Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 33.21074032783508
Epoch: 1, Steps: 34 | Train Loss: 6.601 Vali Loss: 7.487 Vali Acc: 0.376 Test Loss: 7.487 Test Acc: 0.376
Validation loss decreased (inf --> -0.375648).  Saving model ...
Epoch: 2 cost time: 34.43491291999817
Epoch: 2, Steps: 34 | Train Loss: 9.760 Vali Loss: 14.156 Vali Acc: 0.335 Test Loss: 14.156 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.83670401573181
Epoch: 3, Steps: 34 | Train Loss: 11.203 Vali Loss: 19.704 Vali Acc: 0.376 Test Loss: 19.704 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 33.22850728034973
Epoch: 4, Steps: 34 | Train Loss: 10.542 Vali Loss: 11.943 Vali Acc: 0.636 Test Loss: 11.943 Test Acc: 0.636
Validation loss decreased (-0.375648 --> -0.635719).  Saving model ...
Epoch: 5 cost time: 30.56781315803528
Epoch: 5, Steps: 34 | Train Loss: 8.529 Vali Loss: 11.931 Vali Acc: 0.561 Test Loss: 11.931 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.045026779174805
Epoch: 6, Steps: 34 | Train Loss: 4.747 Vali Loss: 20.759 Vali Acc: 0.509 Test Loss: 20.759 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 33.64202523231506
Epoch: 7, Steps: 34 | Train Loss: 4.476 Vali Loss: 7.021 Vali Acc: 0.538 Test Loss: 7.021 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 34.27734684944153
Epoch: 8, Steps: 34 | Train Loss: 2.803 Vali Loss: 6.372 Vali Acc: 0.694 Test Loss: 6.372 Test Acc: 0.694
Validation loss decreased (-0.635719 --> -0.693578).  Saving model ...
Epoch: 9 cost time: 34.01916313171387
Epoch: 9, Steps: 34 | Train Loss: 1.993 Vali Loss: 6.085 Vali Acc: 0.526 Test Loss: 6.085 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 37.812556743621826
Epoch: 10, Steps: 34 | Train Loss: 3.273 Vali Loss: 11.129 Vali Acc: 0.671 Test Loss: 11.129 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 34.78175115585327
Epoch: 11, Steps: 34 | Train Loss: 3.686 Vali Loss: 8.888 Vali Acc: 0.647 Test Loss: 8.888 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 36.784778356552124
Epoch: 12, Steps: 34 | Train Loss: 3.700 Vali Loss: 10.349 Vali Acc: 0.590 Test Loss: 10.349 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 30.939364194869995
Epoch: 13, Steps: 34 | Train Loss: 2.924 Vali Loss: 7.601 Vali Acc: 0.723 Test Loss: 7.601 Test Acc: 0.723
Validation loss decreased (-0.693578 --> -0.722467).  Saving model ...
Epoch: 14 cost time: 35.22996187210083
Epoch: 14, Steps: 34 | Train Loss: 1.795 Vali Loss: 3.482 Vali Acc: 0.803 Test Loss: 3.482 Test Acc: 0.803
Validation loss decreased (-0.722467 --> -0.803433).  Saving model ...
Epoch: 15 cost time: 36.00739097595215
Epoch: 15, Steps: 34 | Train Loss: 2.043 Vali Loss: 10.518 Vali Acc: 0.538 Test Loss: 10.518 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 35.61266875267029
Epoch: 16, Steps: 34 | Train Loss: 3.177 Vali Loss: 9.022 Vali Acc: 0.624 Test Loss: 9.022 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 32.85992765426636
Epoch: 17, Steps: 34 | Train Loss: 3.181 Vali Loss: 23.254 Vali Acc: 0.312 Test Loss: 23.254 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 27.33339023590088
Epoch: 18, Steps: 34 | Train Loss: 9.735 Vali Loss: 5.361 Vali Acc: 0.717 Test Loss: 5.361 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 34.18697452545166
Epoch: 19, Steps: 34 | Train Loss: 5.911 Vali Loss: 5.014 Vali Acc: 0.740 Test Loss: 5.014 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 36.80493211746216
Epoch: 20, Steps: 34 | Train Loss: 4.976 Vali Loss: 13.554 Vali Acc: 0.624 Test Loss: 13.554 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 38.40595507621765
Epoch: 21, Steps: 34 | Train Loss: 13.534 Vali Loss: 23.113 Vali Acc: 0.214 Test Loss: 23.113 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 36.568867206573486
Epoch: 22, Steps: 34 | Train Loss: 17.075 Vali Loss: 16.003 Vali Acc: 0.289 Test Loss: 16.003 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 37.87303566932678
Epoch: 23, Steps: 34 | Train Loss: 12.747 Vali Loss: 22.595 Vali Acc: 0.133 Test Loss: 22.595 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 34.878050088882446
Epoch: 24, Steps: 34 | Train Loss: 10.446 Vali Loss: 11.209 Vali Acc: 0.133 Test Loss: 11.209 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 20684611
model size : 83.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 37.51871061325073
Epoch: 1, Steps: 34 | Train Loss: 6.651 Vali Loss: 17.934 Vali Acc: 0.225 Test Loss: 17.934 Test Acc: 0.225
Validation loss decreased (inf --> -0.225254).  Saving model ...
Epoch: 2 cost time: 35.91639757156372
Epoch: 2, Steps: 34 | Train Loss: 8.633 Vali Loss: 15.105 Vali Acc: 0.445 Test Loss: 15.105 Test Acc: 0.445
Validation loss decreased (-0.225254 --> -0.444936).  Saving model ...
Epoch: 3 cost time: 37.8028838634491
Epoch: 3, Steps: 34 | Train Loss: 11.729 Vali Loss: 24.661 Vali Acc: 0.347 Test Loss: 24.661 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.24950385093689
Epoch: 4, Steps: 34 | Train Loss: 11.469 Vali Loss: 7.887 Vali Acc: 0.486 Test Loss: 7.887 Test Acc: 0.486
Validation loss decreased (-0.444936 --> -0.485470).  Saving model ...
Epoch: 5 cost time: 35.34029483795166
Epoch: 5, Steps: 34 | Train Loss: 7.311 Vali Loss: 6.580 Vali Acc: 0.630 Test Loss: 6.580 Test Acc: 0.630
Validation loss decreased (-0.485470 --> -0.629992).  Saving model ...
Epoch: 6 cost time: 35.96529006958008
Epoch: 6, Steps: 34 | Train Loss: 4.616 Vali Loss: 10.201 Vali Acc: 0.480 Test Loss: 10.201 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 36.404528856277466
Epoch: 7, Steps: 34 | Train Loss: 3.346 Vali Loss: 9.240 Vali Acc: 0.647 Test Loss: 9.240 Test Acc: 0.647
Validation loss decreased (-0.629992 --> -0.647306).  Saving model ...
Epoch: 8 cost time: 37.91713881492615
Epoch: 8, Steps: 34 | Train Loss: 2.894 Vali Loss: 4.596 Vali Acc: 0.763 Test Loss: 4.596 Test Acc: 0.763
Validation loss decreased (-0.647306 --> -0.762960).  Saving model ...
Epoch: 9 cost time: 42.357521057128906
Epoch: 9, Steps: 34 | Train Loss: 2.791 Vali Loss: 6.825 Vali Acc: 0.757 Test Loss: 6.825 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 30.905354261398315
Epoch: 10, Steps: 34 | Train Loss: 2.303 Vali Loss: 3.158 Vali Acc: 0.763 Test Loss: 3.158 Test Acc: 0.763
Validation loss decreased (-0.762960 --> -0.762974).  Saving model ...
Epoch: 11 cost time: 36.024011850357056
Epoch: 11, Steps: 34 | Train Loss: 1.926 Vali Loss: 7.212 Vali Acc: 0.653 Test Loss: 7.212 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.799543380737305
Epoch: 12, Steps: 34 | Train Loss: 2.643 Vali Loss: 16.356 Vali Acc: 0.584 Test Loss: 16.356 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 35.924593687057495
Epoch: 13, Steps: 34 | Train Loss: 5.531 Vali Loss: 9.428 Vali Acc: 0.578 Test Loss: 9.428 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 35.6564667224884
Epoch: 14, Steps: 34 | Train Loss: 3.003 Vali Loss: 10.785 Vali Acc: 0.699 Test Loss: 10.785 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 34.357691049575806
Epoch: 15, Steps: 34 | Train Loss: 2.476 Vali Loss: 11.582 Vali Acc: 0.734 Test Loss: 11.582 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 36.123854637145996
Epoch: 16, Steps: 34 | Train Loss: 7.114 Vali Loss: 6.163 Vali Acc: 0.636 Test Loss: 6.163 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 24.703776121139526
Epoch: 17, Steps: 34 | Train Loss: 2.507 Vali Loss: 12.374 Vali Acc: 0.584 Test Loss: 12.374 Test Acc: 0.584
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 31.01095938682556
Epoch: 18, Steps: 34 | Train Loss: 13.684 Vali Loss: 18.100 Vali Acc: 0.347 Test Loss: 18.100 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 37.97715401649475
Epoch: 19, Steps: 34 | Train Loss: 21.772 Vali Loss: 8.492 Vali Acc: 0.185 Test Loss: 8.492 Test Acc: 0.185
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 36.065396785736084
Epoch: 20, Steps: 34 | Train Loss: 16.281 Vali Loss: 10.539 Vali Acc: 0.133 Test Loss: 10.539 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 20678723
model size : 83.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 35.50276446342468
Epoch: 1, Steps: 34 | Train Loss: 5.364 Vali Loss: 10.475 Vali Acc: 0.376 Test Loss: 10.475 Test Acc: 0.376
Validation loss decreased (inf --> -0.375618).  Saving model ...
Epoch: 2 cost time: 34.93070197105408
Epoch: 2, Steps: 34 | Train Loss: 13.926 Vali Loss: 8.578 Vali Acc: 0.555 Test Loss: 8.578 Test Acc: 0.555
Validation loss decreased (-0.375618 --> -0.554828).  Saving model ...
Epoch: 3 cost time: 36.177324533462524
Epoch: 3, Steps: 34 | Train Loss: 13.389 Vali Loss: 17.398 Vali Acc: 0.376 Test Loss: 17.398 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.23564887046814
Epoch: 4, Steps: 34 | Train Loss: 10.865 Vali Loss: 31.146 Vali Acc: 0.480 Test Loss: 31.146 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 36.39385986328125
Epoch: 5, Steps: 34 | Train Loss: 8.781 Vali Loss: 7.326 Vali Acc: 0.572 Test Loss: 7.326 Test Acc: 0.572
Validation loss decreased (-0.554828 --> -0.572181).  Saving model ...
Epoch: 6 cost time: 34.8247971534729
Epoch: 6, Steps: 34 | Train Loss: 4.721 Vali Loss: 8.139 Vali Acc: 0.538 Test Loss: 8.139 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 34.602269411087036
Epoch: 7, Steps: 34 | Train Loss: 3.445 Vali Loss: 9.120 Vali Acc: 0.607 Test Loss: 9.120 Test Acc: 0.607
Validation loss decreased (-0.572181 --> -0.606845).  Saving model ...
Epoch: 8 cost time: 34.665913581848145
Epoch: 8, Steps: 34 | Train Loss: 4.888 Vali Loss: 10.351 Vali Acc: 0.595 Test Loss: 10.351 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 36.95597743988037
Epoch: 9, Steps: 34 | Train Loss: 4.757 Vali Loss: 9.581 Vali Acc: 0.555 Test Loss: 9.581 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 37.320154666900635
Epoch: 10, Steps: 34 | Train Loss: 2.618 Vali Loss: 3.065 Vali Acc: 0.763 Test Loss: 3.065 Test Acc: 0.763
Validation loss decreased (-0.606845 --> -0.762975).  Saving model ...
Epoch: 11 cost time: 39.59774422645569
Epoch: 11, Steps: 34 | Train Loss: 2.439 Vali Loss: 6.889 Vali Acc: 0.671 Test Loss: 6.889 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 35.10699486732483
Epoch: 12, Steps: 34 | Train Loss: 2.019 Vali Loss: 12.522 Vali Acc: 0.694 Test Loss: 12.522 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 35.06825828552246
Epoch: 13, Steps: 34 | Train Loss: 2.235 Vali Loss: 8.422 Vali Acc: 0.723 Test Loss: 8.422 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 34.85339593887329
Epoch: 14, Steps: 34 | Train Loss: 2.259 Vali Loss: 6.847 Vali Acc: 0.717 Test Loss: 6.847 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 35.45239853858948
Epoch: 15, Steps: 34 | Train Loss: 3.173 Vali Loss: 10.782 Vali Acc: 0.665 Test Loss: 10.782 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 36.23514676094055
Epoch: 16, Steps: 34 | Train Loss: 5.572 Vali Loss: 9.908 Vali Acc: 0.618 Test Loss: 9.908 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 36.177878856658936
Epoch: 17, Steps: 34 | Train Loss: 4.212 Vali Loss: 8.712 Vali Acc: 0.699 Test Loss: 8.712 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 36.6161003112793
Epoch: 18, Steps: 34 | Train Loss: 4.853 Vali Loss: 15.925 Vali Acc: 0.497 Test Loss: 15.925 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 27.957435846328735
Epoch: 19, Steps: 34 | Train Loss: 6.924 Vali Loss: 17.649 Vali Acc: 0.289 Test Loss: 17.649 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 35.30203676223755
Epoch: 20, Steps: 34 | Train Loss: 9.775 Vali Loss: 16.748 Vali Acc: 0.538 Test Loss: 16.748 Test Acc: 0.538
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 20672835
model size : 83.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 38.19133973121643
Epoch: 1, Steps: 34 | Train Loss: 4.813 Vali Loss: 5.548 Vali Acc: 0.335 Test Loss: 5.548 Test Acc: 0.335
Validation loss decreased (inf --> -0.335205).  Saving model ...
Epoch: 2 cost time: 33.187066316604614
Epoch: 2, Steps: 34 | Train Loss: 15.599 Vali Loss: 20.572 Vali Acc: 0.277 Test Loss: 20.572 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.595519065856934
Epoch: 3, Steps: 34 | Train Loss: 13.355 Vali Loss: 21.774 Vali Acc: 0.607 Test Loss: 21.774 Test Acc: 0.607
Validation loss decreased (-0.335205 --> -0.606719).  Saving model ...
Epoch: 4 cost time: 33.187071800231934
Epoch: 4, Steps: 34 | Train Loss: 16.067 Vali Loss: 12.509 Vali Acc: 0.590 Test Loss: 12.509 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.09117937088013
Epoch: 5, Steps: 34 | Train Loss: 8.524 Vali Loss: 5.957 Vali Acc: 0.659 Test Loss: 5.957 Test Acc: 0.659
Validation loss decreased (-0.606719 --> -0.658900).  Saving model ...
Epoch: 6 cost time: 33.57455396652222
Epoch: 6, Steps: 34 | Train Loss: 5.391 Vali Loss: 5.048 Vali Acc: 0.694 Test Loss: 5.048 Test Acc: 0.694
Validation loss decreased (-0.658900 --> -0.693591).  Saving model ...
Epoch: 7 cost time: 34.041903495788574
Epoch: 7, Steps: 34 | Train Loss: 3.960 Vali Loss: 5.803 Vali Acc: 0.682 Test Loss: 5.803 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 35.809537172317505
Epoch: 8, Steps: 34 | Train Loss: 3.687 Vali Loss: 13.323 Vali Acc: 0.451 Test Loss: 13.323 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 35.14075970649719
Epoch: 9, Steps: 34 | Train Loss: 3.850 Vali Loss: 7.533 Vali Acc: 0.699 Test Loss: 7.533 Test Acc: 0.699
Validation loss decreased (-0.693591 --> -0.699347).  Saving model ...
Epoch: 10 cost time: 33.535770893096924
Epoch: 10, Steps: 34 | Train Loss: 2.330 Vali Loss: 16.028 Vali Acc: 0.595 Test Loss: 16.028 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 35.993816614151
Epoch: 11, Steps: 34 | Train Loss: 4.242 Vali Loss: 12.519 Vali Acc: 0.607 Test Loss: 12.519 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 35.951369762420654
Epoch: 12, Steps: 34 | Train Loss: 5.647 Vali Loss: 7.166 Vali Acc: 0.653 Test Loss: 7.166 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 36.92873477935791
Epoch: 13, Steps: 34 | Train Loss: 4.059 Vali Loss: 6.535 Vali Acc: 0.711 Test Loss: 6.535 Test Acc: 0.711
Validation loss decreased (-0.699347 --> -0.710917).  Saving model ...
Epoch: 14 cost time: 33.675251960754395
Epoch: 14, Steps: 34 | Train Loss: 1.998 Vali Loss: 11.048 Vali Acc: 0.578 Test Loss: 11.048 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 33.948822259902954
Epoch: 15, Steps: 34 | Train Loss: 3.019 Vali Loss: 5.584 Vali Acc: 0.757 Test Loss: 5.584 Test Acc: 0.757
Validation loss decreased (-0.710917 --> -0.757170).  Saving model ...
Epoch: 16 cost time: 33.88591456413269
Epoch: 16, Steps: 34 | Train Loss: 4.494 Vali Loss: 4.703 Vali Acc: 0.746 Test Loss: 4.703 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 32.12841272354126
Epoch: 17, Steps: 34 | Train Loss: 6.070 Vali Loss: 7.404 Vali Acc: 0.647 Test Loss: 7.404 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 35.20619082450867
Epoch: 18, Steps: 34 | Train Loss: 2.168 Vali Loss: 18.106 Vali Acc: 0.312 Test Loss: 18.106 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 32.80893397331238
Epoch: 19, Steps: 34 | Train Loss: 3.074 Vali Loss: 4.331 Vali Acc: 0.665 Test Loss: 4.331 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 33.467097997665405
Epoch: 20, Steps: 34 | Train Loss: 3.578 Vali Loss: 8.972 Vali Acc: 0.555 Test Loss: 8.972 Test Acc: 0.555
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 33.54241466522217
Epoch: 21, Steps: 34 | Train Loss: 16.326 Vali Loss: 45.164 Vali Acc: 0.092 Test Loss: 45.164 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 28.112079620361328
Epoch: 22, Steps: 34 | Train Loss: 32.053 Vali Loss: 39.999 Vali Acc: 0.150 Test Loss: 39.999 Test Acc: 0.150
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 37.84087300300598
Epoch: 23, Steps: 34 | Train Loss: 17.609 Vali Loss: 19.730 Vali Acc: 0.150 Test Loss: 19.730 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 34.62650012969971
Epoch: 24, Steps: 34 | Train Loss: 13.619 Vali Loss: 20.402 Vali Acc: 0.145 Test Loss: 20.402 Test Acc: 0.145
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 34.49788808822632
Epoch: 25, Steps: 34 | Train Loss: 15.571 Vali Loss: 18.007 Vali Acc: 0.156 Test Loss: 18.007 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 20666947
model size : 83.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.738430976867676
Epoch: 1, Steps: 34 | Train Loss: 4.416 Vali Loss: 14.838 Vali Acc: 0.266 Test Loss: 14.838 Test Acc: 0.266
Validation loss decreased (inf --> -0.265748).  Saving model ...
Epoch: 2 cost time: 31.000192165374756
Epoch: 2, Steps: 34 | Train Loss: 11.700 Vali Loss: 10.336 Vali Acc: 0.474 Test Loss: 10.336 Test Acc: 0.474
Validation loss decreased (-0.265748 --> -0.473885).  Saving model ...
Epoch: 3 cost time: 32.66579866409302
Epoch: 3, Steps: 34 | Train Loss: 14.707 Vali Loss: 29.869 Vali Acc: 0.416 Test Loss: 29.869 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 29.253597021102905
Epoch: 4, Steps: 34 | Train Loss: 12.125 Vali Loss: 9.492 Vali Acc: 0.480 Test Loss: 9.492 Test Acc: 0.480
Validation loss decreased (-0.473885 --> -0.479674).  Saving model ...
Epoch: 5 cost time: 32.06277656555176
Epoch: 5, Steps: 34 | Train Loss: 8.556 Vali Loss: 9.563 Vali Acc: 0.595 Test Loss: 9.563 Test Acc: 0.595
Validation loss decreased (-0.479674 --> -0.595280).  Saving model ...
Epoch: 6 cost time: 30.634796380996704
Epoch: 6, Steps: 34 | Train Loss: 6.103 Vali Loss: 11.005 Vali Acc: 0.549 Test Loss: 11.005 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 33.62562680244446
Epoch: 7, Steps: 34 | Train Loss: 4.043 Vali Loss: 5.523 Vali Acc: 0.711 Test Loss: 5.523 Test Acc: 0.711
Validation loss decreased (-0.595280 --> -0.710927).  Saving model ...
Epoch: 8 cost time: 35.37438464164734
Epoch: 8, Steps: 34 | Train Loss: 1.851 Vali Loss: 8.965 Vali Acc: 0.566 Test Loss: 8.965 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 35.050957679748535
Epoch: 9, Steps: 34 | Train Loss: 1.647 Vali Loss: 7.952 Vali Acc: 0.647 Test Loss: 7.952 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 29.960445404052734
Epoch: 10, Steps: 34 | Train Loss: 3.501 Vali Loss: 4.736 Vali Acc: 0.740 Test Loss: 4.736 Test Acc: 0.740
Validation loss decreased (-0.710927 --> -0.739837).  Saving model ...
Epoch: 11 cost time: 33.11406874656677
Epoch: 11, Steps: 34 | Train Loss: 2.638 Vali Loss: 5.457 Vali Acc: 0.717 Test Loss: 5.457 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 31.620771169662476
Epoch: 12, Steps: 34 | Train Loss: 1.667 Vali Loss: 13.704 Vali Acc: 0.497 Test Loss: 13.704 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 34.46136665344238
Epoch: 13, Steps: 34 | Train Loss: 2.208 Vali Loss: 10.292 Vali Acc: 0.543 Test Loss: 10.292 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 32.79671311378479
Epoch: 14, Steps: 34 | Train Loss: 2.123 Vali Loss: 7.307 Vali Acc: 0.682 Test Loss: 7.307 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 32.1217827796936
Epoch: 15, Steps: 34 | Train Loss: 2.920 Vali Loss: 2.382 Vali Acc: 0.780 Test Loss: 2.382 Test Acc: 0.780
Validation loss decreased (-0.739837 --> -0.780323).  Saving model ...
Epoch: 16 cost time: 32.14594769477844
Epoch: 16, Steps: 34 | Train Loss: 5.799 Vali Loss: 9.494 Vali Acc: 0.728 Test Loss: 9.494 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 32.82979702949524
Epoch: 17, Steps: 34 | Train Loss: 4.711 Vali Loss: 8.589 Vali Acc: 0.543 Test Loss: 8.589 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 33.348650217056274
Epoch: 18, Steps: 34 | Train Loss: 9.780 Vali Loss: 25.760 Vali Acc: 0.422 Test Loss: 25.760 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 34.83498764038086
Epoch: 19, Steps: 34 | Train Loss: 9.682 Vali Loss: 11.932 Vali Acc: 0.595 Test Loss: 11.932 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 31.168850898742676
Epoch: 20, Steps: 34 | Train Loss: 13.562 Vali Loss: 10.479 Vali Acc: 0.434 Test Loss: 10.479 Test Acc: 0.434
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 28.63617467880249
Epoch: 21, Steps: 34 | Train Loss: 6.654 Vali Loss: 6.055 Vali Acc: 0.225 Test Loss: 6.055 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 32.50886940956116
Epoch: 22, Steps: 34 | Train Loss: 21.236 Vali Loss: 29.706 Vali Acc: 0.116 Test Loss: 29.706 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 32.164270639419556
Epoch: 23, Steps: 34 | Train Loss: 10.034 Vali Loss: 13.967 Vali Acc: 0.387 Test Loss: 13.967 Test Acc: 0.387
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 33.45837068557739
Epoch: 24, Steps: 34 | Train Loss: 17.783 Vali Loss: 24.541 Vali Acc: 0.150 Test Loss: 24.541 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 30.31854510307312
Epoch: 25, Steps: 34 | Train Loss: 13.992 Vali Loss: 7.062 Vali Acc: 0.133 Test Loss: 7.062 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 18320707
model size : 74.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 31.875784635543823
Epoch: 1, Steps: 34 | Train Loss: 5.122 Vali Loss: 7.058 Vali Acc: 0.358 Test Loss: 7.058 Test Acc: 0.358
Validation loss decreased (inf --> -0.358311).  Saving model ...
Epoch: 2 cost time: 32.54213881492615
Epoch: 2, Steps: 34 | Train Loss: 9.168 Vali Loss: 6.492 Vali Acc: 0.445 Test Loss: 6.492 Test Acc: 0.445
Validation loss decreased (-0.358311 --> -0.445022).  Saving model ...
Epoch: 3 cost time: 30.850719451904297
Epoch: 3, Steps: 34 | Train Loss: 12.716 Vali Loss: 16.680 Vali Acc: 0.428 Test Loss: 16.680 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.44127559661865
Epoch: 4, Steps: 34 | Train Loss: 12.885 Vali Loss: 13.726 Vali Acc: 0.578 Test Loss: 13.726 Test Acc: 0.578
Validation loss decreased (-0.445022 --> -0.577897).  Saving model ...
Epoch: 5 cost time: 31.832733392715454
Epoch: 5, Steps: 34 | Train Loss: 10.915 Vali Loss: 12.966 Vali Acc: 0.607 Test Loss: 12.966 Test Acc: 0.607
Validation loss decreased (-0.577897 --> -0.606807).  Saving model ...
Epoch: 6 cost time: 34.13452219963074
Epoch: 6, Steps: 34 | Train Loss: 6.540 Vali Loss: 13.702 Vali Acc: 0.590 Test Loss: 13.702 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 35.46313118934631
Epoch: 7, Steps: 34 | Train Loss: 5.085 Vali Loss: 3.884 Vali Acc: 0.705 Test Loss: 3.884 Test Acc: 0.705
Validation loss decreased (-0.606807 --> -0.705163).  Saving model ...
Epoch: 8 cost time: 32.16071176528931
Epoch: 8, Steps: 34 | Train Loss: 3.748 Vali Loss: 8.295 Vali Acc: 0.705 Test Loss: 8.295 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 30.829407930374146
Epoch: 9, Steps: 34 | Train Loss: 7.128 Vali Loss: 7.301 Vali Acc: 0.607 Test Loss: 7.301 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 33.2201943397522
Epoch: 10, Steps: 34 | Train Loss: 4.899 Vali Loss: 6.849 Vali Acc: 0.723 Test Loss: 6.849 Test Acc: 0.723
Validation loss decreased (-0.705163 --> -0.722475).  Saving model ...
Epoch: 11 cost time: 28.67014455795288
Epoch: 11, Steps: 34 | Train Loss: 2.109 Vali Loss: 3.018 Vali Acc: 0.809 Test Loss: 3.018 Test Acc: 0.809
Validation loss decreased (-0.722475 --> -0.809218).  Saving model ...
Epoch: 12 cost time: 31.44049382209778
Epoch: 12, Steps: 34 | Train Loss: 2.277 Vali Loss: 6.328 Vali Acc: 0.751 Test Loss: 6.328 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 29.47519874572754
Epoch: 13, Steps: 34 | Train Loss: 2.897 Vali Loss: 4.774 Vali Acc: 0.751 Test Loss: 4.774 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 31.35392713546753
Epoch: 14, Steps: 34 | Train Loss: 1.888 Vali Loss: 18.843 Vali Acc: 0.555 Test Loss: 18.843 Test Acc: 0.555
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 33.11583995819092
Epoch: 15, Steps: 34 | Train Loss: 3.950 Vali Loss: 9.987 Vali Acc: 0.711 Test Loss: 9.987 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 32.90799021720886
Epoch: 16, Steps: 34 | Train Loss: 3.161 Vali Loss: 4.247 Vali Acc: 0.809 Test Loss: 4.247 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 31.885572910308838
Epoch: 17, Steps: 34 | Train Loss: 2.894 Vali Loss: 8.684 Vali Acc: 0.630 Test Loss: 8.684 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 36.27746105194092
Epoch: 18, Steps: 34 | Train Loss: 7.890 Vali Loss: 10.214 Vali Acc: 0.445 Test Loss: 10.214 Test Acc: 0.445
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 32.40096664428711
Epoch: 19, Steps: 34 | Train Loss: 14.466 Vali Loss: 20.663 Vali Acc: 0.150 Test Loss: 20.663 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 23.39838695526123
Epoch: 20, Steps: 34 | Train Loss: 18.475 Vali Loss: 13.532 Vali Acc: 0.162 Test Loss: 13.532 Test Acc: 0.162
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 30.503217458724976
Epoch: 21, Steps: 34 | Train Loss: 11.612 Vali Loss: 18.058 Vali Acc: 0.133 Test Loss: 18.058 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 18314819
model size : 74.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.25778031349182
Epoch: 1, Steps: 34 | Train Loss: 7.543 Vali Loss: 8.586 Vali Acc: 0.272 Test Loss: 8.586 Test Acc: 0.272
Validation loss decreased (inf --> -0.271590).  Saving model ...
Epoch: 2 cost time: 29.942994117736816
Epoch: 2, Steps: 34 | Train Loss: 9.279 Vali Loss: 10.200 Vali Acc: 0.416 Test Loss: 10.200 Test Acc: 0.416
Validation loss decreased (-0.271590 --> -0.416083).  Saving model ...
Epoch: 3 cost time: 30.188466548919678
Epoch: 3, Steps: 34 | Train Loss: 11.310 Vali Loss: 22.999 Vali Acc: 0.382 Test Loss: 22.999 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.710103034973145
Epoch: 4, Steps: 34 | Train Loss: 16.630 Vali Loss: 16.597 Vali Acc: 0.526 Test Loss: 16.597 Test Acc: 0.526
Validation loss decreased (-0.416083 --> -0.525846).  Saving model ...
Epoch: 5 cost time: 31.916892528533936
Epoch: 5, Steps: 34 | Train Loss: 10.270 Vali Loss: 20.998 Vali Acc: 0.457 Test Loss: 20.998 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.45370268821716
Epoch: 6, Steps: 34 | Train Loss: 5.226 Vali Loss: 7.698 Vali Acc: 0.647 Test Loss: 7.698 Test Acc: 0.647
Validation loss decreased (-0.525846 --> -0.647322).  Saving model ...
Epoch: 7 cost time: 34.93667912483215
Epoch: 7, Steps: 34 | Train Loss: 3.020 Vali Loss: 9.974 Vali Acc: 0.578 Test Loss: 9.974 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 31.246628999710083
Epoch: 8, Steps: 34 | Train Loss: 3.849 Vali Loss: 5.971 Vali Acc: 0.653 Test Loss: 5.971 Test Acc: 0.653
Validation loss decreased (-0.647322 --> -0.653119).  Saving model ...
Epoch: 9 cost time: 31.727104902267456
Epoch: 9, Steps: 34 | Train Loss: 2.556 Vali Loss: 8.448 Vali Acc: 0.717 Test Loss: 8.448 Test Acc: 0.717
Validation loss decreased (-0.653119 --> -0.716679).  Saving model ...
Epoch: 10 cost time: 30.66598105430603
Epoch: 10, Steps: 34 | Train Loss: 3.352 Vali Loss: 9.790 Vali Acc: 0.711 Test Loss: 9.790 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 31.13436460494995
Epoch: 11, Steps: 34 | Train Loss: 3.456 Vali Loss: 8.318 Vali Acc: 0.751 Test Loss: 8.318 Test Acc: 0.751
Validation loss decreased (-0.716679 --> -0.751362).  Saving model ...
Epoch: 12 cost time: 32.89998006820679
Epoch: 12, Steps: 34 | Train Loss: 3.632 Vali Loss: 7.927 Vali Acc: 0.572 Test Loss: 7.927 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 32.33856272697449
Epoch: 13, Steps: 34 | Train Loss: 2.909 Vali Loss: 10.642 Vali Acc: 0.624 Test Loss: 10.642 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 29.2401065826416
Epoch: 14, Steps: 34 | Train Loss: 1.943 Vali Loss: 5.050 Vali Acc: 0.694 Test Loss: 5.050 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 32.597039461135864
Epoch: 15, Steps: 34 | Train Loss: 1.050 Vali Loss: 15.222 Vali Acc: 0.595 Test Loss: 15.222 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 32.30768013000488
Epoch: 16, Steps: 34 | Train Loss: 2.136 Vali Loss: 3.727 Vali Acc: 0.734 Test Loss: 3.727 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 38.22998309135437
Epoch: 17, Steps: 34 | Train Loss: 0.866 Vali Loss: 8.174 Vali Acc: 0.769 Test Loss: 8.174 Test Acc: 0.769
Validation loss decreased (-0.751362 --> -0.768704).  Saving model ...
Epoch: 18 cost time: 33.963531494140625
Epoch: 18, Steps: 34 | Train Loss: 2.190 Vali Loss: 9.734 Vali Acc: 0.659 Test Loss: 9.734 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 35.76218056678772
Epoch: 19, Steps: 34 | Train Loss: 3.799 Vali Loss: 7.953 Vali Acc: 0.711 Test Loss: 7.953 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 34.87570834159851
Epoch: 20, Steps: 34 | Train Loss: 2.885 Vali Loss: 10.363 Vali Acc: 0.624 Test Loss: 10.363 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 33.414515256881714
Epoch: 21, Steps: 34 | Train Loss: 2.346 Vali Loss: 16.054 Vali Acc: 0.549 Test Loss: 16.054 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 33.46286654472351
Epoch: 22, Steps: 34 | Train Loss: 8.739 Vali Loss: 5.315 Vali Acc: 0.549 Test Loss: 5.315 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 36.32013154029846
Epoch: 23, Steps: 34 | Train Loss: 7.002 Vali Loss: 8.533 Vali Acc: 0.509 Test Loss: 8.533 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 31.313429355621338
Epoch: 24, Steps: 34 | Train Loss: 26.852 Vali Loss: 20.321 Vali Acc: 0.127 Test Loss: 20.321 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 24.5339834690094
Epoch: 25, Steps: 34 | Train Loss: 14.418 Vali Loss: 12.478 Vali Acc: 0.173 Test Loss: 12.478 Test Acc: 0.173
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 34.70335340499878
Epoch: 26, Steps: 34 | Train Loss: 10.809 Vali Loss: 6.116 Vali Acc: 0.116 Test Loss: 6.116 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 33.14988088607788
Epoch: 27, Steps: 34 | Train Loss: 8.093 Vali Loss: 8.900 Vali Acc: 0.127 Test Loss: 8.900 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 18308931
model size : 74.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 37.72808885574341
Epoch: 1, Steps: 34 | Train Loss: 9.339 Vali Loss: 12.822 Vali Acc: 0.341 Test Loss: 12.822 Test Acc: 0.341
Validation loss decreased (inf --> -0.340912).  Saving model ...
Epoch: 2 cost time: 35.81028723716736
Epoch: 2, Steps: 34 | Train Loss: 13.341 Vali Loss: 10.197 Vali Acc: 0.422 Test Loss: 10.197 Test Acc: 0.422
Validation loss decreased (-0.340912 --> -0.421863).  Saving model ...
Epoch: 3 cost time: 34.03135442733765
Epoch: 3, Steps: 34 | Train Loss: 9.290 Vali Loss: 9.303 Vali Acc: 0.514 Test Loss: 9.303 Test Acc: 0.514
Validation loss decreased (-0.421863 --> -0.514358).  Saving model ...
Epoch: 4 cost time: 39.9393470287323
Epoch: 4, Steps: 34 | Train Loss: 5.921 Vali Loss: 9.043 Vali Acc: 0.526 Test Loss: 9.043 Test Acc: 0.526
Validation loss decreased (-0.514358 --> -0.525921).  Saving model ...
Epoch: 5 cost time: 28.603453636169434
Epoch: 5, Steps: 34 | Train Loss: 6.188 Vali Loss: 5.088 Vali Acc: 0.711 Test Loss: 5.088 Test Acc: 0.711
Validation loss decreased (-0.525921 --> -0.710932).  Saving model ...
Epoch: 6 cost time: 32.98064422607422
Epoch: 6, Steps: 34 | Train Loss: 5.697 Vali Loss: 7.963 Vali Acc: 0.561 Test Loss: 7.963 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 32.759511947631836
Epoch: 7, Steps: 34 | Train Loss: 7.479 Vali Loss: 13.076 Vali Acc: 0.503 Test Loss: 13.076 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 33.19557809829712
Epoch: 8, Steps: 34 | Train Loss: 2.628 Vali Loss: 4.341 Vali Acc: 0.728 Test Loss: 4.341 Test Acc: 0.728
Validation loss decreased (-0.710932 --> -0.728280).  Saving model ...
Epoch: 9 cost time: 34.44571781158447
Epoch: 9, Steps: 34 | Train Loss: 1.898 Vali Loss: 7.488 Vali Acc: 0.595 Test Loss: 7.488 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 33.88563108444214
Epoch: 10, Steps: 34 | Train Loss: 2.841 Vali Loss: 4.571 Vali Acc: 0.728 Test Loss: 4.571 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 33.38349175453186
Epoch: 11, Steps: 34 | Train Loss: 1.876 Vali Loss: 4.252 Vali Acc: 0.792 Test Loss: 4.252 Test Acc: 0.792
Validation loss decreased (-0.728280 --> -0.791865).  Saving model ...
Epoch: 12 cost time: 35.32298183441162
Epoch: 12, Steps: 34 | Train Loss: 2.361 Vali Loss: 6.708 Vali Acc: 0.694 Test Loss: 6.708 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 33.237507581710815
Epoch: 13, Steps: 34 | Train Loss: 1.786 Vali Loss: 4.019 Vali Acc: 0.803 Test Loss: 4.019 Test Acc: 0.803
Validation loss decreased (-0.791865 --> -0.803428).  Saving model ...
Epoch: 14 cost time: 34.918418645858765
Epoch: 14, Steps: 34 | Train Loss: 3.343 Vali Loss: 25.879 Vali Acc: 0.532 Test Loss: 25.879 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 32.7531156539917
Epoch: 15, Steps: 34 | Train Loss: 5.795 Vali Loss: 10.891 Vali Acc: 0.694 Test Loss: 10.891 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 34.10041785240173
Epoch: 16, Steps: 34 | Train Loss: 2.392 Vali Loss: 8.091 Vali Acc: 0.682 Test Loss: 8.091 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 32.87371754646301
Epoch: 17, Steps: 34 | Train Loss: 2.431 Vali Loss: 9.162 Vali Acc: 0.734 Test Loss: 9.162 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 32.821038246154785
Epoch: 18, Steps: 34 | Train Loss: 3.132 Vali Loss: 11.361 Vali Acc: 0.613 Test Loss: 11.361 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 31.56402349472046
Epoch: 19, Steps: 34 | Train Loss: 3.286 Vali Loss: 14.226 Vali Acc: 0.578 Test Loss: 14.226 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 28.92644691467285
Epoch: 20, Steps: 34 | Train Loss: 9.190 Vali Loss: 9.878 Vali Acc: 0.584 Test Loss: 9.878 Test Acc: 0.584
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 30.528111696243286
Epoch: 21, Steps: 34 | Train Loss: 9.492 Vali Loss: 17.531 Vali Acc: 0.116 Test Loss: 17.531 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 30.568641901016235
Epoch: 22, Steps: 34 | Train Loss: 12.514 Vali Loss: 11.259 Vali Acc: 0.150 Test Loss: 11.259 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 33.11432337760925
Epoch: 23, Steps: 34 | Train Loss: 7.878 Vali Loss: 7.009 Vali Acc: 0.145 Test Loss: 7.009 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 18303043
model size : 74.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.496845960617065
Epoch: 1, Steps: 34 | Train Loss: 6.355 Vali Loss: 7.162 Vali Acc: 0.329 Test Loss: 7.162 Test Acc: 0.329
Validation loss decreased (inf --> -0.329408).  Saving model ...
Epoch: 2 cost time: 33.58333086967468
Epoch: 2, Steps: 34 | Train Loss: 8.623 Vali Loss: 9.074 Vali Acc: 0.422 Test Loss: 9.074 Test Acc: 0.422
Validation loss decreased (-0.329408 --> -0.421875).  Saving model ...
Epoch: 3 cost time: 32.58553123474121
Epoch: 3, Steps: 34 | Train Loss: 10.844 Vali Loss: 14.454 Vali Acc: 0.306 Test Loss: 14.454 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.768455266952515
Epoch: 4, Steps: 34 | Train Loss: 10.697 Vali Loss: 17.912 Vali Acc: 0.416 Test Loss: 17.912 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.13088512420654
Epoch: 5, Steps: 34 | Train Loss: 7.090 Vali Loss: 7.245 Vali Acc: 0.642 Test Loss: 7.245 Test Acc: 0.642
Validation loss decreased (-0.421875 --> -0.641546).  Saving model ...
Epoch: 6 cost time: 32.48511004447937
Epoch: 6, Steps: 34 | Train Loss: 5.307 Vali Loss: 6.573 Vali Acc: 0.665 Test Loss: 6.573 Test Acc: 0.665
Validation loss decreased (-0.641546 --> -0.664674).  Saving model ...
Epoch: 7 cost time: 30.512447118759155
Epoch: 7, Steps: 34 | Train Loss: 3.597 Vali Loss: 8.708 Vali Acc: 0.734 Test Loss: 8.708 Test Acc: 0.734
Validation loss decreased (-0.664674 --> -0.734017).  Saving model ...
Epoch: 8 cost time: 30.531866550445557
Epoch: 8, Steps: 34 | Train Loss: 1.860 Vali Loss: 2.864 Vali Acc: 0.803 Test Loss: 2.864 Test Acc: 0.803
Validation loss decreased (-0.734017 --> -0.803440).  Saving model ...
Epoch: 9 cost time: 31.937073469161987
Epoch: 9, Steps: 34 | Train Loss: 1.088 Vali Loss: 5.523 Vali Acc: 0.740 Test Loss: 5.523 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.609943866729736
Epoch: 10, Steps: 34 | Train Loss: 1.714 Vali Loss: 7.339 Vali Acc: 0.711 Test Loss: 7.339 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 28.99298095703125
Epoch: 11, Steps: 34 | Train Loss: 1.448 Vali Loss: 5.049 Vali Acc: 0.723 Test Loss: 5.049 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.096675157547
Epoch: 12, Steps: 34 | Train Loss: 1.375 Vali Loss: 8.802 Vali Acc: 0.717 Test Loss: 8.802 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 29.10972809791565
Epoch: 13, Steps: 34 | Train Loss: 1.603 Vali Loss: 6.303 Vali Acc: 0.809 Test Loss: 6.303 Test Acc: 0.809
Validation loss decreased (-0.803440 --> -0.809186).  Saving model ...
Epoch: 14 cost time: 31.654666423797607
Epoch: 14, Steps: 34 | Train Loss: 1.411 Vali Loss: 9.303 Vali Acc: 0.740 Test Loss: 9.303 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 32.15845799446106
Epoch: 15, Steps: 34 | Train Loss: 2.744 Vali Loss: 36.776 Vali Acc: 0.468 Test Loss: 36.776 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 34.278210163116455
Epoch: 16, Steps: 34 | Train Loss: 4.351 Vali Loss: 6.961 Vali Acc: 0.769 Test Loss: 6.961 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 33.171724796295166
Epoch: 17, Steps: 34 | Train Loss: 2.073 Vali Loss: 13.188 Vali Acc: 0.624 Test Loss: 13.188 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 32.5172655582428
Epoch: 18, Steps: 34 | Train Loss: 1.556 Vali Loss: 13.079 Vali Acc: 0.723 Test Loss: 13.079 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 29.75219964981079
Epoch: 19, Steps: 34 | Train Loss: 1.400 Vali Loss: 18.328 Vali Acc: 0.434 Test Loss: 18.328 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 29.91329860687256
Epoch: 20, Steps: 34 | Train Loss: 5.484 Vali Loss: 8.677 Vali Acc: 0.740 Test Loss: 8.677 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 30.96952795982361
Epoch: 21, Steps: 34 | Train Loss: 1.517 Vali Loss: 7.223 Vali Acc: 0.786 Test Loss: 7.223 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 29.083545446395874
Epoch: 22, Steps: 34 | Train Loss: 2.202 Vali Loss: 19.960 Vali Acc: 0.630 Test Loss: 19.960 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 29.693578958511353
Epoch: 23, Steps: 34 | Train Loss: 4.003 Vali Loss: 14.257 Vali Acc: 0.630 Test Loss: 14.257 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 17138755
model size : 70.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.241493463516235
Epoch: 1, Steps: 34 | Train Loss: 5.806 Vali Loss: 13.085 Vali Acc: 0.185 Test Loss: 13.085 Test Acc: 0.185
Validation loss decreased (inf --> -0.184840).  Saving model ...
Epoch: 2 cost time: 32.11080551147461
Epoch: 2, Steps: 34 | Train Loss: 8.826 Vali Loss: 8.273 Vali Acc: 0.410 Test Loss: 8.273 Test Acc: 0.410
Validation loss decreased (-0.184840 --> -0.410322).  Saving model ...
Epoch: 3 cost time: 32.93208456039429
Epoch: 3, Steps: 34 | Train Loss: 10.644 Vali Loss: 12.034 Vali Acc: 0.486 Test Loss: 12.034 Test Acc: 0.486
Validation loss decreased (-0.410322 --> -0.485429).  Saving model ...
Epoch: 4 cost time: 32.95198631286621
Epoch: 4, Steps: 34 | Train Loss: 10.921 Vali Loss: 11.758 Vali Acc: 0.434 Test Loss: 11.758 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.028879642486572
Epoch: 5, Steps: 34 | Train Loss: 7.941 Vali Loss: 15.942 Vali Acc: 0.486 Test Loss: 15.942 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.69062638282776
Epoch: 6, Steps: 34 | Train Loss: 7.182 Vali Loss: 6.855 Vali Acc: 0.694 Test Loss: 6.855 Test Acc: 0.694
Validation loss decreased (-0.485429 --> -0.693573).  Saving model ...
Epoch: 7 cost time: 30.2496497631073
Epoch: 7, Steps: 34 | Train Loss: 4.677 Vali Loss: 7.837 Vali Acc: 0.555 Test Loss: 7.837 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 31.078321933746338
Epoch: 8, Steps: 34 | Train Loss: 3.540 Vali Loss: 3.794 Vali Acc: 0.717 Test Loss: 3.794 Test Acc: 0.717
Validation loss decreased (-0.693573 --> -0.716725).  Saving model ...
Epoch: 9 cost time: 31.75089716911316
Epoch: 9, Steps: 34 | Train Loss: 2.357 Vali Loss: 5.016 Vali Acc: 0.734 Test Loss: 5.016 Test Acc: 0.734
Validation loss decreased (-0.716725 --> -0.734054).  Saving model ...
Epoch: 10 cost time: 31.113680124282837
Epoch: 10, Steps: 34 | Train Loss: 1.518 Vali Loss: 4.275 Vali Acc: 0.780 Test Loss: 4.275 Test Acc: 0.780
Validation loss decreased (-0.734054 --> -0.780304).  Saving model ...
Epoch: 11 cost time: 31.4321551322937
Epoch: 11, Steps: 34 | Train Loss: 2.111 Vali Loss: 6.943 Vali Acc: 0.694 Test Loss: 6.943 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.79989767074585
Epoch: 12, Steps: 34 | Train Loss: 1.642 Vali Loss: 9.295 Vali Acc: 0.694 Test Loss: 9.295 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 29.64635920524597
Epoch: 13, Steps: 34 | Train Loss: 2.319 Vali Loss: 7.840 Vali Acc: 0.595 Test Loss: 7.840 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 31.701579093933105
Epoch: 14, Steps: 34 | Train Loss: 2.431 Vali Loss: 7.893 Vali Acc: 0.723 Test Loss: 7.893 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 33.234925508499146
Epoch: 15, Steps: 34 | Train Loss: 2.228 Vali Loss: 4.355 Vali Acc: 0.769 Test Loss: 4.355 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 33.062480449676514
Epoch: 16, Steps: 34 | Train Loss: 3.960 Vali Loss: 20.546 Vali Acc: 0.416 Test Loss: 20.546 Test Acc: 0.416
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 33.663588762283325
Epoch: 17, Steps: 34 | Train Loss: 4.417 Vali Loss: 17.830 Vali Acc: 0.607 Test Loss: 17.830 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 33.796590089797974
Epoch: 18, Steps: 34 | Train Loss: 7.857 Vali Loss: 14.814 Vali Acc: 0.520 Test Loss: 14.814 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 29.19845986366272
Epoch: 19, Steps: 34 | Train Loss: 6.751 Vali Loss: 8.561 Vali Acc: 0.578 Test Loss: 8.561 Test Acc: 0.578
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 30.669944763183594
Epoch: 20, Steps: 34 | Train Loss: 7.251 Vali Loss: 8.919 Vali Acc: 0.399 Test Loss: 8.919 Test Acc: 0.399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 17132867
model size : 70.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 30.8470356464386
Epoch: 1, Steps: 34 | Train Loss: 7.558 Vali Loss: 8.216 Vali Acc: 0.416 Test Loss: 8.216 Test Acc: 0.416
Validation loss decreased (inf --> -0.416103).  Saving model ...
Epoch: 2 cost time: 21.287048816680908
Epoch: 2, Steps: 34 | Train Loss: 12.170 Vali Loss: 25.086 Vali Acc: 0.289 Test Loss: 25.086 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.2378306388855
Epoch: 3, Steps: 34 | Train Loss: 13.964 Vali Loss: 17.103 Vali Acc: 0.474 Test Loss: 17.103 Test Acc: 0.474
Validation loss decreased (-0.416103 --> -0.473817).  Saving model ...
Epoch: 4 cost time: 30.02571988105774
Epoch: 4, Steps: 34 | Train Loss: 15.211 Vali Loss: 37.443 Vali Acc: 0.387 Test Loss: 37.443 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.41096591949463
Epoch: 5, Steps: 34 | Train Loss: 16.707 Vali Loss: 12.208 Vali Acc: 0.555 Test Loss: 12.208 Test Acc: 0.555
Validation loss decreased (-0.473817 --> -0.554791).  Saving model ...
Epoch: 6 cost time: 30.535914421081543
Epoch: 6, Steps: 34 | Train Loss: 13.025 Vali Loss: 16.043 Vali Acc: 0.561 Test Loss: 16.043 Test Acc: 0.561
Validation loss decreased (-0.554791 --> -0.560533).  Saving model ...
Epoch: 7 cost time: 31.23447012901306
Epoch: 7, Steps: 34 | Train Loss: 5.122 Vali Loss: 23.687 Vali Acc: 0.474 Test Loss: 23.687 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.11390233039856
Epoch: 8, Steps: 34 | Train Loss: 4.133 Vali Loss: 9.473 Vali Acc: 0.659 Test Loss: 9.473 Test Acc: 0.659
Validation loss decreased (-0.560533 --> -0.658865).  Saving model ...
Epoch: 9 cost time: 34.636940479278564
Epoch: 9, Steps: 34 | Train Loss: 4.793 Vali Loss: 9.214 Vali Acc: 0.688 Test Loss: 9.214 Test Acc: 0.688
Validation loss decreased (-0.658865 --> -0.687769).  Saving model ...
Epoch: 10 cost time: 30.23248553276062
Epoch: 10, Steps: 34 | Train Loss: 4.360 Vali Loss: 7.908 Vali Acc: 0.688 Test Loss: 7.908 Test Acc: 0.688
Validation loss decreased (-0.687769 --> -0.687782).  Saving model ...
Epoch: 11 cost time: 30.621716260910034
Epoch: 11, Steps: 34 | Train Loss: 3.564 Vali Loss: 5.415 Vali Acc: 0.809 Test Loss: 5.415 Test Acc: 0.809
Validation loss decreased (-0.687782 --> -0.809194).  Saving model ...
Epoch: 12 cost time: 30.3805935382843
Epoch: 12, Steps: 34 | Train Loss: 2.071 Vali Loss: 4.711 Vali Acc: 0.809 Test Loss: 4.711 Test Acc: 0.809
Validation loss decreased (-0.809194 --> -0.809201).  Saving model ...
Epoch: 13 cost time: 30.193390607833862
Epoch: 13, Steps: 34 | Train Loss: 2.148 Vali Loss: 6.358 Vali Acc: 0.786 Test Loss: 6.358 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 31.19716501235962
Epoch: 14, Steps: 34 | Train Loss: 2.259 Vali Loss: 14.530 Vali Acc: 0.676 Test Loss: 14.530 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 31.97799253463745
Epoch: 15, Steps: 34 | Train Loss: 1.964 Vali Loss: 8.505 Vali Acc: 0.780 Test Loss: 8.505 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 29.847832441329956
Epoch: 16, Steps: 34 | Train Loss: 1.966 Vali Loss: 8.349 Vali Acc: 0.699 Test Loss: 8.349 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 30.789739847183228
Epoch: 17, Steps: 34 | Train Loss: 1.577 Vali Loss: 6.582 Vali Acc: 0.786 Test Loss: 6.582 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 30.643662214279175
Epoch: 18, Steps: 34 | Train Loss: 1.642 Vali Loss: 9.056 Vali Acc: 0.751 Test Loss: 9.056 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 30.67403507232666
Epoch: 19, Steps: 34 | Train Loss: 1.485 Vali Loss: 5.286 Vali Acc: 0.798 Test Loss: 5.286 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 30.413554906845093
Epoch: 20, Steps: 34 | Train Loss: 1.209 Vali Loss: 11.934 Vali Acc: 0.740 Test Loss: 11.934 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 31.252886533737183
Epoch: 21, Steps: 34 | Train Loss: 4.977 Vali Loss: 6.217 Vali Acc: 0.769 Test Loss: 6.217 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 31.472744703292847
Epoch: 22, Steps: 34 | Train Loss: 4.466 Vali Loss: 27.777 Vali Acc: 0.555 Test Loss: 27.777 Test Acc: 0.555
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 17126979
model size : 70.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.56062150001526
Epoch: 1, Steps: 34 | Train Loss: 6.394 Vali Loss: 10.777 Vali Acc: 0.295 Test Loss: 10.777 Test Acc: 0.295
Validation loss decreased (inf --> -0.294690).  Saving model ...
Epoch: 2 cost time: 29.493343114852905
Epoch: 2, Steps: 34 | Train Loss: 10.506 Vali Loss: 28.958 Vali Acc: 0.260 Test Loss: 28.958 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.537322521209717
Epoch: 3, Steps: 34 | Train Loss: 14.452 Vali Loss: 23.676 Vali Acc: 0.434 Test Loss: 23.676 Test Acc: 0.434
Validation loss decreased (-0.294690 --> -0.433289).  Saving model ...
Epoch: 4 cost time: 29.349810123443604
Epoch: 4, Steps: 34 | Train Loss: 12.296 Vali Loss: 32.337 Vali Acc: 0.405 Test Loss: 32.337 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.74215030670166
Epoch: 5, Steps: 34 | Train Loss: 13.504 Vali Loss: 11.050 Vali Acc: 0.601 Test Loss: 11.050 Test Acc: 0.601
Validation loss decreased (-0.433289 --> -0.601046).  Saving model ...
Epoch: 6 cost time: 25.932059049606323
Epoch: 6, Steps: 34 | Train Loss: 9.824 Vali Loss: 17.969 Vali Acc: 0.497 Test Loss: 17.969 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.151347398757935
Epoch: 7, Steps: 34 | Train Loss: 6.771 Vali Loss: 8.764 Vali Acc: 0.630 Test Loss: 8.764 Test Acc: 0.630
Validation loss decreased (-0.601046 --> -0.629970).  Saving model ...
Epoch: 8 cost time: 31.784969091415405
Epoch: 8, Steps: 34 | Train Loss: 3.827 Vali Loss: 13.739 Vali Acc: 0.549 Test Loss: 13.739 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.14790987968445
Epoch: 9, Steps: 34 | Train Loss: 3.313 Vali Loss: 5.685 Vali Acc: 0.723 Test Loss: 5.685 Test Acc: 0.723
Validation loss decreased (-0.629970 --> -0.722487).  Saving model ...
Epoch: 10 cost time: 30.56345844268799
Epoch: 10, Steps: 34 | Train Loss: 1.297 Vali Loss: 9.563 Vali Acc: 0.624 Test Loss: 9.563 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 28.516114234924316
Epoch: 11, Steps: 34 | Train Loss: 2.973 Vali Loss: 6.250 Vali Acc: 0.757 Test Loss: 6.250 Test Acc: 0.757
Validation loss decreased (-0.722487 --> -0.757163).  Saving model ...
Epoch: 12 cost time: 29.02948236465454
Epoch: 12, Steps: 34 | Train Loss: 4.318 Vali Loss: 11.680 Vali Acc: 0.682 Test Loss: 11.680 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 28.86713433265686
Epoch: 13, Steps: 34 | Train Loss: 2.181 Vali Loss: 19.636 Vali Acc: 0.543 Test Loss: 19.636 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 28.996126413345337
Epoch: 14, Steps: 34 | Train Loss: 4.425 Vali Loss: 4.434 Vali Acc: 0.775 Test Loss: 4.434 Test Acc: 0.775
Validation loss decreased (-0.757163 --> -0.774522).  Saving model ...
Epoch: 15 cost time: 27.978179454803467
Epoch: 15, Steps: 34 | Train Loss: 2.190 Vali Loss: 15.299 Vali Acc: 0.671 Test Loss: 15.299 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 28.21998691558838
Epoch: 16, Steps: 34 | Train Loss: 1.648 Vali Loss: 10.631 Vali Acc: 0.676 Test Loss: 10.631 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 27.884419918060303
Epoch: 17, Steps: 34 | Train Loss: 2.248 Vali Loss: 7.717 Vali Acc: 0.676 Test Loss: 7.717 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 27.741036653518677
Epoch: 18, Steps: 34 | Train Loss: 2.740 Vali Loss: 10.984 Vali Acc: 0.624 Test Loss: 10.984 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 26.748927354812622
Epoch: 19, Steps: 34 | Train Loss: 2.402 Vali Loss: 10.015 Vali Acc: 0.694 Test Loss: 10.015 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 30.159864902496338
Epoch: 20, Steps: 34 | Train Loss: 3.869 Vali Loss: 18.598 Vali Acc: 0.624 Test Loss: 18.598 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 29.773120880126953
Epoch: 21, Steps: 34 | Train Loss: 6.098 Vali Loss: 11.069 Vali Acc: 0.671 Test Loss: 11.069 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 29.471184492111206
Epoch: 22, Steps: 34 | Train Loss: 16.750 Vali Loss: 23.902 Vali Acc: 0.156 Test Loss: 23.902 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 30.673847436904907
Epoch: 23, Steps: 34 | Train Loss: 41.471 Vali Loss: 31.229 Vali Acc: 0.127 Test Loss: 31.229 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 28.265784978866577
Epoch: 24, Steps: 34 | Train Loss: 25.377 Vali Loss: 31.081 Vali Acc: 0.145 Test Loss: 31.081 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 17121091
model size : 70.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 31.07850217819214
Epoch: 1, Steps: 34 | Train Loss: 5.034 Vali Loss: 9.406 Vali Acc: 0.462 Test Loss: 9.406 Test Acc: 0.462
Validation loss decreased (inf --> -0.462334).  Saving model ...
Epoch: 2 cost time: 27.73226523399353
Epoch: 2, Steps: 34 | Train Loss: 12.885 Vali Loss: 13.062 Vali Acc: 0.376 Test Loss: 13.062 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.977914333343506
Epoch: 3, Steps: 34 | Train Loss: 15.610 Vali Loss: 16.192 Vali Acc: 0.480 Test Loss: 16.192 Test Acc: 0.480
Validation loss decreased (-0.462334 --> -0.479607).  Saving model ...
Epoch: 4 cost time: 29.561022520065308
Epoch: 4, Steps: 34 | Train Loss: 9.362 Vali Loss: 11.756 Vali Acc: 0.445 Test Loss: 11.756 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.919893980026245
Epoch: 5, Steps: 34 | Train Loss: 13.177 Vali Loss: 13.572 Vali Acc: 0.422 Test Loss: 13.572 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.721671104431152
Epoch: 6, Steps: 34 | Train Loss: 6.987 Vali Loss: 14.389 Vali Acc: 0.405 Test Loss: 14.389 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.586356163024902
Epoch: 7, Steps: 34 | Train Loss: 7.993 Vali Loss: 2.413 Vali Acc: 0.803 Test Loss: 2.413 Test Acc: 0.803
Validation loss decreased (-0.479607 --> -0.803444).  Saving model ...
Epoch: 8 cost time: 29.58278465270996
Epoch: 8, Steps: 34 | Train Loss: 7.357 Vali Loss: 6.203 Vali Acc: 0.676 Test Loss: 6.203 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.675713300704956
Epoch: 9, Steps: 34 | Train Loss: 8.430 Vali Loss: 11.724 Vali Acc: 0.642 Test Loss: 11.724 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 30.61050534248352
Epoch: 10, Steps: 34 | Train Loss: 4.927 Vali Loss: 5.846 Vali Acc: 0.694 Test Loss: 5.846 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 28.6900053024292
Epoch: 11, Steps: 34 | Train Loss: 4.688 Vali Loss: 8.955 Vali Acc: 0.682 Test Loss: 8.955 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 27.54027795791626
Epoch: 12, Steps: 34 | Train Loss: 2.249 Vali Loss: 10.241 Vali Acc: 0.746 Test Loss: 10.241 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 30.226979732513428
Epoch: 13, Steps: 34 | Train Loss: 2.682 Vali Loss: 7.549 Vali Acc: 0.746 Test Loss: 7.549 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 28.620627880096436
Epoch: 14, Steps: 34 | Train Loss: 3.016 Vali Loss: 5.398 Vali Acc: 0.751 Test Loss: 5.398 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 28.834134578704834
Epoch: 15, Steps: 34 | Train Loss: 0.966 Vali Loss: 10.450 Vali Acc: 0.803 Test Loss: 10.450 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 27.704043865203857
Epoch: 16, Steps: 34 | Train Loss: 1.255 Vali Loss: 13.517 Vali Acc: 0.711 Test Loss: 13.517 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 29.091548681259155
Epoch: 17, Steps: 34 | Train Loss: 3.295 Vali Loss: 32.227 Vali Acc: 0.624 Test Loss: 32.227 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 16547779
model size : 68.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 33.980834007263184
Epoch: 1, Steps: 34 | Train Loss: 6.460 Vali Loss: 7.805 Vali Acc: 0.364 Test Loss: 7.805 Test Acc: 0.364
Validation loss decreased (inf --> -0.364084).  Saving model ...
Epoch: 2 cost time: 31.66537570953369
Epoch: 2, Steps: 34 | Train Loss: 10.292 Vali Loss: 19.655 Vali Acc: 0.312 Test Loss: 19.655 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.849448204040527
Epoch: 3, Steps: 34 | Train Loss: 16.340 Vali Loss: 29.603 Vali Acc: 0.434 Test Loss: 29.603 Test Acc: 0.434
Validation loss decreased (-0.364084 --> -0.433230).  Saving model ...
Epoch: 4 cost time: 28.76871109008789
Epoch: 4, Steps: 34 | Train Loss: 18.547 Vali Loss: 18.166 Vali Acc: 0.457 Test Loss: 18.166 Test Acc: 0.457
Validation loss decreased (-0.433230 --> -0.456466).  Saving model ...
Epoch: 5 cost time: 28.89820694923401
Epoch: 5, Steps: 34 | Train Loss: 8.789 Vali Loss: 11.118 Vali Acc: 0.601 Test Loss: 11.118 Test Acc: 0.601
Validation loss decreased (-0.456466 --> -0.601045).  Saving model ...
Epoch: 6 cost time: 26.643744945526123
Epoch: 6, Steps: 34 | Train Loss: 6.681 Vali Loss: 10.195 Vali Acc: 0.653 Test Loss: 10.195 Test Acc: 0.653
Validation loss decreased (-0.601045 --> -0.653077).  Saving model ...
Epoch: 7 cost time: 27.467515230178833
Epoch: 7, Steps: 34 | Train Loss: 4.281 Vali Loss: 6.067 Vali Acc: 0.699 Test Loss: 6.067 Test Acc: 0.699
Validation loss decreased (-0.653077 --> -0.699361).  Saving model ...
Epoch: 8 cost time: 27.47325038909912
Epoch: 8, Steps: 34 | Train Loss: 5.962 Vali Loss: 9.198 Vali Acc: 0.694 Test Loss: 9.198 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.701585054397583
Epoch: 9, Steps: 34 | Train Loss: 5.498 Vali Loss: 29.822 Vali Acc: 0.601 Test Loss: 29.822 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 29.264933824539185
Epoch: 10, Steps: 34 | Train Loss: 7.242 Vali Loss: 14.251 Vali Acc: 0.578 Test Loss: 14.251 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 28.20894956588745
Epoch: 11, Steps: 34 | Train Loss: 4.667 Vali Loss: 6.370 Vali Acc: 0.775 Test Loss: 6.370 Test Acc: 0.775
Validation loss decreased (-0.699361 --> -0.774503).  Saving model ...
Epoch: 12 cost time: 27.940171718597412
Epoch: 12, Steps: 34 | Train Loss: 3.333 Vali Loss: 16.498 Vali Acc: 0.711 Test Loss: 16.498 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 29.425851345062256
Epoch: 13, Steps: 34 | Train Loss: 2.953 Vali Loss: 8.177 Vali Acc: 0.769 Test Loss: 8.177 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 31.179542064666748
Epoch: 14, Steps: 34 | Train Loss: 3.096 Vali Loss: 33.187 Vali Acc: 0.607 Test Loss: 33.187 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 29.533294200897217
Epoch: 15, Steps: 34 | Train Loss: 5.002 Vali Loss: 25.779 Vali Acc: 0.538 Test Loss: 25.779 Test Acc: 0.538
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 29.337334632873535
Epoch: 16, Steps: 34 | Train Loss: 2.766 Vali Loss: 11.245 Vali Acc: 0.751 Test Loss: 11.245 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 28.399478912353516
Epoch: 17, Steps: 34 | Train Loss: 2.206 Vali Loss: 10.191 Vali Acc: 0.769 Test Loss: 10.191 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 29.666520357131958
Epoch: 18, Steps: 34 | Train Loss: 1.427 Vali Loss: 7.061 Vali Acc: 0.844 Test Loss: 7.061 Test Acc: 0.844
Validation loss decreased (-0.774503 --> -0.843860).  Saving model ...
Epoch: 19 cost time: 27.694897413253784
Epoch: 19, Steps: 34 | Train Loss: 3.346 Vali Loss: 8.031 Vali Acc: 0.763 Test Loss: 8.031 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 29.0373637676239
Epoch: 20, Steps: 34 | Train Loss: 4.466 Vali Loss: 11.695 Vali Acc: 0.809 Test Loss: 11.695 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 28.355475902557373
Epoch: 21, Steps: 34 | Train Loss: 1.476 Vali Loss: 13.604 Vali Acc: 0.780 Test Loss: 13.604 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 28.973971605300903
Epoch: 22, Steps: 34 | Train Loss: 1.662 Vali Loss: 10.126 Vali Acc: 0.740 Test Loss: 10.126 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 28.0440354347229
Epoch: 23, Steps: 34 | Train Loss: 2.056 Vali Loss: 8.252 Vali Acc: 0.821 Test Loss: 8.252 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 28.28380584716797
Epoch: 24, Steps: 34 | Train Loss: 2.014 Vali Loss: 10.808 Vali Acc: 0.798 Test Loss: 10.808 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 29.564675331115723
Epoch: 25, Steps: 34 | Train Loss: 1.700 Vali Loss: 15.925 Vali Acc: 0.676 Test Loss: 15.925 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 28.424280643463135
Epoch: 26, Steps: 34 | Train Loss: 2.454 Vali Loss: 64.385 Vali Acc: 0.647 Test Loss: 64.385 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 27.881123542785645
Epoch: 27, Steps: 34 | Train Loss: 16.299 Vali Loss: 68.708 Vali Acc: 0.139 Test Loss: 68.708 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 32.65998458862305
Epoch: 28, Steps: 34 | Train Loss: 26.750 Vali Loss: 35.960 Vali Acc: 0.318 Test Loss: 35.960 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 16541891
model size : 68.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 28.53026032447815
Epoch: 1, Steps: 34 | Train Loss: 4.694 Vali Loss: 9.456 Vali Acc: 0.329 Test Loss: 9.456 Test Acc: 0.329
Validation loss decreased (inf --> -0.329385).  Saving model ...
Epoch: 2 cost time: 29.52688193321228
Epoch: 2, Steps: 34 | Train Loss: 17.416 Vali Loss: 18.530 Vali Acc: 0.422 Test Loss: 18.530 Test Acc: 0.422
Validation loss decreased (-0.329385 --> -0.421780).  Saving model ...
Epoch: 3 cost time: 30.936824798583984
Epoch: 3, Steps: 34 | Train Loss: 19.855 Vali Loss: 37.730 Vali Acc: 0.289 Test Loss: 37.730 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.526021718978882
Epoch: 4, Steps: 34 | Train Loss: 17.101 Vali Loss: 17.330 Vali Acc: 0.364 Test Loss: 17.330 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.36184787750244
Epoch: 5, Steps: 34 | Train Loss: 10.510 Vali Loss: 12.275 Vali Acc: 0.555 Test Loss: 12.275 Test Acc: 0.555
Validation loss decreased (-0.421780 --> -0.554791).  Saving model ...
Epoch: 6 cost time: 30.77593183517456
Epoch: 6, Steps: 34 | Train Loss: 8.733 Vali Loss: 9.776 Vali Acc: 0.607 Test Loss: 9.776 Test Acc: 0.607
Validation loss decreased (-0.554791 --> -0.606839).  Saving model ...
Epoch: 7 cost time: 29.613126039505005
Epoch: 7, Steps: 34 | Train Loss: 4.694 Vali Loss: 10.590 Vali Acc: 0.653 Test Loss: 10.590 Test Acc: 0.653
Validation loss decreased (-0.606839 --> -0.653073).  Saving model ...
Epoch: 8 cost time: 25.812512397766113
Epoch: 8, Steps: 34 | Train Loss: 3.775 Vali Loss: 6.228 Vali Acc: 0.694 Test Loss: 6.228 Test Acc: 0.694
Validation loss decreased (-0.653073 --> -0.693579).  Saving model ...
Epoch: 9 cost time: 29.722723960876465
Epoch: 9, Steps: 34 | Train Loss: 4.054 Vali Loss: 11.629 Vali Acc: 0.676 Test Loss: 11.629 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.79936981201172
Epoch: 10, Steps: 34 | Train Loss: 5.789 Vali Loss: 7.523 Vali Acc: 0.676 Test Loss: 7.523 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 31.346436977386475
Epoch: 11, Steps: 34 | Train Loss: 5.099 Vali Loss: 13.265 Vali Acc: 0.584 Test Loss: 13.265 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 31.19468641281128
Epoch: 12, Steps: 34 | Train Loss: 3.873 Vali Loss: 5.471 Vali Acc: 0.740 Test Loss: 5.471 Test Acc: 0.740
Validation loss decreased (-0.693579 --> -0.739830).  Saving model ...
Epoch: 13 cost time: 30.85964345932007
Epoch: 13, Steps: 34 | Train Loss: 2.956 Vali Loss: 7.119 Vali Acc: 0.665 Test Loss: 7.119 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 28.896794319152832
Epoch: 14, Steps: 34 | Train Loss: 2.941 Vali Loss: 5.843 Vali Acc: 0.746 Test Loss: 5.843 Test Acc: 0.746
Validation loss decreased (-0.739830 --> -0.745606).  Saving model ...
Epoch: 15 cost time: 29.988107204437256
Epoch: 15, Steps: 34 | Train Loss: 2.436 Vali Loss: 7.828 Vali Acc: 0.665 Test Loss: 7.828 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.148507833480835
Epoch: 16, Steps: 34 | Train Loss: 4.601 Vali Loss: 9.628 Vali Acc: 0.526 Test Loss: 9.628 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 29.831957817077637
Epoch: 17, Steps: 34 | Train Loss: 21.216 Vali Loss: 6.005 Vali Acc: 0.254 Test Loss: 6.005 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 28.612583875656128
Epoch: 18, Steps: 34 | Train Loss: 12.605 Vali Loss: 18.348 Vali Acc: 0.162 Test Loss: 18.348 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 29.493249893188477
Epoch: 19, Steps: 34 | Train Loss: 12.908 Vali Loss: 54.062 Vali Acc: 0.156 Test Loss: 54.062 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 27.719197273254395
Epoch: 20, Steps: 34 | Train Loss: 20.168 Vali Loss: 25.562 Vali Acc: 0.133 Test Loss: 25.562 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 28.489885568618774
Epoch: 21, Steps: 34 | Train Loss: 21.140 Vali Loss: 32.093 Vali Acc: 0.173 Test Loss: 32.093 Test Acc: 0.173
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 29.604354858398438
Epoch: 22, Steps: 34 | Train Loss: 15.335 Vali Loss: 32.714 Vali Acc: 0.150 Test Loss: 32.714 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 28.099287748336792
Epoch: 23, Steps: 34 | Train Loss: 12.551 Vali Loss: 19.481 Vali Acc: 0.127 Test Loss: 19.481 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 28.09191584587097
Epoch: 24, Steps: 34 | Train Loss: 13.961 Vali Loss: 20.980 Vali Acc: 0.145 Test Loss: 20.980 Test Acc: 0.145
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 16536003
model size : 68.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 31.53897523880005
Epoch: 1, Steps: 34 | Train Loss: 4.910 Vali Loss: 8.412 Vali Acc: 0.335 Test Loss: 8.412 Test Acc: 0.335
Validation loss decreased (inf --> -0.335176).  Saving model ...
Epoch: 2 cost time: 28.425881147384644
Epoch: 2, Steps: 34 | Train Loss: 9.271 Vali Loss: 22.678 Vali Acc: 0.324 Test Loss: 22.678 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.541711568832397
Epoch: 3, Steps: 34 | Train Loss: 20.476 Vali Loss: 24.726 Vali Acc: 0.457 Test Loss: 24.726 Test Acc: 0.457
Validation loss decreased (-0.335176 --> -0.456400).  Saving model ...
Epoch: 4 cost time: 28.980457067489624
Epoch: 4, Steps: 34 | Train Loss: 15.575 Vali Loss: 26.275 Vali Acc: 0.613 Test Loss: 26.275 Test Acc: 0.613
Validation loss decreased (-0.456400 --> -0.612454).  Saving model ...
Epoch: 5 cost time: 29.61863374710083
Epoch: 5, Steps: 34 | Train Loss: 13.119 Vali Loss: 10.830 Vali Acc: 0.590 Test Loss: 10.830 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.117584466934204
Epoch: 6, Steps: 34 | Train Loss: 11.545 Vali Loss: 19.074 Vali Acc: 0.543 Test Loss: 19.074 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 29.288848400115967
Epoch: 7, Steps: 34 | Train Loss: 9.894 Vali Loss: 21.702 Vali Acc: 0.538 Test Loss: 21.702 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 29.177630186080933
Epoch: 8, Steps: 34 | Train Loss: 4.812 Vali Loss: 12.293 Vali Acc: 0.584 Test Loss: 12.293 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.14815926551819
Epoch: 9, Steps: 34 | Train Loss: 4.576 Vali Loss: 9.711 Vali Acc: 0.728 Test Loss: 9.711 Test Acc: 0.728
Validation loss decreased (-0.612454 --> -0.728227).  Saving model ...
Epoch: 10 cost time: 28.682406425476074
Epoch: 10, Steps: 34 | Train Loss: 3.956 Vali Loss: 6.188 Vali Acc: 0.792 Test Loss: 6.188 Test Acc: 0.792
Validation loss decreased (-0.728227 --> -0.791846).  Saving model ...
Epoch: 11 cost time: 30.648317575454712
Epoch: 11, Steps: 34 | Train Loss: 2.771 Vali Loss: 6.649 Vali Acc: 0.694 Test Loss: 6.649 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.36876654624939
Epoch: 12, Steps: 34 | Train Loss: 3.321 Vali Loss: 6.487 Vali Acc: 0.780 Test Loss: 6.487 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 30.736796855926514
Epoch: 13, Steps: 34 | Train Loss: 2.449 Vali Loss: 3.509 Vali Acc: 0.821 Test Loss: 3.509 Test Acc: 0.821
Validation loss decreased (-0.791846 --> -0.820774).  Saving model ...
Epoch: 14 cost time: 31.27229070663452
Epoch: 14, Steps: 34 | Train Loss: 3.039 Vali Loss: 16.319 Vali Acc: 0.636 Test Loss: 16.319 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 28.90291690826416
Epoch: 15, Steps: 34 | Train Loss: 3.919 Vali Loss: 9.355 Vali Acc: 0.751 Test Loss: 9.355 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 27.7589750289917
Epoch: 16, Steps: 34 | Train Loss: 1.796 Vali Loss: 12.244 Vali Acc: 0.757 Test Loss: 12.244 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 26.781365156173706
Epoch: 17, Steps: 34 | Train Loss: 2.507 Vali Loss: 13.755 Vali Acc: 0.630 Test Loss: 13.755 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 28.421379327774048
Epoch: 18, Steps: 34 | Train Loss: 1.599 Vali Loss: 10.653 Vali Acc: 0.763 Test Loss: 10.653 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 27.96226215362549
Epoch: 19, Steps: 34 | Train Loss: 1.700 Vali Loss: 4.591 Vali Acc: 0.838 Test Loss: 4.591 Test Acc: 0.838
Validation loss decreased (-0.820774 --> -0.838104).  Saving model ...
Epoch: 20 cost time: 27.453369617462158
Epoch: 20, Steps: 34 | Train Loss: 1.899 Vali Loss: 11.760 Vali Acc: 0.728 Test Loss: 11.760 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 29.206443786621094
Epoch: 21, Steps: 34 | Train Loss: 0.425 Vali Loss: 11.695 Vali Acc: 0.671 Test Loss: 11.695 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 28.16546654701233
Epoch: 22, Steps: 34 | Train Loss: 3.440 Vali Loss: 8.902 Vali Acc: 0.803 Test Loss: 8.902 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 29.07539939880371
Epoch: 23, Steps: 34 | Train Loss: 1.506 Vali Loss: 6.782 Vali Acc: 0.757 Test Loss: 6.782 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 31.213128566741943
Epoch: 24, Steps: 34 | Train Loss: 1.206 Vali Loss: 15.868 Vali Acc: 0.676 Test Loss: 15.868 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 28.98212242126465
Epoch: 25, Steps: 34 | Train Loss: 3.227 Vali Loss: 23.984 Vali Acc: 0.549 Test Loss: 23.984 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 30.724904537200928
Epoch: 26, Steps: 34 | Train Loss: 5.490 Vali Loss: 72.137 Vali Acc: 0.173 Test Loss: 72.137 Test Acc: 0.173
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 28.773010969161987
Epoch: 27, Steps: 34 | Train Loss: 16.531 Vali Loss: 21.745 Vali Acc: 0.364 Test Loss: 21.745 Test Acc: 0.364
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 29.342352867126465
Epoch: 28, Steps: 34 | Train Loss: 31.530 Vali Loss: 38.469 Vali Acc: 0.173 Test Loss: 38.469 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 26.709474802017212
Epoch: 29, Steps: 34 | Train Loss: 31.697 Vali Loss: 28.937 Vali Acc: 0.116 Test Loss: 28.937 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 16530115
model size : 68.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 25.024917125701904
Epoch: 1, Steps: 34 | Train Loss: 3.519 Vali Loss: 2.576 Vali Acc: 0.347 Test Loss: 2.576 Test Acc: 0.347
Validation loss decreased (inf --> -0.346795).  Saving model ...
Epoch: 2 cost time: 22.4108943939209
Epoch: 2, Steps: 34 | Train Loss: 5.709 Vali Loss: 6.108 Vali Acc: 0.416 Test Loss: 6.108 Test Acc: 0.416
Validation loss decreased (-0.346795 --> -0.416124).  Saving model ...
Epoch: 3 cost time: 25.150861263275146
Epoch: 3, Steps: 34 | Train Loss: 5.580 Vali Loss: 12.358 Vali Acc: 0.370 Test Loss: 12.358 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.01426100730896
Epoch: 4, Steps: 34 | Train Loss: 9.175 Vali Loss: 14.627 Vali Acc: 0.503 Test Loss: 14.627 Test Acc: 0.503
Validation loss decreased (-0.416124 --> -0.502744).  Saving model ...
Epoch: 5 cost time: 22.33273458480835
Epoch: 5, Steps: 34 | Train Loss: 6.603 Vali Loss: 6.219 Vali Acc: 0.630 Test Loss: 6.219 Test Acc: 0.630
Validation loss decreased (-0.502744 --> -0.629996).  Saving model ...
Epoch: 6 cost time: 18.861133813858032
Epoch: 6, Steps: 34 | Train Loss: 5.072 Vali Loss: 7.198 Vali Acc: 0.699 Test Loss: 7.198 Test Acc: 0.699
Validation loss decreased (-0.629996 --> -0.699350).  Saving model ...
Epoch: 7 cost time: 22.274189233779907
Epoch: 7, Steps: 34 | Train Loss: 1.787 Vali Loss: 4.657 Vali Acc: 0.723 Test Loss: 4.657 Test Acc: 0.723
Validation loss decreased (-0.699350 --> -0.722497).  Saving model ...
Epoch: 8 cost time: 22.589056730270386
Epoch: 8, Steps: 34 | Train Loss: 1.922 Vali Loss: 7.335 Vali Acc: 0.671 Test Loss: 7.335 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.30054211616516
Epoch: 9, Steps: 34 | Train Loss: 2.501 Vali Loss: 4.637 Vali Acc: 0.775 Test Loss: 4.637 Test Acc: 0.775
Validation loss decreased (-0.722497 --> -0.774520).  Saving model ...
Epoch: 10 cost time: 26.39144730567932
Epoch: 10, Steps: 34 | Train Loss: 1.508 Vali Loss: 10.778 Vali Acc: 0.590 Test Loss: 10.778 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.9712016582489
Epoch: 11, Steps: 34 | Train Loss: 2.319 Vali Loss: 7.795 Vali Acc: 0.659 Test Loss: 7.795 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.91900610923767
Epoch: 12, Steps: 34 | Train Loss: 1.333 Vali Loss: 3.584 Vali Acc: 0.740 Test Loss: 3.584 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.693114757537842
Epoch: 13, Steps: 34 | Train Loss: 2.778 Vali Loss: 11.073 Vali Acc: 0.613 Test Loss: 11.073 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 25.337632417678833
Epoch: 14, Steps: 34 | Train Loss: 1.328 Vali Loss: 2.920 Vali Acc: 0.832 Test Loss: 2.920 Test Acc: 0.832
Validation loss decreased (-0.774520 --> -0.832341).  Saving model ...
Epoch: 15 cost time: 23.02657461166382
Epoch: 15, Steps: 34 | Train Loss: 2.034 Vali Loss: 5.711 Vali Acc: 0.688 Test Loss: 5.711 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 23.852730989456177
Epoch: 16, Steps: 34 | Train Loss: 1.108 Vali Loss: 11.310 Vali Acc: 0.607 Test Loss: 11.310 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 24.27174949645996
Epoch: 17, Steps: 34 | Train Loss: 0.946 Vali Loss: 5.656 Vali Acc: 0.694 Test Loss: 5.656 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 23.460773706436157
Epoch: 18, Steps: 34 | Train Loss: 0.442 Vali Loss: 7.222 Vali Acc: 0.740 Test Loss: 7.222 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 23.46449875831604
Epoch: 19, Steps: 34 | Train Loss: 0.557 Vali Loss: 7.560 Vali Acc: 0.757 Test Loss: 7.560 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 22.610392093658447
Epoch: 20, Steps: 34 | Train Loss: 1.126 Vali Loss: 6.107 Vali Acc: 0.769 Test Loss: 6.107 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 27.21975326538086
Epoch: 21, Steps: 34 | Train Loss: 0.561 Vali Loss: 6.141 Vali Acc: 0.798 Test Loss: 6.141 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 24.20439076423645
Epoch: 22, Steps: 34 | Train Loss: 0.752 Vali Loss: 6.561 Vali Acc: 0.786 Test Loss: 6.561 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 25.26707673072815
Epoch: 23, Steps: 34 | Train Loss: 0.823 Vali Loss: 7.344 Vali Acc: 0.728 Test Loss: 7.344 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 26.182512044906616
Epoch: 24, Steps: 34 | Train Loss: 0.951 Vali Loss: 8.049 Vali Acc: 0.780 Test Loss: 8.049 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7987651
model size : 33.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 24.085893392562866
Epoch: 1, Steps: 34 | Train Loss: 2.686 Vali Loss: 5.518 Vali Acc: 0.480 Test Loss: 5.518 Test Acc: 0.480
Validation loss decreased (inf --> -0.479714).  Saving model ...
Epoch: 2 cost time: 22.14793848991394
Epoch: 2, Steps: 34 | Train Loss: 6.069 Vali Loss: 7.888 Vali Acc: 0.266 Test Loss: 7.888 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.099651336669922
Epoch: 3, Steps: 34 | Train Loss: 7.834 Vali Loss: 10.626 Vali Acc: 0.405 Test Loss: 10.626 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.23420524597168
Epoch: 4, Steps: 34 | Train Loss: 6.583 Vali Loss: 6.123 Vali Acc: 0.491 Test Loss: 6.123 Test Acc: 0.491
Validation loss decreased (-0.479714 --> -0.491268).  Saving model ...
Epoch: 5 cost time: 22.13231611251831
Epoch: 5, Steps: 34 | Train Loss: 4.829 Vali Loss: 5.175 Vali Acc: 0.555 Test Loss: 5.175 Test Acc: 0.555
Validation loss decreased (-0.491268 --> -0.554862).  Saving model ...
Epoch: 6 cost time: 21.579325199127197
Epoch: 6, Steps: 34 | Train Loss: 4.824 Vali Loss: 4.233 Vali Acc: 0.711 Test Loss: 4.233 Test Acc: 0.711
Validation loss decreased (-0.554862 --> -0.710940).  Saving model ...
Epoch: 7 cost time: 24.391236543655396
Epoch: 7, Steps: 34 | Train Loss: 2.420 Vali Loss: 3.287 Vali Acc: 0.769 Test Loss: 3.287 Test Acc: 0.769
Validation loss decreased (-0.710940 --> -0.768753).  Saving model ...
Epoch: 8 cost time: 21.825217723846436
Epoch: 8, Steps: 34 | Train Loss: 2.745 Vali Loss: 5.052 Vali Acc: 0.607 Test Loss: 5.052 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.692967176437378
Epoch: 9, Steps: 34 | Train Loss: 2.962 Vali Loss: 7.799 Vali Acc: 0.636 Test Loss: 7.799 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.405796766281128
Epoch: 10, Steps: 34 | Train Loss: 1.929 Vali Loss: 5.932 Vali Acc: 0.705 Test Loss: 5.932 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.497841596603394
Epoch: 11, Steps: 34 | Train Loss: 0.868 Vali Loss: 7.915 Vali Acc: 0.699 Test Loss: 7.915 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.106754779815674
Epoch: 12, Steps: 34 | Train Loss: 1.216 Vali Loss: 5.490 Vali Acc: 0.769 Test Loss: 5.490 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 24.067026138305664
Epoch: 13, Steps: 34 | Train Loss: 1.118 Vali Loss: 5.527 Vali Acc: 0.769 Test Loss: 5.527 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 25.183070421218872
Epoch: 14, Steps: 34 | Train Loss: 0.594 Vali Loss: 5.165 Vali Acc: 0.769 Test Loss: 5.165 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.53193497657776
Epoch: 15, Steps: 34 | Train Loss: 1.972 Vali Loss: 4.407 Vali Acc: 0.786 Test Loss: 4.407 Test Acc: 0.786
Validation loss decreased (-0.768753 --> -0.786083).  Saving model ...
Epoch: 16 cost time: 22.71848225593567
Epoch: 16, Steps: 34 | Train Loss: 1.023 Vali Loss: 11.286 Vali Acc: 0.572 Test Loss: 11.286 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.843627452850342
Epoch: 17, Steps: 34 | Train Loss: 1.352 Vali Loss: 12.152 Vali Acc: 0.757 Test Loss: 12.152 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.285217761993408
Epoch: 18, Steps: 34 | Train Loss: 0.969 Vali Loss: 7.303 Vali Acc: 0.780 Test Loss: 7.303 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.164854526519775
Epoch: 19, Steps: 34 | Train Loss: 0.186 Vali Loss: 3.560 Vali Acc: 0.838 Test Loss: 3.560 Test Acc: 0.838
Validation loss decreased (-0.786083 --> -0.838115).  Saving model ...
Epoch: 20 cost time: 24.965471029281616
Epoch: 20, Steps: 34 | Train Loss: 0.713 Vali Loss: 8.614 Vali Acc: 0.780 Test Loss: 8.614 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.205970525741577
Epoch: 21, Steps: 34 | Train Loss: 1.365 Vali Loss: 8.927 Vali Acc: 0.786 Test Loss: 8.927 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 17.586652755737305
Epoch: 22, Steps: 34 | Train Loss: 0.355 Vali Loss: 6.076 Vali Acc: 0.769 Test Loss: 6.076 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 24.153111934661865
Epoch: 23, Steps: 34 | Train Loss: 0.420 Vali Loss: 8.049 Vali Acc: 0.780 Test Loss: 8.049 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.008562803268433
Epoch: 24, Steps: 34 | Train Loss: 0.632 Vali Loss: 8.900 Vali Acc: 0.746 Test Loss: 8.900 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.95467519760132
Epoch: 25, Steps: 34 | Train Loss: 0.292 Vali Loss: 8.235 Vali Acc: 0.699 Test Loss: 8.235 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 24.839258670806885
Epoch: 26, Steps: 34 | Train Loss: 1.296 Vali Loss: 11.874 Vali Acc: 0.647 Test Loss: 11.874 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 25.50492525100708
Epoch: 27, Steps: 34 | Train Loss: 1.963 Vali Loss: 8.930 Vali Acc: 0.694 Test Loss: 8.930 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 24.84222102165222
Epoch: 28, Steps: 34 | Train Loss: 2.196 Vali Loss: 8.758 Vali Acc: 0.780 Test Loss: 8.758 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 22.667773008346558
Epoch: 29, Steps: 34 | Train Loss: 0.716 Vali Loss: 7.890 Vali Acc: 0.775 Test Loss: 7.890 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 7984707
model size : 33.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 25.969533443450928
Epoch: 1, Steps: 34 | Train Loss: 3.201 Vali Loss: 7.177 Vali Acc: 0.312 Test Loss: 7.177 Test Acc: 0.312
Validation loss decreased (inf --> -0.312067).  Saving model ...
Epoch: 2 cost time: 23.538236141204834
Epoch: 2, Steps: 34 | Train Loss: 5.886 Vali Loss: 8.597 Vali Acc: 0.445 Test Loss: 8.597 Test Acc: 0.445
Validation loss decreased (-0.312067 --> -0.445001).  Saving model ...
Epoch: 3 cost time: 22.846574783325195
Epoch: 3, Steps: 34 | Train Loss: 9.683 Vali Loss: 3.918 Vali Acc: 0.566 Test Loss: 3.918 Test Acc: 0.566
Validation loss decreased (-0.445001 --> -0.566435).  Saving model ...
Epoch: 4 cost time: 24.140877723693848
Epoch: 4, Steps: 34 | Train Loss: 5.829 Vali Loss: 8.666 Vali Acc: 0.509 Test Loss: 8.666 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.194847583770752
Epoch: 5, Steps: 34 | Train Loss: 6.496 Vali Loss: 10.760 Vali Acc: 0.370 Test Loss: 10.760 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.411627531051636
Epoch: 6, Steps: 34 | Train Loss: 2.835 Vali Loss: 3.018 Vali Acc: 0.682 Test Loss: 3.018 Test Acc: 0.682
Validation loss decreased (-0.566435 --> -0.682051).  Saving model ...
Epoch: 7 cost time: 21.90748929977417
Epoch: 7, Steps: 34 | Train Loss: 2.241 Vali Loss: 5.906 Vali Acc: 0.520 Test Loss: 5.906 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.90255618095398
Epoch: 8, Steps: 34 | Train Loss: 2.916 Vali Loss: 4.752 Vali Acc: 0.647 Test Loss: 4.752 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.30667805671692
Epoch: 9, Steps: 34 | Train Loss: 2.239 Vali Loss: 5.040 Vali Acc: 0.642 Test Loss: 5.040 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.48624277114868
Epoch: 10, Steps: 34 | Train Loss: 1.266 Vali Loss: 6.216 Vali Acc: 0.671 Test Loss: 6.216 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.816913843154907
Epoch: 11, Steps: 34 | Train Loss: 1.758 Vali Loss: 7.486 Vali Acc: 0.665 Test Loss: 7.486 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 25.037142753601074
Epoch: 12, Steps: 34 | Train Loss: 1.355 Vali Loss: 4.193 Vali Acc: 0.763 Test Loss: 4.193 Test Acc: 0.763
Validation loss decreased (-0.682051 --> -0.762964).  Saving model ...
Epoch: 13 cost time: 24.12812304496765
Epoch: 13, Steps: 34 | Train Loss: 1.543 Vali Loss: 4.924 Vali Acc: 0.746 Test Loss: 4.924 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.9416606426239
Epoch: 14, Steps: 34 | Train Loss: 0.670 Vali Loss: 6.700 Vali Acc: 0.723 Test Loss: 6.700 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.14944887161255
Epoch: 15, Steps: 34 | Train Loss: 0.364 Vali Loss: 3.878 Vali Acc: 0.815 Test Loss: 3.878 Test Acc: 0.815
Validation loss decreased (-0.762964 --> -0.814990).  Saving model ...
Epoch: 16 cost time: 23.824864387512207
Epoch: 16, Steps: 34 | Train Loss: 0.788 Vali Loss: 8.034 Vali Acc: 0.653 Test Loss: 8.034 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 20.73498272895813
Epoch: 17, Steps: 34 | Train Loss: 1.301 Vali Loss: 8.352 Vali Acc: 0.671 Test Loss: 8.352 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.333232402801514
Epoch: 18, Steps: 34 | Train Loss: 0.741 Vali Loss: 4.955 Vali Acc: 0.740 Test Loss: 4.955 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.591113567352295
Epoch: 19, Steps: 34 | Train Loss: 0.556 Vali Loss: 4.787 Vali Acc: 0.728 Test Loss: 4.787 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.398469924926758
Epoch: 20, Steps: 34 | Train Loss: 0.407 Vali Loss: 4.601 Vali Acc: 0.775 Test Loss: 4.601 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.24154496192932
Epoch: 21, Steps: 34 | Train Loss: 0.878 Vali Loss: 3.445 Vali Acc: 0.769 Test Loss: 3.445 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.95493721961975
Epoch: 22, Steps: 34 | Train Loss: 0.972 Vali Loss: 4.404 Vali Acc: 0.711 Test Loss: 4.404 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 24.668710231781006
Epoch: 23, Steps: 34 | Train Loss: 1.038 Vali Loss: 3.804 Vali Acc: 0.827 Test Loss: 3.804 Test Acc: 0.827
Validation loss decreased (-0.814990 --> -0.826552).  Saving model ...
Epoch: 24 cost time: 24.10140585899353
Epoch: 24, Steps: 34 | Train Loss: 0.522 Vali Loss: 18.269 Vali Acc: 0.526 Test Loss: 18.269 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 24.83890128135681
Epoch: 25, Steps: 34 | Train Loss: 1.927 Vali Loss: 8.644 Vali Acc: 0.520 Test Loss: 8.644 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 22.7984459400177
Epoch: 26, Steps: 34 | Train Loss: 1.463 Vali Loss: 7.981 Vali Acc: 0.728 Test Loss: 7.981 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 24.49352765083313
Epoch: 27, Steps: 34 | Train Loss: 1.426 Vali Loss: 9.139 Vali Acc: 0.607 Test Loss: 9.139 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 20.912896871566772
Epoch: 28, Steps: 34 | Train Loss: 0.847 Vali Loss: 5.296 Vali Acc: 0.786 Test Loss: 5.296 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 22.36454200744629
Epoch: 29, Steps: 34 | Train Loss: 6.679 Vali Loss: 23.617 Vali Acc: 0.503 Test Loss: 23.617 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 23.97463345527649
Epoch: 30, Steps: 34 | Train Loss: 11.815 Vali Loss: 17.294 Vali Acc: 0.468 Test Loss: 17.294 Test Acc: 0.468
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 21.642341136932373
Epoch: 31, Steps: 34 | Train Loss: 20.627 Vali Loss: 16.505 Vali Acc: 0.133 Test Loss: 16.505 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 17.365347385406494
Epoch: 32, Steps: 34 | Train Loss: 13.588 Vali Loss: 12.302 Vali Acc: 0.116 Test Loss: 12.302 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 23.04641890525818
Epoch: 33, Steps: 34 | Train Loss: 8.987 Vali Loss: 21.034 Vali Acc: 0.225 Test Loss: 21.034 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7981763
model size : 33.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 23.657011032104492
Epoch: 1, Steps: 34 | Train Loss: 3.534 Vali Loss: 5.333 Vali Acc: 0.468 Test Loss: 5.333 Test Acc: 0.468
Validation loss decreased (inf --> -0.468155).  Saving model ...
Epoch: 2 cost time: 23.839322566986084
Epoch: 2, Steps: 34 | Train Loss: 6.183 Vali Loss: 8.008 Vali Acc: 0.382 Test Loss: 8.008 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.474173545837402
Epoch: 3, Steps: 34 | Train Loss: 5.715 Vali Loss: 7.205 Vali Acc: 0.410 Test Loss: 7.205 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.702561855316162
Epoch: 4, Steps: 34 | Train Loss: 6.231 Vali Loss: 6.982 Vali Acc: 0.422 Test Loss: 6.982 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.398327589035034
Epoch: 5, Steps: 34 | Train Loss: 4.795 Vali Loss: 8.789 Vali Acc: 0.439 Test Loss: 8.789 Test Acc: 0.439
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.4683620929718
Epoch: 6, Steps: 34 | Train Loss: 6.073 Vali Loss: 11.912 Vali Acc: 0.509 Test Loss: 11.912 Test Acc: 0.509
Validation loss decreased (-0.468155 --> -0.508551).  Saving model ...
Epoch: 7 cost time: 25.294826984405518
Epoch: 7, Steps: 34 | Train Loss: 4.883 Vali Loss: 5.540 Vali Acc: 0.555 Test Loss: 5.540 Test Acc: 0.555
Validation loss decreased (-0.508551 --> -0.554858).  Saving model ...
Epoch: 8 cost time: 23.2238712310791
Epoch: 8, Steps: 34 | Train Loss: 2.031 Vali Loss: 2.219 Vali Acc: 0.757 Test Loss: 2.219 Test Acc: 0.757
Validation loss decreased (-0.554858 --> -0.757203).  Saving model ...
Epoch: 9 cost time: 22.47409439086914
Epoch: 9, Steps: 34 | Train Loss: 0.861 Vali Loss: 3.676 Vali Acc: 0.757 Test Loss: 3.676 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.573580980300903
Epoch: 10, Steps: 34 | Train Loss: 1.955 Vali Loss: 4.810 Vali Acc: 0.769 Test Loss: 4.810 Test Acc: 0.769
Validation loss decreased (-0.757203 --> -0.768738).  Saving model ...
Epoch: 11 cost time: 23.872873067855835
Epoch: 11, Steps: 34 | Train Loss: 2.219 Vali Loss: 7.566 Vali Acc: 0.665 Test Loss: 7.566 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.593855142593384
Epoch: 12, Steps: 34 | Train Loss: 3.122 Vali Loss: 6.414 Vali Acc: 0.665 Test Loss: 6.414 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.365857124328613
Epoch: 13, Steps: 34 | Train Loss: 0.709 Vali Loss: 3.669 Vali Acc: 0.769 Test Loss: 3.669 Test Acc: 0.769
Validation loss decreased (-0.768738 --> -0.768749).  Saving model ...
Epoch: 14 cost time: 23.696589469909668
Epoch: 14, Steps: 34 | Train Loss: 1.350 Vali Loss: 5.635 Vali Acc: 0.676 Test Loss: 5.635 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.0051429271698
Epoch: 15, Steps: 34 | Train Loss: 1.295 Vali Loss: 4.118 Vali Acc: 0.792 Test Loss: 4.118 Test Acc: 0.792
Validation loss decreased (-0.768749 --> -0.791866).  Saving model ...
Epoch: 16 cost time: 20.62833261489868
Epoch: 16, Steps: 34 | Train Loss: 0.110 Vali Loss: 6.107 Vali Acc: 0.769 Test Loss: 6.107 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.741350889205933
Epoch: 17, Steps: 34 | Train Loss: 0.684 Vali Loss: 7.455 Vali Acc: 0.711 Test Loss: 7.455 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.18493914604187
Epoch: 18, Steps: 34 | Train Loss: 0.667 Vali Loss: 9.702 Vali Acc: 0.642 Test Loss: 9.702 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.422181844711304
Epoch: 19, Steps: 34 | Train Loss: 0.482 Vali Loss: 5.224 Vali Acc: 0.751 Test Loss: 5.224 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.191861629486084
Epoch: 20, Steps: 34 | Train Loss: 0.573 Vali Loss: 6.931 Vali Acc: 0.769 Test Loss: 6.931 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.37634801864624
Epoch: 21, Steps: 34 | Train Loss: 0.541 Vali Loss: 6.219 Vali Acc: 0.780 Test Loss: 6.219 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.12113332748413
Epoch: 22, Steps: 34 | Train Loss: 1.187 Vali Loss: 8.661 Vali Acc: 0.751 Test Loss: 8.661 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 21.201984405517578
Epoch: 23, Steps: 34 | Train Loss: 1.002 Vali Loss: 6.413 Vali Acc: 0.728 Test Loss: 6.413 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 25.629345655441284
Epoch: 24, Steps: 34 | Train Loss: 0.959 Vali Loss: 14.178 Vali Acc: 0.572 Test Loss: 14.178 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 20.148289680480957
Epoch: 25, Steps: 34 | Train Loss: 2.706 Vali Loss: 18.855 Vali Acc: 0.491 Test Loss: 18.855 Test Acc: 0.491
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 7978819
model size : 33.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.368433475494385
Epoch: 1, Steps: 34 | Train Loss: 4.598 Vali Loss: 6.142 Vali Acc: 0.249 Test Loss: 6.142 Test Acc: 0.249
Validation loss decreased (inf --> -0.248493).  Saving model ...
Epoch: 2 cost time: 22.395056009292603
Epoch: 2, Steps: 34 | Train Loss: 5.242 Vali Loss: 3.697 Vali Acc: 0.462 Test Loss: 3.697 Test Acc: 0.462
Validation loss decreased (-0.248493 --> -0.462391).  Saving model ...
Epoch: 3 cost time: 19.85525417327881
Epoch: 3, Steps: 34 | Train Loss: 6.607 Vali Loss: 14.688 Vali Acc: 0.341 Test Loss: 14.688 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.279551029205322
Epoch: 4, Steps: 34 | Train Loss: 7.283 Vali Loss: 6.456 Vali Acc: 0.607 Test Loss: 6.456 Test Acc: 0.607
Validation loss decreased (-0.462391 --> -0.606872).  Saving model ...
Epoch: 5 cost time: 19.5523362159729
Epoch: 5, Steps: 34 | Train Loss: 7.562 Vali Loss: 7.221 Vali Acc: 0.607 Test Loss: 7.221 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.247077465057373
Epoch: 6, Steps: 34 | Train Loss: 5.816 Vali Loss: 7.069 Vali Acc: 0.561 Test Loss: 7.069 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.748416423797607
Epoch: 7, Steps: 34 | Train Loss: 2.155 Vali Loss: 5.908 Vali Acc: 0.746 Test Loss: 5.908 Test Acc: 0.746
Validation loss decreased (-0.606872 --> -0.745606).  Saving model ...
Epoch: 8 cost time: 21.93204355239868
Epoch: 8, Steps: 34 | Train Loss: 2.370 Vali Loss: 15.221 Vali Acc: 0.434 Test Loss: 15.221 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.822881937026978
Epoch: 9, Steps: 34 | Train Loss: 4.104 Vali Loss: 4.632 Vali Acc: 0.786 Test Loss: 4.632 Test Acc: 0.786
Validation loss decreased (-0.745606 --> -0.786081).  Saving model ...
Epoch: 10 cost time: 19.216146230697632
Epoch: 10, Steps: 34 | Train Loss: 1.481 Vali Loss: 10.077 Vali Acc: 0.647 Test Loss: 10.077 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.754403829574585
Epoch: 11, Steps: 34 | Train Loss: 2.128 Vali Loss: 3.980 Vali Acc: 0.815 Test Loss: 3.980 Test Acc: 0.815
Validation loss decreased (-0.786081 --> -0.814989).  Saving model ...
Epoch: 12 cost time: 22.70780301094055
Epoch: 12, Steps: 34 | Train Loss: 0.743 Vali Loss: 5.624 Vali Acc: 0.763 Test Loss: 5.624 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.215974807739258
Epoch: 13, Steps: 34 | Train Loss: 0.673 Vali Loss: 9.333 Vali Acc: 0.659 Test Loss: 9.333 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 21.41392421722412
Epoch: 14, Steps: 34 | Train Loss: 1.444 Vali Loss: 7.363 Vali Acc: 0.688 Test Loss: 7.363 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.094100952148438
Epoch: 15, Steps: 34 | Train Loss: 1.119 Vali Loss: 5.968 Vali Acc: 0.717 Test Loss: 5.968 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.258460760116577
Epoch: 16, Steps: 34 | Train Loss: 2.509 Vali Loss: 9.150 Vali Acc: 0.740 Test Loss: 9.150 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.157690048217773
Epoch: 17, Steps: 34 | Train Loss: 2.525 Vali Loss: 6.581 Vali Acc: 0.746 Test Loss: 6.581 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.845624208450317
Epoch: 18, Steps: 34 | Train Loss: 1.331 Vali Loss: 9.475 Vali Acc: 0.780 Test Loss: 9.475 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 20.885003805160522
Epoch: 19, Steps: 34 | Train Loss: 1.988 Vali Loss: 4.269 Vali Acc: 0.798 Test Loss: 4.269 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.17950677871704
Epoch: 20, Steps: 34 | Train Loss: 0.570 Vali Loss: 4.218 Vali Acc: 0.786 Test Loss: 4.218 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 22.74199676513672
Epoch: 21, Steps: 34 | Train Loss: 0.146 Vali Loss: 8.265 Vali Acc: 0.699 Test Loss: 8.265 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 6803395
model size : 28.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.413439512252808
Epoch: 1, Steps: 34 | Train Loss: 3.898 Vali Loss: 10.453 Vali Acc: 0.335 Test Loss: 10.453 Test Acc: 0.335
Validation loss decreased (inf --> -0.335156).  Saving model ...
Epoch: 2 cost time: 15.070525407791138
Epoch: 2, Steps: 34 | Train Loss: 7.718 Vali Loss: 7.373 Vali Acc: 0.439 Test Loss: 7.373 Test Acc: 0.439
Validation loss decreased (-0.335156 --> -0.439233).  Saving model ...
Epoch: 3 cost time: 24.471637964248657
Epoch: 3, Steps: 34 | Train Loss: 5.654 Vali Loss: 7.012 Vali Acc: 0.451 Test Loss: 7.012 Test Acc: 0.451
Validation loss decreased (-0.439233 --> -0.450797).  Saving model ...
Epoch: 4 cost time: 23.673843383789062
Epoch: 4, Steps: 34 | Train Loss: 7.030 Vali Loss: 10.598 Vali Acc: 0.364 Test Loss: 10.598 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.724766969680786
Epoch: 5, Steps: 34 | Train Loss: 4.618 Vali Loss: 3.566 Vali Acc: 0.751 Test Loss: 3.566 Test Acc: 0.751
Validation loss decreased (-0.450797 --> -0.751409).  Saving model ...
Epoch: 6 cost time: 22.11720895767212
Epoch: 6, Steps: 34 | Train Loss: 3.071 Vali Loss: 2.327 Vali Acc: 0.711 Test Loss: 2.327 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.99142551422119
Epoch: 7, Steps: 34 | Train Loss: 2.453 Vali Loss: 4.319 Vali Acc: 0.699 Test Loss: 4.319 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.687803030014038
Epoch: 8, Steps: 34 | Train Loss: 2.490 Vali Loss: 8.212 Vali Acc: 0.642 Test Loss: 8.212 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.037031173706055
Epoch: 9, Steps: 34 | Train Loss: 1.130 Vali Loss: 26.909 Vali Acc: 0.607 Test Loss: 26.909 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.560883283615112
Epoch: 10, Steps: 34 | Train Loss: 4.764 Vali Loss: 5.976 Vali Acc: 0.665 Test Loss: 5.976 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.395591020584106
Epoch: 11, Steps: 34 | Train Loss: 1.523 Vali Loss: 13.385 Vali Acc: 0.584 Test Loss: 13.385 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.490984678268433
Epoch: 12, Steps: 34 | Train Loss: 1.105 Vali Loss: 6.854 Vali Acc: 0.769 Test Loss: 6.854 Test Acc: 0.769
Validation loss decreased (-0.751409 --> -0.768718).  Saving model ...
Epoch: 13 cost time: 19.862289428710938
Epoch: 13, Steps: 34 | Train Loss: 1.868 Vali Loss: 5.123 Vali Acc: 0.751 Test Loss: 5.123 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.250951290130615
Epoch: 14, Steps: 34 | Train Loss: 0.989 Vali Loss: 4.799 Vali Acc: 0.803 Test Loss: 4.799 Test Acc: 0.803
Validation loss decreased (-0.768718 --> -0.803420).  Saving model ...
Epoch: 15 cost time: 16.471150398254395
Epoch: 15, Steps: 34 | Train Loss: 0.966 Vali Loss: 6.521 Vali Acc: 0.734 Test Loss: 6.521 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.177208423614502
Epoch: 16, Steps: 34 | Train Loss: 1.010 Vali Loss: 6.652 Vali Acc: 0.780 Test Loss: 6.652 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.61767315864563
Epoch: 17, Steps: 34 | Train Loss: 0.946 Vali Loss: 5.973 Vali Acc: 0.775 Test Loss: 5.973 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.82114291191101
Epoch: 18, Steps: 34 | Train Loss: 1.206 Vali Loss: 6.739 Vali Acc: 0.769 Test Loss: 6.739 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.133095264434814
Epoch: 19, Steps: 34 | Train Loss: 0.240 Vali Loss: 6.428 Vali Acc: 0.757 Test Loss: 6.428 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 20.422637224197388
Epoch: 20, Steps: 34 | Train Loss: 2.866 Vali Loss: 4.019 Vali Acc: 0.780 Test Loss: 4.019 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 19.778449296951294
Epoch: 21, Steps: 34 | Train Loss: 0.884 Vali Loss: 4.516 Vali Acc: 0.798 Test Loss: 4.516 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 19.003906965255737
Epoch: 22, Steps: 34 | Train Loss: 0.384 Vali Loss: 4.874 Vali Acc: 0.838 Test Loss: 4.874 Test Acc: 0.838
Validation loss decreased (-0.803420 --> -0.838102).  Saving model ...
Epoch: 23 cost time: 19.34570598602295
Epoch: 23, Steps: 34 | Train Loss: 0.922 Vali Loss: 6.959 Vali Acc: 0.815 Test Loss: 6.959 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 17.82277226448059
Epoch: 24, Steps: 34 | Train Loss: 0.501 Vali Loss: 2.483 Vali Acc: 0.838 Test Loss: 2.483 Test Acc: 0.838
Validation loss decreased (-0.838102 --> -0.838125).  Saving model ...
Epoch: 25 cost time: 17.909209728240967
Epoch: 25, Steps: 34 | Train Loss: 0.452 Vali Loss: 7.191 Vali Acc: 0.763 Test Loss: 7.191 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 20.751624584197998
Epoch: 26, Steps: 34 | Train Loss: 0.631 Vali Loss: 4.563 Vali Acc: 0.792 Test Loss: 4.563 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 20.057176113128662
Epoch: 27, Steps: 34 | Train Loss: 0.380 Vali Loss: 5.828 Vali Acc: 0.786 Test Loss: 5.828 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 16.091828107833862
Epoch: 28, Steps: 34 | Train Loss: 0.590 Vali Loss: 11.011 Vali Acc: 0.769 Test Loss: 11.011 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 21.020325660705566
Epoch: 29, Steps: 34 | Train Loss: 0.998 Vali Loss: 12.150 Vali Acc: 0.751 Test Loss: 12.150 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 18.184112071990967
Epoch: 30, Steps: 34 | Train Loss: 0.982 Vali Loss: 7.677 Vali Acc: 0.728 Test Loss: 7.677 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 19.699506521224976
Epoch: 31, Steps: 34 | Train Loss: 0.078 Vali Loss: 8.732 Vali Acc: 0.717 Test Loss: 8.732 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 21.426389455795288
Epoch: 32, Steps: 34 | Train Loss: 1.734 Vali Loss: 17.456 Vali Acc: 0.676 Test Loss: 17.456 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 16.74968147277832
Epoch: 33, Steps: 34 | Train Loss: 1.189 Vali Loss: 13.265 Vali Acc: 0.694 Test Loss: 13.265 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 18.72055411338806
Epoch: 34, Steps: 34 | Train Loss: 0.948 Vali Loss: 8.061 Vali Acc: 0.705 Test Loss: 8.061 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6800451
model size : 28.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.68842363357544
Epoch: 1, Steps: 34 | Train Loss: 4.336 Vali Loss: 10.330 Vali Acc: 0.116 Test Loss: 10.330 Test Acc: 0.116
Validation loss decreased (inf --> -0.115504).  Saving model ...
Epoch: 2 cost time: 18.38897681236267
Epoch: 2, Steps: 34 | Train Loss: 4.343 Vali Loss: 6.874 Vali Acc: 0.439 Test Loss: 6.874 Test Acc: 0.439
Validation loss decreased (-0.115504 --> -0.439238).  Saving model ...
Epoch: 3 cost time: 14.40729308128357
Epoch: 3, Steps: 34 | Train Loss: 6.695 Vali Loss: 8.545 Vali Acc: 0.416 Test Loss: 8.545 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.777080774307251
Epoch: 4, Steps: 34 | Train Loss: 7.736 Vali Loss: 12.204 Vali Acc: 0.532 Test Loss: 12.204 Test Acc: 0.532
Validation loss decreased (-0.439238 --> -0.531670).  Saving model ...
Epoch: 5 cost time: 16.19289994239807
Epoch: 5, Steps: 34 | Train Loss: 5.677 Vali Loss: 8.955 Vali Acc: 0.457 Test Loss: 8.955 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.648961067199707
Epoch: 6, Steps: 34 | Train Loss: 4.003 Vali Loss: 6.702 Vali Acc: 0.642 Test Loss: 6.702 Test Acc: 0.642
Validation loss decreased (-0.531670 --> -0.641551).  Saving model ...
Epoch: 7 cost time: 15.342406988143921
Epoch: 7, Steps: 34 | Train Loss: 2.610 Vali Loss: 3.857 Vali Acc: 0.711 Test Loss: 3.857 Test Acc: 0.711
Validation loss decreased (-0.641551 --> -0.710944).  Saving model ...
Epoch: 8 cost time: 14.20505976676941
Epoch: 8, Steps: 34 | Train Loss: 6.652 Vali Loss: 13.230 Vali Acc: 0.636 Test Loss: 13.230 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.507633924484253
Epoch: 9, Steps: 34 | Train Loss: 6.203 Vali Loss: 12.247 Vali Acc: 0.595 Test Loss: 12.247 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.09721064567566
Epoch: 10, Steps: 34 | Train Loss: 5.727 Vali Loss: 7.766 Vali Acc: 0.618 Test Loss: 7.766 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.793991088867188
Epoch: 11, Steps: 34 | Train Loss: 2.502 Vali Loss: 9.776 Vali Acc: 0.601 Test Loss: 9.776 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.09790563583374
Epoch: 12, Steps: 34 | Train Loss: 1.758 Vali Loss: 7.051 Vali Acc: 0.711 Test Loss: 7.051 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.786298274993896
Epoch: 13, Steps: 34 | Train Loss: 0.487 Vali Loss: 7.517 Vali Acc: 0.751 Test Loss: 7.517 Test Acc: 0.751
Validation loss decreased (-0.710944 --> -0.751370).  Saving model ...
Epoch: 14 cost time: 14.512179851531982
Epoch: 14, Steps: 34 | Train Loss: 1.302 Vali Loss: 5.003 Vali Acc: 0.786 Test Loss: 5.003 Test Acc: 0.786
Validation loss decreased (-0.751370 --> -0.786077).  Saving model ...
Epoch: 15 cost time: 15.14104413986206
Epoch: 15, Steps: 34 | Train Loss: 0.104 Vali Loss: 5.650 Vali Acc: 0.786 Test Loss: 5.650 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.677993774414062
Epoch: 16, Steps: 34 | Train Loss: 0.308 Vali Loss: 4.542 Vali Acc: 0.775 Test Loss: 4.542 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.146124124526978
Epoch: 17, Steps: 34 | Train Loss: 0.511 Vali Loss: 11.227 Vali Acc: 0.659 Test Loss: 11.227 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 18.511051416397095
Epoch: 18, Steps: 34 | Train Loss: 1.524 Vali Loss: 9.881 Vali Acc: 0.734 Test Loss: 9.881 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 19.200279712677002
Epoch: 19, Steps: 34 | Train Loss: 0.733 Vali Loss: 4.395 Vali Acc: 0.827 Test Loss: 4.395 Test Acc: 0.827
Validation loss decreased (-0.786077 --> -0.826546).  Saving model ...
Epoch: 20 cost time: 16.904473781585693
Epoch: 20, Steps: 34 | Train Loss: 1.510 Vali Loss: 6.611 Vali Acc: 0.780 Test Loss: 6.611 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 18.491225242614746
Epoch: 21, Steps: 34 | Train Loss: 0.540 Vali Loss: 8.898 Vali Acc: 0.769 Test Loss: 8.898 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.6259663105011
Epoch: 22, Steps: 34 | Train Loss: 2.387 Vali Loss: 11.478 Vali Acc: 0.636 Test Loss: 11.478 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 17.381625175476074
Epoch: 23, Steps: 34 | Train Loss: 1.525 Vali Loss: 8.365 Vali Acc: 0.734 Test Loss: 8.365 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 18.81356978416443
Epoch: 24, Steps: 34 | Train Loss: 1.112 Vali Loss: 7.811 Vali Acc: 0.711 Test Loss: 7.811 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 16.31761074066162
Epoch: 25, Steps: 34 | Train Loss: 2.130 Vali Loss: 7.266 Vali Acc: 0.775 Test Loss: 7.266 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 16.617257595062256
Epoch: 26, Steps: 34 | Train Loss: 1.080 Vali Loss: 3.218 Vali Acc: 0.838 Test Loss: 3.218 Test Acc: 0.838
Validation loss decreased (-0.826546 --> -0.838118).  Saving model ...
Epoch: 27 cost time: 19.214202404022217
Epoch: 27, Steps: 34 | Train Loss: 0.542 Vali Loss: 4.776 Vali Acc: 0.746 Test Loss: 4.776 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 18.960981607437134
Epoch: 28, Steps: 34 | Train Loss: 0.895 Vali Loss: 6.122 Vali Acc: 0.792 Test Loss: 6.122 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 17.849406242370605
Epoch: 29, Steps: 34 | Train Loss: 0.210 Vali Loss: 8.898 Vali Acc: 0.786 Test Loss: 8.898 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 19.811689853668213
Epoch: 30, Steps: 34 | Train Loss: 0.883 Vali Loss: 10.120 Vali Acc: 0.734 Test Loss: 10.120 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 17.52557945251465
Epoch: 31, Steps: 34 | Train Loss: 1.067 Vali Loss: 4.392 Vali Acc: 0.757 Test Loss: 4.392 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 19.560832977294922
Epoch: 32, Steps: 34 | Train Loss: 0.720 Vali Loss: 16.076 Vali Acc: 0.642 Test Loss: 16.076 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 19.06558871269226
Epoch: 33, Steps: 34 | Train Loss: 0.216 Vali Loss: 3.583 Vali Acc: 0.827 Test Loss: 3.583 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 16.372859477996826
Epoch: 34, Steps: 34 | Train Loss: 0.408 Vali Loss: 7.006 Vali Acc: 0.792 Test Loss: 7.006 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 20.013879537582397
Epoch: 35, Steps: 34 | Train Loss: 0.730 Vali Loss: 6.452 Vali Acc: 0.792 Test Loss: 6.452 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 20.821149110794067
Epoch: 36, Steps: 34 | Train Loss: 3.620 Vali Loss: 12.736 Vali Acc: 0.295 Test Loss: 12.736 Test Acc: 0.295
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6797507
model size : 28.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.326813220977783
Epoch: 1, Steps: 34 | Train Loss: 3.693 Vali Loss: 5.123 Vali Acc: 0.382 Test Loss: 5.123 Test Acc: 0.382
Validation loss decreased (inf --> -0.381452).  Saving model ...
Epoch: 2 cost time: 18.124529361724854
Epoch: 2, Steps: 34 | Train Loss: 7.814 Vali Loss: 10.064 Vali Acc: 0.364 Test Loss: 10.064 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.368358373641968
Epoch: 3, Steps: 34 | Train Loss: 6.562 Vali Loss: 9.578 Vali Acc: 0.526 Test Loss: 9.578 Test Acc: 0.526
Validation loss decreased (-0.381452 --> -0.525916).  Saving model ...
Epoch: 4 cost time: 19.390419483184814
Epoch: 4, Steps: 34 | Train Loss: 7.734 Vali Loss: 7.513 Vali Acc: 0.497 Test Loss: 7.513 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.910897731781006
Epoch: 5, Steps: 34 | Train Loss: 4.622 Vali Loss: 5.935 Vali Acc: 0.595 Test Loss: 5.935 Test Acc: 0.595
Validation loss decreased (-0.525916 --> -0.595316).  Saving model ...
Epoch: 6 cost time: 18.09313178062439
Epoch: 6, Steps: 34 | Train Loss: 4.224 Vali Loss: 8.667 Vali Acc: 0.474 Test Loss: 8.667 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.9898579120636
Epoch: 7, Steps: 34 | Train Loss: 6.627 Vali Loss: 6.543 Vali Acc: 0.578 Test Loss: 6.543 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.57105779647827
Epoch: 8, Steps: 34 | Train Loss: 7.459 Vali Loss: 17.045 Vali Acc: 0.491 Test Loss: 17.045 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.042112350463867
Epoch: 9, Steps: 34 | Train Loss: 5.399 Vali Loss: 3.642 Vali Acc: 0.792 Test Loss: 3.642 Test Acc: 0.792
Validation loss decreased (-0.595316 --> -0.791871).  Saving model ...
Epoch: 10 cost time: 19.91222858428955
Epoch: 10, Steps: 34 | Train Loss: 3.561 Vali Loss: 6.667 Vali Acc: 0.671 Test Loss: 6.667 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.614348888397217
Epoch: 11, Steps: 34 | Train Loss: 2.137 Vali Loss: 4.808 Vali Acc: 0.723 Test Loss: 4.808 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.491583108901978
Epoch: 12, Steps: 34 | Train Loss: 1.556 Vali Loss: 6.522 Vali Acc: 0.642 Test Loss: 6.522 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.337958574295044
Epoch: 13, Steps: 34 | Train Loss: 3.338 Vali Loss: 3.294 Vali Acc: 0.844 Test Loss: 3.294 Test Acc: 0.844
Validation loss decreased (-0.791871 --> -0.843898).  Saving model ...
Epoch: 14 cost time: 19.19893503189087
Epoch: 14, Steps: 34 | Train Loss: 1.742 Vali Loss: 4.886 Vali Acc: 0.717 Test Loss: 4.886 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.725390911102295
Epoch: 15, Steps: 34 | Train Loss: 1.605 Vali Loss: 8.138 Vali Acc: 0.665 Test Loss: 8.138 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.373996019363403
Epoch: 16, Steps: 34 | Train Loss: 0.735 Vali Loss: 14.855 Vali Acc: 0.659 Test Loss: 14.855 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.663834571838379
Epoch: 17, Steps: 34 | Train Loss: 1.104 Vali Loss: 3.991 Vali Acc: 0.827 Test Loss: 3.991 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.268800020217896
Epoch: 18, Steps: 34 | Train Loss: 0.434 Vali Loss: 3.732 Vali Acc: 0.827 Test Loss: 3.732 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.029134035110474
Epoch: 19, Steps: 34 | Train Loss: 0.042 Vali Loss: 5.329 Vali Acc: 0.757 Test Loss: 5.329 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.640108585357666
Epoch: 20, Steps: 34 | Train Loss: 0.769 Vali Loss: 6.477 Vali Acc: 0.728 Test Loss: 6.477 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 14.597763776779175
Epoch: 21, Steps: 34 | Train Loss: 0.225 Vali Loss: 7.045 Vali Acc: 0.751 Test Loss: 7.045 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 14.310342788696289
Epoch: 22, Steps: 34 | Train Loss: 0.135 Vali Loss: 4.330 Vali Acc: 0.832 Test Loss: 4.330 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 19.45036792755127
Epoch: 23, Steps: 34 | Train Loss: 0.399 Vali Loss: 4.528 Vali Acc: 0.792 Test Loss: 4.528 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6794563
model size : 28.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.308305501937866
Epoch: 1, Steps: 34 | Train Loss: 3.650 Vali Loss: 4.999 Vali Acc: 0.376 Test Loss: 4.999 Test Acc: 0.376
Validation loss decreased (inf --> -0.375673).  Saving model ...
Epoch: 2 cost time: 16.772089958190918
Epoch: 2, Steps: 34 | Train Loss: 6.550 Vali Loss: 6.722 Vali Acc: 0.428 Test Loss: 6.722 Test Acc: 0.428
Validation loss decreased (-0.375673 --> -0.427678).  Saving model ...
Epoch: 3 cost time: 18.16549825668335
Epoch: 3, Steps: 34 | Train Loss: 8.419 Vali Loss: 6.066 Vali Acc: 0.532 Test Loss: 6.066 Test Acc: 0.532
Validation loss decreased (-0.427678 --> -0.531731).  Saving model ...
Epoch: 4 cost time: 17.36155104637146
Epoch: 4, Steps: 34 | Train Loss: 8.788 Vali Loss: 8.812 Vali Acc: 0.491 Test Loss: 8.812 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.057945728302002
Epoch: 5, Steps: 34 | Train Loss: 7.490 Vali Loss: 14.029 Vali Acc: 0.480 Test Loss: 14.029 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.88172936439514
Epoch: 6, Steps: 34 | Train Loss: 7.258 Vali Loss: 7.106 Vali Acc: 0.601 Test Loss: 7.106 Test Acc: 0.601
Validation loss decreased (-0.531731 --> -0.601085).  Saving model ...
Epoch: 7 cost time: 16.12977886199951
Epoch: 7, Steps: 34 | Train Loss: 4.140 Vali Loss: 5.950 Vali Acc: 0.665 Test Loss: 5.950 Test Acc: 0.665
Validation loss decreased (-0.601085 --> -0.664680).  Saving model ...
Epoch: 8 cost time: 18.81808090209961
Epoch: 8, Steps: 34 | Train Loss: 2.704 Vali Loss: 13.188 Vali Acc: 0.486 Test Loss: 13.188 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.098132133483887
Epoch: 9, Steps: 34 | Train Loss: 4.662 Vali Loss: 4.830 Vali Acc: 0.711 Test Loss: 4.830 Test Acc: 0.711
Validation loss decreased (-0.664680 --> -0.710934).  Saving model ...
Epoch: 10 cost time: 18.385634660720825
Epoch: 10, Steps: 34 | Train Loss: 0.890 Vali Loss: 5.979 Vali Acc: 0.740 Test Loss: 5.979 Test Acc: 0.740
Validation loss decreased (-0.710934 --> -0.739825).  Saving model ...
Epoch: 11 cost time: 20.43668007850647
Epoch: 11, Steps: 34 | Train Loss: 0.852 Vali Loss: 5.448 Vali Acc: 0.699 Test Loss: 5.448 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.510398626327515
Epoch: 12, Steps: 34 | Train Loss: 1.850 Vali Loss: 4.516 Vali Acc: 0.780 Test Loss: 4.516 Test Acc: 0.780
Validation loss decreased (-0.739825 --> -0.780302).  Saving model ...
Epoch: 13 cost time: 21.3690345287323
Epoch: 13, Steps: 34 | Train Loss: 1.627 Vali Loss: 2.093 Vali Acc: 0.757 Test Loss: 2.093 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.280529260635376
Epoch: 14, Steps: 34 | Train Loss: 0.430 Vali Loss: 1.874 Vali Acc: 0.873 Test Loss: 1.874 Test Acc: 0.873
Validation loss decreased (-0.780302 --> -0.872814).  Saving model ...
Epoch: 15 cost time: 18.27251386642456
Epoch: 15, Steps: 34 | Train Loss: 0.394 Vali Loss: 3.783 Vali Acc: 0.780 Test Loss: 3.783 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.803180932998657
Epoch: 16, Steps: 34 | Train Loss: 1.557 Vali Loss: 5.347 Vali Acc: 0.763 Test Loss: 5.347 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 20.091963529586792
Epoch: 17, Steps: 34 | Train Loss: 0.604 Vali Loss: 4.957 Vali Acc: 0.769 Test Loss: 4.957 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.38618755340576
Epoch: 18, Steps: 34 | Train Loss: 0.823 Vali Loss: 7.975 Vali Acc: 0.659 Test Loss: 7.975 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 20.32979917526245
Epoch: 19, Steps: 34 | Train Loss: 1.154 Vali Loss: 4.310 Vali Acc: 0.827 Test Loss: 4.310 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 19.65375852584839
Epoch: 20, Steps: 34 | Train Loss: 0.298 Vali Loss: 7.760 Vali Acc: 0.780 Test Loss: 7.760 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.889114379882812
Epoch: 21, Steps: 34 | Train Loss: 1.101 Vali Loss: 4.591 Vali Acc: 0.809 Test Loss: 4.591 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 17.696792602539062
Epoch: 22, Steps: 34 | Train Loss: 0.343 Vali Loss: 6.047 Vali Acc: 0.798 Test Loss: 6.047 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 20.656695127487183
Epoch: 23, Steps: 34 | Train Loss: 0.259 Vali Loss: 2.704 Vali Acc: 0.780 Test Loss: 2.704 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 18.05935549736023
Epoch: 24, Steps: 34 | Train Loss: 0.169 Vali Loss: 4.221 Vali Acc: 0.803 Test Loss: 4.221 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 6211267
model size : 26.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.100711584091187
Epoch: 1, Steps: 34 | Train Loss: 3.356 Vali Loss: 5.044 Vali Acc: 0.243 Test Loss: 5.044 Test Acc: 0.243
Validation loss decreased (inf --> -0.242724).  Saving model ...
Epoch: 2 cost time: 17.115236043930054
Epoch: 2, Steps: 34 | Train Loss: 4.482 Vali Loss: 13.626 Vali Acc: 0.301 Test Loss: 13.626 Test Acc: 0.301
Validation loss decreased (-0.242724 --> -0.300442).  Saving model ...
Epoch: 3 cost time: 21.57661724090576
Epoch: 3, Steps: 34 | Train Loss: 6.767 Vali Loss: 7.958 Vali Acc: 0.445 Test Loss: 7.958 Test Acc: 0.445
Validation loss decreased (-0.300442 --> -0.445007).  Saving model ...
Epoch: 4 cost time: 21.54214596748352
Epoch: 4, Steps: 34 | Train Loss: 6.043 Vali Loss: 9.682 Vali Acc: 0.451 Test Loss: 9.682 Test Acc: 0.451
Validation loss decreased (-0.445007 --> -0.450770).  Saving model ...
Epoch: 5 cost time: 19.66153049468994
Epoch: 5, Steps: 34 | Train Loss: 6.335 Vali Loss: 15.113 Vali Acc: 0.526 Test Loss: 15.113 Test Acc: 0.526
Validation loss decreased (-0.450770 --> -0.525860).  Saving model ...
Epoch: 6 cost time: 21.005348682403564
Epoch: 6, Steps: 34 | Train Loss: 5.557 Vali Loss: 11.329 Vali Acc: 0.503 Test Loss: 11.329 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.891043663024902
Epoch: 7, Steps: 34 | Train Loss: 3.694 Vali Loss: 3.944 Vali Acc: 0.659 Test Loss: 3.944 Test Acc: 0.659
Validation loss decreased (-0.525860 --> -0.658920).  Saving model ...
Epoch: 8 cost time: 17.590981006622314
Epoch: 8, Steps: 34 | Train Loss: 1.625 Vali Loss: 3.745 Vali Acc: 0.682 Test Loss: 3.745 Test Acc: 0.682
Validation loss decreased (-0.658920 --> -0.682043).  Saving model ...
Epoch: 9 cost time: 19.84696888923645
Epoch: 9, Steps: 34 | Train Loss: 2.034 Vali Loss: 5.669 Vali Acc: 0.682 Test Loss: 5.669 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.534259557724
Epoch: 10, Steps: 34 | Train Loss: 0.938 Vali Loss: 3.288 Vali Acc: 0.798 Test Loss: 3.288 Test Acc: 0.798
Validation loss decreased (-0.682043 --> -0.797655).  Saving model ...
Epoch: 11 cost time: 18.723571062088013
Epoch: 11, Steps: 34 | Train Loss: 1.484 Vali Loss: 9.741 Vali Acc: 0.647 Test Loss: 9.741 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.376229763031006
Epoch: 12, Steps: 34 | Train Loss: 1.868 Vali Loss: 6.281 Vali Acc: 0.746 Test Loss: 6.281 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.312617778778076
Epoch: 13, Steps: 34 | Train Loss: 3.253 Vali Loss: 6.125 Vali Acc: 0.757 Test Loss: 6.125 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.88008141517639
Epoch: 14, Steps: 34 | Train Loss: 0.834 Vali Loss: 10.272 Vali Acc: 0.688 Test Loss: 10.272 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.231205463409424
Epoch: 15, Steps: 34 | Train Loss: 0.708 Vali Loss: 3.859 Vali Acc: 0.809 Test Loss: 3.859 Test Acc: 0.809
Validation loss decreased (-0.797655 --> -0.809210).  Saving model ...
Epoch: 16 cost time: 19.635602474212646
Epoch: 16, Steps: 34 | Train Loss: 0.301 Vali Loss: 5.184 Vali Acc: 0.809 Test Loss: 5.184 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 20.39232039451599
Epoch: 17, Steps: 34 | Train Loss: 0.287 Vali Loss: 6.377 Vali Acc: 0.775 Test Loss: 6.377 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.801395654678345
Epoch: 18, Steps: 34 | Train Loss: 0.629 Vali Loss: 3.466 Vali Acc: 0.827 Test Loss: 3.466 Test Acc: 0.827
Validation loss decreased (-0.809210 --> -0.826555).  Saving model ...
Epoch: 19 cost time: 22.226605892181396
Epoch: 19, Steps: 34 | Train Loss: 0.070 Vali Loss: 3.480 Vali Acc: 0.780 Test Loss: 3.480 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 19.5453200340271
Epoch: 20, Steps: 34 | Train Loss: 0.069 Vali Loss: 2.594 Vali Acc: 0.838 Test Loss: 2.594 Test Acc: 0.838
Validation loss decreased (-0.826555 --> -0.838124).  Saving model ...
Epoch: 21 cost time: 20.073004245758057
Epoch: 21, Steps: 34 | Train Loss: 0.274 Vali Loss: 4.623 Vali Acc: 0.815 Test Loss: 4.623 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 21.475537300109863
Epoch: 22, Steps: 34 | Train Loss: 0.429 Vali Loss: 11.390 Vali Acc: 0.659 Test Loss: 11.390 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 19.908808708190918
Epoch: 23, Steps: 34 | Train Loss: 1.920 Vali Loss: 8.506 Vali Acc: 0.746 Test Loss: 8.506 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 20.37096667289734
Epoch: 24, Steps: 34 | Train Loss: 1.111 Vali Loss: 7.378 Vali Acc: 0.705 Test Loss: 7.378 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 21.141852378845215
Epoch: 25, Steps: 34 | Train Loss: 1.542 Vali Loss: 10.249 Vali Acc: 0.792 Test Loss: 10.249 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 20.250389575958252
Epoch: 26, Steps: 34 | Train Loss: 1.336 Vali Loss: 8.582 Vali Acc: 0.780 Test Loss: 8.582 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 20.628215312957764
Epoch: 27, Steps: 34 | Train Loss: 1.468 Vali Loss: 5.064 Vali Acc: 0.792 Test Loss: 5.064 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 19.729170322418213
Epoch: 28, Steps: 34 | Train Loss: 0.558 Vali Loss: 11.921 Vali Acc: 0.746 Test Loss: 11.921 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 21.412585735321045
Epoch: 29, Steps: 34 | Train Loss: 1.236 Vali Loss: 4.646 Vali Acc: 0.763 Test Loss: 4.646 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 23.432966709136963
Epoch: 30, Steps: 34 | Train Loss: 1.458 Vali Loss: 8.746 Vali Acc: 0.827 Test Loss: 8.746 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6208323
model size : 26.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.1683509349823
Epoch: 1, Steps: 34 | Train Loss: 3.784 Vali Loss: 5.696 Vali Acc: 0.439 Test Loss: 5.696 Test Acc: 0.439
Validation loss decreased (inf --> -0.439249).  Saving model ...
Epoch: 2 cost time: 19.611945867538452
Epoch: 2, Steps: 34 | Train Loss: 4.597 Vali Loss: 3.636 Vali Acc: 0.520 Test Loss: 3.636 Test Acc: 0.520
Validation loss decreased (-0.439249 --> -0.520195).  Saving model ...
Epoch: 3 cost time: 19.670846223831177
Epoch: 3, Steps: 34 | Train Loss: 5.135 Vali Loss: 5.762 Vali Acc: 0.457 Test Loss: 5.762 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.060670375823975
Epoch: 4, Steps: 34 | Train Loss: 6.287 Vali Loss: 9.182 Vali Acc: 0.497 Test Loss: 9.182 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.444157361984253
Epoch: 5, Steps: 34 | Train Loss: 8.388 Vali Loss: 10.962 Vali Acc: 0.503 Test Loss: 10.962 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.738463163375854
Epoch: 6, Steps: 34 | Train Loss: 9.559 Vali Loss: 13.612 Vali Acc: 0.595 Test Loss: 13.612 Test Acc: 0.595
Validation loss decreased (-0.520195 --> -0.595240).  Saving model ...
Epoch: 7 cost time: 21.249048709869385
Epoch: 7, Steps: 34 | Train Loss: 7.709 Vali Loss: 8.546 Vali Acc: 0.699 Test Loss: 8.546 Test Acc: 0.699
Validation loss decreased (-0.595240 --> -0.699337).  Saving model ...
Epoch: 8 cost time: 20.65442395210266
Epoch: 8, Steps: 34 | Train Loss: 7.160 Vali Loss: 8.319 Vali Acc: 0.688 Test Loss: 8.319 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.46314287185669
Epoch: 9, Steps: 34 | Train Loss: 6.181 Vali Loss: 7.181 Vali Acc: 0.734 Test Loss: 7.181 Test Acc: 0.734
Validation loss decreased (-0.699337 --> -0.734032).  Saving model ...
Epoch: 10 cost time: 19.591228008270264
Epoch: 10, Steps: 34 | Train Loss: 2.933 Vali Loss: 17.734 Vali Acc: 0.642 Test Loss: 17.734 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.194979906082153
Epoch: 11, Steps: 34 | Train Loss: 3.111 Vali Loss: 9.810 Vali Acc: 0.688 Test Loss: 9.810 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.89552092552185
Epoch: 12, Steps: 34 | Train Loss: 1.595 Vali Loss: 16.905 Vali Acc: 0.572 Test Loss: 16.905 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.045825958251953
Epoch: 13, Steps: 34 | Train Loss: 1.846 Vali Loss: 4.921 Vali Acc: 0.809 Test Loss: 4.921 Test Acc: 0.809
Validation loss decreased (-0.734032 --> -0.809199).  Saving model ...
Epoch: 14 cost time: 21.192943334579468
Epoch: 14, Steps: 34 | Train Loss: 0.841 Vali Loss: 14.831 Vali Acc: 0.607 Test Loss: 14.831 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.95460796356201
Epoch: 15, Steps: 34 | Train Loss: 1.148 Vali Loss: 4.953 Vali Acc: 0.798 Test Loss: 4.953 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.73590064048767
Epoch: 16, Steps: 34 | Train Loss: 0.937 Vali Loss: 12.207 Vali Acc: 0.786 Test Loss: 12.207 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 19.514938592910767
Epoch: 17, Steps: 34 | Train Loss: 0.769 Vali Loss: 9.695 Vali Acc: 0.694 Test Loss: 9.695 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 19.488760471343994
Epoch: 18, Steps: 34 | Train Loss: 1.633 Vali Loss: 13.509 Vali Acc: 0.757 Test Loss: 13.509 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.654091119766235
Epoch: 19, Steps: 34 | Train Loss: 0.852 Vali Loss: 7.546 Vali Acc: 0.803 Test Loss: 7.546 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 19.573060274124146
Epoch: 20, Steps: 34 | Train Loss: 1.858 Vali Loss: 25.029 Vali Acc: 0.578 Test Loss: 25.029 Test Acc: 0.578
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 20.467341899871826
Epoch: 21, Steps: 34 | Train Loss: 1.373 Vali Loss: 8.338 Vali Acc: 0.809 Test Loss: 8.338 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 21.61315107345581
Epoch: 22, Steps: 34 | Train Loss: 1.269 Vali Loss: 8.619 Vali Acc: 0.821 Test Loss: 8.619 Test Acc: 0.821
Validation loss decreased (-0.809199 --> -0.820723).  Saving model ...
Epoch: 23 cost time: 18.570776224136353
Epoch: 23, Steps: 34 | Train Loss: 1.958 Vali Loss: 16.304 Vali Acc: 0.676 Test Loss: 16.304 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 20.301486492156982
Epoch: 24, Steps: 34 | Train Loss: 0.990 Vali Loss: 6.290 Vali Acc: 0.775 Test Loss: 6.290 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 20.135461568832397
Epoch: 25, Steps: 34 | Train Loss: 0.591 Vali Loss: 6.635 Vali Acc: 0.827 Test Loss: 6.635 Test Acc: 0.827
Validation loss decreased (-0.820723 --> -0.826523).  Saving model ...
Epoch: 26 cost time: 18.581079721450806
Epoch: 26, Steps: 34 | Train Loss: 0.432 Vali Loss: 12.439 Vali Acc: 0.769 Test Loss: 12.439 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.13140559196472
Epoch: 27, Steps: 34 | Train Loss: 0.619 Vali Loss: 16.559 Vali Acc: 0.746 Test Loss: 16.559 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 20.657201766967773
Epoch: 28, Steps: 34 | Train Loss: 0.538 Vali Loss: 11.452 Vali Acc: 0.786 Test Loss: 11.452 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 20.46460270881653
Epoch: 29, Steps: 34 | Train Loss: 1.295 Vali Loss: 14.083 Vali Acc: 0.723 Test Loss: 14.083 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 21.215356588363647
Epoch: 30, Steps: 34 | Train Loss: 1.927 Vali Loss: 14.410 Vali Acc: 0.769 Test Loss: 14.410 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 21.227152109146118
Epoch: 31, Steps: 34 | Train Loss: 0.481 Vali Loss: 6.520 Vali Acc: 0.786 Test Loss: 6.520 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 21.634313344955444
Epoch: 32, Steps: 34 | Train Loss: 0.811 Vali Loss: 6.285 Vali Acc: 0.827 Test Loss: 6.285 Test Acc: 0.827
Validation loss decreased (-0.826523 --> -0.826527).  Saving model ...
Epoch: 33 cost time: 19.824849367141724
Epoch: 33, Steps: 34 | Train Loss: 0.918 Vali Loss: 5.752 Vali Acc: 0.850 Test Loss: 5.752 Test Acc: 0.850
Validation loss decreased (-0.826527 --> -0.849653).  Saving model ...
Epoch: 34 cost time: 20.460279941558838
Epoch: 34, Steps: 34 | Train Loss: 0.599 Vali Loss: 9.332 Vali Acc: 0.763 Test Loss: 9.332 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 19.409807443618774
Epoch: 35, Steps: 34 | Train Loss: 0.444 Vali Loss: 29.670 Vali Acc: 0.642 Test Loss: 29.670 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 21.776996612548828
Epoch: 36, Steps: 34 | Train Loss: 0.945 Vali Loss: 11.445 Vali Acc: 0.775 Test Loss: 11.445 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 19.31660509109497
Epoch: 37, Steps: 34 | Train Loss: 0.671 Vali Loss: 6.091 Vali Acc: 0.809 Test Loss: 6.091 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 19.128581523895264
Epoch: 38, Steps: 34 | Train Loss: 1.535 Vali Loss: 12.017 Vali Acc: 0.775 Test Loss: 12.017 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 19.047292470932007
Epoch: 39, Steps: 34 | Train Loss: 0.405 Vali Loss: 10.445 Vali Acc: 0.746 Test Loss: 10.445 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 20.48926329612732
Epoch: 40, Steps: 34 | Train Loss: 0.455 Vali Loss: 13.651 Vali Acc: 0.734 Test Loss: 13.651 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 19.03205370903015
Epoch: 41, Steps: 34 | Train Loss: 0.415 Vali Loss: 11.538 Vali Acc: 0.803 Test Loss: 11.538 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 19.09543776512146
Epoch: 42, Steps: 34 | Train Loss: 0.358 Vali Loss: 11.963 Vali Acc: 0.798 Test Loss: 11.963 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 19.188712120056152
Epoch: 43, Steps: 34 | Train Loss: 0.455 Vali Loss: 11.911 Vali Acc: 0.798 Test Loss: 11.911 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 6205379
model size : 26.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.39563798904419
Epoch: 1, Steps: 34 | Train Loss: 3.415 Vali Loss: 3.834 Vali Acc: 0.382 Test Loss: 3.834 Test Acc: 0.382
Validation loss decreased (inf --> -0.381465).  Saving model ...
Epoch: 2 cost time: 22.112728357315063
Epoch: 2, Steps: 34 | Train Loss: 4.800 Vali Loss: 16.730 Vali Acc: 0.243 Test Loss: 16.730 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.06152629852295
Epoch: 3, Steps: 34 | Train Loss: 11.675 Vali Loss: 11.288 Vali Acc: 0.532 Test Loss: 11.288 Test Acc: 0.532
Validation loss decreased (-0.381465 --> -0.531679).  Saving model ...
Epoch: 4 cost time: 22.517638444900513
Epoch: 4, Steps: 34 | Train Loss: 7.714 Vali Loss: 25.484 Vali Acc: 0.306 Test Loss: 25.484 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.221479177474976
Epoch: 5, Steps: 34 | Train Loss: 9.353 Vali Loss: 13.471 Vali Acc: 0.503 Test Loss: 13.471 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.189465284347534
Epoch: 6, Steps: 34 | Train Loss: 7.762 Vali Loss: 7.736 Vali Acc: 0.561 Test Loss: 7.736 Test Acc: 0.561
Validation loss decreased (-0.531679 --> -0.560616).  Saving model ...
Epoch: 7 cost time: 19.876598119735718
Epoch: 7, Steps: 34 | Train Loss: 4.840 Vali Loss: 6.773 Vali Acc: 0.642 Test Loss: 6.773 Test Acc: 0.642
Validation loss decreased (-0.560616 --> -0.641551).  Saving model ...
Epoch: 8 cost time: 19.347144603729248
Epoch: 8, Steps: 34 | Train Loss: 3.113 Vali Loss: 8.808 Vali Acc: 0.665 Test Loss: 8.808 Test Acc: 0.665
Validation loss decreased (-0.641551 --> -0.664652).  Saving model ...
Epoch: 9 cost time: 19.80672836303711
Epoch: 9, Steps: 34 | Train Loss: 2.961 Vali Loss: 7.929 Vali Acc: 0.711 Test Loss: 7.929 Test Acc: 0.711
Validation loss decreased (-0.664652 --> -0.710903).  Saving model ...
Epoch: 10 cost time: 19.75874090194702
Epoch: 10, Steps: 34 | Train Loss: 1.384 Vali Loss: 5.806 Vali Acc: 0.751 Test Loss: 5.806 Test Acc: 0.751
Validation loss decreased (-0.710903 --> -0.751387).  Saving model ...
Epoch: 11 cost time: 18.25217628479004
Epoch: 11, Steps: 34 | Train Loss: 2.551 Vali Loss: 5.811 Vali Acc: 0.711 Test Loss: 5.811 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.664348363876343
Epoch: 12, Steps: 34 | Train Loss: 1.824 Vali Loss: 6.567 Vali Acc: 0.751 Test Loss: 6.567 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.996773719787598
Epoch: 13, Steps: 34 | Train Loss: 2.086 Vali Loss: 3.855 Vali Acc: 0.821 Test Loss: 3.855 Test Acc: 0.821
Validation loss decreased (-0.751387 --> -0.820771).  Saving model ...
Epoch: 14 cost time: 20.554946899414062
Epoch: 14, Steps: 34 | Train Loss: 0.604 Vali Loss: 5.249 Vali Acc: 0.780 Test Loss: 5.249 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.131728887557983
Epoch: 15, Steps: 34 | Train Loss: 1.683 Vali Loss: 6.388 Vali Acc: 0.798 Test Loss: 6.388 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 19.51500964164734
Epoch: 16, Steps: 34 | Train Loss: 0.257 Vali Loss: 3.859 Vali Acc: 0.780 Test Loss: 3.859 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 19.3000910282135
Epoch: 17, Steps: 34 | Train Loss: 0.525 Vali Loss: 2.668 Vali Acc: 0.827 Test Loss: 2.668 Test Acc: 0.827
Validation loss decreased (-0.820771 --> -0.826563).  Saving model ...
Epoch: 18 cost time: 21.24548625946045
Epoch: 18, Steps: 34 | Train Loss: 0.048 Vali Loss: 5.814 Vali Acc: 0.798 Test Loss: 5.814 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.79989457130432
Epoch: 19, Steps: 34 | Train Loss: 0.597 Vali Loss: 4.453 Vali Acc: 0.809 Test Loss: 4.453 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.912641763687134
Epoch: 20, Steps: 34 | Train Loss: 0.656 Vali Loss: 3.973 Vali Acc: 0.844 Test Loss: 3.973 Test Acc: 0.844
Validation loss decreased (-0.826563 --> -0.843891).  Saving model ...
Epoch: 21 cost time: 21.318294286727905
Epoch: 21, Steps: 34 | Train Loss: 0.111 Vali Loss: 4.686 Vali Acc: 0.873 Test Loss: 4.686 Test Acc: 0.873
Validation loss decreased (-0.843891 --> -0.872786).  Saving model ...
Epoch: 22 cost time: 22.577280282974243
Epoch: 22, Steps: 34 | Train Loss: 0.060 Vali Loss: 4.371 Vali Acc: 0.832 Test Loss: 4.371 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 21.33363175392151
Epoch: 23, Steps: 34 | Train Loss: 0.205 Vali Loss: 8.141 Vali Acc: 0.821 Test Loss: 8.141 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 20.026696920394897
Epoch: 24, Steps: 34 | Train Loss: 0.622 Vali Loss: 4.273 Vali Acc: 0.832 Test Loss: 4.273 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 18.913970708847046
Epoch: 25, Steps: 34 | Train Loss: 0.272 Vali Loss: 8.917 Vali Acc: 0.775 Test Loss: 8.917 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 20.26499891281128
Epoch: 26, Steps: 34 | Train Loss: 1.086 Vali Loss: 13.669 Vali Acc: 0.711 Test Loss: 13.669 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 19.416866064071655
Epoch: 27, Steps: 34 | Train Loss: 0.677 Vali Loss: 12.660 Vali Acc: 0.740 Test Loss: 12.660 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 18.786783695220947
Epoch: 28, Steps: 34 | Train Loss: 1.623 Vali Loss: 9.265 Vali Acc: 0.815 Test Loss: 9.265 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 19.660865783691406
Epoch: 29, Steps: 34 | Train Loss: 0.518 Vali Loss: 10.027 Vali Acc: 0.827 Test Loss: 10.027 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 18.96005153656006
Epoch: 30, Steps: 34 | Train Loss: 0.920 Vali Loss: 7.360 Vali Acc: 0.809 Test Loss: 7.360 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 20.420458793640137
Epoch: 31, Steps: 34 | Train Loss: 3.713 Vali Loss: 6.285 Vali Acc: 0.786 Test Loss: 6.285 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 6202435
model size : 26.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.38587784767151
Epoch: 1, Steps: 34 | Train Loss: 3.881 Vali Loss: 4.036 Vali Acc: 0.474 Test Loss: 4.036 Test Acc: 0.474
Validation loss decreased (inf --> -0.473948).  Saving model ...
Epoch: 2 cost time: 20.42292881011963
Epoch: 2, Steps: 34 | Train Loss: 5.049 Vali Loss: 8.841 Vali Acc: 0.220 Test Loss: 8.841 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.173566818237305
Epoch: 3, Steps: 34 | Train Loss: 6.800 Vali Loss: 12.860 Vali Acc: 0.480 Test Loss: 12.860 Test Acc: 0.480
Validation loss decreased (-0.473948 --> -0.479640).  Saving model ...
Epoch: 4 cost time: 21.082342624664307
Epoch: 4, Steps: 34 | Train Loss: 8.954 Vali Loss: 17.198 Vali Acc: 0.462 Test Loss: 17.198 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.997127771377563
Epoch: 5, Steps: 34 | Train Loss: 9.643 Vali Loss: 9.165 Vali Acc: 0.566 Test Loss: 9.165 Test Acc: 0.566
Validation loss decreased (-0.479640 --> -0.566382).  Saving model ...
Epoch: 6 cost time: 19.178386926651
Epoch: 6, Steps: 34 | Train Loss: 8.970 Vali Loss: 10.401 Vali Acc: 0.566 Test Loss: 10.401 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.236075162887573
Epoch: 7, Steps: 34 | Train Loss: 4.001 Vali Loss: 6.691 Vali Acc: 0.676 Test Loss: 6.691 Test Acc: 0.676
Validation loss decreased (-0.566382 --> -0.676234).  Saving model ...
Epoch: 8 cost time: 19.293088674545288
Epoch: 8, Steps: 34 | Train Loss: 4.038 Vali Loss: 10.623 Vali Acc: 0.647 Test Loss: 10.623 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.733464241027832
Epoch: 9, Steps: 34 | Train Loss: 3.032 Vali Loss: 7.925 Vali Acc: 0.676 Test Loss: 7.925 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.796152591705322
Epoch: 10, Steps: 34 | Train Loss: 0.803 Vali Loss: 3.524 Vali Acc: 0.803 Test Loss: 3.524 Test Acc: 0.803
Validation loss decreased (-0.676234 --> -0.803433).  Saving model ...
Epoch: 11 cost time: 17.646045207977295
Epoch: 11, Steps: 34 | Train Loss: 2.024 Vali Loss: 5.514 Vali Acc: 0.751 Test Loss: 5.514 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.54306697845459
Epoch: 12, Steps: 34 | Train Loss: 2.286 Vali Loss: 6.470 Vali Acc: 0.705 Test Loss: 6.470 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.448155403137207
Epoch: 13, Steps: 34 | Train Loss: 1.725 Vali Loss: 4.555 Vali Acc: 0.838 Test Loss: 4.555 Test Acc: 0.838
Validation loss decreased (-0.803433 --> -0.838105).  Saving model ...
Epoch: 14 cost time: 18.828869342803955
Epoch: 14, Steps: 34 | Train Loss: 2.522 Vali Loss: 11.249 Vali Acc: 0.705 Test Loss: 11.249 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.563316106796265
Epoch: 15, Steps: 34 | Train Loss: 4.530 Vali Loss: 8.918 Vali Acc: 0.676 Test Loss: 8.918 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 19.43704390525818
Epoch: 16, Steps: 34 | Train Loss: 0.863 Vali Loss: 2.944 Vali Acc: 0.827 Test Loss: 2.944 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 20.407148361206055
Epoch: 17, Steps: 34 | Train Loss: 0.924 Vali Loss: 6.565 Vali Acc: 0.740 Test Loss: 6.565 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 19.602555751800537
Epoch: 18, Steps: 34 | Train Loss: 1.752 Vali Loss: 4.034 Vali Acc: 0.809 Test Loss: 4.034 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.963817834854126
Epoch: 19, Steps: 34 | Train Loss: 1.075 Vali Loss: 7.256 Vali Acc: 0.809 Test Loss: 7.256 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 20.549975395202637
Epoch: 20, Steps: 34 | Train Loss: 1.902 Vali Loss: 6.273 Vali Acc: 0.815 Test Loss: 6.273 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 21.36223554611206
Epoch: 21, Steps: 34 | Train Loss: 1.015 Vali Loss: 5.470 Vali Acc: 0.821 Test Loss: 5.470 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 14.551591873168945
Epoch: 22, Steps: 34 | Train Loss: 0.157 Vali Loss: 4.804 Vali Acc: 0.827 Test Loss: 4.804 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 19.635277032852173
Epoch: 23, Steps: 34 | Train Loss: 0.129 Vali Loss: 10.506 Vali Acc: 0.792 Test Loss: 10.506 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 5915203
model size : 25.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.79464602470398
Epoch: 1, Steps: 34 | Train Loss: 2.913 Vali Loss: 3.649 Vali Acc: 0.295 Test Loss: 3.649 Test Acc: 0.295
Validation loss decreased (inf --> -0.294761).  Saving model ...
Epoch: 2 cost time: 20.016380310058594
Epoch: 2, Steps: 34 | Train Loss: 5.846 Vali Loss: 7.114 Vali Acc: 0.399 Test Loss: 7.114 Test Acc: 0.399
Validation loss decreased (-0.294761 --> -0.398773).  Saving model ...
Epoch: 3 cost time: 19.64596199989319
Epoch: 3, Steps: 34 | Train Loss: 5.202 Vali Loss: 8.636 Vali Acc: 0.578 Test Loss: 8.636 Test Acc: 0.578
Validation loss decreased (-0.398773 --> -0.577948).  Saving model ...
Epoch: 4 cost time: 19.14565110206604
Epoch: 4, Steps: 34 | Train Loss: 3.564 Vali Loss: 7.671 Vali Acc: 0.613 Test Loss: 7.671 Test Acc: 0.613
Validation loss decreased (-0.577948 --> -0.612640).  Saving model ...
Epoch: 5 cost time: 19.5584077835083
Epoch: 5, Steps: 34 | Train Loss: 4.983 Vali Loss: 9.610 Vali Acc: 0.526 Test Loss: 9.610 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.15431833267212
Epoch: 6, Steps: 34 | Train Loss: 5.033 Vali Loss: 4.195 Vali Acc: 0.659 Test Loss: 4.195 Test Acc: 0.659
Validation loss decreased (-0.612640 --> -0.658918).  Saving model ...
Epoch: 7 cost time: 18.41709876060486
Epoch: 7, Steps: 34 | Train Loss: 2.425 Vali Loss: 4.232 Vali Acc: 0.682 Test Loss: 4.232 Test Acc: 0.682
Validation loss decreased (-0.658918 --> -0.682039).  Saving model ...
Epoch: 8 cost time: 18.935164213180542
Epoch: 8, Steps: 34 | Train Loss: 2.766 Vali Loss: 7.397 Vali Acc: 0.665 Test Loss: 7.397 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.313425540924072
Epoch: 9, Steps: 34 | Train Loss: 4.797 Vali Loss: 10.294 Vali Acc: 0.671 Test Loss: 10.294 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.62794852256775
Epoch: 10, Steps: 34 | Train Loss: 4.042 Vali Loss: 7.832 Vali Acc: 0.682 Test Loss: 7.832 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.148215532302856
Epoch: 11, Steps: 34 | Train Loss: 1.020 Vali Loss: 2.588 Vali Acc: 0.827 Test Loss: 2.588 Test Acc: 0.827
Validation loss decreased (-0.682039 --> -0.826564).  Saving model ...
Epoch: 12 cost time: 22.00488805770874
Epoch: 12, Steps: 34 | Train Loss: 2.331 Vali Loss: 8.584 Vali Acc: 0.682 Test Loss: 8.584 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.560651302337646
Epoch: 13, Steps: 34 | Train Loss: 1.769 Vali Loss: 5.648 Vali Acc: 0.803 Test Loss: 5.648 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.5803165435791
Epoch: 14, Steps: 34 | Train Loss: 0.984 Vali Loss: 4.124 Vali Acc: 0.850 Test Loss: 4.124 Test Acc: 0.850
Validation loss decreased (-0.826564 --> -0.849670).  Saving model ...
Epoch: 15 cost time: 19.7514910697937
Epoch: 15, Steps: 34 | Train Loss: 1.187 Vali Loss: 13.985 Vali Acc: 0.734 Test Loss: 13.985 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.522047758102417
Epoch: 16, Steps: 34 | Train Loss: 1.149 Vali Loss: 8.471 Vali Acc: 0.780 Test Loss: 8.471 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 20.8050320148468
Epoch: 17, Steps: 34 | Train Loss: 0.776 Vali Loss: 19.687 Vali Acc: 0.630 Test Loss: 19.687 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.904866695404053
Epoch: 18, Steps: 34 | Train Loss: 2.911 Vali Loss: 7.045 Vali Acc: 0.809 Test Loss: 7.045 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 19.782911777496338
Epoch: 19, Steps: 34 | Train Loss: 1.032 Vali Loss: 13.823 Vali Acc: 0.705 Test Loss: 13.823 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 18.262197732925415
Epoch: 20, Steps: 34 | Train Loss: 1.354 Vali Loss: 6.072 Vali Acc: 0.809 Test Loss: 6.072 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 19.949021339416504
Epoch: 21, Steps: 34 | Train Loss: 0.679 Vali Loss: 8.492 Vali Acc: 0.832 Test Loss: 8.492 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 19.197036027908325
Epoch: 22, Steps: 34 | Train Loss: 1.236 Vali Loss: 13.180 Vali Acc: 0.728 Test Loss: 13.180 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 18.764874935150146
Epoch: 23, Steps: 34 | Train Loss: 1.109 Vali Loss: 13.762 Vali Acc: 0.734 Test Loss: 13.762 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 18.036007165908813
Epoch: 24, Steps: 34 | Train Loss: 0.827 Vali Loss: 8.359 Vali Acc: 0.798 Test Loss: 8.359 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 5912259
model size : 25.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.65612268447876
Epoch: 1, Steps: 34 | Train Loss: 3.522 Vali Loss: 5.024 Vali Acc: 0.295 Test Loss: 5.024 Test Acc: 0.295
Validation loss decreased (inf --> -0.294747).  Saving model ...
Epoch: 2 cost time: 20.019729137420654
Epoch: 2, Steps: 34 | Train Loss: 4.479 Vali Loss: 13.907 Vali Acc: 0.312 Test Loss: 13.907 Test Acc: 0.312
Validation loss decreased (-0.294747 --> -0.312000).  Saving model ...
Epoch: 3 cost time: 21.498090982437134
Epoch: 3, Steps: 34 | Train Loss: 7.128 Vali Loss: 6.221 Vali Acc: 0.422 Test Loss: 6.221 Test Acc: 0.422
Validation loss decreased (-0.312000 --> -0.421903).  Saving model ...
Epoch: 4 cost time: 21.881671667099
Epoch: 4, Steps: 34 | Train Loss: 6.361 Vali Loss: 6.102 Vali Acc: 0.653 Test Loss: 6.102 Test Acc: 0.653
Validation loss decreased (-0.421903 --> -0.653118).  Saving model ...
Epoch: 5 cost time: 21.63663673400879
Epoch: 5, Steps: 34 | Train Loss: 5.665 Vali Loss: 18.233 Vali Acc: 0.405 Test Loss: 18.233 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.905368328094482
Epoch: 6, Steps: 34 | Train Loss: 8.473 Vali Loss: 11.172 Vali Acc: 0.520 Test Loss: 11.172 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.23069167137146
Epoch: 7, Steps: 34 | Train Loss: 5.019 Vali Loss: 3.081 Vali Acc: 0.769 Test Loss: 3.081 Test Acc: 0.769
Validation loss decreased (-0.653118 --> -0.768755).  Saving model ...
Epoch: 8 cost time: 20.065675497055054
Epoch: 8, Steps: 34 | Train Loss: 2.241 Vali Loss: 14.127 Vali Acc: 0.566 Test Loss: 14.127 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.418508529663086
Epoch: 9, Steps: 34 | Train Loss: 1.936 Vali Loss: 4.910 Vali Acc: 0.769 Test Loss: 4.910 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.924541473388672
Epoch: 10, Steps: 34 | Train Loss: 1.509 Vali Loss: 7.186 Vali Acc: 0.734 Test Loss: 7.186 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.527483463287354
Epoch: 11, Steps: 34 | Train Loss: 2.255 Vali Loss: 19.189 Vali Acc: 0.555 Test Loss: 19.189 Test Acc: 0.555
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.501665830612183
Epoch: 12, Steps: 34 | Train Loss: 1.764 Vali Loss: 4.922 Vali Acc: 0.809 Test Loss: 4.922 Test Acc: 0.809
Validation loss decreased (-0.768755 --> -0.809199).  Saving model ...
Epoch: 13 cost time: 20.147000789642334
Epoch: 13, Steps: 34 | Train Loss: 0.928 Vali Loss: 9.014 Vali Acc: 0.705 Test Loss: 9.014 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.221235036849976
Epoch: 14, Steps: 34 | Train Loss: 0.737 Vali Loss: 6.228 Vali Acc: 0.746 Test Loss: 6.228 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 15.111940622329712
Epoch: 15, Steps: 34 | Train Loss: 0.581 Vali Loss: 8.618 Vali Acc: 0.746 Test Loss: 8.618 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.425559997558594
Epoch: 16, Steps: 34 | Train Loss: 1.525 Vali Loss: 3.860 Vali Acc: 0.827 Test Loss: 3.860 Test Acc: 0.827
Validation loss decreased (-0.809199 --> -0.826551).  Saving model ...
Epoch: 17 cost time: 19.202643394470215
Epoch: 17, Steps: 34 | Train Loss: 0.156 Vali Loss: 7.945 Vali Acc: 0.751 Test Loss: 7.945 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 20.71662187576294
Epoch: 18, Steps: 34 | Train Loss: 0.495 Vali Loss: 5.551 Vali Acc: 0.786 Test Loss: 5.551 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 19.7671058177948
Epoch: 19, Steps: 34 | Train Loss: 0.187 Vali Loss: 6.841 Vali Acc: 0.786 Test Loss: 6.841 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 21.749018669128418
Epoch: 20, Steps: 34 | Train Loss: 0.135 Vali Loss: 9.322 Vali Acc: 0.653 Test Loss: 9.322 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 21.027161359786987
Epoch: 21, Steps: 34 | Train Loss: 1.477 Vali Loss: 7.788 Vali Acc: 0.769 Test Loss: 7.788 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 22.69993019104004
Epoch: 22, Steps: 34 | Train Loss: 0.787 Vali Loss: 9.410 Vali Acc: 0.717 Test Loss: 9.410 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 21.533976078033447
Epoch: 23, Steps: 34 | Train Loss: 0.869 Vali Loss: 9.401 Vali Acc: 0.711 Test Loss: 9.401 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 19.182649612426758
Epoch: 24, Steps: 34 | Train Loss: 1.180 Vali Loss: 25.685 Vali Acc: 0.503 Test Loss: 25.685 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 17.664049863815308
Epoch: 25, Steps: 34 | Train Loss: 0.802 Vali Loss: 8.532 Vali Acc: 0.786 Test Loss: 8.532 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 19.167397260665894
Epoch: 26, Steps: 34 | Train Loss: 0.771 Vali Loss: 6.720 Vali Acc: 0.832 Test Loss: 6.720 Test Acc: 0.832
Validation loss decreased (-0.826551 --> -0.832303).  Saving model ...
Epoch: 27 cost time: 19.319681406021118
Epoch: 27, Steps: 34 | Train Loss: 0.074 Vali Loss: 6.696 Vali Acc: 0.803 Test Loss: 6.696 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 19.29088068008423
Epoch: 28, Steps: 34 | Train Loss: 0.306 Vali Loss: 12.131 Vali Acc: 0.786 Test Loss: 12.131 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 18.661758422851562
Epoch: 29, Steps: 34 | Train Loss: 0.785 Vali Loss: 9.579 Vali Acc: 0.751 Test Loss: 9.579 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 20.098002672195435
Epoch: 30, Steps: 34 | Train Loss: 0.225 Vali Loss: 11.529 Vali Acc: 0.786 Test Loss: 11.529 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 20.89162564277649
Epoch: 31, Steps: 34 | Train Loss: 0.457 Vali Loss: 7.515 Vali Acc: 0.809 Test Loss: 7.515 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 21.0381863117218
Epoch: 32, Steps: 34 | Train Loss: 1.110 Vali Loss: 9.286 Vali Acc: 0.746 Test Loss: 9.286 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 19.098517417907715
Epoch: 33, Steps: 34 | Train Loss: 0.735 Vali Loss: 10.689 Vali Acc: 0.757 Test Loss: 10.689 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 19.581697940826416
Epoch: 34, Steps: 34 | Train Loss: 1.183 Vali Loss: 5.067 Vali Acc: 0.867 Test Loss: 5.067 Test Acc: 0.867
Validation loss decreased (-0.832303 --> -0.867001).  Saving model ...
Epoch: 35 cost time: 20.82728385925293
Epoch: 35, Steps: 34 | Train Loss: 0.453 Vali Loss: 12.716 Vali Acc: 0.723 Test Loss: 12.716 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 18.923018217086792
Epoch: 36, Steps: 34 | Train Loss: 0.241 Vali Loss: 9.171 Vali Acc: 0.798 Test Loss: 9.171 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 19.975188970565796
Epoch: 37, Steps: 34 | Train Loss: 0.300 Vali Loss: 8.993 Vali Acc: 0.803 Test Loss: 8.993 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 20.70899248123169
Epoch: 38, Steps: 34 | Train Loss: 0.295 Vali Loss: 6.583 Vali Acc: 0.786 Test Loss: 6.583 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 18.820102214813232
Epoch: 39, Steps: 34 | Train Loss: 0.723 Vali Loss: 8.756 Vali Acc: 0.769 Test Loss: 8.756 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 21.38801407814026
Epoch: 40, Steps: 34 | Train Loss: 0.381 Vali Loss: 13.176 Vali Acc: 0.740 Test Loss: 13.176 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 18.772173166275024
Epoch: 41, Steps: 34 | Train Loss: 1.028 Vali Loss: 13.861 Vali Acc: 0.676 Test Loss: 13.861 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 19.95598006248474
Epoch: 42, Steps: 34 | Train Loss: 0.729 Vali Loss: 13.850 Vali Acc: 0.734 Test Loss: 13.850 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 18.05224847793579
Epoch: 43, Steps: 34 | Train Loss: 0.048 Vali Loss: 9.108 Vali Acc: 0.769 Test Loss: 9.108 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 19.811435222625732
Epoch: 44, Steps: 34 | Train Loss: 0.454 Vali Loss: 9.982 Vali Acc: 0.740 Test Loss: 9.982 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 5909315
model size : 25.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.40121865272522
Epoch: 1, Steps: 34 | Train Loss: 3.768 Vali Loss: 10.033 Vali Acc: 0.168 Test Loss: 10.033 Test Acc: 0.168
Validation loss decreased (inf --> -0.167530).  Saving model ...
Epoch: 2 cost time: 19.10328197479248
Epoch: 2, Steps: 34 | Train Loss: 7.290 Vali Loss: 6.317 Vali Acc: 0.416 Test Loss: 6.317 Test Acc: 0.416
Validation loss decreased (-0.167530 --> -0.416122).  Saving model ...
Epoch: 3 cost time: 19.313589811325073
Epoch: 3, Steps: 34 | Train Loss: 7.452 Vali Loss: 6.076 Vali Acc: 0.462 Test Loss: 6.076 Test Acc: 0.462
Validation loss decreased (-0.416122 --> -0.462367).  Saving model ...
Epoch: 4 cost time: 17.22786831855774
Epoch: 4, Steps: 34 | Train Loss: 7.744 Vali Loss: 7.797 Vali Acc: 0.439 Test Loss: 7.797 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.62269163131714
Epoch: 5, Steps: 34 | Train Loss: 6.736 Vali Loss: 10.408 Vali Acc: 0.468 Test Loss: 10.408 Test Acc: 0.468
Validation loss decreased (-0.462367 --> -0.468104).  Saving model ...
Epoch: 6 cost time: 18.40496587753296
Epoch: 6, Steps: 34 | Train Loss: 4.254 Vali Loss: 10.354 Vali Acc: 0.393 Test Loss: 10.354 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.333791732788086
Epoch: 7, Steps: 34 | Train Loss: 3.636 Vali Loss: 4.119 Vali Acc: 0.659 Test Loss: 4.119 Test Acc: 0.659
Validation loss decreased (-0.468104 --> -0.658918).  Saving model ...
Epoch: 8 cost time: 20.895236492156982
Epoch: 8, Steps: 34 | Train Loss: 2.591 Vali Loss: 4.708 Vali Acc: 0.740 Test Loss: 4.708 Test Acc: 0.740
Validation loss decreased (-0.658918 --> -0.739837).  Saving model ...
Epoch: 9 cost time: 19.206540822982788
Epoch: 9, Steps: 34 | Train Loss: 1.373 Vali Loss: 2.559 Vali Acc: 0.751 Test Loss: 2.559 Test Acc: 0.751
Validation loss decreased (-0.739837 --> -0.751420).  Saving model ...
Epoch: 10 cost time: 19.66204810142517
Epoch: 10, Steps: 34 | Train Loss: 0.837 Vali Loss: 2.781 Vali Acc: 0.798 Test Loss: 2.781 Test Acc: 0.798
Validation loss decreased (-0.751420 --> -0.797660).  Saving model ...
Epoch: 11 cost time: 19.210040807724
Epoch: 11, Steps: 34 | Train Loss: 0.758 Vali Loss: 4.953 Vali Acc: 0.740 Test Loss: 4.953 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.41681694984436
Epoch: 12, Steps: 34 | Train Loss: 3.930 Vali Loss: 4.575 Vali Acc: 0.705 Test Loss: 4.575 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.762304306030273
Epoch: 13, Steps: 34 | Train Loss: 1.033 Vali Loss: 3.163 Vali Acc: 0.775 Test Loss: 3.163 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.44029974937439
Epoch: 14, Steps: 34 | Train Loss: 1.764 Vali Loss: 4.440 Vali Acc: 0.763 Test Loss: 4.440 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 17.68956685066223
Epoch: 15, Steps: 34 | Train Loss: 0.917 Vali Loss: 3.147 Vali Acc: 0.809 Test Loss: 3.147 Test Acc: 0.809
Validation loss decreased (-0.797660 --> -0.809217).  Saving model ...
Epoch: 16 cost time: 18.50393795967102
Epoch: 16, Steps: 34 | Train Loss: 1.091 Vali Loss: 9.810 Vali Acc: 0.526 Test Loss: 9.810 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.249529123306274
Epoch: 17, Steps: 34 | Train Loss: 0.762 Vali Loss: 8.093 Vali Acc: 0.740 Test Loss: 8.093 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.44991660118103
Epoch: 18, Steps: 34 | Train Loss: 0.704 Vali Loss: 4.999 Vali Acc: 0.815 Test Loss: 4.999 Test Acc: 0.815
Validation loss decreased (-0.809217 --> -0.814979).  Saving model ...
Epoch: 19 cost time: 13.793490648269653
Epoch: 19, Steps: 34 | Train Loss: 0.261 Vali Loss: 4.429 Vali Acc: 0.809 Test Loss: 4.429 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.643435001373291
Epoch: 20, Steps: 34 | Train Loss: 1.702 Vali Loss: 9.039 Vali Acc: 0.751 Test Loss: 9.039 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.614173889160156
Epoch: 21, Steps: 34 | Train Loss: 0.709 Vali Loss: 7.105 Vali Acc: 0.717 Test Loss: 7.105 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.214141607284546
Epoch: 22, Steps: 34 | Train Loss: 1.648 Vali Loss: 8.451 Vali Acc: 0.757 Test Loss: 8.451 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 17.74203896522522
Epoch: 23, Steps: 34 | Train Loss: 1.808 Vali Loss: 10.660 Vali Acc: 0.757 Test Loss: 10.660 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 20.130735635757446
Epoch: 24, Steps: 34 | Train Loss: 1.227 Vali Loss: 6.199 Vali Acc: 0.821 Test Loss: 6.199 Test Acc: 0.821
Validation loss decreased (-0.814979 --> -0.820747).  Saving model ...
Epoch: 25 cost time: 17.677392959594727
Epoch: 25, Steps: 34 | Train Loss: 0.255 Vali Loss: 5.661 Vali Acc: 0.786 Test Loss: 5.661 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 21.427017211914062
Epoch: 26, Steps: 34 | Train Loss: 0.529 Vali Loss: 8.254 Vali Acc: 0.751 Test Loss: 8.254 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 18.052210330963135
Epoch: 27, Steps: 34 | Train Loss: 0.996 Vali Loss: 4.880 Vali Acc: 0.809 Test Loss: 4.880 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 19.369498252868652
Epoch: 28, Steps: 34 | Train Loss: 0.197 Vali Loss: 6.835 Vali Acc: 0.809 Test Loss: 6.835 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 17.656933307647705
Epoch: 29, Steps: 34 | Train Loss: 0.184 Vali Loss: 3.838 Vali Acc: 0.861 Test Loss: 3.838 Test Acc: 0.861
Validation loss decreased (-0.820747 --> -0.861233).  Saving model ...
Epoch: 30 cost time: 17.983932733535767
Epoch: 30, Steps: 34 | Train Loss: 0.279 Vali Loss: 7.456 Vali Acc: 0.775 Test Loss: 7.456 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 19.011266708374023
Epoch: 31, Steps: 34 | Train Loss: 0.693 Vali Loss: 6.614 Vali Acc: 0.792 Test Loss: 6.614 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 18.804654836654663
Epoch: 32, Steps: 34 | Train Loss: 0.256 Vali Loss: 7.426 Vali Acc: 0.798 Test Loss: 7.426 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 17.835904836654663
Epoch: 33, Steps: 34 | Train Loss: 0.236 Vali Loss: 5.132 Vali Acc: 0.827 Test Loss: 5.132 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 16.778252363204956
Epoch: 34, Steps: 34 | Train Loss: 0.270 Vali Loss: 4.711 Vali Acc: 0.809 Test Loss: 4.711 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 20.17039966583252
Epoch: 35, Steps: 34 | Train Loss: 0.123 Vali Loss: 13.736 Vali Acc: 0.757 Test Loss: 13.736 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 19.849034309387207
Epoch: 36, Steps: 34 | Train Loss: 0.422 Vali Loss: 7.053 Vali Acc: 0.821 Test Loss: 7.053 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 20.126155138015747
Epoch: 37, Steps: 34 | Train Loss: 0.567 Vali Loss: 14.082 Vali Acc: 0.746 Test Loss: 14.082 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 18.080500841140747
Epoch: 38, Steps: 34 | Train Loss: 0.275 Vali Loss: 7.635 Vali Acc: 0.769 Test Loss: 7.635 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 21.48127007484436
Epoch: 39, Steps: 34 | Train Loss: 0.041 Vali Loss: 6.791 Vali Acc: 0.798 Test Loss: 6.791 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 5906371
model size : 25.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.853028059005737
Epoch: 1, Steps: 34 | Train Loss: 2.982 Vali Loss: 3.852 Vali Acc: 0.376 Test Loss: 3.852 Test Acc: 0.376
Validation loss decreased (inf --> -0.375684).  Saving model ...
Epoch: 2 cost time: 19.658276796340942
Epoch: 2, Steps: 34 | Train Loss: 3.107 Vali Loss: 2.510 Vali Acc: 0.561 Test Loss: 2.510 Test Acc: 0.561
Validation loss decreased (-0.375684 --> -0.560669).  Saving model ...
Epoch: 3 cost time: 20.49989104270935
Epoch: 3, Steps: 34 | Train Loss: 3.151 Vali Loss: 7.854 Vali Acc: 0.405 Test Loss: 7.854 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.446707487106323
Epoch: 4, Steps: 34 | Train Loss: 3.775 Vali Loss: 6.506 Vali Acc: 0.520 Test Loss: 6.506 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.29039216041565
Epoch: 5, Steps: 34 | Train Loss: 2.985 Vali Loss: 1.818 Vali Acc: 0.688 Test Loss: 1.818 Test Acc: 0.688
Validation loss decreased (-0.560669 --> -0.687843).  Saving model ...
Epoch: 6 cost time: 17.840272426605225
Epoch: 6, Steps: 34 | Train Loss: 2.092 Vali Loss: 6.412 Vali Acc: 0.480 Test Loss: 6.412 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.02845048904419
Epoch: 7, Steps: 34 | Train Loss: 1.345 Vali Loss: 2.734 Vali Acc: 0.717 Test Loss: 2.734 Test Acc: 0.717
Validation loss decreased (-0.687843 --> -0.716736).  Saving model ...
Epoch: 8 cost time: 18.89081907272339
Epoch: 8, Steps: 34 | Train Loss: 1.059 Vali Loss: 6.684 Vali Acc: 0.491 Test Loss: 6.684 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.05071473121643
Epoch: 9, Steps: 34 | Train Loss: 0.878 Vali Loss: 10.533 Vali Acc: 0.457 Test Loss: 10.533 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.472396850585938
Epoch: 10, Steps: 34 | Train Loss: 0.716 Vali Loss: 2.660 Vali Acc: 0.717 Test Loss: 2.660 Test Acc: 0.717
Validation loss decreased (-0.716736 --> -0.716736).  Saving model ...
Epoch: 11 cost time: 18.534172296524048
Epoch: 11, Steps: 34 | Train Loss: 1.159 Vali Loss: 2.750 Vali Acc: 0.728 Test Loss: 2.750 Test Acc: 0.728
Validation loss decreased (-0.716736 --> -0.728296).  Saving model ...
Epoch: 12 cost time: 19.268962621688843
Epoch: 12, Steps: 34 | Train Loss: 0.791 Vali Loss: 11.447 Vali Acc: 0.618 Test Loss: 11.447 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.117716312408447
Epoch: 13, Steps: 34 | Train Loss: 1.033 Vali Loss: 2.989 Vali Acc: 0.809 Test Loss: 2.989 Test Acc: 0.809
Validation loss decreased (-0.728296 --> -0.809219).  Saving model ...
Epoch: 14 cost time: 19.046531438827515
Epoch: 14, Steps: 34 | Train Loss: 0.647 Vali Loss: 3.564 Vali Acc: 0.665 Test Loss: 3.564 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.655845642089844
Epoch: 15, Steps: 34 | Train Loss: 0.318 Vali Loss: 3.845 Vali Acc: 0.775 Test Loss: 3.845 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.143526315689087
Epoch: 16, Steps: 34 | Train Loss: 1.604 Vali Loss: 4.623 Vali Acc: 0.705 Test Loss: 4.623 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.84348225593567
Epoch: 17, Steps: 34 | Train Loss: 0.696 Vali Loss: 2.935 Vali Acc: 0.740 Test Loss: 2.935 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.837258100509644
Epoch: 18, Steps: 34 | Train Loss: 0.389 Vali Loss: 4.395 Vali Acc: 0.751 Test Loss: 4.395 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 20.179940462112427
Epoch: 19, Steps: 34 | Train Loss: 0.134 Vali Loss: 3.920 Vali Acc: 0.746 Test Loss: 3.920 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 21.100974798202515
Epoch: 20, Steps: 34 | Train Loss: 0.223 Vali Loss: 4.047 Vali Acc: 0.740 Test Loss: 4.047 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 17.528417825698853
Epoch: 21, Steps: 34 | Train Loss: 0.185 Vali Loss: 3.607 Vali Acc: 0.832 Test Loss: 3.607 Test Acc: 0.832
Validation loss decreased (-0.809219 --> -0.832334).  Saving model ...
Epoch: 22 cost time: 17.057817220687866
Epoch: 22, Steps: 34 | Train Loss: 0.242 Vali Loss: 5.798 Vali Acc: 0.746 Test Loss: 5.798 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 14.570924043655396
Epoch: 23, Steps: 34 | Train Loss: 0.714 Vali Loss: 4.456 Vali Acc: 0.792 Test Loss: 4.456 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.961929082870483
Epoch: 24, Steps: 34 | Train Loss: 0.343 Vali Loss: 9.791 Vali Acc: 0.746 Test Loss: 9.791 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 14.517919301986694
Epoch: 25, Steps: 34 | Train Loss: 1.629 Vali Loss: 3.373 Vali Acc: 0.746 Test Loss: 3.373 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 15.283788204193115
Epoch: 26, Steps: 34 | Train Loss: 0.198 Vali Loss: 3.401 Vali Acc: 0.786 Test Loss: 3.401 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 13.930637836456299
Epoch: 27, Steps: 34 | Train Loss: 0.184 Vali Loss: 4.050 Vali Acc: 0.769 Test Loss: 4.050 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 17.639315843582153
Epoch: 28, Steps: 34 | Train Loss: 0.323 Vali Loss: 6.328 Vali Acc: 0.751 Test Loss: 6.328 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 18.498283624649048
Epoch: 29, Steps: 34 | Train Loss: 0.578 Vali Loss: 5.027 Vali Acc: 0.705 Test Loss: 5.027 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 18.85204839706421
Epoch: 30, Steps: 34 | Train Loss: 0.851 Vali Loss: 3.528 Vali Acc: 0.723 Test Loss: 3.528 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 18.384161710739136
Epoch: 31, Steps: 34 | Train Loss: 0.914 Vali Loss: 6.815 Vali Acc: 0.659 Test Loss: 6.815 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3408643
model size : 14.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.387512922286987
Epoch: 1, Steps: 34 | Train Loss: 2.289 Vali Loss: 4.330 Vali Acc: 0.243 Test Loss: 4.330 Test Acc: 0.243
Validation loss decreased (inf --> -0.242731).  Saving model ...
Epoch: 2 cost time: 18.96004295349121
Epoch: 2, Steps: 34 | Train Loss: 3.823 Vali Loss: 3.874 Vali Acc: 0.468 Test Loss: 3.874 Test Acc: 0.468
Validation loss decreased (-0.242731 --> -0.468169).  Saving model ...
Epoch: 3 cost time: 20.44632339477539
Epoch: 3, Steps: 34 | Train Loss: 4.384 Vali Loss: 4.354 Vali Acc: 0.486 Test Loss: 4.354 Test Acc: 0.486
Validation loss decreased (-0.468169 --> -0.485506).  Saving model ...
Epoch: 4 cost time: 19.882656574249268
Epoch: 4, Steps: 34 | Train Loss: 3.167 Vali Loss: 6.597 Vali Acc: 0.439 Test Loss: 6.597 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.69101595878601
Epoch: 5, Steps: 34 | Train Loss: 2.745 Vali Loss: 4.348 Vali Acc: 0.682 Test Loss: 4.348 Test Acc: 0.682
Validation loss decreased (-0.485506 --> -0.682037).  Saving model ...
Epoch: 6 cost time: 18.135810136795044
Epoch: 6, Steps: 34 | Train Loss: 3.897 Vali Loss: 6.960 Vali Acc: 0.572 Test Loss: 6.960 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.593228101730347
Epoch: 7, Steps: 34 | Train Loss: 2.048 Vali Loss: 11.011 Vali Acc: 0.347 Test Loss: 11.011 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.73192262649536
Epoch: 8, Steps: 34 | Train Loss: 1.679 Vali Loss: 2.492 Vali Acc: 0.682 Test Loss: 2.492 Test Acc: 0.682
Validation loss decreased (-0.682037 --> -0.682056).  Saving model ...
Epoch: 9 cost time: 18.275001525878906
Epoch: 9, Steps: 34 | Train Loss: 1.979 Vali Loss: 4.775 Vali Acc: 0.705 Test Loss: 4.775 Test Acc: 0.705
Validation loss decreased (-0.682056 --> -0.705155).  Saving model ...
Epoch: 10 cost time: 17.79833722114563
Epoch: 10, Steps: 34 | Train Loss: 1.768 Vali Loss: 5.152 Vali Acc: 0.642 Test Loss: 5.152 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.582542657852173
Epoch: 11, Steps: 34 | Train Loss: 1.631 Vali Loss: 5.272 Vali Acc: 0.717 Test Loss: 5.272 Test Acc: 0.717
Validation loss decreased (-0.705155 --> -0.716710).  Saving model ...
Epoch: 12 cost time: 18.532931327819824
Epoch: 12, Steps: 34 | Train Loss: 1.337 Vali Loss: 2.460 Vali Acc: 0.751 Test Loss: 2.460 Test Acc: 0.751
Validation loss decreased (-0.716710 --> -0.751420).  Saving model ...
Epoch: 13 cost time: 17.570884704589844
Epoch: 13, Steps: 34 | Train Loss: 0.554 Vali Loss: 4.314 Vali Acc: 0.705 Test Loss: 4.314 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.115138292312622
Epoch: 14, Steps: 34 | Train Loss: 1.163 Vali Loss: 3.415 Vali Acc: 0.723 Test Loss: 3.415 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.209683418273926
Epoch: 15, Steps: 34 | Train Loss: 0.518 Vali Loss: 4.939 Vali Acc: 0.734 Test Loss: 4.939 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 18.524217128753662
Epoch: 16, Steps: 34 | Train Loss: 0.233 Vali Loss: 3.873 Vali Acc: 0.792 Test Loss: 3.873 Test Acc: 0.792
Validation loss decreased (-0.751420 --> -0.791869).  Saving model ...
Epoch: 17 cost time: 19.381345510482788
Epoch: 17, Steps: 34 | Train Loss: 0.342 Vali Loss: 3.747 Vali Acc: 0.769 Test Loss: 3.747 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.157079935073853
Epoch: 18, Steps: 34 | Train Loss: 0.464 Vali Loss: 5.049 Vali Acc: 0.728 Test Loss: 5.049 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 19.792775630950928
Epoch: 19, Steps: 34 | Train Loss: 0.570 Vali Loss: 4.143 Vali Acc: 0.740 Test Loss: 4.143 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 19.45093584060669
Epoch: 20, Steps: 34 | Train Loss: 0.085 Vali Loss: 3.894 Vali Acc: 0.775 Test Loss: 3.894 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 19.377368688583374
Epoch: 21, Steps: 34 | Train Loss: 0.186 Vali Loss: 3.802 Vali Acc: 0.803 Test Loss: 3.802 Test Acc: 0.803
Validation loss decreased (-0.791869 --> -0.803430).  Saving model ...
Epoch: 22 cost time: 19.31757950782776
Epoch: 22, Steps: 34 | Train Loss: 0.267 Vali Loss: 6.905 Vali Acc: 0.653 Test Loss: 6.905 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 19.166306018829346
Epoch: 23, Steps: 34 | Train Loss: 1.022 Vali Loss: 3.172 Vali Acc: 0.792 Test Loss: 3.172 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 17.659401655197144
Epoch: 24, Steps: 34 | Train Loss: 1.406 Vali Loss: 3.696 Vali Acc: 0.728 Test Loss: 3.696 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 18.550562620162964
Epoch: 25, Steps: 34 | Train Loss: 0.408 Vali Loss: 4.449 Vali Acc: 0.734 Test Loss: 4.449 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 19.854938507080078
Epoch: 26, Steps: 34 | Train Loss: 0.141 Vali Loss: 5.221 Vali Acc: 0.751 Test Loss: 5.221 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 17.11607336997986
Epoch: 27, Steps: 34 | Train Loss: 0.653 Vali Loss: 3.481 Vali Acc: 0.775 Test Loss: 3.481 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 18.58904457092285
Epoch: 28, Steps: 34 | Train Loss: 0.210 Vali Loss: 6.499 Vali Acc: 0.728 Test Loss: 6.499 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 15.86178207397461
Epoch: 29, Steps: 34 | Train Loss: 0.519 Vali Loss: 7.257 Vali Acc: 0.780 Test Loss: 7.257 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 19.061816692352295
Epoch: 30, Steps: 34 | Train Loss: 1.180 Vali Loss: 4.093 Vali Acc: 0.751 Test Loss: 4.093 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 17.590638637542725
Epoch: 31, Steps: 34 | Train Loss: 0.211 Vali Loss: 3.898 Vali Acc: 0.786 Test Loss: 3.898 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3407171
model size : 14.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.84722137451172
Epoch: 1, Steps: 34 | Train Loss: 2.413 Vali Loss: 2.518 Vali Acc: 0.387 Test Loss: 2.518 Test Acc: 0.387
Validation loss decreased (inf --> -0.387258).  Saving model ...
Epoch: 2 cost time: 18.49459719657898
Epoch: 2, Steps: 34 | Train Loss: 2.184 Vali Loss: 3.516 Vali Acc: 0.410 Test Loss: 3.516 Test Acc: 0.410
Validation loss decreased (-0.387258 --> -0.410369).  Saving model ...
Epoch: 3 cost time: 19.67289137840271
Epoch: 3, Steps: 34 | Train Loss: 2.632 Vali Loss: 4.992 Vali Acc: 0.439 Test Loss: 4.992 Test Acc: 0.439
Validation loss decreased (-0.410369 --> -0.439256).  Saving model ...
Epoch: 4 cost time: 18.21344566345215
Epoch: 4, Steps: 34 | Train Loss: 5.116 Vali Loss: 6.974 Vali Acc: 0.370 Test Loss: 6.974 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.986552953720093
Epoch: 5, Steps: 34 | Train Loss: 4.855 Vali Loss: 3.955 Vali Acc: 0.572 Test Loss: 3.955 Test Acc: 0.572
Validation loss decreased (-0.439256 --> -0.572215).  Saving model ...
Epoch: 6 cost time: 19.120306491851807
Epoch: 6, Steps: 34 | Train Loss: 2.786 Vali Loss: 2.147 Vali Acc: 0.688 Test Loss: 2.147 Test Acc: 0.688
Validation loss decreased (-0.572215 --> -0.687840).  Saving model ...
Epoch: 7 cost time: 19.08145546913147
Epoch: 7, Steps: 34 | Train Loss: 2.781 Vali Loss: 3.931 Vali Acc: 0.659 Test Loss: 3.931 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.542706489562988
Epoch: 8, Steps: 34 | Train Loss: 2.291 Vali Loss: 2.167 Vali Acc: 0.746 Test Loss: 2.167 Test Acc: 0.746
Validation loss decreased (-0.687840 --> -0.745643).  Saving model ...
Epoch: 9 cost time: 13.932381868362427
Epoch: 9, Steps: 34 | Train Loss: 1.995 Vali Loss: 3.554 Vali Acc: 0.671 Test Loss: 3.554 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.561227560043335
Epoch: 10, Steps: 34 | Train Loss: 1.084 Vali Loss: 4.219 Vali Acc: 0.699 Test Loss: 4.219 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.29378032684326
Epoch: 11, Steps: 34 | Train Loss: 0.997 Vali Loss: 3.385 Vali Acc: 0.751 Test Loss: 3.385 Test Acc: 0.751
Validation loss decreased (-0.745643 --> -0.751411).  Saving model ...
Epoch: 12 cost time: 18.297414302825928
Epoch: 12, Steps: 34 | Train Loss: 1.018 Vali Loss: 5.797 Vali Acc: 0.717 Test Loss: 5.797 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.407901287078857
Epoch: 13, Steps: 34 | Train Loss: 0.752 Vali Loss: 3.836 Vali Acc: 0.757 Test Loss: 3.836 Test Acc: 0.757
Validation loss decreased (-0.751411 --> -0.757187).  Saving model ...
Epoch: 14 cost time: 18.061025381088257
Epoch: 14, Steps: 34 | Train Loss: 0.917 Vali Loss: 3.609 Vali Acc: 0.780 Test Loss: 3.609 Test Acc: 0.780
Validation loss decreased (-0.757187 --> -0.780311).  Saving model ...
Epoch: 15 cost time: 19.54956555366516
Epoch: 15, Steps: 34 | Train Loss: 0.325 Vali Loss: 3.407 Vali Acc: 0.751 Test Loss: 3.407 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.636475801467896
Epoch: 16, Steps: 34 | Train Loss: 0.532 Vali Loss: 4.409 Vali Acc: 0.757 Test Loss: 4.409 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 18.043764114379883
Epoch: 17, Steps: 34 | Train Loss: 0.456 Vali Loss: 4.566 Vali Acc: 0.792 Test Loss: 4.566 Test Acc: 0.792
Validation loss decreased (-0.780311 --> -0.791862).  Saving model ...
Epoch: 18 cost time: 16.609926462173462
Epoch: 18, Steps: 34 | Train Loss: 0.249 Vali Loss: 2.710 Vali Acc: 0.844 Test Loss: 2.710 Test Acc: 0.844
Validation loss decreased (-0.791862 --> -0.843904).  Saving model ...
Epoch: 19 cost time: 18.224762678146362
Epoch: 19, Steps: 34 | Train Loss: 0.464 Vali Loss: 2.847 Vali Acc: 0.803 Test Loss: 2.847 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 19.809910774230957
Epoch: 20, Steps: 34 | Train Loss: 0.140 Vali Loss: 4.084 Vali Acc: 0.815 Test Loss: 4.084 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 18.69553232192993
Epoch: 21, Steps: 34 | Train Loss: 0.230 Vali Loss: 2.728 Vali Acc: 0.786 Test Loss: 2.728 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 20.40623903274536
Epoch: 22, Steps: 34 | Train Loss: 0.079 Vali Loss: 3.710 Vali Acc: 0.780 Test Loss: 3.710 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 17.816845178604126
Epoch: 23, Steps: 34 | Train Loss: 0.191 Vali Loss: 3.056 Vali Acc: 0.821 Test Loss: 3.056 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 20.844364643096924
Epoch: 24, Steps: 34 | Train Loss: 0.195 Vali Loss: 6.435 Vali Acc: 0.699 Test Loss: 6.435 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 17.54852557182312
Epoch: 25, Steps: 34 | Train Loss: 0.781 Vali Loss: 4.745 Vali Acc: 0.798 Test Loss: 4.745 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 17.85656452178955
Epoch: 26, Steps: 34 | Train Loss: 0.321 Vali Loss: 3.861 Vali Acc: 0.803 Test Loss: 3.861 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 17.16719102859497
Epoch: 27, Steps: 34 | Train Loss: 0.486 Vali Loss: 3.604 Vali Acc: 0.786 Test Loss: 3.604 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 17.181330680847168
Epoch: 28, Steps: 34 | Train Loss: 1.382 Vali Loss: 7.561 Vali Acc: 0.665 Test Loss: 7.561 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3405699
model size : 14.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.302285194396973
Epoch: 1, Steps: 34 | Train Loss: 2.330 Vali Loss: 2.990 Vali Acc: 0.364 Test Loss: 2.990 Test Acc: 0.364
Validation loss decreased (inf --> -0.364132).  Saving model ...
Epoch: 2 cost time: 17.061826944351196
Epoch: 2, Steps: 34 | Train Loss: 3.162 Vali Loss: 11.666 Vali Acc: 0.312 Test Loss: 11.666 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.9964280128479
Epoch: 3, Steps: 34 | Train Loss: 4.909 Vali Loss: 3.115 Vali Acc: 0.584 Test Loss: 3.115 Test Acc: 0.584
Validation loss decreased (-0.364132 --> -0.583784).  Saving model ...
Epoch: 4 cost time: 17.182767868041992
Epoch: 4, Steps: 34 | Train Loss: 2.671 Vali Loss: 6.907 Vali Acc: 0.422 Test Loss: 6.907 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.41915011405945
Epoch: 5, Steps: 34 | Train Loss: 2.415 Vali Loss: 4.268 Vali Acc: 0.543 Test Loss: 4.268 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.64341139793396
Epoch: 6, Steps: 34 | Train Loss: 1.900 Vali Loss: 2.041 Vali Acc: 0.688 Test Loss: 2.041 Test Acc: 0.688
Validation loss decreased (-0.583784 --> -0.687841).  Saving model ...
Epoch: 7 cost time: 16.210933923721313
Epoch: 7, Steps: 34 | Train Loss: 2.713 Vali Loss: 5.415 Vali Acc: 0.590 Test Loss: 5.415 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.655068397521973
Epoch: 8, Steps: 34 | Train Loss: 2.042 Vali Loss: 3.282 Vali Acc: 0.780 Test Loss: 3.282 Test Acc: 0.780
Validation loss decreased (-0.687841 --> -0.780314).  Saving model ...
Epoch: 9 cost time: 16.992995023727417
Epoch: 9, Steps: 34 | Train Loss: 1.258 Vali Loss: 2.205 Vali Acc: 0.775 Test Loss: 2.205 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.890500783920288
Epoch: 10, Steps: 34 | Train Loss: 1.521 Vali Loss: 3.206 Vali Acc: 0.694 Test Loss: 3.206 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.78145933151245
Epoch: 11, Steps: 34 | Train Loss: 1.379 Vali Loss: 3.461 Vali Acc: 0.780 Test Loss: 3.461 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.06490731239319
Epoch: 12, Steps: 34 | Train Loss: 0.504 Vali Loss: 2.549 Vali Acc: 0.775 Test Loss: 2.549 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.216303825378418
Epoch: 13, Steps: 34 | Train Loss: 0.744 Vali Loss: 4.454 Vali Acc: 0.792 Test Loss: 4.454 Test Acc: 0.792
Validation loss decreased (-0.780314 --> -0.791863).  Saving model ...
Epoch: 14 cost time: 20.7556209564209
Epoch: 14, Steps: 34 | Train Loss: 0.431 Vali Loss: 4.558 Vali Acc: 0.798 Test Loss: 4.558 Test Acc: 0.798
Validation loss decreased (-0.791863 --> -0.797642).  Saving model ...
Epoch: 15 cost time: 15.116935729980469
Epoch: 15, Steps: 34 | Train Loss: 1.026 Vali Loss: 3.603 Vali Acc: 0.803 Test Loss: 3.603 Test Acc: 0.803
Validation loss decreased (-0.797642 --> -0.803432).  Saving model ...
Epoch: 16 cost time: 15.949360609054565
Epoch: 16, Steps: 34 | Train Loss: 0.856 Vali Loss: 4.686 Vali Acc: 0.711 Test Loss: 4.686 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 17.30972957611084
Epoch: 17, Steps: 34 | Train Loss: 0.412 Vali Loss: 3.017 Vali Acc: 0.780 Test Loss: 3.017 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 17.23465609550476
Epoch: 18, Steps: 34 | Train Loss: 0.602 Vali Loss: 8.687 Vali Acc: 0.590 Test Loss: 8.687 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 17.41277289390564
Epoch: 19, Steps: 34 | Train Loss: 0.205 Vali Loss: 2.714 Vali Acc: 0.821 Test Loss: 2.714 Test Acc: 0.821
Validation loss decreased (-0.803432 --> -0.820782).  Saving model ...
Epoch: 20 cost time: 16.090080976486206
Epoch: 20, Steps: 34 | Train Loss: 0.195 Vali Loss: 8.590 Vali Acc: 0.642 Test Loss: 8.590 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.038109540939331
Epoch: 21, Steps: 34 | Train Loss: 0.550 Vali Loss: 3.567 Vali Acc: 0.792 Test Loss: 3.567 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.32035207748413
Epoch: 22, Steps: 34 | Train Loss: 0.523 Vali Loss: 3.979 Vali Acc: 0.792 Test Loss: 3.979 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 14.259543418884277
Epoch: 23, Steps: 34 | Train Loss: 0.348 Vali Loss: 5.344 Vali Acc: 0.757 Test Loss: 5.344 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 16.240699768066406
Epoch: 24, Steps: 34 | Train Loss: 0.191 Vali Loss: 3.867 Vali Acc: 0.803 Test Loss: 3.867 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 15.502061367034912
Epoch: 25, Steps: 34 | Train Loss: 0.319 Vali Loss: 3.081 Vali Acc: 0.827 Test Loss: 3.081 Test Acc: 0.827
Validation loss decreased (-0.820782 --> -0.826559).  Saving model ...
Epoch: 26 cost time: 16.69040060043335
Epoch: 26, Steps: 34 | Train Loss: 1.007 Vali Loss: 7.418 Vali Acc: 0.694 Test Loss: 7.418 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 18.032900094985962
Epoch: 27, Steps: 34 | Train Loss: 1.401 Vali Loss: 8.180 Vali Acc: 0.694 Test Loss: 8.180 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 15.983275651931763
Epoch: 28, Steps: 34 | Train Loss: 0.346 Vali Loss: 2.264 Vali Acc: 0.815 Test Loss: 2.264 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 17.92017388343811
Epoch: 29, Steps: 34 | Train Loss: 0.277 Vali Loss: 11.903 Vali Acc: 0.624 Test Loss: 11.903 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 16.943443775177002
Epoch: 30, Steps: 34 | Train Loss: 0.759 Vali Loss: 5.569 Vali Acc: 0.763 Test Loss: 5.569 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 18.06567645072937
Epoch: 31, Steps: 34 | Train Loss: 0.483 Vali Loss: 10.214 Vali Acc: 0.584 Test Loss: 10.214 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 18.954174041748047
Epoch: 32, Steps: 34 | Train Loss: 0.906 Vali Loss: 9.239 Vali Acc: 0.699 Test Loss: 9.239 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 18.715725660324097
Epoch: 33, Steps: 34 | Train Loss: 0.405 Vali Loss: 7.631 Vali Acc: 0.746 Test Loss: 7.631 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 17.239933252334595
Epoch: 34, Steps: 34 | Train Loss: 0.618 Vali Loss: 6.085 Vali Acc: 0.746 Test Loss: 6.085 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 16.75024724006653
Epoch: 35, Steps: 34 | Train Loss: 0.083 Vali Loss: 4.668 Vali Acc: 0.803 Test Loss: 4.668 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3404227
model size : 14.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.334141492843628
Epoch: 1, Steps: 34 | Train Loss: 2.976 Vali Loss: 2.309 Vali Acc: 0.329 Test Loss: 2.309 Test Acc: 0.329
Validation loss decreased (inf --> -0.329457).  Saving model ...
Epoch: 2 cost time: 16.41347646713257
Epoch: 2, Steps: 34 | Train Loss: 2.620 Vali Loss: 3.111 Vali Acc: 0.370 Test Loss: 3.111 Test Acc: 0.370
Validation loss decreased (-0.329457 --> -0.369911).  Saving model ...
Epoch: 3 cost time: 15.177748203277588
Epoch: 3, Steps: 34 | Train Loss: 2.621 Vali Loss: 2.297 Vali Acc: 0.590 Test Loss: 2.297 Test Acc: 0.590
Validation loss decreased (-0.369911 --> -0.589572).  Saving model ...
Epoch: 4 cost time: 15.911302328109741
Epoch: 4, Steps: 34 | Train Loss: 2.588 Vali Loss: 5.164 Vali Acc: 0.595 Test Loss: 5.164 Test Acc: 0.595
Validation loss decreased (-0.589572 --> -0.595324).  Saving model ...
Epoch: 5 cost time: 16.717438220977783
Epoch: 5, Steps: 34 | Train Loss: 2.783 Vali Loss: 2.406 Vali Acc: 0.665 Test Loss: 2.406 Test Acc: 0.665
Validation loss decreased (-0.595324 --> -0.664716).  Saving model ...
Epoch: 6 cost time: 16.409146785736084
Epoch: 6, Steps: 34 | Train Loss: 1.833 Vali Loss: 6.246 Vali Acc: 0.526 Test Loss: 6.246 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.18526339530945
Epoch: 7, Steps: 34 | Train Loss: 1.761 Vali Loss: 6.833 Vali Acc: 0.555 Test Loss: 6.833 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.103541135787964
Epoch: 8, Steps: 34 | Train Loss: 2.059 Vali Loss: 5.720 Vali Acc: 0.723 Test Loss: 5.720 Test Acc: 0.723
Validation loss decreased (-0.664716 --> -0.722486).  Saving model ...
Epoch: 9 cost time: 17.16319751739502
Epoch: 9, Steps: 34 | Train Loss: 2.631 Vali Loss: 5.903 Vali Acc: 0.682 Test Loss: 5.903 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.699905633926392
Epoch: 10, Steps: 34 | Train Loss: 1.629 Vali Loss: 4.096 Vali Acc: 0.665 Test Loss: 4.096 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.114336490631104
Epoch: 11, Steps: 34 | Train Loss: 2.861 Vali Loss: 3.195 Vali Acc: 0.792 Test Loss: 3.195 Test Acc: 0.792
Validation loss decreased (-0.722486 --> -0.791876).  Saving model ...
Epoch: 12 cost time: 17.550326108932495
Epoch: 12, Steps: 34 | Train Loss: 0.861 Vali Loss: 10.045 Vali Acc: 0.618 Test Loss: 10.045 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.59559679031372
Epoch: 13, Steps: 34 | Train Loss: 1.910 Vali Loss: 5.279 Vali Acc: 0.665 Test Loss: 5.279 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.279231071472168
Epoch: 14, Steps: 34 | Train Loss: 0.645 Vali Loss: 4.166 Vali Acc: 0.740 Test Loss: 4.166 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.454712390899658
Epoch: 15, Steps: 34 | Train Loss: 1.130 Vali Loss: 3.569 Vali Acc: 0.751 Test Loss: 3.569 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.984367609024048
Epoch: 16, Steps: 34 | Train Loss: 0.126 Vali Loss: 4.019 Vali Acc: 0.838 Test Loss: 4.019 Test Acc: 0.838
Validation loss decreased (-0.791876 --> -0.838110).  Saving model ...
Epoch: 17 cost time: 16.340014219284058
Epoch: 17, Steps: 34 | Train Loss: 0.384 Vali Loss: 4.654 Vali Acc: 0.763 Test Loss: 4.654 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.07921290397644
Epoch: 18, Steps: 34 | Train Loss: 1.028 Vali Loss: 10.078 Vali Acc: 0.630 Test Loss: 10.078 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 15.751670837402344
Epoch: 19, Steps: 34 | Train Loss: 0.381 Vali Loss: 5.199 Vali Acc: 0.757 Test Loss: 5.199 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.682434558868408
Epoch: 20, Steps: 34 | Train Loss: 0.907 Vali Loss: 3.849 Vali Acc: 0.803 Test Loss: 3.849 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.088847875595093
Epoch: 21, Steps: 34 | Train Loss: 0.507 Vali Loss: 2.956 Vali Acc: 0.821 Test Loss: 2.956 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.121279001235962
Epoch: 22, Steps: 34 | Train Loss: 0.254 Vali Loss: 3.341 Vali Acc: 0.832 Test Loss: 3.341 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 16.436723709106445
Epoch: 23, Steps: 34 | Train Loss: 0.500 Vali Loss: 4.922 Vali Acc: 0.827 Test Loss: 4.922 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 15.431471109390259
Epoch: 24, Steps: 34 | Train Loss: 0.319 Vali Loss: 7.384 Vali Acc: 0.775 Test Loss: 7.384 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 16.12260103225708
Epoch: 25, Steps: 34 | Train Loss: 0.379 Vali Loss: 5.551 Vali Acc: 0.844 Test Loss: 5.551 Test Acc: 0.844
Validation loss decreased (-0.838110 --> -0.843875).  Saving model ...
Epoch: 26 cost time: 17.073638200759888
Epoch: 26, Steps: 34 | Train Loss: 0.243 Vali Loss: 4.336 Vali Acc: 0.780 Test Loss: 4.336 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 16.147122859954834
Epoch: 27, Steps: 34 | Train Loss: 0.389 Vali Loss: 6.386 Vali Acc: 0.792 Test Loss: 6.386 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 16.81021213531494
Epoch: 28, Steps: 34 | Train Loss: 0.324 Vali Loss: 5.235 Vali Acc: 0.809 Test Loss: 5.235 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 14.868098497390747
Epoch: 29, Steps: 34 | Train Loss: 1.167 Vali Loss: 6.660 Vali Acc: 0.798 Test Loss: 6.660 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 17.742939949035645
Epoch: 30, Steps: 34 | Train Loss: 0.531 Vali Loss: 7.161 Vali Acc: 0.728 Test Loss: 7.161 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 18.33125901222229
Epoch: 31, Steps: 34 | Train Loss: 0.640 Vali Loss: 9.817 Vali Acc: 0.653 Test Loss: 9.817 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 18.01156735420227
Epoch: 32, Steps: 34 | Train Loss: 0.162 Vali Loss: 8.951 Vali Acc: 0.723 Test Loss: 8.951 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 14.104869365692139
Epoch: 33, Steps: 34 | Train Loss: 0.413 Vali Loss: 10.716 Vali Acc: 0.613 Test Loss: 10.716 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 13.763095140457153
Epoch: 34, Steps: 34 | Train Loss: 0.182 Vali Loss: 4.827 Vali Acc: 0.832 Test Loss: 4.827 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 12.759722232818604
Epoch: 35, Steps: 34 | Train Loss: 0.012 Vali Loss: 8.823 Vali Acc: 0.769 Test Loss: 8.823 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2814211
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.587223052978516
Epoch: 1, Steps: 34 | Train Loss: 2.959 Vali Loss: 3.074 Vali Acc: 0.353 Test Loss: 3.074 Test Acc: 0.353
Validation loss decreased (inf --> -0.352570).  Saving model ...
Epoch: 2 cost time: 16.257548332214355
Epoch: 2, Steps: 34 | Train Loss: 3.887 Vali Loss: 5.175 Vali Acc: 0.364 Test Loss: 5.175 Test Acc: 0.364
Validation loss decreased (-0.352570 --> -0.364110).  Saving model ...
Epoch: 3 cost time: 15.182298183441162
Epoch: 3, Steps: 34 | Train Loss: 6.547 Vali Loss: 6.546 Vali Acc: 0.393 Test Loss: 6.546 Test Acc: 0.393
Validation loss decreased (-0.364110 --> -0.392998).  Saving model ...
Epoch: 4 cost time: 15.8662109375
Epoch: 4, Steps: 34 | Train Loss: 4.992 Vali Loss: 5.007 Vali Acc: 0.549 Test Loss: 5.007 Test Acc: 0.549
Validation loss decreased (-0.392998 --> -0.549083).  Saving model ...
Epoch: 5 cost time: 16.06370186805725
Epoch: 5, Steps: 34 | Train Loss: 3.509 Vali Loss: 4.373 Vali Acc: 0.699 Test Loss: 4.373 Test Acc: 0.699
Validation loss decreased (-0.549083 --> -0.699378).  Saving model ...
Epoch: 6 cost time: 14.406916856765747
Epoch: 6, Steps: 34 | Train Loss: 4.688 Vali Loss: 3.908 Vali Acc: 0.665 Test Loss: 3.908 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.310148239135742
Epoch: 7, Steps: 34 | Train Loss: 3.129 Vali Loss: 3.586 Vali Acc: 0.653 Test Loss: 3.586 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.674444675445557
Epoch: 8, Steps: 34 | Train Loss: 2.144 Vali Loss: 5.314 Vali Acc: 0.618 Test Loss: 5.314 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.440144300460815
Epoch: 9, Steps: 34 | Train Loss: 1.797 Vali Loss: 4.396 Vali Acc: 0.688 Test Loss: 4.396 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.643657207489014
Epoch: 10, Steps: 34 | Train Loss: 2.303 Vali Loss: 6.243 Vali Acc: 0.532 Test Loss: 6.243 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 15.751256704330444
Epoch: 11, Steps: 34 | Train Loss: 1.384 Vali Loss: 3.550 Vali Acc: 0.705 Test Loss: 3.550 Test Acc: 0.705
Validation loss decreased (-0.699378 --> -0.705167).  Saving model ...
Epoch: 12 cost time: 15.941689014434814
Epoch: 12, Steps: 34 | Train Loss: 1.774 Vali Loss: 3.762 Vali Acc: 0.653 Test Loss: 3.762 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.840980291366577
Epoch: 13, Steps: 34 | Train Loss: 0.462 Vali Loss: 2.533 Vali Acc: 0.740 Test Loss: 2.533 Test Acc: 0.740
Validation loss decreased (-0.705167 --> -0.739859).  Saving model ...
Epoch: 14 cost time: 17.47496771812439
Epoch: 14, Steps: 34 | Train Loss: 0.473 Vali Loss: 3.788 Vali Acc: 0.757 Test Loss: 3.788 Test Acc: 0.757
Validation loss decreased (-0.739859 --> -0.757188).  Saving model ...
Epoch: 15 cost time: 16.902817010879517
Epoch: 15, Steps: 34 | Train Loss: 0.350 Vali Loss: 3.748 Vali Acc: 0.711 Test Loss: 3.748 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.321287393569946
Epoch: 16, Steps: 34 | Train Loss: 0.360 Vali Loss: 2.801 Vali Acc: 0.780 Test Loss: 2.801 Test Acc: 0.780
Validation loss decreased (-0.757188 --> -0.780319).  Saving model ...
Epoch: 17 cost time: 16.799882888793945
Epoch: 17, Steps: 34 | Train Loss: 0.457 Vali Loss: 3.158 Vali Acc: 0.728 Test Loss: 3.158 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.480334281921387
Epoch: 18, Steps: 34 | Train Loss: 0.483 Vali Loss: 4.460 Vali Acc: 0.699 Test Loss: 4.460 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 15.60736632347107
Epoch: 19, Steps: 34 | Train Loss: 0.925 Vali Loss: 3.171 Vali Acc: 0.786 Test Loss: 3.171 Test Acc: 0.786
Validation loss decreased (-0.780319 --> -0.786095).  Saving model ...
Epoch: 20 cost time: 17.1304452419281
Epoch: 20, Steps: 34 | Train Loss: 0.654 Vali Loss: 5.936 Vali Acc: 0.642 Test Loss: 5.936 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 15.15253496170044
Epoch: 21, Steps: 34 | Train Loss: 0.145 Vali Loss: 4.261 Vali Acc: 0.740 Test Loss: 4.261 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.034687519073486
Epoch: 22, Steps: 34 | Train Loss: 0.149 Vali Loss: 2.082 Vali Acc: 0.838 Test Loss: 2.082 Test Acc: 0.838
Validation loss decreased (-0.786095 --> -0.838129).  Saving model ...
Epoch: 23 cost time: 16.27804923057556
Epoch: 23, Steps: 34 | Train Loss: 0.276 Vali Loss: 4.810 Vali Acc: 0.728 Test Loss: 4.810 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 16.146634340286255
Epoch: 24, Steps: 34 | Train Loss: 0.297 Vali Loss: 4.087 Vali Acc: 0.786 Test Loss: 4.087 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 16.73561429977417
Epoch: 25, Steps: 34 | Train Loss: 0.814 Vali Loss: 4.180 Vali Acc: 0.769 Test Loss: 4.180 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 14.896773099899292
Epoch: 26, Steps: 34 | Train Loss: 0.251 Vali Loss: 5.190 Vali Acc: 0.717 Test Loss: 5.190 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 16.38564658164978
Epoch: 27, Steps: 34 | Train Loss: 0.527 Vali Loss: 3.411 Vali Acc: 0.734 Test Loss: 3.411 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 15.716507196426392
Epoch: 28, Steps: 34 | Train Loss: 0.159 Vali Loss: 4.522 Vali Acc: 0.780 Test Loss: 4.522 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 16.051689386367798
Epoch: 29, Steps: 34 | Train Loss: 0.042 Vali Loss: 3.896 Vali Acc: 0.821 Test Loss: 3.896 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 16.296196222305298
Epoch: 30, Steps: 34 | Train Loss: 0.075 Vali Loss: 7.783 Vali Acc: 0.682 Test Loss: 7.783 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 14.576572179794312
Epoch: 31, Steps: 34 | Train Loss: 0.316 Vali Loss: 3.957 Vali Acc: 0.769 Test Loss: 3.957 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 16.64808225631714
Epoch: 32, Steps: 34 | Train Loss: 0.751 Vali Loss: 4.820 Vali Acc: 0.757 Test Loss: 4.820 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2812739
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.9739830493927
Epoch: 1, Steps: 34 | Train Loss: 2.879 Vali Loss: 2.736 Vali Acc: 0.376 Test Loss: 2.736 Test Acc: 0.376
Validation loss decreased (inf --> -0.375695).  Saving model ...
Epoch: 2 cost time: 16.553346872329712
Epoch: 2, Steps: 34 | Train Loss: 3.071 Vali Loss: 4.461 Vali Acc: 0.405 Test Loss: 4.461 Test Acc: 0.405
Validation loss decreased (-0.375695 --> -0.404580).  Saving model ...
Epoch: 3 cost time: 15.344560384750366
Epoch: 3, Steps: 34 | Train Loss: 2.757 Vali Loss: 2.619 Vali Acc: 0.618 Test Loss: 2.619 Test Acc: 0.618
Validation loss decreased (-0.404580 --> -0.618471).  Saving model ...
Epoch: 4 cost time: 15.26486587524414
Epoch: 4, Steps: 34 | Train Loss: 2.219 Vali Loss: 2.096 Vali Acc: 0.584 Test Loss: 2.096 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.293216705322266
Epoch: 5, Steps: 34 | Train Loss: 1.951 Vali Loss: 11.284 Vali Acc: 0.457 Test Loss: 11.284 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.57205295562744
Epoch: 6, Steps: 34 | Train Loss: 5.423 Vali Loss: 7.795 Vali Acc: 0.572 Test Loss: 7.795 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.982467889785767
Epoch: 7, Steps: 34 | Train Loss: 3.085 Vali Loss: 8.330 Vali Acc: 0.538 Test Loss: 8.330 Test Acc: 0.538
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.365753650665283
Epoch: 8, Steps: 34 | Train Loss: 2.771 Vali Loss: 2.740 Vali Acc: 0.694 Test Loss: 2.740 Test Acc: 0.694
Validation loss decreased (-0.618471 --> -0.693614).  Saving model ...
Epoch: 9 cost time: 16.26285696029663
Epoch: 9, Steps: 34 | Train Loss: 1.717 Vali Loss: 3.182 Vali Acc: 0.717 Test Loss: 3.182 Test Acc: 0.717
Validation loss decreased (-0.693614 --> -0.716731).  Saving model ...
Epoch: 10 cost time: 15.888668298721313
Epoch: 10, Steps: 34 | Train Loss: 0.868 Vali Loss: 7.028 Vali Acc: 0.653 Test Loss: 7.028 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.00822639465332
Epoch: 11, Steps: 34 | Train Loss: 2.322 Vali Loss: 8.032 Vali Acc: 0.642 Test Loss: 8.032 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.420053720474243
Epoch: 12, Steps: 34 | Train Loss: 1.698 Vali Loss: 3.390 Vali Acc: 0.734 Test Loss: 3.390 Test Acc: 0.734
Validation loss decreased (-0.716731 --> -0.734070).  Saving model ...
Epoch: 13 cost time: 15.435873746871948
Epoch: 13, Steps: 34 | Train Loss: 2.714 Vali Loss: 21.696 Vali Acc: 0.578 Test Loss: 21.696 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.8094322681427
Epoch: 14, Steps: 34 | Train Loss: 1.690 Vali Loss: 8.949 Vali Acc: 0.636 Test Loss: 8.949 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.507948398590088
Epoch: 15, Steps: 34 | Train Loss: 0.839 Vali Loss: 4.983 Vali Acc: 0.763 Test Loss: 4.983 Test Acc: 0.763
Validation loss decreased (-0.734070 --> -0.762956).  Saving model ...
Epoch: 16 cost time: 15.474283456802368
Epoch: 16, Steps: 34 | Train Loss: 0.117 Vali Loss: 4.364 Vali Acc: 0.798 Test Loss: 4.364 Test Acc: 0.798
Validation loss decreased (-0.762956 --> -0.797644).  Saving model ...
Epoch: 17 cost time: 16.778387546539307
Epoch: 17, Steps: 34 | Train Loss: 0.765 Vali Loss: 8.872 Vali Acc: 0.723 Test Loss: 8.872 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.699491024017334
Epoch: 18, Steps: 34 | Train Loss: 0.455 Vali Loss: 6.353 Vali Acc: 0.740 Test Loss: 6.353 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 16.576452255249023
Epoch: 19, Steps: 34 | Train Loss: 0.453 Vali Loss: 7.013 Vali Acc: 0.734 Test Loss: 7.013 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.65099287033081
Epoch: 20, Steps: 34 | Train Loss: 0.077 Vali Loss: 5.248 Vali Acc: 0.746 Test Loss: 5.248 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.233027458190918
Epoch: 21, Steps: 34 | Train Loss: 0.559 Vali Loss: 4.295 Vali Acc: 0.798 Test Loss: 4.295 Test Acc: 0.798
Validation loss decreased (-0.797644 --> -0.797645).  Saving model ...
Epoch: 22 cost time: 14.330674409866333
Epoch: 22, Steps: 34 | Train Loss: 0.879 Vali Loss: 4.276 Vali Acc: 0.792 Test Loss: 4.276 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.906368017196655
Epoch: 23, Steps: 34 | Train Loss: 0.284 Vali Loss: 6.707 Vali Acc: 0.711 Test Loss: 6.707 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.57069730758667
Epoch: 24, Steps: 34 | Train Loss: 0.129 Vali Loss: 3.708 Vali Acc: 0.827 Test Loss: 3.708 Test Acc: 0.827
Validation loss decreased (-0.797645 --> -0.826553).  Saving model ...
Epoch: 25 cost time: 16.70371127128601
Epoch: 25, Steps: 34 | Train Loss: 0.287 Vali Loss: 8.791 Vali Acc: 0.740 Test Loss: 8.791 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 15.874970436096191
Epoch: 26, Steps: 34 | Train Loss: 0.513 Vali Loss: 6.980 Vali Acc: 0.757 Test Loss: 6.980 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 15.693535089492798
Epoch: 27, Steps: 34 | Train Loss: 0.154 Vali Loss: 4.365 Vali Acc: 0.786 Test Loss: 4.365 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 16.097700834274292
Epoch: 28, Steps: 34 | Train Loss: 0.169 Vali Loss: 9.954 Vali Acc: 0.757 Test Loss: 9.954 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 15.867155075073242
Epoch: 29, Steps: 34 | Train Loss: 0.133 Vali Loss: 5.819 Vali Acc: 0.798 Test Loss: 5.819 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 17.01130437850952
Epoch: 30, Steps: 34 | Train Loss: 0.076 Vali Loss: 5.717 Vali Acc: 0.821 Test Loss: 5.717 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 15.90922737121582
Epoch: 31, Steps: 34 | Train Loss: 0.178 Vali Loss: 6.198 Vali Acc: 0.815 Test Loss: 6.198 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 16.09826636314392
Epoch: 32, Steps: 34 | Train Loss: 0.160 Vali Loss: 3.566 Vali Acc: 0.827 Test Loss: 3.566 Test Acc: 0.827
Validation loss decreased (-0.826553 --> -0.826554).  Saving model ...
Epoch: 33 cost time: 15.92165994644165
Epoch: 33, Steps: 34 | Train Loss: 0.169 Vali Loss: 4.878 Vali Acc: 0.815 Test Loss: 4.878 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 16.521826028823853
Epoch: 34, Steps: 34 | Train Loss: 0.173 Vali Loss: 5.026 Vali Acc: 0.821 Test Loss: 5.026 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 17.26604437828064
Epoch: 35, Steps: 34 | Train Loss: 0.146 Vali Loss: 7.869 Vali Acc: 0.780 Test Loss: 7.869 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 16.451056480407715
Epoch: 36, Steps: 34 | Train Loss: 0.244 Vali Loss: 6.458 Vali Acc: 0.786 Test Loss: 6.458 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 17.447263479232788
Epoch: 37, Steps: 34 | Train Loss: 0.609 Vali Loss: 4.632 Vali Acc: 0.815 Test Loss: 4.632 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 15.675918817520142
Epoch: 38, Steps: 34 | Train Loss: 1.146 Vali Loss: 9.825 Vali Acc: 0.711 Test Loss: 9.825 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 18.31015372276306
Epoch: 39, Steps: 34 | Train Loss: 1.418 Vali Loss: 10.013 Vali Acc: 0.746 Test Loss: 10.013 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 15.630690574645996
Epoch: 40, Steps: 34 | Train Loss: 1.051 Vali Loss: 7.480 Vali Acc: 0.792 Test Loss: 7.480 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 15.656574010848999
Epoch: 41, Steps: 34 | Train Loss: 0.470 Vali Loss: 8.354 Vali Acc: 0.734 Test Loss: 8.354 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 14.682270526885986
Epoch: 42, Steps: 34 | Train Loss: 0.472 Vali Loss: 6.033 Vali Acc: 0.821 Test Loss: 6.033 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2811267
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.109909772872925
Epoch: 1, Steps: 34 | Train Loss: 2.403 Vali Loss: 3.268 Vali Acc: 0.318 Test Loss: 3.268 Test Acc: 0.318
Validation loss decreased (inf --> -0.317886).  Saving model ...
Epoch: 2 cost time: 13.943748474121094
Epoch: 2, Steps: 34 | Train Loss: 3.102 Vali Loss: 5.130 Vali Acc: 0.341 Test Loss: 5.130 Test Acc: 0.341
Validation loss decreased (-0.317886 --> -0.340989).  Saving model ...
Epoch: 3 cost time: 15.14854097366333
Epoch: 3, Steps: 34 | Train Loss: 3.622 Vali Loss: 2.063 Vali Acc: 0.514 Test Loss: 2.063 Test Acc: 0.514
Validation loss decreased (-0.340989 --> -0.514430).  Saving model ...
Epoch: 4 cost time: 12.730189085006714
Epoch: 4, Steps: 34 | Train Loss: 2.965 Vali Loss: 4.031 Vali Acc: 0.566 Test Loss: 4.031 Test Acc: 0.566
Validation loss decreased (-0.514430 --> -0.566434).  Saving model ...
Epoch: 5 cost time: 15.235917091369629
Epoch: 5, Steps: 34 | Train Loss: 4.130 Vali Loss: 6.290 Vali Acc: 0.468 Test Loss: 6.290 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.656620025634766
Epoch: 6, Steps: 34 | Train Loss: 3.469 Vali Loss: 3.715 Vali Acc: 0.642 Test Loss: 3.715 Test Acc: 0.642
Validation loss decreased (-0.566434 --> -0.641581).  Saving model ...
Epoch: 7 cost time: 15.043662548065186
Epoch: 7, Steps: 34 | Train Loss: 3.254 Vali Loss: 5.272 Vali Acc: 0.613 Test Loss: 5.272 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.976718425750732
Epoch: 8, Steps: 34 | Train Loss: 3.207 Vali Loss: 3.748 Vali Acc: 0.665 Test Loss: 3.748 Test Acc: 0.665
Validation loss decreased (-0.641581 --> -0.664702).  Saving model ...
Epoch: 9 cost time: 13.368980884552002
Epoch: 9, Steps: 34 | Train Loss: 1.735 Vali Loss: 4.876 Vali Acc: 0.590 Test Loss: 4.876 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.99064540863037
Epoch: 10, Steps: 34 | Train Loss: 1.838 Vali Loss: 8.114 Vali Acc: 0.618 Test Loss: 8.114 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.76319408416748
Epoch: 11, Steps: 34 | Train Loss: 1.439 Vali Loss: 3.860 Vali Acc: 0.746 Test Loss: 3.860 Test Acc: 0.746
Validation loss decreased (-0.664702 --> -0.745626).  Saving model ...
Epoch: 12 cost time: 15.657374382019043
Epoch: 12, Steps: 34 | Train Loss: 0.357 Vali Loss: 3.684 Vali Acc: 0.751 Test Loss: 3.684 Test Acc: 0.751
Validation loss decreased (-0.745626 --> -0.751408).  Saving model ...
Epoch: 13 cost time: 16.105989456176758
Epoch: 13, Steps: 34 | Train Loss: 0.212 Vali Loss: 3.656 Vali Acc: 0.780 Test Loss: 3.656 Test Acc: 0.780
Validation loss decreased (-0.751408 --> -0.780310).  Saving model ...
Epoch: 14 cost time: 15.796818017959595
Epoch: 14, Steps: 34 | Train Loss: 0.137 Vali Loss: 6.916 Vali Acc: 0.665 Test Loss: 6.916 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.957584142684937
Epoch: 15, Steps: 34 | Train Loss: 0.620 Vali Loss: 4.478 Vali Acc: 0.751 Test Loss: 4.478 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.652130365371704
Epoch: 16, Steps: 34 | Train Loss: 0.588 Vali Loss: 4.490 Vali Acc: 0.717 Test Loss: 4.490 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.761526346206665
Epoch: 17, Steps: 34 | Train Loss: 0.528 Vali Loss: 3.205 Vali Acc: 0.803 Test Loss: 3.205 Test Acc: 0.803
Validation loss decreased (-0.780310 --> -0.803436).  Saving model ...
Epoch: 18 cost time: 14.323187112808228
Epoch: 18, Steps: 34 | Train Loss: 0.413 Vali Loss: 5.581 Vali Acc: 0.769 Test Loss: 5.581 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.946539878845215
Epoch: 19, Steps: 34 | Train Loss: 0.244 Vali Loss: 4.360 Vali Acc: 0.780 Test Loss: 4.360 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 15.623342037200928
Epoch: 20, Steps: 34 | Train Loss: 0.310 Vali Loss: 4.737 Vali Acc: 0.803 Test Loss: 4.737 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 15.0955650806427
Epoch: 21, Steps: 34 | Train Loss: 0.380 Vali Loss: 3.242 Vali Acc: 0.809 Test Loss: 3.242 Test Acc: 0.809
Validation loss decreased (-0.803436 --> -0.809216).  Saving model ...
Epoch: 22 cost time: 14.499362230300903
Epoch: 22, Steps: 34 | Train Loss: 0.368 Vali Loss: 7.048 Vali Acc: 0.688 Test Loss: 7.048 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.198516607284546
Epoch: 23, Steps: 34 | Train Loss: 0.479 Vali Loss: 3.930 Vali Acc: 0.803 Test Loss: 3.930 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.576659917831421
Epoch: 24, Steps: 34 | Train Loss: 0.134 Vali Loss: 6.992 Vali Acc: 0.717 Test Loss: 6.992 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 14.821935892105103
Epoch: 25, Steps: 34 | Train Loss: 0.666 Vali Loss: 3.611 Vali Acc: 0.809 Test Loss: 3.611 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.350392818450928
Epoch: 26, Steps: 34 | Train Loss: 0.192 Vali Loss: 3.821 Vali Acc: 0.763 Test Loss: 3.821 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 15.402889490127563
Epoch: 27, Steps: 34 | Train Loss: 0.632 Vali Loss: 4.674 Vali Acc: 0.798 Test Loss: 4.674 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 14.429506778717041
Epoch: 28, Steps: 34 | Train Loss: 0.321 Vali Loss: 3.744 Vali Acc: 0.832 Test Loss: 3.744 Test Acc: 0.832
Validation loss decreased (-0.809216 --> -0.832332).  Saving model ...
Epoch: 29 cost time: 15.988648891448975
Epoch: 29, Steps: 34 | Train Loss: 0.497 Vali Loss: 3.224 Vali Acc: 0.798 Test Loss: 3.224 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 15.896592617034912
Epoch: 30, Steps: 34 | Train Loss: 0.518 Vali Loss: 3.676 Vali Acc: 0.786 Test Loss: 3.676 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 15.681350231170654
Epoch: 31, Steps: 34 | Train Loss: 0.216 Vali Loss: 5.472 Vali Acc: 0.786 Test Loss: 5.472 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 15.752561569213867
Epoch: 32, Steps: 34 | Train Loss: 0.699 Vali Loss: 10.065 Vali Acc: 0.723 Test Loss: 10.065 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 15.503172636032104
Epoch: 33, Steps: 34 | Train Loss: 0.906 Vali Loss: 4.554 Vali Acc: 0.740 Test Loss: 4.554 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 17.14162826538086
Epoch: 34, Steps: 34 | Train Loss: 0.924 Vali Loss: 10.999 Vali Acc: 0.734 Test Loss: 10.999 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 15.081781387329102
Epoch: 35, Steps: 34 | Train Loss: 0.637 Vali Loss: 7.993 Vali Acc: 0.734 Test Loss: 7.993 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 14.792635679244995
Epoch: 36, Steps: 34 | Train Loss: 0.383 Vali Loss: 5.054 Vali Acc: 0.740 Test Loss: 5.054 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 14.70384430885315
Epoch: 37, Steps: 34 | Train Loss: 0.359 Vali Loss: 5.551 Vali Acc: 0.769 Test Loss: 5.551 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 15.393632173538208
Epoch: 38, Steps: 34 | Train Loss: 0.308 Vali Loss: 6.000 Vali Acc: 0.786 Test Loss: 6.000 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2809795
model size : 12.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.898767948150635
Epoch: 1, Steps: 34 | Train Loss: 2.237 Vali Loss: 2.404 Vali Acc: 0.341 Test Loss: 2.404 Test Acc: 0.341
Validation loss decreased (inf --> -0.341016).  Saving model ...
Epoch: 2 cost time: 14.427706480026245
Epoch: 2, Steps: 34 | Train Loss: 2.343 Vali Loss: 3.924 Vali Acc: 0.451 Test Loss: 3.924 Test Acc: 0.451
Validation loss decreased (-0.341016 --> -0.450828).  Saving model ...
Epoch: 3 cost time: 14.553563117980957
Epoch: 3, Steps: 34 | Train Loss: 3.041 Vali Loss: 5.305 Vali Acc: 0.434 Test Loss: 5.305 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.404999494552612
Epoch: 4, Steps: 34 | Train Loss: 4.249 Vali Loss: 3.003 Vali Acc: 0.653 Test Loss: 3.003 Test Acc: 0.653
Validation loss decreased (-0.450828 --> -0.653149).  Saving model ...
Epoch: 5 cost time: 15.629250764846802
Epoch: 5, Steps: 34 | Train Loss: 3.974 Vali Loss: 4.891 Vali Acc: 0.509 Test Loss: 4.891 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.558834552764893
Epoch: 6, Steps: 34 | Train Loss: 2.978 Vali Loss: 1.926 Vali Acc: 0.734 Test Loss: 1.926 Test Acc: 0.734
Validation loss decreased (-0.653149 --> -0.734085).  Saving model ...
Epoch: 7 cost time: 13.772161722183228
Epoch: 7, Steps: 34 | Train Loss: 2.366 Vali Loss: 4.947 Vali Acc: 0.682 Test Loss: 4.947 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.681955575942993
Epoch: 8, Steps: 34 | Train Loss: 2.625 Vali Loss: 4.975 Vali Acc: 0.717 Test Loss: 4.975 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.28757119178772
Epoch: 9, Steps: 34 | Train Loss: 1.718 Vali Loss: 5.243 Vali Acc: 0.584 Test Loss: 5.243 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.36260414123535
Epoch: 10, Steps: 34 | Train Loss: 1.229 Vali Loss: 3.403 Vali Acc: 0.705 Test Loss: 3.403 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.806884050369263
Epoch: 11, Steps: 34 | Train Loss: 0.863 Vali Loss: 6.027 Vali Acc: 0.590 Test Loss: 6.027 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.25198483467102
Epoch: 12, Steps: 34 | Train Loss: 1.220 Vali Loss: 7.592 Vali Acc: 0.624 Test Loss: 7.592 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.747387409210205
Epoch: 13, Steps: 34 | Train Loss: 1.512 Vali Loss: 8.538 Vali Acc: 0.607 Test Loss: 8.538 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.568948030471802
Epoch: 14, Steps: 34 | Train Loss: 1.212 Vali Loss: 9.927 Vali Acc: 0.578 Test Loss: 9.927 Test Acc: 0.578
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.378727197647095
Epoch: 15, Steps: 34 | Train Loss: 1.507 Vali Loss: 3.997 Vali Acc: 0.740 Test Loss: 3.997 Test Acc: 0.740
Validation loss decreased (-0.734085 --> -0.739844).  Saving model ...
Epoch: 16 cost time: 13.504779815673828
Epoch: 16, Steps: 34 | Train Loss: 0.958 Vali Loss: 5.559 Vali Acc: 0.665 Test Loss: 5.559 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.431248426437378
Epoch: 17, Steps: 34 | Train Loss: 0.322 Vali Loss: 4.230 Vali Acc: 0.809 Test Loss: 4.230 Test Acc: 0.809
Validation loss decreased (-0.739844 --> -0.809206).  Saving model ...
Epoch: 18 cost time: 14.551270008087158
Epoch: 18, Steps: 34 | Train Loss: 0.159 Vali Loss: 3.554 Vali Acc: 0.815 Test Loss: 3.554 Test Acc: 0.815
Validation loss decreased (-0.809206 --> -0.814993).  Saving model ...
Epoch: 19 cost time: 14.812873125076294
Epoch: 19, Steps: 34 | Train Loss: 0.261 Vali Loss: 6.301 Vali Acc: 0.763 Test Loss: 6.301 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.698888778686523
Epoch: 20, Steps: 34 | Train Loss: 0.138 Vali Loss: 4.482 Vali Acc: 0.775 Test Loss: 4.482 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 15.176095008850098
Epoch: 21, Steps: 34 | Train Loss: 1.204 Vali Loss: 4.069 Vali Acc: 0.763 Test Loss: 4.069 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.221181392669678
Epoch: 22, Steps: 34 | Train Loss: 0.301 Vali Loss: 3.797 Vali Acc: 0.792 Test Loss: 3.797 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.72277045249939
Epoch: 23, Steps: 34 | Train Loss: 0.222 Vali Loss: 3.184 Vali Acc: 0.821 Test Loss: 3.184 Test Acc: 0.821
Validation loss decreased (-0.814993 --> -0.820777).  Saving model ...
Epoch: 24 cost time: 13.315483808517456
Epoch: 24, Steps: 34 | Train Loss: 0.139 Vali Loss: 5.725 Vali Acc: 0.740 Test Loss: 5.725 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 14.520570993423462
Epoch: 25, Steps: 34 | Train Loss: 0.073 Vali Loss: 4.673 Vali Acc: 0.775 Test Loss: 4.673 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.87182331085205
Epoch: 26, Steps: 34 | Train Loss: 0.318 Vali Loss: 5.041 Vali Acc: 0.711 Test Loss: 5.041 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 14.56664228439331
Epoch: 27, Steps: 34 | Train Loss: 0.617 Vali Loss: 2.843 Vali Acc: 0.821 Test Loss: 2.843 Test Acc: 0.821
Validation loss decreased (-0.820777 --> -0.820781).  Saving model ...
Epoch: 28 cost time: 14.55758547782898
Epoch: 28, Steps: 34 | Train Loss: 0.530 Vali Loss: 4.134 Vali Acc: 0.821 Test Loss: 4.134 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 14.442500829696655
Epoch: 29, Steps: 34 | Train Loss: 0.591 Vali Loss: 4.685 Vali Acc: 0.780 Test Loss: 4.685 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 16.286296129226685
Epoch: 30, Steps: 34 | Train Loss: 0.687 Vali Loss: 14.486 Vali Acc: 0.555 Test Loss: 14.486 Test Acc: 0.555
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 16.420440912246704
Epoch: 31, Steps: 34 | Train Loss: 0.669 Vali Loss: 9.196 Vali Acc: 0.757 Test Loss: 9.196 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 15.543667554855347
Epoch: 32, Steps: 34 | Train Loss: 0.584 Vali Loss: 7.059 Vali Acc: 0.786 Test Loss: 7.059 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 15.412676572799683
Epoch: 33, Steps: 34 | Train Loss: 0.335 Vali Loss: 7.863 Vali Acc: 0.682 Test Loss: 7.863 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 14.759408712387085
Epoch: 34, Steps: 34 | Train Loss: 0.217 Vali Loss: 3.567 Vali Acc: 0.815 Test Loss: 3.567 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 14.352980375289917
Epoch: 35, Steps: 34 | Train Loss: 0.081 Vali Loss: 5.112 Vali Acc: 0.803 Test Loss: 5.112 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 15.560538530349731
Epoch: 36, Steps: 34 | Train Loss: 0.054 Vali Loss: 6.175 Vali Acc: 0.746 Test Loss: 6.175 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 14.228180646896362
Epoch: 37, Steps: 34 | Train Loss: 0.067 Vali Loss: 6.096 Vali Acc: 0.769 Test Loss: 6.096 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2516995
model size : 11.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.93301796913147
Epoch: 1, Steps: 34 | Train Loss: 2.274 Vali Loss: 2.551 Vali Acc: 0.289 Test Loss: 2.551 Test Acc: 0.289
Validation loss decreased (inf --> -0.288992).  Saving model ...
Epoch: 2 cost time: 14.329094886779785
Epoch: 2, Steps: 34 | Train Loss: 2.844 Vali Loss: 1.978 Vali Acc: 0.491 Test Loss: 1.978 Test Acc: 0.491
Validation loss decreased (-0.288992 --> -0.491310).  Saving model ...
Epoch: 3 cost time: 15.262195348739624
Epoch: 3, Steps: 34 | Train Loss: 2.841 Vali Loss: 8.519 Vali Acc: 0.312 Test Loss: 8.519 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.324111223220825
Epoch: 4, Steps: 34 | Train Loss: 2.529 Vali Loss: 3.166 Vali Acc: 0.543 Test Loss: 3.166 Test Acc: 0.543
Validation loss decreased (-0.491310 --> -0.543321).  Saving model ...
Epoch: 5 cost time: 14.179672241210938
Epoch: 5, Steps: 34 | Train Loss: 1.954 Vali Loss: 2.002 Vali Acc: 0.613 Test Loss: 2.002 Test Acc: 0.613
Validation loss decreased (-0.543321 --> -0.612697).  Saving model ...
Epoch: 6 cost time: 13.95960545539856
Epoch: 6, Steps: 34 | Train Loss: 3.552 Vali Loss: 3.836 Vali Acc: 0.647 Test Loss: 3.836 Test Acc: 0.647
Validation loss decreased (-0.612697 --> -0.647360).  Saving model ...
Epoch: 7 cost time: 15.041686773300171
Epoch: 7, Steps: 34 | Train Loss: 2.620 Vali Loss: 5.515 Vali Acc: 0.590 Test Loss: 5.515 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.372166633605957
Epoch: 8, Steps: 34 | Train Loss: 1.074 Vali Loss: 6.458 Vali Acc: 0.613 Test Loss: 6.458 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.282259225845337
Epoch: 9, Steps: 34 | Train Loss: 3.548 Vali Loss: 6.711 Vali Acc: 0.636 Test Loss: 6.711 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.376268148422241
Epoch: 10, Steps: 34 | Train Loss: 1.865 Vali Loss: 6.023 Vali Acc: 0.723 Test Loss: 6.023 Test Acc: 0.723
Validation loss decreased (-0.647360 --> -0.722483).  Saving model ...
Epoch: 11 cost time: 15.037218570709229
Epoch: 11, Steps: 34 | Train Loss: 2.649 Vali Loss: 3.090 Vali Acc: 0.763 Test Loss: 3.090 Test Acc: 0.763
Validation loss decreased (-0.722483 --> -0.762975).  Saving model ...
Epoch: 12 cost time: 15.790344476699829
Epoch: 12, Steps: 34 | Train Loss: 0.832 Vali Loss: 2.747 Vali Acc: 0.786 Test Loss: 2.747 Test Acc: 0.786
Validation loss decreased (-0.762975 --> -0.786100).  Saving model ...
Epoch: 13 cost time: 16.77423119544983
Epoch: 13, Steps: 34 | Train Loss: 0.817 Vali Loss: 5.001 Vali Acc: 0.728 Test Loss: 5.001 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.008216619491577
Epoch: 14, Steps: 34 | Train Loss: 1.075 Vali Loss: 5.518 Vali Acc: 0.740 Test Loss: 5.518 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.72346806526184
Epoch: 15, Steps: 34 | Train Loss: 1.253 Vali Loss: 2.750 Vali Acc: 0.821 Test Loss: 2.750 Test Acc: 0.821
Validation loss decreased (-0.786100 --> -0.820782).  Saving model ...
Epoch: 16 cost time: 14.015733480453491
Epoch: 16, Steps: 34 | Train Loss: 0.736 Vali Loss: 7.544 Vali Acc: 0.699 Test Loss: 7.544 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.697862386703491
Epoch: 17, Steps: 34 | Train Loss: 0.420 Vali Loss: 4.189 Vali Acc: 0.815 Test Loss: 4.189 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.785021543502808
Epoch: 18, Steps: 34 | Train Loss: 0.842 Vali Loss: 10.128 Vali Acc: 0.636 Test Loss: 10.128 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.58413052558899
Epoch: 19, Steps: 34 | Train Loss: 0.497 Vali Loss: 3.748 Vali Acc: 0.832 Test Loss: 3.748 Test Acc: 0.832
Validation loss decreased (-0.820782 --> -0.832332).  Saving model ...
Epoch: 20 cost time: 14.741270303726196
Epoch: 20, Steps: 34 | Train Loss: 0.445 Vali Loss: 8.220 Vali Acc: 0.694 Test Loss: 8.220 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.0498628616333
Epoch: 21, Steps: 34 | Train Loss: 0.143 Vali Loss: 4.216 Vali Acc: 0.815 Test Loss: 4.216 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 15.520318269729614
Epoch: 22, Steps: 34 | Train Loss: 0.310 Vali Loss: 4.086 Vali Acc: 0.803 Test Loss: 4.086 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 14.706899881362915
Epoch: 23, Steps: 34 | Train Loss: 0.098 Vali Loss: 3.372 Vali Acc: 0.792 Test Loss: 3.372 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.927651405334473
Epoch: 24, Steps: 34 | Train Loss: 0.582 Vali Loss: 5.624 Vali Acc: 0.786 Test Loss: 5.624 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 14.536256074905396
Epoch: 25, Steps: 34 | Train Loss: 0.327 Vali Loss: 5.304 Vali Acc: 0.792 Test Loss: 5.304 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 13.767897605895996
Epoch: 26, Steps: 34 | Train Loss: 0.326 Vali Loss: 10.696 Vali Acc: 0.763 Test Loss: 10.696 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 15.070628881454468
Epoch: 27, Steps: 34 | Train Loss: 0.796 Vali Loss: 6.752 Vali Acc: 0.769 Test Loss: 6.752 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 14.169549226760864
Epoch: 28, Steps: 34 | Train Loss: 0.261 Vali Loss: 3.561 Vali Acc: 0.850 Test Loss: 3.561 Test Acc: 0.850
Validation loss decreased (-0.832332 --> -0.849675).  Saving model ...
Epoch: 29 cost time: 14.991293907165527
Epoch: 29, Steps: 34 | Train Loss: 0.047 Vali Loss: 4.880 Vali Acc: 0.850 Test Loss: 4.880 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 12.631343126296997
Epoch: 30, Steps: 34 | Train Loss: 0.233 Vali Loss: 7.123 Vali Acc: 0.751 Test Loss: 7.123 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 15.710474729537964
Epoch: 31, Steps: 34 | Train Loss: 0.027 Vali Loss: 2.848 Vali Acc: 0.838 Test Loss: 2.848 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 15.956160306930542
Epoch: 32, Steps: 34 | Train Loss: 0.024 Vali Loss: 3.545 Vali Acc: 0.827 Test Loss: 3.545 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 15.495734691619873
Epoch: 33, Steps: 34 | Train Loss: 0.115 Vali Loss: 7.707 Vali Acc: 0.798 Test Loss: 7.707 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 15.184760332107544
Epoch: 34, Steps: 34 | Train Loss: 0.034 Vali Loss: 4.144 Vali Acc: 0.786 Test Loss: 4.144 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 13.95816445350647
Epoch: 35, Steps: 34 | Train Loss: 0.031 Vali Loss: 5.782 Vali Acc: 0.832 Test Loss: 5.782 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 14.215553522109985
Epoch: 36, Steps: 34 | Train Loss: 0.475 Vali Loss: 4.665 Vali Acc: 0.815 Test Loss: 4.665 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 15.027849435806274
Epoch: 37, Steps: 34 | Train Loss: 0.299 Vali Loss: 5.530 Vali Acc: 0.815 Test Loss: 5.530 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 14.354601383209229
Epoch: 38, Steps: 34 | Train Loss: 0.382 Vali Loss: 10.774 Vali Acc: 0.613 Test Loss: 10.774 Test Acc: 0.613
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2515523
model size : 11.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.866509199142456
Epoch: 1, Steps: 34 | Train Loss: 2.543 Vali Loss: 2.239 Vali Acc: 0.312 Test Loss: 2.239 Test Acc: 0.312
Validation loss decreased (inf --> -0.312116).  Saving model ...
Epoch: 2 cost time: 14.081109285354614
Epoch: 2, Steps: 34 | Train Loss: 2.923 Vali Loss: 7.609 Vali Acc: 0.393 Test Loss: 7.609 Test Acc: 0.393
Validation loss decreased (-0.312116 --> -0.392987).  Saving model ...
Epoch: 3 cost time: 14.695385217666626
Epoch: 3, Steps: 34 | Train Loss: 4.456 Vali Loss: 4.046 Vali Acc: 0.462 Test Loss: 4.046 Test Acc: 0.462
Validation loss decreased (-0.392987 --> -0.462387).  Saving model ...
Epoch: 4 cost time: 14.153228998184204
Epoch: 4, Steps: 34 | Train Loss: 4.303 Vali Loss: 9.092 Vali Acc: 0.474 Test Loss: 9.092 Test Acc: 0.474
Validation loss decreased (-0.462387 --> -0.473898).  Saving model ...
Epoch: 5 cost time: 13.936909437179565
Epoch: 5, Steps: 34 | Train Loss: 4.207 Vali Loss: 6.006 Vali Acc: 0.526 Test Loss: 6.006 Test Acc: 0.526
Validation loss decreased (-0.473898 --> -0.525951).  Saving model ...
Epoch: 6 cost time: 14.345230340957642
Epoch: 6, Steps: 34 | Train Loss: 2.438 Vali Loss: 3.149 Vali Acc: 0.659 Test Loss: 3.149 Test Acc: 0.659
Validation loss decreased (-0.525951 --> -0.658928).  Saving model ...
Epoch: 7 cost time: 14.446814775466919
Epoch: 7, Steps: 34 | Train Loss: 1.231 Vali Loss: 5.789 Vali Acc: 0.676 Test Loss: 5.789 Test Acc: 0.676
Validation loss decreased (-0.658928 --> -0.676243).  Saving model ...
Epoch: 8 cost time: 15.260855674743652
Epoch: 8, Steps: 34 | Train Loss: 1.977 Vali Loss: 3.390 Vali Acc: 0.613 Test Loss: 3.390 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.744828939437866
Epoch: 9, Steps: 34 | Train Loss: 0.859 Vali Loss: 3.765 Vali Acc: 0.769 Test Loss: 3.765 Test Acc: 0.769
Validation loss decreased (-0.676243 --> -0.768748).  Saving model ...
Epoch: 10 cost time: 14.52658724784851
Epoch: 10, Steps: 34 | Train Loss: 0.950 Vali Loss: 2.231 Vali Acc: 0.792 Test Loss: 2.231 Test Acc: 0.792
Validation loss decreased (-0.768748 --> -0.791885).  Saving model ...
Epoch: 11 cost time: 15.23880410194397
Epoch: 11, Steps: 34 | Train Loss: 0.817 Vali Loss: 5.974 Vali Acc: 0.717 Test Loss: 5.974 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.259483098983765
Epoch: 12, Steps: 34 | Train Loss: 0.970 Vali Loss: 2.061 Vali Acc: 0.786 Test Loss: 2.061 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.900423765182495
Epoch: 13, Steps: 34 | Train Loss: 1.241 Vali Loss: 6.162 Vali Acc: 0.647 Test Loss: 6.162 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 17.479132652282715
Epoch: 14, Steps: 34 | Train Loss: 0.950 Vali Loss: 4.788 Vali Acc: 0.746 Test Loss: 4.788 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.718713760375977
Epoch: 15, Steps: 34 | Train Loss: 1.121 Vali Loss: 3.458 Vali Acc: 0.705 Test Loss: 3.458 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.599095821380615
Epoch: 16, Steps: 34 | Train Loss: 0.673 Vali Loss: 5.534 Vali Acc: 0.746 Test Loss: 5.534 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.733277082443237
Epoch: 17, Steps: 34 | Train Loss: 0.173 Vali Loss: 7.138 Vali Acc: 0.728 Test Loss: 7.138 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.038386106491089
Epoch: 18, Steps: 34 | Train Loss: 0.862 Vali Loss: 2.661 Vali Acc: 0.821 Test Loss: 2.661 Test Acc: 0.821
Validation loss decreased (-0.791885 --> -0.820783).  Saving model ...
Epoch: 19 cost time: 13.791173696517944
Epoch: 19, Steps: 34 | Train Loss: 0.067 Vali Loss: 4.759 Vali Acc: 0.769 Test Loss: 4.759 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.517244577407837
Epoch: 20, Steps: 34 | Train Loss: 0.211 Vali Loss: 2.203 Vali Acc: 0.855 Test Loss: 2.203 Test Acc: 0.855
Validation loss decreased (-0.820783 --> -0.855469).  Saving model ...
Epoch: 21 cost time: 13.804770946502686
Epoch: 21, Steps: 34 | Train Loss: 0.713 Vali Loss: 3.043 Vali Acc: 0.798 Test Loss: 3.043 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.857232332229614
Epoch: 22, Steps: 34 | Train Loss: 0.144 Vali Loss: 3.908 Vali Acc: 0.792 Test Loss: 3.908 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 14.147339344024658
Epoch: 23, Steps: 34 | Train Loss: 0.189 Vali Loss: 4.638 Vali Acc: 0.734 Test Loss: 4.638 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 14.7410888671875
Epoch: 24, Steps: 34 | Train Loss: 0.260 Vali Loss: 4.088 Vali Acc: 0.780 Test Loss: 4.088 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 13.730734586715698
Epoch: 25, Steps: 34 | Train Loss: 0.161 Vali Loss: 11.422 Vali Acc: 0.676 Test Loss: 11.422 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.411609411239624
Epoch: 26, Steps: 34 | Train Loss: 0.523 Vali Loss: 7.393 Vali Acc: 0.647 Test Loss: 7.393 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.75592589378357
Epoch: 27, Steps: 34 | Train Loss: 0.495 Vali Loss: 6.598 Vali Acc: 0.688 Test Loss: 6.598 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 14.067306756973267
Epoch: 28, Steps: 34 | Train Loss: 0.313 Vali Loss: 3.665 Vali Acc: 0.786 Test Loss: 3.665 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 15.403430461883545
Epoch: 29, Steps: 34 | Train Loss: 0.330 Vali Loss: 6.607 Vali Acc: 0.757 Test Loss: 6.607 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.12507677078247
Epoch: 30, Steps: 34 | Train Loss: 0.036 Vali Loss: 5.932 Vali Acc: 0.746 Test Loss: 5.932 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2514051
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.681164979934692
Epoch: 1, Steps: 34 | Train Loss: 2.066 Vali Loss: 1.981 Vali Acc: 0.249 Test Loss: 1.981 Test Acc: 0.249
Validation loss decreased (inf --> -0.248535).  Saving model ...
Epoch: 2 cost time: 15.318486213684082
Epoch: 2, Steps: 34 | Train Loss: 1.972 Vali Loss: 2.533 Vali Acc: 0.532 Test Loss: 2.533 Test Acc: 0.532
Validation loss decreased (-0.248535 --> -0.531767).  Saving model ...
Epoch: 3 cost time: 15.338522672653198
Epoch: 3, Steps: 34 | Train Loss: 3.854 Vali Loss: 4.201 Vali Acc: 0.416 Test Loss: 4.201 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.664558410644531
Epoch: 4, Steps: 34 | Train Loss: 3.557 Vali Loss: 3.153 Vali Acc: 0.538 Test Loss: 3.153 Test Acc: 0.538
Validation loss decreased (-0.531767 --> -0.537541).  Saving model ...
Epoch: 5 cost time: 13.302289724349976
Epoch: 5, Steps: 34 | Train Loss: 5.076 Vali Loss: 4.489 Vali Acc: 0.509 Test Loss: 4.489 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.204919338226318
Epoch: 6, Steps: 34 | Train Loss: 2.353 Vali Loss: 3.537 Vali Acc: 0.688 Test Loss: 3.537 Test Acc: 0.688
Validation loss decreased (-0.537541 --> -0.687826).  Saving model ...
Epoch: 7 cost time: 13.520819425582886
Epoch: 7, Steps: 34 | Train Loss: 2.712 Vali Loss: 4.008 Vali Acc: 0.717 Test Loss: 4.008 Test Acc: 0.717
Validation loss decreased (-0.687826 --> -0.716723).  Saving model ...
Epoch: 8 cost time: 15.04988408088684
Epoch: 8, Steps: 34 | Train Loss: 3.612 Vali Loss: 4.416 Vali Acc: 0.590 Test Loss: 4.416 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.0860013961792
Epoch: 9, Steps: 34 | Train Loss: 2.106 Vali Loss: 4.186 Vali Acc: 0.723 Test Loss: 4.186 Test Acc: 0.723
Validation loss decreased (-0.716723 --> -0.722501).  Saving model ...
Epoch: 10 cost time: 13.411046743392944
Epoch: 10, Steps: 34 | Train Loss: 0.870 Vali Loss: 1.922 Vali Acc: 0.827 Test Loss: 1.922 Test Acc: 0.827
Validation loss decreased (-0.722501 --> -0.826570).  Saving model ...
Epoch: 11 cost time: 13.470099449157715
Epoch: 11, Steps: 34 | Train Loss: 0.776 Vali Loss: 3.734 Vali Acc: 0.751 Test Loss: 3.734 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.628876447677612
Epoch: 12, Steps: 34 | Train Loss: 0.974 Vali Loss: 1.969 Vali Acc: 0.803 Test Loss: 1.969 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.743788480758667
Epoch: 13, Steps: 34 | Train Loss: 0.293 Vali Loss: 1.385 Vali Acc: 0.832 Test Loss: 1.385 Test Acc: 0.832
Validation loss decreased (-0.826570 --> -0.832356).  Saving model ...
Epoch: 14 cost time: 14.047666549682617
Epoch: 14, Steps: 34 | Train Loss: 0.145 Vali Loss: 3.657 Vali Acc: 0.809 Test Loss: 3.657 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.2944016456604
Epoch: 15, Steps: 34 | Train Loss: 0.302 Vali Loss: 4.959 Vali Acc: 0.728 Test Loss: 4.959 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.670880556106567
Epoch: 16, Steps: 34 | Train Loss: 0.489 Vali Loss: 3.569 Vali Acc: 0.786 Test Loss: 3.569 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.662048101425171
Epoch: 17, Steps: 34 | Train Loss: 1.144 Vali Loss: 7.778 Vali Acc: 0.590 Test Loss: 7.778 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.12897539138794
Epoch: 18, Steps: 34 | Train Loss: 0.624 Vali Loss: 2.452 Vali Acc: 0.844 Test Loss: 2.452 Test Acc: 0.844
Validation loss decreased (-0.832356 --> -0.843906).  Saving model ...
Epoch: 19 cost time: 13.688591003417969
Epoch: 19, Steps: 34 | Train Loss: 0.648 Vali Loss: 3.795 Vali Acc: 0.763 Test Loss: 3.795 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.001955032348633
Epoch: 20, Steps: 34 | Train Loss: 0.613 Vali Loss: 12.490 Vali Acc: 0.665 Test Loss: 12.490 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.557151794433594
Epoch: 21, Steps: 34 | Train Loss: 0.693 Vali Loss: 6.397 Vali Acc: 0.694 Test Loss: 6.397 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.550659656524658
Epoch: 22, Steps: 34 | Train Loss: 0.256 Vali Loss: 1.951 Vali Acc: 0.827 Test Loss: 1.951 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 15.407480239868164
Epoch: 23, Steps: 34 | Train Loss: 0.012 Vali Loss: 2.895 Vali Acc: 0.780 Test Loss: 2.895 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.29500937461853
Epoch: 24, Steps: 34 | Train Loss: 0.342 Vali Loss: 5.870 Vali Acc: 0.746 Test Loss: 5.870 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 13.370493173599243
Epoch: 25, Steps: 34 | Train Loss: 0.296 Vali Loss: 6.705 Vali Acc: 0.728 Test Loss: 6.705 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.6255042552948
Epoch: 26, Steps: 34 | Train Loss: 0.208 Vali Loss: 3.217 Vali Acc: 0.809 Test Loss: 3.217 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.506591558456421
Epoch: 27, Steps: 34 | Train Loss: 0.406 Vali Loss: 1.764 Vali Acc: 0.832 Test Loss: 1.764 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 14.318485498428345
Epoch: 28, Steps: 34 | Train Loss: 0.318 Vali Loss: 4.647 Vali Acc: 0.798 Test Loss: 4.647 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2512579
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.10295820236206
Epoch: 1, Steps: 34 | Train Loss: 2.878 Vali Loss: 5.737 Vali Acc: 0.272 Test Loss: 5.737 Test Acc: 0.272
Validation loss decreased (inf --> -0.271619).  Saving model ...
Epoch: 2 cost time: 12.709564208984375
Epoch: 2, Steps: 34 | Train Loss: 3.246 Vali Loss: 2.325 Vali Acc: 0.468 Test Loss: 2.325 Test Acc: 0.468
Validation loss decreased (-0.271619 --> -0.468185).  Saving model ...
Epoch: 3 cost time: 14.30365800857544
Epoch: 3, Steps: 34 | Train Loss: 4.107 Vali Loss: 5.921 Vali Acc: 0.543 Test Loss: 5.921 Test Acc: 0.543
Validation loss decreased (-0.468185 --> -0.543293).  Saving model ...
Epoch: 4 cost time: 14.348865509033203
Epoch: 4, Steps: 34 | Train Loss: 3.359 Vali Loss: 3.714 Vali Acc: 0.457 Test Loss: 3.714 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.26027798652649
Epoch: 5, Steps: 34 | Train Loss: 4.101 Vali Loss: 8.428 Vali Acc: 0.462 Test Loss: 8.428 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.943290948867798
Epoch: 6, Steps: 34 | Train Loss: 3.428 Vali Loss: 7.276 Vali Acc: 0.514 Test Loss: 7.276 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.40988802909851
Epoch: 7, Steps: 34 | Train Loss: 3.045 Vali Loss: 4.422 Vali Acc: 0.624 Test Loss: 4.422 Test Acc: 0.624
Validation loss decreased (-0.543293 --> -0.624233).  Saving model ...
Epoch: 8 cost time: 17.1919527053833
Epoch: 8, Steps: 34 | Train Loss: 1.312 Vali Loss: 3.388 Vali Acc: 0.676 Test Loss: 3.388 Test Acc: 0.676
Validation loss decreased (-0.624233 --> -0.676267).  Saving model ...
Epoch: 9 cost time: 15.212646245956421
Epoch: 9, Steps: 34 | Train Loss: 1.516 Vali Loss: 3.886 Vali Acc: 0.705 Test Loss: 3.886 Test Acc: 0.705
Validation loss decreased (-0.676267 --> -0.705163).  Saving model ...
Epoch: 10 cost time: 15.00710415840149
Epoch: 10, Steps: 34 | Train Loss: 1.717 Vali Loss: 4.769 Vali Acc: 0.705 Test Loss: 4.769 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.626968145370483
Epoch: 11, Steps: 34 | Train Loss: 0.498 Vali Loss: 3.631 Vali Acc: 0.717 Test Loss: 3.631 Test Acc: 0.717
Validation loss decreased (-0.705163 --> -0.716727).  Saving model ...
Epoch: 12 cost time: 14.851245164871216
Epoch: 12, Steps: 34 | Train Loss: 0.816 Vali Loss: 6.810 Vali Acc: 0.665 Test Loss: 6.810 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.5226469039917
Epoch: 13, Steps: 34 | Train Loss: 0.848 Vali Loss: 4.177 Vali Acc: 0.723 Test Loss: 4.177 Test Acc: 0.723
Validation loss decreased (-0.716727 --> -0.722502).  Saving model ...
Epoch: 14 cost time: 14.12433671951294
Epoch: 14, Steps: 34 | Train Loss: 1.418 Vali Loss: 8.904 Vali Acc: 0.607 Test Loss: 8.904 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.58907675743103
Epoch: 15, Steps: 34 | Train Loss: 1.067 Vali Loss: 3.899 Vali Acc: 0.746 Test Loss: 3.899 Test Acc: 0.746
Validation loss decreased (-0.722502 --> -0.745626).  Saving model ...
Epoch: 16 cost time: 12.69095754623413
Epoch: 16, Steps: 34 | Train Loss: 0.243 Vali Loss: 2.794 Vali Acc: 0.844 Test Loss: 2.794 Test Acc: 0.844
Validation loss decreased (-0.745626 --> -0.843903).  Saving model ...
Epoch: 17 cost time: 13.76206922531128
Epoch: 17, Steps: 34 | Train Loss: 0.540 Vali Loss: 2.509 Vali Acc: 0.798 Test Loss: 2.509 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.646730899810791
Epoch: 18, Steps: 34 | Train Loss: 0.254 Vali Loss: 3.128 Vali Acc: 0.803 Test Loss: 3.128 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 14.348106384277344
Epoch: 19, Steps: 34 | Train Loss: 0.475 Vali Loss: 4.446 Vali Acc: 0.803 Test Loss: 4.446 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.049498319625854
Epoch: 20, Steps: 34 | Train Loss: 0.294 Vali Loss: 2.252 Vali Acc: 0.815 Test Loss: 2.252 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 13.802303075790405
Epoch: 21, Steps: 34 | Train Loss: 0.066 Vali Loss: 3.216 Vali Acc: 0.769 Test Loss: 3.216 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.735706567764282
Epoch: 22, Steps: 34 | Train Loss: 0.091 Vali Loss: 2.350 Vali Acc: 0.821 Test Loss: 2.350 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 14.443915128707886
Epoch: 23, Steps: 34 | Train Loss: 0.105 Vali Loss: 4.735 Vali Acc: 0.798 Test Loss: 4.735 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.288069486618042
Epoch: 24, Steps: 34 | Train Loss: 0.328 Vali Loss: 4.744 Vali Acc: 0.844 Test Loss: 4.744 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 13.994810581207275
Epoch: 25, Steps: 34 | Train Loss: 0.645 Vali Loss: 9.020 Vali Acc: 0.717 Test Loss: 9.020 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 13.80254340171814
Epoch: 26, Steps: 34 | Train Loss: 0.309 Vali Loss: 7.172 Vali Acc: 0.757 Test Loss: 7.172 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2368387
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.514951944351196
Epoch: 1, Steps: 34 | Train Loss: 2.616 Vali Loss: 3.906 Vali Acc: 0.272 Test Loss: 3.906 Test Acc: 0.272
Validation loss decreased (inf --> -0.271637).  Saving model ...
Epoch: 2 cost time: 14.605246305465698
Epoch: 2, Steps: 34 | Train Loss: 2.294 Vali Loss: 4.714 Vali Acc: 0.457 Test Loss: 4.714 Test Acc: 0.457
Validation loss decreased (-0.271637 --> -0.456600).  Saving model ...
Epoch: 3 cost time: 14.462192058563232
Epoch: 3, Steps: 34 | Train Loss: 2.589 Vali Loss: 3.086 Vali Acc: 0.624 Test Loss: 3.086 Test Acc: 0.624
Validation loss decreased (-0.456600 --> -0.624247).  Saving model ...
Epoch: 4 cost time: 14.399691343307495
Epoch: 4, Steps: 34 | Train Loss: 2.365 Vali Loss: 4.789 Vali Acc: 0.532 Test Loss: 4.789 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.823692560195923
Epoch: 5, Steps: 34 | Train Loss: 3.679 Vali Loss: 7.041 Vali Acc: 0.491 Test Loss: 7.041 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.622230291366577
Epoch: 6, Steps: 34 | Train Loss: 4.205 Vali Loss: 6.154 Vali Acc: 0.578 Test Loss: 6.154 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.456698656082153
Epoch: 7, Steps: 34 | Train Loss: 3.051 Vali Loss: 3.063 Vali Acc: 0.676 Test Loss: 3.063 Test Acc: 0.676
Validation loss decreased (-0.624247 --> -0.676270).  Saving model ...
Epoch: 8 cost time: 13.834710836410522
Epoch: 8, Steps: 34 | Train Loss: 0.993 Vali Loss: 5.966 Vali Acc: 0.699 Test Loss: 5.966 Test Acc: 0.699
Validation loss decreased (-0.676270 --> -0.699362).  Saving model ...
Epoch: 9 cost time: 13.148110628128052
Epoch: 9, Steps: 34 | Train Loss: 1.668 Vali Loss: 4.484 Vali Acc: 0.584 Test Loss: 4.484 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.067644596099854
Epoch: 10, Steps: 34 | Train Loss: 1.761 Vali Loss: 9.258 Vali Acc: 0.572 Test Loss: 9.258 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.29524540901184
Epoch: 11, Steps: 34 | Train Loss: 2.347 Vali Loss: 4.237 Vali Acc: 0.711 Test Loss: 4.237 Test Acc: 0.711
Validation loss decreased (-0.699362 --> -0.710940).  Saving model ...
Epoch: 12 cost time: 13.90071988105774
Epoch: 12, Steps: 34 | Train Loss: 1.425 Vali Loss: 4.517 Vali Acc: 0.763 Test Loss: 4.517 Test Acc: 0.763
Validation loss decreased (-0.710940 --> -0.762961).  Saving model ...
Epoch: 13 cost time: 14.086023330688477
Epoch: 13, Steps: 34 | Train Loss: 1.875 Vali Loss: 3.423 Vali Acc: 0.792 Test Loss: 3.423 Test Acc: 0.792
Validation loss decreased (-0.762961 --> -0.791873).  Saving model ...
Epoch: 14 cost time: 13.506163358688354
Epoch: 14, Steps: 34 | Train Loss: 0.822 Vali Loss: 4.160 Vali Acc: 0.786 Test Loss: 4.160 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.866798639297485
Epoch: 15, Steps: 34 | Train Loss: 0.694 Vali Loss: 2.966 Vali Acc: 0.803 Test Loss: 2.966 Test Acc: 0.803
Validation loss decreased (-0.791873 --> -0.803439).  Saving model ...
Epoch: 16 cost time: 14.323545217514038
Epoch: 16, Steps: 34 | Train Loss: 0.489 Vali Loss: 3.186 Vali Acc: 0.803 Test Loss: 3.186 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.924685955047607
Epoch: 17, Steps: 34 | Train Loss: 0.456 Vali Loss: 7.995 Vali Acc: 0.630 Test Loss: 7.995 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.50014042854309
Epoch: 18, Steps: 34 | Train Loss: 0.584 Vali Loss: 2.788 Vali Acc: 0.827 Test Loss: 2.788 Test Acc: 0.827
Validation loss decreased (-0.803439 --> -0.826562).  Saving model ...
Epoch: 19 cost time: 14.05764126777649
Epoch: 19, Steps: 34 | Train Loss: 0.336 Vali Loss: 6.986 Vali Acc: 0.728 Test Loss: 6.986 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.197980165481567
Epoch: 20, Steps: 34 | Train Loss: 0.240 Vali Loss: 4.652 Vali Acc: 0.763 Test Loss: 4.652 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 15.97908878326416
Epoch: 21, Steps: 34 | Train Loss: 0.389 Vali Loss: 3.368 Vali Acc: 0.786 Test Loss: 3.368 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.933705806732178
Epoch: 22, Steps: 34 | Train Loss: 0.575 Vali Loss: 3.296 Vali Acc: 0.780 Test Loss: 3.296 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.581731796264648
Epoch: 23, Steps: 34 | Train Loss: 0.643 Vali Loss: 8.912 Vali Acc: 0.676 Test Loss: 8.912 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.731836318969727
Epoch: 24, Steps: 34 | Train Loss: 1.097 Vali Loss: 5.165 Vali Acc: 0.775 Test Loss: 5.165 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 13.810149669647217
Epoch: 25, Steps: 34 | Train Loss: 0.804 Vali Loss: 6.981 Vali Acc: 0.798 Test Loss: 6.981 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 14.613025665283203
Epoch: 26, Steps: 34 | Train Loss: 0.210 Vali Loss: 6.609 Vali Acc: 0.746 Test Loss: 6.609 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.163055658340454
Epoch: 27, Steps: 34 | Train Loss: 0.282 Vali Loss: 3.939 Vali Acc: 0.815 Test Loss: 3.939 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.900634765625
Epoch: 28, Steps: 34 | Train Loss: 0.562 Vali Loss: 6.385 Vali Acc: 0.786 Test Loss: 6.385 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2366915
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.797101020812988
Epoch: 1, Steps: 34 | Train Loss: 2.066 Vali Loss: 2.477 Vali Acc: 0.405 Test Loss: 2.477 Test Acc: 0.405
Validation loss decreased (inf --> -0.404600).  Saving model ...
Epoch: 2 cost time: 14.229952335357666
Epoch: 2, Steps: 34 | Train Loss: 2.679 Vali Loss: 2.519 Vali Acc: 0.416 Test Loss: 2.519 Test Acc: 0.416
Validation loss decreased (-0.404600 --> -0.416160).  Saving model ...
Epoch: 3 cost time: 13.739393711090088
Epoch: 3, Steps: 34 | Train Loss: 2.908 Vali Loss: 3.856 Vali Acc: 0.595 Test Loss: 3.856 Test Acc: 0.595
Validation loss decreased (-0.416160 --> -0.595337).  Saving model ...
Epoch: 4 cost time: 14.079213619232178
Epoch: 4, Steps: 34 | Train Loss: 2.591 Vali Loss: 7.329 Vali Acc: 0.555 Test Loss: 7.329 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.985117435455322
Epoch: 5, Steps: 34 | Train Loss: 4.566 Vali Loss: 7.298 Vali Acc: 0.584 Test Loss: 7.298 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.002855777740479
Epoch: 6, Steps: 34 | Train Loss: 4.225 Vali Loss: 5.606 Vali Acc: 0.624 Test Loss: 5.606 Test Acc: 0.624
Validation loss decreased (-0.595337 --> -0.624221).  Saving model ...
Epoch: 7 cost time: 14.934309482574463
Epoch: 7, Steps: 34 | Train Loss: 1.992 Vali Loss: 6.009 Vali Acc: 0.636 Test Loss: 6.009 Test Acc: 0.636
Validation loss decreased (-0.624221 --> -0.635778).  Saving model ...
Epoch: 8 cost time: 13.319536447525024
Epoch: 8, Steps: 34 | Train Loss: 4.176 Vali Loss: 3.940 Vali Acc: 0.601 Test Loss: 3.940 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.981128215789795
Epoch: 9, Steps: 34 | Train Loss: 2.236 Vali Loss: 3.745 Vali Acc: 0.757 Test Loss: 3.745 Test Acc: 0.757
Validation loss decreased (-0.635778 --> -0.757188).  Saving model ...
Epoch: 10 cost time: 14.439584016799927
Epoch: 10, Steps: 34 | Train Loss: 2.286 Vali Loss: 12.983 Vali Acc: 0.538 Test Loss: 12.983 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.138470888137817
Epoch: 11, Steps: 34 | Train Loss: 3.143 Vali Loss: 1.989 Vali Acc: 0.803 Test Loss: 1.989 Test Acc: 0.803
Validation loss decreased (-0.757188 --> -0.803448).  Saving model ...
Epoch: 12 cost time: 15.693206310272217
Epoch: 12, Steps: 34 | Train Loss: 1.895 Vali Loss: 6.679 Vali Acc: 0.734 Test Loss: 6.679 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.832396984100342
Epoch: 13, Steps: 34 | Train Loss: 0.704 Vali Loss: 5.139 Vali Acc: 0.699 Test Loss: 5.139 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.465462684631348
Epoch: 14, Steps: 34 | Train Loss: 0.584 Vali Loss: 2.369 Vali Acc: 0.821 Test Loss: 2.369 Test Acc: 0.821
Validation loss decreased (-0.803448 --> -0.820786).  Saving model ...
Epoch: 15 cost time: 14.046493530273438
Epoch: 15, Steps: 34 | Train Loss: 0.790 Vali Loss: 4.385 Vali Acc: 0.821 Test Loss: 4.385 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.24776577949524
Epoch: 16, Steps: 34 | Train Loss: 0.908 Vali Loss: 3.006 Vali Acc: 0.827 Test Loss: 3.006 Test Acc: 0.827
Validation loss decreased (-0.820786 --> -0.826560).  Saving model ...
Epoch: 17 cost time: 13.991183280944824
Epoch: 17, Steps: 34 | Train Loss: 0.874 Vali Loss: 8.867 Vali Acc: 0.647 Test Loss: 8.867 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.891391038894653
Epoch: 18, Steps: 34 | Train Loss: 0.285 Vali Loss: 8.111 Vali Acc: 0.786 Test Loss: 8.111 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.991288661956787
Epoch: 19, Steps: 34 | Train Loss: 0.251 Vali Loss: 6.869 Vali Acc: 0.740 Test Loss: 6.869 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.476248264312744
Epoch: 20, Steps: 34 | Train Loss: 0.431 Vali Loss: 9.062 Vali Acc: 0.642 Test Loss: 9.062 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 14.591903448104858
Epoch: 21, Steps: 34 | Train Loss: 1.963 Vali Loss: 3.822 Vali Acc: 0.780 Test Loss: 3.822 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 14.223393201828003
Epoch: 22, Steps: 34 | Train Loss: 0.478 Vali Loss: 10.558 Vali Acc: 0.699 Test Loss: 10.558 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.8114652633667
Epoch: 23, Steps: 34 | Train Loss: 4.417 Vali Loss: 7.761 Vali Acc: 0.705 Test Loss: 7.761 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 13.812116622924805
Epoch: 24, Steps: 34 | Train Loss: 1.524 Vali Loss: 16.719 Vali Acc: 0.572 Test Loss: 16.719 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 13.648950338363647
Epoch: 25, Steps: 34 | Train Loss: 1.483 Vali Loss: 7.440 Vali Acc: 0.746 Test Loss: 7.440 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 14.358110189437866
Epoch: 26, Steps: 34 | Train Loss: 1.015 Vali Loss: 6.085 Vali Acc: 0.798 Test Loss: 6.085 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2365443
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.289071321487427
Epoch: 1, Steps: 34 | Train Loss: 2.243 Vali Loss: 3.301 Vali Acc: 0.249 Test Loss: 3.301 Test Acc: 0.249
Validation loss decreased (inf --> -0.248522).  Saving model ...
Epoch: 2 cost time: 12.818765640258789
Epoch: 2, Steps: 34 | Train Loss: 2.058 Vali Loss: 3.837 Vali Acc: 0.468 Test Loss: 3.837 Test Acc: 0.468
Validation loss decreased (-0.248522 --> -0.468170).  Saving model ...
Epoch: 3 cost time: 14.842979431152344
Epoch: 3, Steps: 34 | Train Loss: 4.554 Vali Loss: 6.977 Vali Acc: 0.445 Test Loss: 6.977 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.63268780708313
Epoch: 4, Steps: 34 | Train Loss: 4.259 Vali Loss: 3.577 Vali Acc: 0.549 Test Loss: 3.577 Test Acc: 0.549
Validation loss decreased (-0.468170 --> -0.549097).  Saving model ...
Epoch: 5 cost time: 16.03653597831726
Epoch: 5, Steps: 34 | Train Loss: 3.153 Vali Loss: 7.346 Vali Acc: 0.358 Test Loss: 7.346 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.81761860847473
Epoch: 6, Steps: 34 | Train Loss: 5.419 Vali Loss: 6.435 Vali Acc: 0.590 Test Loss: 6.435 Test Acc: 0.590
Validation loss decreased (-0.549097 --> -0.589531).  Saving model ...
Epoch: 7 cost time: 13.738830804824829
Epoch: 7, Steps: 34 | Train Loss: 2.522 Vali Loss: 3.580 Vali Acc: 0.613 Test Loss: 3.580 Test Acc: 0.613
Validation loss decreased (-0.589531 --> -0.612681).  Saving model ...
Epoch: 8 cost time: 13.929015159606934
Epoch: 8, Steps: 34 | Train Loss: 1.099 Vali Loss: 9.497 Vali Acc: 0.607 Test Loss: 9.497 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.357216835021973
Epoch: 9, Steps: 34 | Train Loss: 1.827 Vali Loss: 3.169 Vali Acc: 0.699 Test Loss: 3.169 Test Acc: 0.699
Validation loss decreased (-0.612681 --> -0.699390).  Saving model ...
Epoch: 10 cost time: 14.695931911468506
Epoch: 10, Steps: 34 | Train Loss: 0.860 Vali Loss: 5.015 Vali Acc: 0.728 Test Loss: 5.015 Test Acc: 0.728
Validation loss decreased (-0.699390 --> -0.728274).  Saving model ...
Epoch: 11 cost time: 13.471299648284912
Epoch: 11, Steps: 34 | Train Loss: 1.242 Vali Loss: 5.816 Vali Acc: 0.740 Test Loss: 5.816 Test Acc: 0.740
Validation loss decreased (-0.728274 --> -0.739826).  Saving model ...
Epoch: 12 cost time: 14.325851202011108
Epoch: 12, Steps: 34 | Train Loss: 0.999 Vali Loss: 2.731 Vali Acc: 0.827 Test Loss: 2.731 Test Acc: 0.827
Validation loss decreased (-0.739826 --> -0.826562).  Saving model ...
Epoch: 13 cost time: 13.83082914352417
Epoch: 13, Steps: 34 | Train Loss: 0.432 Vali Loss: 3.476 Vali Acc: 0.815 Test Loss: 3.476 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.725401878356934
Epoch: 14, Steps: 34 | Train Loss: 1.824 Vali Loss: 3.715 Vali Acc: 0.792 Test Loss: 3.715 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.294816493988037
Epoch: 15, Steps: 34 | Train Loss: 0.918 Vali Loss: 4.576 Vali Acc: 0.723 Test Loss: 4.576 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.622151136398315
Epoch: 16, Steps: 34 | Train Loss: 1.735 Vali Loss: 8.294 Vali Acc: 0.671 Test Loss: 8.294 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.404065608978271
Epoch: 17, Steps: 34 | Train Loss: 3.363 Vali Loss: 4.257 Vali Acc: 0.786 Test Loss: 4.257 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.883171558380127
Epoch: 18, Steps: 34 | Train Loss: 1.149 Vali Loss: 4.147 Vali Acc: 0.809 Test Loss: 4.147 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.92000961303711
Epoch: 19, Steps: 34 | Train Loss: 2.105 Vali Loss: 4.416 Vali Acc: 0.786 Test Loss: 4.416 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.157532691955566
Epoch: 20, Steps: 34 | Train Loss: 0.658 Vali Loss: 3.548 Vali Acc: 0.832 Test Loss: 3.548 Test Acc: 0.832
Validation loss decreased (-0.826562 --> -0.832334).  Saving model ...
Epoch: 21 cost time: 14.759384632110596
Epoch: 21, Steps: 34 | Train Loss: 0.062 Vali Loss: 4.807 Vali Acc: 0.763 Test Loss: 4.807 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 15.392639636993408
Epoch: 22, Steps: 34 | Train Loss: 0.961 Vali Loss: 3.335 Vali Acc: 0.786 Test Loss: 3.335 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 15.768872261047363
Epoch: 23, Steps: 34 | Train Loss: 0.590 Vali Loss: 6.548 Vali Acc: 0.728 Test Loss: 6.548 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 15.508228540420532
Epoch: 24, Steps: 34 | Train Loss: 0.095 Vali Loss: 4.088 Vali Acc: 0.763 Test Loss: 4.088 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 16.042449951171875
Epoch: 25, Steps: 34 | Train Loss: 0.290 Vali Loss: 8.575 Vali Acc: 0.763 Test Loss: 8.575 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 13.143502473831177
Epoch: 26, Steps: 34 | Train Loss: 0.240 Vali Loss: 5.635 Vali Acc: 0.809 Test Loss: 5.635 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.184292316436768
Epoch: 27, Steps: 34 | Train Loss: 0.083 Vali Loss: 4.438 Vali Acc: 0.821 Test Loss: 4.438 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 13.62208104133606
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.607 Vali Acc: 0.821 Test Loss: 4.607 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 14.65009331703186
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.612 Vali Acc: 0.821 Test Loss: 4.612 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.489758968353271
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.612 Vali Acc: 0.821 Test Loss: 4.612 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2363971
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.430450439453125
Epoch: 1, Steps: 34 | Train Loss: 2.301 Vali Loss: 2.579 Vali Acc: 0.243 Test Loss: 2.579 Test Acc: 0.243
Validation loss decreased (inf --> -0.242749).  Saving model ...
Epoch: 2 cost time: 14.148808002471924
Epoch: 2, Steps: 34 | Train Loss: 2.095 Vali Loss: 2.595 Vali Acc: 0.462 Test Loss: 2.595 Test Acc: 0.462
Validation loss decreased (-0.242749 --> -0.462402).  Saving model ...
Epoch: 3 cost time: 15.255997896194458
Epoch: 3, Steps: 34 | Train Loss: 2.072 Vali Loss: 1.960 Vali Acc: 0.445 Test Loss: 1.960 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.651196241378784
Epoch: 4, Steps: 34 | Train Loss: 1.852 Vali Loss: 4.224 Vali Acc: 0.457 Test Loss: 4.224 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.389812231063843
Epoch: 5, Steps: 34 | Train Loss: 1.966 Vali Loss: 1.879 Vali Acc: 0.590 Test Loss: 1.879 Test Acc: 0.590
Validation loss decreased (-0.462402 --> -0.589577).  Saving model ...
Epoch: 6 cost time: 13.658982753753662
Epoch: 6, Steps: 34 | Train Loss: 1.398 Vali Loss: 2.346 Vali Acc: 0.578 Test Loss: 2.346 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.95187497138977
Epoch: 7, Steps: 34 | Train Loss: 1.033 Vali Loss: 2.503 Vali Acc: 0.595 Test Loss: 2.503 Test Acc: 0.595
Validation loss decreased (-0.589577 --> -0.595351).  Saving model ...
Epoch: 8 cost time: 14.657618761062622
Epoch: 8, Steps: 34 | Train Loss: 1.229 Vali Loss: 2.533 Vali Acc: 0.555 Test Loss: 2.533 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.38528299331665
Epoch: 9, Steps: 34 | Train Loss: 0.963 Vali Loss: 2.206 Vali Acc: 0.699 Test Loss: 2.206 Test Acc: 0.699
Validation loss decreased (-0.595351 --> -0.699400).  Saving model ...
Epoch: 10 cost time: 14.347768306732178
Epoch: 10, Steps: 34 | Train Loss: 0.839 Vali Loss: 1.629 Vali Acc: 0.705 Test Loss: 1.629 Test Acc: 0.705
Validation loss decreased (-0.699400 --> -0.705186).  Saving model ...
Epoch: 11 cost time: 14.963409185409546
Epoch: 11, Steps: 34 | Train Loss: 1.163 Vali Loss: 3.305 Vali Acc: 0.705 Test Loss: 3.305 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.590621948242188
Epoch: 12, Steps: 34 | Train Loss: 0.943 Vali Loss: 2.272 Vali Acc: 0.705 Test Loss: 2.272 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.416446924209595
Epoch: 13, Steps: 34 | Train Loss: 0.441 Vali Loss: 0.939 Vali Acc: 0.815 Test Loss: 0.939 Test Acc: 0.815
Validation loss decreased (-0.705186 --> -0.815020).  Saving model ...
Epoch: 14 cost time: 14.434443473815918
Epoch: 14, Steps: 34 | Train Loss: 0.192 Vali Loss: 2.482 Vali Acc: 0.665 Test Loss: 2.482 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.56456732749939
Epoch: 15, Steps: 34 | Train Loss: 0.239 Vali Loss: 1.347 Vali Acc: 0.815 Test Loss: 1.347 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.388160705566406
Epoch: 16, Steps: 34 | Train Loss: 0.323 Vali Loss: 3.388 Vali Acc: 0.688 Test Loss: 3.388 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.93564748764038
Epoch: 17, Steps: 34 | Train Loss: 0.453 Vali Loss: 4.155 Vali Acc: 0.665 Test Loss: 4.155 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.67196536064148
Epoch: 18, Steps: 34 | Train Loss: 0.453 Vali Loss: 2.510 Vali Acc: 0.746 Test Loss: 2.510 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.372991561889648
Epoch: 19, Steps: 34 | Train Loss: 0.408 Vali Loss: 1.579 Vali Acc: 0.786 Test Loss: 1.579 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.237032175064087
Epoch: 20, Steps: 34 | Train Loss: 0.286 Vali Loss: 1.963 Vali Acc: 0.780 Test Loss: 1.963 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.772459030151367
Epoch: 21, Steps: 34 | Train Loss: 0.127 Vali Loss: 1.869 Vali Acc: 0.838 Test Loss: 1.869 Test Acc: 0.838
Validation loss decreased (-0.815020 --> -0.838132).  Saving model ...
Epoch: 22 cost time: 12.457702875137329
Epoch: 22, Steps: 34 | Train Loss: 0.166 Vali Loss: 3.788 Vali Acc: 0.751 Test Loss: 3.788 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 14.29617714881897
Epoch: 23, Steps: 34 | Train Loss: 0.139 Vali Loss: 1.211 Vali Acc: 0.850 Test Loss: 1.211 Test Acc: 0.850
Validation loss decreased (-0.838132 --> -0.849699).  Saving model ...
Epoch: 24 cost time: 15.276851654052734
Epoch: 24, Steps: 34 | Train Loss: 0.141 Vali Loss: 2.411 Vali Acc: 0.792 Test Loss: 2.411 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 14.176255226135254
Epoch: 25, Steps: 34 | Train Loss: 0.259 Vali Loss: 2.111 Vali Acc: 0.780 Test Loss: 2.111 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 13.068178415298462
Epoch: 26, Steps: 34 | Train Loss: 0.173 Vali Loss: 3.167 Vali Acc: 0.751 Test Loss: 3.167 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 13.768742084503174
Epoch: 27, Steps: 34 | Train Loss: 0.116 Vali Loss: 3.007 Vali Acc: 0.734 Test Loss: 3.007 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 14.141909122467041
Epoch: 28, Steps: 34 | Train Loss: 0.127 Vali Loss: 3.292 Vali Acc: 0.769 Test Loss: 3.292 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 15.155978918075562
Epoch: 29, Steps: 34 | Train Loss: 0.534 Vali Loss: 1.746 Vali Acc: 0.803 Test Loss: 1.746 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 14.62516450881958
Epoch: 30, Steps: 34 | Train Loss: 0.087 Vali Loss: 4.370 Vali Acc: 0.717 Test Loss: 4.370 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 14.90165114402771
Epoch: 31, Steps: 34 | Train Loss: 0.514 Vali Loss: 4.173 Vali Acc: 0.723 Test Loss: 4.173 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 15.129673480987549
Epoch: 32, Steps: 34 | Train Loss: 0.202 Vali Loss: 1.097 Vali Acc: 0.838 Test Loss: 1.097 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 16.549378633499146
Epoch: 33, Steps: 34 | Train Loss: 0.093 Vali Loss: 4.781 Vali Acc: 0.786 Test Loss: 4.781 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1561507
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.675341844558716
Epoch: 1, Steps: 34 | Train Loss: 1.961 Vali Loss: 1.855 Vali Acc: 0.405 Test Loss: 1.855 Test Acc: 0.405
Validation loss decreased (inf --> -0.404606).  Saving model ...
Epoch: 2 cost time: 13.553114175796509
Epoch: 2, Steps: 34 | Train Loss: 1.461 Vali Loss: 1.483 Vali Acc: 0.613 Test Loss: 1.483 Test Acc: 0.613
Validation loss decreased (-0.404606 --> -0.612702).  Saving model ...
Epoch: 3 cost time: 14.056854009628296
Epoch: 3, Steps: 34 | Train Loss: 1.788 Vali Loss: 2.463 Vali Acc: 0.514 Test Loss: 2.463 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.482584714889526
Epoch: 4, Steps: 34 | Train Loss: 1.413 Vali Loss: 2.070 Vali Acc: 0.723 Test Loss: 2.070 Test Acc: 0.723
Validation loss decreased (-0.612702 --> -0.722523).  Saving model ...
Epoch: 5 cost time: 13.880750179290771
Epoch: 5, Steps: 34 | Train Loss: 1.381 Vali Loss: 1.295 Vali Acc: 0.682 Test Loss: 1.295 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.569069385528564
Epoch: 6, Steps: 34 | Train Loss: 0.682 Vali Loss: 2.215 Vali Acc: 0.618 Test Loss: 2.215 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.449793815612793
Epoch: 7, Steps: 34 | Train Loss: 1.161 Vali Loss: 1.289 Vali Acc: 0.763 Test Loss: 1.289 Test Acc: 0.763
Validation loss decreased (-0.722523 --> -0.762993).  Saving model ...
Epoch: 8 cost time: 13.463216543197632
Epoch: 8, Steps: 34 | Train Loss: 1.260 Vali Loss: 2.220 Vali Acc: 0.584 Test Loss: 2.220 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.353992938995361
Epoch: 9, Steps: 34 | Train Loss: 1.784 Vali Loss: 2.796 Vali Acc: 0.751 Test Loss: 2.796 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.58025598526001
Epoch: 10, Steps: 34 | Train Loss: 0.888 Vali Loss: 2.728 Vali Acc: 0.636 Test Loss: 2.728 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.603795766830444
Epoch: 11, Steps: 34 | Train Loss: 0.588 Vali Loss: 5.458 Vali Acc: 0.462 Test Loss: 5.458 Test Acc: 0.462
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.079621315002441
Epoch: 12, Steps: 34 | Train Loss: 0.378 Vali Loss: 4.276 Vali Acc: 0.653 Test Loss: 4.276 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.538963079452515
Epoch: 13, Steps: 34 | Train Loss: 0.726 Vali Loss: 1.990 Vali Acc: 0.763 Test Loss: 1.990 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.29263424873352
Epoch: 14, Steps: 34 | Train Loss: 0.312 Vali Loss: 3.894 Vali Acc: 0.711 Test Loss: 3.894 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.18228006362915
Epoch: 15, Steps: 34 | Train Loss: 0.295 Vali Loss: 3.101 Vali Acc: 0.711 Test Loss: 3.101 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 15.008641481399536
Epoch: 16, Steps: 34 | Train Loss: 0.376 Vali Loss: 2.486 Vali Acc: 0.792 Test Loss: 2.486 Test Acc: 0.792
Validation loss decreased (-0.762993 --> -0.791883).  Saving model ...
Epoch: 17 cost time: 14.65029501914978
Epoch: 17, Steps: 34 | Train Loss: 0.678 Vali Loss: 2.854 Vali Acc: 0.740 Test Loss: 2.854 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.64675235748291
Epoch: 18, Steps: 34 | Train Loss: 0.496 Vali Loss: 2.661 Vali Acc: 0.757 Test Loss: 2.661 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 14.273153305053711
Epoch: 19, Steps: 34 | Train Loss: 0.057 Vali Loss: 2.382 Vali Acc: 0.746 Test Loss: 2.382 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.2571964263916
Epoch: 20, Steps: 34 | Train Loss: 0.123 Vali Loss: 2.456 Vali Acc: 0.775 Test Loss: 2.456 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.36299753189087
Epoch: 21, Steps: 34 | Train Loss: 0.054 Vali Loss: 2.683 Vali Acc: 0.792 Test Loss: 2.683 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.46015453338623
Epoch: 22, Steps: 34 | Train Loss: 0.003 Vali Loss: 2.202 Vali Acc: 0.821 Test Loss: 2.202 Test Acc: 0.821
Validation loss decreased (-0.791883 --> -0.820787).  Saving model ...
Epoch: 23 cost time: 13.493724584579468
Epoch: 23, Steps: 34 | Train Loss: 0.465 Vali Loss: 2.897 Vali Acc: 0.717 Test Loss: 2.897 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.752344369888306
Epoch: 24, Steps: 34 | Train Loss: 0.020 Vali Loss: 3.057 Vali Acc: 0.723 Test Loss: 3.057 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 14.643550395965576
Epoch: 25, Steps: 34 | Train Loss: 0.084 Vali Loss: 2.198 Vali Acc: 0.792 Test Loss: 2.198 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 13.988343238830566
Epoch: 26, Steps: 34 | Train Loss: 0.064 Vali Loss: 3.069 Vali Acc: 0.728 Test Loss: 3.069 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.700680017471313
Epoch: 27, Steps: 34 | Train Loss: 0.115 Vali Loss: 3.322 Vali Acc: 0.723 Test Loss: 3.322 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.029557704925537
Epoch: 28, Steps: 34 | Train Loss: 0.046 Vali Loss: 3.058 Vali Acc: 0.809 Test Loss: 3.058 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.820393085479736
Epoch: 29, Steps: 34 | Train Loss: 0.061 Vali Loss: 2.498 Vali Acc: 0.803 Test Loss: 2.498 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 13.93358850479126
Epoch: 30, Steps: 34 | Train Loss: 0.376 Vali Loss: 1.985 Vali Acc: 0.803 Test Loss: 1.985 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 14.994311571121216
Epoch: 31, Steps: 34 | Train Loss: 0.191 Vali Loss: 2.511 Vali Acc: 0.699 Test Loss: 2.511 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 13.985246181488037
Epoch: 32, Steps: 34 | Train Loss: 0.212 Vali Loss: 2.332 Vali Acc: 0.769 Test Loss: 2.332 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1560771
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.973060131072998
Epoch: 1, Steps: 34 | Train Loss: 2.138 Vali Loss: 1.478 Vali Acc: 0.405 Test Loss: 1.478 Test Acc: 0.405
Validation loss decreased (inf --> -0.404609).  Saving model ...
Epoch: 2 cost time: 16.022413969039917
Epoch: 2, Steps: 34 | Train Loss: 2.073 Vali Loss: 3.614 Vali Acc: 0.254 Test Loss: 3.614 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.333000898361206
Epoch: 3, Steps: 34 | Train Loss: 2.183 Vali Loss: 3.401 Vali Acc: 0.532 Test Loss: 3.401 Test Acc: 0.532
Validation loss decreased (-0.404609 --> -0.531758).  Saving model ...
Epoch: 4 cost time: 14.70262861251831
Epoch: 4, Steps: 34 | Train Loss: 1.809 Vali Loss: 3.344 Vali Acc: 0.538 Test Loss: 3.344 Test Acc: 0.538
Validation loss decreased (-0.531758 --> -0.537539).  Saving model ...
Epoch: 5 cost time: 15.196274757385254
Epoch: 5, Steps: 34 | Train Loss: 2.228 Vali Loss: 3.390 Vali Acc: 0.514 Test Loss: 3.390 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.184518814086914
Epoch: 6, Steps: 34 | Train Loss: 1.553 Vali Loss: 3.427 Vali Acc: 0.509 Test Loss: 3.427 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.80355930328369
Epoch: 7, Steps: 34 | Train Loss: 1.297 Vali Loss: 2.201 Vali Acc: 0.561 Test Loss: 2.201 Test Acc: 0.561
Validation loss decreased (-0.537539 --> -0.560672).  Saving model ...
Epoch: 8 cost time: 13.615370035171509
Epoch: 8, Steps: 34 | Train Loss: 0.966 Vali Loss: 2.364 Vali Acc: 0.630 Test Loss: 2.364 Test Acc: 0.630
Validation loss decreased (-0.560672 --> -0.630034).  Saving model ...
Epoch: 9 cost time: 13.714332580566406
Epoch: 9, Steps: 34 | Train Loss: 0.719 Vali Loss: 1.881 Vali Acc: 0.659 Test Loss: 1.881 Test Acc: 0.659
Validation loss decreased (-0.630034 --> -0.658941).  Saving model ...
Epoch: 10 cost time: 13.891941785812378
Epoch: 10, Steps: 34 | Train Loss: 0.427 Vali Loss: 1.741 Vali Acc: 0.763 Test Loss: 1.741 Test Acc: 0.763
Validation loss decreased (-0.658941 --> -0.762988).  Saving model ...
Epoch: 11 cost time: 15.42206621170044
Epoch: 11, Steps: 34 | Train Loss: 0.648 Vali Loss: 1.853 Vali Acc: 0.711 Test Loss: 1.853 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.821507930755615
Epoch: 12, Steps: 34 | Train Loss: 0.229 Vali Loss: 2.630 Vali Acc: 0.740 Test Loss: 2.630 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.11480975151062
Epoch: 13, Steps: 34 | Train Loss: 0.370 Vali Loss: 1.688 Vali Acc: 0.809 Test Loss: 1.688 Test Acc: 0.809
Validation loss decreased (-0.762988 --> -0.809232).  Saving model ...
Epoch: 14 cost time: 12.853657484054565
Epoch: 14, Steps: 34 | Train Loss: 0.239 Vali Loss: 1.693 Vali Acc: 0.763 Test Loss: 1.693 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.114277124404907
Epoch: 15, Steps: 34 | Train Loss: 0.085 Vali Loss: 1.138 Vali Acc: 0.821 Test Loss: 1.138 Test Acc: 0.821
Validation loss decreased (-0.809232 --> -0.820798).  Saving model ...
Epoch: 16 cost time: 12.851700067520142
Epoch: 16, Steps: 34 | Train Loss: 0.075 Vali Loss: 2.886 Vali Acc: 0.699 Test Loss: 2.886 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.495466470718384
Epoch: 17, Steps: 34 | Train Loss: 0.205 Vali Loss: 2.096 Vali Acc: 0.775 Test Loss: 2.096 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.807971477508545
Epoch: 18, Steps: 34 | Train Loss: 0.209 Vali Loss: 1.266 Vali Acc: 0.832 Test Loss: 1.266 Test Acc: 0.832
Validation loss decreased (-0.820798 --> -0.832357).  Saving model ...
Epoch: 19 cost time: 13.933084726333618
Epoch: 19, Steps: 34 | Train Loss: 0.079 Vali Loss: 1.830 Vali Acc: 0.798 Test Loss: 1.830 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.381125211715698
Epoch: 20, Steps: 34 | Train Loss: 0.172 Vali Loss: 1.513 Vali Acc: 0.821 Test Loss: 1.513 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 15.07306981086731
Epoch: 21, Steps: 34 | Train Loss: 0.171 Vali Loss: 3.700 Vali Acc: 0.763 Test Loss: 3.700 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 15.810909986495972
Epoch: 22, Steps: 34 | Train Loss: 0.354 Vali Loss: 3.639 Vali Acc: 0.711 Test Loss: 3.639 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 15.715712785720825
Epoch: 23, Steps: 34 | Train Loss: 0.951 Vali Loss: 1.394 Vali Acc: 0.815 Test Loss: 1.394 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.945389747619629
Epoch: 24, Steps: 34 | Train Loss: 0.177 Vali Loss: 2.069 Vali Acc: 0.786 Test Loss: 2.069 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 15.169161558151245
Epoch: 25, Steps: 34 | Train Loss: 0.312 Vali Loss: 2.207 Vali Acc: 0.792 Test Loss: 2.207 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 17.64190983772278
Epoch: 26, Steps: 34 | Train Loss: 0.193 Vali Loss: 2.031 Vali Acc: 0.821 Test Loss: 2.031 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 15.49422001838684
Epoch: 27, Steps: 34 | Train Loss: 0.049 Vali Loss: 2.673 Vali Acc: 0.775 Test Loss: 2.673 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 14.263724327087402
Epoch: 28, Steps: 34 | Train Loss: 0.080 Vali Loss: 1.817 Vali Acc: 0.809 Test Loss: 1.817 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1560035
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.329038143157959
Epoch: 1, Steps: 34 | Train Loss: 2.144 Vali Loss: 2.780 Vali Acc: 0.202 Test Loss: 2.780 Test Acc: 0.202
Validation loss decreased (inf --> -0.202284).  Saving model ...
Epoch: 2 cost time: 12.668609619140625
Epoch: 2, Steps: 34 | Train Loss: 1.855 Vali Loss: 1.807 Vali Acc: 0.474 Test Loss: 1.807 Test Acc: 0.474
Validation loss decreased (-0.202284 --> -0.473970).  Saving model ...
Epoch: 3 cost time: 13.974522352218628
Epoch: 3, Steps: 34 | Train Loss: 2.110 Vali Loss: 3.933 Vali Acc: 0.480 Test Loss: 3.933 Test Acc: 0.480
Validation loss decreased (-0.473970 --> -0.479729).  Saving model ...
Epoch: 4 cost time: 13.482547998428345
Epoch: 4, Steps: 34 | Train Loss: 3.100 Vali Loss: 2.469 Vali Acc: 0.480 Test Loss: 2.469 Test Acc: 0.480
Validation loss decreased (-0.479729 --> -0.479744).  Saving model ...
Epoch: 5 cost time: 12.913737297058105
Epoch: 5, Steps: 34 | Train Loss: 1.564 Vali Loss: 1.894 Vali Acc: 0.688 Test Loss: 1.894 Test Acc: 0.688
Validation loss decreased (-0.479744 --> -0.687842).  Saving model ...
Epoch: 6 cost time: 12.810917139053345
Epoch: 6, Steps: 34 | Train Loss: 1.190 Vali Loss: 1.966 Vali Acc: 0.601 Test Loss: 1.966 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.307907104492188
Epoch: 7, Steps: 34 | Train Loss: 0.642 Vali Loss: 1.644 Vali Acc: 0.659 Test Loss: 1.644 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.262796878814697
Epoch: 8, Steps: 34 | Train Loss: 0.878 Vali Loss: 1.800 Vali Acc: 0.717 Test Loss: 1.800 Test Acc: 0.717
Validation loss decreased (-0.687842 --> -0.716745).  Saving model ...
Epoch: 9 cost time: 13.789691686630249
Epoch: 9, Steps: 34 | Train Loss: 0.989 Vali Loss: 2.406 Vali Acc: 0.613 Test Loss: 2.406 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.442923784255981
Epoch: 10, Steps: 34 | Train Loss: 0.720 Vali Loss: 2.982 Vali Acc: 0.636 Test Loss: 2.982 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.61131238937378
Epoch: 11, Steps: 34 | Train Loss: 0.900 Vali Loss: 2.354 Vali Acc: 0.780 Test Loss: 2.354 Test Acc: 0.780
Validation loss decreased (-0.716745 --> -0.780323).  Saving model ...
Epoch: 12 cost time: 14.56821084022522
Epoch: 12, Steps: 34 | Train Loss: 0.766 Vali Loss: 1.668 Vali Acc: 0.723 Test Loss: 1.668 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.129899978637695
Epoch: 13, Steps: 34 | Train Loss: 0.349 Vali Loss: 1.523 Vali Acc: 0.792 Test Loss: 1.523 Test Acc: 0.792
Validation loss decreased (-0.780323 --> -0.791892).  Saving model ...
Epoch: 14 cost time: 16.240296840667725
Epoch: 14, Steps: 34 | Train Loss: 0.318 Vali Loss: 3.642 Vali Acc: 0.665 Test Loss: 3.642 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.424885749816895
Epoch: 15, Steps: 34 | Train Loss: 0.725 Vali Loss: 1.881 Vali Acc: 0.763 Test Loss: 1.881 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.291734457015991
Epoch: 16, Steps: 34 | Train Loss: 0.687 Vali Loss: 5.616 Vali Acc: 0.520 Test Loss: 5.616 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.160157680511475
Epoch: 17, Steps: 34 | Train Loss: 0.403 Vali Loss: 1.623 Vali Acc: 0.780 Test Loss: 1.623 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.692441701889038
Epoch: 18, Steps: 34 | Train Loss: 0.204 Vali Loss: 2.061 Vali Acc: 0.769 Test Loss: 2.061 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.267690896987915
Epoch: 19, Steps: 34 | Train Loss: 0.172 Vali Loss: 2.118 Vali Acc: 0.775 Test Loss: 2.118 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.561981678009033
Epoch: 20, Steps: 34 | Train Loss: 0.082 Vali Loss: 1.322 Vali Acc: 0.809 Test Loss: 1.322 Test Acc: 0.809
Validation loss decreased (-0.791892 --> -0.809235).  Saving model ...
Epoch: 21 cost time: 12.701090097427368
Epoch: 21, Steps: 34 | Train Loss: 0.125 Vali Loss: 2.179 Vali Acc: 0.740 Test Loss: 2.179 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.244760751724243
Epoch: 22, Steps: 34 | Train Loss: 0.102 Vali Loss: 2.246 Vali Acc: 0.740 Test Loss: 2.246 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 13.651456356048584
Epoch: 23, Steps: 34 | Train Loss: 0.328 Vali Loss: 2.831 Vali Acc: 0.728 Test Loss: 2.831 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 14.634735345840454
Epoch: 24, Steps: 34 | Train Loss: 0.160 Vali Loss: 1.864 Vali Acc: 0.815 Test Loss: 1.864 Test Acc: 0.815
Validation loss decreased (-0.809235 --> -0.815010).  Saving model ...
Epoch: 25 cost time: 12.897095441818237
Epoch: 25, Steps: 34 | Train Loss: 0.087 Vali Loss: 1.795 Vali Acc: 0.803 Test Loss: 1.795 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 13.345158100128174
Epoch: 26, Steps: 34 | Train Loss: 0.302 Vali Loss: 3.071 Vali Acc: 0.711 Test Loss: 3.071 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 13.530808925628662
Epoch: 27, Steps: 34 | Train Loss: 0.110 Vali Loss: 1.516 Vali Acc: 0.838 Test Loss: 1.516 Test Acc: 0.838
Validation loss decreased (-0.815010 --> -0.838135).  Saving model ...
Epoch: 28 cost time: 13.787948369979858
Epoch: 28, Steps: 34 | Train Loss: 0.167 Vali Loss: 3.583 Vali Acc: 0.728 Test Loss: 3.583 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 13.609275102615356
Epoch: 29, Steps: 34 | Train Loss: 0.127 Vali Loss: 5.934 Vali Acc: 0.676 Test Loss: 5.934 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 12.987447500228882
Epoch: 30, Steps: 34 | Train Loss: 0.242 Vali Loss: 7.275 Vali Acc: 0.601 Test Loss: 7.275 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 13.438099145889282
Epoch: 31, Steps: 34 | Train Loss: 0.463 Vali Loss: 3.496 Vali Acc: 0.699 Test Loss: 3.496 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 13.87917447090149
Epoch: 32, Steps: 34 | Train Loss: 0.714 Vali Loss: 3.896 Vali Acc: 0.711 Test Loss: 3.896 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 14.677788019180298
Epoch: 33, Steps: 34 | Train Loss: 0.318 Vali Loss: 5.296 Vali Acc: 0.653 Test Loss: 5.296 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 14.898407697677612
Epoch: 34, Steps: 34 | Train Loss: 1.348 Vali Loss: 5.459 Vali Acc: 0.607 Test Loss: 5.459 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 13.316431045532227
Epoch: 35, Steps: 34 | Train Loss: 0.935 Vali Loss: 3.641 Vali Acc: 0.682 Test Loss: 3.641 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 14.177172422409058
Epoch: 36, Steps: 34 | Train Loss: 0.590 Vali Loss: 2.805 Vali Acc: 0.723 Test Loss: 2.805 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 15.329989910125732
Epoch: 37, Steps: 34 | Train Loss: 0.745 Vali Loss: 2.633 Vali Acc: 0.728 Test Loss: 2.633 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1559299
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.57778549194336
Epoch: 1, Steps: 34 | Train Loss: 1.933 Vali Loss: 1.797 Vali Acc: 0.451 Test Loss: 1.797 Test Acc: 0.451
Validation loss decreased (inf --> -0.450849).  Saving model ...
Epoch: 2 cost time: 12.55878758430481
Epoch: 2, Steps: 34 | Train Loss: 1.671 Vali Loss: 2.112 Vali Acc: 0.260 Test Loss: 2.112 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.843974351882935
Epoch: 3, Steps: 34 | Train Loss: 1.959 Vali Loss: 1.843 Vali Acc: 0.474 Test Loss: 1.843 Test Acc: 0.474
Validation loss decreased (-0.450849 --> -0.473970).  Saving model ...
Epoch: 4 cost time: 11.702709913253784
Epoch: 4, Steps: 34 | Train Loss: 2.622 Vali Loss: 1.854 Vali Acc: 0.555 Test Loss: 1.854 Test Acc: 0.555
Validation loss decreased (-0.473970 --> -0.554895).  Saving model ...
Epoch: 5 cost time: 12.861585855484009
Epoch: 5, Steps: 34 | Train Loss: 1.985 Vali Loss: 1.746 Vali Acc: 0.671 Test Loss: 1.746 Test Acc: 0.671
Validation loss decreased (-0.554895 --> -0.670503).  Saving model ...
Epoch: 6 cost time: 13.265642404556274
Epoch: 6, Steps: 34 | Train Loss: 2.025 Vali Loss: 1.768 Vali Acc: 0.636 Test Loss: 1.768 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.00377082824707
Epoch: 7, Steps: 34 | Train Loss: 2.116 Vali Loss: 2.825 Vali Acc: 0.549 Test Loss: 2.825 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.401217937469482
Epoch: 8, Steps: 34 | Train Loss: 1.014 Vali Loss: 2.544 Vali Acc: 0.740 Test Loss: 2.544 Test Acc: 0.740
Validation loss decreased (-0.670503 --> -0.739859).  Saving model ...
Epoch: 9 cost time: 12.64637303352356
Epoch: 9, Steps: 34 | Train Loss: 0.940 Vali Loss: 3.338 Vali Acc: 0.566 Test Loss: 3.338 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.16295576095581
Epoch: 10, Steps: 34 | Train Loss: 0.592 Vali Loss: 1.670 Vali Acc: 0.694 Test Loss: 1.670 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.492835283279419
Epoch: 11, Steps: 34 | Train Loss: 1.033 Vali Loss: 3.510 Vali Acc: 0.676 Test Loss: 3.510 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.700870990753174
Epoch: 12, Steps: 34 | Train Loss: 0.920 Vali Loss: 1.660 Vali Acc: 0.746 Test Loss: 1.660 Test Acc: 0.746
Validation loss decreased (-0.739859 --> -0.745648).  Saving model ...
Epoch: 13 cost time: 12.50400710105896
Epoch: 13, Steps: 34 | Train Loss: 0.283 Vali Loss: 2.966 Vali Acc: 0.711 Test Loss: 2.966 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.991719961166382
Epoch: 14, Steps: 34 | Train Loss: 0.521 Vali Loss: 2.113 Vali Acc: 0.775 Test Loss: 2.113 Test Acc: 0.775
Validation loss decreased (-0.745648 --> -0.774545).  Saving model ...
Epoch: 15 cost time: 12.805734634399414
Epoch: 15, Steps: 34 | Train Loss: 0.547 Vali Loss: 3.126 Vali Acc: 0.746 Test Loss: 3.126 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.049527168273926
Epoch: 16, Steps: 34 | Train Loss: 0.321 Vali Loss: 5.224 Vali Acc: 0.711 Test Loss: 5.224 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.970915794372559
Epoch: 17, Steps: 34 | Train Loss: 0.528 Vali Loss: 3.527 Vali Acc: 0.786 Test Loss: 3.527 Test Acc: 0.786
Validation loss decreased (-0.774545 --> -0.786092).  Saving model ...
Epoch: 18 cost time: 13.116680145263672
Epoch: 18, Steps: 34 | Train Loss: 0.843 Vali Loss: 3.767 Vali Acc: 0.694 Test Loss: 3.767 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.459019422531128
Epoch: 19, Steps: 34 | Train Loss: 0.279 Vali Loss: 2.250 Vali Acc: 0.827 Test Loss: 2.250 Test Acc: 0.827
Validation loss decreased (-0.786092 --> -0.826567).  Saving model ...
Epoch: 20 cost time: 12.814653873443604
Epoch: 20, Steps: 34 | Train Loss: 0.093 Vali Loss: 1.987 Vali Acc: 0.821 Test Loss: 1.987 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.843839406967163
Epoch: 21, Steps: 34 | Train Loss: 0.060 Vali Loss: 2.795 Vali Acc: 0.792 Test Loss: 2.795 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.720397472381592
Epoch: 22, Steps: 34 | Train Loss: 0.140 Vali Loss: 2.513 Vali Acc: 0.757 Test Loss: 2.513 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.575796365737915
Epoch: 23, Steps: 34 | Train Loss: 0.447 Vali Loss: 3.361 Vali Acc: 0.769 Test Loss: 3.361 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.55526328086853
Epoch: 24, Steps: 34 | Train Loss: 0.057 Vali Loss: 2.281 Vali Acc: 0.798 Test Loss: 2.281 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 12.156171321868896
Epoch: 25, Steps: 34 | Train Loss: 0.132 Vali Loss: 2.707 Vali Acc: 0.763 Test Loss: 2.707 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 12.056577444076538
Epoch: 26, Steps: 34 | Train Loss: 0.023 Vali Loss: 4.020 Vali Acc: 0.711 Test Loss: 4.020 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 12.164799928665161
Epoch: 27, Steps: 34 | Train Loss: 0.219 Vali Loss: 4.986 Vali Acc: 0.734 Test Loss: 4.986 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 13.479215145111084
Epoch: 28, Steps: 34 | Train Loss: 0.070 Vali Loss: 2.723 Vali Acc: 0.786 Test Loss: 2.723 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 12.334061861038208
Epoch: 29, Steps: 34 | Train Loss: 0.085 Vali Loss: 2.552 Vali Acc: 0.803 Test Loss: 2.552 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1261987
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.007368564605713
Epoch: 1, Steps: 34 | Train Loss: 2.177 Vali Loss: 1.899 Vali Acc: 0.277 Test Loss: 1.899 Test Acc: 0.277
Validation loss decreased (inf --> -0.277438).  Saving model ...
Epoch: 2 cost time: 12.376221418380737
Epoch: 2, Steps: 34 | Train Loss: 1.828 Vali Loss: 1.327 Vali Acc: 0.578 Test Loss: 1.327 Test Acc: 0.578
Validation loss decreased (-0.277438 --> -0.578021).  Saving model ...
Epoch: 3 cost time: 13.288631439208984
Epoch: 3, Steps: 34 | Train Loss: 2.648 Vali Loss: 2.665 Vali Acc: 0.329 Test Loss: 2.665 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.407002687454224
Epoch: 4, Steps: 34 | Train Loss: 2.660 Vali Loss: 2.063 Vali Acc: 0.439 Test Loss: 2.063 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.57821011543274
Epoch: 5, Steps: 34 | Train Loss: 1.529 Vali Loss: 1.941 Vali Acc: 0.624 Test Loss: 1.941 Test Acc: 0.624
Validation loss decreased (-0.578021 --> -0.624258).  Saving model ...
Epoch: 6 cost time: 10.575579166412354
Epoch: 6, Steps: 34 | Train Loss: 1.481 Vali Loss: 1.975 Vali Acc: 0.671 Test Loss: 1.975 Test Acc: 0.671
Validation loss decreased (-0.624258 --> -0.670500).  Saving model ...
Epoch: 7 cost time: 13.537072658538818
Epoch: 7, Steps: 34 | Train Loss: 1.672 Vali Loss: 4.471 Vali Acc: 0.503 Test Loss: 4.471 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.223673820495605
Epoch: 8, Steps: 34 | Train Loss: 1.426 Vali Loss: 1.709 Vali Acc: 0.705 Test Loss: 1.709 Test Acc: 0.705
Validation loss decreased (-0.670500 --> -0.705185).  Saving model ...
Epoch: 9 cost time: 13.867924451828003
Epoch: 9, Steps: 34 | Train Loss: 0.795 Vali Loss: 5.966 Vali Acc: 0.590 Test Loss: 5.966 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.626655101776123
Epoch: 10, Steps: 34 | Train Loss: 1.294 Vali Loss: 2.684 Vali Acc: 0.607 Test Loss: 2.684 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.501390218734741
Epoch: 11, Steps: 34 | Train Loss: 0.558 Vali Loss: 1.908 Vali Acc: 0.705 Test Loss: 1.908 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.603760480880737
Epoch: 12, Steps: 34 | Train Loss: 0.323 Vali Loss: 1.788 Vali Acc: 0.717 Test Loss: 1.788 Test Acc: 0.717
Validation loss decreased (-0.705185 --> -0.716745).  Saving model ...
Epoch: 13 cost time: 11.67245864868164
Epoch: 13, Steps: 34 | Train Loss: 0.395 Vali Loss: 2.753 Vali Acc: 0.740 Test Loss: 2.753 Test Acc: 0.740
Validation loss decreased (-0.716745 --> -0.739857).  Saving model ...
Epoch: 14 cost time: 13.408022403717041
Epoch: 14, Steps: 34 | Train Loss: 0.233 Vali Loss: 4.006 Vali Acc: 0.642 Test Loss: 4.006 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.871936559677124
Epoch: 15, Steps: 34 | Train Loss: 0.198 Vali Loss: 3.319 Vali Acc: 0.740 Test Loss: 3.319 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.713826179504395
Epoch: 16, Steps: 34 | Train Loss: 0.411 Vali Loss: 4.239 Vali Acc: 0.630 Test Loss: 4.239 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.687922239303589
Epoch: 17, Steps: 34 | Train Loss: 0.168 Vali Loss: 2.347 Vali Acc: 0.792 Test Loss: 2.347 Test Acc: 0.792
Validation loss decreased (-0.739857 --> -0.791884).  Saving model ...
Epoch: 18 cost time: 11.740485668182373
Epoch: 18, Steps: 34 | Train Loss: 0.692 Vali Loss: 5.493 Vali Acc: 0.532 Test Loss: 5.493 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.05225920677185
Epoch: 19, Steps: 34 | Train Loss: 0.616 Vali Loss: 3.013 Vali Acc: 0.728 Test Loss: 3.013 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 13.426913976669312
Epoch: 20, Steps: 34 | Train Loss: 0.530 Vali Loss: 2.519 Vali Acc: 0.769 Test Loss: 2.519 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.074758768081665
Epoch: 21, Steps: 34 | Train Loss: 0.150 Vali Loss: 2.717 Vali Acc: 0.786 Test Loss: 2.717 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.226658344268799
Epoch: 22, Steps: 34 | Train Loss: 0.101 Vali Loss: 3.619 Vali Acc: 0.711 Test Loss: 3.619 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.135433197021484
Epoch: 23, Steps: 34 | Train Loss: 0.397 Vali Loss: 11.419 Vali Acc: 0.468 Test Loss: 11.419 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.854122638702393
Epoch: 24, Steps: 34 | Train Loss: 0.654 Vali Loss: 2.599 Vali Acc: 0.803 Test Loss: 2.599 Test Acc: 0.803
Validation loss decreased (-0.791884 --> -0.803442).  Saving model ...
Epoch: 25 cost time: 12.601547479629517
Epoch: 25, Steps: 34 | Train Loss: 0.068 Vali Loss: 5.388 Vali Acc: 0.717 Test Loss: 5.388 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 13.323270320892334
Epoch: 26, Steps: 34 | Train Loss: 0.273 Vali Loss: 2.378 Vali Acc: 0.775 Test Loss: 2.378 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 11.914937734603882
Epoch: 27, Steps: 34 | Train Loss: 0.211 Vali Loss: 3.447 Vali Acc: 0.734 Test Loss: 3.447 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 11.891032218933105
Epoch: 28, Steps: 34 | Train Loss: 0.187 Vali Loss: 4.135 Vali Acc: 0.740 Test Loss: 4.135 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 12.732783555984497
Epoch: 29, Steps: 34 | Train Loss: 0.119 Vali Loss: 7.660 Vali Acc: 0.688 Test Loss: 7.660 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 12.75022578239441
Epoch: 30, Steps: 34 | Train Loss: 0.184 Vali Loss: 5.052 Vali Acc: 0.740 Test Loss: 5.052 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 14.399172306060791
Epoch: 31, Steps: 34 | Train Loss: 0.280 Vali Loss: 3.738 Vali Acc: 0.746 Test Loss: 3.738 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 14.811578273773193
Epoch: 32, Steps: 34 | Train Loss: 0.267 Vali Loss: 4.486 Vali Acc: 0.769 Test Loss: 4.486 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 12.357913255691528
Epoch: 33, Steps: 34 | Train Loss: 0.262 Vali Loss: 5.009 Vali Acc: 0.717 Test Loss: 5.009 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 13.690311908721924
Epoch: 34, Steps: 34 | Train Loss: 0.156 Vali Loss: 4.061 Vali Acc: 0.786 Test Loss: 4.061 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1261251
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.276846885681152
Epoch: 1, Steps: 34 | Train Loss: 2.238 Vali Loss: 1.678 Vali Acc: 0.324 Test Loss: 1.678 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 12.299633264541626
Epoch: 2, Steps: 34 | Train Loss: 1.671 Vali Loss: 1.510 Vali Acc: 0.526 Test Loss: 1.510 Test Acc: 0.526
Validation loss decreased (-0.323683 --> -0.525996).  Saving model ...
Epoch: 3 cost time: 12.700191974639893
Epoch: 3, Steps: 34 | Train Loss: 1.658 Vali Loss: 1.983 Vali Acc: 0.497 Test Loss: 1.983 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.394877195358276
Epoch: 4, Steps: 34 | Train Loss: 1.566 Vali Loss: 2.618 Vali Acc: 0.561 Test Loss: 2.618 Test Acc: 0.561
Validation loss decreased (-0.525996 --> -0.560667).  Saving model ...
Epoch: 5 cost time: 11.945757627487183
Epoch: 5, Steps: 34 | Train Loss: 1.180 Vali Loss: 3.395 Vali Acc: 0.393 Test Loss: 3.395 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.000437498092651
Epoch: 6, Steps: 34 | Train Loss: 1.235 Vali Loss: 6.315 Vali Acc: 0.410 Test Loss: 6.315 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.014132261276245
Epoch: 7, Steps: 34 | Train Loss: 1.053 Vali Loss: 3.460 Vali Acc: 0.595 Test Loss: 3.460 Test Acc: 0.595
Validation loss decreased (-0.560667 --> -0.595341).  Saving model ...
Epoch: 8 cost time: 11.712316751480103
Epoch: 8, Steps: 34 | Train Loss: 1.383 Vali Loss: 4.137 Vali Acc: 0.572 Test Loss: 4.137 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.663379669189453
Epoch: 9, Steps: 34 | Train Loss: 1.363 Vali Loss: 6.838 Vali Acc: 0.457 Test Loss: 6.838 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.977469682693481
Epoch: 10, Steps: 34 | Train Loss: 1.252 Vali Loss: 2.558 Vali Acc: 0.705 Test Loss: 2.558 Test Acc: 0.705
Validation loss decreased (-0.595341 --> -0.705177).  Saving model ...
Epoch: 11 cost time: 12.798741102218628
Epoch: 11, Steps: 34 | Train Loss: 0.763 Vali Loss: 3.795 Vali Acc: 0.671 Test Loss: 3.795 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.170894861221313
Epoch: 12, Steps: 34 | Train Loss: 0.688 Vali Loss: 2.273 Vali Acc: 0.792 Test Loss: 2.273 Test Acc: 0.792
Validation loss decreased (-0.705177 --> -0.791885).  Saving model ...
Epoch: 13 cost time: 13.44994068145752
Epoch: 13, Steps: 34 | Train Loss: 0.261 Vali Loss: 4.428 Vali Acc: 0.601 Test Loss: 4.428 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.257046461105347
Epoch: 14, Steps: 34 | Train Loss: 0.518 Vali Loss: 2.796 Vali Acc: 0.717 Test Loss: 2.796 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.515468120574951
Epoch: 15, Steps: 34 | Train Loss: 0.135 Vali Loss: 2.296 Vali Acc: 0.769 Test Loss: 2.296 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.095733165740967
Epoch: 16, Steps: 34 | Train Loss: 0.069 Vali Loss: 3.402 Vali Acc: 0.705 Test Loss: 3.402 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.879696130752563
Epoch: 17, Steps: 34 | Train Loss: 0.157 Vali Loss: 2.950 Vali Acc: 0.746 Test Loss: 2.950 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.047637462615967
Epoch: 18, Steps: 34 | Train Loss: 0.330 Vali Loss: 2.431 Vali Acc: 0.751 Test Loss: 2.431 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.033795595169067
Epoch: 19, Steps: 34 | Train Loss: 0.024 Vali Loss: 1.610 Vali Acc: 0.821 Test Loss: 1.610 Test Acc: 0.821
Validation loss decreased (-0.791885 --> -0.820793).  Saving model ...
Epoch: 20 cost time: 14.200684309005737
Epoch: 20, Steps: 34 | Train Loss: 0.046 Vali Loss: 1.525 Vali Acc: 0.821 Test Loss: 1.525 Test Acc: 0.821
Validation loss decreased (-0.820793 --> -0.820794).  Saving model ...
Epoch: 21 cost time: 13.259885549545288
Epoch: 21, Steps: 34 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.803 Test Loss: 1.604 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.702166080474854
Epoch: 22, Steps: 34 | Train Loss: 0.021 Vali Loss: 1.699 Vali Acc: 0.815 Test Loss: 1.699 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.35144829750061
Epoch: 23, Steps: 34 | Train Loss: 0.017 Vali Loss: 1.820 Vali Acc: 0.786 Test Loss: 1.820 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.451256036758423
Epoch: 24, Steps: 34 | Train Loss: 0.111 Vali Loss: 2.780 Vali Acc: 0.751 Test Loss: 2.780 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.775630474090576
Epoch: 25, Steps: 34 | Train Loss: 0.018 Vali Loss: 3.144 Vali Acc: 0.751 Test Loss: 3.144 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.949412822723389
Epoch: 26, Steps: 34 | Train Loss: 0.012 Vali Loss: 3.684 Vali Acc: 0.746 Test Loss: 3.684 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 12.133742332458496
Epoch: 27, Steps: 34 | Train Loss: 0.157 Vali Loss: 2.005 Vali Acc: 0.803 Test Loss: 2.005 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 12.59398889541626
Epoch: 28, Steps: 34 | Train Loss: 0.002 Vali Loss: 3.681 Vali Acc: 0.699 Test Loss: 3.681 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.387837409973145
Epoch: 29, Steps: 34 | Train Loss: 0.223 Vali Loss: 6.307 Vali Acc: 0.590 Test Loss: 6.307 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 11.867231130599976
Epoch: 30, Steps: 34 | Train Loss: 0.598 Vali Loss: 1.848 Vali Acc: 0.815 Test Loss: 1.848 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1260515
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.079110622406006
Epoch: 1, Steps: 34 | Train Loss: 2.081 Vali Loss: 2.137 Vali Acc: 0.335 Test Loss: 2.137 Test Acc: 0.335
Validation loss decreased (inf --> -0.335239).  Saving model ...
Epoch: 2 cost time: 11.941517114639282
Epoch: 2, Steps: 34 | Train Loss: 2.055 Vali Loss: 1.092 Vali Acc: 0.607 Test Loss: 1.092 Test Acc: 0.607
Validation loss decreased (-0.335239 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 11.590846300125122
Epoch: 3, Steps: 34 | Train Loss: 1.427 Vali Loss: 1.090 Vali Acc: 0.636 Test Loss: 1.090 Test Acc: 0.636
Validation loss decreased (-0.606925 --> -0.635827).  Saving model ...
Epoch: 4 cost time: 11.495911598205566
Epoch: 4, Steps: 34 | Train Loss: 1.288 Vali Loss: 1.285 Vali Acc: 0.665 Test Loss: 1.285 Test Acc: 0.665
Validation loss decreased (-0.635827 --> -0.664727).  Saving model ...
Epoch: 5 cost time: 12.036517858505249
Epoch: 5, Steps: 34 | Train Loss: 2.305 Vali Loss: 1.652 Vali Acc: 0.671 Test Loss: 1.652 Test Acc: 0.671
Validation loss decreased (-0.664727 --> -0.670504).  Saving model ...
Epoch: 6 cost time: 12.670055627822876
Epoch: 6, Steps: 34 | Train Loss: 1.387 Vali Loss: 1.453 Vali Acc: 0.728 Test Loss: 1.453 Test Acc: 0.728
Validation loss decreased (-0.670504 --> -0.728309).  Saving model ...
Epoch: 7 cost time: 12.97588586807251
Epoch: 7, Steps: 34 | Train Loss: 1.285 Vali Loss: 2.438 Vali Acc: 0.671 Test Loss: 2.438 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.688756465911865
Epoch: 8, Steps: 34 | Train Loss: 0.583 Vali Loss: 4.227 Vali Acc: 0.526 Test Loss: 4.227 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.197274208068848
Epoch: 9, Steps: 34 | Train Loss: 0.753 Vali Loss: 1.356 Vali Acc: 0.786 Test Loss: 1.356 Test Acc: 0.786
Validation loss decreased (-0.728309 --> -0.786114).  Saving model ...
Epoch: 10 cost time: 12.47378420829773
Epoch: 10, Steps: 34 | Train Loss: 0.795 Vali Loss: 2.958 Vali Acc: 0.618 Test Loss: 2.958 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.567575931549072
Epoch: 11, Steps: 34 | Train Loss: 0.856 Vali Loss: 1.894 Vali Acc: 0.763 Test Loss: 1.894 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.67973017692566
Epoch: 12, Steps: 34 | Train Loss: 0.580 Vali Loss: 2.389 Vali Acc: 0.792 Test Loss: 2.389 Test Acc: 0.792
Validation loss decreased (-0.786114 --> -0.791884).  Saving model ...
Epoch: 13 cost time: 11.697728633880615
Epoch: 13, Steps: 34 | Train Loss: 0.736 Vali Loss: 2.402 Vali Acc: 0.763 Test Loss: 2.402 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.255397319793701
Epoch: 14, Steps: 34 | Train Loss: 0.370 Vali Loss: 1.661 Vali Acc: 0.746 Test Loss: 1.661 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.202536344528198
Epoch: 15, Steps: 34 | Train Loss: 0.196 Vali Loss: 2.319 Vali Acc: 0.763 Test Loss: 2.319 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.196122407913208
Epoch: 16, Steps: 34 | Train Loss: 0.081 Vali Loss: 1.975 Vali Acc: 0.792 Test Loss: 1.975 Test Acc: 0.792
Validation loss decreased (-0.791884 --> -0.791888).  Saving model ...
Epoch: 17 cost time: 13.262125492095947
Epoch: 17, Steps: 34 | Train Loss: 0.107 Vali Loss: 2.312 Vali Acc: 0.809 Test Loss: 2.312 Test Acc: 0.809
Validation loss decreased (-0.791888 --> -0.809225).  Saving model ...
Epoch: 18 cost time: 12.048684358596802
Epoch: 18, Steps: 34 | Train Loss: 0.424 Vali Loss: 2.064 Vali Acc: 0.676 Test Loss: 2.064 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.09300684928894
Epoch: 19, Steps: 34 | Train Loss: 0.525 Vali Loss: 2.938 Vali Acc: 0.653 Test Loss: 2.938 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.381258487701416
Epoch: 20, Steps: 34 | Train Loss: 0.157 Vali Loss: 2.159 Vali Acc: 0.786 Test Loss: 2.159 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.359017610549927
Epoch: 21, Steps: 34 | Train Loss: 0.081 Vali Loss: 1.891 Vali Acc: 0.769 Test Loss: 1.891 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.81869387626648
Epoch: 22, Steps: 34 | Train Loss: 0.187 Vali Loss: 2.017 Vali Acc: 0.827 Test Loss: 2.017 Test Acc: 0.827
Validation loss decreased (-0.809225 --> -0.826569).  Saving model ...
Epoch: 23 cost time: 10.962773323059082
Epoch: 23, Steps: 34 | Train Loss: 0.061 Vali Loss: 1.938 Vali Acc: 0.780 Test Loss: 1.938 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.855678081512451
Epoch: 24, Steps: 34 | Train Loss: 0.097 Vali Loss: 2.753 Vali Acc: 0.803 Test Loss: 2.753 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.210509777069092
Epoch: 25, Steps: 34 | Train Loss: 0.036 Vali Loss: 2.317 Vali Acc: 0.815 Test Loss: 2.317 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.835551261901855
Epoch: 26, Steps: 34 | Train Loss: 0.028 Vali Loss: 3.874 Vali Acc: 0.757 Test Loss: 3.874 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.999283790588379
Epoch: 27, Steps: 34 | Train Loss: 0.501 Vali Loss: 2.772 Vali Acc: 0.780 Test Loss: 2.772 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.624866247177124
Epoch: 28, Steps: 34 | Train Loss: 0.257 Vali Loss: 5.229 Vali Acc: 0.711 Test Loss: 5.229 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 14.222599267959595
Epoch: 29, Steps: 34 | Train Loss: 0.108 Vali Loss: 2.118 Vali Acc: 0.792 Test Loss: 2.118 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 12.578125953674316
Epoch: 30, Steps: 34 | Train Loss: 0.147 Vali Loss: 3.833 Vali Acc: 0.723 Test Loss: 3.833 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 12.372982501983643
Epoch: 31, Steps: 34 | Train Loss: 0.208 Vali Loss: 4.011 Vali Acc: 0.786 Test Loss: 4.011 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 11.958136796951294
Epoch: 32, Steps: 34 | Train Loss: 0.363 Vali Loss: 3.924 Vali Acc: 0.746 Test Loss: 3.924 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1259779
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.380638122558594
Epoch: 1, Steps: 34 | Train Loss: 2.087 Vali Loss: 1.903 Vali Acc: 0.324 Test Loss: 1.903 Test Acc: 0.324
Validation loss decreased (inf --> -0.323680).  Saving model ...
Epoch: 2 cost time: 11.405988931655884
Epoch: 2, Steps: 34 | Train Loss: 1.912 Vali Loss: 3.868 Vali Acc: 0.254 Test Loss: 3.868 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.007312774658203
Epoch: 3, Steps: 34 | Train Loss: 1.844 Vali Loss: 1.924 Vali Acc: 0.416 Test Loss: 1.924 Test Acc: 0.416
Validation loss decreased (-0.323680 --> -0.416166).  Saving model ...
Epoch: 4 cost time: 11.133316993713379
Epoch: 4, Steps: 34 | Train Loss: 1.792 Vali Loss: 2.239 Vali Acc: 0.543 Test Loss: 2.239 Test Acc: 0.543
Validation loss decreased (-0.416166 --> -0.543330).  Saving model ...
Epoch: 5 cost time: 11.974079847335815
Epoch: 5, Steps: 34 | Train Loss: 2.645 Vali Loss: 3.317 Vali Acc: 0.624 Test Loss: 3.317 Test Acc: 0.624
Validation loss decreased (-0.543330 --> -0.624244).  Saving model ...
Epoch: 6 cost time: 12.127900123596191
Epoch: 6, Steps: 34 | Train Loss: 1.415 Vali Loss: 6.027 Vali Acc: 0.486 Test Loss: 6.027 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.306813478469849
Epoch: 7, Steps: 34 | Train Loss: 2.665 Vali Loss: 3.657 Vali Acc: 0.439 Test Loss: 3.657 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.815443277359009
Epoch: 8, Steps: 34 | Train Loss: 1.848 Vali Loss: 3.568 Vali Acc: 0.618 Test Loss: 3.568 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.383221626281738
Epoch: 9, Steps: 34 | Train Loss: 1.759 Vali Loss: 2.447 Vali Acc: 0.653 Test Loss: 2.447 Test Acc: 0.653
Validation loss decreased (-0.624244 --> -0.653155).  Saving model ...
Epoch: 10 cost time: 12.181288719177246
Epoch: 10, Steps: 34 | Train Loss: 1.427 Vali Loss: 5.135 Vali Acc: 0.613 Test Loss: 5.135 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.76417851448059
Epoch: 11, Steps: 34 | Train Loss: 0.626 Vali Loss: 3.503 Vali Acc: 0.682 Test Loss: 3.503 Test Acc: 0.682
Validation loss decreased (-0.653155 --> -0.682046).  Saving model ...
Epoch: 12 cost time: 12.021288633346558
Epoch: 12, Steps: 34 | Train Loss: 0.781 Vali Loss: 3.359 Vali Acc: 0.688 Test Loss: 3.359 Test Acc: 0.688
Validation loss decreased (-0.682046 --> -0.687828).  Saving model ...
Epoch: 13 cost time: 12.097506046295166
Epoch: 13, Steps: 34 | Train Loss: 0.558 Vali Loss: 2.799 Vali Acc: 0.671 Test Loss: 2.799 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.73661732673645
Epoch: 14, Steps: 34 | Train Loss: 0.274 Vali Loss: 3.394 Vali Acc: 0.694 Test Loss: 3.394 Test Acc: 0.694
Validation loss decreased (-0.687828 --> -0.693608).  Saving model ...
Epoch: 15 cost time: 11.312909603118896
Epoch: 15, Steps: 34 | Train Loss: 0.621 Vali Loss: 3.489 Vali Acc: 0.763 Test Loss: 3.489 Test Acc: 0.763
Validation loss decreased (-0.693608 --> -0.762971).  Saving model ...
Epoch: 16 cost time: 11.977469682693481
Epoch: 16, Steps: 34 | Train Loss: 0.063 Vali Loss: 2.346 Vali Acc: 0.803 Test Loss: 2.346 Test Acc: 0.803
Validation loss decreased (-0.762971 --> -0.803445).  Saving model ...
Epoch: 17 cost time: 12.497570514678955
Epoch: 17, Steps: 34 | Train Loss: 0.305 Vali Loss: 5.382 Vali Acc: 0.705 Test Loss: 5.382 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.31892991065979
Epoch: 18, Steps: 34 | Train Loss: 0.830 Vali Loss: 2.399 Vali Acc: 0.763 Test Loss: 2.399 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.705688953399658
Epoch: 19, Steps: 34 | Train Loss: 0.108 Vali Loss: 1.979 Vali Acc: 0.798 Test Loss: 1.979 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.189343214035034
Epoch: 20, Steps: 34 | Train Loss: 0.080 Vali Loss: 2.907 Vali Acc: 0.734 Test Loss: 2.907 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.954397201538086
Epoch: 21, Steps: 34 | Train Loss: 0.205 Vali Loss: 3.069 Vali Acc: 0.728 Test Loss: 3.069 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.83482813835144
Epoch: 22, Steps: 34 | Train Loss: 0.053 Vali Loss: 4.835 Vali Acc: 0.728 Test Loss: 4.835 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.490846395492554
Epoch: 23, Steps: 34 | Train Loss: 0.124 Vali Loss: 4.640 Vali Acc: 0.734 Test Loss: 4.640 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.499186754226685
Epoch: 24, Steps: 34 | Train Loss: 0.079 Vali Loss: 3.585 Vali Acc: 0.775 Test Loss: 3.585 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 15.110713005065918
Epoch: 25, Steps: 34 | Train Loss: 0.183 Vali Loss: 3.002 Vali Acc: 0.803 Test Loss: 3.002 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 14.566673994064331
Epoch: 26, Steps: 34 | Train Loss: 0.317 Vali Loss: 1.892 Vali Acc: 0.803 Test Loss: 1.892 Test Acc: 0.803
Validation loss decreased (-0.803445 --> -0.803449).  Saving model ...
Epoch: 27 cost time: 8.91307544708252
Epoch: 27, Steps: 34 | Train Loss: 0.224 Vali Loss: 1.885 Vali Acc: 0.815 Test Loss: 1.885 Test Acc: 0.815
Validation loss decreased (-0.803449 --> -0.815010).  Saving model ...
Epoch: 28 cost time: 9.790749073028564
Epoch: 28, Steps: 34 | Train Loss: 0.113 Vali Loss: 5.526 Vali Acc: 0.630 Test Loss: 5.526 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 10.748045682907104
Epoch: 29, Steps: 34 | Train Loss: 0.372 Vali Loss: 1.774 Vali Acc: 0.867 Test Loss: 1.774 Test Acc: 0.867
Validation loss decreased (-0.815010 --> -0.867034).  Saving model ...
Epoch: 30 cost time: 12.287365198135376
Epoch: 30, Steps: 34 | Train Loss: 0.114 Vali Loss: 1.233 Vali Acc: 0.861 Test Loss: 1.233 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 11.39998197555542
Epoch: 31, Steps: 34 | Train Loss: 0.153 Vali Loss: 1.074 Vali Acc: 0.844 Test Loss: 1.074 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 10.057942390441895
Epoch: 32, Steps: 34 | Train Loss: 0.009 Vali Loss: 2.369 Vali Acc: 0.803 Test Loss: 2.369 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 11.731609344482422
Epoch: 33, Steps: 34 | Train Loss: 0.005 Vali Loss: 1.169 Vali Acc: 0.855 Test Loss: 1.169 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 10.841780662536621
Epoch: 34, Steps: 34 | Train Loss: 0.022 Vali Loss: 1.554 Vali Acc: 0.850 Test Loss: 1.554 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 12.280807971954346
Epoch: 35, Steps: 34 | Train Loss: 0.022 Vali Loss: 1.018 Vali Acc: 0.873 Test Loss: 1.018 Test Acc: 0.873
Validation loss decreased (-0.867034 --> -0.872822).  Saving model ...
Epoch: 36 cost time: 12.053500890731812
Epoch: 36, Steps: 34 | Train Loss: 0.001 Vali Loss: 2.760 Vali Acc: 0.780 Test Loss: 2.760 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 10.917717218399048
Epoch: 37, Steps: 34 | Train Loss: 0.011 Vali Loss: 2.198 Vali Acc: 0.803 Test Loss: 2.198 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 11.439397096633911
Epoch: 38, Steps: 34 | Train Loss: 0.001 Vali Loss: 2.440 Vali Acc: 0.815 Test Loss: 2.440 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 11.717775106430054
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.481 Vali Acc: 0.815 Test Loss: 2.481 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 11.547226428985596
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.431 Vali Acc: 0.815 Test Loss: 2.431 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 12.70533299446106
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.815 Test Loss: 2.347 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 11.34593415260315
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.815 Test Loss: 2.279 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 11.553667306900024
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.815 Test Loss: 2.274 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 11.802029132843018
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.273 Vali Acc: 0.815 Test Loss: 2.273 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 11.586514711380005
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.270 Vali Acc: 0.815 Test Loss: 2.270 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1112227
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.733036756515503
Epoch: 1, Steps: 34 | Train Loss: 2.105 Vali Loss: 3.132 Vali Acc: 0.324 Test Loss: 3.132 Test Acc: 0.324
Validation loss decreased (inf --> -0.323668).  Saving model ...
Epoch: 2 cost time: 12.011775970458984
Epoch: 2, Steps: 34 | Train Loss: 2.144 Vali Loss: 1.897 Vali Acc: 0.491 Test Loss: 1.897 Test Acc: 0.491
Validation loss decreased (-0.323668 --> -0.491311).  Saving model ...
Epoch: 3 cost time: 12.08786153793335
Epoch: 3, Steps: 34 | Train Loss: 1.933 Vali Loss: 4.449 Vali Acc: 0.301 Test Loss: 4.449 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.792988777160645
Epoch: 4, Steps: 34 | Train Loss: 2.489 Vali Loss: 7.611 Vali Acc: 0.324 Test Loss: 7.611 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.039405107498169
Epoch: 5, Steps: 34 | Train Loss: 1.656 Vali Loss: 2.684 Vali Acc: 0.503 Test Loss: 2.684 Test Acc: 0.503
Validation loss decreased (-0.491311 --> -0.502863).  Saving model ...
Epoch: 6 cost time: 9.337608098983765
Epoch: 6, Steps: 34 | Train Loss: 1.597 Vali Loss: 4.012 Vali Acc: 0.584 Test Loss: 4.012 Test Acc: 0.584
Validation loss decreased (-0.502863 --> -0.583775).  Saving model ...
Epoch: 7 cost time: 11.463362455368042
Epoch: 7, Steps: 34 | Train Loss: 1.449 Vali Loss: 6.732 Vali Acc: 0.474 Test Loss: 6.732 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.224367618560791
Epoch: 8, Steps: 34 | Train Loss: 1.477 Vali Loss: 4.768 Vali Acc: 0.624 Test Loss: 4.768 Test Acc: 0.624
Validation loss decreased (-0.583775 --> -0.624230).  Saving model ...
Epoch: 9 cost time: 11.086096286773682
Epoch: 9, Steps: 34 | Train Loss: 0.683 Vali Loss: 4.931 Vali Acc: 0.503 Test Loss: 4.931 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.989006996154785
Epoch: 10, Steps: 34 | Train Loss: 0.937 Vali Loss: 3.130 Vali Acc: 0.630 Test Loss: 3.130 Test Acc: 0.630
Validation loss decreased (-0.624230 --> -0.630027).  Saving model ...
Epoch: 11 cost time: 9.901618480682373
Epoch: 11, Steps: 34 | Train Loss: 0.669 Vali Loss: 2.279 Vali Acc: 0.734 Test Loss: 2.279 Test Acc: 0.734
Validation loss decreased (-0.630027 --> -0.734081).  Saving model ...
Epoch: 12 cost time: 12.199364423751831
Epoch: 12, Steps: 34 | Train Loss: 0.551 Vali Loss: 1.588 Vali Acc: 0.775 Test Loss: 1.588 Test Acc: 0.775
Validation loss decreased (-0.734081 --> -0.774551).  Saving model ...
Epoch: 13 cost time: 11.152605056762695
Epoch: 13, Steps: 34 | Train Loss: 0.425 Vali Loss: 4.370 Vali Acc: 0.699 Test Loss: 4.370 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.331929922103882
Epoch: 14, Steps: 34 | Train Loss: 0.556 Vali Loss: 1.578 Vali Acc: 0.775 Test Loss: 1.578 Test Acc: 0.775
Validation loss decreased (-0.774551 --> -0.774551).  Saving model ...
Epoch: 15 cost time: 11.363832712173462
Epoch: 15, Steps: 34 | Train Loss: 0.203 Vali Loss: 1.572 Vali Acc: 0.832 Test Loss: 1.572 Test Acc: 0.832
Validation loss decreased (-0.774551 --> -0.832354).  Saving model ...
Epoch: 16 cost time: 10.514448881149292
Epoch: 16, Steps: 34 | Train Loss: 0.133 Vali Loss: 4.967 Vali Acc: 0.647 Test Loss: 4.967 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.753469228744507
Epoch: 17, Steps: 34 | Train Loss: 0.204 Vali Loss: 1.895 Vali Acc: 0.786 Test Loss: 1.895 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.457168579101562
Epoch: 18, Steps: 34 | Train Loss: 0.088 Vali Loss: 2.073 Vali Acc: 0.809 Test Loss: 2.073 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.650837659835815
Epoch: 19, Steps: 34 | Train Loss: 0.182 Vali Loss: 3.073 Vali Acc: 0.751 Test Loss: 3.073 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.662832021713257
Epoch: 20, Steps: 34 | Train Loss: 0.320 Vali Loss: 6.552 Vali Acc: 0.624 Test Loss: 6.552 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.916758298873901
Epoch: 21, Steps: 34 | Train Loss: 1.750 Vali Loss: 6.352 Vali Acc: 0.653 Test Loss: 6.352 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.030191659927368
Epoch: 22, Steps: 34 | Train Loss: 0.099 Vali Loss: 4.301 Vali Acc: 0.699 Test Loss: 4.301 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.936871528625488
Epoch: 23, Steps: 34 | Train Loss: 0.112 Vali Loss: 2.539 Vali Acc: 0.792 Test Loss: 2.539 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.61579966545105
Epoch: 24, Steps: 34 | Train Loss: 0.213 Vali Loss: 2.399 Vali Acc: 0.780 Test Loss: 2.399 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 12.505960464477539
Epoch: 25, Steps: 34 | Train Loss: 0.051 Vali Loss: 3.094 Vali Acc: 0.798 Test Loss: 3.094 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1111491
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.133828163146973
Epoch: 1, Steps: 34 | Train Loss: 2.031 Vali Loss: 1.891 Vali Acc: 0.266 Test Loss: 1.891 Test Acc: 0.266
Validation loss decreased (inf --> -0.265877).  Saving model ...
Epoch: 2 cost time: 11.40928339958191
Epoch: 2, Steps: 34 | Train Loss: 2.065 Vali Loss: 2.139 Vali Acc: 0.387 Test Loss: 2.139 Test Acc: 0.387
Validation loss decreased (-0.265877 --> -0.387262).  Saving model ...
Epoch: 3 cost time: 10.582209825515747
Epoch: 3, Steps: 34 | Train Loss: 1.795 Vali Loss: 2.638 Vali Acc: 0.566 Test Loss: 2.638 Test Acc: 0.566
Validation loss decreased (-0.387262 --> -0.566448).  Saving model ...
Epoch: 4 cost time: 11.01088833808899
Epoch: 4, Steps: 34 | Train Loss: 2.734 Vali Loss: 1.975 Vali Acc: 0.659 Test Loss: 1.975 Test Acc: 0.659
Validation loss decreased (-0.566448 --> -0.658940).  Saving model ...
Epoch: 5 cost time: 11.110098123550415
Epoch: 5, Steps: 34 | Train Loss: 2.301 Vali Loss: 4.031 Vali Acc: 0.613 Test Loss: 4.031 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.349887132644653
Epoch: 6, Steps: 34 | Train Loss: 1.475 Vali Loss: 2.348 Vali Acc: 0.647 Test Loss: 2.348 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.744463920593262
Epoch: 7, Steps: 34 | Train Loss: 1.022 Vali Loss: 3.029 Vali Acc: 0.630 Test Loss: 3.029 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.68912410736084
Epoch: 8, Steps: 34 | Train Loss: 1.657 Vali Loss: 2.403 Vali Acc: 0.590 Test Loss: 2.403 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.715839147567749
Epoch: 9, Steps: 34 | Train Loss: 1.100 Vali Loss: 2.478 Vali Acc: 0.642 Test Loss: 2.478 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.703371047973633
Epoch: 10, Steps: 34 | Train Loss: 0.371 Vali Loss: 3.059 Vali Acc: 0.636 Test Loss: 3.059 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.985607862472534
Epoch: 11, Steps: 34 | Train Loss: 0.820 Vali Loss: 2.670 Vali Acc: 0.746 Test Loss: 2.670 Test Acc: 0.746
Validation loss decreased (-0.658940 --> -0.745638).  Saving model ...
Epoch: 12 cost time: 11.96922254562378
Epoch: 12, Steps: 34 | Train Loss: 0.982 Vali Loss: 2.248 Vali Acc: 0.659 Test Loss: 2.248 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.683306694030762
Epoch: 13, Steps: 34 | Train Loss: 0.585 Vali Loss: 8.066 Vali Acc: 0.584 Test Loss: 8.066 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.074877500534058
Epoch: 14, Steps: 34 | Train Loss: 0.583 Vali Loss: 3.637 Vali Acc: 0.647 Test Loss: 3.637 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.059672832489014
Epoch: 15, Steps: 34 | Train Loss: 0.280 Vali Loss: 2.238 Vali Acc: 0.751 Test Loss: 2.238 Test Acc: 0.751
Validation loss decreased (-0.745638 --> -0.751423).  Saving model ...
Epoch: 16 cost time: 10.387762784957886
Epoch: 16, Steps: 34 | Train Loss: 0.269 Vali Loss: 1.979 Vali Acc: 0.769 Test Loss: 1.979 Test Acc: 0.769
Validation loss decreased (-0.751423 --> -0.768766).  Saving model ...
Epoch: 17 cost time: 9.935260772705078
Epoch: 17, Steps: 34 | Train Loss: 0.339 Vali Loss: 1.918 Vali Acc: 0.798 Test Loss: 1.918 Test Acc: 0.798
Validation loss decreased (-0.768766 --> -0.797669).  Saving model ...
Epoch: 18 cost time: 10.533749341964722
Epoch: 18, Steps: 34 | Train Loss: 0.077 Vali Loss: 2.219 Vali Acc: 0.734 Test Loss: 2.219 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.190096139907837
Epoch: 19, Steps: 34 | Train Loss: 0.439 Vali Loss: 1.956 Vali Acc: 0.803 Test Loss: 1.956 Test Acc: 0.803
Validation loss decreased (-0.797669 --> -0.803449).  Saving model ...
Epoch: 20 cost time: 10.11671495437622
Epoch: 20, Steps: 34 | Train Loss: 0.058 Vali Loss: 1.836 Vali Acc: 0.827 Test Loss: 1.836 Test Acc: 0.827
Validation loss decreased (-0.803449 --> -0.826571).  Saving model ...
Epoch: 21 cost time: 9.726954221725464
Epoch: 21, Steps: 34 | Train Loss: 0.123 Vali Loss: 1.092 Vali Acc: 0.838 Test Loss: 1.092 Test Acc: 0.838
Validation loss decreased (-0.826571 --> -0.838139).  Saving model ...
Epoch: 22 cost time: 11.506577730178833
Epoch: 22, Steps: 34 | Train Loss: 0.316 Vali Loss: 3.511 Vali Acc: 0.786 Test Loss: 3.511 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.845873355865479
Epoch: 23, Steps: 34 | Train Loss: 0.207 Vali Loss: 3.369 Vali Acc: 0.757 Test Loss: 3.369 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 10.975831985473633
Epoch: 24, Steps: 34 | Train Loss: 0.479 Vali Loss: 1.333 Vali Acc: 0.861 Test Loss: 1.333 Test Acc: 0.861
Validation loss decreased (-0.838139 --> -0.861258).  Saving model ...
Epoch: 25 cost time: 11.100586891174316
Epoch: 25, Steps: 34 | Train Loss: 0.077 Vali Loss: 1.733 Vali Acc: 0.827 Test Loss: 1.733 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 11.73821473121643
Epoch: 26, Steps: 34 | Train Loss: 0.030 Vali Loss: 2.194 Vali Acc: 0.827 Test Loss: 2.194 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 10.478651285171509
Epoch: 27, Steps: 34 | Train Loss: 0.154 Vali Loss: 2.792 Vali Acc: 0.734 Test Loss: 2.792 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 10.556387424468994
Epoch: 28, Steps: 34 | Train Loss: 0.598 Vali Loss: 2.712 Vali Acc: 0.740 Test Loss: 2.712 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 11.167986392974854
Epoch: 29, Steps: 34 | Train Loss: 0.244 Vali Loss: 3.041 Vali Acc: 0.803 Test Loss: 3.041 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.698053121566772
Epoch: 30, Steps: 34 | Train Loss: 0.040 Vali Loss: 3.141 Vali Acc: 0.780 Test Loss: 3.141 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 10.721279382705688
Epoch: 31, Steps: 34 | Train Loss: 0.172 Vali Loss: 3.810 Vali Acc: 0.734 Test Loss: 3.810 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 10.773706674575806
Epoch: 32, Steps: 34 | Train Loss: 0.218 Vali Loss: 1.882 Vali Acc: 0.798 Test Loss: 1.882 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 9.288535833358765
Epoch: 33, Steps: 34 | Train Loss: 0.060 Vali Loss: 2.794 Vali Acc: 0.763 Test Loss: 2.794 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 8.620590448379517
Epoch: 34, Steps: 34 | Train Loss: 0.073 Vali Loss: 2.514 Vali Acc: 0.775 Test Loss: 2.514 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1110755
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.485075950622559
Epoch: 1, Steps: 34 | Train Loss: 2.087 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
Validation loss decreased (inf --> -0.242753).  Saving model ...
Epoch: 2 cost time: 10.948453187942505
Epoch: 2, Steps: 34 | Train Loss: 2.187 Vali Loss: 2.729 Vali Acc: 0.376 Test Loss: 2.729 Test Acc: 0.376
Validation loss decreased (-0.242753 --> -0.375695).  Saving model ...
Epoch: 3 cost time: 10.574199199676514
Epoch: 3, Steps: 34 | Train Loss: 2.138 Vali Loss: 2.182 Vali Acc: 0.347 Test Loss: 2.182 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.69541072845459
Epoch: 4, Steps: 34 | Train Loss: 1.970 Vali Loss: 1.632 Vali Acc: 0.613 Test Loss: 1.632 Test Acc: 0.613
Validation loss decreased (-0.375695 --> -0.612700).  Saving model ...
Epoch: 5 cost time: 10.717000961303711
Epoch: 5, Steps: 34 | Train Loss: 1.310 Vali Loss: 4.197 Vali Acc: 0.618 Test Loss: 4.197 Test Acc: 0.618
Validation loss decreased (-0.612700 --> -0.618455).  Saving model ...
Epoch: 6 cost time: 10.543671369552612
Epoch: 6, Steps: 34 | Train Loss: 1.441 Vali Loss: 1.299 Vali Acc: 0.665 Test Loss: 1.299 Test Acc: 0.665
Validation loss decreased (-0.618455 --> -0.664727).  Saving model ...
Epoch: 7 cost time: 9.785201072692871
Epoch: 7, Steps: 34 | Train Loss: 1.035 Vali Loss: 3.041 Vali Acc: 0.647 Test Loss: 3.041 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.925849437713623
Epoch: 8, Steps: 34 | Train Loss: 1.302 Vali Loss: 2.060 Vali Acc: 0.694 Test Loss: 2.060 Test Acc: 0.694
Validation loss decreased (-0.664727 --> -0.693621).  Saving model ...
Epoch: 9 cost time: 10.735532999038696
Epoch: 9, Steps: 34 | Train Loss: 0.705 Vali Loss: 3.251 Vali Acc: 0.618 Test Loss: 3.251 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.947920560836792
Epoch: 10, Steps: 34 | Train Loss: 1.104 Vali Loss: 3.089 Vali Acc: 0.723 Test Loss: 3.089 Test Acc: 0.723
Validation loss decreased (-0.693621 --> -0.722512).  Saving model ...
Epoch: 11 cost time: 9.871942281723022
Epoch: 11, Steps: 34 | Train Loss: 0.827 Vali Loss: 2.202 Vali Acc: 0.688 Test Loss: 2.202 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.344457864761353
Epoch: 12, Steps: 34 | Train Loss: 0.543 Vali Loss: 2.664 Vali Acc: 0.746 Test Loss: 2.664 Test Acc: 0.746
Validation loss decreased (-0.722512 --> -0.745638).  Saving model ...
Epoch: 13 cost time: 9.819782018661499
Epoch: 13, Steps: 34 | Train Loss: 0.381 Vali Loss: 2.644 Vali Acc: 0.740 Test Loss: 2.644 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.793306112289429
Epoch: 14, Steps: 34 | Train Loss: 0.149 Vali Loss: 2.757 Vali Acc: 0.746 Test Loss: 2.757 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.715158700942993
Epoch: 15, Steps: 34 | Train Loss: 0.161 Vali Loss: 2.890 Vali Acc: 0.769 Test Loss: 2.890 Test Acc: 0.769
Validation loss decreased (-0.745638 --> -0.768757).  Saving model ...
Epoch: 16 cost time: 10.902935028076172
Epoch: 16, Steps: 34 | Train Loss: 0.405 Vali Loss: 2.271 Vali Acc: 0.786 Test Loss: 2.271 Test Acc: 0.786
Validation loss decreased (-0.768757 --> -0.786104).  Saving model ...
Epoch: 17 cost time: 9.492006301879883
Epoch: 17, Steps: 34 | Train Loss: 0.172 Vali Loss: 2.069 Vali Acc: 0.792 Test Loss: 2.069 Test Acc: 0.792
Validation loss decreased (-0.786104 --> -0.791887).  Saving model ...
Epoch: 18 cost time: 10.816388130187988
Epoch: 18, Steps: 34 | Train Loss: 0.200 Vali Loss: 2.749 Vali Acc: 0.798 Test Loss: 2.749 Test Acc: 0.798
Validation loss decreased (-0.791887 --> -0.797660).  Saving model ...
Epoch: 19 cost time: 10.257028102874756
Epoch: 19, Steps: 34 | Train Loss: 0.270 Vali Loss: 3.122 Vali Acc: 0.798 Test Loss: 3.122 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.946166515350342
Epoch: 20, Steps: 34 | Train Loss: 0.013 Vali Loss: 1.887 Vali Acc: 0.803 Test Loss: 1.887 Test Acc: 0.803
Validation loss decreased (-0.797660 --> -0.803449).  Saving model ...
Epoch: 21 cost time: 10.557304859161377
Epoch: 21, Steps: 34 | Train Loss: 0.559 Vali Loss: 3.707 Vali Acc: 0.746 Test Loss: 3.707 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.181623697280884
Epoch: 22, Steps: 34 | Train Loss: 0.508 Vali Loss: 5.717 Vali Acc: 0.665 Test Loss: 5.717 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.263628721237183
Epoch: 23, Steps: 34 | Train Loss: 2.327 Vali Loss: 1.966 Vali Acc: 0.815 Test Loss: 1.966 Test Acc: 0.815
Validation loss decreased (-0.803449 --> -0.815009).  Saving model ...
Epoch: 24 cost time: 10.508756399154663
Epoch: 24, Steps: 34 | Train Loss: 0.300 Vali Loss: 2.715 Vali Acc: 0.798 Test Loss: 2.715 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.50703763961792
Epoch: 25, Steps: 34 | Train Loss: 0.221 Vali Loss: 4.020 Vali Acc: 0.711 Test Loss: 4.020 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 9.69550371170044
Epoch: 26, Steps: 34 | Train Loss: 0.195 Vali Loss: 2.128 Vali Acc: 0.763 Test Loss: 2.128 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 9.656253576278687
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.780 Test Loss: 1.977 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 11.140388250350952
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.803 Test Loss: 1.466 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.69218897819519
Epoch: 29, Steps: 34 | Train Loss: 0.022 Vali Loss: 1.590 Vali Acc: 0.844 Test Loss: 1.590 Test Acc: 0.844
Validation loss decreased (-0.815009 --> -0.843915).  Saving model ...
Epoch: 30 cost time: 10.907695055007935
Epoch: 30, Steps: 34 | Train Loss: 0.034 Vali Loss: 2.706 Vali Acc: 0.775 Test Loss: 2.706 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 10.621645212173462
Epoch: 31, Steps: 34 | Train Loss: 0.448 Vali Loss: 2.571 Vali Acc: 0.775 Test Loss: 2.571 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 10.61770224571228
Epoch: 32, Steps: 34 | Train Loss: 0.143 Vali Loss: 4.194 Vali Acc: 0.815 Test Loss: 4.194 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 10.179659843444824
Epoch: 33, Steps: 34 | Train Loss: 0.239 Vali Loss: 3.102 Vali Acc: 0.757 Test Loss: 3.102 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 10.819644689559937
Epoch: 34, Steps: 34 | Train Loss: 0.353 Vali Loss: 6.798 Vali Acc: 0.723 Test Loss: 6.798 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 11.018769979476929
Epoch: 35, Steps: 34 | Train Loss: 0.567 Vali Loss: 4.404 Vali Acc: 0.786 Test Loss: 4.404 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 11.575183153152466
Epoch: 36, Steps: 34 | Train Loss: 0.129 Vali Loss: 3.870 Vali Acc: 0.717 Test Loss: 3.870 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 10.339434385299683
Epoch: 37, Steps: 34 | Train Loss: 0.127 Vali Loss: 4.187 Vali Acc: 0.786 Test Loss: 4.187 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 11.003511428833008
Epoch: 38, Steps: 34 | Train Loss: 0.095 Vali Loss: 3.536 Vali Acc: 0.746 Test Loss: 3.536 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 9.767598628997803
Epoch: 39, Steps: 34 | Train Loss: 0.149 Vali Loss: 2.912 Vali Acc: 0.838 Test Loss: 2.912 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1110019
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.182914733886719
Epoch: 1, Steps: 34 | Train Loss: 2.171 Vali Loss: 2.636 Vali Acc: 0.266 Test Loss: 2.636 Test Acc: 0.266
Validation loss decreased (inf --> -0.265870).  Saving model ...
Epoch: 2 cost time: 10.166980981826782
Epoch: 2, Steps: 34 | Train Loss: 2.077 Vali Loss: 4.214 Vali Acc: 0.312 Test Loss: 4.214 Test Acc: 0.312
Validation loss decreased (-0.265870 --> -0.312097).  Saving model ...
Epoch: 3 cost time: 11.243672847747803
Epoch: 3, Steps: 34 | Train Loss: 2.277 Vali Loss: 2.462 Vali Acc: 0.486 Test Loss: 2.462 Test Acc: 0.486
Validation loss decreased (-0.312097 --> -0.485525).  Saving model ...
Epoch: 4 cost time: 9.301849126815796
Epoch: 4, Steps: 34 | Train Loss: 2.522 Vali Loss: 3.299 Vali Acc: 0.364 Test Loss: 3.299 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.051071882247925
Epoch: 5, Steps: 34 | Train Loss: 1.784 Vali Loss: 3.949 Vali Acc: 0.526 Test Loss: 3.949 Test Acc: 0.526
Validation loss decreased (-0.485525 --> -0.525972).  Saving model ...
Epoch: 6 cost time: 9.302154064178467
Epoch: 6, Steps: 34 | Train Loss: 1.617 Vali Loss: 2.158 Vali Acc: 0.584 Test Loss: 2.158 Test Acc: 0.584
Validation loss decreased (-0.525972 --> -0.583793).  Saving model ...
Epoch: 7 cost time: 9.269822835922241
Epoch: 7, Steps: 34 | Train Loss: 1.188 Vali Loss: 2.472 Vali Acc: 0.659 Test Loss: 2.472 Test Acc: 0.659
Validation loss decreased (-0.583793 --> -0.658935).  Saving model ...
Epoch: 8 cost time: 9.628508806228638
Epoch: 8, Steps: 34 | Train Loss: 0.970 Vali Loss: 2.319 Vali Acc: 0.682 Test Loss: 2.319 Test Acc: 0.682
Validation loss decreased (-0.658935 --> -0.682058).  Saving model ...
Epoch: 9 cost time: 10.442085981369019
Epoch: 9, Steps: 34 | Train Loss: 1.886 Vali Loss: 2.942 Vali Acc: 0.607 Test Loss: 2.942 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.373757123947144
Epoch: 10, Steps: 34 | Train Loss: 0.625 Vali Loss: 2.603 Vali Acc: 0.740 Test Loss: 2.603 Test Acc: 0.740
Validation loss decreased (-0.682058 --> -0.739858).  Saving model ...
Epoch: 11 cost time: 8.724846601486206
Epoch: 11, Steps: 34 | Train Loss: 0.689 Vali Loss: 3.308 Vali Acc: 0.636 Test Loss: 3.308 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.404529571533203
Epoch: 12, Steps: 34 | Train Loss: 0.614 Vali Loss: 3.837 Vali Acc: 0.676 Test Loss: 3.837 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.78367805480957
Epoch: 13, Steps: 34 | Train Loss: 1.483 Vali Loss: 2.135 Vali Acc: 0.786 Test Loss: 2.135 Test Acc: 0.786
Validation loss decreased (-0.739858 --> -0.786106).  Saving model ...
Epoch: 14 cost time: 10.090283393859863
Epoch: 14, Steps: 34 | Train Loss: 0.489 Vali Loss: 2.296 Vali Acc: 0.734 Test Loss: 2.296 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.609600067138672
Epoch: 15, Steps: 34 | Train Loss: 0.554 Vali Loss: 2.361 Vali Acc: 0.780 Test Loss: 2.361 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.300879001617432
Epoch: 16, Steps: 34 | Train Loss: 0.088 Vali Loss: 2.906 Vali Acc: 0.786 Test Loss: 2.906 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.769872665405273
Epoch: 17, Steps: 34 | Train Loss: 0.079 Vali Loss: 1.773 Vali Acc: 0.803 Test Loss: 1.773 Test Acc: 0.803
Validation loss decreased (-0.786106 --> -0.803450).  Saving model ...
Epoch: 18 cost time: 10.641474485397339
Epoch: 18, Steps: 34 | Train Loss: 0.124 Vali Loss: 1.899 Vali Acc: 0.798 Test Loss: 1.899 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.58925724029541
Epoch: 19, Steps: 34 | Train Loss: 0.027 Vali Loss: 2.800 Vali Acc: 0.792 Test Loss: 2.800 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.08777666091919
Epoch: 20, Steps: 34 | Train Loss: 0.115 Vali Loss: 4.258 Vali Acc: 0.699 Test Loss: 4.258 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.4495108127594
Epoch: 21, Steps: 34 | Train Loss: 0.239 Vali Loss: 2.078 Vali Acc: 0.815 Test Loss: 2.078 Test Acc: 0.815
Validation loss decreased (-0.803450 --> -0.815008).  Saving model ...
Epoch: 22 cost time: 9.84705662727356
Epoch: 22, Steps: 34 | Train Loss: 0.140 Vali Loss: 3.012 Vali Acc: 0.803 Test Loss: 3.012 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.249745607376099
Epoch: 23, Steps: 34 | Train Loss: 0.004 Vali Loss: 2.256 Vali Acc: 0.809 Test Loss: 2.256 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.5842125415802
Epoch: 24, Steps: 34 | Train Loss: 0.099 Vali Loss: 2.128 Vali Acc: 0.792 Test Loss: 2.128 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.958200216293335
Epoch: 25, Steps: 34 | Train Loss: 0.091 Vali Loss: 3.692 Vali Acc: 0.786 Test Loss: 3.692 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 10.298568725585938
Epoch: 26, Steps: 34 | Train Loss: 0.042 Vali Loss: 3.800 Vali Acc: 0.809 Test Loss: 3.800 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.8499276638031
Epoch: 27, Steps: 34 | Train Loss: 0.018 Vali Loss: 3.645 Vali Acc: 0.798 Test Loss: 3.645 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.129583597183228
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.398 Vali Acc: 0.798 Test Loss: 3.398 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.42276668548584
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.240 Vali Acc: 0.798 Test Loss: 3.240 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 8.868328094482422
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.229 Vali Acc: 0.798 Test Loss: 3.229 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.113537311553955
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.225 Vali Acc: 0.798 Test Loss: 3.225 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1037347
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.460889101028442
Epoch: 1, Steps: 34 | Train Loss: 1.878 Vali Loss: 1.963 Vali Acc: 0.277 Test Loss: 1.963 Test Acc: 0.277
Validation loss decreased (inf --> -0.277437).  Saving model ...
Epoch: 2 cost time: 10.03745698928833
Epoch: 2, Steps: 34 | Train Loss: 2.540 Vali Loss: 2.199 Vali Acc: 0.532 Test Loss: 2.199 Test Acc: 0.532
Validation loss decreased (-0.277437 --> -0.531770).  Saving model ...
Epoch: 3 cost time: 10.473378896713257
Epoch: 3, Steps: 34 | Train Loss: 1.551 Vali Loss: 1.234 Vali Acc: 0.561 Test Loss: 1.234 Test Acc: 0.561
Validation loss decreased (-0.531770 --> -0.560681).  Saving model ...
Epoch: 4 cost time: 9.076042890548706
Epoch: 4, Steps: 34 | Train Loss: 1.523 Vali Loss: 1.746 Vali Acc: 0.590 Test Loss: 1.746 Test Acc: 0.590
Validation loss decreased (-0.560681 --> -0.589578).  Saving model ...
Epoch: 5 cost time: 8.958085775375366
Epoch: 5, Steps: 34 | Train Loss: 1.772 Vali Loss: 4.743 Vali Acc: 0.434 Test Loss: 4.743 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.595174551010132
Epoch: 6, Steps: 34 | Train Loss: 2.124 Vali Loss: 1.631 Vali Acc: 0.642 Test Loss: 1.631 Test Acc: 0.642
Validation loss decreased (-0.589578 --> -0.641602).  Saving model ...
Epoch: 7 cost time: 10.913154125213623
Epoch: 7, Steps: 34 | Train Loss: 1.648 Vali Loss: 3.296 Vali Acc: 0.688 Test Loss: 3.296 Test Acc: 0.688
Validation loss decreased (-0.641602 --> -0.687828).  Saving model ...
Epoch: 8 cost time: 9.209053754806519
Epoch: 8, Steps: 34 | Train Loss: 1.899 Vali Loss: 1.683 Vali Acc: 0.699 Test Loss: 1.683 Test Acc: 0.699
Validation loss decreased (-0.687828 --> -0.699405).  Saving model ...
Epoch: 9 cost time: 9.470784425735474
Epoch: 9, Steps: 34 | Train Loss: 1.183 Vali Loss: 1.627 Vali Acc: 0.751 Test Loss: 1.627 Test Acc: 0.751
Validation loss decreased (-0.699405 --> -0.751429).  Saving model ...
Epoch: 10 cost time: 10.739228010177612
Epoch: 10, Steps: 34 | Train Loss: 1.624 Vali Loss: 3.339 Vali Acc: 0.659 Test Loss: 3.339 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.104594707489014
Epoch: 11, Steps: 34 | Train Loss: 1.241 Vali Loss: 2.749 Vali Acc: 0.676 Test Loss: 2.749 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.864175796508789
Epoch: 12, Steps: 34 | Train Loss: 0.898 Vali Loss: 2.203 Vali Acc: 0.757 Test Loss: 2.203 Test Acc: 0.757
Validation loss decreased (-0.751429 --> -0.757203).  Saving model ...
Epoch: 13 cost time: 10.075098752975464
Epoch: 13, Steps: 34 | Train Loss: 0.278 Vali Loss: 1.683 Vali Acc: 0.786 Test Loss: 1.683 Test Acc: 0.786
Validation loss decreased (-0.757203 --> -0.786110).  Saving model ...
Epoch: 14 cost time: 10.366038799285889
Epoch: 14, Steps: 34 | Train Loss: 0.749 Vali Loss: 3.118 Vali Acc: 0.711 Test Loss: 3.118 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.33826208114624
Epoch: 15, Steps: 34 | Train Loss: 0.725 Vali Loss: 2.599 Vali Acc: 0.769 Test Loss: 2.599 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.013426780700684
Epoch: 16, Steps: 34 | Train Loss: 0.524 Vali Loss: 2.153 Vali Acc: 0.751 Test Loss: 2.153 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.769306659698486
Epoch: 17, Steps: 34 | Train Loss: 0.582 Vali Loss: 2.614 Vali Acc: 0.769 Test Loss: 2.614 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.776921272277832
Epoch: 18, Steps: 34 | Train Loss: 0.254 Vali Loss: 3.837 Vali Acc: 0.734 Test Loss: 3.837 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.12587022781372
Epoch: 19, Steps: 34 | Train Loss: 0.567 Vali Loss: 2.501 Vali Acc: 0.769 Test Loss: 2.501 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.874270915985107
Epoch: 20, Steps: 34 | Train Loss: 0.369 Vali Loss: 4.381 Vali Acc: 0.671 Test Loss: 4.381 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.653911590576172
Epoch: 21, Steps: 34 | Train Loss: 0.789 Vali Loss: 4.782 Vali Acc: 0.688 Test Loss: 4.782 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.778676509857178
Epoch: 22, Steps: 34 | Train Loss: 0.339 Vali Loss: 2.361 Vali Acc: 0.786 Test Loss: 2.361 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.248804092407227
Epoch: 23, Steps: 34 | Train Loss: 0.155 Vali Loss: 2.810 Vali Acc: 0.798 Test Loss: 2.810 Test Acc: 0.798
Validation loss decreased (-0.786110 --> -0.797660).  Saving model ...
Epoch: 24 cost time: 9.379544258117676
Epoch: 24, Steps: 34 | Train Loss: 0.430 Vali Loss: 4.703 Vali Acc: 0.717 Test Loss: 4.703 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.145007848739624
Epoch: 25, Steps: 34 | Train Loss: 0.113 Vali Loss: 4.409 Vali Acc: 0.769 Test Loss: 4.409 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 9.198760509490967
Epoch: 26, Steps: 34 | Train Loss: 0.035 Vali Loss: 3.316 Vali Acc: 0.775 Test Loss: 3.316 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 9.362748861312866
Epoch: 27, Steps: 34 | Train Loss: 0.218 Vali Loss: 3.318 Vali Acc: 0.769 Test Loss: 3.318 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 9.324734926223755
Epoch: 28, Steps: 34 | Train Loss: 0.031 Vali Loss: 2.692 Vali Acc: 0.757 Test Loss: 2.692 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.165090560913086
Epoch: 29, Steps: 34 | Train Loss: 0.097 Vali Loss: 2.576 Vali Acc: 0.815 Test Loss: 2.576 Test Acc: 0.815
Validation loss decreased (-0.797660 --> -0.815003).  Saving model ...
Epoch: 30 cost time: 8.011666536331177
Epoch: 30, Steps: 34 | Train Loss: 0.049 Vali Loss: 2.624 Vali Acc: 0.775 Test Loss: 2.624 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.745664119720459
Epoch: 31, Steps: 34 | Train Loss: 0.127 Vali Loss: 2.057 Vali Acc: 0.786 Test Loss: 2.057 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 8.271263599395752
Epoch: 32, Steps: 34 | Train Loss: 0.074 Vali Loss: 3.796 Vali Acc: 0.763 Test Loss: 3.796 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 8.060999631881714
Epoch: 33, Steps: 34 | Train Loss: 0.002 Vali Loss: 2.967 Vali Acc: 0.815 Test Loss: 2.967 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 9.269263982772827
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.487 Vali Acc: 0.838 Test Loss: 2.487 Test Acc: 0.838
Validation loss decreased (-0.815003 --> -0.838125).  Saving model ...
Epoch: 35 cost time: 8.579177618026733
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.495 Vali Acc: 0.838 Test Loss: 2.495 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.947108030319214
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.490 Vali Acc: 0.838 Test Loss: 2.490 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 8.456912994384766
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.832 Test Loss: 2.479 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 8.839846134185791
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.451 Vali Acc: 0.815 Test Loss: 2.451 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 8.029174327850342
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 10.01769232749939
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 9.254562616348267
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 8.839879035949707
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 9.546268224716187
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 8.747392892837524
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1036611
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.024322509765625
Epoch: 1, Steps: 34 | Train Loss: 2.216 Vali Loss: 1.682 Vali Acc: 0.301 Test Loss: 1.682 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 9.561778783798218
Epoch: 2, Steps: 34 | Train Loss: 1.722 Vali Loss: 2.110 Vali Acc: 0.549 Test Loss: 2.110 Test Acc: 0.549
Validation loss decreased (-0.300561 --> -0.549112).  Saving model ...
Epoch: 3 cost time: 9.006251573562622
Epoch: 3, Steps: 34 | Train Loss: 2.083 Vali Loss: 2.562 Vali Acc: 0.405 Test Loss: 2.562 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.868041515350342
Epoch: 4, Steps: 34 | Train Loss: 1.379 Vali Loss: 2.033 Vali Acc: 0.601 Test Loss: 2.033 Test Acc: 0.601
Validation loss decreased (-0.549112 --> -0.601136).  Saving model ...
Epoch: 5 cost time: 8.628443002700806
Epoch: 5, Steps: 34 | Train Loss: 1.428 Vali Loss: 7.013 Vali Acc: 0.491 Test Loss: 7.013 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.292721033096313
Epoch: 6, Steps: 34 | Train Loss: 2.465 Vali Loss: 2.284 Vali Acc: 0.526 Test Loss: 2.284 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.75455093383789
Epoch: 7, Steps: 34 | Train Loss: 1.418 Vali Loss: 1.452 Vali Acc: 0.694 Test Loss: 1.452 Test Acc: 0.694
Validation loss decreased (-0.601136 --> -0.693627).  Saving model ...
Epoch: 8 cost time: 8.317170143127441
Epoch: 8, Steps: 34 | Train Loss: 1.958 Vali Loss: 2.319 Vali Acc: 0.705 Test Loss: 2.319 Test Acc: 0.705
Validation loss decreased (-0.693627 --> -0.705179).  Saving model ...
Epoch: 9 cost time: 8.456312656402588
Epoch: 9, Steps: 34 | Train Loss: 1.181 Vali Loss: 3.502 Vali Acc: 0.705 Test Loss: 3.502 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.558496475219727
Epoch: 10, Steps: 34 | Train Loss: 0.604 Vali Loss: 3.458 Vali Acc: 0.636 Test Loss: 3.458 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.161891460418701
Epoch: 11, Steps: 34 | Train Loss: 1.640 Vali Loss: 3.523 Vali Acc: 0.665 Test Loss: 3.523 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.65581464767456
Epoch: 12, Steps: 34 | Train Loss: 0.566 Vali Loss: 2.938 Vali Acc: 0.734 Test Loss: 2.938 Test Acc: 0.734
Validation loss decreased (-0.705179 --> -0.734075).  Saving model ...
Epoch: 13 cost time: 9.632758617401123
Epoch: 13, Steps: 34 | Train Loss: 1.027 Vali Loss: 3.466 Vali Acc: 0.694 Test Loss: 3.466 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.909134149551392
Epoch: 14, Steps: 34 | Train Loss: 0.394 Vali Loss: 1.575 Vali Acc: 0.838 Test Loss: 1.575 Test Acc: 0.838
Validation loss decreased (-0.734075 --> -0.838135).  Saving model ...
Epoch: 15 cost time: 8.913088083267212
Epoch: 15, Steps: 34 | Train Loss: 0.585 Vali Loss: 4.836 Vali Acc: 0.728 Test Loss: 4.836 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.155774116516113
Epoch: 16, Steps: 34 | Train Loss: 0.971 Vali Loss: 3.361 Vali Acc: 0.682 Test Loss: 3.361 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.354910135269165
Epoch: 17, Steps: 34 | Train Loss: 0.423 Vali Loss: 3.590 Vali Acc: 0.757 Test Loss: 3.590 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.477015256881714
Epoch: 18, Steps: 34 | Train Loss: 0.207 Vali Loss: 3.306 Vali Acc: 0.763 Test Loss: 3.306 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.785003662109375
Epoch: 19, Steps: 34 | Train Loss: 0.783 Vali Loss: 4.140 Vali Acc: 0.682 Test Loss: 4.140 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.739509105682373
Epoch: 20, Steps: 34 | Train Loss: 0.700 Vali Loss: 4.549 Vali Acc: 0.671 Test Loss: 4.549 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.623141050338745
Epoch: 21, Steps: 34 | Train Loss: 0.207 Vali Loss: 4.588 Vali Acc: 0.699 Test Loss: 4.588 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.907277584075928
Epoch: 22, Steps: 34 | Train Loss: 0.198 Vali Loss: 5.462 Vali Acc: 0.740 Test Loss: 5.462 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.655197620391846
Epoch: 23, Steps: 34 | Train Loss: 0.336 Vali Loss: 3.690 Vali Acc: 0.769 Test Loss: 3.690 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.79807448387146
Epoch: 24, Steps: 34 | Train Loss: 0.071 Vali Loss: 3.191 Vali Acc: 0.803 Test Loss: 3.191 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1035875
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.901534795761108
Epoch: 1, Steps: 34 | Train Loss: 2.154 Vali Loss: 1.661 Vali Acc: 0.422 Test Loss: 1.661 Test Acc: 0.422
Validation loss decreased (inf --> -0.421949).  Saving model ...
Epoch: 2 cost time: 9.152430772781372
Epoch: 2, Steps: 34 | Train Loss: 1.533 Vali Loss: 2.138 Vali Acc: 0.434 Test Loss: 2.138 Test Acc: 0.434
Validation loss decreased (-0.421949 --> -0.433505).  Saving model ...
Epoch: 3 cost time: 9.040945529937744
Epoch: 3, Steps: 34 | Train Loss: 1.791 Vali Loss: 2.282 Vali Acc: 0.410 Test Loss: 2.282 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.730901956558228
Epoch: 4, Steps: 34 | Train Loss: 1.612 Vali Loss: 3.205 Vali Acc: 0.486 Test Loss: 3.205 Test Acc: 0.486
Validation loss decreased (-0.433505 --> -0.485517).  Saving model ...
Epoch: 5 cost time: 8.5260169506073
Epoch: 5, Steps: 34 | Train Loss: 1.362 Vali Loss: 2.030 Vali Acc: 0.682 Test Loss: 2.030 Test Acc: 0.682
Validation loss decreased (-0.485517 --> -0.682061).  Saving model ...
Epoch: 6 cost time: 9.178208351135254
Epoch: 6, Steps: 34 | Train Loss: 1.027 Vali Loss: 1.961 Vali Acc: 0.659 Test Loss: 1.961 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.86137580871582
Epoch: 7, Steps: 34 | Train Loss: 1.067 Vali Loss: 4.268 Vali Acc: 0.532 Test Loss: 4.268 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.856328010559082
Epoch: 8, Steps: 34 | Train Loss: 1.381 Vali Loss: 2.150 Vali Acc: 0.624 Test Loss: 2.150 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.11928415298462
Epoch: 9, Steps: 34 | Train Loss: 1.343 Vali Loss: 3.673 Vali Acc: 0.636 Test Loss: 3.673 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.682915449142456
Epoch: 10, Steps: 34 | Train Loss: 2.001 Vali Loss: 5.439 Vali Acc: 0.532 Test Loss: 5.439 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.649613857269287
Epoch: 11, Steps: 34 | Train Loss: 1.293 Vali Loss: 2.662 Vali Acc: 0.688 Test Loss: 2.662 Test Acc: 0.688
Validation loss decreased (-0.682061 --> -0.687835).  Saving model ...
Epoch: 12 cost time: 9.38208532333374
Epoch: 12, Steps: 34 | Train Loss: 0.753 Vali Loss: 2.583 Vali Acc: 0.740 Test Loss: 2.583 Test Acc: 0.740
Validation loss decreased (-0.687835 --> -0.739859).  Saving model ...
Epoch: 13 cost time: 8.45760703086853
Epoch: 13, Steps: 34 | Train Loss: 0.231 Vali Loss: 1.258 Vali Acc: 0.844 Test Loss: 1.258 Test Acc: 0.844
Validation loss decreased (-0.739859 --> -0.843918).  Saving model ...
Epoch: 14 cost time: 8.954286575317383
Epoch: 14, Steps: 34 | Train Loss: 0.365 Vali Loss: 1.967 Vali Acc: 0.798 Test Loss: 1.967 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.450999021530151
Epoch: 15, Steps: 34 | Train Loss: 0.366 Vali Loss: 4.129 Vali Acc: 0.682 Test Loss: 4.129 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.033409357070923
Epoch: 16, Steps: 34 | Train Loss: 0.591 Vali Loss: 1.932 Vali Acc: 0.803 Test Loss: 1.932 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.176841259002686
Epoch: 17, Steps: 34 | Train Loss: 0.370 Vali Loss: 2.412 Vali Acc: 0.798 Test Loss: 2.412 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.05821967124939
Epoch: 18, Steps: 34 | Train Loss: 0.233 Vali Loss: 1.848 Vali Acc: 0.809 Test Loss: 1.848 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.753094911575317
Epoch: 19, Steps: 34 | Train Loss: 0.063 Vali Loss: 1.769 Vali Acc: 0.798 Test Loss: 1.769 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.58835244178772
Epoch: 20, Steps: 34 | Train Loss: 0.024 Vali Loss: 1.335 Vali Acc: 0.815 Test Loss: 1.335 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.861939430236816
Epoch: 21, Steps: 34 | Train Loss: 0.075 Vali Loss: 3.053 Vali Acc: 0.763 Test Loss: 3.053 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.464329481124878
Epoch: 22, Steps: 34 | Train Loss: 0.382 Vali Loss: 2.044 Vali Acc: 0.803 Test Loss: 2.044 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.07580828666687
Epoch: 23, Steps: 34 | Train Loss: 0.451 Vali Loss: 1.585 Vali Acc: 0.821 Test Loss: 1.585 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1035139
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 24.867347478866577
Epoch: 1, Steps: 34 | Train Loss: 10.128 Vali Loss: 24.155 Vali Acc: 0.272 Test Loss: 24.155 Test Acc: 0.272
Validation loss decreased (inf --> -0.271435).  Saving model ...
Epoch: 2 cost time: 25.849464893341064
Epoch: 2, Steps: 34 | Train Loss: 17.004 Vali Loss: 14.516 Vali Acc: 0.341 Test Loss: 14.516 Test Acc: 0.341
Validation loss decreased (-0.271435 --> -0.340895).  Saving model ...
Epoch: 3 cost time: 21.206268072128296
Epoch: 3, Steps: 34 | Train Loss: 18.392 Vali Loss: 16.070 Vali Acc: 0.399 Test Loss: 16.070 Test Acc: 0.399
Validation loss decreased (-0.340895 --> -0.398683).  Saving model ...
Epoch: 4 cost time: 23.418718576431274
Epoch: 4, Steps: 34 | Train Loss: 18.082 Vali Loss: 23.816 Vali Acc: 0.451 Test Loss: 23.816 Test Acc: 0.451
Validation loss decreased (-0.398683 --> -0.450629).  Saving model ...
Epoch: 5 cost time: 22.015514850616455
Epoch: 5, Steps: 34 | Train Loss: 12.481 Vali Loss: 4.839 Vali Acc: 0.734 Test Loss: 4.839 Test Acc: 0.734
Validation loss decreased (-0.450629 --> -0.734056).  Saving model ...
Epoch: 6 cost time: 25.2020366191864
Epoch: 6, Steps: 34 | Train Loss: 7.995 Vali Loss: 7.644 Vali Acc: 0.642 Test Loss: 7.644 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.963709831237793
Epoch: 7, Steps: 34 | Train Loss: 6.917 Vali Loss: 6.118 Vali Acc: 0.705 Test Loss: 6.118 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.964247465133667
Epoch: 8, Steps: 34 | Train Loss: 2.996 Vali Loss: 11.394 Vali Acc: 0.653 Test Loss: 11.394 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.989584922790527
Epoch: 9, Steps: 34 | Train Loss: 4.468 Vali Loss: 13.442 Vali Acc: 0.584 Test Loss: 13.442 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.543803930282593
Epoch: 10, Steps: 34 | Train Loss: 2.603 Vali Loss: 5.352 Vali Acc: 0.769 Test Loss: 5.352 Test Acc: 0.769
Validation loss decreased (-0.734056 --> -0.768733).  Saving model ...
Epoch: 11 cost time: 20.55420994758606
Epoch: 11, Steps: 34 | Train Loss: 2.061 Vali Loss: 16.089 Vali Acc: 0.751 Test Loss: 16.089 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.65323781967163
Epoch: 12, Steps: 34 | Train Loss: 2.602 Vali Loss: 16.788 Vali Acc: 0.642 Test Loss: 16.788 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.762113332748413
Epoch: 13, Steps: 34 | Train Loss: 1.983 Vali Loss: 7.910 Vali Acc: 0.694 Test Loss: 7.910 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 22.779801845550537
Epoch: 14, Steps: 34 | Train Loss: 1.648 Vali Loss: 9.745 Vali Acc: 0.699 Test Loss: 9.745 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 23.234692573547363
Epoch: 15, Steps: 34 | Train Loss: 2.795 Vali Loss: 10.007 Vali Acc: 0.792 Test Loss: 10.007 Test Acc: 0.792
Validation loss decreased (-0.768733 --> -0.791807).  Saving model ...
Epoch: 16 cost time: 20.069096088409424
Epoch: 16, Steps: 34 | Train Loss: 1.887 Vali Loss: 6.373 Vali Acc: 0.769 Test Loss: 6.373 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.15382218360901
Epoch: 17, Steps: 34 | Train Loss: 2.827 Vali Loss: 7.574 Vali Acc: 0.763 Test Loss: 7.574 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.05139923095703
Epoch: 18, Steps: 34 | Train Loss: 2.485 Vali Loss: 17.997 Vali Acc: 0.688 Test Loss: 17.997 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 21.84935736656189
Epoch: 19, Steps: 34 | Train Loss: 2.099 Vali Loss: 12.094 Vali Acc: 0.555 Test Loss: 12.094 Test Acc: 0.555
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.132794618606567
Epoch: 20, Steps: 34 | Train Loss: 4.979 Vali Loss: 12.006 Vali Acc: 0.740 Test Loss: 12.006 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.868024349212646
Epoch: 21, Steps: 34 | Train Loss: 2.747 Vali Loss: 10.453 Vali Acc: 0.688 Test Loss: 10.453 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 20.721481800079346
Epoch: 22, Steps: 34 | Train Loss: 3.291 Vali Loss: 9.169 Vali Acc: 0.746 Test Loss: 9.169 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 20.28663468360901
Epoch: 23, Steps: 34 | Train Loss: 3.325 Vali Loss: 39.590 Vali Acc: 0.572 Test Loss: 39.590 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 21.685705184936523
Epoch: 24, Steps: 34 | Train Loss: 6.283 Vali Loss: 27.891 Vali Acc: 0.474 Test Loss: 27.891 Test Acc: 0.474
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 19.636115312576294
Epoch: 25, Steps: 34 | Train Loss: 13.366 Vali Loss: 35.982 Vali Acc: 0.405 Test Loss: 35.982 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 19242295
model size : 78.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.374279737472534
Epoch: 1, Steps: 34 | Train Loss: 9.167 Vali Loss: 18.581 Vali Acc: 0.370 Test Loss: 18.581 Test Acc: 0.370
Validation loss decreased (inf --> -0.369756).  Saving model ...
Epoch: 2 cost time: 19.150063037872314
Epoch: 2, Steps: 34 | Train Loss: 18.321 Vali Loss: 41.359 Vali Acc: 0.306 Test Loss: 41.359 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.053218364715576
Epoch: 3, Steps: 34 | Train Loss: 21.216 Vali Loss: 79.174 Vali Acc: 0.260 Test Loss: 79.174 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.614840269088745
Epoch: 4, Steps: 34 | Train Loss: 19.745 Vali Loss: 14.979 Vali Acc: 0.624 Test Loss: 14.979 Test Acc: 0.624
Validation loss decreased (-0.369756 --> -0.624128).  Saving model ...
Epoch: 5 cost time: 16.698390007019043
Epoch: 5, Steps: 34 | Train Loss: 11.858 Vali Loss: 7.517 Vali Acc: 0.526 Test Loss: 7.517 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.763169050216675
Epoch: 6, Steps: 34 | Train Loss: 3.878 Vali Loss: 7.173 Vali Acc: 0.682 Test Loss: 7.173 Test Acc: 0.682
Validation loss decreased (-0.624128 --> -0.682009).  Saving model ...
Epoch: 7 cost time: 18.445905447006226
Epoch: 7, Steps: 34 | Train Loss: 4.119 Vali Loss: 9.070 Vali Acc: 0.711 Test Loss: 9.070 Test Acc: 0.711
Validation loss decreased (-0.682009 --> -0.710892).  Saving model ...
Epoch: 8 cost time: 17.16086483001709
Epoch: 8, Steps: 34 | Train Loss: 6.553 Vali Loss: 15.890 Vali Acc: 0.671 Test Loss: 15.890 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.971768140792847
Epoch: 9, Steps: 34 | Train Loss: 2.291 Vali Loss: 17.014 Vali Acc: 0.676 Test Loss: 17.014 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.606037616729736
Epoch: 10, Steps: 34 | Train Loss: 11.623 Vali Loss: 18.620 Vali Acc: 0.676 Test Loss: 18.620 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.29287838935852
Epoch: 11, Steps: 34 | Train Loss: 8.398 Vali Loss: 11.214 Vali Acc: 0.740 Test Loss: 11.214 Test Acc: 0.740
Validation loss decreased (-0.710892 --> -0.739772).  Saving model ...
Epoch: 12 cost time: 19.25953483581543
Epoch: 12, Steps: 34 | Train Loss: 6.137 Vali Loss: 19.573 Vali Acc: 0.595 Test Loss: 19.573 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.653635025024414
Epoch: 13, Steps: 34 | Train Loss: 4.028 Vali Loss: 15.779 Vali Acc: 0.653 Test Loss: 15.779 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.380053281784058
Epoch: 14, Steps: 34 | Train Loss: 3.912 Vali Loss: 13.984 Vali Acc: 0.688 Test Loss: 13.984 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.562238216400146
Epoch: 15, Steps: 34 | Train Loss: 2.308 Vali Loss: 10.910 Vali Acc: 0.798 Test Loss: 10.910 Test Acc: 0.798
Validation loss decreased (-0.739772 --> -0.797579).  Saving model ...
Epoch: 16 cost time: 19.530618906021118
Epoch: 16, Steps: 34 | Train Loss: 2.766 Vali Loss: 15.541 Vali Acc: 0.688 Test Loss: 15.541 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.19616961479187
Epoch: 17, Steps: 34 | Train Loss: 1.637 Vali Loss: 43.030 Vali Acc: 0.566 Test Loss: 43.030 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.309550762176514
Epoch: 18, Steps: 34 | Train Loss: 3.706 Vali Loss: 25.261 Vali Acc: 0.676 Test Loss: 25.261 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.518075227737427
Epoch: 19, Steps: 34 | Train Loss: 2.993 Vali Loss: 20.180 Vali Acc: 0.682 Test Loss: 20.180 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.66729712486267
Epoch: 20, Steps: 34 | Train Loss: 4.028 Vali Loss: 20.269 Vali Acc: 0.682 Test Loss: 20.269 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 20.90999484062195
Epoch: 21, Steps: 34 | Train Loss: 2.805 Vali Loss: 35.204 Vali Acc: 0.624 Test Loss: 35.204 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 20.68895959854126
Epoch: 22, Steps: 34 | Train Loss: 4.378 Vali Loss: 6.373 Vali Acc: 0.827 Test Loss: 6.373 Test Acc: 0.827
Validation loss decreased (-0.797579 --> -0.826526).  Saving model ...
Epoch: 23 cost time: 21.080492734909058
Epoch: 23, Steps: 34 | Train Loss: 1.061 Vali Loss: 8.440 Vali Acc: 0.751 Test Loss: 8.440 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 19.894826889038086
Epoch: 24, Steps: 34 | Train Loss: 2.778 Vali Loss: 34.403 Vali Acc: 0.607 Test Loss: 34.403 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 20.699105262756348
Epoch: 25, Steps: 34 | Train Loss: 4.713 Vali Loss: 8.333 Vali Acc: 0.763 Test Loss: 8.333 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 19.631435871124268
Epoch: 26, Steps: 34 | Train Loss: 1.308 Vali Loss: 16.539 Vali Acc: 0.671 Test Loss: 16.539 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 21.132623195648193
Epoch: 27, Steps: 34 | Train Loss: 3.580 Vali Loss: 21.707 Vali Acc: 0.676 Test Loss: 21.707 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 20.016201734542847
Epoch: 28, Steps: 34 | Train Loss: 0.585 Vali Loss: 9.087 Vali Acc: 0.792 Test Loss: 9.087 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.47639274597168
Epoch: 29, Steps: 34 | Train Loss: 1.446 Vali Loss: 21.307 Vali Acc: 0.671 Test Loss: 21.307 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 22.905014991760254
Epoch: 30, Steps: 34 | Train Loss: 1.215 Vali Loss: 9.832 Vali Acc: 0.769 Test Loss: 9.832 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 21.36521053314209
Epoch: 31, Steps: 34 | Train Loss: 2.461 Vali Loss: 17.389 Vali Acc: 0.636 Test Loss: 17.389 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 21.525949478149414
Epoch: 32, Steps: 34 | Train Loss: 6.432 Vali Loss: 27.310 Vali Acc: 0.451 Test Loss: 27.310 Test Acc: 0.451
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 19236919
model size : 78.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.503909587860107
Epoch: 1, Steps: 34 | Train Loss: 8.883 Vali Loss: 32.609 Vali Acc: 0.225 Test Loss: 32.609 Test Acc: 0.225
Validation loss decreased (inf --> -0.225107).  Saving model ...
Epoch: 2 cost time: 20.16156244277954
Epoch: 2, Steps: 34 | Train Loss: 20.719 Vali Loss: 26.279 Vali Acc: 0.422 Test Loss: 26.279 Test Acc: 0.422
Validation loss decreased (-0.225107 --> -0.421703).  Saving model ...
Epoch: 3 cost time: 17.605684518814087
Epoch: 3, Steps: 34 | Train Loss: 20.759 Vali Loss: 46.911 Vali Acc: 0.277 Test Loss: 46.911 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.827895641326904
Epoch: 4, Steps: 34 | Train Loss: 13.409 Vali Loss: 8.622 Vali Acc: 0.647 Test Loss: 8.622 Test Acc: 0.647
Validation loss decreased (-0.421703 --> -0.647313).  Saving model ...
Epoch: 5 cost time: 19.60757541656494
Epoch: 5, Steps: 34 | Train Loss: 10.146 Vali Loss: 29.419 Vali Acc: 0.503 Test Loss: 29.419 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.57947611808777
Epoch: 6, Steps: 34 | Train Loss: 11.408 Vali Loss: 14.900 Vali Acc: 0.647 Test Loss: 14.900 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.553945064544678
Epoch: 7, Steps: 34 | Train Loss: 12.318 Vali Loss: 17.824 Vali Acc: 0.520 Test Loss: 17.824 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.331781148910522
Epoch: 8, Steps: 34 | Train Loss: 9.246 Vali Loss: 17.704 Vali Acc: 0.699 Test Loss: 17.704 Test Acc: 0.699
Validation loss decreased (-0.647313 --> -0.699245).  Saving model ...
Epoch: 9 cost time: 21.206329584121704
Epoch: 9, Steps: 34 | Train Loss: 8.363 Vali Loss: 19.506 Vali Acc: 0.653 Test Loss: 19.506 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.89557909965515
Epoch: 10, Steps: 34 | Train Loss: 4.355 Vali Loss: 16.527 Vali Acc: 0.723 Test Loss: 16.527 Test Acc: 0.723
Validation loss decreased (-0.699245 --> -0.722378).  Saving model ...
Epoch: 11 cost time: 21.605238914489746
Epoch: 11, Steps: 34 | Train Loss: 4.272 Vali Loss: 20.213 Vali Acc: 0.642 Test Loss: 20.213 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.006052017211914
Epoch: 12, Steps: 34 | Train Loss: 2.277 Vali Loss: 14.133 Vali Acc: 0.728 Test Loss: 14.133 Test Acc: 0.728
Validation loss decreased (-0.722378 --> -0.728182).  Saving model ...
Epoch: 13 cost time: 22.854769945144653
Epoch: 13, Steps: 34 | Train Loss: 2.116 Vali Loss: 24.663 Vali Acc: 0.538 Test Loss: 24.663 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.960280179977417
Epoch: 14, Steps: 34 | Train Loss: 2.978 Vali Loss: 15.067 Vali Acc: 0.763 Test Loss: 15.067 Test Acc: 0.763
Validation loss decreased (-0.728182 --> -0.762855).  Saving model ...
Epoch: 15 cost time: 21.24086284637451
Epoch: 15, Steps: 34 | Train Loss: 1.962 Vali Loss: 16.617 Vali Acc: 0.717 Test Loss: 16.617 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.378222942352295
Epoch: 16, Steps: 34 | Train Loss: 1.886 Vali Loss: 13.579 Vali Acc: 0.763 Test Loss: 13.579 Test Acc: 0.763
Validation loss decreased (-0.762855 --> -0.762870).  Saving model ...
Epoch: 17 cost time: 20.752813577651978
Epoch: 17, Steps: 34 | Train Loss: 2.017 Vali Loss: 12.832 Vali Acc: 0.769 Test Loss: 12.832 Test Acc: 0.769
Validation loss decreased (-0.762870 --> -0.768658).  Saving model ...
Epoch: 18 cost time: 21.2979633808136
Epoch: 18, Steps: 34 | Train Loss: 3.555 Vali Loss: 22.930 Vali Acc: 0.694 Test Loss: 22.930 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.007739543914795
Epoch: 19, Steps: 34 | Train Loss: 3.120 Vali Loss: 21.293 Vali Acc: 0.717 Test Loss: 21.293 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 20.450673818588257
Epoch: 20, Steps: 34 | Train Loss: 1.120 Vali Loss: 22.230 Vali Acc: 0.717 Test Loss: 22.230 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.984081029891968
Epoch: 21, Steps: 34 | Train Loss: 4.388 Vali Loss: 15.275 Vali Acc: 0.792 Test Loss: 15.275 Test Acc: 0.792
Validation loss decreased (-0.768658 --> -0.791755).  Saving model ...
Epoch: 22 cost time: 20.25238800048828
Epoch: 22, Steps: 34 | Train Loss: 3.847 Vali Loss: 16.350 Vali Acc: 0.746 Test Loss: 16.350 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.783954620361328
Epoch: 23, Steps: 34 | Train Loss: 0.618 Vali Loss: 13.455 Vali Acc: 0.746 Test Loss: 13.455 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.374406814575195
Epoch: 24, Steps: 34 | Train Loss: 4.298 Vali Loss: 35.084 Vali Acc: 0.671 Test Loss: 35.084 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.6053786277771
Epoch: 25, Steps: 34 | Train Loss: 4.392 Vali Loss: 23.278 Vali Acc: 0.549 Test Loss: 23.278 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 21.5047390460968
Epoch: 26, Steps: 34 | Train Loss: 11.580 Vali Loss: 31.815 Vali Acc: 0.503 Test Loss: 31.815 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 22.73246479034424
Epoch: 27, Steps: 34 | Train Loss: 22.789 Vali Loss: 13.959 Vali Acc: 0.699 Test Loss: 13.959 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 21.052392721176147
Epoch: 28, Steps: 34 | Train Loss: 26.389 Vali Loss: 22.204 Vali Acc: 0.191 Test Loss: 22.204 Test Acc: 0.191
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 22.89165234565735
Epoch: 29, Steps: 34 | Train Loss: 32.138 Vali Loss: 25.144 Vali Acc: 0.116 Test Loss: 25.144 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 21.651047945022583
Epoch: 30, Steps: 34 | Train Loss: 28.148 Vali Loss: 34.660 Vali Acc: 0.150 Test Loss: 34.660 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 21.958882570266724
Epoch: 31, Steps: 34 | Train Loss: 19.138 Vali Loss: 24.122 Vali Acc: 0.150 Test Loss: 24.122 Test Acc: 0.150
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 19231543
model size : 78.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 26.458436012268066
Epoch: 1, Steps: 34 | Train Loss: 11.004 Vali Loss: 14.934 Vali Acc: 0.283 Test Loss: 14.934 Test Acc: 0.283
Validation loss decreased (inf --> -0.283088).  Saving model ...
Epoch: 2 cost time: 25.10231637954712
Epoch: 2, Steps: 34 | Train Loss: 21.232 Vali Loss: 32.745 Vali Acc: 0.353 Test Loss: 32.745 Test Acc: 0.353
Validation loss decreased (-0.283088 --> -0.352274).  Saving model ...
Epoch: 3 cost time: 20.458462715148926
Epoch: 3, Steps: 34 | Train Loss: 18.154 Vali Loss: 13.157 Vali Acc: 0.555 Test Loss: 13.157 Test Acc: 0.555
Validation loss decreased (-0.352274 --> -0.554782).  Saving model ...
Epoch: 4 cost time: 20.38244605064392
Epoch: 4, Steps: 34 | Train Loss: 13.096 Vali Loss: 23.442 Vali Acc: 0.538 Test Loss: 23.442 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.59618330001831
Epoch: 5, Steps: 34 | Train Loss: 19.343 Vali Loss: 13.132 Vali Acc: 0.659 Test Loss: 13.132 Test Acc: 0.659
Validation loss decreased (-0.554782 --> -0.658828).  Saving model ...
Epoch: 6 cost time: 21.675512552261353
Epoch: 6, Steps: 34 | Train Loss: 8.011 Vali Loss: 23.475 Vali Acc: 0.566 Test Loss: 23.475 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.574437379837036
Epoch: 7, Steps: 34 | Train Loss: 9.952 Vali Loss: 13.481 Vali Acc: 0.613 Test Loss: 13.481 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.818905353546143
Epoch: 8, Steps: 34 | Train Loss: 6.886 Vali Loss: 18.578 Vali Acc: 0.613 Test Loss: 18.578 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.681535482406616
Epoch: 9, Steps: 34 | Train Loss: 5.687 Vali Loss: 27.414 Vali Acc: 0.624 Test Loss: 27.414 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.2356379032135
Epoch: 10, Steps: 34 | Train Loss: 5.638 Vali Loss: 22.977 Vali Acc: 0.590 Test Loss: 22.977 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.570887327194214
Epoch: 11, Steps: 34 | Train Loss: 4.887 Vali Loss: 14.823 Vali Acc: 0.734 Test Loss: 14.823 Test Acc: 0.734
Validation loss decreased (-0.658828 --> -0.733956).  Saving model ...
Epoch: 12 cost time: 21.14579749107361
Epoch: 12, Steps: 34 | Train Loss: 2.181 Vali Loss: 18.753 Vali Acc: 0.723 Test Loss: 18.753 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.136399745941162
Epoch: 13, Steps: 34 | Train Loss: 4.144 Vali Loss: 8.753 Vali Acc: 0.740 Test Loss: 8.753 Test Acc: 0.740
Validation loss decreased (-0.733956 --> -0.739797).  Saving model ...
Epoch: 14 cost time: 25.445314407348633
Epoch: 14, Steps: 34 | Train Loss: 1.521 Vali Loss: 8.280 Vali Acc: 0.757 Test Loss: 8.280 Test Acc: 0.757
Validation loss decreased (-0.739797 --> -0.757143).  Saving model ...
Epoch: 15 cost time: 23.445730686187744
Epoch: 15, Steps: 34 | Train Loss: 3.336 Vali Loss: 20.463 Vali Acc: 0.676 Test Loss: 20.463 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.238406658172607
Epoch: 16, Steps: 34 | Train Loss: 3.020 Vali Loss: 11.828 Vali Acc: 0.775 Test Loss: 11.828 Test Acc: 0.775
Validation loss decreased (-0.757143 --> -0.774448).  Saving model ...
Epoch: 17 cost time: 22.371121406555176
Epoch: 17, Steps: 34 | Train Loss: 3.600 Vali Loss: 14.689 Vali Acc: 0.792 Test Loss: 14.689 Test Acc: 0.792
Validation loss decreased (-0.774448 --> -0.791761).  Saving model ...
Epoch: 18 cost time: 25.000056505203247
Epoch: 18, Steps: 34 | Train Loss: 1.289 Vali Loss: 16.346 Vali Acc: 0.780 Test Loss: 16.346 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.25954556465149
Epoch: 19, Steps: 34 | Train Loss: 1.319 Vali Loss: 11.908 Vali Acc: 0.763 Test Loss: 11.908 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.576170682907104
Epoch: 20, Steps: 34 | Train Loss: 2.660 Vali Loss: 21.234 Vali Acc: 0.688 Test Loss: 21.234 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 25.045621633529663
Epoch: 21, Steps: 34 | Train Loss: 4.155 Vali Loss: 22.426 Vali Acc: 0.717 Test Loss: 22.426 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 25.205812215805054
Epoch: 22, Steps: 34 | Train Loss: 2.563 Vali Loss: 21.400 Vali Acc: 0.746 Test Loss: 21.400 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 25.215027570724487
Epoch: 23, Steps: 34 | Train Loss: 2.421 Vali Loss: 25.615 Vali Acc: 0.659 Test Loss: 25.615 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 24.303861141204834
Epoch: 24, Steps: 34 | Train Loss: 5.540 Vali Loss: 18.594 Vali Acc: 0.740 Test Loss: 18.594 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 24.488220691680908
Epoch: 25, Steps: 34 | Train Loss: 7.946 Vali Loss: 73.118 Vali Acc: 0.277 Test Loss: 73.118 Test Acc: 0.277
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 23.268609762191772
Epoch: 26, Steps: 34 | Train Loss: 23.729 Vali Loss: 41.258 Vali Acc: 0.145 Test Loss: 41.258 Test Acc: 0.145
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 23.028374671936035
Epoch: 27, Steps: 34 | Train Loss: 36.956 Vali Loss: 23.528 Vali Acc: 0.133 Test Loss: 23.528 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 19226167
model size : 78.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.1015522480011
Epoch: 1, Steps: 34 | Train Loss: 9.039 Vali Loss: 20.277 Vali Acc: 0.353 Test Loss: 20.277 Test Acc: 0.353
Validation loss decreased (inf --> -0.352398).  Saving model ...
Epoch: 2 cost time: 21.188068151474
Epoch: 2, Steps: 34 | Train Loss: 18.427 Vali Loss: 19.625 Vali Acc: 0.410 Test Loss: 19.625 Test Acc: 0.410
Validation loss decreased (-0.352398 --> -0.410208).  Saving model ...
Epoch: 3 cost time: 21.75039315223694
Epoch: 3, Steps: 34 | Train Loss: 23.345 Vali Loss: 32.602 Vali Acc: 0.445 Test Loss: 32.602 Test Acc: 0.445
Validation loss decreased (-0.410208 --> -0.444761).  Saving model ...
Epoch: 4 cost time: 20.563023567199707
Epoch: 4, Steps: 34 | Train Loss: 18.187 Vali Loss: 23.944 Vali Acc: 0.474 Test Loss: 23.944 Test Acc: 0.474
Validation loss decreased (-0.444761 --> -0.473749).  Saving model ...
Epoch: 5 cost time: 21.30040669441223
Epoch: 5, Steps: 34 | Train Loss: 23.193 Vali Loss: 37.607 Vali Acc: 0.480 Test Loss: 37.607 Test Acc: 0.480
Validation loss decreased (-0.473749 --> -0.479393).  Saving model ...
Epoch: 6 cost time: 21.64252543449402
Epoch: 6, Steps: 34 | Train Loss: 14.877 Vali Loss: 15.391 Vali Acc: 0.566 Test Loss: 15.391 Test Acc: 0.566
Validation loss decreased (-0.479393 --> -0.566320).  Saving model ...
Epoch: 7 cost time: 21.010844945907593
Epoch: 7, Steps: 34 | Train Loss: 6.185 Vali Loss: 19.267 Vali Acc: 0.607 Test Loss: 19.267 Test Acc: 0.607
Validation loss decreased (-0.566320 --> -0.606744).  Saving model ...
Epoch: 8 cost time: 19.330641508102417
Epoch: 8, Steps: 34 | Train Loss: 9.734 Vali Loss: 14.586 Vali Acc: 0.665 Test Loss: 14.586 Test Acc: 0.665
Validation loss decreased (-0.606744 --> -0.664594).  Saving model ...
Epoch: 9 cost time: 21.594958543777466
Epoch: 9, Steps: 34 | Train Loss: 5.516 Vali Loss: 9.108 Vali Acc: 0.746 Test Loss: 9.108 Test Acc: 0.746
Validation loss decreased (-0.664594 --> -0.745574).  Saving model ...
Epoch: 10 cost time: 21.51762080192566
Epoch: 10, Steps: 34 | Train Loss: 3.280 Vali Loss: 27.956 Vali Acc: 0.520 Test Loss: 27.956 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.948885440826416
Epoch: 11, Steps: 34 | Train Loss: 5.007 Vali Loss: 15.591 Vali Acc: 0.653 Test Loss: 15.591 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.057297945022583
Epoch: 12, Steps: 34 | Train Loss: 1.921 Vali Loss: 9.727 Vali Acc: 0.769 Test Loss: 9.727 Test Acc: 0.769
Validation loss decreased (-0.745574 --> -0.768689).  Saving model ...
Epoch: 13 cost time: 22.61052393913269
Epoch: 13, Steps: 34 | Train Loss: 2.842 Vali Loss: 16.840 Vali Acc: 0.607 Test Loss: 16.840 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.045865058898926
Epoch: 14, Steps: 34 | Train Loss: 2.172 Vali Loss: 8.940 Vali Acc: 0.827 Test Loss: 8.940 Test Acc: 0.827
Validation loss decreased (-0.768689 --> -0.826500).  Saving model ...
Epoch: 15 cost time: 22.060423612594604
Epoch: 15, Steps: 34 | Train Loss: 2.866 Vali Loss: 6.997 Vali Acc: 0.751 Test Loss: 6.997 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.833100080490112
Epoch: 16, Steps: 34 | Train Loss: 1.618 Vali Loss: 43.196 Vali Acc: 0.532 Test Loss: 43.196 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.710017681121826
Epoch: 17, Steps: 34 | Train Loss: 2.858 Vali Loss: 21.050 Vali Acc: 0.699 Test Loss: 21.050 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 20.766873836517334
Epoch: 18, Steps: 34 | Train Loss: 4.158 Vali Loss: 10.793 Vali Acc: 0.769 Test Loss: 10.793 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.79382038116455
Epoch: 19, Steps: 34 | Train Loss: 1.357 Vali Loss: 13.302 Vali Acc: 0.763 Test Loss: 13.302 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 20.008354425430298
Epoch: 20, Steps: 34 | Train Loss: 0.899 Vali Loss: 17.330 Vali Acc: 0.775 Test Loss: 17.330 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 20.836796045303345
Epoch: 21, Steps: 34 | Train Loss: 2.144 Vali Loss: 13.729 Vali Acc: 0.780 Test Loss: 13.729 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 20.929004192352295
Epoch: 22, Steps: 34 | Train Loss: 1.637 Vali Loss: 31.363 Vali Acc: 0.590 Test Loss: 31.363 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 22.42415690422058
Epoch: 23, Steps: 34 | Train Loss: 4.352 Vali Loss: 13.500 Vali Acc: 0.751 Test Loss: 13.500 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.582825183868408
Epoch: 24, Steps: 34 | Train Loss: 3.863 Vali Loss: 31.114 Vali Acc: 0.601 Test Loss: 31.114 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 17403703
model size : 71.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.606361865997314
Epoch: 1, Steps: 34 | Train Loss: 10.199 Vali Loss: 12.821 Vali Acc: 0.150 Test Loss: 12.821 Test Acc: 0.150
Validation loss decreased (inf --> -0.150161).  Saving model ...
Epoch: 2 cost time: 22.310224056243896
Epoch: 2, Steps: 34 | Train Loss: 16.881 Vali Loss: 43.843 Vali Acc: 0.329 Test Loss: 43.843 Test Acc: 0.329
Validation loss decreased (-0.150161 --> -0.329041).  Saving model ...
Epoch: 3 cost time: 21.945265531539917
Epoch: 3, Steps: 34 | Train Loss: 24.127 Vali Loss: 12.445 Vali Acc: 0.561 Test Loss: 12.445 Test Acc: 0.561
Validation loss decreased (-0.329041 --> -0.560569).  Saving model ...
Epoch: 4 cost time: 20.34022855758667
Epoch: 4, Steps: 34 | Train Loss: 13.381 Vali Loss: 12.625 Vali Acc: 0.613 Test Loss: 12.625 Test Acc: 0.613
Validation loss decreased (-0.560569 --> -0.612591).  Saving model ...
Epoch: 5 cost time: 22.0124089717865
Epoch: 5, Steps: 34 | Train Loss: 12.799 Vali Loss: 21.203 Vali Acc: 0.607 Test Loss: 21.203 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.91791033744812
Epoch: 6, Steps: 34 | Train Loss: 12.786 Vali Loss: 19.335 Vali Acc: 0.601 Test Loss: 19.335 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.079740047454834
Epoch: 7, Steps: 34 | Train Loss: 11.838 Vali Loss: 12.164 Vali Acc: 0.665 Test Loss: 12.164 Test Acc: 0.665
Validation loss decreased (-0.612591 --> -0.664618).  Saving model ...
Epoch: 8 cost time: 20.862945795059204
Epoch: 8, Steps: 34 | Train Loss: 6.230 Vali Loss: 12.818 Vali Acc: 0.671 Test Loss: 12.818 Test Acc: 0.671
Validation loss decreased (-0.664618 --> -0.670392).  Saving model ...
Epoch: 9 cost time: 18.94796085357666
Epoch: 9, Steps: 34 | Train Loss: 4.478 Vali Loss: 11.299 Vali Acc: 0.717 Test Loss: 11.299 Test Acc: 0.717
Validation loss decreased (-0.670392 --> -0.716650).  Saving model ...
Epoch: 10 cost time: 22.492127895355225
Epoch: 10, Steps: 34 | Train Loss: 6.367 Vali Loss: 18.263 Vali Acc: 0.601 Test Loss: 18.263 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.44467329978943
Epoch: 11, Steps: 34 | Train Loss: 3.192 Vali Loss: 11.453 Vali Acc: 0.740 Test Loss: 11.453 Test Acc: 0.740
Validation loss decreased (-0.716650 --> -0.739770).  Saving model ...
Epoch: 12 cost time: 20.584383249282837
Epoch: 12, Steps: 34 | Train Loss: 4.025 Vali Loss: 9.119 Vali Acc: 0.740 Test Loss: 9.119 Test Acc: 0.740
Validation loss decreased (-0.739770 --> -0.739793).  Saving model ...
Epoch: 13 cost time: 21.48704695701599
Epoch: 13, Steps: 34 | Train Loss: 2.854 Vali Loss: 14.835 Vali Acc: 0.676 Test Loss: 14.835 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.34427833557129
Epoch: 14, Steps: 34 | Train Loss: 4.629 Vali Loss: 19.865 Vali Acc: 0.665 Test Loss: 19.865 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.463223934173584
Epoch: 15, Steps: 34 | Train Loss: 1.385 Vali Loss: 36.212 Vali Acc: 0.618 Test Loss: 36.212 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.06273865699768
Epoch: 16, Steps: 34 | Train Loss: 3.775 Vali Loss: 13.083 Vali Acc: 0.717 Test Loss: 13.083 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 24.475837230682373
Epoch: 17, Steps: 34 | Train Loss: 3.043 Vali Loss: 17.109 Vali Acc: 0.717 Test Loss: 17.109 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 21.22967553138733
Epoch: 18, Steps: 34 | Train Loss: 2.315 Vali Loss: 21.198 Vali Acc: 0.694 Test Loss: 21.198 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 25.05130410194397
Epoch: 19, Steps: 34 | Train Loss: 5.008 Vali Loss: 11.798 Vali Acc: 0.775 Test Loss: 11.798 Test Acc: 0.775
Validation loss decreased (-0.739793 --> -0.774448).  Saving model ...
Epoch: 20 cost time: 25.22303056716919
Epoch: 20, Steps: 34 | Train Loss: 3.696 Vali Loss: 21.836 Vali Acc: 0.653 Test Loss: 21.836 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.061007261276245
Epoch: 21, Steps: 34 | Train Loss: 2.889 Vali Loss: 17.673 Vali Acc: 0.723 Test Loss: 17.673 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.8603413105011
Epoch: 22, Steps: 34 | Train Loss: 1.581 Vali Loss: 14.498 Vali Acc: 0.746 Test Loss: 14.498 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 18.640414476394653
Epoch: 23, Steps: 34 | Train Loss: 2.210 Vali Loss: 26.736 Vali Acc: 0.572 Test Loss: 26.736 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 19.472973108291626
Epoch: 24, Steps: 34 | Train Loss: 1.885 Vali Loss: 15.756 Vali Acc: 0.798 Test Loss: 15.756 Test Acc: 0.798
Validation loss decreased (-0.774448 --> -0.797530).  Saving model ...
Epoch: 25 cost time: 17.992772817611694
Epoch: 25, Steps: 34 | Train Loss: 0.621 Vali Loss: 27.479 Vali Acc: 0.601 Test Loss: 27.479 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 20.936676263809204
Epoch: 26, Steps: 34 | Train Loss: 2.172 Vali Loss: 35.136 Vali Acc: 0.613 Test Loss: 35.136 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 19.311790227890015
Epoch: 27, Steps: 34 | Train Loss: 2.384 Vali Loss: 12.580 Vali Acc: 0.792 Test Loss: 12.580 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 19.1617374420166
Epoch: 28, Steps: 34 | Train Loss: 1.974 Vali Loss: 13.420 Vali Acc: 0.751 Test Loss: 13.420 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 18.363497972488403
Epoch: 29, Steps: 34 | Train Loss: 1.877 Vali Loss: 17.710 Vali Acc: 0.763 Test Loss: 17.710 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 22.091686248779297
Epoch: 30, Steps: 34 | Train Loss: 2.188 Vali Loss: 31.160 Vali Acc: 0.665 Test Loss: 31.160 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 21.95605707168579
Epoch: 31, Steps: 34 | Train Loss: 4.595 Vali Loss: 27.705 Vali Acc: 0.647 Test Loss: 27.705 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 20.440602779388428
Epoch: 32, Steps: 34 | Train Loss: 2.115 Vali Loss: 32.688 Vali Acc: 0.532 Test Loss: 32.688 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 20.69796085357666
Epoch: 33, Steps: 34 | Train Loss: 5.144 Vali Loss: 21.437 Vali Acc: 0.769 Test Loss: 21.437 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 21.44873070716858
Epoch: 34, Steps: 34 | Train Loss: 13.617 Vali Loss: 62.884 Vali Acc: 0.364 Test Loss: 62.884 Test Acc: 0.364
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 17398327
model size : 71.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.584250926971436
Epoch: 1, Steps: 34 | Train Loss: 9.995 Vali Loss: 11.077 Vali Acc: 0.225 Test Loss: 11.077 Test Acc: 0.225
Validation loss decreased (inf --> -0.225323).  Saving model ...
Epoch: 2 cost time: 22.708988904953003
Epoch: 2, Steps: 34 | Train Loss: 14.985 Vali Loss: 17.168 Vali Acc: 0.428 Test Loss: 17.168 Test Acc: 0.428
Validation loss decreased (-0.225323 --> -0.427574).  Saving model ...
Epoch: 3 cost time: 18.948757886886597
Epoch: 3, Steps: 34 | Train Loss: 21.258 Vali Loss: 61.331 Vali Acc: 0.457 Test Loss: 61.331 Test Acc: 0.457
Validation loss decreased (-0.427574 --> -0.456034).  Saving model ...
Epoch: 4 cost time: 22.354196786880493
Epoch: 4, Steps: 34 | Train Loss: 22.789 Vali Loss: 20.220 Vali Acc: 0.480 Test Loss: 20.220 Test Acc: 0.480
Validation loss decreased (-0.456034 --> -0.479567).  Saving model ...
Epoch: 5 cost time: 20.547613859176636
Epoch: 5, Steps: 34 | Train Loss: 10.331 Vali Loss: 13.393 Vali Acc: 0.624 Test Loss: 13.393 Test Acc: 0.624
Validation loss decreased (-0.479567 --> -0.624144).  Saving model ...
Epoch: 6 cost time: 22.910402536392212
Epoch: 6, Steps: 34 | Train Loss: 8.263 Vali Loss: 10.374 Vali Acc: 0.699 Test Loss: 10.374 Test Acc: 0.699
Validation loss decreased (-0.624144 --> -0.699318).  Saving model ...
Epoch: 7 cost time: 21.80333662033081
Epoch: 7, Steps: 34 | Train Loss: 6.555 Vali Loss: 9.057 Vali Acc: 0.682 Test Loss: 9.057 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.64943814277649
Epoch: 8, Steps: 34 | Train Loss: 5.488 Vali Loss: 11.804 Vali Acc: 0.699 Test Loss: 11.804 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.8079891204834
Epoch: 9, Steps: 34 | Train Loss: 3.348 Vali Loss: 5.586 Vali Acc: 0.734 Test Loss: 5.586 Test Acc: 0.734
Validation loss decreased (-0.699318 --> -0.734048).  Saving model ...
Epoch: 10 cost time: 21.77509903907776
Epoch: 10, Steps: 34 | Train Loss: 1.940 Vali Loss: 11.675 Vali Acc: 0.728 Test Loss: 11.675 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.626596689224243
Epoch: 11, Steps: 34 | Train Loss: 5.140 Vali Loss: 33.289 Vali Acc: 0.630 Test Loss: 33.289 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.394065856933594
Epoch: 12, Steps: 34 | Train Loss: 4.182 Vali Loss: 15.218 Vali Acc: 0.734 Test Loss: 15.218 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.07801651954651
Epoch: 13, Steps: 34 | Train Loss: 2.643 Vali Loss: 12.572 Vali Acc: 0.740 Test Loss: 12.572 Test Acc: 0.740
Validation loss decreased (-0.734048 --> -0.739759).  Saving model ...
Epoch: 14 cost time: 21.616315603256226
Epoch: 14, Steps: 34 | Train Loss: 2.984 Vali Loss: 7.796 Vali Acc: 0.803 Test Loss: 7.796 Test Acc: 0.803
Validation loss decreased (-0.739759 --> -0.803390).  Saving model ...
Epoch: 15 cost time: 20.843260049819946
Epoch: 15, Steps: 34 | Train Loss: 1.266 Vali Loss: 23.312 Vali Acc: 0.642 Test Loss: 23.312 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.547367095947266
Epoch: 16, Steps: 34 | Train Loss: 1.206 Vali Loss: 34.377 Vali Acc: 0.624 Test Loss: 34.377 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.177989959716797
Epoch: 17, Steps: 34 | Train Loss: 1.981 Vali Loss: 13.777 Vali Acc: 0.757 Test Loss: 13.777 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 21.718876600265503
Epoch: 18, Steps: 34 | Train Loss: 0.630 Vali Loss: 14.781 Vali Acc: 0.676 Test Loss: 14.781 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 22.62671661376953
Epoch: 19, Steps: 34 | Train Loss: 2.055 Vali Loss: 11.946 Vali Acc: 0.803 Test Loss: 11.946 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 20.114596843719482
Epoch: 20, Steps: 34 | Train Loss: 1.824 Vali Loss: 9.579 Vali Acc: 0.803 Test Loss: 9.579 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 22.861816883087158
Epoch: 21, Steps: 34 | Train Loss: 2.565 Vali Loss: 14.020 Vali Acc: 0.786 Test Loss: 14.020 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 20.53890347480774
Epoch: 22, Steps: 34 | Train Loss: 2.080 Vali Loss: 11.309 Vali Acc: 0.769 Test Loss: 11.309 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 20.198686838150024
Epoch: 23, Steps: 34 | Train Loss: 2.506 Vali Loss: 19.706 Vali Acc: 0.717 Test Loss: 19.706 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 20.827720403671265
Epoch: 24, Steps: 34 | Train Loss: 2.023 Vali Loss: 32.017 Vali Acc: 0.584 Test Loss: 32.017 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 17392951
model size : 71.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.54715847969055
Epoch: 1, Steps: 34 | Train Loss: 9.662 Vali Loss: 19.940 Vali Acc: 0.370 Test Loss: 19.940 Test Acc: 0.370
Validation loss decreased (inf --> -0.369743).  Saving model ...
Epoch: 2 cost time: 22.047189235687256
Epoch: 2, Steps: 34 | Train Loss: 18.061 Vali Loss: 28.248 Vali Acc: 0.225 Test Loss: 28.248 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.814112663269043
Epoch: 3, Steps: 34 | Train Loss: 23.015 Vali Loss: 38.767 Vali Acc: 0.399 Test Loss: 38.767 Test Acc: 0.399
Validation loss decreased (-0.369743 --> -0.398456).  Saving model ...
Epoch: 4 cost time: 22.158592700958252
Epoch: 4, Steps: 34 | Train Loss: 22.400 Vali Loss: 33.370 Vali Acc: 0.434 Test Loss: 33.370 Test Acc: 0.434
Validation loss decreased (-0.398456 --> -0.433192).  Saving model ...
Epoch: 5 cost time: 21.37465810775757
Epoch: 5, Steps: 34 | Train Loss: 11.587 Vali Loss: 17.568 Vali Acc: 0.503 Test Loss: 17.568 Test Acc: 0.503
Validation loss decreased (-0.433192 --> -0.502714).  Saving model ...
Epoch: 6 cost time: 22.884962797164917
Epoch: 6, Steps: 34 | Train Loss: 13.170 Vali Loss: 10.689 Vali Acc: 0.717 Test Loss: 10.689 Test Acc: 0.717
Validation loss decreased (-0.502714 --> -0.716656).  Saving model ...
Epoch: 7 cost time: 23.829193592071533
Epoch: 7, Steps: 34 | Train Loss: 9.917 Vali Loss: 31.588 Vali Acc: 0.509 Test Loss: 31.588 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.411673069000244
Epoch: 8, Steps: 34 | Train Loss: 6.199 Vali Loss: 23.210 Vali Acc: 0.647 Test Loss: 23.210 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.50337815284729
Epoch: 9, Steps: 34 | Train Loss: 5.616 Vali Loss: 24.159 Vali Acc: 0.601 Test Loss: 24.159 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.063472032546997
Epoch: 10, Steps: 34 | Train Loss: 8.171 Vali Loss: 5.253 Vali Acc: 0.815 Test Loss: 5.253 Test Acc: 0.815
Validation loss decreased (-0.716656 --> -0.814976).  Saving model ...
Epoch: 11 cost time: 21.89935803413391
Epoch: 11, Steps: 34 | Train Loss: 5.993 Vali Loss: 23.931 Vali Acc: 0.734 Test Loss: 23.931 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.768696308135986
Epoch: 12, Steps: 34 | Train Loss: 3.301 Vali Loss: 12.016 Vali Acc: 0.746 Test Loss: 12.016 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.857372760772705
Epoch: 13, Steps: 34 | Train Loss: 2.772 Vali Loss: 20.626 Vali Acc: 0.705 Test Loss: 20.626 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 21.98723077774048
Epoch: 14, Steps: 34 | Train Loss: 1.363 Vali Loss: 7.093 Vali Acc: 0.832 Test Loss: 7.093 Test Acc: 0.832
Validation loss decreased (-0.814976 --> -0.832299).  Saving model ...
Epoch: 15 cost time: 20.218045711517334
Epoch: 15, Steps: 34 | Train Loss: 2.781 Vali Loss: 9.758 Vali Acc: 0.769 Test Loss: 9.758 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.49514937400818
Epoch: 16, Steps: 34 | Train Loss: 1.397 Vali Loss: 16.522 Vali Acc: 0.751 Test Loss: 16.522 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.831414461135864
Epoch: 17, Steps: 34 | Train Loss: 1.339 Vali Loss: 23.997 Vali Acc: 0.699 Test Loss: 23.997 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.228904724121094
Epoch: 18, Steps: 34 | Train Loss: 1.654 Vali Loss: 20.970 Vali Acc: 0.775 Test Loss: 20.970 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 22.019753456115723
Epoch: 19, Steps: 34 | Train Loss: 3.623 Vali Loss: 7.866 Vali Acc: 0.827 Test Loss: 7.866 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 22.898258447647095
Epoch: 20, Steps: 34 | Train Loss: 1.412 Vali Loss: 37.509 Vali Acc: 0.653 Test Loss: 37.509 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 22.218278408050537
Epoch: 21, Steps: 34 | Train Loss: 9.143 Vali Loss: 13.588 Vali Acc: 0.775 Test Loss: 13.588 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.341795921325684
Epoch: 22, Steps: 34 | Train Loss: 3.041 Vali Loss: 25.774 Vali Acc: 0.688 Test Loss: 25.774 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 20.380930185317993
Epoch: 23, Steps: 34 | Train Loss: 3.874 Vali Loss: 29.761 Vali Acc: 0.538 Test Loss: 29.761 Test Acc: 0.538
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 22.219704389572144
Epoch: 24, Steps: 34 | Train Loss: 2.275 Vali Loss: 38.414 Vali Acc: 0.682 Test Loss: 38.414 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 17387575
model size : 71.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.139081954956055
Epoch: 1, Steps: 34 | Train Loss: 13.389 Vali Loss: 13.431 Vali Acc: 0.260 Test Loss: 13.431 Test Acc: 0.260
Validation loss decreased (inf --> -0.259981).  Saving model ...
Epoch: 2 cost time: 21.61890482902527
Epoch: 2, Steps: 34 | Train Loss: 14.673 Vali Loss: 37.452 Vali Acc: 0.318 Test Loss: 37.452 Test Acc: 0.318
Validation loss decreased (-0.259981 --> -0.317545).  Saving model ...
Epoch: 3 cost time: 22.022813320159912
Epoch: 3, Steps: 34 | Train Loss: 21.838 Vali Loss: 22.312 Vali Acc: 0.428 Test Loss: 22.312 Test Acc: 0.428
Validation loss decreased (-0.317545 --> -0.427523).  Saving model ...
Epoch: 4 cost time: 19.99180269241333
Epoch: 4, Steps: 34 | Train Loss: 24.821 Vali Loss: 20.276 Vali Acc: 0.572 Test Loss: 20.276 Test Acc: 0.572
Validation loss decreased (-0.427523 --> -0.572052).  Saving model ...
Epoch: 5 cost time: 19.01001787185669
Epoch: 5, Steps: 34 | Train Loss: 11.412 Vali Loss: 17.073 Vali Acc: 0.514 Test Loss: 17.073 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.55857276916504
Epoch: 6, Steps: 34 | Train Loss: 6.177 Vali Loss: 12.846 Vali Acc: 0.671 Test Loss: 12.846 Test Acc: 0.671
Validation loss decreased (-0.572052 --> -0.670392).  Saving model ...
Epoch: 7 cost time: 22.20349621772766
Epoch: 7, Steps: 34 | Train Loss: 6.282 Vali Loss: 13.569 Vali Acc: 0.601 Test Loss: 13.569 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.445207595825195
Epoch: 8, Steps: 34 | Train Loss: 4.530 Vali Loss: 11.931 Vali Acc: 0.636 Test Loss: 11.931 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.252041578292847
Epoch: 9, Steps: 34 | Train Loss: 4.358 Vali Loss: 12.111 Vali Acc: 0.630 Test Loss: 12.111 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.13982367515564
Epoch: 10, Steps: 34 | Train Loss: 3.600 Vali Loss: 20.941 Vali Acc: 0.694 Test Loss: 20.941 Test Acc: 0.694
Validation loss decreased (-0.670392 --> -0.693432).  Saving model ...
Epoch: 11 cost time: 21.0892333984375
Epoch: 11, Steps: 34 | Train Loss: 2.604 Vali Loss: 14.263 Vali Acc: 0.647 Test Loss: 14.263 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.744297981262207
Epoch: 12, Steps: 34 | Train Loss: 3.609 Vali Loss: 13.560 Vali Acc: 0.728 Test Loss: 13.560 Test Acc: 0.728
Validation loss decreased (-0.693432 --> -0.728188).  Saving model ...
Epoch: 13 cost time: 22.19636869430542
Epoch: 13, Steps: 34 | Train Loss: 1.968 Vali Loss: 11.093 Vali Acc: 0.786 Test Loss: 11.093 Test Acc: 0.786
Validation loss decreased (-0.728188 --> -0.786016).  Saving model ...
Epoch: 14 cost time: 20.616967916488647
Epoch: 14, Steps: 34 | Train Loss: 2.719 Vali Loss: 9.802 Vali Acc: 0.723 Test Loss: 9.802 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.037816286087036
Epoch: 15, Steps: 34 | Train Loss: 1.124 Vali Loss: 10.499 Vali Acc: 0.734 Test Loss: 10.499 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.475631952285767
Epoch: 16, Steps: 34 | Train Loss: 1.653 Vali Loss: 9.878 Vali Acc: 0.786 Test Loss: 9.878 Test Acc: 0.786
Validation loss decreased (-0.786016 --> -0.786028).  Saving model ...
Epoch: 17 cost time: 21.526281595230103
Epoch: 17, Steps: 34 | Train Loss: 2.301 Vali Loss: 12.237 Vali Acc: 0.751 Test Loss: 12.237 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 20.85873556137085
Epoch: 18, Steps: 34 | Train Loss: 2.391 Vali Loss: 12.706 Vali Acc: 0.676 Test Loss: 12.706 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 21.96012830734253
Epoch: 19, Steps: 34 | Train Loss: 1.881 Vali Loss: 8.402 Vali Acc: 0.832 Test Loss: 8.402 Test Acc: 0.832
Validation loss decreased (-0.786028 --> -0.832286).  Saving model ...
Epoch: 20 cost time: 22.06825876235962
Epoch: 20, Steps: 34 | Train Loss: 1.317 Vali Loss: 14.363 Vali Acc: 0.723 Test Loss: 14.363 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.669219493865967
Epoch: 21, Steps: 34 | Train Loss: 1.224 Vali Loss: 26.671 Vali Acc: 0.590 Test Loss: 26.671 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 21.960190773010254
Epoch: 22, Steps: 34 | Train Loss: 0.218 Vali Loss: 9.177 Vali Acc: 0.798 Test Loss: 9.177 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 24.73576593399048
Epoch: 23, Steps: 34 | Train Loss: 1.900 Vali Loss: 15.963 Vali Acc: 0.751 Test Loss: 15.963 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 21.992664575576782
Epoch: 24, Steps: 34 | Train Loss: 3.718 Vali Loss: 10.273 Vali Acc: 0.763 Test Loss: 10.273 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 20.548381805419922
Epoch: 25, Steps: 34 | Train Loss: 2.552 Vali Loss: 19.968 Vali Acc: 0.694 Test Loss: 19.968 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 21.61983036994934
Epoch: 26, Steps: 34 | Train Loss: 2.279 Vali Loss: 13.570 Vali Acc: 0.751 Test Loss: 13.570 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 20.75274085998535
Epoch: 27, Steps: 34 | Train Loss: 7.361 Vali Loss: 17.540 Vali Acc: 0.653 Test Loss: 17.540 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.06425166130066
Epoch: 28, Steps: 34 | Train Loss: 8.307 Vali Loss: 23.395 Vali Acc: 0.497 Test Loss: 23.395 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 20.903367519378662
Epoch: 29, Steps: 34 | Train Loss: 18.281 Vali Loss: 34.309 Vali Acc: 0.480 Test Loss: 34.309 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 16484407
model size : 67.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.732696056365967
Epoch: 1, Steps: 34 | Train Loss: 10.326 Vali Loss: 26.766 Vali Acc: 0.295 Test Loss: 26.766 Test Acc: 0.295
Validation loss decreased (inf --> -0.294530).  Saving model ...
Epoch: 2 cost time: 20.57462739944458
Epoch: 2, Steps: 34 | Train Loss: 19.323 Vali Loss: 12.580 Vali Acc: 0.434 Test Loss: 12.580 Test Acc: 0.434
Validation loss decreased (-0.294530 --> -0.433400).  Saving model ...
Epoch: 3 cost time: 21.879246473312378
Epoch: 3, Steps: 34 | Train Loss: 29.804 Vali Loss: 20.421 Vali Acc: 0.491 Test Loss: 20.421 Test Acc: 0.491
Validation loss decreased (-0.433400 --> -0.491125).  Saving model ...
Epoch: 4 cost time: 22.038186073303223
Epoch: 4, Steps: 34 | Train Loss: 21.024 Vali Loss: 16.371 Vali Acc: 0.595 Test Loss: 16.371 Test Acc: 0.595
Validation loss decreased (-0.491125 --> -0.595212).  Saving model ...
Epoch: 5 cost time: 22.314213514328003
Epoch: 5, Steps: 34 | Train Loss: 14.878 Vali Loss: 27.298 Vali Acc: 0.549 Test Loss: 27.298 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.728058338165283
Epoch: 6, Steps: 34 | Train Loss: 14.720 Vali Loss: 6.915 Vali Acc: 0.723 Test Loss: 6.915 Test Acc: 0.723
Validation loss decreased (-0.595212 --> -0.722474).  Saving model ...
Epoch: 7 cost time: 18.019290447235107
Epoch: 7, Steps: 34 | Train Loss: 6.109 Vali Loss: 24.850 Vali Acc: 0.451 Test Loss: 24.850 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.307635068893433
Epoch: 8, Steps: 34 | Train Loss: 3.368 Vali Loss: 19.967 Vali Acc: 0.630 Test Loss: 19.967 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.992047786712646
Epoch: 9, Steps: 34 | Train Loss: 8.353 Vali Loss: 29.632 Vali Acc: 0.549 Test Loss: 29.632 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.521538734436035
Epoch: 10, Steps: 34 | Train Loss: 7.818 Vali Loss: 4.947 Vali Acc: 0.786 Test Loss: 4.947 Test Acc: 0.786
Validation loss decreased (-0.722474 --> -0.786078).  Saving model ...
Epoch: 11 cost time: 21.220787525177002
Epoch: 11, Steps: 34 | Train Loss: 2.773 Vali Loss: 16.898 Vali Acc: 0.723 Test Loss: 16.898 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.112650632858276
Epoch: 12, Steps: 34 | Train Loss: 3.345 Vali Loss: 7.619 Vali Acc: 0.798 Test Loss: 7.619 Test Acc: 0.798
Validation loss decreased (-0.786078 --> -0.797612).  Saving model ...
Epoch: 13 cost time: 20.691413402557373
Epoch: 13, Steps: 34 | Train Loss: 3.869 Vali Loss: 17.045 Vali Acc: 0.659 Test Loss: 17.045 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.213881969451904
Epoch: 14, Steps: 34 | Train Loss: 2.770 Vali Loss: 8.615 Vali Acc: 0.757 Test Loss: 8.615 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.508472681045532
Epoch: 15, Steps: 34 | Train Loss: 2.135 Vali Loss: 26.166 Vali Acc: 0.676 Test Loss: 26.166 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.787861347198486
Epoch: 16, Steps: 34 | Train Loss: 2.194 Vali Loss: 18.209 Vali Acc: 0.734 Test Loss: 18.209 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.665676593780518
Epoch: 17, Steps: 34 | Train Loss: 0.998 Vali Loss: 13.937 Vali Acc: 0.751 Test Loss: 13.937 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 24.277328491210938
Epoch: 18, Steps: 34 | Train Loss: 1.805 Vali Loss: 16.693 Vali Acc: 0.717 Test Loss: 16.693 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.90550470352173
Epoch: 19, Steps: 34 | Train Loss: 1.472 Vali Loss: 16.047 Vali Acc: 0.717 Test Loss: 16.047 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 19.458292722702026
Epoch: 20, Steps: 34 | Train Loss: 2.327 Vali Loss: 12.657 Vali Acc: 0.763 Test Loss: 12.657 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.455852031707764
Epoch: 21, Steps: 34 | Train Loss: 3.018 Vali Loss: 12.269 Vali Acc: 0.757 Test Loss: 12.269 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 20.761013984680176
Epoch: 22, Steps: 34 | Train Loss: 0.179 Vali Loss: 9.524 Vali Acc: 0.803 Test Loss: 9.524 Test Acc: 0.803
Validation loss decreased (-0.797612 --> -0.803373).  Saving model ...
Epoch: 23 cost time: 19.50376796722412
Epoch: 23, Steps: 34 | Train Loss: 2.658 Vali Loss: 11.189 Vali Acc: 0.798 Test Loss: 11.189 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 19.72149109840393
Epoch: 24, Steps: 34 | Train Loss: 1.643 Vali Loss: 36.199 Vali Acc: 0.526 Test Loss: 36.199 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 19.44397258758545
Epoch: 25, Steps: 34 | Train Loss: 4.223 Vali Loss: 11.911 Vali Acc: 0.786 Test Loss: 11.911 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 20.062957525253296
Epoch: 26, Steps: 34 | Train Loss: 1.835 Vali Loss: 16.516 Vali Acc: 0.676 Test Loss: 16.516 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 20.6449716091156
Epoch: 27, Steps: 34 | Train Loss: 2.330 Vali Loss: 41.929 Vali Acc: 0.491 Test Loss: 41.929 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 20.481306791305542
Epoch: 28, Steps: 34 | Train Loss: 5.631 Vali Loss: 17.047 Vali Acc: 0.624 Test Loss: 17.047 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.847073554992676
Epoch: 29, Steps: 34 | Train Loss: 4.628 Vali Loss: 12.491 Vali Acc: 0.751 Test Loss: 12.491 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 22.286035537719727
Epoch: 30, Steps: 34 | Train Loss: 4.173 Vali Loss: 20.907 Vali Acc: 0.555 Test Loss: 20.907 Test Acc: 0.555
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 22.109357357025146
Epoch: 31, Steps: 34 | Train Loss: 16.363 Vali Loss: 17.491 Vali Acc: 0.566 Test Loss: 17.491 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 23.43905234336853
Epoch: 32, Steps: 34 | Train Loss: 6.012 Vali Loss: 27.423 Vali Acc: 0.353 Test Loss: 27.423 Test Acc: 0.353
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 16479031
model size : 67.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.363373041152954
Epoch: 1, Steps: 34 | Train Loss: 9.551 Vali Loss: 32.995 Vali Acc: 0.150 Test Loss: 32.995 Test Acc: 0.150
Validation loss decreased (inf --> -0.149959).  Saving model ...
Epoch: 2 cost time: 17.769001483917236
Epoch: 2, Steps: 34 | Train Loss: 24.311 Vali Loss: 12.178 Vali Acc: 0.526 Test Loss: 12.178 Test Acc: 0.526
Validation loss decreased (-0.149959 --> -0.525890).  Saving model ...
Epoch: 3 cost time: 20.43126082420349
Epoch: 3, Steps: 34 | Train Loss: 21.011 Vali Loss: 36.426 Vali Acc: 0.439 Test Loss: 36.426 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.7788348197937
Epoch: 4, Steps: 34 | Train Loss: 20.364 Vali Loss: 15.972 Vali Acc: 0.480 Test Loss: 15.972 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.454795598983765
Epoch: 5, Steps: 34 | Train Loss: 12.734 Vali Loss: 23.439 Vali Acc: 0.549 Test Loss: 23.439 Test Acc: 0.549
Validation loss decreased (-0.525890 --> -0.548899).  Saving model ...
Epoch: 6 cost time: 20.839677572250366
Epoch: 6, Steps: 34 | Train Loss: 11.018 Vali Loss: 14.100 Vali Acc: 0.584 Test Loss: 14.100 Test Acc: 0.584
Validation loss decreased (-0.548899 --> -0.583674).  Saving model ...
Epoch: 7 cost time: 19.728453636169434
Epoch: 7, Steps: 34 | Train Loss: 5.536 Vali Loss: 10.341 Vali Acc: 0.607 Test Loss: 10.341 Test Acc: 0.607
Validation loss decreased (-0.583674 --> -0.606833).  Saving model ...
Epoch: 8 cost time: 19.801101207733154
Epoch: 8, Steps: 34 | Train Loss: 6.709 Vali Loss: 3.137 Vali Acc: 0.786 Test Loss: 3.137 Test Acc: 0.786
Validation loss decreased (-0.606833 --> -0.786096).  Saving model ...
Epoch: 9 cost time: 21.482922554016113
Epoch: 9, Steps: 34 | Train Loss: 4.067 Vali Loss: 7.101 Vali Acc: 0.809 Test Loss: 7.101 Test Acc: 0.809
Validation loss decreased (-0.786096 --> -0.809178).  Saving model ...
Epoch: 10 cost time: 19.50777506828308
Epoch: 10, Steps: 34 | Train Loss: 4.586 Vali Loss: 30.303 Vali Acc: 0.480 Test Loss: 30.303 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.46561598777771
Epoch: 11, Steps: 34 | Train Loss: 6.242 Vali Loss: 7.938 Vali Acc: 0.699 Test Loss: 7.938 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.60016942024231
Epoch: 12, Steps: 34 | Train Loss: 2.310 Vali Loss: 12.840 Vali Acc: 0.711 Test Loss: 12.840 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.771623134613037
Epoch: 13, Steps: 34 | Train Loss: 5.504 Vali Loss: 13.094 Vali Acc: 0.705 Test Loss: 13.094 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.169034242630005
Epoch: 14, Steps: 34 | Train Loss: 3.509 Vali Loss: 9.562 Vali Acc: 0.723 Test Loss: 9.562 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 19.181930541992188
Epoch: 15, Steps: 34 | Train Loss: 4.253 Vali Loss: 9.776 Vali Acc: 0.751 Test Loss: 9.776 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.06867480278015
Epoch: 16, Steps: 34 | Train Loss: 2.266 Vali Loss: 13.646 Vali Acc: 0.717 Test Loss: 13.646 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 20.840867519378662
Epoch: 17, Steps: 34 | Train Loss: 1.762 Vali Loss: 19.508 Vali Acc: 0.659 Test Loss: 19.508 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 18.23879313468933
Epoch: 18, Steps: 34 | Train Loss: 1.888 Vali Loss: 11.792 Vali Acc: 0.757 Test Loss: 11.792 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.56933069229126
Epoch: 19, Steps: 34 | Train Loss: 0.936 Vali Loss: 15.091 Vali Acc: 0.751 Test Loss: 15.091 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 16473655
model size : 67.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.99651288986206
Epoch: 1, Steps: 34 | Train Loss: 11.931 Vali Loss: 47.715 Vali Acc: 0.133 Test Loss: 47.715 Test Acc: 0.133
Validation loss decreased (inf --> -0.132471).  Saving model ...
Epoch: 2 cost time: 20.231805086135864
Epoch: 2, Steps: 34 | Train Loss: 19.153 Vali Loss: 40.846 Vali Acc: 0.335 Test Loss: 40.846 Test Acc: 0.335
Validation loss decreased (-0.132471 --> -0.334852).  Saving model ...
Epoch: 3 cost time: 23.26217269897461
Epoch: 3, Steps: 34 | Train Loss: 22.870 Vali Loss: 21.181 Vali Acc: 0.613 Test Loss: 21.181 Test Acc: 0.613
Validation loss decreased (-0.334852 --> -0.612505).  Saving model ...
Epoch: 4 cost time: 23.037811994552612
Epoch: 4, Steps: 34 | Train Loss: 27.303 Vali Loss: 44.952 Vali Acc: 0.486 Test Loss: 44.952 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.96328592300415
Epoch: 5, Steps: 34 | Train Loss: 18.190 Vali Loss: 16.002 Vali Acc: 0.532 Test Loss: 16.002 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.709611415863037
Epoch: 6, Steps: 34 | Train Loss: 12.083 Vali Loss: 31.324 Vali Acc: 0.353 Test Loss: 31.324 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.53953242301941
Epoch: 7, Steps: 34 | Train Loss: 14.020 Vali Loss: 25.237 Vali Acc: 0.526 Test Loss: 25.237 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.94787335395813
Epoch: 8, Steps: 34 | Train Loss: 11.314 Vali Loss: 9.459 Vali Acc: 0.711 Test Loss: 9.459 Test Acc: 0.711
Validation loss decreased (-0.612505 --> -0.710888).  Saving model ...
Epoch: 9 cost time: 26.8841712474823
Epoch: 9, Steps: 34 | Train Loss: 8.345 Vali Loss: 11.557 Vali Acc: 0.676 Test Loss: 11.557 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.30814790725708
Epoch: 10, Steps: 34 | Train Loss: 4.024 Vali Loss: 10.955 Vali Acc: 0.694 Test Loss: 10.955 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 26.60198736190796
Epoch: 11, Steps: 34 | Train Loss: 3.296 Vali Loss: 9.110 Vali Acc: 0.717 Test Loss: 9.110 Test Acc: 0.717
Validation loss decreased (-0.710888 --> -0.716672).  Saving model ...
Epoch: 12 cost time: 23.964349508285522
Epoch: 12, Steps: 34 | Train Loss: 0.744 Vali Loss: 7.362 Vali Acc: 0.728 Test Loss: 7.362 Test Acc: 0.728
Validation loss decreased (-0.716672 --> -0.728250).  Saving model ...
Epoch: 13 cost time: 25.12420916557312
Epoch: 13, Steps: 34 | Train Loss: 1.040 Vali Loss: 9.960 Vali Acc: 0.775 Test Loss: 9.960 Test Acc: 0.775
Validation loss decreased (-0.728250 --> -0.774467).  Saving model ...
Epoch: 14 cost time: 27.67714834213257
Epoch: 14, Steps: 34 | Train Loss: 0.763 Vali Loss: 6.113 Vali Acc: 0.740 Test Loss: 6.113 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.99126124382019
Epoch: 15, Steps: 34 | Train Loss: 2.166 Vali Loss: 3.950 Vali Acc: 0.798 Test Loss: 3.950 Test Acc: 0.798
Validation loss decreased (-0.774467 --> -0.797648).  Saving model ...
Epoch: 16 cost time: 26.001843214035034
Epoch: 16, Steps: 34 | Train Loss: 1.788 Vali Loss: 29.533 Vali Acc: 0.578 Test Loss: 29.533 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 28.92531943321228
Epoch: 17, Steps: 34 | Train Loss: 3.638 Vali Loss: 13.027 Vali Acc: 0.665 Test Loss: 13.027 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.981788635253906
Epoch: 18, Steps: 34 | Train Loss: 1.145 Vali Loss: 16.634 Vali Acc: 0.717 Test Loss: 16.634 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 29.6573224067688
Epoch: 19, Steps: 34 | Train Loss: 2.745 Vali Loss: 34.785 Vali Acc: 0.682 Test Loss: 34.785 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 26.273327827453613
Epoch: 20, Steps: 34 | Train Loss: 2.953 Vali Loss: 13.658 Vali Acc: 0.723 Test Loss: 13.658 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.75353693962097
Epoch: 21, Steps: 34 | Train Loss: 3.069 Vali Loss: 47.410 Vali Acc: 0.549 Test Loss: 47.410 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 27.213403463363647
Epoch: 22, Steps: 34 | Train Loss: 1.607 Vali Loss: 20.759 Vali Acc: 0.705 Test Loss: 20.759 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 23.158238649368286
Epoch: 23, Steps: 34 | Train Loss: 1.843 Vali Loss: 11.008 Vali Acc: 0.769 Test Loss: 11.008 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 24.874979496002197
Epoch: 24, Steps: 34 | Train Loss: 1.099 Vali Loss: 21.071 Vali Acc: 0.757 Test Loss: 21.071 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 25.93255615234375
Epoch: 25, Steps: 34 | Train Loss: 1.928 Vali Loss: 9.073 Vali Acc: 0.775 Test Loss: 9.073 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 16468279
model size : 67.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 27.72162103652954
Epoch: 1, Steps: 34 | Train Loss: 10.377 Vali Loss: 14.437 Vali Acc: 0.312 Test Loss: 14.437 Test Acc: 0.312
Validation loss decreased (inf --> -0.311994).  Saving model ...
Epoch: 2 cost time: 24.020932912826538
Epoch: 2, Steps: 34 | Train Loss: 18.844 Vali Loss: 30.230 Vali Acc: 0.532 Test Loss: 30.230 Test Acc: 0.532
Validation loss decreased (-0.311994 --> -0.531490).  Saving model ...
Epoch: 3 cost time: 26.851874589920044
Epoch: 3, Steps: 34 | Train Loss: 28.925 Vali Loss: 42.712 Vali Acc: 0.358 Test Loss: 42.712 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.565725326538086
Epoch: 4, Steps: 34 | Train Loss: 23.336 Vali Loss: 16.086 Vali Acc: 0.509 Test Loss: 16.086 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.472855806350708
Epoch: 5, Steps: 34 | Train Loss: 22.428 Vali Loss: 38.501 Vali Acc: 0.445 Test Loss: 38.501 Test Acc: 0.445
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.98656392097473
Epoch: 6, Steps: 34 | Train Loss: 24.300 Vali Loss: 37.427 Vali Acc: 0.526 Test Loss: 37.427 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 25.06713032722473
Epoch: 7, Steps: 34 | Train Loss: 14.709 Vali Loss: 19.031 Vali Acc: 0.642 Test Loss: 19.031 Test Acc: 0.642
Validation loss decreased (-0.531490 --> -0.641428).  Saving model ...
Epoch: 8 cost time: 25.36439275741577
Epoch: 8, Steps: 34 | Train Loss: 5.911 Vali Loss: 17.801 Vali Acc: 0.624 Test Loss: 17.801 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.079380989074707
Epoch: 9, Steps: 34 | Train Loss: 5.240 Vali Loss: 12.175 Vali Acc: 0.780 Test Loss: 12.175 Test Acc: 0.780
Validation loss decreased (-0.641428 --> -0.780225).  Saving model ...
Epoch: 10 cost time: 24.01790690422058
Epoch: 10, Steps: 34 | Train Loss: 6.838 Vali Loss: 22.686 Vali Acc: 0.636 Test Loss: 22.686 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 26.841877460479736
Epoch: 11, Steps: 34 | Train Loss: 5.425 Vali Loss: 8.050 Vali Acc: 0.809 Test Loss: 8.050 Test Acc: 0.809
Validation loss decreased (-0.780225 --> -0.809168).  Saving model ...
Epoch: 12 cost time: 23.921988248825073
Epoch: 12, Steps: 34 | Train Loss: 3.370 Vali Loss: 9.980 Vali Acc: 0.740 Test Loss: 9.980 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.200995922088623
Epoch: 13, Steps: 34 | Train Loss: 1.831 Vali Loss: 13.947 Vali Acc: 0.792 Test Loss: 13.947 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.75296926498413
Epoch: 14, Steps: 34 | Train Loss: 4.960 Vali Loss: 19.638 Vali Acc: 0.642 Test Loss: 19.638 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.673622608184814
Epoch: 15, Steps: 34 | Train Loss: 3.663 Vali Loss: 22.590 Vali Acc: 0.630 Test Loss: 22.590 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 26.205730676651
Epoch: 16, Steps: 34 | Train Loss: 3.648 Vali Loss: 19.366 Vali Acc: 0.694 Test Loss: 19.366 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 23.447697162628174
Epoch: 17, Steps: 34 | Train Loss: 0.852 Vali Loss: 25.535 Vali Acc: 0.734 Test Loss: 25.535 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 28.68706464767456
Epoch: 18, Steps: 34 | Train Loss: 1.361 Vali Loss: 16.590 Vali Acc: 0.769 Test Loss: 16.590 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 24.82867407798767
Epoch: 19, Steps: 34 | Train Loss: 1.985 Vali Loss: 27.714 Vali Acc: 0.659 Test Loss: 27.714 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.811781883239746
Epoch: 20, Steps: 34 | Train Loss: 2.771 Vali Loss: 11.137 Vali Acc: 0.757 Test Loss: 11.137 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 28.625120639801025
Epoch: 21, Steps: 34 | Train Loss: 0.840 Vali Loss: 13.308 Vali Acc: 0.734 Test Loss: 13.308 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 16024759
model size : 66.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 26.499059200286865
Epoch: 1, Steps: 34 | Train Loss: 8.031 Vali Loss: 19.292 Vali Acc: 0.277 Test Loss: 19.292 Test Acc: 0.277
Validation loss decreased (inf --> -0.277264).  Saving model ...
Epoch: 2 cost time: 27.09044909477234
Epoch: 2, Steps: 34 | Train Loss: 14.567 Vali Loss: 15.716 Vali Acc: 0.509 Test Loss: 15.716 Test Acc: 0.509
Validation loss decreased (-0.277264 --> -0.508513).  Saving model ...
Epoch: 3 cost time: 24.117207765579224
Epoch: 3, Steps: 34 | Train Loss: 22.634 Vali Loss: 26.663 Vali Acc: 0.428 Test Loss: 26.663 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.444803476333618
Epoch: 4, Steps: 34 | Train Loss: 15.405 Vali Loss: 24.299 Vali Acc: 0.549 Test Loss: 24.299 Test Acc: 0.549
Validation loss decreased (-0.508513 --> -0.548890).  Saving model ...
Epoch: 5 cost time: 26.34251856803894
Epoch: 5, Steps: 34 | Train Loss: 15.190 Vali Loss: 26.066 Vali Acc: 0.613 Test Loss: 26.066 Test Acc: 0.613
Validation loss decreased (-0.548890 --> -0.612456).  Saving model ...
Epoch: 6 cost time: 22.939109086990356
Epoch: 6, Steps: 34 | Train Loss: 9.273 Vali Loss: 17.185 Vali Acc: 0.624 Test Loss: 17.185 Test Acc: 0.624
Validation loss decreased (-0.612456 --> -0.624106).  Saving model ...
Epoch: 7 cost time: 26.751347541809082
Epoch: 7, Steps: 34 | Train Loss: 11.448 Vali Loss: 16.665 Vali Acc: 0.601 Test Loss: 16.665 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.042398691177368
Epoch: 8, Steps: 34 | Train Loss: 9.069 Vali Loss: 14.767 Vali Acc: 0.613 Test Loss: 14.767 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.888535499572754
Epoch: 9, Steps: 34 | Train Loss: 6.539 Vali Loss: 10.329 Vali Acc: 0.728 Test Loss: 10.329 Test Acc: 0.728
Validation loss decreased (-0.624106 --> -0.728220).  Saving model ...
Epoch: 10 cost time: 28.511940479278564
Epoch: 10, Steps: 34 | Train Loss: 3.778 Vali Loss: 22.508 Vali Acc: 0.630 Test Loss: 22.508 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 26.767242670059204
Epoch: 11, Steps: 34 | Train Loss: 1.851 Vali Loss: 8.987 Vali Acc: 0.734 Test Loss: 8.987 Test Acc: 0.734
Validation loss decreased (-0.728220 --> -0.734014).  Saving model ...
Epoch: 12 cost time: 28.300472497940063
Epoch: 12, Steps: 34 | Train Loss: 4.371 Vali Loss: 4.884 Vali Acc: 0.832 Test Loss: 4.884 Test Acc: 0.832
Validation loss decreased (-0.734014 --> -0.832321).  Saving model ...
Epoch: 13 cost time: 23.85928988456726
Epoch: 13, Steps: 34 | Train Loss: 1.644 Vali Loss: 13.024 Vali Acc: 0.705 Test Loss: 13.024 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.43600058555603
Epoch: 14, Steps: 34 | Train Loss: 0.973 Vali Loss: 11.757 Vali Acc: 0.780 Test Loss: 11.757 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.458443880081177
Epoch: 15, Steps: 34 | Train Loss: 1.814 Vali Loss: 21.169 Vali Acc: 0.688 Test Loss: 21.169 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.93536877632141
Epoch: 16, Steps: 34 | Train Loss: 2.309 Vali Loss: 17.330 Vali Acc: 0.746 Test Loss: 17.330 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.560179233551025
Epoch: 17, Steps: 34 | Train Loss: 1.928 Vali Loss: 20.899 Vali Acc: 0.723 Test Loss: 20.899 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.23011088371277
Epoch: 18, Steps: 34 | Train Loss: 3.459 Vali Loss: 12.689 Vali Acc: 0.798 Test Loss: 12.689 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 25.386902332305908
Epoch: 19, Steps: 34 | Train Loss: 1.564 Vali Loss: 20.281 Vali Acc: 0.775 Test Loss: 20.281 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.231929779052734
Epoch: 20, Steps: 34 | Train Loss: 2.693 Vali Loss: 10.401 Vali Acc: 0.792 Test Loss: 10.401 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.947184324264526
Epoch: 21, Steps: 34 | Train Loss: 2.284 Vali Loss: 10.314 Vali Acc: 0.803 Test Loss: 10.314 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 26.048789978027344
Epoch: 22, Steps: 34 | Train Loss: 2.605 Vali Loss: 11.516 Vali Acc: 0.775 Test Loss: 11.516 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 16019383
model size : 66.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 30.013607263565063
Epoch: 1, Steps: 34 | Train Loss: 7.518 Vali Loss: 12.127 Vali Acc: 0.306 Test Loss: 12.127 Test Acc: 0.306
Validation loss decreased (inf --> -0.306237).  Saving model ...
Epoch: 2 cost time: 28.073487758636475
Epoch: 2, Steps: 34 | Train Loss: 13.711 Vali Loss: 21.535 Vali Acc: 0.555 Test Loss: 21.535 Test Acc: 0.555
Validation loss decreased (-0.306237 --> -0.554698).  Saving model ...
Epoch: 3 cost time: 24.775518655776978
Epoch: 3, Steps: 34 | Train Loss: 21.325 Vali Loss: 19.481 Vali Acc: 0.566 Test Loss: 19.481 Test Acc: 0.566
Validation loss decreased (-0.554698 --> -0.566279).  Saving model ...
Epoch: 4 cost time: 27.55966544151306
Epoch: 4, Steps: 34 | Train Loss: 18.620 Vali Loss: 21.568 Vali Acc: 0.595 Test Loss: 21.568 Test Acc: 0.595
Validation loss decreased (-0.566279 --> -0.595160).  Saving model ...
Epoch: 5 cost time: 23.270070552825928
Epoch: 5, Steps: 34 | Train Loss: 19.443 Vali Loss: 20.078 Vali Acc: 0.520 Test Loss: 20.078 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.692898988723755
Epoch: 6, Steps: 34 | Train Loss: 11.215 Vali Loss: 24.253 Vali Acc: 0.422 Test Loss: 24.253 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.682961463928223
Epoch: 7, Steps: 34 | Train Loss: 14.489 Vali Loss: 17.391 Vali Acc: 0.653 Test Loss: 17.391 Test Acc: 0.653
Validation loss decreased (-0.595160 --> -0.653005).  Saving model ...
Epoch: 8 cost time: 23.649560689926147
Epoch: 8, Steps: 34 | Train Loss: 4.562 Vali Loss: 9.917 Vali Acc: 0.734 Test Loss: 9.917 Test Acc: 0.734
Validation loss decreased (-0.653005 --> -0.734005).  Saving model ...
Epoch: 9 cost time: 26.67732310295105
Epoch: 9, Steps: 34 | Train Loss: 10.193 Vali Loss: 27.122 Vali Acc: 0.538 Test Loss: 27.122 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.00859832763672
Epoch: 10, Steps: 34 | Train Loss: 4.160 Vali Loss: 22.557 Vali Acc: 0.694 Test Loss: 22.557 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 24.79312038421631
Epoch: 11, Steps: 34 | Train Loss: 8.108 Vali Loss: 28.532 Vali Acc: 0.642 Test Loss: 28.532 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.46621561050415
Epoch: 12, Steps: 34 | Train Loss: 7.605 Vali Loss: 11.079 Vali Acc: 0.769 Test Loss: 11.079 Test Acc: 0.769
Validation loss decreased (-0.734005 --> -0.768675).  Saving model ...
Epoch: 13 cost time: 25.12729811668396
Epoch: 13, Steps: 34 | Train Loss: 2.716 Vali Loss: 8.791 Vali Acc: 0.803 Test Loss: 8.791 Test Acc: 0.803
Validation loss decreased (-0.768675 --> -0.803380).  Saving model ...
Epoch: 14 cost time: 27.259479999542236
Epoch: 14, Steps: 34 | Train Loss: 2.621 Vali Loss: 22.932 Vali Acc: 0.746 Test Loss: 22.932 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.774903535842896
Epoch: 15, Steps: 34 | Train Loss: 3.260 Vali Loss: 15.100 Vali Acc: 0.827 Test Loss: 15.100 Test Acc: 0.827
Validation loss decreased (-0.803380 --> -0.826439).  Saving model ...
Epoch: 16 cost time: 28.162416458129883
Epoch: 16, Steps: 34 | Train Loss: 2.492 Vali Loss: 11.412 Vali Acc: 0.803 Test Loss: 11.412 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.61894726753235
Epoch: 17, Steps: 34 | Train Loss: 2.302 Vali Loss: 46.326 Vali Acc: 0.607 Test Loss: 46.326 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.852394342422485
Epoch: 18, Steps: 34 | Train Loss: 4.233 Vali Loss: 28.124 Vali Acc: 0.746 Test Loss: 28.124 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.33384895324707
Epoch: 19, Steps: 34 | Train Loss: 2.421 Vali Loss: 26.854 Vali Acc: 0.711 Test Loss: 26.854 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 28.32546615600586
Epoch: 20, Steps: 34 | Train Loss: 1.687 Vali Loss: 13.319 Vali Acc: 0.780 Test Loss: 13.319 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.439029932022095
Epoch: 21, Steps: 34 | Train Loss: 1.223 Vali Loss: 7.482 Vali Acc: 0.855 Test Loss: 7.482 Test Acc: 0.855
Validation loss decreased (-0.826439 --> -0.855417).  Saving model ...
Epoch: 22 cost time: 25.37007451057434
Epoch: 22, Steps: 34 | Train Loss: 1.235 Vali Loss: 21.058 Vali Acc: 0.728 Test Loss: 21.058 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 26.13434147834778
Epoch: 23, Steps: 34 | Train Loss: 0.265 Vali Loss: 13.888 Vali Acc: 0.809 Test Loss: 13.888 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 24.500167846679688
Epoch: 24, Steps: 34 | Train Loss: 1.762 Vali Loss: 19.714 Vali Acc: 0.740 Test Loss: 19.714 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 26.88612151145935
Epoch: 25, Steps: 34 | Train Loss: 1.578 Vali Loss: 23.756 Vali Acc: 0.803 Test Loss: 23.756 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 25.763853073120117
Epoch: 26, Steps: 34 | Train Loss: 4.062 Vali Loss: 20.922 Vali Acc: 0.775 Test Loss: 20.922 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 26.725847482681274
Epoch: 27, Steps: 34 | Train Loss: 3.260 Vali Loss: 17.731 Vali Acc: 0.821 Test Loss: 17.731 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 27.622904539108276
Epoch: 28, Steps: 34 | Train Loss: 5.535 Vali Loss: 28.195 Vali Acc: 0.751 Test Loss: 28.195 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 27.4405620098114
Epoch: 29, Steps: 34 | Train Loss: 2.139 Vali Loss: 33.373 Vali Acc: 0.728 Test Loss: 33.373 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 29.733742713928223
Epoch: 30, Steps: 34 | Train Loss: 7.153 Vali Loss: 22.324 Vali Acc: 0.642 Test Loss: 22.324 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 26.083829402923584
Epoch: 31, Steps: 34 | Train Loss: 3.983 Vali Loss: 16.016 Vali Acc: 0.728 Test Loss: 16.016 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 16014007
model size : 66.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 26.115725994110107
Epoch: 1, Steps: 34 | Train Loss: 12.257 Vali Loss: 17.646 Vali Acc: 0.335 Test Loss: 17.646 Test Acc: 0.335
Validation loss decreased (inf --> -0.335084).  Saving model ...
Epoch: 2 cost time: 24.768773317337036
Epoch: 2, Steps: 34 | Train Loss: 21.396 Vali Loss: 24.560 Vali Acc: 0.428 Test Loss: 24.560 Test Acc: 0.428
Validation loss decreased (-0.335084 --> -0.427500).  Saving model ...
Epoch: 3 cost time: 27.131154775619507
Epoch: 3, Steps: 34 | Train Loss: 14.573 Vali Loss: 54.506 Vali Acc: 0.399 Test Loss: 54.506 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.94162607192993
Epoch: 4, Steps: 34 | Train Loss: 28.399 Vali Loss: 25.798 Vali Acc: 0.341 Test Loss: 25.798 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.905958652496338
Epoch: 5, Steps: 34 | Train Loss: 17.125 Vali Loss: 20.872 Vali Acc: 0.474 Test Loss: 20.872 Test Acc: 0.474
Validation loss decreased (-0.427500 --> -0.473780).  Saving model ...
Epoch: 6 cost time: 24.945090770721436
Epoch: 6, Steps: 34 | Train Loss: 13.803 Vali Loss: 14.714 Vali Acc: 0.566 Test Loss: 14.714 Test Acc: 0.566
Validation loss decreased (-0.473780 --> -0.566327).  Saving model ...
Epoch: 7 cost time: 25.766825437545776
Epoch: 7, Steps: 34 | Train Loss: 7.956 Vali Loss: 5.676 Vali Acc: 0.728 Test Loss: 5.676 Test Acc: 0.728
Validation loss decreased (-0.566327 --> -0.728267).  Saving model ...
Epoch: 8 cost time: 26.87883710861206
Epoch: 8, Steps: 34 | Train Loss: 5.723 Vali Loss: 28.611 Vali Acc: 0.480 Test Loss: 28.611 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.65412163734436
Epoch: 9, Steps: 34 | Train Loss: 6.033 Vali Loss: 22.777 Vali Acc: 0.642 Test Loss: 22.777 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 30.286988973617554
Epoch: 10, Steps: 34 | Train Loss: 3.916 Vali Loss: 10.713 Vali Acc: 0.717 Test Loss: 10.713 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 27.271342992782593
Epoch: 11, Steps: 34 | Train Loss: 6.368 Vali Loss: 9.851 Vali Acc: 0.746 Test Loss: 9.851 Test Acc: 0.746
Validation loss decreased (-0.728267 --> -0.745566).  Saving model ...
Epoch: 12 cost time: 28.292673110961914
Epoch: 12, Steps: 34 | Train Loss: 2.428 Vali Loss: 12.920 Vali Acc: 0.711 Test Loss: 12.920 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 27.223907232284546
Epoch: 13, Steps: 34 | Train Loss: 2.233 Vali Loss: 15.026 Vali Acc: 0.607 Test Loss: 15.026 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.360769748687744
Epoch: 14, Steps: 34 | Train Loss: 3.263 Vali Loss: 16.177 Vali Acc: 0.717 Test Loss: 16.177 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 26.805640697479248
Epoch: 15, Steps: 34 | Train Loss: 1.327 Vali Loss: 15.260 Vali Acc: 0.786 Test Loss: 15.260 Test Acc: 0.786
Validation loss decreased (-0.745566 --> -0.785975).  Saving model ...
Epoch: 16 cost time: 24.40151309967041
Epoch: 16, Steps: 34 | Train Loss: 0.258 Vali Loss: 9.733 Vali Acc: 0.757 Test Loss: 9.733 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.329414129257202
Epoch: 17, Steps: 34 | Train Loss: 1.130 Vali Loss: 31.547 Vali Acc: 0.555 Test Loss: 31.547 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 19.152082920074463
Epoch: 18, Steps: 34 | Train Loss: 1.808 Vali Loss: 27.858 Vali Acc: 0.613 Test Loss: 27.858 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.860169887542725
Epoch: 19, Steps: 34 | Train Loss: 2.449 Vali Loss: 9.308 Vali Acc: 0.746 Test Loss: 9.308 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.04566526412964
Epoch: 20, Steps: 34 | Train Loss: 1.242 Vali Loss: 12.591 Vali Acc: 0.723 Test Loss: 12.591 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.74706268310547
Epoch: 21, Steps: 34 | Train Loss: 1.625 Vali Loss: 8.628 Vali Acc: 0.746 Test Loss: 8.628 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 23.44741415977478
Epoch: 22, Steps: 34 | Train Loss: 2.747 Vali Loss: 21.510 Vali Acc: 0.618 Test Loss: 21.510 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 24.99618411064148
Epoch: 23, Steps: 34 | Train Loss: 2.514 Vali Loss: 14.392 Vali Acc: 0.728 Test Loss: 14.392 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 27.60530948638916
Epoch: 24, Steps: 34 | Train Loss: 3.114 Vali Loss: 35.433 Vali Acc: 0.566 Test Loss: 35.433 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 26.21655035018921
Epoch: 25, Steps: 34 | Train Loss: 1.688 Vali Loss: 14.638 Vali Acc: 0.717 Test Loss: 14.638 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 16008631
model size : 66.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.105449199676514
Epoch: 1, Steps: 34 | Train Loss: 4.749 Vali Loss: 6.059 Vali Acc: 0.399 Test Loss: 6.059 Test Acc: 0.399
Validation loss decreased (inf --> -0.398783).  Saving model ...
Epoch: 2 cost time: 21.230583667755127
Epoch: 2, Steps: 34 | Train Loss: 5.184 Vali Loss: 5.769 Vali Acc: 0.462 Test Loss: 5.769 Test Acc: 0.462
Validation loss decreased (-0.398783 --> -0.462370).  Saving model ...
Epoch: 3 cost time: 19.201059103012085
Epoch: 3, Steps: 34 | Train Loss: 9.379 Vali Loss: 8.755 Vali Acc: 0.532 Test Loss: 8.755 Test Acc: 0.532
Validation loss decreased (-0.462370 --> -0.531704).  Saving model ...
Epoch: 4 cost time: 22.855274200439453
Epoch: 4, Steps: 34 | Train Loss: 10.712 Vali Loss: 12.892 Vali Acc: 0.428 Test Loss: 12.892 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.31163215637207
Epoch: 5, Steps: 34 | Train Loss: 8.432 Vali Loss: 11.640 Vali Acc: 0.509 Test Loss: 11.640 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.607354402542114
Epoch: 6, Steps: 34 | Train Loss: 7.060 Vali Loss: 10.758 Vali Acc: 0.595 Test Loss: 10.758 Test Acc: 0.595
Validation loss decreased (-0.531704 --> -0.595268).  Saving model ...
Epoch: 7 cost time: 21.15457820892334
Epoch: 7, Steps: 34 | Train Loss: 5.562 Vali Loss: 13.756 Vali Acc: 0.671 Test Loss: 13.756 Test Acc: 0.671
Validation loss decreased (-0.595268 --> -0.670383).  Saving model ...
Epoch: 8 cost time: 20.398690700531006
Epoch: 8, Steps: 34 | Train Loss: 3.525 Vali Loss: 11.394 Vali Acc: 0.676 Test Loss: 11.394 Test Acc: 0.676
Validation loss decreased (-0.670383 --> -0.676187).  Saving model ...
Epoch: 9 cost time: 18.692559719085693
Epoch: 9, Steps: 34 | Train Loss: 3.881 Vali Loss: 11.421 Vali Acc: 0.647 Test Loss: 11.421 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.788714170455933
Epoch: 10, Steps: 34 | Train Loss: 2.521 Vali Loss: 2.370 Vali Acc: 0.809 Test Loss: 2.370 Test Acc: 0.809
Validation loss decreased (-0.676187 --> -0.809225).  Saving model ...
Epoch: 11 cost time: 21.609678506851196
Epoch: 11, Steps: 34 | Train Loss: 0.762 Vali Loss: 12.106 Vali Acc: 0.688 Test Loss: 12.106 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.955528020858765
Epoch: 12, Steps: 34 | Train Loss: 0.688 Vali Loss: 2.874 Vali Acc: 0.850 Test Loss: 2.874 Test Acc: 0.850
Validation loss decreased (-0.809225 --> -0.849682).  Saving model ...
Epoch: 13 cost time: 20.550631523132324
Epoch: 13, Steps: 34 | Train Loss: 0.481 Vali Loss: 10.601 Vali Acc: 0.763 Test Loss: 10.601 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.027074337005615
Epoch: 14, Steps: 34 | Train Loss: 1.208 Vali Loss: 6.450 Vali Acc: 0.803 Test Loss: 6.450 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.1985924243927
Epoch: 15, Steps: 34 | Train Loss: 0.623 Vali Loss: 12.912 Vali Acc: 0.734 Test Loss: 12.912 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 24.944272994995117
Epoch: 16, Steps: 34 | Train Loss: 4.772 Vali Loss: 12.244 Vali Acc: 0.775 Test Loss: 12.244 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.858789205551147
Epoch: 17, Steps: 34 | Train Loss: 0.666 Vali Loss: 13.201 Vali Acc: 0.647 Test Loss: 13.201 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.779884338378906
Epoch: 18, Steps: 34 | Train Loss: 0.992 Vali Loss: 10.774 Vali Acc: 0.740 Test Loss: 10.774 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 20.34870958328247
Epoch: 19, Steps: 34 | Train Loss: 1.216 Vali Loss: 8.665 Vali Acc: 0.757 Test Loss: 8.665 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.712738037109375
Epoch: 20, Steps: 34 | Train Loss: 0.863 Vali Loss: 8.952 Vali Acc: 0.763 Test Loss: 8.952 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.547592401504517
Epoch: 21, Steps: 34 | Train Loss: 1.542 Vali Loss: 6.562 Vali Acc: 0.827 Test Loss: 6.562 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 20.370012998580933
Epoch: 22, Steps: 34 | Train Loss: 0.533 Vali Loss: 10.974 Vali Acc: 0.734 Test Loss: 10.974 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 7789751
model size : 32.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.632457971572876
Epoch: 1, Steps: 34 | Train Loss: 5.184 Vali Loss: 6.928 Vali Acc: 0.272 Test Loss: 6.928 Test Acc: 0.272
Validation loss decreased (inf --> -0.271607).  Saving model ...
Epoch: 2 cost time: 21.93606972694397
Epoch: 2, Steps: 34 | Train Loss: 7.629 Vali Loss: 7.000 Vali Acc: 0.347 Test Loss: 7.000 Test Acc: 0.347
Validation loss decreased (-0.271607 --> -0.346751).  Saving model ...
Epoch: 3 cost time: 20.22239398956299
Epoch: 3, Steps: 34 | Train Loss: 7.533 Vali Loss: 12.247 Vali Acc: 0.486 Test Loss: 12.247 Test Acc: 0.486
Validation loss decreased (-0.346751 --> -0.485427).  Saving model ...
Epoch: 4 cost time: 20.887121200561523
Epoch: 4, Steps: 34 | Train Loss: 7.778 Vali Loss: 13.395 Vali Acc: 0.526 Test Loss: 13.395 Test Acc: 0.526
Validation loss decreased (-0.485427 --> -0.525878).  Saving model ...
Epoch: 5 cost time: 20.737866163253784
Epoch: 5, Steps: 34 | Train Loss: 5.732 Vali Loss: 7.543 Vali Acc: 0.682 Test Loss: 7.543 Test Acc: 0.682
Validation loss decreased (-0.525878 --> -0.682005).  Saving model ...
Epoch: 6 cost time: 22.112330675125122
Epoch: 6, Steps: 34 | Train Loss: 8.030 Vali Loss: 12.824 Vali Acc: 0.601 Test Loss: 12.824 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.625667572021484
Epoch: 7, Steps: 34 | Train Loss: 4.259 Vali Loss: 12.159 Vali Acc: 0.595 Test Loss: 12.159 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.554166078567505
Epoch: 8, Steps: 34 | Train Loss: 5.356 Vali Loss: 13.213 Vali Acc: 0.665 Test Loss: 13.213 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.7431743144989
Epoch: 9, Steps: 34 | Train Loss: 3.521 Vali Loss: 16.381 Vali Acc: 0.647 Test Loss: 16.381 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.44907021522522
Epoch: 10, Steps: 34 | Train Loss: 4.645 Vali Loss: 15.820 Vali Acc: 0.630 Test Loss: 15.820 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.015193939208984
Epoch: 11, Steps: 34 | Train Loss: 3.993 Vali Loss: 9.631 Vali Acc: 0.688 Test Loss: 9.631 Test Acc: 0.688
Validation loss decreased (-0.682005 --> -0.687765).  Saving model ...
Epoch: 12 cost time: 20.181801319122314
Epoch: 12, Steps: 34 | Train Loss: 0.781 Vali Loss: 6.872 Vali Acc: 0.757 Test Loss: 6.872 Test Acc: 0.757
Validation loss decreased (-0.687765 --> -0.757157).  Saving model ...
Epoch: 13 cost time: 23.31378436088562
Epoch: 13, Steps: 34 | Train Loss: 1.446 Vali Loss: 11.661 Vali Acc: 0.688 Test Loss: 11.661 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.69247317314148
Epoch: 14, Steps: 34 | Train Loss: 0.557 Vali Loss: 8.393 Vali Acc: 0.746 Test Loss: 8.393 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.857226371765137
Epoch: 15, Steps: 34 | Train Loss: 0.958 Vali Loss: 7.160 Vali Acc: 0.809 Test Loss: 7.160 Test Acc: 0.809
Validation loss decreased (-0.757157 --> -0.809177).  Saving model ...
Epoch: 16 cost time: 19.41603994369507
Epoch: 16, Steps: 34 | Train Loss: 0.584 Vali Loss: 7.947 Vali Acc: 0.757 Test Loss: 7.947 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 23.10811996459961
Epoch: 17, Steps: 34 | Train Loss: 0.929 Vali Loss: 4.761 Vali Acc: 0.798 Test Loss: 4.761 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.18990159034729
Epoch: 18, Steps: 34 | Train Loss: 1.028 Vali Loss: 14.443 Vali Acc: 0.757 Test Loss: 14.443 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 21.448872327804565
Epoch: 19, Steps: 34 | Train Loss: 0.986 Vali Loss: 7.772 Vali Acc: 0.792 Test Loss: 7.772 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.18398118019104
Epoch: 20, Steps: 34 | Train Loss: 0.666 Vali Loss: 11.487 Vali Acc: 0.763 Test Loss: 11.487 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.257097959518433
Epoch: 21, Steps: 34 | Train Loss: 0.348 Vali Loss: 18.366 Vali Acc: 0.671 Test Loss: 18.366 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.572292804718018
Epoch: 22, Steps: 34 | Train Loss: 0.873 Vali Loss: 16.425 Vali Acc: 0.676 Test Loss: 16.425 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 24.78445792198181
Epoch: 23, Steps: 34 | Train Loss: 2.746 Vali Loss: 11.337 Vali Acc: 0.676 Test Loss: 11.337 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 23.36990976333618
Epoch: 24, Steps: 34 | Train Loss: 2.111 Vali Loss: 10.883 Vali Acc: 0.798 Test Loss: 10.883 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 23.50406813621521
Epoch: 25, Steps: 34 | Train Loss: 0.720 Vali Loss: 7.737 Vali Acc: 0.792 Test Loss: 7.737 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 7787063
model size : 32.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.600549459457397
Epoch: 1, Steps: 34 | Train Loss: 5.406 Vali Loss: 13.190 Vali Acc: 0.272 Test Loss: 13.190 Test Acc: 0.272
Validation loss decreased (inf --> -0.271544).  Saving model ...
Epoch: 2 cost time: 21.3425714969635
Epoch: 2, Steps: 34 | Train Loss: 7.575 Vali Loss: 9.753 Vali Acc: 0.566 Test Loss: 9.753 Test Acc: 0.566
Validation loss decreased (-0.271544 --> -0.566376).  Saving model ...
Epoch: 3 cost time: 20.83315896987915
Epoch: 3, Steps: 34 | Train Loss: 10.512 Vali Loss: 12.858 Vali Acc: 0.486 Test Loss: 12.858 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.90738320350647
Epoch: 4, Steps: 34 | Train Loss: 13.342 Vali Loss: 19.101 Vali Acc: 0.538 Test Loss: 19.101 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.388984203338623
Epoch: 5, Steps: 34 | Train Loss: 11.010 Vali Loss: 15.299 Vali Acc: 0.503 Test Loss: 15.299 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.24521827697754
Epoch: 6, Steps: 34 | Train Loss: 6.718 Vali Loss: 5.549 Vali Acc: 0.705 Test Loss: 5.549 Test Acc: 0.705
Validation loss decreased (-0.566376 --> -0.705147).  Saving model ...
Epoch: 7 cost time: 20.372668266296387
Epoch: 7, Steps: 34 | Train Loss: 2.058 Vali Loss: 7.249 Vali Acc: 0.613 Test Loss: 7.249 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.08459782600403
Epoch: 8, Steps: 34 | Train Loss: 1.413 Vali Loss: 10.497 Vali Acc: 0.636 Test Loss: 10.497 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.00587749481201
Epoch: 9, Steps: 34 | Train Loss: 1.506 Vali Loss: 7.124 Vali Acc: 0.734 Test Loss: 7.124 Test Acc: 0.734
Validation loss decreased (-0.705147 --> -0.734033).  Saving model ...
Epoch: 10 cost time: 21.439716577529907
Epoch: 10, Steps: 34 | Train Loss: 2.819 Vali Loss: 6.943 Vali Acc: 0.699 Test Loss: 6.943 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.66112518310547
Epoch: 11, Steps: 34 | Train Loss: 0.367 Vali Loss: 4.541 Vali Acc: 0.798 Test Loss: 4.541 Test Acc: 0.798
Validation loss decreased (-0.734033 --> -0.797642).  Saving model ...
Epoch: 12 cost time: 21.97784686088562
Epoch: 12, Steps: 34 | Train Loss: 0.884 Vali Loss: 6.804 Vali Acc: 0.705 Test Loss: 6.804 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.750781297683716
Epoch: 13, Steps: 34 | Train Loss: 1.884 Vali Loss: 5.589 Vali Acc: 0.763 Test Loss: 5.589 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.280246257781982
Epoch: 14, Steps: 34 | Train Loss: 3.308 Vali Loss: 6.730 Vali Acc: 0.751 Test Loss: 6.730 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.661429405212402
Epoch: 15, Steps: 34 | Train Loss: 1.221 Vali Loss: 7.081 Vali Acc: 0.763 Test Loss: 7.081 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.186463594436646
Epoch: 16, Steps: 34 | Train Loss: 0.786 Vali Loss: 12.050 Vali Acc: 0.688 Test Loss: 12.050 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 23.632801294326782
Epoch: 17, Steps: 34 | Train Loss: 0.050 Vali Loss: 10.213 Vali Acc: 0.809 Test Loss: 10.213 Test Acc: 0.809
Validation loss decreased (-0.797642 --> -0.809146).  Saving model ...
Epoch: 18 cost time: 24.188538551330566
Epoch: 18, Steps: 34 | Train Loss: 1.123 Vali Loss: 9.629 Vali Acc: 0.676 Test Loss: 9.629 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.23137354850769
Epoch: 19, Steps: 34 | Train Loss: 0.597 Vali Loss: 8.319 Vali Acc: 0.798 Test Loss: 8.319 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 20.170212745666504
Epoch: 20, Steps: 34 | Train Loss: 1.291 Vali Loss: 9.534 Vali Acc: 0.786 Test Loss: 9.534 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.94984722137451
Epoch: 21, Steps: 34 | Train Loss: 2.269 Vali Loss: 8.208 Vali Acc: 0.815 Test Loss: 8.208 Test Acc: 0.815
Validation loss decreased (-0.809146 --> -0.814947).  Saving model ...
Epoch: 22 cost time: 21.05123496055603
Epoch: 22, Steps: 34 | Train Loss: 0.382 Vali Loss: 7.827 Vali Acc: 0.792 Test Loss: 7.827 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 21.8641836643219
Epoch: 23, Steps: 34 | Train Loss: 1.210 Vali Loss: 12.551 Vali Acc: 0.717 Test Loss: 12.551 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 18.655457973480225
Epoch: 24, Steps: 34 | Train Loss: 0.365 Vali Loss: 13.297 Vali Acc: 0.728 Test Loss: 13.297 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 22.033037424087524
Epoch: 25, Steps: 34 | Train Loss: 1.375 Vali Loss: 13.943 Vali Acc: 0.751 Test Loss: 13.943 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 20.218961477279663
Epoch: 26, Steps: 34 | Train Loss: 0.320 Vali Loss: 9.166 Vali Acc: 0.832 Test Loss: 9.166 Test Acc: 0.832
Validation loss decreased (-0.814947 --> -0.832278).  Saving model ...
Epoch: 27 cost time: 21.966975927352905
Epoch: 27, Steps: 34 | Train Loss: 0.257 Vali Loss: 22.575 Vali Acc: 0.636 Test Loss: 22.575 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 18.345126390457153
Epoch: 28, Steps: 34 | Train Loss: 1.011 Vali Loss: 14.365 Vali Acc: 0.723 Test Loss: 14.365 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 22.157301664352417
Epoch: 29, Steps: 34 | Train Loss: 0.259 Vali Loss: 13.719 Vali Acc: 0.711 Test Loss: 13.719 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 19.510576486587524
Epoch: 30, Steps: 34 | Train Loss: 0.774 Vali Loss: 10.164 Vali Acc: 0.798 Test Loss: 10.164 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 21.709562063217163
Epoch: 31, Steps: 34 | Train Loss: 0.298 Vali Loss: 6.672 Vali Acc: 0.809 Test Loss: 6.672 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 22.27836322784424
Epoch: 32, Steps: 34 | Train Loss: 0.143 Vali Loss: 17.192 Vali Acc: 0.763 Test Loss: 17.192 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 23.625279188156128
Epoch: 33, Steps: 34 | Train Loss: 0.300 Vali Loss: 12.442 Vali Acc: 0.769 Test Loss: 12.442 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 24.049175024032593
Epoch: 34, Steps: 34 | Train Loss: 0.576 Vali Loss: 13.781 Vali Acc: 0.717 Test Loss: 13.781 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 23.714277505874634
Epoch: 35, Steps: 34 | Train Loss: 3.554 Vali Loss: 14.466 Vali Acc: 0.659 Test Loss: 14.466 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 21.479878664016724
Epoch: 36, Steps: 34 | Train Loss: 2.361 Vali Loss: 19.688 Vali Acc: 0.711 Test Loss: 19.688 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7784375
model size : 32.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.46965003013611
Epoch: 1, Steps: 34 | Train Loss: 5.530 Vali Loss: 10.095 Vali Acc: 0.179 Test Loss: 10.095 Test Acc: 0.179
Validation loss decreased (inf --> -0.179090).  Saving model ...
Epoch: 2 cost time: 20.15910053253174
Epoch: 2, Steps: 34 | Train Loss: 11.313 Vali Loss: 12.390 Vali Acc: 0.329 Test Loss: 12.390 Test Acc: 0.329
Validation loss decreased (-0.179090 --> -0.329356).  Saving model ...
Epoch: 3 cost time: 17.470781564712524
Epoch: 3, Steps: 34 | Train Loss: 13.016 Vali Loss: 9.886 Vali Acc: 0.457 Test Loss: 9.886 Test Acc: 0.457
Validation loss decreased (-0.329356 --> -0.456549).  Saving model ...
Epoch: 4 cost time: 19.98379397392273
Epoch: 4, Steps: 34 | Train Loss: 9.455 Vali Loss: 15.260 Vali Acc: 0.428 Test Loss: 15.260 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.66417670249939
Epoch: 5, Steps: 34 | Train Loss: 6.635 Vali Loss: 4.868 Vali Acc: 0.659 Test Loss: 4.868 Test Acc: 0.659
Validation loss decreased (-0.456549 --> -0.658911).  Saving model ...
Epoch: 6 cost time: 20.94030213356018
Epoch: 6, Steps: 34 | Train Loss: 4.770 Vali Loss: 9.121 Vali Acc: 0.671 Test Loss: 9.121 Test Acc: 0.671
Validation loss decreased (-0.658911 --> -0.670429).  Saving model ...
Epoch: 7 cost time: 20.578775882720947
Epoch: 7, Steps: 34 | Train Loss: 2.735 Vali Loss: 7.970 Vali Acc: 0.630 Test Loss: 7.970 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.76121234893799
Epoch: 8, Steps: 34 | Train Loss: 2.787 Vali Loss: 5.952 Vali Acc: 0.688 Test Loss: 5.952 Test Acc: 0.688
Validation loss decreased (-0.670429 --> -0.687802).  Saving model ...
Epoch: 9 cost time: 20.081435918807983
Epoch: 9, Steps: 34 | Train Loss: 1.674 Vali Loss: 7.753 Vali Acc: 0.624 Test Loss: 7.753 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.189778327941895
Epoch: 10, Steps: 34 | Train Loss: 2.217 Vali Loss: 7.119 Vali Acc: 0.694 Test Loss: 7.119 Test Acc: 0.694
Validation loss decreased (-0.687802 --> -0.693570).  Saving model ...
Epoch: 11 cost time: 23.31606125831604
Epoch: 11, Steps: 34 | Train Loss: 1.609 Vali Loss: 6.474 Vali Acc: 0.746 Test Loss: 6.474 Test Acc: 0.746
Validation loss decreased (-0.693570 --> -0.745600).  Saving model ...
Epoch: 12 cost time: 24.03680729866028
Epoch: 12, Steps: 34 | Train Loss: 1.252 Vali Loss: 7.374 Vali Acc: 0.780 Test Loss: 7.374 Test Acc: 0.780
Validation loss decreased (-0.745600 --> -0.780273).  Saving model ...
Epoch: 13 cost time: 20.809316635131836
Epoch: 13, Steps: 34 | Train Loss: 0.529 Vali Loss: 10.155 Vali Acc: 0.734 Test Loss: 10.155 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.736067056655884
Epoch: 14, Steps: 34 | Train Loss: 1.004 Vali Loss: 7.166 Vali Acc: 0.769 Test Loss: 7.166 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.694008827209473
Epoch: 15, Steps: 34 | Train Loss: 0.863 Vali Loss: 7.323 Vali Acc: 0.786 Test Loss: 7.323 Test Acc: 0.786
Validation loss decreased (-0.780273 --> -0.786054).  Saving model ...
Epoch: 16 cost time: 21.556463956832886
Epoch: 16, Steps: 34 | Train Loss: 0.780 Vali Loss: 7.753 Vali Acc: 0.775 Test Loss: 7.753 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.468696355819702
Epoch: 17, Steps: 34 | Train Loss: 1.007 Vali Loss: 10.880 Vali Acc: 0.711 Test Loss: 10.880 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.17367911338806
Epoch: 18, Steps: 34 | Train Loss: 0.981 Vali Loss: 7.781 Vali Acc: 0.711 Test Loss: 7.781 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 19.31361174583435
Epoch: 19, Steps: 34 | Train Loss: 0.851 Vali Loss: 10.493 Vali Acc: 0.723 Test Loss: 10.493 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.614481449127197
Epoch: 20, Steps: 34 | Train Loss: 0.844 Vali Loss: 6.514 Vali Acc: 0.798 Test Loss: 6.514 Test Acc: 0.798
Validation loss decreased (-0.786054 --> -0.797623).  Saving model ...
Epoch: 21 cost time: 19.23481273651123
Epoch: 21, Steps: 34 | Train Loss: 0.485 Vali Loss: 9.019 Vali Acc: 0.780 Test Loss: 9.019 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 22.2973575592041
Epoch: 22, Steps: 34 | Train Loss: 1.322 Vali Loss: 12.026 Vali Acc: 0.751 Test Loss: 12.026 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 18.341431140899658
Epoch: 23, Steps: 34 | Train Loss: 1.498 Vali Loss: 10.747 Vali Acc: 0.728 Test Loss: 10.747 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 21.828922033309937
Epoch: 24, Steps: 34 | Train Loss: 1.160 Vali Loss: 7.445 Vali Acc: 0.734 Test Loss: 7.445 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 19.20020842552185
Epoch: 25, Steps: 34 | Train Loss: 1.223 Vali Loss: 15.277 Vali Acc: 0.740 Test Loss: 15.277 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 21.71072244644165
Epoch: 26, Steps: 34 | Train Loss: 0.227 Vali Loss: 12.364 Vali Acc: 0.740 Test Loss: 12.364 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 20.08873677253723
Epoch: 27, Steps: 34 | Train Loss: 2.168 Vali Loss: 5.549 Vali Acc: 0.786 Test Loss: 5.549 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 23.65792202949524
Epoch: 28, Steps: 34 | Train Loss: 0.498 Vali Loss: 7.901 Vali Acc: 0.757 Test Loss: 7.901 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 21.258316040039062
Epoch: 29, Steps: 34 | Train Loss: 1.098 Vali Loss: 15.815 Vali Acc: 0.751 Test Loss: 15.815 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 23.70907235145569
Epoch: 30, Steps: 34 | Train Loss: 0.723 Vali Loss: 17.445 Vali Acc: 0.763 Test Loss: 17.445 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 7781687
model size : 32.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.505595684051514
Epoch: 1, Steps: 34 | Train Loss: 6.184 Vali Loss: 9.043 Vali Acc: 0.225 Test Loss: 9.043 Test Acc: 0.225
Validation loss decreased (inf --> -0.225343).  Saving model ...
Epoch: 2 cost time: 20.640807151794434
Epoch: 2, Steps: 34 | Train Loss: 8.429 Vali Loss: 9.816 Vali Acc: 0.410 Test Loss: 9.816 Test Acc: 0.410
Validation loss decreased (-0.225343 --> -0.410306).  Saving model ...
Epoch: 3 cost time: 17.645467519760132
Epoch: 3, Steps: 34 | Train Loss: 12.286 Vali Loss: 12.468 Vali Acc: 0.520 Test Loss: 12.468 Test Acc: 0.520
Validation loss decreased (-0.410306 --> -0.520107).  Saving model ...
Epoch: 4 cost time: 19.654157876968384
Epoch: 4, Steps: 34 | Train Loss: 12.488 Vali Loss: 33.416 Vali Acc: 0.283 Test Loss: 33.416 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.306031703948975
Epoch: 5, Steps: 34 | Train Loss: 11.766 Vali Loss: 15.896 Vali Acc: 0.445 Test Loss: 15.896 Test Acc: 0.445
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.37186622619629
Epoch: 6, Steps: 34 | Train Loss: 11.369 Vali Loss: 9.713 Vali Acc: 0.676 Test Loss: 9.713 Test Acc: 0.676
Validation loss decreased (-0.520107 --> -0.676203).  Saving model ...
Epoch: 7 cost time: 19.074873685836792
Epoch: 7, Steps: 34 | Train Loss: 6.562 Vali Loss: 8.222 Vali Acc: 0.618 Test Loss: 8.222 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.083911418914795
Epoch: 8, Steps: 34 | Train Loss: 3.871 Vali Loss: 9.280 Vali Acc: 0.595 Test Loss: 9.280 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.037678003311157
Epoch: 9, Steps: 34 | Train Loss: 3.646 Vali Loss: 10.580 Vali Acc: 0.665 Test Loss: 10.580 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.802649974822998
Epoch: 10, Steps: 34 | Train Loss: 1.445 Vali Loss: 7.800 Vali Acc: 0.769 Test Loss: 7.800 Test Acc: 0.769
Validation loss decreased (-0.676203 --> -0.768708).  Saving model ...
Epoch: 11 cost time: 19.203967571258545
Epoch: 11, Steps: 34 | Train Loss: 2.137 Vali Loss: 9.986 Vali Acc: 0.740 Test Loss: 9.986 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.105326175689697
Epoch: 12, Steps: 34 | Train Loss: 0.559 Vali Loss: 7.892 Vali Acc: 0.769 Test Loss: 7.892 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.42337417602539
Epoch: 13, Steps: 34 | Train Loss: 2.839 Vali Loss: 5.285 Vali Acc: 0.821 Test Loss: 5.285 Test Acc: 0.821
Validation loss decreased (-0.768708 --> -0.820756).  Saving model ...
Epoch: 14 cost time: 19.82087731361389
Epoch: 14, Steps: 34 | Train Loss: 0.745 Vali Loss: 4.412 Vali Acc: 0.809 Test Loss: 4.412 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.140857696533203
Epoch: 15, Steps: 34 | Train Loss: 2.111 Vali Loss: 4.519 Vali Acc: 0.844 Test Loss: 4.519 Test Acc: 0.844
Validation loss decreased (-0.820756 --> -0.843885).  Saving model ...
Epoch: 16 cost time: 20.85021448135376
Epoch: 16, Steps: 34 | Train Loss: 0.511 Vali Loss: 8.853 Vali Acc: 0.792 Test Loss: 8.853 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.74660348892212
Epoch: 17, Steps: 34 | Train Loss: 0.602 Vali Loss: 32.845 Vali Acc: 0.480 Test Loss: 32.845 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.09665036201477
Epoch: 18, Steps: 34 | Train Loss: 1.702 Vali Loss: 11.911 Vali Acc: 0.717 Test Loss: 11.911 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 17.420010089874268
Epoch: 19, Steps: 34 | Train Loss: 1.304 Vali Loss: 7.000 Vali Acc: 0.786 Test Loss: 7.000 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 19.45128107070923
Epoch: 20, Steps: 34 | Train Loss: 1.225 Vali Loss: 9.058 Vali Acc: 0.740 Test Loss: 9.058 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 20.114949703216553
Epoch: 21, Steps: 34 | Train Loss: 0.524 Vali Loss: 7.150 Vali Acc: 0.821 Test Loss: 7.150 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 18.752872228622437
Epoch: 22, Steps: 34 | Train Loss: 1.084 Vali Loss: 6.736 Vali Acc: 0.803 Test Loss: 6.736 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 19.83956265449524
Epoch: 23, Steps: 34 | Train Loss: 0.703 Vali Loss: 9.248 Vali Acc: 0.746 Test Loss: 9.248 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 17.938187837600708
Epoch: 24, Steps: 34 | Train Loss: 0.009 Vali Loss: 8.888 Vali Acc: 0.798 Test Loss: 8.888 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 19.91897988319397
Epoch: 25, Steps: 34 | Train Loss: 0.504 Vali Loss: 7.441 Vali Acc: 0.746 Test Loss: 7.441 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6868663
model size : 28.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.622960090637207
Epoch: 1, Steps: 34 | Train Loss: 4.450 Vali Loss: 6.938 Vali Acc: 0.301 Test Loss: 6.938 Test Acc: 0.301
Validation loss decreased (inf --> -0.300509).  Saving model ...
Epoch: 2 cost time: 19.405638933181763
Epoch: 2, Steps: 34 | Train Loss: 6.526 Vali Loss: 11.711 Vali Acc: 0.266 Test Loss: 11.711 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.487065076828003
Epoch: 3, Steps: 34 | Train Loss: 7.311 Vali Loss: 13.429 Vali Acc: 0.260 Test Loss: 13.429 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.905301570892334
Epoch: 4, Steps: 34 | Train Loss: 9.029 Vali Loss: 12.653 Vali Acc: 0.480 Test Loss: 12.653 Test Acc: 0.480
Validation loss decreased (-0.300509 --> -0.479642).  Saving model ...
Epoch: 5 cost time: 22.01197838783264
Epoch: 5, Steps: 34 | Train Loss: 7.052 Vali Loss: 8.789 Vali Acc: 0.543 Test Loss: 8.789 Test Acc: 0.543
Validation loss decreased (-0.479642 --> -0.543265).  Saving model ...
Epoch: 6 cost time: 19.583590507507324
Epoch: 6, Steps: 34 | Train Loss: 2.728 Vali Loss: 9.933 Vali Acc: 0.630 Test Loss: 9.933 Test Acc: 0.630
Validation loss decreased (-0.543265 --> -0.629958).  Saving model ...
Epoch: 7 cost time: 21.923970222473145
Epoch: 7, Steps: 34 | Train Loss: 2.943 Vali Loss: 9.158 Vali Acc: 0.624 Test Loss: 9.158 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.41842031478882
Epoch: 8, Steps: 34 | Train Loss: 3.826 Vali Loss: 10.389 Vali Acc: 0.595 Test Loss: 10.389 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.46170711517334
Epoch: 9, Steps: 34 | Train Loss: 2.037 Vali Loss: 22.291 Vali Acc: 0.566 Test Loss: 22.291 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.974361896514893
Epoch: 10, Steps: 34 | Train Loss: 2.612 Vali Loss: 4.294 Vali Acc: 0.780 Test Loss: 4.294 Test Acc: 0.780
Validation loss decreased (-0.629958 --> -0.780304).  Saving model ...
Epoch: 11 cost time: 17.696335554122925
Epoch: 11, Steps: 34 | Train Loss: 0.828 Vali Loss: 9.865 Vali Acc: 0.728 Test Loss: 9.865 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.514434576034546
Epoch: 12, Steps: 34 | Train Loss: 1.433 Vali Loss: 12.347 Vali Acc: 0.723 Test Loss: 12.347 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.344927072525024
Epoch: 13, Steps: 34 | Train Loss: 0.950 Vali Loss: 5.079 Vali Acc: 0.740 Test Loss: 5.079 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.84427523612976
Epoch: 14, Steps: 34 | Train Loss: 0.291 Vali Loss: 7.025 Vali Acc: 0.798 Test Loss: 7.025 Test Acc: 0.798
Validation loss decreased (-0.780304 --> -0.797618).  Saving model ...
Epoch: 15 cost time: 17.08747959136963
Epoch: 15, Steps: 34 | Train Loss: 2.286 Vali Loss: 19.415 Vali Acc: 0.676 Test Loss: 19.415 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.003543376922607
Epoch: 16, Steps: 34 | Train Loss: 4.626 Vali Loss: 8.356 Vali Acc: 0.746 Test Loss: 8.356 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.874260425567627
Epoch: 17, Steps: 34 | Train Loss: 0.777 Vali Loss: 15.195 Vali Acc: 0.682 Test Loss: 15.195 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.659857749938965
Epoch: 18, Steps: 34 | Train Loss: 1.704 Vali Loss: 12.041 Vali Acc: 0.699 Test Loss: 12.041 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 17.82818913459778
Epoch: 19, Steps: 34 | Train Loss: 1.205 Vali Loss: 16.217 Vali Acc: 0.757 Test Loss: 16.217 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 19.047853708267212
Epoch: 20, Steps: 34 | Train Loss: 1.370 Vali Loss: 6.964 Vali Acc: 0.792 Test Loss: 6.964 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 19.580273628234863
Epoch: 21, Steps: 34 | Train Loss: 0.942 Vali Loss: 7.285 Vali Acc: 0.827 Test Loss: 7.285 Test Acc: 0.827
Validation loss decreased (-0.797618 --> -0.826517).  Saving model ...
Epoch: 22 cost time: 20.107970237731934
Epoch: 22, Steps: 34 | Train Loss: 0.532 Vali Loss: 10.252 Vali Acc: 0.809 Test Loss: 10.252 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 20.184691190719604
Epoch: 23, Steps: 34 | Train Loss: 1.592 Vali Loss: 10.910 Vali Acc: 0.798 Test Loss: 10.910 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 20.850690841674805
Epoch: 24, Steps: 34 | Train Loss: 0.985 Vali Loss: 8.990 Vali Acc: 0.792 Test Loss: 8.990 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.681135177612305
Epoch: 25, Steps: 34 | Train Loss: 0.920 Vali Loss: 5.478 Vali Acc: 0.815 Test Loss: 5.478 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 22.01561737060547
Epoch: 26, Steps: 34 | Train Loss: 0.943 Vali Loss: 13.874 Vali Acc: 0.717 Test Loss: 13.874 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 19.671161651611328
Epoch: 27, Steps: 34 | Train Loss: 1.130 Vali Loss: 7.431 Vali Acc: 0.803 Test Loss: 7.431 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 17.85726284980774
Epoch: 28, Steps: 34 | Train Loss: 0.703 Vali Loss: 8.024 Vali Acc: 0.827 Test Loss: 8.024 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 19.80311417579651
Epoch: 29, Steps: 34 | Train Loss: 0.433 Vali Loss: 15.111 Vali Acc: 0.705 Test Loss: 15.111 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 18.64795684814453
Epoch: 30, Steps: 34 | Train Loss: 0.595 Vali Loss: 12.934 Vali Acc: 0.786 Test Loss: 12.934 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 19.2655189037323
Epoch: 31, Steps: 34 | Train Loss: 0.616 Vali Loss: 10.729 Vali Acc: 0.809 Test Loss: 10.729 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 6865975
model size : 28.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.383859872817993
Epoch: 1, Steps: 34 | Train Loss: 3.264 Vali Loss: 6.275 Vali Acc: 0.277 Test Loss: 6.275 Test Acc: 0.277
Validation loss decreased (inf --> -0.277394).  Saving model ...
Epoch: 2 cost time: 19.357742071151733
Epoch: 2, Steps: 34 | Train Loss: 10.565 Vali Loss: 12.603 Vali Acc: 0.439 Test Loss: 12.603 Test Acc: 0.439
Validation loss decreased (-0.277394 --> -0.439180).  Saving model ...
Epoch: 3 cost time: 13.485860347747803
Epoch: 3, Steps: 34 | Train Loss: 12.861 Vali Loss: 19.647 Vali Acc: 0.329 Test Loss: 19.647 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.484973192214966
Epoch: 4, Steps: 34 | Train Loss: 6.943 Vali Loss: 9.720 Vali Acc: 0.566 Test Loss: 9.720 Test Acc: 0.566
Validation loss decreased (-0.439180 --> -0.566377).  Saving model ...
Epoch: 5 cost time: 19.125401735305786
Epoch: 5, Steps: 34 | Train Loss: 7.457 Vali Loss: 9.726 Vali Acc: 0.682 Test Loss: 9.726 Test Acc: 0.682
Validation loss decreased (-0.566377 --> -0.681984).  Saving model ...
Epoch: 6 cost time: 19.91425585746765
Epoch: 6, Steps: 34 | Train Loss: 6.555 Vali Loss: 9.790 Vali Acc: 0.665 Test Loss: 9.790 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.15700674057007
Epoch: 7, Steps: 34 | Train Loss: 4.248 Vali Loss: 7.783 Vali Acc: 0.717 Test Loss: 7.783 Test Acc: 0.717
Validation loss decreased (-0.681984 --> -0.716685).  Saving model ...
Epoch: 8 cost time: 22.004223346710205
Epoch: 8, Steps: 34 | Train Loss: 10.942 Vali Loss: 20.953 Vali Acc: 0.630 Test Loss: 20.953 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.917798280715942
Epoch: 9, Steps: 34 | Train Loss: 5.052 Vali Loss: 12.638 Vali Acc: 0.728 Test Loss: 12.638 Test Acc: 0.728
Validation loss decreased (-0.716685 --> -0.728197).  Saving model ...
Epoch: 10 cost time: 22.228214740753174
Epoch: 10, Steps: 34 | Train Loss: 4.154 Vali Loss: 15.283 Vali Acc: 0.630 Test Loss: 15.283 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.97419571876526
Epoch: 11, Steps: 34 | Train Loss: 2.124 Vali Loss: 9.525 Vali Acc: 0.711 Test Loss: 9.525 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.559805870056152
Epoch: 12, Steps: 34 | Train Loss: 2.354 Vali Loss: 20.110 Vali Acc: 0.653 Test Loss: 20.110 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.176220178604126
Epoch: 13, Steps: 34 | Train Loss: 1.878 Vali Loss: 10.976 Vali Acc: 0.723 Test Loss: 10.976 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.714511156082153
Epoch: 14, Steps: 34 | Train Loss: 0.624 Vali Loss: 14.853 Vali Acc: 0.746 Test Loss: 14.853 Test Acc: 0.746
Validation loss decreased (-0.728197 --> -0.745516).  Saving model ...
Epoch: 15 cost time: 17.80111026763916
Epoch: 15, Steps: 34 | Train Loss: 2.036 Vali Loss: 10.631 Vali Acc: 0.798 Test Loss: 10.631 Test Acc: 0.798
Validation loss decreased (-0.745516 --> -0.797582).  Saving model ...
Epoch: 16 cost time: 20.227131128311157
Epoch: 16, Steps: 34 | Train Loss: 0.264 Vali Loss: 7.046 Vali Acc: 0.792 Test Loss: 7.046 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.729809284210205
Epoch: 17, Steps: 34 | Train Loss: 0.152 Vali Loss: 7.133 Vali Acc: 0.809 Test Loss: 7.133 Test Acc: 0.809
Validation loss decreased (-0.797582 --> -0.809177).  Saving model ...
Epoch: 18 cost time: 19.638994932174683
Epoch: 18, Steps: 34 | Train Loss: 0.281 Vali Loss: 6.080 Vali Acc: 0.803 Test Loss: 6.080 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 18.31008219718933
Epoch: 19, Steps: 34 | Train Loss: 0.168 Vali Loss: 7.212 Vali Acc: 0.815 Test Loss: 7.212 Test Acc: 0.815
Validation loss decreased (-0.809177 --> -0.814957).  Saving model ...
Epoch: 20 cost time: 20.405590772628784
Epoch: 20, Steps: 34 | Train Loss: 1.582 Vali Loss: 11.558 Vali Acc: 0.775 Test Loss: 11.558 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 17.866876363754272
Epoch: 21, Steps: 34 | Train Loss: 1.857 Vali Loss: 17.800 Vali Acc: 0.694 Test Loss: 17.800 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.44220995903015
Epoch: 22, Steps: 34 | Train Loss: 3.414 Vali Loss: 10.564 Vali Acc: 0.671 Test Loss: 10.564 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 17.622135877609253
Epoch: 23, Steps: 34 | Train Loss: 1.298 Vali Loss: 31.489 Vali Acc: 0.642 Test Loss: 31.489 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 20.598324060440063
Epoch: 24, Steps: 34 | Train Loss: 3.847 Vali Loss: 10.170 Vali Acc: 0.757 Test Loss: 10.170 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 19.137526988983154
Epoch: 25, Steps: 34 | Train Loss: 1.652 Vali Loss: 20.585 Vali Acc: 0.780 Test Loss: 20.585 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 21.576200008392334
Epoch: 26, Steps: 34 | Train Loss: 1.281 Vali Loss: 15.830 Vali Acc: 0.769 Test Loss: 15.830 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 19.560959815979004
Epoch: 27, Steps: 34 | Train Loss: 1.635 Vali Loss: 20.043 Vali Acc: 0.711 Test Loss: 20.043 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 23.033656358718872
Epoch: 28, Steps: 34 | Train Loss: 0.483 Vali Loss: 9.654 Vali Acc: 0.821 Test Loss: 9.654 Test Acc: 0.821
Validation loss decreased (-0.814957 --> -0.820713).  Saving model ...
Epoch: 29 cost time: 18.965526580810547
Epoch: 29, Steps: 34 | Train Loss: 0.465 Vali Loss: 7.584 Vali Acc: 0.838 Test Loss: 7.584 Test Acc: 0.838
Validation loss decreased (-0.820713 --> -0.838074).  Saving model ...
Epoch: 30 cost time: 18.08164691925049
Epoch: 30, Steps: 34 | Train Loss: 0.104 Vali Loss: 12.642 Vali Acc: 0.717 Test Loss: 12.642 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 18.49716806411743
Epoch: 31, Steps: 34 | Train Loss: 0.674 Vali Loss: 25.176 Vali Acc: 0.653 Test Loss: 25.176 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 20.058691263198853
Epoch: 32, Steps: 34 | Train Loss: 0.153 Vali Loss: 11.982 Vali Acc: 0.769 Test Loss: 11.982 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 17.661567211151123
Epoch: 33, Steps: 34 | Train Loss: 0.159 Vali Loss: 16.626 Vali Acc: 0.792 Test Loss: 16.626 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 19.143141508102417
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 15.842 Vali Acc: 0.780 Test Loss: 15.842 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 18.966904878616333
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 15.425 Vali Acc: 0.780 Test Loss: 15.425 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 19.463930368423462
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 15.413 Vali Acc: 0.780 Test Loss: 15.413 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 16.95057964324951
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 15.408 Vali Acc: 0.780 Test Loss: 15.408 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 15.591854810714722
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 15.408 Vali Acc: 0.780 Test Loss: 15.408 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 17.131421089172363
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 15.408 Vali Acc: 0.780 Test Loss: 15.408 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6863287
model size : 28.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.687602043151855
Epoch: 1, Steps: 34 | Train Loss: 9.910 Vali Loss: 15.900 Vali Acc: 0.324 Test Loss: 15.900 Test Acc: 0.324
Validation loss decreased (inf --> -0.323540).  Saving model ...
Epoch: 2 cost time: 20.66475510597229
Epoch: 2, Steps: 34 | Train Loss: 10.055 Vali Loss: 5.222 Vali Acc: 0.486 Test Loss: 5.222 Test Acc: 0.486
Validation loss decreased (-0.323540 --> -0.485497).  Saving model ...
Epoch: 3 cost time: 20.797821521759033
Epoch: 3, Steps: 34 | Train Loss: 10.701 Vali Loss: 29.091 Vali Acc: 0.162 Test Loss: 29.091 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.995957374572754
Epoch: 4, Steps: 34 | Train Loss: 13.041 Vali Loss: 17.329 Vali Acc: 0.514 Test Loss: 17.329 Test Acc: 0.514
Validation loss decreased (-0.485497 --> -0.514278).  Saving model ...
Epoch: 5 cost time: 20.793163537979126
Epoch: 5, Steps: 34 | Train Loss: 8.601 Vali Loss: 6.092 Vali Acc: 0.613 Test Loss: 6.092 Test Acc: 0.613
Validation loss decreased (-0.514278 --> -0.612656).  Saving model ...
Epoch: 6 cost time: 19.02586555480957
Epoch: 6, Steps: 34 | Train Loss: 5.977 Vali Loss: 8.731 Vali Acc: 0.543 Test Loss: 8.731 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.521671295166016
Epoch: 7, Steps: 34 | Train Loss: 4.009 Vali Loss: 6.457 Vali Acc: 0.618 Test Loss: 6.457 Test Acc: 0.618
Validation loss decreased (-0.612656 --> -0.618433).  Saving model ...
Epoch: 8 cost time: 18.599172830581665
Epoch: 8, Steps: 34 | Train Loss: 3.617 Vali Loss: 12.791 Vali Acc: 0.538 Test Loss: 12.791 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.921058416366577
Epoch: 9, Steps: 34 | Train Loss: 4.239 Vali Loss: 13.843 Vali Acc: 0.659 Test Loss: 13.843 Test Acc: 0.659
Validation loss decreased (-0.618433 --> -0.658821).  Saving model ...
Epoch: 10 cost time: 20.169461011886597
Epoch: 10, Steps: 34 | Train Loss: 1.372 Vali Loss: 8.980 Vali Acc: 0.659 Test Loss: 8.980 Test Acc: 0.659
Validation loss decreased (-0.658821 --> -0.658870).  Saving model ...
Epoch: 11 cost time: 17.160593032836914
Epoch: 11, Steps: 34 | Train Loss: 1.043 Vali Loss: 7.838 Vali Acc: 0.723 Test Loss: 7.838 Test Acc: 0.723
Validation loss decreased (-0.658870 --> -0.722465).  Saving model ...
Epoch: 12 cost time: 18.924774885177612
Epoch: 12, Steps: 34 | Train Loss: 0.777 Vali Loss: 8.737 Vali Acc: 0.705 Test Loss: 8.737 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.439141273498535
Epoch: 13, Steps: 34 | Train Loss: 0.766 Vali Loss: 7.323 Vali Acc: 0.769 Test Loss: 7.323 Test Acc: 0.769
Validation loss decreased (-0.722465 --> -0.768713).  Saving model ...
Epoch: 14 cost time: 19.717419624328613
Epoch: 14, Steps: 34 | Train Loss: 1.897 Vali Loss: 16.967 Vali Acc: 0.607 Test Loss: 16.967 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.685839414596558
Epoch: 15, Steps: 34 | Train Loss: 1.300 Vali Loss: 5.737 Vali Acc: 0.751 Test Loss: 5.737 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 19.482501745224
Epoch: 16, Steps: 34 | Train Loss: 0.605 Vali Loss: 5.108 Vali Acc: 0.775 Test Loss: 5.108 Test Acc: 0.775
Validation loss decreased (-0.768713 --> -0.774515).  Saving model ...
Epoch: 17 cost time: 16.466065883636475
Epoch: 17, Steps: 34 | Train Loss: 0.890 Vali Loss: 3.684 Vali Acc: 0.803 Test Loss: 3.684 Test Acc: 0.803
Validation loss decreased (-0.774515 --> -0.803431).  Saving model ...
Epoch: 18 cost time: 20.11804962158203
Epoch: 18, Steps: 34 | Train Loss: 1.170 Vali Loss: 15.817 Vali Acc: 0.711 Test Loss: 15.817 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.050259828567505
Epoch: 19, Steps: 34 | Train Loss: 0.901 Vali Loss: 7.629 Vali Acc: 0.798 Test Loss: 7.629 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.78419017791748
Epoch: 20, Steps: 34 | Train Loss: 0.228 Vali Loss: 9.190 Vali Acc: 0.775 Test Loss: 9.190 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 18.568508863449097
Epoch: 21, Steps: 34 | Train Loss: 0.476 Vali Loss: 11.861 Vali Acc: 0.717 Test Loss: 11.861 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 21.40468955039978
Epoch: 22, Steps: 34 | Train Loss: 0.486 Vali Loss: 7.362 Vali Acc: 0.746 Test Loss: 7.362 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 19.57310128211975
Epoch: 23, Steps: 34 | Train Loss: 0.851 Vali Loss: 7.020 Vali Acc: 0.775 Test Loss: 7.020 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 18.496903896331787
Epoch: 24, Steps: 34 | Train Loss: 1.490 Vali Loss: 17.049 Vali Acc: 0.734 Test Loss: 17.049 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 18.62633514404297
Epoch: 25, Steps: 34 | Train Loss: 0.974 Vali Loss: 6.165 Vali Acc: 0.786 Test Loss: 6.165 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 17.398501873016357
Epoch: 26, Steps: 34 | Train Loss: 0.865 Vali Loss: 8.933 Vali Acc: 0.821 Test Loss: 8.933 Test Acc: 0.821
Validation loss decreased (-0.803431 --> -0.820720).  Saving model ...
Epoch: 27 cost time: 13.157218933105469
Epoch: 27, Steps: 34 | Train Loss: 1.119 Vali Loss: 10.723 Vali Acc: 0.780 Test Loss: 10.723 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 19.172924995422363
Epoch: 28, Steps: 34 | Train Loss: 0.366 Vali Loss: 6.801 Vali Acc: 0.803 Test Loss: 6.801 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 16.712467670440674
Epoch: 29, Steps: 34 | Train Loss: 1.477 Vali Loss: 16.459 Vali Acc: 0.682 Test Loss: 16.459 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 19.649017095565796
Epoch: 30, Steps: 34 | Train Loss: 1.104 Vali Loss: 11.627 Vali Acc: 0.798 Test Loss: 11.627 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 16.744672775268555
Epoch: 31, Steps: 34 | Train Loss: 0.537 Vali Loss: 15.285 Vali Acc: 0.734 Test Loss: 15.285 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 18.286736249923706
Epoch: 32, Steps: 34 | Train Loss: 0.747 Vali Loss: 12.637 Vali Acc: 0.728 Test Loss: 12.637 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 17.923131942749023
Epoch: 33, Steps: 34 | Train Loss: 0.344 Vali Loss: 9.416 Vali Acc: 0.775 Test Loss: 9.416 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 19.552521228790283
Epoch: 34, Steps: 34 | Train Loss: 0.590 Vali Loss: 24.068 Vali Acc: 0.717 Test Loss: 24.068 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 17.90505290031433
Epoch: 35, Steps: 34 | Train Loss: 0.722 Vali Loss: 13.349 Vali Acc: 0.717 Test Loss: 13.349 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 17.944061279296875
Epoch: 36, Steps: 34 | Train Loss: 0.641 Vali Loss: 18.147 Vali Acc: 0.618 Test Loss: 18.147 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 6860599
model size : 28.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.451473474502563
Epoch: 1, Steps: 34 | Train Loss: 4.908 Vali Loss: 3.903 Vali Acc: 0.428 Test Loss: 3.903 Test Acc: 0.428
Validation loss decreased (inf --> -0.427707).  Saving model ...
Epoch: 2 cost time: 20.134086847305298
Epoch: 2, Steps: 34 | Train Loss: 9.839 Vali Loss: 22.974 Vali Acc: 0.335 Test Loss: 22.974 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.551854848861694
Epoch: 3, Steps: 34 | Train Loss: 11.305 Vali Loss: 7.307 Vali Acc: 0.601 Test Loss: 7.307 Test Acc: 0.601
Validation loss decreased (-0.427707 --> -0.601083).  Saving model ...
Epoch: 4 cost time: 22.150733470916748
Epoch: 4, Steps: 34 | Train Loss: 10.830 Vali Loss: 6.950 Vali Acc: 0.642 Test Loss: 6.950 Test Acc: 0.642
Validation loss decreased (-0.601083 --> -0.641549).  Saving model ...
Epoch: 5 cost time: 20.91860294342041
Epoch: 5, Steps: 34 | Train Loss: 5.127 Vali Loss: 6.695 Vali Acc: 0.618 Test Loss: 6.695 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.915403842926025
Epoch: 6, Steps: 34 | Train Loss: 5.461 Vali Loss: 17.813 Vali Acc: 0.491 Test Loss: 17.813 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.24162745475769
Epoch: 7, Steps: 34 | Train Loss: 7.410 Vali Loss: 9.150 Vali Acc: 0.636 Test Loss: 9.150 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.66399836540222
Epoch: 8, Steps: 34 | Train Loss: 8.940 Vali Loss: 9.135 Vali Acc: 0.578 Test Loss: 9.135 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.537779331207275
Epoch: 9, Steps: 34 | Train Loss: 6.461 Vali Loss: 8.518 Vali Acc: 0.728 Test Loss: 8.518 Test Acc: 0.728
Validation loss decreased (-0.641549 --> -0.728239).  Saving model ...
Epoch: 10 cost time: 19.289260625839233
Epoch: 10, Steps: 34 | Train Loss: 4.101 Vali Loss: 11.048 Vali Acc: 0.740 Test Loss: 11.048 Test Acc: 0.740
Validation loss decreased (-0.728239 --> -0.739774).  Saving model ...
Epoch: 11 cost time: 18.097716808319092
Epoch: 11, Steps: 34 | Train Loss: 2.826 Vali Loss: 14.196 Vali Acc: 0.665 Test Loss: 14.196 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.134824991226196
Epoch: 12, Steps: 34 | Train Loss: 2.051 Vali Loss: 13.592 Vali Acc: 0.682 Test Loss: 13.592 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.742483615875244
Epoch: 13, Steps: 34 | Train Loss: 1.461 Vali Loss: 10.228 Vali Acc: 0.717 Test Loss: 10.228 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.475404977798462
Epoch: 14, Steps: 34 | Train Loss: 2.519 Vali Loss: 9.232 Vali Acc: 0.769 Test Loss: 9.232 Test Acc: 0.769
Validation loss decreased (-0.739774 --> -0.768694).  Saving model ...
Epoch: 15 cost time: 16.777904987335205
Epoch: 15, Steps: 34 | Train Loss: 1.520 Vali Loss: 8.095 Vali Acc: 0.751 Test Loss: 8.095 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.798187732696533
Epoch: 16, Steps: 34 | Train Loss: 1.314 Vali Loss: 13.195 Vali Acc: 0.763 Test Loss: 13.195 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.42765760421753
Epoch: 17, Steps: 34 | Train Loss: 1.637 Vali Loss: 20.692 Vali Acc: 0.676 Test Loss: 20.692 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.234135150909424
Epoch: 18, Steps: 34 | Train Loss: 1.309 Vali Loss: 7.051 Vali Acc: 0.838 Test Loss: 7.051 Test Acc: 0.838
Validation loss decreased (-0.768694 --> -0.838080).  Saving model ...
Epoch: 19 cost time: 16.473652124404907
Epoch: 19, Steps: 34 | Train Loss: 0.231 Vali Loss: 18.270 Vali Acc: 0.740 Test Loss: 18.270 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 20.782464027404785
Epoch: 20, Steps: 34 | Train Loss: 1.142 Vali Loss: 10.418 Vali Acc: 0.728 Test Loss: 10.418 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 18.63518452644348
Epoch: 21, Steps: 34 | Train Loss: 0.622 Vali Loss: 8.430 Vali Acc: 0.827 Test Loss: 8.430 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.553213596343994
Epoch: 22, Steps: 34 | Train Loss: 0.720 Vali Loss: 9.894 Vali Acc: 0.751 Test Loss: 9.894 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 18.354418754577637
Epoch: 23, Steps: 34 | Train Loss: 0.180 Vali Loss: 10.187 Vali Acc: 0.850 Test Loss: 10.187 Test Acc: 0.850
Validation loss decreased (-0.838080 --> -0.849609).  Saving model ...
Epoch: 24 cost time: 18.159594774246216
Epoch: 24, Steps: 34 | Train Loss: 0.710 Vali Loss: 5.953 Vali Acc: 0.844 Test Loss: 5.953 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 18.424445390701294
Epoch: 25, Steps: 34 | Train Loss: 1.901 Vali Loss: 9.400 Vali Acc: 0.775 Test Loss: 9.400 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 18.616881608963013
Epoch: 26, Steps: 34 | Train Loss: 1.075 Vali Loss: 9.263 Vali Acc: 0.832 Test Loss: 9.263 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 12.99722409248352
Epoch: 27, Steps: 34 | Train Loss: 0.600 Vali Loss: 10.838 Vali Acc: 0.815 Test Loss: 10.838 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 18.35114097595215
Epoch: 28, Steps: 34 | Train Loss: 0.294 Vali Loss: 14.753 Vali Acc: 0.740 Test Loss: 14.753 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 16.860767602920532
Epoch: 29, Steps: 34 | Train Loss: 0.391 Vali Loss: 15.529 Vali Acc: 0.832 Test Loss: 15.529 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 18.814067602157593
Epoch: 30, Steps: 34 | Train Loss: 1.262 Vali Loss: 15.356 Vali Acc: 0.792 Test Loss: 15.356 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 17.330458164215088
Epoch: 31, Steps: 34 | Train Loss: 1.415 Vali Loss: 22.846 Vali Acc: 0.705 Test Loss: 22.846 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 18.897714376449585
Epoch: 32, Steps: 34 | Train Loss: 1.433 Vali Loss: 17.137 Vali Acc: 0.827 Test Loss: 17.137 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 16.822203397750854
Epoch: 33, Steps: 34 | Train Loss: 1.246 Vali Loss: 17.033 Vali Acc: 0.763 Test Loss: 17.033 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 6408119
model size : 27.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.448852062225342
Epoch: 1, Steps: 34 | Train Loss: 9.563 Vali Loss: 17.617 Vali Acc: 0.145 Test Loss: 17.617 Test Acc: 0.145
Validation loss decreased (inf --> -0.144333).  Saving model ...
Epoch: 2 cost time: 18.216277360916138
Epoch: 2, Steps: 34 | Train Loss: 9.317 Vali Loss: 12.558 Vali Acc: 0.405 Test Loss: 12.558 Test Acc: 0.405
Validation loss decreased (-0.144333 --> -0.404499).  Saving model ...
Epoch: 3 cost time: 17.349604845046997
Epoch: 3, Steps: 34 | Train Loss: 16.137 Vali Loss: 19.551 Vali Acc: 0.318 Test Loss: 19.551 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.52129817008972
Epoch: 4, Steps: 34 | Train Loss: 9.290 Vali Loss: 10.446 Vali Acc: 0.509 Test Loss: 10.446 Test Acc: 0.509
Validation loss decreased (-0.404499 --> -0.508566).  Saving model ...
Epoch: 5 cost time: 19.737611770629883
Epoch: 5, Steps: 34 | Train Loss: 12.352 Vali Loss: 14.697 Vali Acc: 0.532 Test Loss: 14.697 Test Acc: 0.532
Validation loss decreased (-0.508566 --> -0.531645).  Saving model ...
Epoch: 6 cost time: 19.332053184509277
Epoch: 6, Steps: 34 | Train Loss: 8.448 Vali Loss: 6.926 Vali Acc: 0.653 Test Loss: 6.926 Test Acc: 0.653
Validation loss decreased (-0.531645 --> -0.653110).  Saving model ...
Epoch: 7 cost time: 19.28839921951294
Epoch: 7, Steps: 34 | Train Loss: 4.768 Vali Loss: 17.026 Vali Acc: 0.468 Test Loss: 17.026 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.993215084075928
Epoch: 8, Steps: 34 | Train Loss: 5.507 Vali Loss: 3.964 Vali Acc: 0.844 Test Loss: 3.964 Test Acc: 0.844
Validation loss decreased (-0.653110 --> -0.843891).  Saving model ...
Epoch: 9 cost time: 18.357374668121338
Epoch: 9, Steps: 34 | Train Loss: 3.325 Vali Loss: 13.827 Vali Acc: 0.717 Test Loss: 13.827 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.787240743637085
Epoch: 10, Steps: 34 | Train Loss: 2.709 Vali Loss: 5.445 Vali Acc: 0.780 Test Loss: 5.445 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.144935131072998
Epoch: 11, Steps: 34 | Train Loss: 1.308 Vali Loss: 8.220 Vali Acc: 0.636 Test Loss: 8.220 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.39730453491211
Epoch: 12, Steps: 34 | Train Loss: 1.995 Vali Loss: 20.187 Vali Acc: 0.520 Test Loss: 20.187 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.221729278564453
Epoch: 13, Steps: 34 | Train Loss: 1.983 Vali Loss: 8.803 Vali Acc: 0.734 Test Loss: 8.803 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.786065340042114
Epoch: 14, Steps: 34 | Train Loss: 2.285 Vali Loss: 9.080 Vali Acc: 0.711 Test Loss: 9.080 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.743181467056274
Epoch: 15, Steps: 34 | Train Loss: 0.674 Vali Loss: 11.263 Vali Acc: 0.705 Test Loss: 11.263 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 17.751458406448364
Epoch: 16, Steps: 34 | Train Loss: 0.480 Vali Loss: 7.355 Vali Acc: 0.838 Test Loss: 7.355 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 19.218486309051514
Epoch: 17, Steps: 34 | Train Loss: 0.663 Vali Loss: 5.887 Vali Acc: 0.803 Test Loss: 5.887 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 17.455321311950684
Epoch: 18, Steps: 34 | Train Loss: 0.150 Vali Loss: 20.825 Vali Acc: 0.613 Test Loss: 20.825 Test Acc: 0.613
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6405431
model size : 27.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.766703367233276
Epoch: 1, Steps: 34 | Train Loss: 4.512 Vali Loss: 3.133 Vali Acc: 0.428 Test Loss: 3.133 Test Acc: 0.428
Validation loss decreased (inf --> -0.427714).  Saving model ...
Epoch: 2 cost time: 19.78560733795166
Epoch: 2, Steps: 34 | Train Loss: 8.609 Vali Loss: 4.609 Vali Acc: 0.468 Test Loss: 4.609 Test Acc: 0.468
Validation loss decreased (-0.427714 --> -0.468162).  Saving model ...
Epoch: 3 cost time: 19.92316722869873
Epoch: 3, Steps: 34 | Train Loss: 12.785 Vali Loss: 20.223 Vali Acc: 0.422 Test Loss: 20.223 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.016403198242188
Epoch: 4, Steps: 34 | Train Loss: 17.547 Vali Loss: 12.153 Vali Acc: 0.532 Test Loss: 12.153 Test Acc: 0.532
Validation loss decreased (-0.468162 --> -0.531670).  Saving model ...
Epoch: 5 cost time: 19.687148332595825
Epoch: 5, Steps: 34 | Train Loss: 10.864 Vali Loss: 12.426 Vali Acc: 0.520 Test Loss: 12.426 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.14216375350952
Epoch: 6, Steps: 34 | Train Loss: 12.821 Vali Loss: 2.552 Vali Acc: 0.734 Test Loss: 2.552 Test Acc: 0.734
Validation loss decreased (-0.531670 --> -0.734079).  Saving model ...
Epoch: 7 cost time: 17.346613883972168
Epoch: 7, Steps: 34 | Train Loss: 4.123 Vali Loss: 8.961 Vali Acc: 0.636 Test Loss: 8.961 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.83407759666443
Epoch: 8, Steps: 34 | Train Loss: 3.697 Vali Loss: 6.093 Vali Acc: 0.757 Test Loss: 6.093 Test Acc: 0.757
Validation loss decreased (-0.734079 --> -0.757165).  Saving model ...
Epoch: 9 cost time: 17.975260257720947
Epoch: 9, Steps: 34 | Train Loss: 3.689 Vali Loss: 7.117 Vali Acc: 0.717 Test Loss: 7.117 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.537539958953857
Epoch: 10, Steps: 34 | Train Loss: 2.637 Vali Loss: 12.200 Vali Acc: 0.682 Test Loss: 12.200 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.132235765457153
Epoch: 11, Steps: 34 | Train Loss: 2.811 Vali Loss: 8.944 Vali Acc: 0.699 Test Loss: 8.944 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.53313398361206
Epoch: 12, Steps: 34 | Train Loss: 2.548 Vali Loss: 11.258 Vali Acc: 0.705 Test Loss: 11.258 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.695103883743286
Epoch: 13, Steps: 34 | Train Loss: 1.254 Vali Loss: 7.789 Vali Acc: 0.809 Test Loss: 7.789 Test Acc: 0.809
Validation loss decreased (-0.757165 --> -0.809171).  Saving model ...
Epoch: 14 cost time: 17.723515510559082
Epoch: 14, Steps: 34 | Train Loss: 0.915 Vali Loss: 6.875 Vali Acc: 0.798 Test Loss: 6.875 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.421512603759766
Epoch: 15, Steps: 34 | Train Loss: 0.746 Vali Loss: 9.244 Vali Acc: 0.751 Test Loss: 9.244 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.51995325088501
Epoch: 16, Steps: 34 | Train Loss: 0.746 Vali Loss: 15.487 Vali Acc: 0.618 Test Loss: 15.487 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.926000118255615
Epoch: 17, Steps: 34 | Train Loss: 0.945 Vali Loss: 7.872 Vali Acc: 0.786 Test Loss: 7.872 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.89711618423462
Epoch: 18, Steps: 34 | Train Loss: 0.425 Vali Loss: 12.188 Vali Acc: 0.780 Test Loss: 12.188 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.003841876983643
Epoch: 19, Steps: 34 | Train Loss: 0.766 Vali Loss: 11.398 Vali Acc: 0.763 Test Loss: 11.398 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 20.11155414581299
Epoch: 20, Steps: 34 | Train Loss: 0.776 Vali Loss: 10.918 Vali Acc: 0.717 Test Loss: 10.918 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 20.77402091026306
Epoch: 21, Steps: 34 | Train Loss: 1.066 Vali Loss: 7.018 Vali Acc: 0.809 Test Loss: 7.018 Test Acc: 0.809
Validation loss decreased (-0.809171 --> -0.809178).  Saving model ...
Epoch: 22 cost time: 18.695443868637085
Epoch: 22, Steps: 34 | Train Loss: 0.926 Vali Loss: 8.542 Vali Acc: 0.792 Test Loss: 8.542 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 20.19928789138794
Epoch: 23, Steps: 34 | Train Loss: 1.264 Vali Loss: 10.386 Vali Acc: 0.780 Test Loss: 10.386 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 16.183615922927856
Epoch: 24, Steps: 34 | Train Loss: 0.695 Vali Loss: 9.203 Vali Acc: 0.786 Test Loss: 9.203 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 19.141432285308838
Epoch: 25, Steps: 34 | Train Loss: 0.571 Vali Loss: 15.194 Vali Acc: 0.792 Test Loss: 15.194 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 16.824264526367188
Epoch: 26, Steps: 34 | Train Loss: 0.230 Vali Loss: 14.175 Vali Acc: 0.751 Test Loss: 14.175 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 18.983548402786255
Epoch: 27, Steps: 34 | Train Loss: 1.202 Vali Loss: 19.527 Vali Acc: 0.676 Test Loss: 19.527 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 17.328980207443237
Epoch: 28, Steps: 34 | Train Loss: 0.936 Vali Loss: 13.780 Vali Acc: 0.780 Test Loss: 13.780 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 18.9930636882782
Epoch: 29, Steps: 34 | Train Loss: 2.562 Vali Loss: 15.370 Vali Acc: 0.723 Test Loss: 15.370 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 17.50105881690979
Epoch: 30, Steps: 34 | Train Loss: 0.650 Vali Loss: 13.595 Vali Acc: 0.769 Test Loss: 13.595 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 18.130241632461548
Epoch: 31, Steps: 34 | Train Loss: 2.860 Vali Loss: 10.965 Vali Acc: 0.723 Test Loss: 10.965 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 6402743
model size : 27.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.772939920425415
Epoch: 1, Steps: 34 | Train Loss: 5.112 Vali Loss: 6.817 Vali Acc: 0.399 Test Loss: 6.817 Test Acc: 0.399
Validation loss decreased (inf --> -0.398776).  Saving model ...
Epoch: 2 cost time: 17.977781057357788
Epoch: 2, Steps: 34 | Train Loss: 7.380 Vali Loss: 4.774 Vali Acc: 0.491 Test Loss: 4.774 Test Acc: 0.491
Validation loss decreased (-0.398776 --> -0.491282).  Saving model ...
Epoch: 3 cost time: 17.91801404953003
Epoch: 3, Steps: 34 | Train Loss: 9.265 Vali Loss: 7.840 Vali Acc: 0.514 Test Loss: 7.840 Test Acc: 0.514
Validation loss decreased (-0.491282 --> -0.514372).  Saving model ...
Epoch: 4 cost time: 18.111063957214355
Epoch: 4, Steps: 34 | Train Loss: 8.817 Vali Loss: 10.148 Vali Acc: 0.584 Test Loss: 10.148 Test Acc: 0.584
Validation loss decreased (-0.514372 --> -0.583714).  Saving model ...
Epoch: 5 cost time: 20.215355157852173
Epoch: 5, Steps: 34 | Train Loss: 8.904 Vali Loss: 9.997 Vali Acc: 0.514 Test Loss: 9.997 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.651824474334717
Epoch: 6, Steps: 34 | Train Loss: 12.279 Vali Loss: 19.250 Vali Acc: 0.462 Test Loss: 19.250 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.998858213424683
Epoch: 7, Steps: 34 | Train Loss: 8.961 Vali Loss: 58.516 Vali Acc: 0.370 Test Loss: 58.516 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.751728296279907
Epoch: 8, Steps: 34 | Train Loss: 8.794 Vali Loss: 7.837 Vali Acc: 0.711 Test Loss: 7.837 Test Acc: 0.711
Validation loss decreased (-0.583714 --> -0.710904).  Saving model ...
Epoch: 9 cost time: 17.88711714744568
Epoch: 9, Steps: 34 | Train Loss: 3.849 Vali Loss: 6.916 Vali Acc: 0.711 Test Loss: 6.916 Test Acc: 0.711
Validation loss decreased (-0.710904 --> -0.710913).  Saving model ...
Epoch: 10 cost time: 17.65278959274292
Epoch: 10, Steps: 34 | Train Loss: 5.456 Vali Loss: 20.676 Vali Acc: 0.607 Test Loss: 20.676 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.01653790473938
Epoch: 11, Steps: 34 | Train Loss: 3.232 Vali Loss: 13.445 Vali Acc: 0.630 Test Loss: 13.445 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.62998390197754
Epoch: 12, Steps: 34 | Train Loss: 2.035 Vali Loss: 9.620 Vali Acc: 0.757 Test Loss: 9.620 Test Acc: 0.757
Validation loss decreased (-0.710913 --> -0.757129).  Saving model ...
Epoch: 13 cost time: 18.166714191436768
Epoch: 13, Steps: 34 | Train Loss: 2.369 Vali Loss: 12.809 Vali Acc: 0.740 Test Loss: 12.809 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.846977472305298
Epoch: 14, Steps: 34 | Train Loss: 1.151 Vali Loss: 6.026 Vali Acc: 0.832 Test Loss: 6.026 Test Acc: 0.832
Validation loss decreased (-0.757129 --> -0.832310).  Saving model ...
Epoch: 15 cost time: 18.130653381347656
Epoch: 15, Steps: 34 | Train Loss: 0.190 Vali Loss: 5.001 Vali Acc: 0.855 Test Loss: 5.001 Test Acc: 0.855
Validation loss decreased (-0.832310 --> -0.855441).  Saving model ...
Epoch: 16 cost time: 19.755483388900757
Epoch: 16, Steps: 34 | Train Loss: 1.966 Vali Loss: 9.889 Vali Acc: 0.775 Test Loss: 9.889 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.097518920898438
Epoch: 17, Steps: 34 | Train Loss: 1.318 Vali Loss: 13.629 Vali Acc: 0.757 Test Loss: 13.629 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.715768575668335
Epoch: 18, Steps: 34 | Train Loss: 1.196 Vali Loss: 17.914 Vali Acc: 0.734 Test Loss: 17.914 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 18.9351589679718
Epoch: 19, Steps: 34 | Train Loss: 1.102 Vali Loss: 8.198 Vali Acc: 0.786 Test Loss: 8.198 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 18.91931176185608
Epoch: 20, Steps: 34 | Train Loss: 4.838 Vali Loss: 10.439 Vali Acc: 0.769 Test Loss: 10.439 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 13.752882242202759
Epoch: 21, Steps: 34 | Train Loss: 0.383 Vali Loss: 7.038 Vali Acc: 0.815 Test Loss: 7.038 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.522747039794922
Epoch: 22, Steps: 34 | Train Loss: 1.924 Vali Loss: 15.651 Vali Acc: 0.734 Test Loss: 15.651 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 18.29024362564087
Epoch: 23, Steps: 34 | Train Loss: 2.188 Vali Loss: 11.175 Vali Acc: 0.780 Test Loss: 11.175 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 22.254905939102173
Epoch: 24, Steps: 34 | Train Loss: 0.672 Vali Loss: 10.037 Vali Acc: 0.803 Test Loss: 10.037 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 20.27162480354309
Epoch: 25, Steps: 34 | Train Loss: 1.213 Vali Loss: 11.196 Vali Acc: 0.815 Test Loss: 11.196 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 6400055
model size : 27.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.153088808059692
Epoch: 1, Steps: 34 | Train Loss: 5.211 Vali Loss: 5.407 Vali Acc: 0.416 Test Loss: 5.407 Test Acc: 0.416
Validation loss decreased (inf --> -0.416131).  Saving model ...
Epoch: 2 cost time: 19.075841903686523
Epoch: 2, Steps: 34 | Train Loss: 8.264 Vali Loss: 6.187 Vali Acc: 0.399 Test Loss: 6.187 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.033037185668945
Epoch: 3, Steps: 34 | Train Loss: 9.133 Vali Loss: 18.256 Vali Acc: 0.457 Test Loss: 18.256 Test Acc: 0.457
Validation loss decreased (-0.416131 --> -0.456465).  Saving model ...
Epoch: 4 cost time: 18.639789819717407
Epoch: 4, Steps: 34 | Train Loss: 10.694 Vali Loss: 10.905 Vali Acc: 0.503 Test Loss: 10.905 Test Acc: 0.503
Validation loss decreased (-0.456465 --> -0.502781).  Saving model ...
Epoch: 5 cost time: 18.454378128051758
Epoch: 5, Steps: 34 | Train Loss: 12.890 Vali Loss: 16.670 Vali Acc: 0.289 Test Loss: 16.670 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.425866842269897
Epoch: 6, Steps: 34 | Train Loss: 6.313 Vali Loss: 8.871 Vali Acc: 0.590 Test Loss: 8.871 Test Acc: 0.590
Validation loss decreased (-0.502781 --> -0.589507).  Saving model ...
Epoch: 7 cost time: 18.68345069885254
Epoch: 7, Steps: 34 | Train Loss: 6.190 Vali Loss: 13.032 Vali Acc: 0.555 Test Loss: 13.032 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.843003511428833
Epoch: 8, Steps: 34 | Train Loss: 4.418 Vali Loss: 28.426 Vali Acc: 0.457 Test Loss: 28.426 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.480150938034058
Epoch: 9, Steps: 34 | Train Loss: 6.507 Vali Loss: 13.607 Vali Acc: 0.607 Test Loss: 13.607 Test Acc: 0.607
Validation loss decreased (-0.589507 --> -0.606800).  Saving model ...
Epoch: 10 cost time: 17.533457279205322
Epoch: 10, Steps: 34 | Train Loss: 3.927 Vali Loss: 20.814 Vali Acc: 0.624 Test Loss: 20.814 Test Acc: 0.624
Validation loss decreased (-0.606800 --> -0.624069).  Saving model ...
Epoch: 11 cost time: 19.32689070701599
Epoch: 11, Steps: 34 | Train Loss: 4.687 Vali Loss: 5.382 Vali Acc: 0.786 Test Loss: 5.382 Test Acc: 0.786
Validation loss decreased (-0.624069 --> -0.786073).  Saving model ...
Epoch: 12 cost time: 18.68202495574951
Epoch: 12, Steps: 34 | Train Loss: 2.302 Vali Loss: 19.018 Vali Acc: 0.723 Test Loss: 19.018 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.646743059158325
Epoch: 13, Steps: 34 | Train Loss: 1.172 Vali Loss: 7.420 Vali Acc: 0.821 Test Loss: 7.420 Test Acc: 0.821
Validation loss decreased (-0.786073 --> -0.820735).  Saving model ...
Epoch: 14 cost time: 17.48071599006653
Epoch: 14, Steps: 34 | Train Loss: 4.315 Vali Loss: 7.283 Vali Acc: 0.809 Test Loss: 7.283 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.115723133087158
Epoch: 15, Steps: 34 | Train Loss: 1.704 Vali Loss: 12.774 Vali Acc: 0.734 Test Loss: 12.774 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.00696635246277
Epoch: 16, Steps: 34 | Train Loss: 2.993 Vali Loss: 6.092 Vali Acc: 0.855 Test Loss: 6.092 Test Acc: 0.855
Validation loss decreased (-0.820735 --> -0.855430).  Saving model ...
Epoch: 17 cost time: 19.6702299118042
Epoch: 17, Steps: 34 | Train Loss: 0.305 Vali Loss: 5.932 Vali Acc: 0.838 Test Loss: 5.932 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 20.087418794631958
Epoch: 18, Steps: 34 | Train Loss: 0.660 Vali Loss: 5.533 Vali Acc: 0.815 Test Loss: 5.533 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 18.656112670898438
Epoch: 19, Steps: 34 | Train Loss: 1.430 Vali Loss: 6.346 Vali Acc: 0.815 Test Loss: 6.346 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 20.225025177001953
Epoch: 20, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.442 Vali Acc: 0.821 Test Loss: 4.442 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 16.673174381256104
Epoch: 21, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.525 Vali Acc: 0.821 Test Loss: 4.525 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 18.89218258857727
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.528 Vali Acc: 0.821 Test Loss: 4.528 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 17.158456087112427
Epoch: 23, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.528 Vali Acc: 0.821 Test Loss: 4.528 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 19.21201229095459
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.528 Vali Acc: 0.821 Test Loss: 4.528 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 17.678320169448853
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.528 Vali Acc: 0.821 Test Loss: 4.528 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 18.457855463027954
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.528 Vali Acc: 0.821 Test Loss: 4.528 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 6177847
model size : 26.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.080862045288086
Epoch: 1, Steps: 34 | Train Loss: 6.254 Vali Loss: 6.325 Vali Acc: 0.399 Test Loss: 6.325 Test Acc: 0.399
Validation loss decreased (inf --> -0.398781).  Saving model ...
Epoch: 2 cost time: 15.946693897247314
Epoch: 2, Steps: 34 | Train Loss: 7.018 Vali Loss: 6.491 Vali Acc: 0.491 Test Loss: 6.491 Test Acc: 0.491
Validation loss decreased (-0.398781 --> -0.491265).  Saving model ...
Epoch: 3 cost time: 18.729509830474854
Epoch: 3, Steps: 34 | Train Loss: 13.069 Vali Loss: 8.381 Vali Acc: 0.601 Test Loss: 8.381 Test Acc: 0.601
Validation loss decreased (-0.491265 --> -0.601072).  Saving model ...
Epoch: 4 cost time: 18.598499536514282
Epoch: 4, Steps: 34 | Train Loss: 10.848 Vali Loss: 16.318 Vali Acc: 0.514 Test Loss: 16.318 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.095442533493042
Epoch: 5, Steps: 34 | Train Loss: 10.619 Vali Loss: 21.066 Vali Acc: 0.497 Test Loss: 21.066 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.846681594848633
Epoch: 6, Steps: 34 | Train Loss: 7.223 Vali Loss: 15.530 Vali Acc: 0.520 Test Loss: 15.530 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.085400104522705
Epoch: 7, Steps: 34 | Train Loss: 7.003 Vali Loss: 9.945 Vali Acc: 0.607 Test Loss: 9.945 Test Acc: 0.607
Validation loss decreased (-0.601072 --> -0.606837).  Saving model ...
Epoch: 8 cost time: 19.870701789855957
Epoch: 8, Steps: 34 | Train Loss: 3.836 Vali Loss: 15.046 Vali Acc: 0.601 Test Loss: 15.046 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.21500039100647
Epoch: 9, Steps: 34 | Train Loss: 4.351 Vali Loss: 19.617 Vali Acc: 0.538 Test Loss: 19.617 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.555284023284912
Epoch: 10, Steps: 34 | Train Loss: 3.702 Vali Loss: 23.915 Vali Acc: 0.566 Test Loss: 23.915 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.046268701553345
Epoch: 11, Steps: 34 | Train Loss: 3.181 Vali Loss: 15.005 Vali Acc: 0.671 Test Loss: 15.005 Test Acc: 0.671
Validation loss decreased (-0.606837 --> -0.670370).  Saving model ...
Epoch: 12 cost time: 18.95666265487671
Epoch: 12, Steps: 34 | Train Loss: 3.420 Vali Loss: 4.817 Vali Acc: 0.780 Test Loss: 4.817 Test Acc: 0.780
Validation loss decreased (-0.670370 --> -0.780299).  Saving model ...
Epoch: 13 cost time: 18.927152395248413
Epoch: 13, Steps: 34 | Train Loss: 1.789 Vali Loss: 9.689 Vali Acc: 0.792 Test Loss: 9.689 Test Acc: 0.792
Validation loss decreased (-0.780299 --> -0.791811).  Saving model ...
Epoch: 14 cost time: 18.705145359039307
Epoch: 14, Steps: 34 | Train Loss: 0.487 Vali Loss: 12.646 Vali Acc: 0.734 Test Loss: 12.646 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.362889766693115
Epoch: 15, Steps: 34 | Train Loss: 1.602 Vali Loss: 10.792 Vali Acc: 0.786 Test Loss: 10.792 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 19.197493076324463
Epoch: 16, Steps: 34 | Train Loss: 1.046 Vali Loss: 4.885 Vali Acc: 0.815 Test Loss: 4.885 Test Acc: 0.815
Validation loss decreased (-0.791811 --> -0.814980).  Saving model ...
Epoch: 17 cost time: 18.876752614974976
Epoch: 17, Steps: 34 | Train Loss: 0.249 Vali Loss: 13.948 Vali Acc: 0.705 Test Loss: 13.948 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 19.101200103759766
Epoch: 18, Steps: 34 | Train Loss: 0.537 Vali Loss: 7.577 Vali Acc: 0.792 Test Loss: 7.577 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.782348155975342
Epoch: 19, Steps: 34 | Train Loss: 0.542 Vali Loss: 15.783 Vali Acc: 0.734 Test Loss: 15.783 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 20.02329134941101
Epoch: 20, Steps: 34 | Train Loss: 1.882 Vali Loss: 10.235 Vali Acc: 0.827 Test Loss: 10.235 Test Acc: 0.827
Validation loss decreased (-0.814980 --> -0.826487).  Saving model ...
Epoch: 21 cost time: 17.34669303894043
Epoch: 21, Steps: 34 | Train Loss: 1.794 Vali Loss: 15.960 Vali Acc: 0.676 Test Loss: 15.960 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 19.22454333305359
Epoch: 22, Steps: 34 | Train Loss: 2.346 Vali Loss: 10.815 Vali Acc: 0.786 Test Loss: 10.815 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 16.940302848815918
Epoch: 23, Steps: 34 | Train Loss: 0.498 Vali Loss: 9.526 Vali Acc: 0.832 Test Loss: 9.526 Test Acc: 0.832
Validation loss decreased (-0.826487 --> -0.832275).  Saving model ...
Epoch: 24 cost time: 19.923349857330322
Epoch: 24, Steps: 34 | Train Loss: 1.440 Vali Loss: 11.386 Vali Acc: 0.775 Test Loss: 11.386 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 19.44922637939453
Epoch: 25, Steps: 34 | Train Loss: 0.580 Vali Loss: 7.216 Vali Acc: 0.832 Test Loss: 7.216 Test Acc: 0.832
Validation loss decreased (-0.832275 --> -0.832298).  Saving model ...
Epoch: 26 cost time: 20.149006605148315
Epoch: 26, Steps: 34 | Train Loss: 0.175 Vali Loss: 12.607 Vali Acc: 0.798 Test Loss: 12.607 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 20.61375141143799
Epoch: 27, Steps: 34 | Train Loss: 1.746 Vali Loss: 18.211 Vali Acc: 0.711 Test Loss: 18.211 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 21.745736360549927
Epoch: 28, Steps: 34 | Train Loss: 1.271 Vali Loss: 8.140 Vali Acc: 0.803 Test Loss: 8.140 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 18.514499187469482
Epoch: 29, Steps: 34 | Train Loss: 0.834 Vali Loss: 11.950 Vali Acc: 0.763 Test Loss: 11.950 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 18.294636726379395
Epoch: 30, Steps: 34 | Train Loss: 0.949 Vali Loss: 13.521 Vali Acc: 0.757 Test Loss: 13.521 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 19.713313817977905
Epoch: 31, Steps: 34 | Train Loss: 0.226 Vali Loss: 7.529 Vali Acc: 0.838 Test Loss: 7.529 Test Acc: 0.838
Validation loss decreased (-0.832298 --> -0.838075).  Saving model ...
Epoch: 32 cost time: 18.92632746696472
Epoch: 32, Steps: 34 | Train Loss: 0.745 Vali Loss: 6.873 Vali Acc: 0.809 Test Loss: 6.873 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 19.564335346221924
Epoch: 33, Steps: 34 | Train Loss: 0.518 Vali Loss: 7.484 Vali Acc: 0.827 Test Loss: 7.484 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 18.28852105140686
Epoch: 34, Steps: 34 | Train Loss: 2.099 Vali Loss: 9.258 Vali Acc: 0.786 Test Loss: 9.258 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 13.764310121536255
Epoch: 35, Steps: 34 | Train Loss: 0.828 Vali Loss: 9.539 Vali Acc: 0.775 Test Loss: 9.539 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 18.921610593795776
Epoch: 36, Steps: 34 | Train Loss: 1.103 Vali Loss: 11.499 Vali Acc: 0.798 Test Loss: 11.499 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 16.37999677658081
Epoch: 37, Steps: 34 | Train Loss: 0.320 Vali Loss: 5.719 Vali Acc: 0.873 Test Loss: 5.719 Test Acc: 0.873
Validation loss decreased (-0.838075 --> -0.872775).  Saving model ...
Epoch: 38 cost time: 18.240516185760498
Epoch: 38, Steps: 34 | Train Loss: 0.267 Vali Loss: 7.719 Vali Acc: 0.821 Test Loss: 7.719 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 17.21092915534973
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.890 Vali Acc: 0.838 Test Loss: 6.890 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 18.177603244781494
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.858 Vali Acc: 0.838 Test Loss: 6.858 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 17.420252084732056
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.838 Vali Acc: 0.838 Test Loss: 6.838 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 18.061569929122925
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.835 Vali Acc: 0.838 Test Loss: 6.835 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 19.271337032318115
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.835 Vali Acc: 0.838 Test Loss: 6.835 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 20.877975463867188
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.834 Vali Acc: 0.838 Test Loss: 6.834 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 17.542782306671143
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.803 Vali Acc: 0.838 Test Loss: 6.803 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 20.311391592025757
Epoch: 46, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.802 Vali Acc: 0.838 Test Loss: 6.802 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 16.855435609817505
Epoch: 47, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.802 Vali Acc: 0.838 Test Loss: 6.802 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 6175159
model size : 26.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.283840894699097
Epoch: 1, Steps: 34 | Train Loss: 5.765 Vali Loss: 7.094 Vali Acc: 0.295 Test Loss: 7.094 Test Acc: 0.295
Validation loss decreased (inf --> -0.294727).  Saving model ...
Epoch: 2 cost time: 18.343647480010986
Epoch: 2, Steps: 34 | Train Loss: 8.821 Vali Loss: 10.752 Vali Acc: 0.243 Test Loss: 10.752 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.69579792022705
Epoch: 3, Steps: 34 | Train Loss: 10.737 Vali Loss: 14.451 Vali Acc: 0.329 Test Loss: 14.451 Test Acc: 0.329
Validation loss decreased (-0.294727 --> -0.329335).  Saving model ...
Epoch: 4 cost time: 19.386133670806885
Epoch: 4, Steps: 34 | Train Loss: 7.443 Vali Loss: 10.917 Vali Acc: 0.434 Test Loss: 10.917 Test Acc: 0.434
Validation loss decreased (-0.329335 --> -0.433417).  Saving model ...
Epoch: 5 cost time: 17.580530643463135
Epoch: 5, Steps: 34 | Train Loss: 8.415 Vali Loss: 6.570 Vali Acc: 0.607 Test Loss: 6.570 Test Acc: 0.607
Validation loss decreased (-0.433417 --> -0.606871).  Saving model ...
Epoch: 6 cost time: 18.954418659210205
Epoch: 6, Steps: 34 | Train Loss: 6.416 Vali Loss: 21.670 Vali Acc: 0.566 Test Loss: 21.670 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.81544828414917
Epoch: 7, Steps: 34 | Train Loss: 9.236 Vali Loss: 17.383 Vali Acc: 0.439 Test Loss: 17.383 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.534562587738037
Epoch: 8, Steps: 34 | Train Loss: 8.228 Vali Loss: 4.846 Vali Acc: 0.798 Test Loss: 4.846 Test Acc: 0.798
Validation loss decreased (-0.606871 --> -0.797639).  Saving model ...
Epoch: 9 cost time: 17.791889667510986
Epoch: 9, Steps: 34 | Train Loss: 4.750 Vali Loss: 26.893 Vali Acc: 0.514 Test Loss: 26.893 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.711106538772583
Epoch: 10, Steps: 34 | Train Loss: 5.601 Vali Loss: 18.852 Vali Acc: 0.601 Test Loss: 18.852 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.51090097427368
Epoch: 11, Steps: 34 | Train Loss: 2.527 Vali Loss: 5.053 Vali Acc: 0.798 Test Loss: 5.053 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.53375792503357
Epoch: 12, Steps: 34 | Train Loss: 0.869 Vali Loss: 28.170 Vali Acc: 0.543 Test Loss: 28.170 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.607724905014038
Epoch: 13, Steps: 34 | Train Loss: 2.786 Vali Loss: 7.947 Vali Acc: 0.769 Test Loss: 7.947 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.03466534614563
Epoch: 14, Steps: 34 | Train Loss: 1.056 Vali Loss: 17.149 Vali Acc: 0.682 Test Loss: 17.149 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 19.452711820602417
Epoch: 15, Steps: 34 | Train Loss: 2.205 Vali Loss: 10.173 Vali Acc: 0.803 Test Loss: 10.173 Test Acc: 0.803
Validation loss decreased (-0.797639 --> -0.803366).  Saving model ...
Epoch: 16 cost time: 21.358006238937378
Epoch: 16, Steps: 34 | Train Loss: 1.127 Vali Loss: 12.973 Vali Acc: 0.728 Test Loss: 12.973 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.33307409286499
Epoch: 17, Steps: 34 | Train Loss: 1.468 Vali Loss: 11.499 Vali Acc: 0.746 Test Loss: 11.499 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.612528800964355
Epoch: 18, Steps: 34 | Train Loss: 0.901 Vali Loss: 8.953 Vali Acc: 0.711 Test Loss: 8.953 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 18.127007961273193
Epoch: 19, Steps: 34 | Train Loss: 2.115 Vali Loss: 8.060 Vali Acc: 0.780 Test Loss: 8.060 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 18.938170909881592
Epoch: 20, Steps: 34 | Train Loss: 0.714 Vali Loss: 12.607 Vali Acc: 0.734 Test Loss: 12.607 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 18.47576594352722
Epoch: 21, Steps: 34 | Train Loss: 0.591 Vali Loss: 10.395 Vali Acc: 0.809 Test Loss: 10.395 Test Acc: 0.809
Validation loss decreased (-0.803366 --> -0.809145).  Saving model ...
Epoch: 22 cost time: 17.48537302017212
Epoch: 22, Steps: 34 | Train Loss: 0.693 Vali Loss: 9.955 Vali Acc: 0.827 Test Loss: 9.955 Test Acc: 0.827
Validation loss decreased (-0.809145 --> -0.826490).  Saving model ...
Epoch: 23 cost time: 19.338804721832275
Epoch: 23, Steps: 34 | Train Loss: 0.799 Vali Loss: 21.777 Vali Acc: 0.705 Test Loss: 21.777 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 17.9375479221344
Epoch: 24, Steps: 34 | Train Loss: 0.594 Vali Loss: 10.987 Vali Acc: 0.809 Test Loss: 10.987 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 18.433494091033936
Epoch: 25, Steps: 34 | Train Loss: 0.534 Vali Loss: 18.472 Vali Acc: 0.653 Test Loss: 18.472 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 17.936570644378662
Epoch: 26, Steps: 34 | Train Loss: 0.395 Vali Loss: 7.339 Vali Acc: 0.821 Test Loss: 7.339 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 18.590819120407104
Epoch: 27, Steps: 34 | Train Loss: 0.478 Vali Loss: 19.060 Vali Acc: 0.740 Test Loss: 19.060 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 18.253670692443848
Epoch: 28, Steps: 34 | Train Loss: 0.108 Vali Loss: 17.496 Vali Acc: 0.699 Test Loss: 17.496 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 18.524362325668335
Epoch: 29, Steps: 34 | Train Loss: 1.589 Vali Loss: 6.793 Vali Acc: 0.827 Test Loss: 6.793 Test Acc: 0.827
Validation loss decreased (-0.826490 --> -0.826522).  Saving model ...
Epoch: 30 cost time: 17.906147241592407
Epoch: 30, Steps: 34 | Train Loss: 0.461 Vali Loss: 10.210 Vali Acc: 0.827 Test Loss: 10.210 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 18.963895082473755
Epoch: 31, Steps: 34 | Train Loss: 0.048 Vali Loss: 10.257 Vali Acc: 0.775 Test Loss: 10.257 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 20.175177812576294
Epoch: 32, Steps: 34 | Train Loss: 0.480 Vali Loss: 7.935 Vali Acc: 0.832 Test Loss: 7.935 Test Acc: 0.832
Validation loss decreased (-0.826522 --> -0.832291).  Saving model ...
Epoch: 33 cost time: 21.191229820251465
Epoch: 33, Steps: 34 | Train Loss: 0.715 Vali Loss: 8.598 Vali Acc: 0.827 Test Loss: 8.598 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 19.4266676902771
Epoch: 34, Steps: 34 | Train Loss: 0.085 Vali Loss: 8.785 Vali Acc: 0.838 Test Loss: 8.785 Test Acc: 0.838
Validation loss decreased (-0.832291 --> -0.838062).  Saving model ...
Epoch: 35 cost time: 20.37407922744751
Epoch: 35, Steps: 34 | Train Loss: 0.104 Vali Loss: 7.017 Vali Acc: 0.786 Test Loss: 7.017 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 18.598409175872803
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.525 Vali Acc: 0.809 Test Loss: 7.525 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 19.181280851364136
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.541 Vali Acc: 0.809 Test Loss: 7.541 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 18.034124851226807
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.541 Vali Acc: 0.809 Test Loss: 7.541 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 18.57308578491211
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.541 Vali Acc: 0.809 Test Loss: 7.541 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 18.153274059295654
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.541 Vali Acc: 0.809 Test Loss: 7.541 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 19.179123640060425
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.541 Vali Acc: 0.809 Test Loss: 7.541 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 18.366132497787476
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.541 Vali Acc: 0.809 Test Loss: 7.541 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 18.68765091896057
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.539 Vali Acc: 0.809 Test Loss: 7.539 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 17.02103614807129
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.539 Vali Acc: 0.809 Test Loss: 7.539 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6172471
model size : 26.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.136749267578125
Epoch: 1, Steps: 34 | Train Loss: 5.478 Vali Loss: 8.875 Vali Acc: 0.306 Test Loss: 8.875 Test Acc: 0.306
Validation loss decreased (inf --> -0.306270).  Saving model ...
Epoch: 2 cost time: 18.30999732017517
Epoch: 2, Steps: 34 | Train Loss: 10.518 Vali Loss: 7.462 Vali Acc: 0.503 Test Loss: 7.462 Test Acc: 0.503
Validation loss decreased (-0.306270 --> -0.502816).  Saving model ...
Epoch: 3 cost time: 17.624927043914795
Epoch: 3, Steps: 34 | Train Loss: 16.160 Vali Loss: 16.367 Vali Acc: 0.399 Test Loss: 16.367 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.358001470565796
Epoch: 4, Steps: 34 | Train Loss: 11.560 Vali Loss: 9.785 Vali Acc: 0.584 Test Loss: 9.785 Test Acc: 0.584
Validation loss decreased (-0.502816 --> -0.583717).  Saving model ...
Epoch: 5 cost time: 18.108663082122803
Epoch: 5, Steps: 34 | Train Loss: 8.760 Vali Loss: 15.920 Vali Acc: 0.457 Test Loss: 15.920 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.991779327392578
Epoch: 6, Steps: 34 | Train Loss: 8.014 Vali Loss: 30.962 Vali Acc: 0.457 Test Loss: 30.962 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.096617221832275
Epoch: 7, Steps: 34 | Train Loss: 10.700 Vali Loss: 11.180 Vali Acc: 0.624 Test Loss: 11.180 Test Acc: 0.624
Validation loss decreased (-0.583717 --> -0.624166).  Saving model ...
Epoch: 8 cost time: 18.907536268234253
Epoch: 8, Steps: 34 | Train Loss: 3.909 Vali Loss: 6.112 Vali Acc: 0.705 Test Loss: 6.112 Test Acc: 0.705
Validation loss decreased (-0.624166 --> -0.705141).  Saving model ...
Epoch: 9 cost time: 17.904765605926514
Epoch: 9, Steps: 34 | Train Loss: 2.605 Vali Loss: 4.663 Vali Acc: 0.734 Test Loss: 4.663 Test Acc: 0.734
Validation loss decreased (-0.705141 --> -0.734057).  Saving model ...
Epoch: 10 cost time: 16.797890663146973
Epoch: 10, Steps: 34 | Train Loss: 3.009 Vali Loss: 11.748 Vali Acc: 0.647 Test Loss: 11.748 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.255685329437256
Epoch: 11, Steps: 34 | Train Loss: 3.342 Vali Loss: 5.869 Vali Acc: 0.728 Test Loss: 5.869 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.4638569355011
Epoch: 12, Steps: 34 | Train Loss: 1.824 Vali Loss: 10.476 Vali Acc: 0.682 Test Loss: 10.476 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 18.36031699180603
Epoch: 13, Steps: 34 | Train Loss: 1.814 Vali Loss: 6.975 Vali Acc: 0.757 Test Loss: 6.975 Test Acc: 0.757
Validation loss decreased (-0.734057 --> -0.757156).  Saving model ...
Epoch: 14 cost time: 17.220691204071045
Epoch: 14, Steps: 34 | Train Loss: 2.272 Vali Loss: 21.204 Vali Acc: 0.590 Test Loss: 21.204 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.907526969909668
Epoch: 15, Steps: 34 | Train Loss: 2.141 Vali Loss: 17.841 Vali Acc: 0.636 Test Loss: 17.841 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.764368534088135
Epoch: 16, Steps: 34 | Train Loss: 2.080 Vali Loss: 5.094 Vali Acc: 0.769 Test Loss: 5.094 Test Acc: 0.769
Validation loss decreased (-0.757156 --> -0.768735).  Saving model ...
Epoch: 17 cost time: 17.989408493041992
Epoch: 17, Steps: 34 | Train Loss: 1.107 Vali Loss: 5.692 Vali Acc: 0.838 Test Loss: 5.692 Test Acc: 0.838
Validation loss decreased (-0.768735 --> -0.838093).  Saving model ...
Epoch: 18 cost time: 17.040948390960693
Epoch: 18, Steps: 34 | Train Loss: 0.541 Vali Loss: 11.159 Vali Acc: 0.723 Test Loss: 11.159 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 19.114962577819824
Epoch: 19, Steps: 34 | Train Loss: 1.134 Vali Loss: 13.518 Vali Acc: 0.688 Test Loss: 13.518 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.075785160064697
Epoch: 20, Steps: 34 | Train Loss: 1.133 Vali Loss: 15.423 Vali Acc: 0.711 Test Loss: 15.423 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 17.59662127494812
Epoch: 21, Steps: 34 | Train Loss: 0.853 Vali Loss: 11.543 Vali Acc: 0.792 Test Loss: 11.543 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 17.86483359336853
Epoch: 22, Steps: 34 | Train Loss: 0.288 Vali Loss: 8.762 Vali Acc: 0.803 Test Loss: 8.762 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 20.736436128616333
Epoch: 23, Steps: 34 | Train Loss: 0.625 Vali Loss: 12.615 Vali Acc: 0.746 Test Loss: 12.615 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 19.873321533203125
Epoch: 24, Steps: 34 | Train Loss: 0.273 Vali Loss: 11.612 Vali Acc: 0.775 Test Loss: 11.612 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 19.940927267074585
Epoch: 25, Steps: 34 | Train Loss: 0.027 Vali Loss: 7.527 Vali Acc: 0.803 Test Loss: 7.527 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 20.078776121139526
Epoch: 26, Steps: 34 | Train Loss: 0.975 Vali Loss: 11.812 Vali Acc: 0.786 Test Loss: 11.812 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 18.375295162200928
Epoch: 27, Steps: 34 | Train Loss: 0.519 Vali Loss: 8.482 Vali Acc: 0.786 Test Loss: 8.482 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6169783
model size : 26.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.47745966911316
Epoch: 1, Steps: 34 | Train Loss: 3.446 Vali Loss: 5.011 Vali Acc: 0.260 Test Loss: 5.011 Test Acc: 0.260
Validation loss decreased (inf --> -0.260066).  Saving model ...
Epoch: 2 cost time: 16.45932650566101
Epoch: 2, Steps: 34 | Train Loss: 3.076 Vali Loss: 4.422 Vali Acc: 0.376 Test Loss: 4.422 Test Acc: 0.376
Validation loss decreased (-0.260066 --> -0.375678).  Saving model ...
Epoch: 3 cost time: 17.281131982803345
Epoch: 3, Steps: 34 | Train Loss: 5.347 Vali Loss: 7.953 Vali Acc: 0.503 Test Loss: 7.953 Test Acc: 0.503
Validation loss decreased (-0.375678 --> -0.502811).  Saving model ...
Epoch: 4 cost time: 17.10629940032959
Epoch: 4, Steps: 34 | Train Loss: 7.095 Vali Loss: 10.246 Vali Acc: 0.509 Test Loss: 10.246 Test Acc: 0.509
Validation loss decreased (-0.502811 --> -0.508568).  Saving model ...
Epoch: 5 cost time: 16.708348512649536
Epoch: 5, Steps: 34 | Train Loss: 6.329 Vali Loss: 5.154 Vali Acc: 0.572 Test Loss: 5.154 Test Acc: 0.572
Validation loss decreased (-0.508568 --> -0.572203).  Saving model ...
Epoch: 6 cost time: 16.884381532669067
Epoch: 6, Steps: 34 | Train Loss: 4.175 Vali Loss: 4.822 Vali Acc: 0.532 Test Loss: 4.822 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.42983078956604
Epoch: 7, Steps: 34 | Train Loss: 3.669 Vali Loss: 6.542 Vali Acc: 0.613 Test Loss: 6.542 Test Acc: 0.613
Validation loss decreased (-0.572203 --> -0.612651).  Saving model ...
Epoch: 8 cost time: 17.3323495388031
Epoch: 8, Steps: 34 | Train Loss: 1.979 Vali Loss: 9.123 Vali Acc: 0.520 Test Loss: 9.123 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.155184268951416
Epoch: 9, Steps: 34 | Train Loss: 1.769 Vali Loss: 5.376 Vali Acc: 0.711 Test Loss: 5.376 Test Acc: 0.711
Validation loss decreased (-0.612651 --> -0.710929).  Saving model ...
Epoch: 10 cost time: 17.0531165599823
Epoch: 10, Steps: 34 | Train Loss: 3.243 Vali Loss: 8.506 Vali Acc: 0.671 Test Loss: 8.506 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.500741958618164
Epoch: 11, Steps: 34 | Train Loss: 2.148 Vali Loss: 5.137 Vali Acc: 0.734 Test Loss: 5.137 Test Acc: 0.734
Validation loss decreased (-0.710929 --> -0.734053).  Saving model ...
Epoch: 12 cost time: 12.679704904556274
Epoch: 12, Steps: 34 | Train Loss: 1.914 Vali Loss: 4.619 Vali Acc: 0.746 Test Loss: 4.619 Test Acc: 0.746
Validation loss decreased (-0.734053 --> -0.745619).  Saving model ...
Epoch: 13 cost time: 19.0000581741333
Epoch: 13, Steps: 34 | Train Loss: 0.390 Vali Loss: 7.191 Vali Acc: 0.705 Test Loss: 7.191 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.114431858062744
Epoch: 14, Steps: 34 | Train Loss: 0.810 Vali Loss: 10.182 Vali Acc: 0.618 Test Loss: 10.182 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.627135515213013
Epoch: 15, Steps: 34 | Train Loss: 1.180 Vali Loss: 4.246 Vali Acc: 0.815 Test Loss: 4.246 Test Acc: 0.815
Validation loss decreased (-0.745619 --> -0.814986).  Saving model ...
Epoch: 16 cost time: 19.475744485855103
Epoch: 16, Steps: 34 | Train Loss: 0.616 Vali Loss: 4.178 Vali Acc: 0.798 Test Loss: 4.178 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 17.158544778823853
Epoch: 17, Steps: 34 | Train Loss: 0.374 Vali Loss: 3.439 Vali Acc: 0.792 Test Loss: 3.439 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.906936168670654
Epoch: 18, Steps: 34 | Train Loss: 0.495 Vali Loss: 4.553 Vali Acc: 0.757 Test Loss: 4.553 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.90513300895691
Epoch: 19, Steps: 34 | Train Loss: 0.310 Vali Loss: 3.739 Vali Acc: 0.798 Test Loss: 3.739 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.06540822982788
Epoch: 20, Steps: 34 | Train Loss: 0.149 Vali Loss: 9.939 Vali Acc: 0.746 Test Loss: 9.939 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.802666902542114
Epoch: 21, Steps: 34 | Train Loss: 0.317 Vali Loss: 6.556 Vali Acc: 0.740 Test Loss: 6.556 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.72590184211731
Epoch: 22, Steps: 34 | Train Loss: 0.443 Vali Loss: 5.044 Vali Acc: 0.803 Test Loss: 5.044 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.48836064338684
Epoch: 23, Steps: 34 | Train Loss: 0.175 Vali Loss: 5.701 Vali Acc: 0.792 Test Loss: 5.701 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 17.607086896896362
Epoch: 24, Steps: 34 | Train Loss: 0.289 Vali Loss: 2.737 Vali Acc: 0.809 Test Loss: 2.737 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.75875163078308
Epoch: 25, Steps: 34 | Train Loss: 0.298 Vali Loss: 6.348 Vali Acc: 0.734 Test Loss: 6.348 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 3439735
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.168259620666504
Epoch: 1, Steps: 34 | Train Loss: 3.063 Vali Loss: 4.220 Vali Acc: 0.260 Test Loss: 4.220 Test Acc: 0.260
Validation loss decreased (inf --> -0.260073).  Saving model ...
Epoch: 2 cost time: 17.532714366912842
Epoch: 2, Steps: 34 | Train Loss: 4.199 Vali Loss: 4.824 Vali Acc: 0.428 Test Loss: 4.824 Test Acc: 0.428
Validation loss decreased (-0.260073 --> -0.427697).  Saving model ...
Epoch: 3 cost time: 16.524165868759155
Epoch: 3, Steps: 34 | Train Loss: 5.616 Vali Loss: 5.784 Vali Acc: 0.382 Test Loss: 5.784 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.95512843132019
Epoch: 4, Steps: 34 | Train Loss: 4.210 Vali Loss: 6.873 Vali Acc: 0.503 Test Loss: 6.873 Test Acc: 0.503
Validation loss decreased (-0.427697 --> -0.502821).  Saving model ...
Epoch: 5 cost time: 17.70574164390564
Epoch: 5, Steps: 34 | Train Loss: 2.249 Vali Loss: 3.994 Vali Acc: 0.607 Test Loss: 3.994 Test Acc: 0.607
Validation loss decreased (-0.502821 --> -0.606896).  Saving model ...
Epoch: 6 cost time: 18.609963178634644
Epoch: 6, Steps: 34 | Train Loss: 3.478 Vali Loss: 8.645 Vali Acc: 0.566 Test Loss: 8.645 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.50877547264099
Epoch: 7, Steps: 34 | Train Loss: 4.230 Vali Loss: 12.232 Vali Acc: 0.468 Test Loss: 12.232 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.733604669570923
Epoch: 8, Steps: 34 | Train Loss: 3.069 Vali Loss: 3.835 Vali Acc: 0.711 Test Loss: 3.835 Test Acc: 0.711
Validation loss decreased (-0.606896 --> -0.710944).  Saving model ...
Epoch: 9 cost time: 17.715795755386353
Epoch: 9, Steps: 34 | Train Loss: 2.812 Vali Loss: 4.246 Vali Acc: 0.653 Test Loss: 4.246 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.798943042755127
Epoch: 10, Steps: 34 | Train Loss: 1.587 Vali Loss: 5.312 Vali Acc: 0.723 Test Loss: 5.312 Test Acc: 0.723
Validation loss decreased (-0.710944 --> -0.722490).  Saving model ...
Epoch: 11 cost time: 16.94932770729065
Epoch: 11, Steps: 34 | Train Loss: 2.333 Vali Loss: 5.193 Vali Acc: 0.676 Test Loss: 5.193 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.330283880233765
Epoch: 12, Steps: 34 | Train Loss: 1.237 Vali Loss: 2.192 Vali Acc: 0.844 Test Loss: 2.192 Test Acc: 0.844
Validation loss decreased (-0.722490 --> -0.843909).  Saving model ...
Epoch: 13 cost time: 15.75379991531372
Epoch: 13, Steps: 34 | Train Loss: 1.356 Vali Loss: 8.638 Vali Acc: 0.665 Test Loss: 8.638 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.32768940925598
Epoch: 14, Steps: 34 | Train Loss: 1.473 Vali Loss: 7.010 Vali Acc: 0.786 Test Loss: 7.010 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.66986322402954
Epoch: 15, Steps: 34 | Train Loss: 0.488 Vali Loss: 2.774 Vali Acc: 0.815 Test Loss: 2.774 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.320513248443604
Epoch: 16, Steps: 34 | Train Loss: 0.200 Vali Loss: 3.121 Vali Acc: 0.844 Test Loss: 3.121 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.958950757980347
Epoch: 17, Steps: 34 | Train Loss: 0.269 Vali Loss: 6.187 Vali Acc: 0.763 Test Loss: 6.187 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 17.216565132141113
Epoch: 18, Steps: 34 | Train Loss: 0.354 Vali Loss: 4.100 Vali Acc: 0.821 Test Loss: 4.100 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 17.048269987106323
Epoch: 19, Steps: 34 | Train Loss: 1.015 Vali Loss: 6.693 Vali Acc: 0.775 Test Loss: 6.693 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.754392623901367
Epoch: 20, Steps: 34 | Train Loss: 0.940 Vali Loss: 10.423 Vali Acc: 0.705 Test Loss: 10.423 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 16.27085256576538
Epoch: 21, Steps: 34 | Train Loss: 1.127 Vali Loss: 3.558 Vali Acc: 0.844 Test Loss: 3.558 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.030699491500854
Epoch: 22, Steps: 34 | Train Loss: 0.479 Vali Loss: 4.834 Vali Acc: 0.763 Test Loss: 4.834 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3438391
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.981069803237915
Epoch: 1, Steps: 34 | Train Loss: 3.082 Vali Loss: 3.815 Vali Acc: 0.347 Test Loss: 3.815 Test Acc: 0.347
Validation loss decreased (inf --> -0.346783).  Saving model ...
Epoch: 2 cost time: 19.11450982093811
Epoch: 2, Steps: 34 | Train Loss: 4.678 Vali Loss: 8.553 Vali Acc: 0.283 Test Loss: 8.553 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.94373631477356
Epoch: 3, Steps: 34 | Train Loss: 6.203 Vali Loss: 7.512 Vali Acc: 0.410 Test Loss: 7.512 Test Acc: 0.410
Validation loss decreased (-0.346783 --> -0.410330).  Saving model ...
Epoch: 4 cost time: 19.629982471466064
Epoch: 4, Steps: 34 | Train Loss: 4.064 Vali Loss: 7.616 Vali Acc: 0.457 Test Loss: 7.616 Test Acc: 0.457
Validation loss decreased (-0.410330 --> -0.456571).  Saving model ...
Epoch: 5 cost time: 16.005706548690796
Epoch: 5, Steps: 34 | Train Loss: 5.712 Vali Loss: 4.237 Vali Acc: 0.607 Test Loss: 4.237 Test Acc: 0.607
Validation loss decreased (-0.456571 --> -0.606894).  Saving model ...
Epoch: 6 cost time: 16.85488271713257
Epoch: 6, Steps: 34 | Train Loss: 5.955 Vali Loss: 4.304 Vali Acc: 0.688 Test Loss: 4.304 Test Acc: 0.688
Validation loss decreased (-0.606894 --> -0.687818).  Saving model ...
Epoch: 7 cost time: 15.6818106174469
Epoch: 7, Steps: 34 | Train Loss: 5.079 Vali Loss: 8.687 Vali Acc: 0.671 Test Loss: 8.687 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.071263790130615
Epoch: 8, Steps: 34 | Train Loss: 2.581 Vali Loss: 2.735 Vali Acc: 0.775 Test Loss: 2.735 Test Acc: 0.775
Validation loss decreased (-0.687818 --> -0.774539).  Saving model ...
Epoch: 9 cost time: 17.22620987892151
Epoch: 9, Steps: 34 | Train Loss: 3.802 Vali Loss: 7.519 Vali Acc: 0.584 Test Loss: 7.519 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.798503637313843
Epoch: 10, Steps: 34 | Train Loss: 2.867 Vali Loss: 3.463 Vali Acc: 0.780 Test Loss: 3.463 Test Acc: 0.780
Validation loss decreased (-0.774539 --> -0.780312).  Saving model ...
Epoch: 11 cost time: 16.2595431804657
Epoch: 11, Steps: 34 | Train Loss: 1.306 Vali Loss: 4.186 Vali Acc: 0.769 Test Loss: 4.186 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.268494367599487
Epoch: 12, Steps: 34 | Train Loss: 0.732 Vali Loss: 5.443 Vali Acc: 0.740 Test Loss: 5.443 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.751641988754272
Epoch: 13, Steps: 34 | Train Loss: 1.206 Vali Loss: 4.601 Vali Acc: 0.798 Test Loss: 4.601 Test Acc: 0.798
Validation loss decreased (-0.780312 --> -0.797642).  Saving model ...
Epoch: 14 cost time: 16.751749753952026
Epoch: 14, Steps: 34 | Train Loss: 0.820 Vali Loss: 5.568 Vali Acc: 0.751 Test Loss: 5.568 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.894784688949585
Epoch: 15, Steps: 34 | Train Loss: 0.505 Vali Loss: 9.417 Vali Acc: 0.734 Test Loss: 9.417 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.268856048583984
Epoch: 16, Steps: 34 | Train Loss: 0.925 Vali Loss: 9.878 Vali Acc: 0.630 Test Loss: 9.878 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.726560592651367
Epoch: 17, Steps: 34 | Train Loss: 0.966 Vali Loss: 7.805 Vali Acc: 0.723 Test Loss: 7.805 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 15.284639358520508
Epoch: 18, Steps: 34 | Train Loss: 1.335 Vali Loss: 2.522 Vali Acc: 0.832 Test Loss: 2.522 Test Acc: 0.832
Validation loss decreased (-0.797642 --> -0.832345).  Saving model ...
Epoch: 19 cost time: 17.519230604171753
Epoch: 19, Steps: 34 | Train Loss: 0.645 Vali Loss: 9.436 Vali Acc: 0.763 Test Loss: 9.436 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 18.128798246383667
Epoch: 20, Steps: 34 | Train Loss: 0.917 Vali Loss: 16.252 Vali Acc: 0.688 Test Loss: 16.252 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 18.04670739173889
Epoch: 21, Steps: 34 | Train Loss: 1.001 Vali Loss: 8.691 Vali Acc: 0.734 Test Loss: 8.691 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 18.859019994735718
Epoch: 22, Steps: 34 | Train Loss: 0.438 Vali Loss: 6.869 Vali Acc: 0.763 Test Loss: 6.869 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 19.63059949874878
Epoch: 23, Steps: 34 | Train Loss: 0.056 Vali Loss: 4.974 Vali Acc: 0.809 Test Loss: 4.974 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 15.872294902801514
Epoch: 24, Steps: 34 | Train Loss: 0.093 Vali Loss: 7.523 Vali Acc: 0.803 Test Loss: 7.523 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 16.487236261367798
Epoch: 25, Steps: 34 | Train Loss: 0.506 Vali Loss: 7.486 Vali Acc: 0.809 Test Loss: 7.486 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 16.38161039352417
Epoch: 26, Steps: 34 | Train Loss: 0.214 Vali Loss: 5.132 Vali Acc: 0.832 Test Loss: 5.132 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 17.00365662574768
Epoch: 27, Steps: 34 | Train Loss: 0.964 Vali Loss: 3.890 Vali Acc: 0.821 Test Loss: 3.890 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 16.541884183883667
Epoch: 28, Steps: 34 | Train Loss: 0.162 Vali Loss: 5.741 Vali Acc: 0.728 Test Loss: 5.741 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3437047
model size : 14.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.3455650806427
Epoch: 1, Steps: 34 | Train Loss: 2.896 Vali Loss: 6.388 Vali Acc: 0.324 Test Loss: 6.388 Test Acc: 0.324
Validation loss decreased (inf --> -0.323636).  Saving model ...
Epoch: 2 cost time: 14.907639265060425
Epoch: 2, Steps: 34 | Train Loss: 4.034 Vali Loss: 4.908 Vali Acc: 0.439 Test Loss: 4.908 Test Acc: 0.439
Validation loss decreased (-0.323636 --> -0.439257).  Saving model ...
Epoch: 3 cost time: 15.630080699920654
Epoch: 3, Steps: 34 | Train Loss: 5.786 Vali Loss: 7.761 Vali Acc: 0.532 Test Loss: 7.761 Test Acc: 0.532
Validation loss decreased (-0.439257 --> -0.531714).  Saving model ...
Epoch: 4 cost time: 15.278783321380615
Epoch: 4, Steps: 34 | Train Loss: 3.615 Vali Loss: 4.740 Vali Acc: 0.474 Test Loss: 4.740 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.239672422409058
Epoch: 5, Steps: 34 | Train Loss: 4.339 Vali Loss: 3.803 Vali Acc: 0.509 Test Loss: 3.803 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.41679096221924
Epoch: 6, Steps: 34 | Train Loss: 2.434 Vali Loss: 8.326 Vali Acc: 0.480 Test Loss: 8.326 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.0002703666687
Epoch: 7, Steps: 34 | Train Loss: 2.549 Vali Loss: 3.910 Vali Acc: 0.694 Test Loss: 3.910 Test Acc: 0.694
Validation loss decreased (-0.531714 --> -0.693603).  Saving model ...
Epoch: 8 cost time: 16.559147357940674
Epoch: 8, Steps: 34 | Train Loss: 2.644 Vali Loss: 12.715 Vali Acc: 0.376 Test Loss: 12.715 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.755480527877808
Epoch: 9, Steps: 34 | Train Loss: 2.107 Vali Loss: 2.568 Vali Acc: 0.780 Test Loss: 2.568 Test Acc: 0.780
Validation loss decreased (-0.693603 --> -0.780321).  Saving model ...
Epoch: 10 cost time: 17.988837242126465
Epoch: 10, Steps: 34 | Train Loss: 0.874 Vali Loss: 9.680 Vali Acc: 0.549 Test Loss: 9.680 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.772597074508667
Epoch: 11, Steps: 34 | Train Loss: 2.539 Vali Loss: 11.375 Vali Acc: 0.549 Test Loss: 11.375 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.072643041610718
Epoch: 12, Steps: 34 | Train Loss: 1.748 Vali Loss: 4.237 Vali Acc: 0.769 Test Loss: 4.237 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.73179292678833
Epoch: 13, Steps: 34 | Train Loss: 0.848 Vali Loss: 5.186 Vali Acc: 0.717 Test Loss: 5.186 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.295809507369995
Epoch: 14, Steps: 34 | Train Loss: 0.136 Vali Loss: 3.661 Vali Acc: 0.786 Test Loss: 3.661 Test Acc: 0.786
Validation loss decreased (-0.780321 --> -0.786091).  Saving model ...
Epoch: 15 cost time: 17.1395902633667
Epoch: 15, Steps: 34 | Train Loss: 0.366 Vali Loss: 7.682 Vali Acc: 0.734 Test Loss: 7.682 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.856291770935059
Epoch: 16, Steps: 34 | Train Loss: 1.091 Vali Loss: 4.074 Vali Acc: 0.746 Test Loss: 4.074 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.706934213638306
Epoch: 17, Steps: 34 | Train Loss: 0.433 Vali Loss: 6.933 Vali Acc: 0.728 Test Loss: 6.933 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.803662300109863
Epoch: 18, Steps: 34 | Train Loss: 0.800 Vali Loss: 4.853 Vali Acc: 0.757 Test Loss: 4.853 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 16.89289951324463
Epoch: 19, Steps: 34 | Train Loss: 1.501 Vali Loss: 7.897 Vali Acc: 0.642 Test Loss: 7.897 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.759096384048462
Epoch: 20, Steps: 34 | Train Loss: 0.941 Vali Loss: 2.832 Vali Acc: 0.780 Test Loss: 2.832 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.714870929718018
Epoch: 21, Steps: 34 | Train Loss: 0.195 Vali Loss: 4.019 Vali Acc: 0.803 Test Loss: 4.019 Test Acc: 0.803
Validation loss decreased (-0.786091 --> -0.803428).  Saving model ...
Epoch: 22 cost time: 16.012771368026733
Epoch: 22, Steps: 34 | Train Loss: 0.297 Vali Loss: 5.921 Vali Acc: 0.746 Test Loss: 5.921 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 16.599568605422974
Epoch: 23, Steps: 34 | Train Loss: 0.878 Vali Loss: 8.314 Vali Acc: 0.665 Test Loss: 8.314 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 16.35672402381897
Epoch: 24, Steps: 34 | Train Loss: 0.727 Vali Loss: 4.785 Vali Acc: 0.792 Test Loss: 4.785 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 15.822722911834717
Epoch: 25, Steps: 34 | Train Loss: 0.213 Vali Loss: 3.602 Vali Acc: 0.769 Test Loss: 3.602 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 16.031538009643555
Epoch: 26, Steps: 34 | Train Loss: 0.255 Vali Loss: 4.508 Vali Acc: 0.688 Test Loss: 4.508 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 16.30220341682434
Epoch: 27, Steps: 34 | Train Loss: 0.293 Vali Loss: 5.567 Vali Acc: 0.751 Test Loss: 5.567 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 18.222313404083252
Epoch: 28, Steps: 34 | Train Loss: 0.045 Vali Loss: 4.671 Vali Acc: 0.723 Test Loss: 4.671 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 17.071414947509766
Epoch: 29, Steps: 34 | Train Loss: 1.665 Vali Loss: 6.885 Vali Acc: 0.699 Test Loss: 6.885 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 17.50748062133789
Epoch: 30, Steps: 34 | Train Loss: 0.518 Vali Loss: 3.377 Vali Acc: 0.798 Test Loss: 3.377 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 18.366575479507446
Epoch: 31, Steps: 34 | Train Loss: 0.570 Vali Loss: 8.050 Vali Acc: 0.763 Test Loss: 8.050 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3435703
model size : 14.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.647292137145996
Epoch: 1, Steps: 34 | Train Loss: 3.300 Vali Loss: 3.745 Vali Acc: 0.283 Test Loss: 3.745 Test Acc: 0.283
Validation loss decreased (inf --> -0.283200).  Saving model ...
Epoch: 2 cost time: 15.60950493812561
Epoch: 2, Steps: 34 | Train Loss: 3.578 Vali Loss: 2.965 Vali Acc: 0.462 Test Loss: 2.965 Test Acc: 0.462
Validation loss decreased (-0.283200 --> -0.462398).  Saving model ...
Epoch: 3 cost time: 15.012776136398315
Epoch: 3, Steps: 34 | Train Loss: 7.020 Vali Loss: 9.992 Vali Acc: 0.416 Test Loss: 9.992 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.431679725646973
Epoch: 4, Steps: 34 | Train Loss: 6.588 Vali Loss: 3.916 Vali Acc: 0.578 Test Loss: 3.916 Test Acc: 0.578
Validation loss decreased (-0.462398 --> -0.577996).  Saving model ...
Epoch: 5 cost time: 15.445754051208496
Epoch: 5, Steps: 34 | Train Loss: 6.005 Vali Loss: 13.245 Vali Acc: 0.434 Test Loss: 13.245 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.42395281791687
Epoch: 6, Steps: 34 | Train Loss: 6.248 Vali Loss: 4.353 Vali Acc: 0.642 Test Loss: 4.353 Test Acc: 0.642
Validation loss decreased (-0.577996 --> -0.641575).  Saving model ...
Epoch: 7 cost time: 15.407102346420288
Epoch: 7, Steps: 34 | Train Loss: 2.792 Vali Loss: 4.057 Vali Acc: 0.659 Test Loss: 4.057 Test Acc: 0.659
Validation loss decreased (-0.641575 --> -0.658919).  Saving model ...
Epoch: 8 cost time: 15.387194156646729
Epoch: 8, Steps: 34 | Train Loss: 3.611 Vali Loss: 8.068 Vali Acc: 0.665 Test Loss: 8.068 Test Acc: 0.665
Validation loss decreased (-0.658919 --> -0.664659).  Saving model ...
Epoch: 9 cost time: 15.994124412536621
Epoch: 9, Steps: 34 | Train Loss: 4.394 Vali Loss: 5.650 Vali Acc: 0.740 Test Loss: 5.650 Test Acc: 0.740
Validation loss decreased (-0.664659 --> -0.739828).  Saving model ...
Epoch: 10 cost time: 14.067628860473633
Epoch: 10, Steps: 34 | Train Loss: 2.481 Vali Loss: 8.480 Vali Acc: 0.653 Test Loss: 8.480 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.277336597442627
Epoch: 11, Steps: 34 | Train Loss: 1.296 Vali Loss: 5.042 Vali Acc: 0.688 Test Loss: 5.042 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.74879789352417
Epoch: 12, Steps: 34 | Train Loss: 1.078 Vali Loss: 15.044 Vali Acc: 0.520 Test Loss: 15.044 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.833670616149902
Epoch: 13, Steps: 34 | Train Loss: 2.080 Vali Loss: 5.014 Vali Acc: 0.723 Test Loss: 5.014 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.13284683227539
Epoch: 14, Steps: 34 | Train Loss: 0.573 Vali Loss: 9.801 Vali Acc: 0.642 Test Loss: 9.801 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 16.585248708724976
Epoch: 15, Steps: 34 | Train Loss: 1.878 Vali Loss: 4.224 Vali Acc: 0.792 Test Loss: 4.224 Test Acc: 0.792
Validation loss decreased (-0.739828 --> -0.791865).  Saving model ...
Epoch: 16 cost time: 17.132115840911865
Epoch: 16, Steps: 34 | Train Loss: 0.706 Vali Loss: 4.884 Vali Acc: 0.734 Test Loss: 4.884 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 17.780268669128418
Epoch: 17, Steps: 34 | Train Loss: 0.788 Vali Loss: 7.578 Vali Acc: 0.671 Test Loss: 7.578 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 17.344311714172363
Epoch: 18, Steps: 34 | Train Loss: 0.630 Vali Loss: 3.435 Vali Acc: 0.769 Test Loss: 3.435 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.794946432113647
Epoch: 19, Steps: 34 | Train Loss: 0.209 Vali Loss: 6.980 Vali Acc: 0.746 Test Loss: 6.980 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.820807456970215
Epoch: 20, Steps: 34 | Train Loss: 0.489 Vali Loss: 8.320 Vali Acc: 0.653 Test Loss: 8.320 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 14.736509323120117
Epoch: 21, Steps: 34 | Train Loss: 0.595 Vali Loss: 6.627 Vali Acc: 0.780 Test Loss: 6.627 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.146284580230713
Epoch: 22, Steps: 34 | Train Loss: 0.313 Vali Loss: 6.117 Vali Acc: 0.763 Test Loss: 6.117 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 14.219791412353516
Epoch: 23, Steps: 34 | Train Loss: 0.355 Vali Loss: 9.530 Vali Acc: 0.775 Test Loss: 9.530 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.901795864105225
Epoch: 24, Steps: 34 | Train Loss: 0.359 Vali Loss: 4.174 Vali Acc: 0.815 Test Loss: 4.174 Test Acc: 0.815
Validation loss decreased (-0.791865 --> -0.814987).  Saving model ...
Epoch: 25 cost time: 14.422683000564575
Epoch: 25, Steps: 34 | Train Loss: 0.403 Vali Loss: 4.085 Vali Acc: 0.809 Test Loss: 4.085 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 16.1802077293396
Epoch: 26, Steps: 34 | Train Loss: 0.037 Vali Loss: 4.302 Vali Acc: 0.780 Test Loss: 4.302 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 14.773429870605469
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.358 Vali Acc: 0.821 Test Loss: 4.358 Test Acc: 0.821
Validation loss decreased (-0.814987 --> -0.820766).  Saving model ...
Epoch: 28 cost time: 15.104383945465088
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.367 Vali Acc: 0.821 Test Loss: 4.367 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 14.910847187042236
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 15.201534032821655
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 15.35983157157898
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 14.877339839935303
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 15.455713987350464
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 14.630062103271484
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 17.628474950790405
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.366 Vali Acc: 0.821 Test Loss: 4.366 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 14.279578447341919
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.365 Vali Acc: 0.821 Test Loss: 4.365 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 17.216010093688965
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.364 Vali Acc: 0.821 Test Loss: 4.364 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2977399
model size : 12.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.018157958984375
Epoch: 1, Steps: 34 | Train Loss: 3.267 Vali Loss: 3.291 Vali Acc: 0.243 Test Loss: 3.291 Test Acc: 0.243
Validation loss decreased (inf --> -0.242742).  Saving model ...
Epoch: 2 cost time: 15.21535325050354
Epoch: 2, Steps: 34 | Train Loss: 4.156 Vali Loss: 4.220 Vali Acc: 0.439 Test Loss: 4.220 Test Acc: 0.439
Validation loss decreased (-0.242742 --> -0.439264).  Saving model ...
Epoch: 3 cost time: 14.359379053115845
Epoch: 3, Steps: 34 | Train Loss: 4.346 Vali Loss: 3.164 Vali Acc: 0.474 Test Loss: 3.164 Test Acc: 0.474
Validation loss decreased (-0.439264 --> -0.473957).  Saving model ...
Epoch: 4 cost time: 15.016798734664917
Epoch: 4, Steps: 34 | Train Loss: 4.511 Vali Loss: 10.285 Vali Acc: 0.399 Test Loss: 10.285 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.23025107383728
Epoch: 5, Steps: 34 | Train Loss: 3.997 Vali Loss: 6.825 Vali Acc: 0.486 Test Loss: 6.825 Test Acc: 0.486
Validation loss decreased (-0.473957 --> -0.485481).  Saving model ...
Epoch: 6 cost time: 15.315374612808228
Epoch: 6, Steps: 34 | Train Loss: 4.034 Vali Loss: 7.415 Vali Acc: 0.590 Test Loss: 7.415 Test Acc: 0.590
Validation loss decreased (-0.485481 --> -0.589521).  Saving model ...
Epoch: 7 cost time: 14.225712060928345
Epoch: 7, Steps: 34 | Train Loss: 3.938 Vali Loss: 7.097 Vali Acc: 0.665 Test Loss: 7.097 Test Acc: 0.665
Validation loss decreased (-0.589521 --> -0.664669).  Saving model ...
Epoch: 8 cost time: 14.391690015792847
Epoch: 8, Steps: 34 | Train Loss: 3.828 Vali Loss: 6.111 Vali Acc: 0.630 Test Loss: 6.111 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.966867208480835
Epoch: 9, Steps: 34 | Train Loss: 1.899 Vali Loss: 5.958 Vali Acc: 0.636 Test Loss: 5.958 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.376051425933838
Epoch: 10, Steps: 34 | Train Loss: 2.899 Vali Loss: 2.834 Vali Acc: 0.780 Test Loss: 2.834 Test Acc: 0.780
Validation loss decreased (-0.664669 --> -0.780318).  Saving model ...
Epoch: 11 cost time: 15.418044805526733
Epoch: 11, Steps: 34 | Train Loss: 1.011 Vali Loss: 4.212 Vali Acc: 0.775 Test Loss: 4.212 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.376268863677979
Epoch: 12, Steps: 34 | Train Loss: 0.566 Vali Loss: 5.068 Vali Acc: 0.717 Test Loss: 5.068 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.096105813980103
Epoch: 13, Steps: 34 | Train Loss: 1.103 Vali Loss: 3.234 Vali Acc: 0.838 Test Loss: 3.234 Test Acc: 0.838
Validation loss decreased (-0.780318 --> -0.838118).  Saving model ...
Epoch: 14 cost time: 13.73054027557373
Epoch: 14, Steps: 34 | Train Loss: 0.513 Vali Loss: 6.047 Vali Acc: 0.688 Test Loss: 6.047 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.65511679649353
Epoch: 15, Steps: 34 | Train Loss: 0.353 Vali Loss: 5.517 Vali Acc: 0.682 Test Loss: 5.517 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.321136951446533
Epoch: 16, Steps: 34 | Train Loss: 0.714 Vali Loss: 11.421 Vali Acc: 0.601 Test Loss: 11.421 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.6524338722229
Epoch: 17, Steps: 34 | Train Loss: 0.785 Vali Loss: 4.037 Vali Acc: 0.786 Test Loss: 4.037 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 16.507871627807617
Epoch: 18, Steps: 34 | Train Loss: 1.586 Vali Loss: 4.409 Vali Acc: 0.751 Test Loss: 4.409 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 16.756880283355713
Epoch: 19, Steps: 34 | Train Loss: 0.192 Vali Loss: 6.452 Vali Acc: 0.780 Test Loss: 6.452 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.717053651809692
Epoch: 20, Steps: 34 | Train Loss: 0.247 Vali Loss: 3.790 Vali Acc: 0.803 Test Loss: 3.790 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 16.500991821289062
Epoch: 21, Steps: 34 | Train Loss: 0.487 Vali Loss: 5.294 Vali Acc: 0.769 Test Loss: 5.294 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 14.329994916915894
Epoch: 22, Steps: 34 | Train Loss: 0.425 Vali Loss: 5.694 Vali Acc: 0.757 Test Loss: 5.694 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 14.889548063278198
Epoch: 23, Steps: 34 | Train Loss: 0.862 Vali Loss: 2.048 Vali Acc: 0.850 Test Loss: 2.048 Test Acc: 0.850
Validation loss decreased (-0.838118 --> -0.849690).  Saving model ...
Epoch: 24 cost time: 12.64105486869812
Epoch: 24, Steps: 34 | Train Loss: 0.228 Vali Loss: 5.235 Vali Acc: 0.850 Test Loss: 5.235 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 14.301190853118896
Epoch: 25, Steps: 34 | Train Loss: 0.472 Vali Loss: 4.198 Vali Acc: 0.827 Test Loss: 4.198 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 14.46936583518982
Epoch: 26, Steps: 34 | Train Loss: 0.255 Vali Loss: 5.879 Vali Acc: 0.763 Test Loss: 5.879 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 15.10119366645813
Epoch: 27, Steps: 34 | Train Loss: 0.151 Vali Loss: 4.566 Vali Acc: 0.775 Test Loss: 4.566 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 14.409868955612183
Epoch: 28, Steps: 34 | Train Loss: 0.041 Vali Loss: 4.287 Vali Acc: 0.786 Test Loss: 4.287 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 14.926788091659546
Epoch: 29, Steps: 34 | Train Loss: 0.393 Vali Loss: 2.894 Vali Acc: 0.861 Test Loss: 2.894 Test Acc: 0.861
Validation loss decreased (-0.849690 --> -0.861243).  Saving model ...
Epoch: 30 cost time: 14.78165316581726
Epoch: 30, Steps: 34 | Train Loss: 0.054 Vali Loss: 4.570 Vali Acc: 0.827 Test Loss: 4.570 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 15.146449089050293
Epoch: 31, Steps: 34 | Train Loss: 0.092 Vali Loss: 2.742 Vali Acc: 0.855 Test Loss: 2.742 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 14.195501804351807
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.005 Vali Acc: 0.838 Test Loss: 3.005 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 14.32093095779419
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.778 Vali Acc: 0.838 Test Loss: 2.778 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 14.692957401275635
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.764 Vali Acc: 0.838 Test Loss: 2.764 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 14.921937465667725
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.758 Vali Acc: 0.838 Test Loss: 2.758 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 14.876102924346924
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.755 Vali Acc: 0.838 Test Loss: 2.755 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 13.375317811965942
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.751 Vali Acc: 0.838 Test Loss: 2.751 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 12.308896780014038
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.838 Test Loss: 2.658 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 16.781383514404297
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.652 Vali Acc: 0.838 Test Loss: 2.652 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 2976055
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.730580806732178
Epoch: 1, Steps: 34 | Train Loss: 3.025 Vali Loss: 5.096 Vali Acc: 0.266 Test Loss: 5.096 Test Acc: 0.266
Validation loss decreased (inf --> -0.265845).  Saving model ...
Epoch: 2 cost time: 15.270766735076904
Epoch: 2, Steps: 34 | Train Loss: 4.876 Vali Loss: 7.385 Vali Acc: 0.382 Test Loss: 7.385 Test Acc: 0.382
Validation loss decreased (-0.265845 --> -0.381429).  Saving model ...
Epoch: 3 cost time: 14.975077629089355
Epoch: 3, Steps: 34 | Train Loss: 6.467 Vali Loss: 15.967 Vali Acc: 0.364 Test Loss: 15.967 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.016263008117676
Epoch: 4, Steps: 34 | Train Loss: 5.019 Vali Loss: 5.524 Vali Acc: 0.555 Test Loss: 5.524 Test Acc: 0.555
Validation loss decreased (-0.381429 --> -0.554858).  Saving model ...
Epoch: 5 cost time: 14.767527341842651
Epoch: 5, Steps: 34 | Train Loss: 5.009 Vali Loss: 16.432 Vali Acc: 0.393 Test Loss: 16.432 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.123122215270996
Epoch: 6, Steps: 34 | Train Loss: 6.443 Vali Loss: 8.767 Vali Acc: 0.578 Test Loss: 8.767 Test Acc: 0.578
Validation loss decreased (-0.554858 --> -0.577947).  Saving model ...
Epoch: 7 cost time: 14.754983901977539
Epoch: 7, Steps: 34 | Train Loss: 4.410 Vali Loss: 5.327 Vali Acc: 0.665 Test Loss: 5.327 Test Acc: 0.665
Validation loss decreased (-0.577947 --> -0.664687).  Saving model ...
Epoch: 8 cost time: 14.83071231842041
Epoch: 8, Steps: 34 | Train Loss: 2.909 Vali Loss: 3.301 Vali Acc: 0.705 Test Loss: 3.301 Test Acc: 0.705
Validation loss decreased (-0.664687 --> -0.705169).  Saving model ...
Epoch: 9 cost time: 15.16286563873291
Epoch: 9, Steps: 34 | Train Loss: 2.017 Vali Loss: 17.855 Vali Acc: 0.445 Test Loss: 17.855 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.692923545837402
Epoch: 10, Steps: 34 | Train Loss: 3.477 Vali Loss: 7.590 Vali Acc: 0.538 Test Loss: 7.590 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.389726161956787
Epoch: 11, Steps: 34 | Train Loss: 1.621 Vali Loss: 9.528 Vali Acc: 0.624 Test Loss: 9.528 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.95777940750122
Epoch: 12, Steps: 34 | Train Loss: 1.830 Vali Loss: 6.320 Vali Acc: 0.694 Test Loss: 6.320 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.870760202407837
Epoch: 13, Steps: 34 | Train Loss: 1.947 Vali Loss: 4.342 Vali Acc: 0.780 Test Loss: 4.342 Test Acc: 0.780
Validation loss decreased (-0.705169 --> -0.780303).  Saving model ...
Epoch: 14 cost time: 14.82369589805603
Epoch: 14, Steps: 34 | Train Loss: 0.901 Vali Loss: 8.731 Vali Acc: 0.682 Test Loss: 8.731 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.077792882919312
Epoch: 15, Steps: 34 | Train Loss: 1.597 Vali Loss: 4.657 Vali Acc: 0.780 Test Loss: 4.657 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.142945528030396
Epoch: 16, Steps: 34 | Train Loss: 0.277 Vali Loss: 4.526 Vali Acc: 0.757 Test Loss: 4.526 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.739126920700073
Epoch: 17, Steps: 34 | Train Loss: 0.216 Vali Loss: 8.291 Vali Acc: 0.757 Test Loss: 8.291 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.06099843978882
Epoch: 18, Steps: 34 | Train Loss: 0.504 Vali Loss: 2.595 Vali Acc: 0.844 Test Loss: 2.595 Test Acc: 0.844
Validation loss decreased (-0.780303 --> -0.843905).  Saving model ...
Epoch: 19 cost time: 15.728441953659058
Epoch: 19, Steps: 34 | Train Loss: 1.443 Vali Loss: 3.377 Vali Acc: 0.850 Test Loss: 3.377 Test Acc: 0.850
Validation loss decreased (-0.843905 --> -0.849677).  Saving model ...
Epoch: 20 cost time: 16.361366271972656
Epoch: 20, Steps: 34 | Train Loss: 0.594 Vali Loss: 3.284 Vali Acc: 0.850 Test Loss: 3.284 Test Acc: 0.850
Validation loss decreased (-0.849677 --> -0.849678).  Saving model ...
Epoch: 21 cost time: 14.667207717895508
Epoch: 21, Steps: 34 | Train Loss: 1.309 Vali Loss: 5.097 Vali Acc: 0.815 Test Loss: 5.097 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 17.24239993095398
Epoch: 22, Steps: 34 | Train Loss: 0.171 Vali Loss: 7.307 Vali Acc: 0.775 Test Loss: 7.307 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 15.728447675704956
Epoch: 23, Steps: 34 | Train Loss: 0.128 Vali Loss: 3.538 Vali Acc: 0.832 Test Loss: 3.538 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 17.762800693511963
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.494 Vali Acc: 0.832 Test Loss: 3.494 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 13.312610387802124
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.472 Vali Acc: 0.832 Test Loss: 3.472 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.209748268127441
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.467 Vali Acc: 0.832 Test Loss: 3.467 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.779552698135376
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.465 Vali Acc: 0.832 Test Loss: 3.465 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 14.316337823867798
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.332 Vali Acc: 0.850 Test Loss: 3.332 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 14.602244853973389
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.315 Vali Acc: 0.850 Test Loss: 3.315 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 13.88661503791809
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.314 Vali Acc: 0.850 Test Loss: 3.314 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2974711
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.131094932556152
Epoch: 1, Steps: 34 | Train Loss: 2.743 Vali Loss: 3.054 Vali Acc: 0.382 Test Loss: 3.054 Test Acc: 0.382
Validation loss decreased (inf --> -0.381472).  Saving model ...
Epoch: 2 cost time: 14.083280801773071
Epoch: 2, Steps: 34 | Train Loss: 2.639 Vali Loss: 9.003 Vali Acc: 0.237 Test Loss: 9.003 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.607485294342041
Epoch: 3, Steps: 34 | Train Loss: 3.767 Vali Loss: 4.350 Vali Acc: 0.503 Test Loss: 4.350 Test Acc: 0.503
Validation loss decreased (-0.381472 --> -0.502847).  Saving model ...
Epoch: 4 cost time: 14.898614645004272
Epoch: 4, Steps: 34 | Train Loss: 4.207 Vali Loss: 6.930 Vali Acc: 0.549 Test Loss: 6.930 Test Acc: 0.549
Validation loss decreased (-0.502847 --> -0.549064).  Saving model ...
Epoch: 5 cost time: 13.00321912765503
Epoch: 5, Steps: 34 | Train Loss: 3.650 Vali Loss: 3.950 Vali Acc: 0.630 Test Loss: 3.950 Test Acc: 0.630
Validation loss decreased (-0.549064 --> -0.630018).  Saving model ...
Epoch: 6 cost time: 14.504780292510986
Epoch: 6, Steps: 34 | Train Loss: 2.905 Vali Loss: 6.664 Vali Acc: 0.572 Test Loss: 6.664 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.276209592819214
Epoch: 7, Steps: 34 | Train Loss: 3.680 Vali Loss: 4.739 Vali Acc: 0.572 Test Loss: 4.739 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.357652187347412
Epoch: 8, Steps: 34 | Train Loss: 2.053 Vali Loss: 1.939 Vali Acc: 0.769 Test Loss: 1.939 Test Acc: 0.769
Validation loss decreased (-0.630018 --> -0.768767).  Saving model ...
Epoch: 9 cost time: 13.720982313156128
Epoch: 9, Steps: 34 | Train Loss: 1.908 Vali Loss: 7.057 Vali Acc: 0.671 Test Loss: 7.057 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.44551157951355
Epoch: 10, Steps: 34 | Train Loss: 2.378 Vali Loss: 4.692 Vali Acc: 0.699 Test Loss: 4.692 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.215487480163574
Epoch: 11, Steps: 34 | Train Loss: 1.650 Vali Loss: 7.048 Vali Acc: 0.624 Test Loss: 7.048 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 15.679165363311768
Epoch: 12, Steps: 34 | Train Loss: 0.625 Vali Loss: 2.296 Vali Acc: 0.803 Test Loss: 2.296 Test Acc: 0.803
Validation loss decreased (-0.768767 --> -0.803445).  Saving model ...
Epoch: 13 cost time: 15.02645993232727
Epoch: 13, Steps: 34 | Train Loss: 0.641 Vali Loss: 3.190 Vali Acc: 0.803 Test Loss: 3.190 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.5333514213562
Epoch: 14, Steps: 34 | Train Loss: 0.579 Vali Loss: 10.680 Vali Acc: 0.590 Test Loss: 10.680 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.109841108322144
Epoch: 15, Steps: 34 | Train Loss: 0.939 Vali Loss: 11.651 Vali Acc: 0.613 Test Loss: 11.651 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.959446430206299
Epoch: 16, Steps: 34 | Train Loss: 1.901 Vali Loss: 9.079 Vali Acc: 0.723 Test Loss: 9.079 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.106811046600342
Epoch: 17, Steps: 34 | Train Loss: 1.251 Vali Loss: 4.699 Vali Acc: 0.723 Test Loss: 4.699 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.836099624633789
Epoch: 18, Steps: 34 | Train Loss: 0.737 Vali Loss: 5.150 Vali Acc: 0.798 Test Loss: 5.150 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.615896940231323
Epoch: 19, Steps: 34 | Train Loss: 0.931 Vali Loss: 2.766 Vali Acc: 0.809 Test Loss: 2.766 Test Acc: 0.809
Validation loss decreased (-0.803445 --> -0.809221).  Saving model ...
Epoch: 20 cost time: 13.07575798034668
Epoch: 20, Steps: 34 | Train Loss: 0.671 Vali Loss: 10.747 Vali Acc: 0.601 Test Loss: 10.747 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.020728826522827
Epoch: 21, Steps: 34 | Train Loss: 0.572 Vali Loss: 4.261 Vali Acc: 0.803 Test Loss: 4.261 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.921634912490845
Epoch: 22, Steps: 34 | Train Loss: 0.662 Vali Loss: 6.204 Vali Acc: 0.821 Test Loss: 6.204 Test Acc: 0.821
Validation loss decreased (-0.809221 --> -0.820747).  Saving model ...
Epoch: 23 cost time: 13.836764097213745
Epoch: 23, Steps: 34 | Train Loss: 0.110 Vali Loss: 5.181 Vali Acc: 0.757 Test Loss: 5.181 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 14.626666784286499
Epoch: 24, Steps: 34 | Train Loss: 0.052 Vali Loss: 11.798 Vali Acc: 0.659 Test Loss: 11.798 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 13.63375473022461
Epoch: 25, Steps: 34 | Train Loss: 1.407 Vali Loss: 12.433 Vali Acc: 0.647 Test Loss: 12.433 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 14.425657749176025
Epoch: 26, Steps: 34 | Train Loss: 0.186 Vali Loss: 4.304 Vali Acc: 0.809 Test Loss: 4.304 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.27333688735962
Epoch: 27, Steps: 34 | Train Loss: 0.198 Vali Loss: 3.958 Vali Acc: 0.815 Test Loss: 3.958 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 15.116212368011475
Epoch: 28, Steps: 34 | Train Loss: 0.139 Vali Loss: 5.424 Vali Acc: 0.792 Test Loss: 5.424 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.442536115646362
Epoch: 29, Steps: 34 | Train Loss: 0.027 Vali Loss: 4.784 Vali Acc: 0.798 Test Loss: 4.784 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 14.449296474456787
Epoch: 30, Steps: 34 | Train Loss: 0.010 Vali Loss: 7.766 Vali Acc: 0.705 Test Loss: 7.766 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 13.050070524215698
Epoch: 31, Steps: 34 | Train Loss: 0.117 Vali Loss: 6.960 Vali Acc: 0.803 Test Loss: 6.960 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 13.175337553024292
Epoch: 32, Steps: 34 | Train Loss: 0.295 Vali Loss: 5.211 Vali Acc: 0.717 Test Loss: 5.211 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2973367
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.270038843154907
Epoch: 1, Steps: 34 | Train Loss: 3.511 Vali Loss: 4.024 Vali Acc: 0.341 Test Loss: 4.024 Test Acc: 0.341
Validation loss decreased (inf --> -0.341000).  Saving model ...
Epoch: 2 cost time: 15.205155849456787
Epoch: 2, Steps: 34 | Train Loss: 4.145 Vali Loss: 3.731 Vali Acc: 0.416 Test Loss: 3.731 Test Acc: 0.416
Validation loss decreased (-0.341000 --> -0.416148).  Saving model ...
Epoch: 3 cost time: 15.181642055511475
Epoch: 3, Steps: 34 | Train Loss: 3.997 Vali Loss: 3.529 Vali Acc: 0.561 Test Loss: 3.529 Test Acc: 0.561
Validation loss decreased (-0.416148 --> -0.560658).  Saving model ...
Epoch: 4 cost time: 11.818751335144043
Epoch: 4, Steps: 34 | Train Loss: 3.769 Vali Loss: 3.918 Vali Acc: 0.705 Test Loss: 3.918 Test Acc: 0.705
Validation loss decreased (-0.560658 --> -0.705163).  Saving model ...
Epoch: 5 cost time: 14.179396152496338
Epoch: 5, Steps: 34 | Train Loss: 2.980 Vali Loss: 5.147 Vali Acc: 0.503 Test Loss: 5.147 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.274433612823486
Epoch: 6, Steps: 34 | Train Loss: 4.965 Vali Loss: 5.007 Vali Acc: 0.584 Test Loss: 5.007 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.282887935638428
Epoch: 7, Steps: 34 | Train Loss: 4.685 Vali Loss: 4.838 Vali Acc: 0.607 Test Loss: 4.838 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.367294549942017
Epoch: 8, Steps: 34 | Train Loss: 4.208 Vali Loss: 11.778 Vali Acc: 0.578 Test Loss: 11.778 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.000858545303345
Epoch: 9, Steps: 34 | Train Loss: 4.985 Vali Loss: 6.884 Vali Acc: 0.607 Test Loss: 6.884 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.42120885848999
Epoch: 10, Steps: 34 | Train Loss: 2.720 Vali Loss: 4.753 Vali Acc: 0.728 Test Loss: 4.753 Test Acc: 0.728
Validation loss decreased (-0.705163 --> -0.728276).  Saving model ...
Epoch: 11 cost time: 13.598507404327393
Epoch: 11, Steps: 34 | Train Loss: 1.702 Vali Loss: 5.849 Vali Acc: 0.717 Test Loss: 5.849 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.549597024917603
Epoch: 12, Steps: 34 | Train Loss: 0.154 Vali Loss: 12.069 Vali Acc: 0.630 Test Loss: 12.069 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.853447198867798
Epoch: 13, Steps: 34 | Train Loss: 1.592 Vali Loss: 6.126 Vali Acc: 0.711 Test Loss: 6.126 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.265976428985596
Epoch: 14, Steps: 34 | Train Loss: 0.763 Vali Loss: 14.322 Vali Acc: 0.665 Test Loss: 14.322 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.814301490783691
Epoch: 15, Steps: 34 | Train Loss: 5.455 Vali Loss: 4.661 Vali Acc: 0.757 Test Loss: 4.661 Test Acc: 0.757
Validation loss decreased (-0.728276 --> -0.757179).  Saving model ...
Epoch: 16 cost time: 14.447320222854614
Epoch: 16, Steps: 34 | Train Loss: 1.051 Vali Loss: 15.044 Vali Acc: 0.578 Test Loss: 15.044 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.194761514663696
Epoch: 17, Steps: 34 | Train Loss: 0.717 Vali Loss: 9.611 Vali Acc: 0.717 Test Loss: 9.611 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.429869651794434
Epoch: 18, Steps: 34 | Train Loss: 0.797 Vali Loss: 4.399 Vali Acc: 0.792 Test Loss: 4.399 Test Acc: 0.792
Validation loss decreased (-0.757179 --> -0.791864).  Saving model ...
Epoch: 19 cost time: 13.686192989349365
Epoch: 19, Steps: 34 | Train Loss: 0.102 Vali Loss: 8.351 Vali Acc: 0.694 Test Loss: 8.351 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.503607034683228
Epoch: 20, Steps: 34 | Train Loss: 0.025 Vali Loss: 2.667 Vali Acc: 0.821 Test Loss: 2.667 Test Acc: 0.821
Validation loss decreased (-0.791864 --> -0.820783).  Saving model ...
Epoch: 21 cost time: 15.150269746780396
Epoch: 21, Steps: 34 | Train Loss: 0.193 Vali Loss: 4.655 Vali Acc: 0.827 Test Loss: 4.655 Test Acc: 0.827
Validation loss decreased (-0.820783 --> -0.826543).  Saving model ...
Epoch: 22 cost time: 16.09724497795105
Epoch: 22, Steps: 34 | Train Loss: 0.778 Vali Loss: 4.565 Vali Acc: 0.757 Test Loss: 4.565 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.923084259033203
Epoch: 23, Steps: 34 | Train Loss: 0.794 Vali Loss: 9.813 Vali Acc: 0.775 Test Loss: 9.813 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.970612287521362
Epoch: 24, Steps: 34 | Train Loss: 0.329 Vali Loss: 5.287 Vali Acc: 0.798 Test Loss: 5.287 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 14.209925889968872
Epoch: 25, Steps: 34 | Train Loss: 1.017 Vali Loss: 19.046 Vali Acc: 0.601 Test Loss: 19.046 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 13.385907411575317
Epoch: 26, Steps: 34 | Train Loss: 2.138 Vali Loss: 5.364 Vali Acc: 0.844 Test Loss: 5.364 Test Acc: 0.844
Validation loss decreased (-0.826543 --> -0.843877).  Saving model ...
Epoch: 27 cost time: 13.920952558517456
Epoch: 27, Steps: 34 | Train Loss: 0.380 Vali Loss: 6.054 Vali Acc: 0.821 Test Loss: 6.054 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 12.973065853118896
Epoch: 28, Steps: 34 | Train Loss: 1.030 Vali Loss: 8.250 Vali Acc: 0.757 Test Loss: 8.250 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 14.174474477767944
Epoch: 29, Steps: 34 | Train Loss: 0.283 Vali Loss: 11.338 Vali Acc: 0.723 Test Loss: 11.338 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 13.291266202926636
Epoch: 30, Steps: 34 | Train Loss: 0.266 Vali Loss: 4.418 Vali Acc: 0.850 Test Loss: 4.418 Test Acc: 0.850
Validation loss decreased (-0.843877 --> -0.849667).  Saving model ...
Epoch: 31 cost time: 11.917093753814697
Epoch: 31, Steps: 34 | Train Loss: 0.137 Vali Loss: 3.635 Vali Acc: 0.850 Test Loss: 3.635 Test Acc: 0.850
Validation loss decreased (-0.849667 --> -0.849675).  Saving model ...
Epoch: 32 cost time: 14.18477201461792
Epoch: 32, Steps: 34 | Train Loss: 0.193 Vali Loss: 6.192 Vali Acc: 0.838 Test Loss: 6.192 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 12.168615818023682
Epoch: 33, Steps: 34 | Train Loss: 0.196 Vali Loss: 6.359 Vali Acc: 0.832 Test Loss: 6.359 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 10.394660711288452
Epoch: 34, Steps: 34 | Train Loss: 0.013 Vali Loss: 14.267 Vali Acc: 0.734 Test Loss: 14.267 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 13.687915086746216
Epoch: 35, Steps: 34 | Train Loss: 0.230 Vali Loss: 9.656 Vali Acc: 0.746 Test Loss: 9.656 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 14.073249578475952
Epoch: 36, Steps: 34 | Train Loss: 0.743 Vali Loss: 6.007 Vali Acc: 0.821 Test Loss: 6.007 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 13.751821994781494
Epoch: 37, Steps: 34 | Train Loss: 0.184 Vali Loss: 10.083 Vali Acc: 0.740 Test Loss: 10.083 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 13.933779954910278
Epoch: 38, Steps: 34 | Train Loss: 0.315 Vali Loss: 14.535 Vali Acc: 0.723 Test Loss: 14.535 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 11.973167657852173
Epoch: 39, Steps: 34 | Train Loss: 0.137 Vali Loss: 16.521 Vali Acc: 0.711 Test Loss: 16.521 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 14.186590909957886
Epoch: 40, Steps: 34 | Train Loss: 0.189 Vali Loss: 6.738 Vali Acc: 0.832 Test Loss: 6.738 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 14.25816297531128
Epoch: 41, Steps: 34 | Train Loss: 0.141 Vali Loss: 6.882 Vali Acc: 0.821 Test Loss: 6.882 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2746231
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.11373233795166
Epoch: 1, Steps: 34 | Train Loss: 2.444 Vali Loss: 1.917 Vali Acc: 0.439 Test Loss: 1.917 Test Acc: 0.439
Validation loss decreased (inf --> -0.439287).  Saving model ...
Epoch: 2 cost time: 15.841878175735474
Epoch: 2, Steps: 34 | Train Loss: 3.371 Vali Loss: 5.500 Vali Acc: 0.335 Test Loss: 5.500 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.937828063964844
Epoch: 3, Steps: 34 | Train Loss: 3.256 Vali Loss: 7.174 Vali Acc: 0.376 Test Loss: 7.174 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.3914315700531
Epoch: 4, Steps: 34 | Train Loss: 4.939 Vali Loss: 4.051 Vali Acc: 0.578 Test Loss: 4.051 Test Acc: 0.578
Validation loss decreased (-0.439287 --> -0.577994).  Saving model ...
Epoch: 5 cost time: 12.78309440612793
Epoch: 5, Steps: 34 | Train Loss: 5.020 Vali Loss: 7.991 Vali Acc: 0.555 Test Loss: 7.991 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.701793432235718
Epoch: 6, Steps: 34 | Train Loss: 6.021 Vali Loss: 5.299 Vali Acc: 0.578 Test Loss: 5.299 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.3818941116333
Epoch: 7, Steps: 34 | Train Loss: 2.929 Vali Loss: 14.769 Vali Acc: 0.561 Test Loss: 14.769 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.7417471408844
Epoch: 8, Steps: 34 | Train Loss: 5.688 Vali Loss: 4.783 Vali Acc: 0.723 Test Loss: 4.783 Test Acc: 0.723
Validation loss decreased (-0.577994 --> -0.722496).  Saving model ...
Epoch: 9 cost time: 13.503944158554077
Epoch: 9, Steps: 34 | Train Loss: 3.946 Vali Loss: 12.513 Vali Acc: 0.618 Test Loss: 12.513 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.879554986953735
Epoch: 10, Steps: 34 | Train Loss: 3.142 Vali Loss: 4.082 Vali Acc: 0.734 Test Loss: 4.082 Test Acc: 0.734
Validation loss decreased (-0.722496 --> -0.734063).  Saving model ...
Epoch: 11 cost time: 13.870764970779419
Epoch: 11, Steps: 34 | Train Loss: 0.941 Vali Loss: 15.753 Vali Acc: 0.705 Test Loss: 15.753 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.04324460029602
Epoch: 12, Steps: 34 | Train Loss: 3.708 Vali Loss: 3.050 Vali Acc: 0.803 Test Loss: 3.050 Test Acc: 0.803
Validation loss decreased (-0.734063 --> -0.803438).  Saving model ...
Epoch: 13 cost time: 14.186426401138306
Epoch: 13, Steps: 34 | Train Loss: 1.607 Vali Loss: 7.445 Vali Acc: 0.717 Test Loss: 7.445 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.899929523468018
Epoch: 14, Steps: 34 | Train Loss: 2.244 Vali Loss: 8.653 Vali Acc: 0.699 Test Loss: 8.653 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.614268779754639
Epoch: 15, Steps: 34 | Train Loss: 1.107 Vali Loss: 6.687 Vali Acc: 0.740 Test Loss: 6.687 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.624964952468872
Epoch: 16, Steps: 34 | Train Loss: 0.456 Vali Loss: 7.947 Vali Acc: 0.827 Test Loss: 7.947 Test Acc: 0.827
Validation loss decreased (-0.803438 --> -0.826510).  Saving model ...
Epoch: 17 cost time: 13.049715280532837
Epoch: 17, Steps: 34 | Train Loss: 0.960 Vali Loss: 6.127 Vali Acc: 0.775 Test Loss: 6.127 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.176470518112183
Epoch: 18, Steps: 34 | Train Loss: 0.909 Vali Loss: 6.094 Vali Acc: 0.740 Test Loss: 6.094 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.947295427322388
Epoch: 19, Steps: 34 | Train Loss: 0.841 Vali Loss: 11.602 Vali Acc: 0.711 Test Loss: 11.602 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.231854915618896
Epoch: 20, Steps: 34 | Train Loss: 0.674 Vali Loss: 8.225 Vali Acc: 0.780 Test Loss: 8.225 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.221898794174194
Epoch: 21, Steps: 34 | Train Loss: 0.593 Vali Loss: 2.765 Vali Acc: 0.832 Test Loss: 2.765 Test Acc: 0.832
Validation loss decreased (-0.826510 --> -0.832342).  Saving model ...
Epoch: 22 cost time: 14.886794328689575
Epoch: 22, Steps: 34 | Train Loss: 1.280 Vali Loss: 8.366 Vali Acc: 0.780 Test Loss: 8.366 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.710607528686523
Epoch: 23, Steps: 34 | Train Loss: 0.294 Vali Loss: 5.365 Vali Acc: 0.815 Test Loss: 5.365 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.820493698120117
Epoch: 24, Steps: 34 | Train Loss: 0.130 Vali Loss: 6.459 Vali Acc: 0.821 Test Loss: 6.459 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 15.45010256767273
Epoch: 25, Steps: 34 | Train Loss: 0.714 Vali Loss: 6.954 Vali Acc: 0.821 Test Loss: 6.954 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 13.447004318237305
Epoch: 26, Steps: 34 | Train Loss: 0.123 Vali Loss: 4.534 Vali Acc: 0.850 Test Loss: 4.534 Test Acc: 0.850
Validation loss decreased (-0.832342 --> -0.849666).  Saving model ...
Epoch: 27 cost time: 13.333662033081055
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.256 Vali Acc: 0.821 Test Loss: 5.256 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 13.459042310714722
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.956 Vali Acc: 0.827 Test Loss: 4.956 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 14.242437362670898
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.927 Vali Acc: 0.838 Test Loss: 4.927 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 12.755331039428711
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.884 Vali Acc: 0.838 Test Loss: 4.884 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 14.060922145843506
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.838 Test Loss: 4.880 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 11.776901245117188
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.861 Vali Acc: 0.838 Test Loss: 4.861 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 14.45436954498291
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.823 Vali Acc: 0.838 Test Loss: 4.823 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 13.317234516143799
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.818 Vali Acc: 0.838 Test Loss: 4.818 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 13.433142185211182
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.817 Vali Acc: 0.838 Test Loss: 4.817 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 13.334558248519897
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.798 Vali Acc: 0.838 Test Loss: 4.798 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2744887
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.690081119537354
Epoch: 1, Steps: 34 | Train Loss: 3.098 Vali Loss: 3.908 Vali Acc: 0.312 Test Loss: 3.908 Test Acc: 0.312
Validation loss decreased (inf --> -0.312100).  Saving model ...
Epoch: 2 cost time: 12.697160720825195
Epoch: 2, Steps: 34 | Train Loss: 5.035 Vali Loss: 3.585 Vali Acc: 0.468 Test Loss: 3.585 Test Acc: 0.468
Validation loss decreased (-0.312100 --> -0.468172).  Saving model ...
Epoch: 3 cost time: 9.988544464111328
Epoch: 3, Steps: 34 | Train Loss: 6.677 Vali Loss: 4.449 Vali Acc: 0.480 Test Loss: 4.449 Test Acc: 0.480
Validation loss decreased (-0.468172 --> -0.479724).  Saving model ...
Epoch: 4 cost time: 15.287225246429443
Epoch: 4, Steps: 34 | Train Loss: 2.981 Vali Loss: 11.643 Vali Acc: 0.468 Test Loss: 11.643 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.88347053527832
Epoch: 5, Steps: 34 | Train Loss: 5.096 Vali Loss: 6.139 Vali Acc: 0.671 Test Loss: 6.139 Test Acc: 0.671
Validation loss decreased (-0.479724 --> -0.670459).  Saving model ...
Epoch: 6 cost time: 15.343922853469849
Epoch: 6, Steps: 34 | Train Loss: 3.787 Vali Loss: 15.682 Vali Acc: 0.370 Test Loss: 15.682 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.004572629928589
Epoch: 7, Steps: 34 | Train Loss: 4.143 Vali Loss: 10.720 Vali Acc: 0.491 Test Loss: 10.720 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.567041873931885
Epoch: 8, Steps: 34 | Train Loss: 4.047 Vali Loss: 10.204 Vali Acc: 0.613 Test Loss: 10.204 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.103026628494263
Epoch: 9, Steps: 34 | Train Loss: 2.938 Vali Loss: 19.410 Vali Acc: 0.329 Test Loss: 19.410 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.365794658660889
Epoch: 10, Steps: 34 | Train Loss: 2.530 Vali Loss: 8.873 Vali Acc: 0.532 Test Loss: 8.873 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.09029245376587
Epoch: 11, Steps: 34 | Train Loss: 1.931 Vali Loss: 8.488 Vali Acc: 0.676 Test Loss: 8.488 Test Acc: 0.676
Validation loss decreased (-0.670459 --> -0.676216).  Saving model ...
Epoch: 12 cost time: 11.974234580993652
Epoch: 12, Steps: 34 | Train Loss: 1.413 Vali Loss: 3.811 Vali Acc: 0.763 Test Loss: 3.811 Test Acc: 0.763
Validation loss decreased (-0.676216 --> -0.762968).  Saving model ...
Epoch: 13 cost time: 13.920952558517456
Epoch: 13, Steps: 34 | Train Loss: 1.376 Vali Loss: 7.871 Vali Acc: 0.676 Test Loss: 7.871 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.373067617416382
Epoch: 14, Steps: 34 | Train Loss: 0.429 Vali Loss: 3.117 Vali Acc: 0.832 Test Loss: 3.117 Test Acc: 0.832
Validation loss decreased (-0.762968 --> -0.832339).  Saving model ...
Epoch: 15 cost time: 14.038453578948975
Epoch: 15, Steps: 34 | Train Loss: 0.525 Vali Loss: 10.274 Vali Acc: 0.711 Test Loss: 10.274 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.566824913024902
Epoch: 16, Steps: 34 | Train Loss: 2.434 Vali Loss: 7.470 Vali Acc: 0.711 Test Loss: 7.470 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.100716352462769
Epoch: 17, Steps: 34 | Train Loss: 0.893 Vali Loss: 9.700 Vali Acc: 0.717 Test Loss: 9.700 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.43900752067566
Epoch: 18, Steps: 34 | Train Loss: 1.620 Vali Loss: 5.967 Vali Acc: 0.803 Test Loss: 5.967 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 13.327259063720703
Epoch: 19, Steps: 34 | Train Loss: 0.794 Vali Loss: 7.860 Vali Acc: 0.717 Test Loss: 7.860 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.050903797149658
Epoch: 20, Steps: 34 | Train Loss: 0.794 Vali Loss: 9.947 Vali Acc: 0.723 Test Loss: 9.947 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.75890564918518
Epoch: 21, Steps: 34 | Train Loss: 0.237 Vali Loss: 3.437 Vali Acc: 0.850 Test Loss: 3.437 Test Acc: 0.850
Validation loss decreased (-0.832339 --> -0.849677).  Saving model ...
Epoch: 22 cost time: 13.780625820159912
Epoch: 22, Steps: 34 | Train Loss: 0.082 Vali Loss: 7.590 Vali Acc: 0.746 Test Loss: 7.590 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.986120462417603
Epoch: 23, Steps: 34 | Train Loss: 0.962 Vali Loss: 9.120 Vali Acc: 0.780 Test Loss: 9.120 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.91292428970337
Epoch: 24, Steps: 34 | Train Loss: 0.354 Vali Loss: 9.030 Vali Acc: 0.798 Test Loss: 9.030 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.804605484008789
Epoch: 25, Steps: 34 | Train Loss: 0.366 Vali Loss: 4.795 Vali Acc: 0.803 Test Loss: 4.795 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.968534708023071
Epoch: 26, Steps: 34 | Train Loss: 0.686 Vali Loss: 24.078 Vali Acc: 0.624 Test Loss: 24.078 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 14.725930213928223
Epoch: 27, Steps: 34 | Train Loss: 0.136 Vali Loss: 5.744 Vali Acc: 0.803 Test Loss: 5.744 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 14.833023071289062
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.290 Vali Acc: 0.844 Test Loss: 5.290 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 16.25267791748047
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.351 Vali Acc: 0.775 Test Loss: 7.351 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 15.070108890533447
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.490 Vali Acc: 0.775 Test Loss: 7.490 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 14.197181463241577
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.494 Vali Acc: 0.775 Test Loss: 7.494 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2743543
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.53584098815918
Epoch: 1, Steps: 34 | Train Loss: 3.944 Vali Loss: 6.820 Vali Acc: 0.156 Test Loss: 6.820 Test Acc: 0.156
Validation loss decreased (inf --> -0.156001).  Saving model ...
Epoch: 2 cost time: 12.21811294555664
Epoch: 2, Steps: 34 | Train Loss: 5.126 Vali Loss: 8.044 Vali Acc: 0.399 Test Loss: 8.044 Test Acc: 0.399
Validation loss decreased (-0.156001 --> -0.398763).  Saving model ...
Epoch: 3 cost time: 11.406278133392334
Epoch: 3, Steps: 34 | Train Loss: 4.151 Vali Loss: 3.201 Vali Acc: 0.538 Test Loss: 3.201 Test Acc: 0.538
Validation loss decreased (-0.398763 --> -0.537540).  Saving model ...
Epoch: 4 cost time: 11.784595489501953
Epoch: 4, Steps: 34 | Train Loss: 4.627 Vali Loss: 5.874 Vali Acc: 0.439 Test Loss: 5.874 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.557835817337036
Epoch: 5, Steps: 34 | Train Loss: 8.898 Vali Loss: 3.567 Vali Acc: 0.705 Test Loss: 3.567 Test Acc: 0.705
Validation loss decreased (-0.537540 --> -0.705167).  Saving model ...
Epoch: 6 cost time: 13.053602457046509
Epoch: 6, Steps: 34 | Train Loss: 7.109 Vali Loss: 4.337 Vali Acc: 0.601 Test Loss: 4.337 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.05481505393982
Epoch: 7, Steps: 34 | Train Loss: 4.169 Vali Loss: 6.721 Vali Acc: 0.636 Test Loss: 6.721 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.388039588928223
Epoch: 8, Steps: 34 | Train Loss: 4.961 Vali Loss: 5.661 Vali Acc: 0.595 Test Loss: 5.661 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.85635495185852
Epoch: 9, Steps: 34 | Train Loss: 4.601 Vali Loss: 4.103 Vali Acc: 0.740 Test Loss: 4.103 Test Acc: 0.740
Validation loss decreased (-0.705167 --> -0.739843).  Saving model ...
Epoch: 10 cost time: 11.445233821868896
Epoch: 10, Steps: 34 | Train Loss: 1.746 Vali Loss: 3.360 Vali Acc: 0.728 Test Loss: 3.360 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.971627950668335
Epoch: 11, Steps: 34 | Train Loss: 1.203 Vali Loss: 3.230 Vali Acc: 0.780 Test Loss: 3.230 Test Acc: 0.780
Validation loss decreased (-0.739843 --> -0.780315).  Saving model ...
Epoch: 12 cost time: 12.959112405776978
Epoch: 12, Steps: 34 | Train Loss: 1.475 Vali Loss: 4.155 Vali Acc: 0.815 Test Loss: 4.155 Test Acc: 0.815
Validation loss decreased (-0.780315 --> -0.814987).  Saving model ...
Epoch: 13 cost time: 11.785536050796509
Epoch: 13, Steps: 34 | Train Loss: 1.474 Vali Loss: 3.775 Vali Acc: 0.809 Test Loss: 3.775 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.558270931243896
Epoch: 14, Steps: 34 | Train Loss: 1.691 Vali Loss: 3.106 Vali Acc: 0.798 Test Loss: 3.106 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.40147352218628
Epoch: 15, Steps: 34 | Train Loss: 0.486 Vali Loss: 8.304 Vali Acc: 0.723 Test Loss: 8.304 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.714730501174927
Epoch: 16, Steps: 34 | Train Loss: 0.419 Vali Loss: 4.139 Vali Acc: 0.798 Test Loss: 4.139 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.561569690704346
Epoch: 17, Steps: 34 | Train Loss: 0.341 Vali Loss: 5.496 Vali Acc: 0.786 Test Loss: 5.496 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.292466402053833
Epoch: 18, Steps: 34 | Train Loss: 2.662 Vali Loss: 19.182 Vali Acc: 0.613 Test Loss: 19.182 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.047186136245728
Epoch: 19, Steps: 34 | Train Loss: 0.459 Vali Loss: 6.448 Vali Acc: 0.769 Test Loss: 6.448 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.33818793296814
Epoch: 20, Steps: 34 | Train Loss: 1.456 Vali Loss: 4.573 Vali Acc: 0.780 Test Loss: 4.573 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.206282615661621
Epoch: 21, Steps: 34 | Train Loss: 0.367 Vali Loss: 8.440 Vali Acc: 0.694 Test Loss: 8.440 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.991469860076904
Epoch: 22, Steps: 34 | Train Loss: 0.957 Vali Loss: 3.774 Vali Acc: 0.827 Test Loss: 3.774 Test Acc: 0.827
Validation loss decreased (-0.814987 --> -0.826552).  Saving model ...
Epoch: 23 cost time: 13.080639362335205
Epoch: 23, Steps: 34 | Train Loss: 0.068 Vali Loss: 7.403 Vali Acc: 0.751 Test Loss: 7.403 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.759032011032104
Epoch: 24, Steps: 34 | Train Loss: 0.070 Vali Loss: 12.192 Vali Acc: 0.757 Test Loss: 12.192 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.881046533584595
Epoch: 25, Steps: 34 | Train Loss: 0.782 Vali Loss: 5.077 Vali Acc: 0.769 Test Loss: 5.077 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.578159809112549
Epoch: 26, Steps: 34 | Train Loss: 0.438 Vali Loss: 4.773 Vali Acc: 0.803 Test Loss: 4.773 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.733083486557007
Epoch: 27, Steps: 34 | Train Loss: 0.336 Vali Loss: 4.896 Vali Acc: 0.775 Test Loss: 4.896 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.432293176651001
Epoch: 28, Steps: 34 | Train Loss: 1.070 Vali Loss: 13.533 Vali Acc: 0.740 Test Loss: 13.533 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.508917808532715
Epoch: 29, Steps: 34 | Train Loss: 0.344 Vali Loss: 5.058 Vali Acc: 0.792 Test Loss: 5.058 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 12.76941990852356
Epoch: 30, Steps: 34 | Train Loss: 0.209 Vali Loss: 4.006 Vali Acc: 0.855 Test Loss: 4.006 Test Acc: 0.855
Validation loss decreased (-0.826552 --> -0.855451).  Saving model ...
Epoch: 31 cost time: 12.118893384933472
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.871 Vali Acc: 0.792 Test Loss: 5.871 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 12.823806524276733
Epoch: 32, Steps: 34 | Train Loss: 0.085 Vali Loss: 5.138 Vali Acc: 0.798 Test Loss: 5.138 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 11.854387521743774
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.790 Vali Acc: 0.798 Test Loss: 5.790 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 12.847789764404297
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.805 Vali Acc: 0.798 Test Loss: 5.805 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 12.0565767288208
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.705 Vali Acc: 0.798 Test Loss: 5.705 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 11.431249856948853
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.681 Vali Acc: 0.798 Test Loss: 5.681 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 13.731523275375366
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.678 Vali Acc: 0.798 Test Loss: 5.678 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 14.393935441970825
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.651 Vali Acc: 0.798 Test Loss: 5.651 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 13.398858785629272
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.642 Vali Acc: 0.798 Test Loss: 5.642 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 12.598276853561401
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.642 Vali Acc: 0.798 Test Loss: 5.642 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2742199
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.414975643157959
Epoch: 1, Steps: 34 | Train Loss: 3.723 Vali Loss: 4.267 Vali Acc: 0.399 Test Loss: 4.267 Test Acc: 0.399
Validation loss decreased (inf --> -0.398801).  Saving model ...
Epoch: 2 cost time: 13.504333734512329
Epoch: 2, Steps: 34 | Train Loss: 3.738 Vali Loss: 3.907 Vali Acc: 0.347 Test Loss: 3.907 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.941686630249023
Epoch: 3, Steps: 34 | Train Loss: 2.877 Vali Loss: 4.700 Vali Acc: 0.462 Test Loss: 4.700 Test Acc: 0.462
Validation loss decreased (-0.398801 --> -0.462381).  Saving model ...
Epoch: 4 cost time: 11.098992824554443
Epoch: 4, Steps: 34 | Train Loss: 5.685 Vali Loss: 4.735 Vali Acc: 0.486 Test Loss: 4.735 Test Acc: 0.486
Validation loss decreased (-0.462381 --> -0.485502).  Saving model ...
Epoch: 5 cost time: 10.918441534042358
Epoch: 5, Steps: 34 | Train Loss: 3.214 Vali Loss: 4.499 Vali Acc: 0.601 Test Loss: 4.499 Test Acc: 0.601
Validation loss decreased (-0.485502 --> -0.601111).  Saving model ...
Epoch: 6 cost time: 13.365931272506714
Epoch: 6, Steps: 34 | Train Loss: 3.059 Vali Loss: 4.155 Vali Acc: 0.607 Test Loss: 4.155 Test Acc: 0.607
Validation loss decreased (-0.601111 --> -0.606895).  Saving model ...
Epoch: 7 cost time: 12.652498722076416
Epoch: 7, Steps: 34 | Train Loss: 2.834 Vali Loss: 3.465 Vali Acc: 0.665 Test Loss: 3.465 Test Acc: 0.665
Validation loss decreased (-0.606895 --> -0.664705).  Saving model ...
Epoch: 8 cost time: 13.14811897277832
Epoch: 8, Steps: 34 | Train Loss: 1.980 Vali Loss: 3.712 Vali Acc: 0.665 Test Loss: 3.712 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.202032327651978
Epoch: 9, Steps: 34 | Train Loss: 1.479 Vali Loss: 4.468 Vali Acc: 0.630 Test Loss: 4.468 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.965588331222534
Epoch: 10, Steps: 34 | Train Loss: 2.052 Vali Loss: 6.185 Vali Acc: 0.723 Test Loss: 6.185 Test Acc: 0.723
Validation loss decreased (-0.664705 --> -0.722482).  Saving model ...
Epoch: 11 cost time: 12.913694381713867
Epoch: 11, Steps: 34 | Train Loss: 1.608 Vali Loss: 3.023 Vali Acc: 0.769 Test Loss: 3.023 Test Acc: 0.769
Validation loss decreased (-0.722482 --> -0.768756).  Saving model ...
Epoch: 12 cost time: 12.332226753234863
Epoch: 12, Steps: 34 | Train Loss: 0.431 Vali Loss: 3.599 Vali Acc: 0.803 Test Loss: 3.599 Test Acc: 0.803
Validation loss decreased (-0.768756 --> -0.803432).  Saving model ...
Epoch: 13 cost time: 13.052373170852661
Epoch: 13, Steps: 34 | Train Loss: 0.384 Vali Loss: 3.084 Vali Acc: 0.803 Test Loss: 3.084 Test Acc: 0.803
Validation loss decreased (-0.803432 --> -0.803437).  Saving model ...
Epoch: 14 cost time: 12.294222354888916
Epoch: 14, Steps: 34 | Train Loss: 0.140 Vali Loss: 8.492 Vali Acc: 0.607 Test Loss: 8.492 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.190648317337036
Epoch: 15, Steps: 34 | Train Loss: 0.692 Vali Loss: 3.776 Vali Acc: 0.740 Test Loss: 3.776 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.63232684135437
Epoch: 16, Steps: 34 | Train Loss: 1.100 Vali Loss: 11.019 Vali Acc: 0.728 Test Loss: 11.019 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.199651718139648
Epoch: 17, Steps: 34 | Train Loss: 0.868 Vali Loss: 5.216 Vali Acc: 0.798 Test Loss: 5.216 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.584394693374634
Epoch: 18, Steps: 34 | Train Loss: 0.611 Vali Loss: 10.271 Vali Acc: 0.647 Test Loss: 10.271 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.371422529220581
Epoch: 19, Steps: 34 | Train Loss: 0.830 Vali Loss: 6.455 Vali Acc: 0.763 Test Loss: 6.455 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.396698474884033
Epoch: 20, Steps: 34 | Train Loss: 3.424 Vali Loss: 6.201 Vali Acc: 0.775 Test Loss: 6.201 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 14.730732202529907
Epoch: 21, Steps: 34 | Train Loss: 1.379 Vali Loss: 4.730 Vali Acc: 0.821 Test Loss: 4.730 Test Acc: 0.821
Validation loss decreased (-0.803437 --> -0.820762).  Saving model ...
Epoch: 22 cost time: 14.194564580917358
Epoch: 22, Steps: 34 | Train Loss: 0.244 Vali Loss: 10.696 Vali Acc: 0.705 Test Loss: 10.696 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.357261419296265
Epoch: 23, Steps: 34 | Train Loss: 1.331 Vali Loss: 4.421 Vali Acc: 0.815 Test Loss: 4.421 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.847241878509521
Epoch: 24, Steps: 34 | Train Loss: 1.562 Vali Loss: 17.427 Vali Acc: 0.671 Test Loss: 17.427 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.124829769134521
Epoch: 25, Steps: 34 | Train Loss: 1.070 Vali Loss: 9.447 Vali Acc: 0.780 Test Loss: 9.447 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 13.351978063583374
Epoch: 26, Steps: 34 | Train Loss: 0.705 Vali Loss: 9.202 Vali Acc: 0.780 Test Loss: 9.202 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 12.088690042495728
Epoch: 27, Steps: 34 | Train Loss: 1.169 Vali Loss: 8.432 Vali Acc: 0.769 Test Loss: 8.432 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 12.580363988876343
Epoch: 28, Steps: 34 | Train Loss: 0.029 Vali Loss: 8.424 Vali Acc: 0.821 Test Loss: 8.424 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.83852744102478
Epoch: 29, Steps: 34 | Train Loss: 0.776 Vali Loss: 15.537 Vali Acc: 0.694 Test Loss: 15.537 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 12.997264862060547
Epoch: 30, Steps: 34 | Train Loss: 0.353 Vali Loss: 8.891 Vali Acc: 0.746 Test Loss: 8.891 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 12.641335487365723
Epoch: 31, Steps: 34 | Train Loss: 0.197 Vali Loss: 8.003 Vali Acc: 0.809 Test Loss: 8.003 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2630647
model size : 11.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.623412132263184
Epoch: 1, Steps: 34 | Train Loss: 3.394 Vali Loss: 4.810 Vali Acc: 0.318 Test Loss: 4.810 Test Acc: 0.318
Validation loss decreased (inf --> -0.317871).  Saving model ...
Epoch: 2 cost time: 12.972333431243896
Epoch: 2, Steps: 34 | Train Loss: 2.399 Vali Loss: 5.272 Vali Acc: 0.301 Test Loss: 5.272 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.212382793426514
Epoch: 3, Steps: 34 | Train Loss: 4.274 Vali Loss: 5.344 Vali Acc: 0.514 Test Loss: 5.344 Test Acc: 0.514
Validation loss decreased (-0.317871 --> -0.514397).  Saving model ...
Epoch: 4 cost time: 11.708500862121582
Epoch: 4, Steps: 34 | Train Loss: 4.573 Vali Loss: 9.860 Vali Acc: 0.347 Test Loss: 9.860 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.950013160705566
Epoch: 5, Steps: 34 | Train Loss: 7.437 Vali Loss: 10.952 Vali Acc: 0.428 Test Loss: 10.952 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.043519973754883
Epoch: 6, Steps: 34 | Train Loss: 4.175 Vali Loss: 3.327 Vali Acc: 0.682 Test Loss: 3.327 Test Acc: 0.682
Validation loss decreased (-0.514397 --> -0.682048).  Saving model ...
Epoch: 7 cost time: 12.673439025878906
Epoch: 7, Steps: 34 | Train Loss: 3.486 Vali Loss: 3.756 Vali Acc: 0.734 Test Loss: 3.756 Test Acc: 0.734
Validation loss decreased (-0.682048 --> -0.734066).  Saving model ...
Epoch: 8 cost time: 13.299763917922974
Epoch: 8, Steps: 34 | Train Loss: 3.140 Vali Loss: 12.114 Vali Acc: 0.590 Test Loss: 12.114 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.70274829864502
Epoch: 9, Steps: 34 | Train Loss: 2.437 Vali Loss: 7.689 Vali Acc: 0.665 Test Loss: 7.689 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.204944849014282
Epoch: 10, Steps: 34 | Train Loss: 2.233 Vali Loss: 4.384 Vali Acc: 0.699 Test Loss: 4.384 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.378980875015259
Epoch: 11, Steps: 34 | Train Loss: 1.540 Vali Loss: 8.282 Vali Acc: 0.642 Test Loss: 8.282 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.379261493682861
Epoch: 12, Steps: 34 | Train Loss: 3.673 Vali Loss: 7.111 Vali Acc: 0.636 Test Loss: 7.111 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.135253667831421
Epoch: 13, Steps: 34 | Train Loss: 0.783 Vali Loss: 3.544 Vali Acc: 0.757 Test Loss: 3.544 Test Acc: 0.757
Validation loss decreased (-0.734066 --> -0.757190).  Saving model ...
Epoch: 14 cost time: 13.282333135604858
Epoch: 14, Steps: 34 | Train Loss: 0.555 Vali Loss: 5.248 Vali Acc: 0.676 Test Loss: 5.248 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.788363218307495
Epoch: 15, Steps: 34 | Train Loss: 0.489 Vali Loss: 3.288 Vali Acc: 0.815 Test Loss: 3.288 Test Acc: 0.815
Validation loss decreased (-0.757190 --> -0.814996).  Saving model ...
Epoch: 16 cost time: 12.868077039718628
Epoch: 16, Steps: 34 | Train Loss: 0.529 Vali Loss: 12.100 Vali Acc: 0.607 Test Loss: 12.100 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.552712440490723
Epoch: 17, Steps: 34 | Train Loss: 0.983 Vali Loss: 9.720 Vali Acc: 0.647 Test Loss: 9.720 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.594286441802979
Epoch: 18, Steps: 34 | Train Loss: 0.896 Vali Loss: 10.958 Vali Acc: 0.665 Test Loss: 10.958 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.841937065124512
Epoch: 19, Steps: 34 | Train Loss: 1.188 Vali Loss: 20.027 Vali Acc: 0.520 Test Loss: 20.027 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 12.476735591888428
Epoch: 20, Steps: 34 | Train Loss: 2.597 Vali Loss: 5.506 Vali Acc: 0.763 Test Loss: 5.506 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.72264575958252
Epoch: 21, Steps: 34 | Train Loss: 0.627 Vali Loss: 10.537 Vali Acc: 0.740 Test Loss: 10.537 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 13.002298593521118
Epoch: 22, Steps: 34 | Train Loss: 0.470 Vali Loss: 6.540 Vali Acc: 0.809 Test Loss: 6.540 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 12.14119839668274
Epoch: 23, Steps: 34 | Train Loss: 0.590 Vali Loss: 5.631 Vali Acc: 0.769 Test Loss: 5.631 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 11.620847940444946
Epoch: 24, Steps: 34 | Train Loss: 0.408 Vali Loss: 11.224 Vali Acc: 0.723 Test Loss: 11.224 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 12.600063800811768
Epoch: 25, Steps: 34 | Train Loss: 0.131 Vali Loss: 5.878 Vali Acc: 0.786 Test Loss: 5.878 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2629303
model size : 11.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.253273010253906
Epoch: 1, Steps: 34 | Train Loss: 2.916 Vali Loss: 3.254 Vali Acc: 0.312 Test Loss: 3.254 Test Acc: 0.312
Validation loss decreased (inf --> -0.312106).  Saving model ...
Epoch: 2 cost time: 11.782979249954224
Epoch: 2, Steps: 34 | Train Loss: 2.734 Vali Loss: 4.389 Vali Acc: 0.341 Test Loss: 4.389 Test Acc: 0.341
Validation loss decreased (-0.312106 --> -0.340997).  Saving model ...
Epoch: 3 cost time: 12.738775968551636
Epoch: 3, Steps: 34 | Train Loss: 2.424 Vali Loss: 2.885 Vali Acc: 0.572 Test Loss: 2.885 Test Acc: 0.572
Validation loss decreased (-0.340997 --> -0.572225).  Saving model ...
Epoch: 4 cost time: 11.267146348953247
Epoch: 4, Steps: 34 | Train Loss: 4.040 Vali Loss: 8.606 Vali Acc: 0.387 Test Loss: 8.606 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.32980465888977
Epoch: 5, Steps: 34 | Train Loss: 6.872 Vali Loss: 27.667 Vali Acc: 0.318 Test Loss: 27.667 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.405698537826538
Epoch: 6, Steps: 34 | Train Loss: 9.202 Vali Loss: 16.862 Vali Acc: 0.410 Test Loss: 16.862 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.837773561477661
Epoch: 7, Steps: 34 | Train Loss: 6.103 Vali Loss: 7.374 Vali Acc: 0.590 Test Loss: 7.374 Test Acc: 0.590
Validation loss decreased (-0.572225 --> -0.589522).  Saving model ...
Epoch: 8 cost time: 13.525284767150879
Epoch: 8, Steps: 34 | Train Loss: 2.386 Vali Loss: 9.492 Vali Acc: 0.572 Test Loss: 9.492 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.325000524520874
Epoch: 9, Steps: 34 | Train Loss: 1.855 Vali Loss: 4.854 Vali Acc: 0.688 Test Loss: 4.854 Test Acc: 0.688
Validation loss decreased (-0.589522 --> -0.687813).  Saving model ...
Epoch: 10 cost time: 12.975951671600342
Epoch: 10, Steps: 34 | Train Loss: 3.250 Vali Loss: 9.773 Vali Acc: 0.538 Test Loss: 9.773 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.843668222427368
Epoch: 11, Steps: 34 | Train Loss: 2.580 Vali Loss: 3.320 Vali Acc: 0.803 Test Loss: 3.320 Test Acc: 0.803
Validation loss decreased (-0.687813 --> -0.803435).  Saving model ...
Epoch: 12 cost time: 12.478271007537842
Epoch: 12, Steps: 34 | Train Loss: 1.705 Vali Loss: 10.539 Vali Acc: 0.711 Test Loss: 10.539 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.335521697998047
Epoch: 13, Steps: 34 | Train Loss: 1.690 Vali Loss: 7.431 Vali Acc: 0.659 Test Loss: 7.431 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.303416013717651
Epoch: 14, Steps: 34 | Train Loss: 0.728 Vali Loss: 5.263 Vali Acc: 0.792 Test Loss: 5.263 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.163268566131592
Epoch: 15, Steps: 34 | Train Loss: 3.016 Vali Loss: 6.598 Vali Acc: 0.728 Test Loss: 6.598 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.184590339660645
Epoch: 16, Steps: 34 | Train Loss: 1.872 Vali Loss: 8.706 Vali Acc: 0.723 Test Loss: 8.706 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.53210163116455
Epoch: 17, Steps: 34 | Train Loss: 0.752 Vali Loss: 4.738 Vali Acc: 0.855 Test Loss: 4.738 Test Acc: 0.855
Validation loss decreased (-0.803435 --> -0.855444).  Saving model ...
Epoch: 18 cost time: 12.12062954902649
Epoch: 18, Steps: 34 | Train Loss: 0.790 Vali Loss: 3.630 Vali Acc: 0.827 Test Loss: 3.630 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.196640491485596
Epoch: 19, Steps: 34 | Train Loss: 1.023 Vali Loss: 3.896 Vali Acc: 0.798 Test Loss: 3.896 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.744457483291626
Epoch: 20, Steps: 34 | Train Loss: 0.556 Vali Loss: 17.362 Vali Acc: 0.653 Test Loss: 17.362 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 13.312098503112793
Epoch: 21, Steps: 34 | Train Loss: 2.906 Vali Loss: 8.825 Vali Acc: 0.751 Test Loss: 8.825 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.174676895141602
Epoch: 22, Steps: 34 | Train Loss: 0.755 Vali Loss: 5.063 Vali Acc: 0.792 Test Loss: 5.063 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 13.100695848464966
Epoch: 23, Steps: 34 | Train Loss: 0.798 Vali Loss: 5.977 Vali Acc: 0.850 Test Loss: 5.977 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.638164281845093
Epoch: 24, Steps: 34 | Train Loss: 0.297 Vali Loss: 8.127 Vali Acc: 0.815 Test Loss: 8.127 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.569207429885864
Epoch: 25, Steps: 34 | Train Loss: 0.455 Vali Loss: 5.423 Vali Acc: 0.850 Test Loss: 5.423 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 12.807514905929565
Epoch: 26, Steps: 34 | Train Loss: 0.123 Vali Loss: 4.269 Vali Acc: 0.873 Test Loss: 4.269 Test Acc: 0.873
Validation loss decreased (-0.855444 --> -0.872790).  Saving model ...
Epoch: 27 cost time: 14.362525224685669
Epoch: 27, Steps: 34 | Train Loss: 0.066 Vali Loss: 5.768 Vali Acc: 0.815 Test Loss: 5.768 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 13.981063842773438
Epoch: 28, Steps: 34 | Train Loss: 0.170 Vali Loss: 5.112 Vali Acc: 0.827 Test Loss: 5.112 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 13.726023197174072
Epoch: 29, Steps: 34 | Train Loss: 0.395 Vali Loss: 4.472 Vali Acc: 0.815 Test Loss: 4.472 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 14.45703411102295
Epoch: 30, Steps: 34 | Train Loss: 0.110 Vali Loss: 5.475 Vali Acc: 0.844 Test Loss: 5.475 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 14.364733457565308
Epoch: 31, Steps: 34 | Train Loss: 0.168 Vali Loss: 4.027 Vali Acc: 0.838 Test Loss: 4.027 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 13.095543622970581
Epoch: 32, Steps: 34 | Train Loss: 0.001 Vali Loss: 5.375 Vali Acc: 0.815 Test Loss: 5.375 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 11.910772800445557
Epoch: 33, Steps: 34 | Train Loss: 0.063 Vali Loss: 5.659 Vali Acc: 0.815 Test Loss: 5.659 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 12.96143651008606
Epoch: 34, Steps: 34 | Train Loss: 0.004 Vali Loss: 4.148 Vali Acc: 0.844 Test Loss: 4.148 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 12.588137865066528
Epoch: 35, Steps: 34 | Train Loss: 0.041 Vali Loss: 6.513 Vali Acc: 0.832 Test Loss: 6.513 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 13.219707489013672
Epoch: 36, Steps: 34 | Train Loss: 0.028 Vali Loss: 8.526 Vali Acc: 0.798 Test Loss: 8.526 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 2627959
model size : 11.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.638937711715698
Epoch: 1, Steps: 34 | Train Loss: 3.157 Vali Loss: 4.579 Vali Acc: 0.318 Test Loss: 4.579 Test Acc: 0.318
Validation loss decreased (inf --> -0.317873).  Saving model ...
Epoch: 2 cost time: 11.86306357383728
Epoch: 2, Steps: 34 | Train Loss: 5.122 Vali Loss: 8.794 Vali Acc: 0.283 Test Loss: 8.794 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.846396923065186
Epoch: 3, Steps: 34 | Train Loss: 5.533 Vali Loss: 4.593 Vali Acc: 0.543 Test Loss: 4.593 Test Acc: 0.543
Validation loss decreased (-0.317873 --> -0.543307).  Saving model ...
Epoch: 4 cost time: 11.509468793869019
Epoch: 4, Steps: 34 | Train Loss: 3.479 Vali Loss: 5.524 Vali Acc: 0.451 Test Loss: 5.524 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.276421070098877
Epoch: 5, Steps: 34 | Train Loss: 5.206 Vali Loss: 9.256 Vali Acc: 0.555 Test Loss: 9.256 Test Acc: 0.555
Validation loss decreased (-0.543307 --> -0.554821).  Saving model ...
Epoch: 6 cost time: 11.942615032196045
Epoch: 6, Steps: 34 | Train Loss: 8.328 Vali Loss: 9.626 Vali Acc: 0.497 Test Loss: 9.626 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.069862127304077
Epoch: 7, Steps: 34 | Train Loss: 3.542 Vali Loss: 5.895 Vali Acc: 0.676 Test Loss: 5.895 Test Acc: 0.676
Validation loss decreased (-0.554821 --> -0.676242).  Saving model ...
Epoch: 8 cost time: 11.843192338943481
Epoch: 8, Steps: 34 | Train Loss: 3.661 Vali Loss: 3.933 Vali Acc: 0.682 Test Loss: 3.933 Test Acc: 0.682
Validation loss decreased (-0.676242 --> -0.682042).  Saving model ...
Epoch: 9 cost time: 11.925488710403442
Epoch: 9, Steps: 34 | Train Loss: 3.067 Vali Loss: 7.693 Vali Acc: 0.526 Test Loss: 7.693 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.946434020996094
Epoch: 10, Steps: 34 | Train Loss: 1.833 Vali Loss: 6.715 Vali Acc: 0.578 Test Loss: 6.715 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.082412004470825
Epoch: 11, Steps: 34 | Train Loss: 0.646 Vali Loss: 4.755 Vali Acc: 0.798 Test Loss: 4.755 Test Acc: 0.798
Validation loss decreased (-0.682042 --> -0.797640).  Saving model ...
Epoch: 12 cost time: 12.196924686431885
Epoch: 12, Steps: 34 | Train Loss: 1.140 Vali Loss: 6.257 Vali Acc: 0.763 Test Loss: 6.257 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.701194286346436
Epoch: 13, Steps: 34 | Train Loss: 1.462 Vali Loss: 3.382 Vali Acc: 0.821 Test Loss: 3.382 Test Acc: 0.821
Validation loss decreased (-0.797640 --> -0.820775).  Saving model ...
Epoch: 14 cost time: 13.842400312423706
Epoch: 14, Steps: 34 | Train Loss: 0.581 Vali Loss: 13.601 Vali Acc: 0.578 Test Loss: 13.601 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.636452674865723
Epoch: 15, Steps: 34 | Train Loss: 1.474 Vali Loss: 3.044 Vali Acc: 0.832 Test Loss: 3.044 Test Acc: 0.832
Validation loss decreased (-0.820775 --> -0.832339).  Saving model ...
Epoch: 16 cost time: 12.40132737159729
Epoch: 16, Steps: 34 | Train Loss: 0.608 Vali Loss: 14.552 Vali Acc: 0.566 Test Loss: 14.552 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.194593906402588
Epoch: 17, Steps: 34 | Train Loss: 0.748 Vali Loss: 4.940 Vali Acc: 0.809 Test Loss: 4.940 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.768713474273682
Epoch: 18, Steps: 34 | Train Loss: 0.405 Vali Loss: 5.084 Vali Acc: 0.711 Test Loss: 5.084 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.820942163467407
Epoch: 19, Steps: 34 | Train Loss: 0.232 Vali Loss: 3.157 Vali Acc: 0.798 Test Loss: 3.157 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.138442516326904
Epoch: 20, Steps: 34 | Train Loss: 0.287 Vali Loss: 6.405 Vali Acc: 0.728 Test Loss: 6.405 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.421518564224243
Epoch: 21, Steps: 34 | Train Loss: 0.651 Vali Loss: 6.690 Vali Acc: 0.740 Test Loss: 6.690 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.020544290542603
Epoch: 22, Steps: 34 | Train Loss: 1.787 Vali Loss: 4.890 Vali Acc: 0.838 Test Loss: 4.890 Test Acc: 0.838
Validation loss decreased (-0.832339 --> -0.838101).  Saving model ...
Epoch: 23 cost time: 11.792964220046997
Epoch: 23, Steps: 34 | Train Loss: 0.872 Vali Loss: 9.766 Vali Acc: 0.659 Test Loss: 9.766 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.418328285217285
Epoch: 24, Steps: 34 | Train Loss: 1.233 Vali Loss: 6.332 Vali Acc: 0.786 Test Loss: 6.332 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.048014402389526
Epoch: 25, Steps: 34 | Train Loss: 0.237 Vali Loss: 4.991 Vali Acc: 0.815 Test Loss: 4.991 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.537837028503418
Epoch: 26, Steps: 34 | Train Loss: 0.493 Vali Loss: 10.615 Vali Acc: 0.798 Test Loss: 10.615 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.632419109344482
Epoch: 27, Steps: 34 | Train Loss: 0.374 Vali Loss: 7.256 Vali Acc: 0.769 Test Loss: 7.256 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.037524223327637
Epoch: 28, Steps: 34 | Train Loss: 0.256 Vali Loss: 4.267 Vali Acc: 0.838 Test Loss: 4.267 Test Acc: 0.838
Validation loss decreased (-0.838101 --> -0.838108).  Saving model ...
Epoch: 29 cost time: 11.348037719726562
Epoch: 29, Steps: 34 | Train Loss: 0.316 Vali Loss: 8.422 Vali Acc: 0.832 Test Loss: 8.422 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 11.836069822311401
Epoch: 30, Steps: 34 | Train Loss: 1.134 Vali Loss: 9.444 Vali Acc: 0.803 Test Loss: 9.444 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 12.777100324630737
Epoch: 31, Steps: 34 | Train Loss: 0.343 Vali Loss: 18.375 Vali Acc: 0.740 Test Loss: 18.375 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 11.864354848861694
Epoch: 32, Steps: 34 | Train Loss: 0.843 Vali Loss: 8.999 Vali Acc: 0.786 Test Loss: 8.999 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 12.617641687393188
Epoch: 33, Steps: 34 | Train Loss: 0.946 Vali Loss: 24.885 Vali Acc: 0.595 Test Loss: 24.885 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 12.670411109924316
Epoch: 34, Steps: 34 | Train Loss: 3.241 Vali Loss: 17.256 Vali Acc: 0.653 Test Loss: 17.256 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 13.49083137512207
Epoch: 35, Steps: 34 | Train Loss: 0.250 Vali Loss: 11.659 Vali Acc: 0.757 Test Loss: 11.659 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 13.459198951721191
Epoch: 36, Steps: 34 | Train Loss: 0.130 Vali Loss: 6.555 Vali Acc: 0.809 Test Loss: 6.555 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 13.532599925994873
Epoch: 37, Steps: 34 | Train Loss: 0.319 Vali Loss: 7.965 Vali Acc: 0.815 Test Loss: 7.965 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 12.763486385345459
Epoch: 38, Steps: 34 | Train Loss: 0.262 Vali Loss: 9.379 Vali Acc: 0.780 Test Loss: 9.379 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2626615
model size : 11.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.141330480575562
Epoch: 1, Steps: 34 | Train Loss: 2.478 Vali Loss: 3.450 Vali Acc: 0.329 Test Loss: 3.450 Test Acc: 0.329
Validation loss decreased (inf --> -0.329445).  Saving model ...
Epoch: 2 cost time: 12.60436201095581
Epoch: 2, Steps: 34 | Train Loss: 2.486 Vali Loss: 2.202 Vali Acc: 0.474 Test Loss: 2.202 Test Acc: 0.474
Validation loss decreased (-0.329445 --> -0.473966).  Saving model ...
Epoch: 3 cost time: 11.701582431793213
Epoch: 3, Steps: 34 | Train Loss: 3.674 Vali Loss: 4.360 Vali Acc: 0.457 Test Loss: 4.360 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.11344051361084
Epoch: 4, Steps: 34 | Train Loss: 3.437 Vali Loss: 6.435 Vali Acc: 0.416 Test Loss: 6.435 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.034468650817871
Epoch: 5, Steps: 34 | Train Loss: 1.595 Vali Loss: 2.491 Vali Acc: 0.566 Test Loss: 2.491 Test Acc: 0.566
Validation loss decreased (-0.473966 --> -0.566449).  Saving model ...
Epoch: 6 cost time: 11.117502212524414
Epoch: 6, Steps: 34 | Train Loss: 2.468 Vali Loss: 3.232 Vali Acc: 0.503 Test Loss: 3.232 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.01940107345581
Epoch: 7, Steps: 34 | Train Loss: 3.645 Vali Loss: 6.462 Vali Acc: 0.566 Test Loss: 6.462 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.335851430892944
Epoch: 8, Steps: 34 | Train Loss: 3.669 Vali Loss: 3.474 Vali Acc: 0.694 Test Loss: 3.474 Test Acc: 0.694
Validation loss decreased (-0.566449 --> -0.693607).  Saving model ...
Epoch: 9 cost time: 11.49486756324768
Epoch: 9, Steps: 34 | Train Loss: 1.381 Vali Loss: 3.132 Vali Acc: 0.624 Test Loss: 3.132 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.723686695098877
Epoch: 10, Steps: 34 | Train Loss: 1.027 Vali Loss: 3.651 Vali Acc: 0.699 Test Loss: 3.651 Test Acc: 0.699
Validation loss decreased (-0.693607 --> -0.699385).  Saving model ...
Epoch: 11 cost time: 11.915005683898926
Epoch: 11, Steps: 34 | Train Loss: 0.603 Vali Loss: 3.412 Vali Acc: 0.775 Test Loss: 3.412 Test Acc: 0.775
Validation loss decreased (-0.699385 --> -0.774532).  Saving model ...
Epoch: 12 cost time: 12.397457361221313
Epoch: 12, Steps: 34 | Train Loss: 0.619 Vali Loss: 1.849 Vali Acc: 0.803 Test Loss: 1.849 Test Acc: 0.803
Validation loss decreased (-0.774532 --> -0.803450).  Saving model ...
Epoch: 13 cost time: 11.768656492233276
Epoch: 13, Steps: 34 | Train Loss: 0.333 Vali Loss: 4.244 Vali Acc: 0.711 Test Loss: 4.244 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.559582948684692
Epoch: 14, Steps: 34 | Train Loss: 0.813 Vali Loss: 3.530 Vali Acc: 0.769 Test Loss: 3.530 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.874627351760864
Epoch: 15, Steps: 34 | Train Loss: 1.039 Vali Loss: 4.875 Vali Acc: 0.630 Test Loss: 4.875 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.942402124404907
Epoch: 16, Steps: 34 | Train Loss: 0.442 Vali Loss: 5.564 Vali Acc: 0.665 Test Loss: 5.564 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.325863599777222
Epoch: 17, Steps: 34 | Train Loss: 0.806 Vali Loss: 4.573 Vali Acc: 0.671 Test Loss: 4.573 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.658208131790161
Epoch: 18, Steps: 34 | Train Loss: 1.148 Vali Loss: 4.325 Vali Acc: 0.711 Test Loss: 4.325 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.25704550743103
Epoch: 19, Steps: 34 | Train Loss: 0.296 Vali Loss: 2.111 Vali Acc: 0.844 Test Loss: 2.111 Test Acc: 0.844
Validation loss decreased (-0.803450 --> -0.843910).  Saving model ...
Epoch: 20 cost time: 11.387582778930664
Epoch: 20, Steps: 34 | Train Loss: 0.318 Vali Loss: 3.770 Vali Acc: 0.809 Test Loss: 3.770 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.689294576644897
Epoch: 21, Steps: 34 | Train Loss: 0.141 Vali Loss: 3.125 Vali Acc: 0.844 Test Loss: 3.125 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.179780960083008
Epoch: 22, Steps: 34 | Train Loss: 0.111 Vali Loss: 3.791 Vali Acc: 0.757 Test Loss: 3.791 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.513492345809937
Epoch: 23, Steps: 34 | Train Loss: 0.101 Vali Loss: 5.412 Vali Acc: 0.734 Test Loss: 5.412 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.774048089981079
Epoch: 24, Steps: 34 | Train Loss: 0.227 Vali Loss: 6.228 Vali Acc: 0.676 Test Loss: 6.228 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.51359224319458
Epoch: 25, Steps: 34 | Train Loss: 0.206 Vali Loss: 2.274 Vali Acc: 0.786 Test Loss: 2.274 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 12.402366876602173
Epoch: 26, Steps: 34 | Train Loss: 0.045 Vali Loss: 3.460 Vali Acc: 0.769 Test Loss: 3.460 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.863474130630493
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.798 Test Loss: 2.691 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 12.070847511291504
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.492 Vali Acc: 0.809 Test Loss: 2.492 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 12.796195268630981
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.809 Test Loss: 2.479 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1608791
model size : 6.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.87449860572815
Epoch: 1, Steps: 34 | Train Loss: 2.426 Vali Loss: 2.789 Vali Acc: 0.289 Test Loss: 2.789 Test Acc: 0.289
Validation loss decreased (inf --> -0.288989).  Saving model ...
Epoch: 2 cost time: 12.057385444641113
Epoch: 2, Steps: 34 | Train Loss: 2.558 Vali Loss: 2.809 Vali Acc: 0.439 Test Loss: 2.809 Test Acc: 0.439
Validation loss decreased (-0.288989 --> -0.439278).  Saving model ...
Epoch: 3 cost time: 11.944992780685425
Epoch: 3, Steps: 34 | Train Loss: 2.429 Vali Loss: 3.620 Vali Acc: 0.318 Test Loss: 3.620 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.794297218322754
Epoch: 4, Steps: 34 | Train Loss: 4.342 Vali Loss: 2.652 Vali Acc: 0.572 Test Loss: 2.652 Test Acc: 0.572
Validation loss decreased (-0.439278 --> -0.572228).  Saving model ...
Epoch: 5 cost time: 12.634586095809937
Epoch: 5, Steps: 34 | Train Loss: 2.023 Vali Loss: 2.426 Vali Acc: 0.549 Test Loss: 2.426 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.814379453659058
Epoch: 6, Steps: 34 | Train Loss: 2.024 Vali Loss: 6.704 Vali Acc: 0.445 Test Loss: 6.704 Test Acc: 0.445
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.334380388259888
Epoch: 7, Steps: 34 | Train Loss: 2.695 Vali Loss: 5.412 Vali Acc: 0.647 Test Loss: 5.412 Test Acc: 0.647
Validation loss decreased (-0.572228 --> -0.647345).  Saving model ...
Epoch: 8 cost time: 12.784682512283325
Epoch: 8, Steps: 34 | Train Loss: 1.066 Vali Loss: 2.702 Vali Acc: 0.682 Test Loss: 2.702 Test Acc: 0.682
Validation loss decreased (-0.647345 --> -0.682054).  Saving model ...
Epoch: 9 cost time: 13.516487121582031
Epoch: 9, Steps: 34 | Train Loss: 0.766 Vali Loss: 3.305 Vali Acc: 0.723 Test Loss: 3.305 Test Acc: 0.723
Validation loss decreased (-0.682054 --> -0.722510).  Saving model ...
Epoch: 10 cost time: 14.159215688705444
Epoch: 10, Steps: 34 | Train Loss: 1.053 Vali Loss: 3.265 Vali Acc: 0.676 Test Loss: 3.265 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.678755760192871
Epoch: 11, Steps: 34 | Train Loss: 0.859 Vali Loss: 6.515 Vali Acc: 0.659 Test Loss: 6.515 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.815505743026733
Epoch: 12, Steps: 34 | Train Loss: 1.422 Vali Loss: 3.361 Vali Acc: 0.757 Test Loss: 3.361 Test Acc: 0.757
Validation loss decreased (-0.722510 --> -0.757192).  Saving model ...
Epoch: 13 cost time: 12.106486082077026
Epoch: 13, Steps: 34 | Train Loss: 0.634 Vali Loss: 3.823 Vali Acc: 0.642 Test Loss: 3.823 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.390151739120483
Epoch: 14, Steps: 34 | Train Loss: 0.430 Vali Loss: 5.769 Vali Acc: 0.676 Test Loss: 5.769 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.358760833740234
Epoch: 15, Steps: 34 | Train Loss: 0.523 Vali Loss: 4.138 Vali Acc: 0.717 Test Loss: 4.138 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.282853126525879
Epoch: 16, Steps: 34 | Train Loss: 0.266 Vali Loss: 3.793 Vali Acc: 0.746 Test Loss: 3.793 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.444164991378784
Epoch: 17, Steps: 34 | Train Loss: 0.401 Vali Loss: 4.713 Vali Acc: 0.717 Test Loss: 4.713 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.725923776626587
Epoch: 18, Steps: 34 | Train Loss: 0.175 Vali Loss: 3.229 Vali Acc: 0.786 Test Loss: 3.229 Test Acc: 0.786
Validation loss decreased (-0.757192 --> -0.786095).  Saving model ...
Epoch: 19 cost time: 11.670382022857666
Epoch: 19, Steps: 34 | Train Loss: 0.284 Vali Loss: 3.553 Vali Acc: 0.769 Test Loss: 3.553 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.936701536178589
Epoch: 20, Steps: 34 | Train Loss: 0.631 Vali Loss: 2.129 Vali Acc: 0.769 Test Loss: 2.129 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 12.527239799499512
Epoch: 21, Steps: 34 | Train Loss: 0.181 Vali Loss: 2.941 Vali Acc: 0.780 Test Loss: 2.941 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.515844345092773
Epoch: 22, Steps: 34 | Train Loss: 0.013 Vali Loss: 1.410 Vali Acc: 0.809 Test Loss: 1.410 Test Acc: 0.809
Validation loss decreased (-0.786095 --> -0.809234).  Saving model ...
Epoch: 23 cost time: 8.459776878356934
Epoch: 23, Steps: 34 | Train Loss: 0.039 Vali Loss: 3.571 Vali Acc: 0.746 Test Loss: 3.571 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.884437084197998
Epoch: 24, Steps: 34 | Train Loss: 0.117 Vali Loss: 5.998 Vali Acc: 0.723 Test Loss: 5.998 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.160427570343018
Epoch: 25, Steps: 34 | Train Loss: 0.452 Vali Loss: 2.783 Vali Acc: 0.798 Test Loss: 2.783 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.160008430480957
Epoch: 26, Steps: 34 | Train Loss: 0.438 Vali Loss: 4.613 Vali Acc: 0.734 Test Loss: 4.613 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.429701566696167
Epoch: 27, Steps: 34 | Train Loss: 0.409 Vali Loss: 4.122 Vali Acc: 0.746 Test Loss: 4.122 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.789452314376831
Epoch: 28, Steps: 34 | Train Loss: 0.313 Vali Loss: 5.079 Vali Acc: 0.775 Test Loss: 5.079 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.064777374267578
Epoch: 29, Steps: 34 | Train Loss: 0.141 Vali Loss: 2.973 Vali Acc: 0.763 Test Loss: 2.973 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.643648147583008
Epoch: 30, Steps: 34 | Train Loss: 0.113 Vali Loss: 2.800 Vali Acc: 0.757 Test Loss: 2.800 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 11.910240888595581
Epoch: 31, Steps: 34 | Train Loss: 0.341 Vali Loss: 5.582 Vali Acc: 0.769 Test Loss: 5.582 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 13.155215740203857
Epoch: 32, Steps: 34 | Train Loss: 0.112 Vali Loss: 8.400 Vali Acc: 0.694 Test Loss: 8.400 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1608119
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.85219407081604
Epoch: 1, Steps: 34 | Train Loss: 2.375 Vali Loss: 3.679 Vali Acc: 0.266 Test Loss: 3.679 Test Acc: 0.266
Validation loss decreased (inf --> -0.265859).  Saving model ...
Epoch: 2 cost time: 12.998039960861206
Epoch: 2, Steps: 34 | Train Loss: 2.823 Vali Loss: 2.778 Vali Acc: 0.474 Test Loss: 2.778 Test Acc: 0.474
Validation loss decreased (-0.265859 --> -0.473961).  Saving model ...
Epoch: 3 cost time: 11.78954553604126
Epoch: 3, Steps: 34 | Train Loss: 2.182 Vali Loss: 3.075 Vali Acc: 0.514 Test Loss: 3.075 Test Acc: 0.514
Validation loss decreased (-0.473961 --> -0.514420).  Saving model ...
Epoch: 4 cost time: 12.125360012054443
Epoch: 4, Steps: 34 | Train Loss: 2.882 Vali Loss: 3.005 Vali Acc: 0.491 Test Loss: 3.005 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.214257717132568
Epoch: 5, Steps: 34 | Train Loss: 1.854 Vali Loss: 2.626 Vali Acc: 0.451 Test Loss: 2.626 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.205404996871948
Epoch: 6, Steps: 34 | Train Loss: 1.732 Vali Loss: 4.487 Vali Acc: 0.561 Test Loss: 4.487 Test Acc: 0.561
Validation loss decreased (-0.514420 --> -0.560649).  Saving model ...
Epoch: 7 cost time: 11.904532432556152
Epoch: 7, Steps: 34 | Train Loss: 1.368 Vali Loss: 3.281 Vali Acc: 0.659 Test Loss: 3.281 Test Acc: 0.659
Validation loss decreased (-0.560649 --> -0.658927).  Saving model ...
Epoch: 8 cost time: 10.74475646018982
Epoch: 8, Steps: 34 | Train Loss: 1.061 Vali Loss: 1.631 Vali Acc: 0.740 Test Loss: 1.631 Test Acc: 0.740
Validation loss decreased (-0.658927 --> -0.739868).  Saving model ...
Epoch: 9 cost time: 12.370333433151245
Epoch: 9, Steps: 34 | Train Loss: 0.821 Vali Loss: 2.790 Vali Acc: 0.671 Test Loss: 2.790 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.073740720748901
Epoch: 10, Steps: 34 | Train Loss: 1.041 Vali Loss: 2.835 Vali Acc: 0.705 Test Loss: 2.835 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.63668179512024
Epoch: 11, Steps: 34 | Train Loss: 0.686 Vali Loss: 2.465 Vali Acc: 0.734 Test Loss: 2.465 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.773679494857788
Epoch: 12, Steps: 34 | Train Loss: 1.239 Vali Loss: 3.052 Vali Acc: 0.694 Test Loss: 3.052 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.319652557373047
Epoch: 13, Steps: 34 | Train Loss: 0.433 Vali Loss: 2.997 Vali Acc: 0.607 Test Loss: 2.997 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.210961818695068
Epoch: 14, Steps: 34 | Train Loss: 0.548 Vali Loss: 5.404 Vali Acc: 0.607 Test Loss: 5.404 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.707494974136353
Epoch: 15, Steps: 34 | Train Loss: 0.390 Vali Loss: 2.730 Vali Acc: 0.751 Test Loss: 2.730 Test Acc: 0.751
Validation loss decreased (-0.739868 --> -0.751418).  Saving model ...
Epoch: 16 cost time: 11.971177339553833
Epoch: 16, Steps: 34 | Train Loss: 0.179 Vali Loss: 2.822 Vali Acc: 0.740 Test Loss: 2.822 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.148141145706177
Epoch: 17, Steps: 34 | Train Loss: 0.218 Vali Loss: 1.585 Vali Acc: 0.792 Test Loss: 1.585 Test Acc: 0.792
Validation loss decreased (-0.751418 --> -0.791892).  Saving model ...
Epoch: 18 cost time: 10.82884430885315
Epoch: 18, Steps: 34 | Train Loss: 0.030 Vali Loss: 3.724 Vali Acc: 0.757 Test Loss: 3.724 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.119507312774658
Epoch: 19, Steps: 34 | Train Loss: 0.011 Vali Loss: 2.952 Vali Acc: 0.798 Test Loss: 2.952 Test Acc: 0.798
Validation loss decreased (-0.791892 --> -0.797658).  Saving model ...
Epoch: 20 cost time: 12.63578200340271
Epoch: 20, Steps: 34 | Train Loss: 0.140 Vali Loss: 3.714 Vali Acc: 0.763 Test Loss: 3.714 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.757583379745483
Epoch: 21, Steps: 34 | Train Loss: 0.362 Vali Loss: 2.888 Vali Acc: 0.723 Test Loss: 2.888 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.614822387695312
Epoch: 22, Steps: 34 | Train Loss: 0.213 Vali Loss: 3.644 Vali Acc: 0.763 Test Loss: 3.644 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.031947612762451
Epoch: 23, Steps: 34 | Train Loss: 0.086 Vali Loss: 2.896 Vali Acc: 0.769 Test Loss: 2.896 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.119915246963501
Epoch: 24, Steps: 34 | Train Loss: 0.395 Vali Loss: 3.073 Vali Acc: 0.699 Test Loss: 3.073 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.835540533065796
Epoch: 25, Steps: 34 | Train Loss: 0.347 Vali Loss: 3.232 Vali Acc: 0.803 Test Loss: 3.232 Test Acc: 0.803
Validation loss decreased (-0.797658 --> -0.803436).  Saving model ...
Epoch: 26 cost time: 12.459938764572144
Epoch: 26, Steps: 34 | Train Loss: 0.152 Vali Loss: 2.833 Vali Acc: 0.815 Test Loss: 2.833 Test Acc: 0.815
Validation loss decreased (-0.803436 --> -0.815001).  Saving model ...
Epoch: 27 cost time: 10.044661521911621
Epoch: 27, Steps: 34 | Train Loss: 0.002 Vali Loss: 2.408 Vali Acc: 0.798 Test Loss: 2.408 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.156070470809937
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.033 Vali Acc: 0.809 Test Loss: 3.033 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 11.28181505203247
Epoch: 29, Steps: 34 | Train Loss: 0.098 Vali Loss: 2.676 Vali Acc: 0.763 Test Loss: 2.676 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.85811734199524
Epoch: 30, Steps: 34 | Train Loss: 0.069 Vali Loss: 2.512 Vali Acc: 0.798 Test Loss: 2.512 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 11.954078674316406
Epoch: 31, Steps: 34 | Train Loss: 0.008 Vali Loss: 2.764 Vali Acc: 0.763 Test Loss: 2.764 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 12.142294883728027
Epoch: 32, Steps: 34 | Train Loss: 0.788 Vali Loss: 5.950 Vali Acc: 0.746 Test Loss: 5.950 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 11.416006565093994
Epoch: 33, Steps: 34 | Train Loss: 0.255 Vali Loss: 4.926 Vali Acc: 0.699 Test Loss: 4.926 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 10.94171142578125
Epoch: 34, Steps: 34 | Train Loss: 0.201 Vali Loss: 3.708 Vali Acc: 0.798 Test Loss: 3.708 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 11.72370719909668
Epoch: 35, Steps: 34 | Train Loss: 0.015 Vali Loss: 3.820 Vali Acc: 0.740 Test Loss: 3.820 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 12.120275974273682
Epoch: 36, Steps: 34 | Train Loss: 0.028 Vali Loss: 3.170 Vali Acc: 0.763 Test Loss: 3.170 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1607447
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.400689363479614
Epoch: 1, Steps: 34 | Train Loss: 2.706 Vali Loss: 3.394 Vali Acc: 0.370 Test Loss: 3.394 Test Acc: 0.370
Validation loss decreased (inf --> -0.369908).  Saving model ...
Epoch: 2 cost time: 11.186527013778687
Epoch: 2, Steps: 34 | Train Loss: 3.102 Vali Loss: 4.497 Vali Acc: 0.358 Test Loss: 4.497 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.567333936691284
Epoch: 3, Steps: 34 | Train Loss: 2.980 Vali Loss: 3.288 Vali Acc: 0.503 Test Loss: 3.288 Test Acc: 0.503
Validation loss decreased (-0.369908 --> -0.502857).  Saving model ...
Epoch: 4 cost time: 11.669447183609009
Epoch: 4, Steps: 34 | Train Loss: 2.294 Vali Loss: 2.662 Vali Acc: 0.555 Test Loss: 2.662 Test Acc: 0.555
Validation loss decreased (-0.502857 --> -0.554887).  Saving model ...
Epoch: 5 cost time: 11.12803053855896
Epoch: 5, Steps: 34 | Train Loss: 1.999 Vali Loss: 3.381 Vali Acc: 0.566 Test Loss: 3.381 Test Acc: 0.566
Validation loss decreased (-0.554887 --> -0.566440).  Saving model ...
Epoch: 6 cost time: 10.514631748199463
Epoch: 6, Steps: 34 | Train Loss: 2.076 Vali Loss: 1.710 Vali Acc: 0.711 Test Loss: 1.710 Test Acc: 0.711
Validation loss decreased (-0.566440 --> -0.710966).  Saving model ...
Epoch: 7 cost time: 11.870438575744629
Epoch: 7, Steps: 34 | Train Loss: 1.539 Vali Loss: 1.657 Vali Acc: 0.705 Test Loss: 1.657 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.894968032836914
Epoch: 8, Steps: 34 | Train Loss: 1.301 Vali Loss: 1.974 Vali Acc: 0.705 Test Loss: 1.974 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.63379192352295
Epoch: 9, Steps: 34 | Train Loss: 2.362 Vali Loss: 2.615 Vali Acc: 0.665 Test Loss: 2.615 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.600899696350098
Epoch: 10, Steps: 34 | Train Loss: 0.895 Vali Loss: 1.348 Vali Acc: 0.763 Test Loss: 1.348 Test Acc: 0.763
Validation loss decreased (-0.710966 --> -0.762992).  Saving model ...
Epoch: 11 cost time: 11.679986953735352
Epoch: 11, Steps: 34 | Train Loss: 0.503 Vali Loss: 3.722 Vali Acc: 0.607 Test Loss: 3.722 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.435266017913818
Epoch: 12, Steps: 34 | Train Loss: 0.622 Vali Loss: 2.057 Vali Acc: 0.751 Test Loss: 2.057 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.101234912872314
Epoch: 13, Steps: 34 | Train Loss: 0.293 Vali Loss: 2.280 Vali Acc: 0.769 Test Loss: 2.280 Test Acc: 0.769
Validation loss decreased (-0.762992 --> -0.768763).  Saving model ...
Epoch: 14 cost time: 11.162615537643433
Epoch: 14, Steps: 34 | Train Loss: 0.206 Vali Loss: 2.181 Vali Acc: 0.763 Test Loss: 2.181 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.317208766937256
Epoch: 15, Steps: 34 | Train Loss: 0.266 Vali Loss: 2.062 Vali Acc: 0.792 Test Loss: 2.062 Test Acc: 0.792
Validation loss decreased (-0.768763 --> -0.791887).  Saving model ...
Epoch: 16 cost time: 9.860624074935913
Epoch: 16, Steps: 34 | Train Loss: 0.220 Vali Loss: 2.457 Vali Acc: 0.780 Test Loss: 2.457 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.540504932403564
Epoch: 17, Steps: 34 | Train Loss: 0.139 Vali Loss: 6.211 Vali Acc: 0.613 Test Loss: 6.211 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.929800271987915
Epoch: 18, Steps: 34 | Train Loss: 0.265 Vali Loss: 4.048 Vali Acc: 0.705 Test Loss: 4.048 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.569918155670166
Epoch: 19, Steps: 34 | Train Loss: 0.206 Vali Loss: 1.714 Vali Acc: 0.786 Test Loss: 1.714 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.338932037353516
Epoch: 20, Steps: 34 | Train Loss: 0.182 Vali Loss: 4.562 Vali Acc: 0.671 Test Loss: 4.562 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.598903894424438
Epoch: 21, Steps: 34 | Train Loss: 0.145 Vali Loss: 2.575 Vali Acc: 0.803 Test Loss: 2.575 Test Acc: 0.803
Validation loss decreased (-0.791887 --> -0.803442).  Saving model ...
Epoch: 22 cost time: 11.781376600265503
Epoch: 22, Steps: 34 | Train Loss: 0.095 Vali Loss: 2.709 Vali Acc: 0.780 Test Loss: 2.709 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.894803285598755
Epoch: 23, Steps: 34 | Train Loss: 0.134 Vali Loss: 2.385 Vali Acc: 0.775 Test Loss: 2.385 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.525415420532227
Epoch: 24, Steps: 34 | Train Loss: 0.224 Vali Loss: 3.624 Vali Acc: 0.780 Test Loss: 3.624 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.495622396469116
Epoch: 25, Steps: 34 | Train Loss: 0.325 Vali Loss: 2.297 Vali Acc: 0.769 Test Loss: 2.297 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 10.646655797958374
Epoch: 26, Steps: 34 | Train Loss: 0.037 Vali Loss: 2.608 Vali Acc: 0.827 Test Loss: 2.608 Test Acc: 0.827
Validation loss decreased (-0.803442 --> -0.826564).  Saving model ...
Epoch: 27 cost time: 11.523847818374634
Epoch: 27, Steps: 34 | Train Loss: 0.083 Vali Loss: 3.839 Vali Acc: 0.728 Test Loss: 3.839 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.133270740509033
Epoch: 28, Steps: 34 | Train Loss: 0.182 Vali Loss: 1.985 Vali Acc: 0.809 Test Loss: 1.985 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 10.79414963722229
Epoch: 29, Steps: 34 | Train Loss: 0.196 Vali Loss: 2.192 Vali Acc: 0.792 Test Loss: 2.192 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 8.032177448272705
Epoch: 30, Steps: 34 | Train Loss: 0.208 Vali Loss: 5.020 Vali Acc: 0.711 Test Loss: 5.020 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 11.434528350830078
Epoch: 31, Steps: 34 | Train Loss: 0.106 Vali Loss: 5.905 Vali Acc: 0.792 Test Loss: 5.905 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 12.597087860107422
Epoch: 32, Steps: 34 | Train Loss: 0.521 Vali Loss: 3.939 Vali Acc: 0.798 Test Loss: 3.939 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 10.967147588729858
Epoch: 33, Steps: 34 | Train Loss: 0.366 Vali Loss: 5.194 Vali Acc: 0.740 Test Loss: 5.194 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 13.703186273574829
Epoch: 34, Steps: 34 | Train Loss: 0.178 Vali Loss: 5.949 Vali Acc: 0.746 Test Loss: 5.949 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 13.369402885437012
Epoch: 35, Steps: 34 | Train Loss: 0.137 Vali Loss: 5.184 Vali Acc: 0.728 Test Loss: 5.184 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 11.302812576293945
Epoch: 36, Steps: 34 | Train Loss: 0.430 Vali Loss: 3.880 Vali Acc: 0.815 Test Loss: 3.880 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1606775
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.912076711654663
Epoch: 1, Steps: 34 | Train Loss: 2.190 Vali Loss: 1.578 Vali Acc: 0.422 Test Loss: 1.578 Test Acc: 0.422
Validation loss decreased (inf --> -0.421950).  Saving model ...
Epoch: 2 cost time: 10.838587522506714
Epoch: 2, Steps: 34 | Train Loss: 2.466 Vali Loss: 1.862 Vali Acc: 0.434 Test Loss: 1.862 Test Acc: 0.434
Validation loss decreased (-0.421950 --> -0.433507).  Saving model ...
Epoch: 3 cost time: 10.84171724319458
Epoch: 3, Steps: 34 | Train Loss: 2.497 Vali Loss: 4.530 Vali Acc: 0.445 Test Loss: 4.530 Test Acc: 0.445
Validation loss decreased (-0.433507 --> -0.445041).  Saving model ...
Epoch: 4 cost time: 10.380869626998901
Epoch: 4, Steps: 34 | Train Loss: 2.161 Vali Loss: 2.895 Vali Acc: 0.543 Test Loss: 2.895 Test Acc: 0.543
Validation loss decreased (-0.445041 --> -0.543324).  Saving model ...
Epoch: 5 cost time: 9.307849168777466
Epoch: 5, Steps: 34 | Train Loss: 1.567 Vali Loss: 2.592 Vali Acc: 0.618 Test Loss: 2.592 Test Acc: 0.618
Validation loss decreased (-0.543324 --> -0.618471).  Saving model ...
Epoch: 6 cost time: 10.535602807998657
Epoch: 6, Steps: 34 | Train Loss: 2.461 Vali Loss: 3.653 Vali Acc: 0.647 Test Loss: 3.653 Test Acc: 0.647
Validation loss decreased (-0.618471 --> -0.647362).  Saving model ...
Epoch: 7 cost time: 10.54989504814148
Epoch: 7, Steps: 34 | Train Loss: 3.915 Vali Loss: 9.230 Vali Acc: 0.451 Test Loss: 9.230 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.982085943222046
Epoch: 8, Steps: 34 | Train Loss: 2.394 Vali Loss: 5.024 Vali Acc: 0.532 Test Loss: 5.024 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.24410367012024
Epoch: 9, Steps: 34 | Train Loss: 3.330 Vali Loss: 3.443 Vali Acc: 0.630 Test Loss: 3.443 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.591132402420044
Epoch: 10, Steps: 34 | Train Loss: 1.340 Vali Loss: 4.033 Vali Acc: 0.682 Test Loss: 4.033 Test Acc: 0.682
Validation loss decreased (-0.647362 --> -0.682041).  Saving model ...
Epoch: 11 cost time: 10.160157680511475
Epoch: 11, Steps: 34 | Train Loss: 1.107 Vali Loss: 2.461 Vali Acc: 0.688 Test Loss: 2.461 Test Acc: 0.688
Validation loss decreased (-0.682041 --> -0.687837).  Saving model ...
Epoch: 12 cost time: 9.452338457107544
Epoch: 12, Steps: 34 | Train Loss: 0.648 Vali Loss: 1.958 Vali Acc: 0.769 Test Loss: 1.958 Test Acc: 0.769
Validation loss decreased (-0.687837 --> -0.768767).  Saving model ...
Epoch: 13 cost time: 10.523786544799805
Epoch: 13, Steps: 34 | Train Loss: 0.970 Vali Loss: 4.660 Vali Acc: 0.694 Test Loss: 4.660 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.92467999458313
Epoch: 14, Steps: 34 | Train Loss: 0.391 Vali Loss: 4.567 Vali Acc: 0.653 Test Loss: 4.567 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.315262079238892
Epoch: 15, Steps: 34 | Train Loss: 0.169 Vali Loss: 3.541 Vali Acc: 0.786 Test Loss: 3.541 Test Acc: 0.786
Validation loss decreased (-0.768767 --> -0.786092).  Saving model ...
Epoch: 16 cost time: 10.811004161834717
Epoch: 16, Steps: 34 | Train Loss: 0.802 Vali Loss: 2.222 Vali Acc: 0.769 Test Loss: 2.222 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.152844905853271
Epoch: 17, Steps: 34 | Train Loss: 0.522 Vali Loss: 4.777 Vali Acc: 0.734 Test Loss: 4.777 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.954056739807129
Epoch: 18, Steps: 34 | Train Loss: 1.106 Vali Loss: 3.189 Vali Acc: 0.746 Test Loss: 3.189 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.002608060836792
Epoch: 19, Steps: 34 | Train Loss: 0.410 Vali Loss: 2.724 Vali Acc: 0.769 Test Loss: 2.724 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.867673397064209
Epoch: 20, Steps: 34 | Train Loss: 0.107 Vali Loss: 4.469 Vali Acc: 0.723 Test Loss: 4.469 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.859750032424927
Epoch: 21, Steps: 34 | Train Loss: 0.157 Vali Loss: 4.938 Vali Acc: 0.717 Test Loss: 4.938 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.94489598274231
Epoch: 22, Steps: 34 | Train Loss: 0.264 Vali Loss: 3.597 Vali Acc: 0.769 Test Loss: 3.597 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.618558406829834
Epoch: 23, Steps: 34 | Train Loss: 0.112 Vali Loss: 4.187 Vali Acc: 0.769 Test Loss: 4.187 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.64473271369934
Epoch: 24, Steps: 34 | Train Loss: 0.413 Vali Loss: 1.912 Vali Acc: 0.855 Test Loss: 1.912 Test Acc: 0.855
Validation loss decreased (-0.786092 --> -0.855472).  Saving model ...
Epoch: 25 cost time: 9.912035703659058
Epoch: 25, Steps: 34 | Train Loss: 0.340 Vali Loss: 3.401 Vali Acc: 0.746 Test Loss: 3.401 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.752060413360596
Epoch: 26, Steps: 34 | Train Loss: 0.403 Vali Loss: 5.411 Vali Acc: 0.728 Test Loss: 5.411 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 10.278734922409058
Epoch: 27, Steps: 34 | Train Loss: 0.645 Vali Loss: 5.014 Vali Acc: 0.734 Test Loss: 5.014 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 10.511284589767456
Epoch: 28, Steps: 34 | Train Loss: 0.564 Vali Loss: 3.180 Vali Acc: 0.728 Test Loss: 3.180 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 10.791346073150635
Epoch: 29, Steps: 34 | Train Loss: 0.423 Vali Loss: 3.545 Vali Acc: 0.809 Test Loss: 3.545 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.126662731170654
Epoch: 30, Steps: 34 | Train Loss: 0.112 Vali Loss: 4.005 Vali Acc: 0.780 Test Loss: 4.005 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 10.962448596954346
Epoch: 31, Steps: 34 | Train Loss: 0.072 Vali Loss: 7.151 Vali Acc: 0.734 Test Loss: 7.151 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 10.236659288406372
Epoch: 32, Steps: 34 | Train Loss: 0.171 Vali Loss: 5.040 Vali Acc: 0.711 Test Loss: 5.040 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 9.68877649307251
Epoch: 33, Steps: 34 | Train Loss: 0.213 Vali Loss: 4.459 Vali Acc: 0.769 Test Loss: 4.459 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 10.8939950466156
Epoch: 34, Steps: 34 | Train Loss: 0.004 Vali Loss: 6.334 Vali Acc: 0.740 Test Loss: 6.334 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1375831
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.496115684509277
Epoch: 1, Steps: 34 | Train Loss: 2.122 Vali Loss: 3.160 Vali Acc: 0.243 Test Loss: 3.160 Test Acc: 0.243
Validation loss decreased (inf --> -0.242743).  Saving model ...
Epoch: 2 cost time: 9.905062198638916
Epoch: 2, Steps: 34 | Train Loss: 2.010 Vali Loss: 2.120 Vali Acc: 0.347 Test Loss: 2.120 Test Acc: 0.347
Validation loss decreased (-0.242743 --> -0.346800).  Saving model ...
Epoch: 3 cost time: 10.446467399597168
Epoch: 3, Steps: 34 | Train Loss: 2.442 Vali Loss: 3.116 Vali Acc: 0.532 Test Loss: 3.116 Test Acc: 0.532
Validation loss decreased (-0.346800 --> -0.531761).  Saving model ...
Epoch: 4 cost time: 10.003862142562866
Epoch: 4, Steps: 34 | Train Loss: 3.360 Vali Loss: 2.412 Vali Acc: 0.497 Test Loss: 2.412 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.256042957305908
Epoch: 5, Steps: 34 | Train Loss: 2.002 Vali Loss: 3.937 Vali Acc: 0.422 Test Loss: 3.937 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.575475931167603
Epoch: 6, Steps: 34 | Train Loss: 2.149 Vali Loss: 2.826 Vali Acc: 0.682 Test Loss: 2.826 Test Acc: 0.682
Validation loss decreased (-0.531761 --> -0.682053).  Saving model ...
Epoch: 7 cost time: 11.074138641357422
Epoch: 7, Steps: 34 | Train Loss: 1.625 Vali Loss: 3.308 Vali Acc: 0.561 Test Loss: 3.308 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.10682487487793
Epoch: 8, Steps: 34 | Train Loss: 1.328 Vali Loss: 6.447 Vali Acc: 0.566 Test Loss: 6.447 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.911150217056274
Epoch: 9, Steps: 34 | Train Loss: 2.520 Vali Loss: 5.388 Vali Acc: 0.566 Test Loss: 5.388 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.639337301254272
Epoch: 10, Steps: 34 | Train Loss: 2.643 Vali Loss: 2.836 Vali Acc: 0.723 Test Loss: 2.836 Test Acc: 0.723
Validation loss decreased (-0.682053 --> -0.722515).  Saving model ...
Epoch: 11 cost time: 10.722843408584595
Epoch: 11, Steps: 34 | Train Loss: 1.040 Vali Loss: 6.213 Vali Acc: 0.595 Test Loss: 6.213 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.32072138786316
Epoch: 12, Steps: 34 | Train Loss: 0.553 Vali Loss: 2.461 Vali Acc: 0.763 Test Loss: 2.461 Test Acc: 0.763
Validation loss decreased (-0.722515 --> -0.762981).  Saving model ...
Epoch: 13 cost time: 9.983907461166382
Epoch: 13, Steps: 34 | Train Loss: 0.649 Vali Loss: 4.380 Vali Acc: 0.723 Test Loss: 4.380 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.719620943069458
Epoch: 14, Steps: 34 | Train Loss: 1.046 Vali Loss: 3.376 Vali Acc: 0.711 Test Loss: 3.376 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.540172100067139
Epoch: 15, Steps: 34 | Train Loss: 0.218 Vali Loss: 15.546 Vali Acc: 0.532 Test Loss: 15.546 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.73757266998291
Epoch: 16, Steps: 34 | Train Loss: 2.090 Vali Loss: 5.177 Vali Acc: 0.665 Test Loss: 5.177 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.683408975601196
Epoch: 17, Steps: 34 | Train Loss: 1.064 Vali Loss: 6.566 Vali Acc: 0.723 Test Loss: 6.566 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.745800256729126
Epoch: 18, Steps: 34 | Train Loss: 0.204 Vali Loss: 2.849 Vali Acc: 0.769 Test Loss: 2.849 Test Acc: 0.769
Validation loss decreased (-0.762981 --> -0.768758).  Saving model ...
Epoch: 19 cost time: 10.825812101364136
Epoch: 19, Steps: 34 | Train Loss: 0.293 Vali Loss: 5.792 Vali Acc: 0.705 Test Loss: 5.792 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.965108394622803
Epoch: 20, Steps: 34 | Train Loss: 0.502 Vali Loss: 3.199 Vali Acc: 0.769 Test Loss: 3.199 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.3612220287323
Epoch: 21, Steps: 34 | Train Loss: 0.137 Vali Loss: 3.201 Vali Acc: 0.780 Test Loss: 3.201 Test Acc: 0.780
Validation loss decreased (-0.768758 --> -0.780315).  Saving model ...
Epoch: 22 cost time: 10.282795667648315
Epoch: 22, Steps: 34 | Train Loss: 0.001 Vali Loss: 4.370 Vali Acc: 0.798 Test Loss: 4.370 Test Acc: 0.798
Validation loss decreased (-0.780315 --> -0.797644).  Saving model ...
Epoch: 23 cost time: 10.392699956893921
Epoch: 23, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.165 Vali Acc: 0.786 Test Loss: 4.165 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.955399513244629
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.792 Test Loss: 3.637 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.608555555343628
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.465 Vali Acc: 0.809 Test Loss: 3.465 Test Acc: 0.809
Validation loss decreased (-0.797644 --> -0.809214).  Saving model ...
Epoch: 26 cost time: 10.297183513641357
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.463 Vali Acc: 0.809 Test Loss: 3.463 Test Acc: 0.809
Validation loss decreased (-0.809214 --> -0.809214).  Saving model ...
Epoch: 27 cost time: 9.304872512817383
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.465 Vali Acc: 0.803 Test Loss: 3.465 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 10.486106634140015
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.465 Vali Acc: 0.803 Test Loss: 3.465 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 10.827140808105469
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.465 Vali Acc: 0.803 Test Loss: 3.465 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 12.394574642181396
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.450 Vali Acc: 0.798 Test Loss: 3.450 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 11.79491400718689
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.453 Vali Acc: 0.792 Test Loss: 3.453 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 11.17514944076538
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.455 Vali Acc: 0.792 Test Loss: 3.455 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 11.29232931137085
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.455 Vali Acc: 0.792 Test Loss: 3.455 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 10.949676275253296
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.456 Vali Acc: 0.792 Test Loss: 3.456 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 11.05380630493164
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.457 Vali Acc: 0.792 Test Loss: 3.457 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 10.910588264465332
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.457 Vali Acc: 0.792 Test Loss: 3.457 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1375159
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.071591854095459
Epoch: 1, Steps: 34 | Train Loss: 2.137 Vali Loss: 2.153 Vali Acc: 0.277 Test Loss: 2.153 Test Acc: 0.277
Validation loss decreased (inf --> -0.277435).  Saving model ...
Epoch: 2 cost time: 11.015423059463501
Epoch: 2, Steps: 34 | Train Loss: 2.199 Vali Loss: 1.441 Vali Acc: 0.416 Test Loss: 1.441 Test Acc: 0.416
Validation loss decreased (-0.277435 --> -0.416171).  Saving model ...
Epoch: 3 cost time: 10.152021169662476
Epoch: 3, Steps: 34 | Train Loss: 1.784 Vali Loss: 1.748 Vali Acc: 0.607 Test Loss: 1.748 Test Acc: 0.607
Validation loss decreased (-0.416171 --> -0.606919).  Saving model ...
Epoch: 4 cost time: 11.1370530128479
Epoch: 4, Steps: 34 | Train Loss: 1.558 Vali Loss: 1.767 Vali Acc: 0.509 Test Loss: 1.767 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.837405920028687
Epoch: 5, Steps: 34 | Train Loss: 1.616 Vali Loss: 2.602 Vali Acc: 0.532 Test Loss: 2.602 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.992437601089478
Epoch: 6, Steps: 34 | Train Loss: 2.367 Vali Loss: 7.044 Vali Acc: 0.474 Test Loss: 7.044 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.278520822525024
Epoch: 7, Steps: 34 | Train Loss: 1.594 Vali Loss: 4.580 Vali Acc: 0.555 Test Loss: 4.580 Test Acc: 0.555
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.398513317108154
Epoch: 8, Steps: 34 | Train Loss: 1.614 Vali Loss: 6.065 Vali Acc: 0.543 Test Loss: 6.065 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.928163766860962
Epoch: 9, Steps: 34 | Train Loss: 0.933 Vali Loss: 3.268 Vali Acc: 0.607 Test Loss: 3.268 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.225440740585327
Epoch: 10, Steps: 34 | Train Loss: 0.385 Vali Loss: 2.157 Vali Acc: 0.734 Test Loss: 2.157 Test Acc: 0.734
Validation loss decreased (-0.606919 --> -0.734082).  Saving model ...
Epoch: 11 cost time: 9.96083378791809
Epoch: 11, Steps: 34 | Train Loss: 0.237 Vali Loss: 3.521 Vali Acc: 0.699 Test Loss: 3.521 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.271965742111206
Epoch: 12, Steps: 34 | Train Loss: 0.181 Vali Loss: 2.169 Vali Acc: 0.763 Test Loss: 2.169 Test Acc: 0.763
Validation loss decreased (-0.734082 --> -0.762984).  Saving model ...
Epoch: 13 cost time: 7.600771427154541
Epoch: 13, Steps: 34 | Train Loss: 0.544 Vali Loss: 2.269 Vali Acc: 0.734 Test Loss: 2.269 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.336779117584229
Epoch: 14, Steps: 34 | Train Loss: 0.520 Vali Loss: 3.461 Vali Acc: 0.734 Test Loss: 3.461 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.629566669464111
Epoch: 15, Steps: 34 | Train Loss: 0.294 Vali Loss: 1.952 Vali Acc: 0.803 Test Loss: 1.952 Test Acc: 0.803
Validation loss decreased (-0.762984 --> -0.803449).  Saving model ...
Epoch: 16 cost time: 11.856528520584106
Epoch: 16, Steps: 34 | Train Loss: 0.098 Vali Loss: 2.735 Vali Acc: 0.751 Test Loss: 2.735 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.15117073059082
Epoch: 17, Steps: 34 | Train Loss: 0.505 Vali Loss: 1.850 Vali Acc: 0.775 Test Loss: 1.850 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.772573232650757
Epoch: 18, Steps: 34 | Train Loss: 0.576 Vali Loss: 2.661 Vali Acc: 0.786 Test Loss: 2.661 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.559767723083496
Epoch: 19, Steps: 34 | Train Loss: 0.123 Vali Loss: 2.083 Vali Acc: 0.803 Test Loss: 2.083 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.996747493743896
Epoch: 20, Steps: 34 | Train Loss: 0.632 Vali Loss: 5.291 Vali Acc: 0.694 Test Loss: 5.291 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.611530780792236
Epoch: 21, Steps: 34 | Train Loss: 0.280 Vali Loss: 3.563 Vali Acc: 0.780 Test Loss: 3.563 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.136223077774048
Epoch: 22, Steps: 34 | Train Loss: 0.239 Vali Loss: 4.329 Vali Acc: 0.815 Test Loss: 4.329 Test Acc: 0.815
Validation loss decreased (-0.803449 --> -0.814986).  Saving model ...
Epoch: 23 cost time: 9.959094047546387
Epoch: 23, Steps: 34 | Train Loss: 0.041 Vali Loss: 4.205 Vali Acc: 0.757 Test Loss: 4.205 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.594414472579956
Epoch: 24, Steps: 34 | Train Loss: 0.185 Vali Loss: 4.070 Vali Acc: 0.780 Test Loss: 4.070 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.677085876464844
Epoch: 25, Steps: 34 | Train Loss: 0.277 Vali Loss: 2.179 Vali Acc: 0.827 Test Loss: 2.179 Test Acc: 0.827
Validation loss decreased (-0.814986 --> -0.826568).  Saving model ...
Epoch: 26 cost time: 10.708873748779297
Epoch: 26, Steps: 34 | Train Loss: 0.325 Vali Loss: 4.667 Vali Acc: 0.780 Test Loss: 4.667 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 11.055578708648682
Epoch: 27, Steps: 34 | Train Loss: 0.421 Vali Loss: 2.817 Vali Acc: 0.786 Test Loss: 2.817 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 10.153887033462524
Epoch: 28, Steps: 34 | Train Loss: 0.434 Vali Loss: 3.866 Vali Acc: 0.780 Test Loss: 3.866 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 9.812119960784912
Epoch: 29, Steps: 34 | Train Loss: 0.262 Vali Loss: 6.569 Vali Acc: 0.671 Test Loss: 6.569 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.978203773498535
Epoch: 30, Steps: 34 | Train Loss: 0.183 Vali Loss: 4.048 Vali Acc: 0.798 Test Loss: 4.048 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 9.966384410858154
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.460 Vali Acc: 0.809 Test Loss: 3.460 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 10.945862293243408
Epoch: 32, Steps: 34 | Train Loss: 0.273 Vali Loss: 3.684 Vali Acc: 0.803 Test Loss: 3.684 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 10.75671648979187
Epoch: 33, Steps: 34 | Train Loss: 0.108 Vali Loss: 3.098 Vali Acc: 0.798 Test Loss: 3.098 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 10.612282752990723
Epoch: 34, Steps: 34 | Train Loss: 0.023 Vali Loss: 3.057 Vali Acc: 0.827 Test Loss: 3.057 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 10.186586141586304
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.066 Vali Acc: 0.803 Test Loss: 3.066 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1374487
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.266759157180786
Epoch: 1, Steps: 34 | Train Loss: 2.638 Vali Loss: 4.357 Vali Acc: 0.260 Test Loss: 4.357 Test Acc: 0.260
Validation loss decreased (inf --> -0.260072).  Saving model ...
Epoch: 2 cost time: 9.451015949249268
Epoch: 2, Steps: 34 | Train Loss: 2.114 Vali Loss: 2.825 Vali Acc: 0.295 Test Loss: 2.825 Test Acc: 0.295
Validation loss decreased (-0.260072 --> -0.294769).  Saving model ...
Epoch: 3 cost time: 10.416746854782104
Epoch: 3, Steps: 34 | Train Loss: 2.183 Vali Loss: 3.378 Vali Acc: 0.347 Test Loss: 3.378 Test Acc: 0.347
Validation loss decreased (-0.294769 --> -0.346787).  Saving model ...
Epoch: 4 cost time: 10.294751644134521
Epoch: 4, Steps: 34 | Train Loss: 1.789 Vali Loss: 3.361 Vali Acc: 0.457 Test Loss: 3.361 Test Acc: 0.457
Validation loss decreased (-0.346787 --> -0.456614).  Saving model ...
Epoch: 5 cost time: 10.65575909614563
Epoch: 5, Steps: 34 | Train Loss: 2.686 Vali Loss: 3.225 Vali Acc: 0.555 Test Loss: 3.225 Test Acc: 0.555
Validation loss decreased (-0.456614 --> -0.554881).  Saving model ...
Epoch: 6 cost time: 10.530182361602783
Epoch: 6, Steps: 34 | Train Loss: 1.967 Vali Loss: 1.262 Vali Acc: 0.757 Test Loss: 1.262 Test Acc: 0.757
Validation loss decreased (-0.554881 --> -0.757213).  Saving model ...
Epoch: 7 cost time: 10.597965955734253
Epoch: 7, Steps: 34 | Train Loss: 1.526 Vali Loss: 3.014 Vali Acc: 0.607 Test Loss: 3.014 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.318094968795776
Epoch: 8, Steps: 34 | Train Loss: 1.575 Vali Loss: 4.408 Vali Acc: 0.595 Test Loss: 4.408 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.0207998752594
Epoch: 9, Steps: 34 | Train Loss: 2.768 Vali Loss: 3.033 Vali Acc: 0.624 Test Loss: 3.033 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.27061152458191
Epoch: 10, Steps: 34 | Train Loss: 0.873 Vali Loss: 2.734 Vali Acc: 0.740 Test Loss: 2.734 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.6211256980896
Epoch: 11, Steps: 34 | Train Loss: 0.892 Vali Loss: 2.772 Vali Acc: 0.711 Test Loss: 2.772 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.078982830047607
Epoch: 12, Steps: 34 | Train Loss: 1.308 Vali Loss: 2.207 Vali Acc: 0.786 Test Loss: 2.207 Test Acc: 0.786
Validation loss decreased (-0.757213 --> -0.786105).  Saving model ...
Epoch: 13 cost time: 9.417733669281006
Epoch: 13, Steps: 34 | Train Loss: 0.536 Vali Loss: 4.983 Vali Acc: 0.682 Test Loss: 4.983 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.434646844863892
Epoch: 14, Steps: 34 | Train Loss: 0.903 Vali Loss: 5.150 Vali Acc: 0.699 Test Loss: 5.150 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.754709720611572
Epoch: 15, Steps: 34 | Train Loss: 1.040 Vali Loss: 9.017 Vali Acc: 0.613 Test Loss: 9.017 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.911818027496338
Epoch: 16, Steps: 34 | Train Loss: 0.798 Vali Loss: 6.109 Vali Acc: 0.613 Test Loss: 6.109 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.104317903518677
Epoch: 17, Steps: 34 | Train Loss: 0.650 Vali Loss: 3.925 Vali Acc: 0.746 Test Loss: 3.925 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.05673360824585
Epoch: 18, Steps: 34 | Train Loss: 0.209 Vali Loss: 7.064 Vali Acc: 0.682 Test Loss: 7.064 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.38033413887024
Epoch: 19, Steps: 34 | Train Loss: 0.537 Vali Loss: 6.282 Vali Acc: 0.665 Test Loss: 6.282 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.430430889129639
Epoch: 20, Steps: 34 | Train Loss: 0.078 Vali Loss: 4.169 Vali Acc: 0.763 Test Loss: 4.169 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.11674976348877
Epoch: 21, Steps: 34 | Train Loss: 0.341 Vali Loss: 7.510 Vali Acc: 0.590 Test Loss: 7.510 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.195924997329712
Epoch: 22, Steps: 34 | Train Loss: 0.309 Vali Loss: 3.028 Vali Acc: 0.763 Test Loss: 3.028 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1373815
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.406177997589111
Epoch: 1, Steps: 34 | Train Loss: 2.177 Vali Loss: 2.715 Vali Acc: 0.422 Test Loss: 2.715 Test Acc: 0.422
Validation loss decreased (inf --> -0.421938).  Saving model ...
Epoch: 2 cost time: 9.082229614257812
Epoch: 2, Steps: 34 | Train Loss: 2.543 Vali Loss: 2.514 Vali Acc: 0.399 Test Loss: 2.514 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.708356380462646
Epoch: 3, Steps: 34 | Train Loss: 2.275 Vali Loss: 2.709 Vali Acc: 0.341 Test Loss: 2.709 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.73051381111145
Epoch: 4, Steps: 34 | Train Loss: 2.098 Vali Loss: 3.804 Vali Acc: 0.561 Test Loss: 3.804 Test Acc: 0.561
Validation loss decreased (-0.421938 --> -0.560656).  Saving model ...
Epoch: 5 cost time: 10.258732795715332
Epoch: 5, Steps: 34 | Train Loss: 1.797 Vali Loss: 2.639 Vali Acc: 0.578 Test Loss: 2.639 Test Acc: 0.578
Validation loss decreased (-0.560656 --> -0.578008).  Saving model ...
Epoch: 6 cost time: 9.99735951423645
Epoch: 6, Steps: 34 | Train Loss: 1.182 Vali Loss: 5.740 Vali Acc: 0.468 Test Loss: 5.740 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.074575662612915
Epoch: 7, Steps: 34 | Train Loss: 2.987 Vali Loss: 8.893 Vali Acc: 0.416 Test Loss: 8.893 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.607157230377197
Epoch: 8, Steps: 34 | Train Loss: 1.859 Vali Loss: 7.476 Vali Acc: 0.590 Test Loss: 7.476 Test Acc: 0.590
Validation loss decreased (-0.578008 --> -0.589521).  Saving model ...
Epoch: 9 cost time: 10.661239385604858
Epoch: 9, Steps: 34 | Train Loss: 1.813 Vali Loss: 3.802 Vali Acc: 0.584 Test Loss: 3.802 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.560269594192505
Epoch: 10, Steps: 34 | Train Loss: 0.732 Vali Loss: 4.669 Vali Acc: 0.694 Test Loss: 4.669 Test Acc: 0.694
Validation loss decreased (-0.589521 --> -0.693595).  Saving model ...
Epoch: 11 cost time: 11.53939962387085
Epoch: 11, Steps: 34 | Train Loss: 0.837 Vali Loss: 3.280 Vali Acc: 0.671 Test Loss: 3.280 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.445528507232666
Epoch: 12, Steps: 34 | Train Loss: 1.687 Vali Loss: 4.794 Vali Acc: 0.578 Test Loss: 4.794 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.947453022003174
Epoch: 13, Steps: 34 | Train Loss: 1.290 Vali Loss: 4.091 Vali Acc: 0.607 Test Loss: 4.091 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.258306980133057
Epoch: 14, Steps: 34 | Train Loss: 0.555 Vali Loss: 2.477 Vali Acc: 0.780 Test Loss: 2.477 Test Acc: 0.780
Validation loss decreased (-0.693595 --> -0.780322).  Saving model ...
Epoch: 15 cost time: 9.38270378112793
Epoch: 15, Steps: 34 | Train Loss: 0.588 Vali Loss: 2.164 Vali Acc: 0.786 Test Loss: 2.164 Test Acc: 0.786
Validation loss decreased (-0.780322 --> -0.786106).  Saving model ...
Epoch: 16 cost time: 10.222875595092773
Epoch: 16, Steps: 34 | Train Loss: 0.407 Vali Loss: 2.208 Vali Acc: 0.798 Test Loss: 2.208 Test Acc: 0.798
Validation loss decreased (-0.786106 --> -0.797666).  Saving model ...
Epoch: 17 cost time: 10.436232089996338
Epoch: 17, Steps: 34 | Train Loss: 0.481 Vali Loss: 3.201 Vali Acc: 0.792 Test Loss: 3.201 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.770502090454102
Epoch: 18, Steps: 34 | Train Loss: 1.117 Vali Loss: 5.638 Vali Acc: 0.746 Test Loss: 5.638 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.78552794456482
Epoch: 19, Steps: 34 | Train Loss: 0.151 Vali Loss: 2.629 Vali Acc: 0.769 Test Loss: 2.629 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.901944160461426
Epoch: 20, Steps: 34 | Train Loss: 0.166 Vali Loss: 3.722 Vali Acc: 0.763 Test Loss: 3.722 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.862309455871582
Epoch: 21, Steps: 34 | Train Loss: 0.166 Vali Loss: 1.903 Vali Acc: 0.803 Test Loss: 1.903 Test Acc: 0.803
Validation loss decreased (-0.797666 --> -0.803449).  Saving model ...
Epoch: 22 cost time: 9.80287790298462
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.265 Vali Acc: 0.827 Test Loss: 2.265 Test Acc: 0.827
Validation loss decreased (-0.803449 --> -0.826567).  Saving model ...
Epoch: 23 cost time: 10.22921109199524
Epoch: 23, Steps: 34 | Train Loss: 0.054 Vali Loss: 2.688 Vali Acc: 0.769 Test Loss: 2.688 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.498771905899048
Epoch: 24, Steps: 34 | Train Loss: 0.104 Vali Loss: 4.947 Vali Acc: 0.751 Test Loss: 4.947 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.95629072189331
Epoch: 25, Steps: 34 | Train Loss: 0.040 Vali Loss: 2.639 Vali Acc: 0.769 Test Loss: 2.639 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.736435413360596
Epoch: 26, Steps: 34 | Train Loss: 0.042 Vali Loss: 2.245 Vali Acc: 0.855 Test Loss: 2.245 Test Acc: 0.855
Validation loss decreased (-0.826567 --> -0.855469).  Saving model ...
Epoch: 27 cost time: 9.91490912437439
Epoch: 27, Steps: 34 | Train Loss: 0.043 Vali Loss: 4.368 Vali Acc: 0.798 Test Loss: 4.368 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 9.999565362930298
Epoch: 28, Steps: 34 | Train Loss: 0.216 Vali Loss: 5.251 Vali Acc: 0.694 Test Loss: 5.251 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 10.313218116760254
Epoch: 29, Steps: 34 | Train Loss: 0.216 Vali Loss: 2.783 Vali Acc: 0.786 Test Loss: 2.783 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.679875612258911
Epoch: 30, Steps: 34 | Train Loss: 0.140 Vali Loss: 3.552 Vali Acc: 0.751 Test Loss: 3.552 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 10.650216341018677
Epoch: 31, Steps: 34 | Train Loss: 0.652 Vali Loss: 3.515 Vali Acc: 0.821 Test Loss: 3.515 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 10.226967811584473
Epoch: 32, Steps: 34 | Train Loss: 0.305 Vali Loss: 2.210 Vali Acc: 0.850 Test Loss: 2.210 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 11.136454820632935
Epoch: 33, Steps: 34 | Train Loss: 0.578 Vali Loss: 2.534 Vali Acc: 0.769 Test Loss: 2.534 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 11.222501993179321
Epoch: 34, Steps: 34 | Train Loss: 0.325 Vali Loss: 4.271 Vali Acc: 0.775 Test Loss: 4.271 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 11.365761041641235
Epoch: 35, Steps: 34 | Train Loss: 0.519 Vali Loss: 2.707 Vali Acc: 0.832 Test Loss: 2.707 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 11.1905038356781
Epoch: 36, Steps: 34 | Train Loss: 0.306 Vali Loss: 7.000 Vali Acc: 0.751 Test Loss: 7.000 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1259351
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.77409291267395
Epoch: 1, Steps: 34 | Train Loss: 2.321 Vali Loss: 3.179 Vali Acc: 0.393 Test Loss: 3.179 Test Acc: 0.393
Validation loss decreased (inf --> -0.393032).  Saving model ...
Epoch: 2 cost time: 9.389265060424805
Epoch: 2, Steps: 34 | Train Loss: 2.229 Vali Loss: 2.218 Vali Acc: 0.451 Test Loss: 2.218 Test Acc: 0.451
Validation loss decreased (-0.393032 --> -0.450845).  Saving model ...
Epoch: 3 cost time: 7.551930904388428
Epoch: 3, Steps: 34 | Train Loss: 2.005 Vali Loss: 3.385 Vali Acc: 0.566 Test Loss: 3.385 Test Acc: 0.566
Validation loss decreased (-0.450845 --> -0.566440).  Saving model ...
Epoch: 4 cost time: 7.561749219894409
Epoch: 4, Steps: 34 | Train Loss: 3.460 Vali Loss: 4.013 Vali Acc: 0.410 Test Loss: 4.013 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.83973479270935
Epoch: 5, Steps: 34 | Train Loss: 2.925 Vali Loss: 3.021 Vali Acc: 0.595 Test Loss: 3.021 Test Acc: 0.595
Validation loss decreased (-0.566440 --> -0.595346).  Saving model ...
Epoch: 6 cost time: 9.448673963546753
Epoch: 6, Steps: 34 | Train Loss: 2.762 Vali Loss: 5.984 Vali Acc: 0.457 Test Loss: 5.984 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.308515310287476
Epoch: 7, Steps: 34 | Train Loss: 1.995 Vali Loss: 3.335 Vali Acc: 0.584 Test Loss: 3.335 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.489009618759155
Epoch: 8, Steps: 34 | Train Loss: 1.873 Vali Loss: 2.220 Vali Acc: 0.705 Test Loss: 2.220 Test Acc: 0.705
Validation loss decreased (-0.595346 --> -0.705180).  Saving model ...
Epoch: 9 cost time: 9.856610536575317
Epoch: 9, Steps: 34 | Train Loss: 1.130 Vali Loss: 2.010 Vali Acc: 0.740 Test Loss: 2.010 Test Acc: 0.740
Validation loss decreased (-0.705180 --> -0.739864).  Saving model ...
Epoch: 10 cost time: 10.095630884170532
Epoch: 10, Steps: 34 | Train Loss: 0.758 Vali Loss: 2.512 Vali Acc: 0.705 Test Loss: 2.512 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.582371950149536
Epoch: 11, Steps: 34 | Train Loss: 0.643 Vali Loss: 3.052 Vali Acc: 0.757 Test Loss: 3.052 Test Acc: 0.757
Validation loss decreased (-0.739864 --> -0.757195).  Saving model ...
Epoch: 12 cost time: 8.876903295516968
Epoch: 12, Steps: 34 | Train Loss: 0.891 Vali Loss: 3.947 Vali Acc: 0.659 Test Loss: 3.947 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.45226240158081
Epoch: 13, Steps: 34 | Train Loss: 1.306 Vali Loss: 2.452 Vali Acc: 0.775 Test Loss: 2.452 Test Acc: 0.775
Validation loss decreased (-0.757195 --> -0.774542).  Saving model ...
Epoch: 14 cost time: 9.25563907623291
Epoch: 14, Steps: 34 | Train Loss: 0.883 Vali Loss: 4.185 Vali Acc: 0.688 Test Loss: 4.185 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.917944192886353
Epoch: 15, Steps: 34 | Train Loss: 1.823 Vali Loss: 3.368 Vali Acc: 0.723 Test Loss: 3.368 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.670677661895752
Epoch: 16, Steps: 34 | Train Loss: 0.641 Vali Loss: 2.754 Vali Acc: 0.740 Test Loss: 2.754 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.329943418502808
Epoch: 17, Steps: 34 | Train Loss: 0.208 Vali Loss: 2.321 Vali Acc: 0.769 Test Loss: 2.321 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.573768615722656
Epoch: 18, Steps: 34 | Train Loss: 0.202 Vali Loss: 2.374 Vali Acc: 0.821 Test Loss: 2.374 Test Acc: 0.821
Validation loss decreased (-0.774542 --> -0.820786).  Saving model ...
Epoch: 19 cost time: 10.499865293502808
Epoch: 19, Steps: 34 | Train Loss: 0.372 Vali Loss: 2.929 Vali Acc: 0.786 Test Loss: 2.929 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.135130643844604
Epoch: 20, Steps: 34 | Train Loss: 0.038 Vali Loss: 5.771 Vali Acc: 0.694 Test Loss: 5.771 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.435347080230713
Epoch: 21, Steps: 34 | Train Loss: 0.116 Vali Loss: 4.064 Vali Acc: 0.809 Test Loss: 4.064 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.125481128692627
Epoch: 22, Steps: 34 | Train Loss: 0.043 Vali Loss: 2.577 Vali Acc: 0.867 Test Loss: 2.577 Test Acc: 0.867
Validation loss decreased (-0.820786 --> -0.867026).  Saving model ...
Epoch: 23 cost time: 10.729369878768921
Epoch: 23, Steps: 34 | Train Loss: 0.024 Vali Loss: 2.418 Vali Acc: 0.844 Test Loss: 2.418 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.446723937988281
Epoch: 24, Steps: 34 | Train Loss: 0.262 Vali Loss: 3.814 Vali Acc: 0.838 Test Loss: 3.814 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.735796689987183
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.632 Vali Acc: 0.838 Test Loss: 3.632 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.405793190002441
Epoch: 26, Steps: 34 | Train Loss: 0.003 Vali Loss: 2.794 Vali Acc: 0.803 Test Loss: 2.794 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.093695640563965
Epoch: 27, Steps: 34 | Train Loss: 0.070 Vali Loss: 2.070 Vali Acc: 0.844 Test Loss: 2.070 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.228003740310669
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.855 Test Loss: 1.839 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.063228130340576
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.855 Test Loss: 1.836 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 10.387780666351318
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.855 Test Loss: 1.836 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 9.675096988677979
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.855 Test Loss: 1.837 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 8.736510276794434
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.855 Test Loss: 1.837 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1258679
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.423824787139893
Epoch: 1, Steps: 34 | Train Loss: 2.053 Vali Loss: 1.945 Vali Acc: 0.445 Test Loss: 1.945 Test Acc: 0.445
Validation loss decreased (inf --> -0.445067).  Saving model ...
Epoch: 2 cost time: 10.164230108261108
Epoch: 2, Steps: 34 | Train Loss: 2.837 Vali Loss: 5.620 Vali Acc: 0.405 Test Loss: 5.620 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.857968807220459
Epoch: 3, Steps: 34 | Train Loss: 2.071 Vali Loss: 1.377 Vali Acc: 0.636 Test Loss: 1.377 Test Acc: 0.636
Validation loss decreased (-0.445067 --> -0.635824).  Saving model ...
Epoch: 4 cost time: 9.352668762207031
Epoch: 4, Steps: 34 | Train Loss: 2.264 Vali Loss: 3.536 Vali Acc: 0.543 Test Loss: 3.536 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.19879674911499
Epoch: 5, Steps: 34 | Train Loss: 2.141 Vali Loss: 6.513 Vali Acc: 0.428 Test Loss: 6.513 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.688378095626831
Epoch: 6, Steps: 34 | Train Loss: 2.501 Vali Loss: 2.706 Vali Acc: 0.584 Test Loss: 2.706 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.528923034667969
Epoch: 7, Steps: 34 | Train Loss: 1.598 Vali Loss: 2.677 Vali Acc: 0.647 Test Loss: 2.677 Test Acc: 0.647
Validation loss decreased (-0.635824 --> -0.647372).  Saving model ...
Epoch: 8 cost time: 10.16922903060913
Epoch: 8, Steps: 34 | Train Loss: 1.643 Vali Loss: 3.066 Vali Acc: 0.595 Test Loss: 3.066 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.007943630218506
Epoch: 9, Steps: 34 | Train Loss: 0.957 Vali Loss: 4.454 Vali Acc: 0.578 Test Loss: 4.454 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.042555093765259
Epoch: 10, Steps: 34 | Train Loss: 1.572 Vali Loss: 4.190 Vali Acc: 0.688 Test Loss: 4.190 Test Acc: 0.688
Validation loss decreased (-0.647372 --> -0.687819).  Saving model ...
Epoch: 11 cost time: 8.595377683639526
Epoch: 11, Steps: 34 | Train Loss: 0.782 Vali Loss: 2.978 Vali Acc: 0.711 Test Loss: 2.978 Test Acc: 0.711
Validation loss decreased (-0.687819 --> -0.710953).  Saving model ...
Epoch: 12 cost time: 10.654351234436035
Epoch: 12, Steps: 34 | Train Loss: 0.816 Vali Loss: 1.840 Vali Acc: 0.792 Test Loss: 1.840 Test Acc: 0.792
Validation loss decreased (-0.710953 --> -0.791889).  Saving model ...
Epoch: 13 cost time: 9.880391597747803
Epoch: 13, Steps: 34 | Train Loss: 0.283 Vali Loss: 6.053 Vali Acc: 0.624 Test Loss: 6.053 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.162852048873901
Epoch: 14, Steps: 34 | Train Loss: 0.747 Vali Loss: 1.587 Vali Acc: 0.809 Test Loss: 1.587 Test Acc: 0.809
Validation loss decreased (-0.791889 --> -0.809233).  Saving model ...
Epoch: 15 cost time: 11.68640398979187
Epoch: 15, Steps: 34 | Train Loss: 0.441 Vali Loss: 2.277 Vali Acc: 0.815 Test Loss: 2.277 Test Acc: 0.815
Validation loss decreased (-0.809233 --> -0.815006).  Saving model ...
Epoch: 16 cost time: 9.711429595947266
Epoch: 16, Steps: 34 | Train Loss: 0.459 Vali Loss: 4.557 Vali Acc: 0.769 Test Loss: 4.557 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.909679174423218
Epoch: 17, Steps: 34 | Train Loss: 0.106 Vali Loss: 3.310 Vali Acc: 0.815 Test Loss: 3.310 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.916212320327759
Epoch: 18, Steps: 34 | Train Loss: 0.309 Vali Loss: 4.331 Vali Acc: 0.780 Test Loss: 4.331 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.233726978302002
Epoch: 19, Steps: 34 | Train Loss: 0.239 Vali Loss: 6.251 Vali Acc: 0.653 Test Loss: 6.251 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.774605989456177
Epoch: 20, Steps: 34 | Train Loss: 0.498 Vali Loss: 4.655 Vali Acc: 0.734 Test Loss: 4.655 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.42586636543274
Epoch: 21, Steps: 34 | Train Loss: 0.512 Vali Loss: 6.114 Vali Acc: 0.728 Test Loss: 6.114 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.260180711746216
Epoch: 22, Steps: 34 | Train Loss: 0.150 Vali Loss: 2.698 Vali Acc: 0.798 Test Loss: 2.698 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.805106401443481
Epoch: 23, Steps: 34 | Train Loss: 0.266 Vali Loss: 3.862 Vali Acc: 0.775 Test Loss: 3.862 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.051179885864258
Epoch: 24, Steps: 34 | Train Loss: 0.016 Vali Loss: 2.349 Vali Acc: 0.838 Test Loss: 2.349 Test Acc: 0.838
Validation loss decreased (-0.815006 --> -0.838127).  Saving model ...
Epoch: 25 cost time: 9.787497282028198
Epoch: 25, Steps: 34 | Train Loss: 0.390 Vali Loss: 3.548 Vali Acc: 0.786 Test Loss: 3.548 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.509779453277588
Epoch: 26, Steps: 34 | Train Loss: 0.106 Vali Loss: 2.584 Vali Acc: 0.827 Test Loss: 2.584 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 10.257692575454712
Epoch: 27, Steps: 34 | Train Loss: 0.198 Vali Loss: 2.968 Vali Acc: 0.775 Test Loss: 2.968 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.469794273376465
Epoch: 28, Steps: 34 | Train Loss: 0.063 Vali Loss: 2.761 Vali Acc: 0.809 Test Loss: 2.761 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.85787034034729
Epoch: 29, Steps: 34 | Train Loss: 0.044 Vali Loss: 3.013 Vali Acc: 0.792 Test Loss: 3.013 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.177587985992432
Epoch: 30, Steps: 34 | Train Loss: 0.091 Vali Loss: 2.292 Vali Acc: 0.838 Test Loss: 2.292 Test Acc: 0.838
Validation loss decreased (-0.838127 --> -0.838127).  Saving model ...
Epoch: 31 cost time: 8.511345863342285
Epoch: 31, Steps: 34 | Train Loss: 0.778 Vali Loss: 5.702 Vali Acc: 0.705 Test Loss: 5.702 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 9.544664859771729
Epoch: 32, Steps: 34 | Train Loss: 0.997 Vali Loss: 8.866 Vali Acc: 0.630 Test Loss: 8.866 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 10.02306318283081
Epoch: 33, Steps: 34 | Train Loss: 1.301 Vali Loss: 4.646 Vali Acc: 0.740 Test Loss: 4.646 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 8.782349109649658
Epoch: 34, Steps: 34 | Train Loss: 0.504 Vali Loss: 8.587 Vali Acc: 0.723 Test Loss: 8.587 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 11.23054027557373
Epoch: 35, Steps: 34 | Train Loss: 0.198 Vali Loss: 5.324 Vali Acc: 0.734 Test Loss: 5.324 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 10.279168367385864
Epoch: 36, Steps: 34 | Train Loss: 0.476 Vali Loss: 6.980 Vali Acc: 0.740 Test Loss: 6.980 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 10.904526472091675
Epoch: 37, Steps: 34 | Train Loss: 0.050 Vali Loss: 2.745 Vali Acc: 0.786 Test Loss: 2.745 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 11.246121644973755
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.547 Vali Acc: 0.798 Test Loss: 3.547 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 9.532771587371826
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.547 Vali Acc: 0.798 Test Loss: 3.547 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 11.177667140960693
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.543 Vali Acc: 0.798 Test Loss: 3.543 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1258007
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.171704530715942
Epoch: 1, Steps: 34 | Train Loss: 2.858 Vali Loss: 2.209 Vali Acc: 0.416 Test Loss: 2.209 Test Acc: 0.416
Validation loss decreased (inf --> -0.416163).  Saving model ...
Epoch: 2 cost time: 9.12099575996399
Epoch: 2, Steps: 34 | Train Loss: 2.085 Vali Loss: 1.030 Vali Acc: 0.624 Test Loss: 1.030 Test Acc: 0.624
Validation loss decreased (-0.416163 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 9.476505279541016
Epoch: 3, Steps: 34 | Train Loss: 2.121 Vali Loss: 1.334 Vali Acc: 0.555 Test Loss: 1.334 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.6525297164917
Epoch: 4, Steps: 34 | Train Loss: 2.129 Vali Loss: 2.978 Vali Acc: 0.584 Test Loss: 2.978 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.2034330368042
Epoch: 5, Steps: 34 | Train Loss: 1.953 Vali Loss: 5.090 Vali Acc: 0.561 Test Loss: 5.090 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.019020080566406
Epoch: 6, Steps: 34 | Train Loss: 2.909 Vali Loss: 3.783 Vali Acc: 0.549 Test Loss: 3.783 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.625032186508179
Epoch: 7, Steps: 34 | Train Loss: 2.879 Vali Loss: 4.945 Vali Acc: 0.520 Test Loss: 4.945 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.734827518463135
Epoch: 8, Steps: 34 | Train Loss: 1.434 Vali Loss: 4.628 Vali Acc: 0.653 Test Loss: 4.628 Test Acc: 0.653
Validation loss decreased (-0.624267 --> -0.653133).  Saving model ...
Epoch: 9 cost time: 9.248035907745361
Epoch: 9, Steps: 34 | Train Loss: 3.035 Vali Loss: 3.167 Vali Acc: 0.688 Test Loss: 3.167 Test Acc: 0.688
Validation loss decreased (-0.653133 --> -0.687830).  Saving model ...
Epoch: 10 cost time: 9.622007608413696
Epoch: 10, Steps: 34 | Train Loss: 3.405 Vali Loss: 6.556 Vali Acc: 0.566 Test Loss: 6.556 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.010478258132935
Epoch: 11, Steps: 34 | Train Loss: 1.580 Vali Loss: 2.973 Vali Acc: 0.688 Test Loss: 2.973 Test Acc: 0.688
Validation loss decreased (-0.687830 --> -0.687832).  Saving model ...
Epoch: 12 cost time: 7.183229207992554
Epoch: 12, Steps: 34 | Train Loss: 1.201 Vali Loss: 2.504 Vali Acc: 0.763 Test Loss: 2.504 Test Acc: 0.763
Validation loss decreased (-0.687832 --> -0.762981).  Saving model ...
Epoch: 13 cost time: 7.043513298034668
Epoch: 13, Steps: 34 | Train Loss: 2.196 Vali Loss: 7.052 Vali Acc: 0.624 Test Loss: 7.052 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.034883737564087
Epoch: 14, Steps: 34 | Train Loss: 0.835 Vali Loss: 3.185 Vali Acc: 0.786 Test Loss: 3.185 Test Acc: 0.786
Validation loss decreased (-0.762981 --> -0.786095).  Saving model ...
Epoch: 15 cost time: 9.101937294006348
Epoch: 15, Steps: 34 | Train Loss: 0.230 Vali Loss: 2.606 Vali Acc: 0.780 Test Loss: 2.606 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.549612522125244
Epoch: 16, Steps: 34 | Train Loss: 0.155 Vali Loss: 4.501 Vali Acc: 0.717 Test Loss: 4.501 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.93291449546814
Epoch: 17, Steps: 34 | Train Loss: 0.113 Vali Loss: 2.776 Vali Acc: 0.769 Test Loss: 2.776 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.062248706817627
Epoch: 18, Steps: 34 | Train Loss: 0.013 Vali Loss: 2.835 Vali Acc: 0.757 Test Loss: 2.835 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.435330390930176
Epoch: 19, Steps: 34 | Train Loss: 0.465 Vali Loss: 3.676 Vali Acc: 0.751 Test Loss: 3.676 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.0270254611969
Epoch: 20, Steps: 34 | Train Loss: 0.168 Vali Loss: 2.516 Vali Acc: 0.803 Test Loss: 2.516 Test Acc: 0.803
Validation loss decreased (-0.786095 --> -0.803443).  Saving model ...
Epoch: 21 cost time: 9.75422215461731
Epoch: 21, Steps: 34 | Train Loss: 0.094 Vali Loss: 3.290 Vali Acc: 0.757 Test Loss: 3.290 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.023989200592041
Epoch: 22, Steps: 34 | Train Loss: 0.151 Vali Loss: 4.023 Vali Acc: 0.775 Test Loss: 4.023 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.016987562179565
Epoch: 23, Steps: 34 | Train Loss: 0.301 Vali Loss: 5.591 Vali Acc: 0.642 Test Loss: 5.591 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.529146909713745
Epoch: 24, Steps: 34 | Train Loss: 0.455 Vali Loss: 2.964 Vali Acc: 0.775 Test Loss: 2.964 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 10.798643350601196
Epoch: 25, Steps: 34 | Train Loss: 0.099 Vali Loss: 3.667 Vali Acc: 0.786 Test Loss: 3.667 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.834264993667603
Epoch: 26, Steps: 34 | Train Loss: 0.069 Vali Loss: 2.142 Vali Acc: 0.780 Test Loss: 2.142 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.90393328666687
Epoch: 27, Steps: 34 | Train Loss: 0.046 Vali Loss: 3.349 Vali Acc: 0.786 Test Loss: 3.349 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.30533218383789
Epoch: 28, Steps: 34 | Train Loss: 0.122 Vali Loss: 2.532 Vali Acc: 0.786 Test Loss: 2.532 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.123010158538818
Epoch: 29, Steps: 34 | Train Loss: 0.072 Vali Loss: 2.650 Vali Acc: 0.769 Test Loss: 2.650 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.201372385025024
Epoch: 30, Steps: 34 | Train Loss: 0.003 Vali Loss: 3.835 Vali Acc: 0.751 Test Loss: 3.835 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1257335
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.596606731414795
Epoch: 1, Steps: 34 | Train Loss: 2.326 Vali Loss: 3.067 Vali Acc: 0.353 Test Loss: 3.067 Test Acc: 0.353
Validation loss decreased (inf --> -0.352570).  Saving model ...
Epoch: 2 cost time: 9.04205846786499
Epoch: 2, Steps: 34 | Train Loss: 2.268 Vali Loss: 2.257 Vali Acc: 0.358 Test Loss: 2.257 Test Acc: 0.358
Validation loss decreased (-0.352570 --> -0.358359).  Saving model ...
Epoch: 3 cost time: 8.99420166015625
Epoch: 3, Steps: 34 | Train Loss: 2.499 Vali Loss: 4.624 Vali Acc: 0.382 Test Loss: 4.624 Test Acc: 0.382
Validation loss decreased (-0.358359 --> -0.381457).  Saving model ...
Epoch: 4 cost time: 8.870569705963135
Epoch: 4, Steps: 34 | Train Loss: 1.791 Vali Loss: 5.152 Vali Acc: 0.382 Test Loss: 5.152 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.260507345199585
Epoch: 5, Steps: 34 | Train Loss: 1.592 Vali Loss: 2.783 Vali Acc: 0.642 Test Loss: 2.783 Test Acc: 0.642
Validation loss decreased (-0.381457 --> -0.641591).  Saving model ...
Epoch: 6 cost time: 10.238193273544312
Epoch: 6, Steps: 34 | Train Loss: 2.776 Vali Loss: 5.675 Vali Acc: 0.324 Test Loss: 5.675 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.256120920181274
Epoch: 7, Steps: 34 | Train Loss: 1.966 Vali Loss: 1.671 Vali Acc: 0.792 Test Loss: 1.671 Test Acc: 0.792
Validation loss decreased (-0.641591 --> -0.791891).  Saving model ...
Epoch: 8 cost time: 8.771898746490479
Epoch: 8, Steps: 34 | Train Loss: 1.130 Vali Loss: 3.179 Vali Acc: 0.711 Test Loss: 3.179 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.720168113708496
Epoch: 9, Steps: 34 | Train Loss: 1.576 Vali Loss: 5.312 Vali Acc: 0.653 Test Loss: 5.312 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.422617673873901
Epoch: 10, Steps: 34 | Train Loss: 1.556 Vali Loss: 2.338 Vali Acc: 0.671 Test Loss: 2.338 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.312362432479858
Epoch: 11, Steps: 34 | Train Loss: 0.855 Vali Loss: 3.792 Vali Acc: 0.578 Test Loss: 3.792 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.892670631408691
Epoch: 12, Steps: 34 | Train Loss: 0.879 Vali Loss: 6.709 Vali Acc: 0.514 Test Loss: 6.709 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.535622119903564
Epoch: 13, Steps: 34 | Train Loss: 1.635 Vali Loss: 5.810 Vali Acc: 0.543 Test Loss: 5.810 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.83131194114685
Epoch: 14, Steps: 34 | Train Loss: 0.443 Vali Loss: 2.726 Vali Acc: 0.775 Test Loss: 2.726 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.162898063659668
Epoch: 15, Steps: 34 | Train Loss: 0.138 Vali Loss: 2.150 Vali Acc: 0.809 Test Loss: 2.150 Test Acc: 0.809
Validation loss decreased (-0.791891 --> -0.809227).  Saving model ...
Epoch: 16 cost time: 10.048660039901733
Epoch: 16, Steps: 34 | Train Loss: 0.219 Vali Loss: 2.310 Vali Acc: 0.803 Test Loss: 2.310 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.634842157363892
Epoch: 17, Steps: 34 | Train Loss: 0.274 Vali Loss: 3.553 Vali Acc: 0.694 Test Loss: 3.553 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.50885820388794
Epoch: 18, Steps: 34 | Train Loss: 0.166 Vali Loss: 2.790 Vali Acc: 0.775 Test Loss: 2.790 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.707884550094604
Epoch: 19, Steps: 34 | Train Loss: 1.713 Vali Loss: 5.177 Vali Acc: 0.711 Test Loss: 5.177 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.815734148025513
Epoch: 20, Steps: 34 | Train Loss: 0.720 Vali Loss: 10.880 Vali Acc: 0.595 Test Loss: 10.880 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.861397504806519
Epoch: 21, Steps: 34 | Train Loss: 0.825 Vali Loss: 3.742 Vali Acc: 0.803 Test Loss: 3.742 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.864892482757568
Epoch: 22, Steps: 34 | Train Loss: 0.282 Vali Loss: 3.126 Vali Acc: 0.838 Test Loss: 3.126 Test Acc: 0.838
Validation loss decreased (-0.809227 --> -0.838119).  Saving model ...
Epoch: 23 cost time: 6.056983232498169
Epoch: 23, Steps: 34 | Train Loss: 0.015 Vali Loss: 3.336 Vali Acc: 0.763 Test Loss: 3.336 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.179219722747803
Epoch: 24, Steps: 34 | Train Loss: 0.024 Vali Loss: 3.100 Vali Acc: 0.815 Test Loss: 3.100 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.843773603439331
Epoch: 25, Steps: 34 | Train Loss: 0.046 Vali Loss: 2.501 Vali Acc: 0.838 Test Loss: 2.501 Test Acc: 0.838
Validation loss decreased (-0.838119 --> -0.838125).  Saving model ...
Epoch: 26 cost time: 10.303319215774536
Epoch: 26, Steps: 34 | Train Loss: 0.016 Vali Loss: 3.733 Vali Acc: 0.832 Test Loss: 3.733 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 9.635395526885986
Epoch: 27, Steps: 34 | Train Loss: 0.002 Vali Loss: 2.582 Vali Acc: 0.827 Test Loss: 2.582 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 9.02243709564209
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.827 Test Loss: 2.448 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 9.88536024093628
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.616481304168701
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 9.90417218208313
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 9.816218137741089
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 9.958863735198975
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 9.062262773513794
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 9.608295440673828
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.827 Test Loss: 2.447 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1201111
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.999460458755493
Epoch: 1, Steps: 34 | Train Loss: 2.187 Vali Loss: 1.976 Vali Acc: 0.422 Test Loss: 1.976 Test Acc: 0.422
Validation loss decreased (inf --> -0.421946).  Saving model ...
Epoch: 2 cost time: 10.73241376876831
Epoch: 2, Steps: 34 | Train Loss: 2.372 Vali Loss: 4.231 Vali Acc: 0.306 Test Loss: 4.231 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.34334135055542
Epoch: 3, Steps: 34 | Train Loss: 1.969 Vali Loss: 2.138 Vali Acc: 0.561 Test Loss: 2.138 Test Acc: 0.561
Validation loss decreased (-0.421946 --> -0.560672).  Saving model ...
Epoch: 4 cost time: 9.2347252368927
Epoch: 4, Steps: 34 | Train Loss: 2.766 Vali Loss: 6.078 Vali Acc: 0.353 Test Loss: 6.078 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.959684610366821
Epoch: 5, Steps: 34 | Train Loss: 3.527 Vali Loss: 5.169 Vali Acc: 0.566 Test Loss: 5.169 Test Acc: 0.566
Validation loss decreased (-0.560672 --> -0.566422).  Saving model ...
Epoch: 6 cost time: 10.96762752532959
Epoch: 6, Steps: 34 | Train Loss: 3.648 Vali Loss: 5.694 Vali Acc: 0.572 Test Loss: 5.694 Test Acc: 0.572
Validation loss decreased (-0.566422 --> -0.572197).  Saving model ...
Epoch: 7 cost time: 9.374891519546509
Epoch: 7, Steps: 34 | Train Loss: 3.146 Vali Loss: 8.709 Vali Acc: 0.439 Test Loss: 8.709 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.204275846481323
Epoch: 8, Steps: 34 | Train Loss: 3.003 Vali Loss: 3.972 Vali Acc: 0.618 Test Loss: 3.972 Test Acc: 0.618
Validation loss decreased (-0.572197 --> -0.618457).  Saving model ...
Epoch: 9 cost time: 11.06904149055481
Epoch: 9, Steps: 34 | Train Loss: 3.018 Vali Loss: 5.619 Vali Acc: 0.647 Test Loss: 5.619 Test Acc: 0.647
Validation loss decreased (-0.618457 --> -0.647343).  Saving model ...
Epoch: 10 cost time: 11.642500877380371
Epoch: 10, Steps: 34 | Train Loss: 4.181 Vali Loss: 6.747 Vali Acc: 0.595 Test Loss: 6.747 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.410423517227173
Epoch: 11, Steps: 34 | Train Loss: 2.502 Vali Loss: 4.085 Vali Acc: 0.572 Test Loss: 4.085 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.699951648712158
Epoch: 12, Steps: 34 | Train Loss: 0.918 Vali Loss: 4.960 Vali Acc: 0.665 Test Loss: 4.960 Test Acc: 0.665
Validation loss decreased (-0.647343 --> -0.664690).  Saving model ...
Epoch: 13 cost time: 9.091636180877686
Epoch: 13, Steps: 34 | Train Loss: 1.474 Vali Loss: 3.721 Vali Acc: 0.607 Test Loss: 3.721 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.338494777679443
Epoch: 14, Steps: 34 | Train Loss: 0.563 Vali Loss: 7.519 Vali Acc: 0.561 Test Loss: 7.519 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.033450603485107
Epoch: 15, Steps: 34 | Train Loss: 0.361 Vali Loss: 5.974 Vali Acc: 0.642 Test Loss: 5.974 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.392298698425293
Epoch: 16, Steps: 34 | Train Loss: 0.696 Vali Loss: 4.278 Vali Acc: 0.763 Test Loss: 4.278 Test Acc: 0.763
Validation loss decreased (-0.664690 --> -0.762963).  Saving model ...
Epoch: 17 cost time: 9.263923645019531
Epoch: 17, Steps: 34 | Train Loss: 1.033 Vali Loss: 5.571 Vali Acc: 0.809 Test Loss: 5.571 Test Acc: 0.809
Validation loss decreased (-0.762963 --> -0.809193).  Saving model ...
Epoch: 18 cost time: 8.368229866027832
Epoch: 18, Steps: 34 | Train Loss: 0.613 Vali Loss: 5.919 Vali Acc: 0.543 Test Loss: 5.919 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.503791570663452
Epoch: 19, Steps: 34 | Train Loss: 0.412 Vali Loss: 5.876 Vali Acc: 0.659 Test Loss: 5.876 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.841059684753418
Epoch: 20, Steps: 34 | Train Loss: 0.112 Vali Loss: 2.798 Vali Acc: 0.769 Test Loss: 2.798 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.757258415222168
Epoch: 21, Steps: 34 | Train Loss: 0.302 Vali Loss: 3.610 Vali Acc: 0.769 Test Loss: 3.610 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.26517915725708
Epoch: 22, Steps: 34 | Train Loss: 0.311 Vali Loss: 3.540 Vali Acc: 0.763 Test Loss: 3.540 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.574275255203247
Epoch: 23, Steps: 34 | Train Loss: 0.355 Vali Loss: 2.131 Vali Acc: 0.815 Test Loss: 2.131 Test Acc: 0.815
Validation loss decreased (-0.809193 --> -0.815008).  Saving model ...
Epoch: 24 cost time: 9.436622142791748
Epoch: 24, Steps: 34 | Train Loss: 0.084 Vali Loss: 1.545 Vali Acc: 0.827 Test Loss: 1.545 Test Acc: 0.827
Validation loss decreased (-0.815008 --> -0.826574).  Saving model ...
Epoch: 25 cost time: 9.452851295471191
Epoch: 25, Steps: 34 | Train Loss: 0.045 Vali Loss: 6.475 Vali Acc: 0.751 Test Loss: 6.475 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.593489646911621
Epoch: 26, Steps: 34 | Train Loss: 0.188 Vali Loss: 6.496 Vali Acc: 0.757 Test Loss: 6.496 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.215665817260742
Epoch: 27, Steps: 34 | Train Loss: 0.610 Vali Loss: 9.154 Vali Acc: 0.734 Test Loss: 9.154 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.275409460067749
Epoch: 28, Steps: 34 | Train Loss: 0.786 Vali Loss: 6.747 Vali Acc: 0.723 Test Loss: 6.747 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.819106578826904
Epoch: 29, Steps: 34 | Train Loss: 0.525 Vali Loss: 13.673 Vali Acc: 0.572 Test Loss: 13.673 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 8.799636840820312
Epoch: 30, Steps: 34 | Train Loss: 0.906 Vali Loss: 4.156 Vali Acc: 0.827 Test Loss: 4.156 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 9.371212244033813
Epoch: 31, Steps: 34 | Train Loss: 0.117 Vali Loss: 4.124 Vali Acc: 0.786 Test Loss: 4.124 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 9.540499210357666
Epoch: 32, Steps: 34 | Train Loss: 0.121 Vali Loss: 3.590 Vali Acc: 0.809 Test Loss: 3.590 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 10.232210159301758
Epoch: 33, Steps: 34 | Train Loss: 0.022 Vali Loss: 3.626 Vali Acc: 0.809 Test Loss: 3.626 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 10.115837335586548
Epoch: 34, Steps: 34 | Train Loss: 0.066 Vali Loss: 3.188 Vali Acc: 0.827 Test Loss: 3.188 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1200439
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.639518022537231
Epoch: 1, Steps: 34 | Train Loss: 2.423 Vali Loss: 2.368 Vali Acc: 0.324 Test Loss: 2.368 Test Acc: 0.324
Validation loss decreased (inf --> -0.323676).  Saving model ...
Epoch: 2 cost time: 10.220491886138916
Epoch: 2, Steps: 34 | Train Loss: 2.038 Vali Loss: 2.963 Vali Acc: 0.503 Test Loss: 2.963 Test Acc: 0.503
Validation loss decreased (-0.323676 --> -0.502861).  Saving model ...
Epoch: 3 cost time: 8.869680404663086
Epoch: 3, Steps: 34 | Train Loss: 2.845 Vali Loss: 3.680 Vali Acc: 0.578 Test Loss: 3.680 Test Acc: 0.578
Validation loss decreased (-0.502861 --> -0.577998).  Saving model ...
Epoch: 4 cost time: 10.794195890426636
Epoch: 4, Steps: 34 | Train Loss: 3.309 Vali Loss: 6.546 Vali Acc: 0.520 Test Loss: 6.546 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.276296138763428
Epoch: 5, Steps: 34 | Train Loss: 5.914 Vali Loss: 7.964 Vali Acc: 0.497 Test Loss: 7.964 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.421113967895508
Epoch: 6, Steps: 34 | Train Loss: 2.980 Vali Loss: 3.589 Vali Acc: 0.572 Test Loss: 3.589 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.482972860336304
Epoch: 7, Steps: 34 | Train Loss: 1.631 Vali Loss: 4.980 Vali Acc: 0.532 Test Loss: 4.980 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.738779306411743
Epoch: 8, Steps: 34 | Train Loss: 1.775 Vali Loss: 3.869 Vali Acc: 0.682 Test Loss: 3.869 Test Acc: 0.682
Validation loss decreased (-0.577998 --> -0.682042).  Saving model ...
Epoch: 9 cost time: 9.527040243148804
Epoch: 9, Steps: 34 | Train Loss: 2.530 Vali Loss: 6.722 Vali Acc: 0.624 Test Loss: 6.722 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.044544696807861
Epoch: 10, Steps: 34 | Train Loss: 1.379 Vali Loss: 1.896 Vali Acc: 0.705 Test Loss: 1.896 Test Acc: 0.705
Validation loss decreased (-0.682042 --> -0.705183).  Saving model ...
Epoch: 11 cost time: 9.431947231292725
Epoch: 11, Steps: 34 | Train Loss: 0.539 Vali Loss: 5.976 Vali Acc: 0.613 Test Loss: 5.976 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.649091243743896
Epoch: 12, Steps: 34 | Train Loss: 2.985 Vali Loss: 1.484 Vali Acc: 0.780 Test Loss: 1.484 Test Acc: 0.780
Validation loss decreased (-0.705183 --> -0.780332).  Saving model ...
Epoch: 13 cost time: 9.063325643539429
Epoch: 13, Steps: 34 | Train Loss: 0.706 Vali Loss: 4.690 Vali Acc: 0.699 Test Loss: 4.690 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.017907619476318
Epoch: 14, Steps: 34 | Train Loss: 0.734 Vali Loss: 4.482 Vali Acc: 0.699 Test Loss: 4.482 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.37022852897644
Epoch: 15, Steps: 34 | Train Loss: 0.914 Vali Loss: 4.332 Vali Acc: 0.775 Test Loss: 4.332 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.568658113479614
Epoch: 16, Steps: 34 | Train Loss: 0.751 Vali Loss: 2.615 Vali Acc: 0.746 Test Loss: 2.615 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.635052680969238
Epoch: 17, Steps: 34 | Train Loss: 0.357 Vali Loss: 5.042 Vali Acc: 0.699 Test Loss: 5.042 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.734673976898193
Epoch: 18, Steps: 34 | Train Loss: 0.512 Vali Loss: 1.853 Vali Acc: 0.838 Test Loss: 1.853 Test Acc: 0.838
Validation loss decreased (-0.780332 --> -0.838132).  Saving model ...
Epoch: 19 cost time: 10.499197244644165
Epoch: 19, Steps: 34 | Train Loss: 0.144 Vali Loss: 4.918 Vali Acc: 0.711 Test Loss: 4.918 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.340109586715698
Epoch: 20, Steps: 34 | Train Loss: 0.544 Vali Loss: 2.441 Vali Acc: 0.792 Test Loss: 2.441 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.060562133789062
Epoch: 21, Steps: 34 | Train Loss: 0.416 Vali Loss: 3.365 Vali Acc: 0.757 Test Loss: 3.365 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.37994122505188
Epoch: 22, Steps: 34 | Train Loss: 0.175 Vali Loss: 5.470 Vali Acc: 0.740 Test Loss: 5.470 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.124614238739014
Epoch: 23, Steps: 34 | Train Loss: 0.168 Vali Loss: 2.390 Vali Acc: 0.861 Test Loss: 2.390 Test Acc: 0.861
Validation loss decreased (-0.838132 --> -0.861248).  Saving model ...
Epoch: 24 cost time: 10.804566383361816
Epoch: 24, Steps: 34 | Train Loss: 0.033 Vali Loss: 3.124 Vali Acc: 0.780 Test Loss: 3.124 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.616013288497925
Epoch: 25, Steps: 34 | Train Loss: 0.074 Vali Loss: 2.107 Vali Acc: 0.821 Test Loss: 2.107 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.587636232376099
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.838 Test Loss: 2.049 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 10.531666994094849
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.844 Test Loss: 2.038 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 9.686691522598267
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.855 Test Loss: 1.997 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.8674635887146
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.855 Test Loss: 1.995 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.586008787155151
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.855 Test Loss: 1.993 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 9.49397325515747
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.855 Test Loss: 1.991 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 9.67647647857666
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.855 Test Loss: 1.990 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 9.527493238449097
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.855 Test Loss: 1.989 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1199767
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.638927698135376
Epoch: 1, Steps: 34 | Train Loss: 2.263 Vali Loss: 3.007 Vali Acc: 0.185 Test Loss: 3.007 Test Acc: 0.185
Validation loss decreased (inf --> -0.184941).  Saving model ...
Epoch: 2 cost time: 8.250953197479248
Epoch: 2, Steps: 34 | Train Loss: 2.540 Vali Loss: 3.624 Vali Acc: 0.283 Test Loss: 3.624 Test Acc: 0.283
Validation loss decreased (-0.184941 --> -0.283201).  Saving model ...
Epoch: 3 cost time: 9.260190725326538
Epoch: 3, Steps: 34 | Train Loss: 3.071 Vali Loss: 2.125 Vali Acc: 0.503 Test Loss: 2.125 Test Acc: 0.503
Validation loss decreased (-0.283201 --> -0.502869).  Saving model ...
Epoch: 4 cost time: 9.03339672088623
Epoch: 4, Steps: 34 | Train Loss: 2.450 Vali Loss: 2.781 Vali Acc: 0.497 Test Loss: 2.781 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.77638292312622
Epoch: 5, Steps: 34 | Train Loss: 1.971 Vali Loss: 3.285 Vali Acc: 0.445 Test Loss: 3.285 Test Acc: 0.445
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.441487789154053
Epoch: 6, Steps: 34 | Train Loss: 2.002 Vali Loss: 3.168 Vali Acc: 0.676 Test Loss: 3.168 Test Acc: 0.676
Validation loss decreased (-0.502869 --> -0.676269).  Saving model ...
Epoch: 7 cost time: 8.642772197723389
Epoch: 7, Steps: 34 | Train Loss: 1.888 Vali Loss: 3.474 Vali Acc: 0.671 Test Loss: 3.474 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.06659746170044
Epoch: 8, Steps: 34 | Train Loss: 1.808 Vali Loss: 2.211 Vali Acc: 0.705 Test Loss: 2.211 Test Acc: 0.705
Validation loss decreased (-0.676269 --> -0.705180).  Saving model ...
Epoch: 9 cost time: 9.318159341812134
Epoch: 9, Steps: 34 | Train Loss: 1.045 Vali Loss: 3.347 Vali Acc: 0.688 Test Loss: 3.347 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.550459861755371
Epoch: 10, Steps: 34 | Train Loss: 1.873 Vali Loss: 2.353 Vali Acc: 0.653 Test Loss: 2.353 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.796202421188354
Epoch: 11, Steps: 34 | Train Loss: 1.829 Vali Loss: 4.421 Vali Acc: 0.740 Test Loss: 4.421 Test Acc: 0.740
Validation loss decreased (-0.705180 --> -0.739840).  Saving model ...
Epoch: 12 cost time: 9.035955905914307
Epoch: 12, Steps: 34 | Train Loss: 1.276 Vali Loss: 1.818 Vali Acc: 0.769 Test Loss: 1.818 Test Acc: 0.769
Validation loss decreased (-0.739840 --> -0.768768).  Saving model ...
Epoch: 13 cost time: 8.18162488937378
Epoch: 13, Steps: 34 | Train Loss: 1.494 Vali Loss: 2.167 Vali Acc: 0.809 Test Loss: 2.167 Test Acc: 0.809
Validation loss decreased (-0.768768 --> -0.809227).  Saving model ...
Epoch: 14 cost time: 9.638445854187012
Epoch: 14, Steps: 34 | Train Loss: 1.912 Vali Loss: 6.513 Vali Acc: 0.538 Test Loss: 6.513 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.213289737701416
Epoch: 15, Steps: 34 | Train Loss: 1.103 Vali Loss: 2.530 Vali Acc: 0.815 Test Loss: 2.530 Test Acc: 0.815
Validation loss decreased (-0.809227 --> -0.815004).  Saving model ...
Epoch: 16 cost time: 10.534708499908447
Epoch: 16, Steps: 34 | Train Loss: 0.417 Vali Loss: 2.996 Vali Acc: 0.792 Test Loss: 2.996 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.801175594329834
Epoch: 17, Steps: 34 | Train Loss: 0.454 Vali Loss: 2.411 Vali Acc: 0.751 Test Loss: 2.411 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.712555408477783
Epoch: 18, Steps: 34 | Train Loss: 0.394 Vali Loss: 1.428 Vali Acc: 0.867 Test Loss: 1.428 Test Acc: 0.867
Validation loss decreased (-0.815004 --> -0.867038).  Saving model ...
Epoch: 19 cost time: 10.082403182983398
Epoch: 19, Steps: 34 | Train Loss: 0.077 Vali Loss: 2.015 Vali Acc: 0.838 Test Loss: 2.015 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.07602047920227
Epoch: 20, Steps: 34 | Train Loss: 0.155 Vali Loss: 7.948 Vali Acc: 0.711 Test Loss: 7.948 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.054802179336548
Epoch: 21, Steps: 34 | Train Loss: 1.001 Vali Loss: 2.491 Vali Acc: 0.809 Test Loss: 2.491 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.015147924423218
Epoch: 22, Steps: 34 | Train Loss: 0.676 Vali Loss: 4.242 Vali Acc: 0.809 Test Loss: 4.242 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.452353239059448
Epoch: 23, Steps: 34 | Train Loss: 0.430 Vali Loss: 5.404 Vali Acc: 0.746 Test Loss: 5.404 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.286509037017822
Epoch: 24, Steps: 34 | Train Loss: 0.166 Vali Loss: 5.067 Vali Acc: 0.740 Test Loss: 5.067 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.421133518218994
Epoch: 25, Steps: 34 | Train Loss: 0.552 Vali Loss: 3.474 Vali Acc: 0.815 Test Loss: 3.474 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.270686864852905
Epoch: 26, Steps: 34 | Train Loss: 0.632 Vali Loss: 6.601 Vali Acc: 0.671 Test Loss: 6.601 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.001295566558838
Epoch: 27, Steps: 34 | Train Loss: 0.442 Vali Loss: 5.381 Vali Acc: 0.763 Test Loss: 5.381 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 8.758567094802856
Epoch: 28, Steps: 34 | Train Loss: 0.059 Vali Loss: 4.588 Vali Acc: 0.740 Test Loss: 4.588 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1199095
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 25.286168813705444
Epoch: 1, Steps: 34 | Train Loss: 16.848 Vali Loss: 28.370 Vali Acc: 0.243 Test Loss: 28.370 Test Acc: 0.243
Validation loss decreased (inf --> -0.242491).  Saving model ...
Epoch: 2 cost time: 22.26257872581482
Epoch: 2, Steps: 34 | Train Loss: 35.146 Vali Loss: 23.676 Vali Acc: 0.509 Test Loss: 23.676 Test Acc: 0.509
Validation loss decreased (-0.242491 --> -0.508434).  Saving model ...
Epoch: 3 cost time: 21.120336532592773
Epoch: 3, Steps: 34 | Train Loss: 54.591 Vali Loss: 52.047 Vali Acc: 0.468 Test Loss: 52.047 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.895103693008423
Epoch: 4, Steps: 34 | Train Loss: 38.983 Vali Loss: 43.419 Vali Acc: 0.618 Test Loss: 43.419 Test Acc: 0.618
Validation loss decreased (-0.508434 --> -0.618063).  Saving model ...
Epoch: 5 cost time: 21.15085005760193
Epoch: 5, Steps: 34 | Train Loss: 22.487 Vali Loss: 33.911 Vali Acc: 0.578 Test Loss: 33.911 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.13807463645935
Epoch: 6, Steps: 34 | Train Loss: 19.152 Vali Loss: 11.204 Vali Acc: 0.717 Test Loss: 11.204 Test Acc: 0.717
Validation loss decreased (-0.618063 --> -0.716651).  Saving model ...
Epoch: 7 cost time: 22.485352993011475
Epoch: 7, Steps: 34 | Train Loss: 12.546 Vali Loss: 28.653 Vali Acc: 0.601 Test Loss: 28.653 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.48686718940735
Epoch: 8, Steps: 34 | Train Loss: 12.737 Vali Loss: 26.910 Vali Acc: 0.711 Test Loss: 26.910 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.44560480117798
Epoch: 9, Steps: 34 | Train Loss: 7.130 Vali Loss: 38.664 Vali Acc: 0.532 Test Loss: 38.664 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.992899656295776
Epoch: 10, Steps: 34 | Train Loss: 6.573 Vali Loss: 36.636 Vali Acc: 0.647 Test Loss: 36.636 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.27514934539795
Epoch: 11, Steps: 34 | Train Loss: 6.744 Vali Loss: 16.449 Vali Acc: 0.757 Test Loss: 16.449 Test Acc: 0.757
Validation loss decreased (-0.716651 --> -0.757061).  Saving model ...
Epoch: 12 cost time: 21.7912175655365
Epoch: 12, Steps: 34 | Train Loss: 6.019 Vali Loss: 29.062 Vali Acc: 0.717 Test Loss: 29.062 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.134174346923828
Epoch: 13, Steps: 34 | Train Loss: 3.195 Vali Loss: 23.325 Vali Acc: 0.642 Test Loss: 23.325 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.294296979904175
Epoch: 14, Steps: 34 | Train Loss: 3.113 Vali Loss: 42.376 Vali Acc: 0.786 Test Loss: 42.376 Test Acc: 0.786
Validation loss decreased (-0.757061 --> -0.785703).  Saving model ...
Epoch: 15 cost time: 21.7121479511261
Epoch: 15, Steps: 34 | Train Loss: 2.136 Vali Loss: 32.368 Vali Acc: 0.769 Test Loss: 32.368 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 23.252294778823853
Epoch: 16, Steps: 34 | Train Loss: 3.531 Vali Loss: 30.493 Vali Acc: 0.757 Test Loss: 30.493 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.872751235961914
Epoch: 17, Steps: 34 | Train Loss: 6.907 Vali Loss: 25.084 Vali Acc: 0.763 Test Loss: 25.084 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.298489570617676
Epoch: 18, Steps: 34 | Train Loss: 2.661 Vali Loss: 36.486 Vali Acc: 0.659 Test Loss: 36.486 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 23.75797724723816
Epoch: 19, Steps: 34 | Train Loss: 1.703 Vali Loss: 31.043 Vali Acc: 0.763 Test Loss: 31.043 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 24.731510162353516
Epoch: 20, Steps: 34 | Train Loss: 3.602 Vali Loss: 17.536 Vali Acc: 0.757 Test Loss: 17.536 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 23.71846604347229
Epoch: 21, Steps: 34 | Train Loss: 3.118 Vali Loss: 29.967 Vali Acc: 0.717 Test Loss: 29.967 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 26.567437648773193
Epoch: 22, Steps: 34 | Train Loss: 5.640 Vali Loss: 56.738 Vali Acc: 0.757 Test Loss: 56.738 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 22.09111523628235
Epoch: 23, Steps: 34 | Train Loss: 4.306 Vali Loss: 16.260 Vali Acc: 0.763 Test Loss: 16.260 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.62621569633484
Epoch: 24, Steps: 34 | Train Loss: 2.467 Vali Loss: 29.171 Vali Acc: 0.751 Test Loss: 29.171 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 21250347
model size : 86.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.061612129211426
Epoch: 1, Steps: 34 | Train Loss: 18.119 Vali Loss: 26.162 Vali Acc: 0.324 Test Loss: 26.162 Test Acc: 0.324
Validation loss decreased (inf --> -0.323438).  Saving model ...
Epoch: 2 cost time: 18.772774696350098
Epoch: 2, Steps: 34 | Train Loss: 44.885 Vali Loss: 40.333 Vali Acc: 0.468 Test Loss: 40.333 Test Acc: 0.468
Validation loss decreased (-0.323438 --> -0.467805).  Saving model ...
Epoch: 3 cost time: 22.617401599884033
Epoch: 3, Steps: 34 | Train Loss: 46.088 Vali Loss: 48.209 Vali Acc: 0.451 Test Loss: 48.209 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.711785554885864
Epoch: 4, Steps: 34 | Train Loss: 21.390 Vali Loss: 20.087 Vali Acc: 0.590 Test Loss: 20.087 Test Acc: 0.590
Validation loss decreased (-0.467805 --> -0.589395).  Saving model ...
Epoch: 5 cost time: 21.604738473892212
Epoch: 5, Steps: 34 | Train Loss: 12.866 Vali Loss: 23.644 Vali Acc: 0.572 Test Loss: 23.644 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.782646894454956
Epoch: 6, Steps: 34 | Train Loss: 12.027 Vali Loss: 19.302 Vali Acc: 0.636 Test Loss: 19.302 Test Acc: 0.636
Validation loss decreased (-0.589395 --> -0.635645).  Saving model ...
Epoch: 7 cost time: 21.779821634292603
Epoch: 7, Steps: 34 | Train Loss: 8.359 Vali Loss: 16.445 Vali Acc: 0.653 Test Loss: 16.445 Test Acc: 0.653
Validation loss decreased (-0.635645 --> -0.653015).  Saving model ...
Epoch: 8 cost time: 24.379607439041138
Epoch: 8, Steps: 34 | Train Loss: 3.680 Vali Loss: 33.873 Vali Acc: 0.590 Test Loss: 33.873 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.169392585754395
Epoch: 9, Steps: 34 | Train Loss: 10.303 Vali Loss: 17.965 Vali Acc: 0.538 Test Loss: 17.965 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.283820152282715
Epoch: 10, Steps: 34 | Train Loss: 3.995 Vali Loss: 11.928 Vali Acc: 0.740 Test Loss: 11.928 Test Acc: 0.740
Validation loss decreased (-0.653015 --> -0.739765).  Saving model ...
Epoch: 11 cost time: 21.8292818069458
Epoch: 11, Steps: 34 | Train Loss: 5.298 Vali Loss: 33.374 Vali Acc: 0.636 Test Loss: 33.374 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.742895126342773
Epoch: 12, Steps: 34 | Train Loss: 6.133 Vali Loss: 12.720 Vali Acc: 0.786 Test Loss: 12.720 Test Acc: 0.786
Validation loss decreased (-0.739765 --> -0.786000).  Saving model ...
Epoch: 13 cost time: 21.007007122039795
Epoch: 13, Steps: 34 | Train Loss: 4.548 Vali Loss: 16.822 Vali Acc: 0.723 Test Loss: 16.822 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.979511976242065
Epoch: 14, Steps: 34 | Train Loss: 4.483 Vali Loss: 29.360 Vali Acc: 0.659 Test Loss: 29.360 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.591777086257935
Epoch: 15, Steps: 34 | Train Loss: 2.593 Vali Loss: 16.391 Vali Acc: 0.792 Test Loss: 16.391 Test Acc: 0.792
Validation loss decreased (-0.786000 --> -0.791744).  Saving model ...
Epoch: 16 cost time: 20.901010274887085
Epoch: 16, Steps: 34 | Train Loss: 1.823 Vali Loss: 26.762 Vali Acc: 0.740 Test Loss: 26.762 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.646212339401245
Epoch: 17, Steps: 34 | Train Loss: 2.461 Vali Loss: 13.014 Vali Acc: 0.838 Test Loss: 13.014 Test Acc: 0.838
Validation loss decreased (-0.791744 --> -0.838020).  Saving model ...
Epoch: 18 cost time: 22.02769947052002
Epoch: 18, Steps: 34 | Train Loss: 1.668 Vali Loss: 31.184 Vali Acc: 0.630 Test Loss: 31.184 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.920201539993286
Epoch: 19, Steps: 34 | Train Loss: 3.643 Vali Loss: 30.916 Vali Acc: 0.751 Test Loss: 30.916 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.544727325439453
Epoch: 20, Steps: 34 | Train Loss: 2.875 Vali Loss: 29.191 Vali Acc: 0.751 Test Loss: 29.191 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.406134843826294
Epoch: 21, Steps: 34 | Train Loss: 5.794 Vali Loss: 22.358 Vali Acc: 0.694 Test Loss: 22.358 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.60249376296997
Epoch: 22, Steps: 34 | Train Loss: 4.187 Vali Loss: 22.276 Vali Acc: 0.798 Test Loss: 22.276 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 23.51095724105835
Epoch: 23, Steps: 34 | Train Loss: 2.184 Vali Loss: 32.107 Vali Acc: 0.798 Test Loss: 32.107 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 23.2940571308136
Epoch: 24, Steps: 34 | Train Loss: 5.672 Vali Loss: 40.446 Vali Acc: 0.699 Test Loss: 40.446 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 21.47499680519104
Epoch: 25, Steps: 34 | Train Loss: 6.095 Vali Loss: 12.136 Vali Acc: 0.775 Test Loss: 12.136 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 21.32295560836792
Epoch: 26, Steps: 34 | Train Loss: 3.143 Vali Loss: 24.564 Vali Acc: 0.751 Test Loss: 24.564 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 21.4127676486969
Epoch: 27, Steps: 34 | Train Loss: 7.103 Vali Loss: 79.626 Vali Acc: 0.584 Test Loss: 79.626 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 21245739
model size : 86.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.463115453720093
Epoch: 1, Steps: 34 | Train Loss: 22.028 Vali Loss: 19.042 Vali Acc: 0.462 Test Loss: 19.042 Test Acc: 0.462
Validation loss decreased (inf --> -0.462237).  Saving model ...
Epoch: 2 cost time: 22.173651933670044
Epoch: 2, Steps: 34 | Train Loss: 37.115 Vali Loss: 50.302 Vali Acc: 0.410 Test Loss: 50.302 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.41514229774475
Epoch: 3, Steps: 34 | Train Loss: 38.752 Vali Loss: 28.751 Vali Acc: 0.457 Test Loss: 28.751 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.827800989151
Epoch: 4, Steps: 34 | Train Loss: 28.089 Vali Loss: 35.605 Vali Acc: 0.543 Test Loss: 35.605 Test Acc: 0.543
Validation loss decreased (-0.462237 --> -0.542997).  Saving model ...
Epoch: 5 cost time: 21.513301134109497
Epoch: 5, Steps: 34 | Train Loss: 18.705 Vali Loss: 20.579 Vali Acc: 0.624 Test Loss: 20.579 Test Acc: 0.624
Validation loss decreased (-0.542997 --> -0.624072).  Saving model ...
Epoch: 6 cost time: 20.63549780845642
Epoch: 6, Steps: 34 | Train Loss: 10.100 Vali Loss: 24.203 Vali Acc: 0.659 Test Loss: 24.203 Test Acc: 0.659
Validation loss decreased (-0.624072 --> -0.658718).  Saving model ...
Epoch: 7 cost time: 24.569936513900757
Epoch: 7, Steps: 34 | Train Loss: 9.885 Vali Loss: 16.339 Vali Acc: 0.607 Test Loss: 16.339 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.768115282058716
Epoch: 8, Steps: 34 | Train Loss: 7.492 Vali Loss: 25.492 Vali Acc: 0.671 Test Loss: 25.492 Test Acc: 0.671
Validation loss decreased (-0.658718 --> -0.670265).  Saving model ...
Epoch: 9 cost time: 24.061344861984253
Epoch: 9, Steps: 34 | Train Loss: 7.477 Vali Loss: 13.086 Vali Acc: 0.757 Test Loss: 13.086 Test Acc: 0.757
Validation loss decreased (-0.670265 --> -0.757095).  Saving model ...
Epoch: 10 cost time: 22.34685206413269
Epoch: 10, Steps: 34 | Train Loss: 4.671 Vali Loss: 30.267 Vali Acc: 0.538 Test Loss: 30.267 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.378747940063477
Epoch: 11, Steps: 34 | Train Loss: 6.279 Vali Loss: 26.320 Vali Acc: 0.682 Test Loss: 26.320 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.468852758407593
Epoch: 12, Steps: 34 | Train Loss: 3.522 Vali Loss: 30.216 Vali Acc: 0.676 Test Loss: 30.216 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.82241415977478
Epoch: 13, Steps: 34 | Train Loss: 5.147 Vali Loss: 36.978 Vali Acc: 0.618 Test Loss: 36.978 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.994527101516724
Epoch: 14, Steps: 34 | Train Loss: 5.856 Vali Loss: 46.482 Vali Acc: 0.636 Test Loss: 46.482 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 20.3011257648468
Epoch: 15, Steps: 34 | Train Loss: 10.823 Vali Loss: 53.150 Vali Acc: 0.538 Test Loss: 53.150 Test Acc: 0.538
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.115133047103882
Epoch: 16, Steps: 34 | Train Loss: 9.816 Vali Loss: 18.773 Vali Acc: 0.740 Test Loss: 18.773 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 20.89157462120056
Epoch: 17, Steps: 34 | Train Loss: 3.841 Vali Loss: 31.796 Vali Acc: 0.671 Test Loss: 31.796 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 20.614753484725952
Epoch: 18, Steps: 34 | Train Loss: 2.231 Vali Loss: 18.291 Vali Acc: 0.751 Test Loss: 18.291 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 21.65254807472229
Epoch: 19, Steps: 34 | Train Loss: 0.416 Vali Loss: 25.797 Vali Acc: 0.746 Test Loss: 25.797 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 21241131
model size : 86.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 24.661380767822266
Epoch: 1, Steps: 34 | Train Loss: 25.166 Vali Loss: 26.487 Vali Acc: 0.306 Test Loss: 26.487 Test Acc: 0.306
Validation loss decreased (inf --> -0.306094).  Saving model ...
Epoch: 2 cost time: 24.799344062805176
Epoch: 2, Steps: 34 | Train Loss: 35.751 Vali Loss: 31.854 Vali Acc: 0.497 Test Loss: 31.854 Test Acc: 0.497
Validation loss decreased (-0.306094 --> -0.496791).  Saving model ...
Epoch: 3 cost time: 22.41836643218994
Epoch: 3, Steps: 34 | Train Loss: 34.719 Vali Loss: 32.683 Vali Acc: 0.503 Test Loss: 32.683 Test Acc: 0.503
Validation loss decreased (-0.496791 --> -0.502563).  Saving model ...
Epoch: 4 cost time: 20.96653413772583
Epoch: 4, Steps: 34 | Train Loss: 25.468 Vali Loss: 30.614 Vali Acc: 0.509 Test Loss: 30.614 Test Acc: 0.509
Validation loss decreased (-0.502563 --> -0.508364).  Saving model ...
Epoch: 5 cost time: 22.96957540512085
Epoch: 5, Steps: 34 | Train Loss: 23.628 Vali Loss: 19.465 Vali Acc: 0.705 Test Loss: 19.465 Test Acc: 0.705
Validation loss decreased (-0.508364 --> -0.705008).  Saving model ...
Epoch: 6 cost time: 21.259907960891724
Epoch: 6, Steps: 34 | Train Loss: 12.530 Vali Loss: 25.792 Vali Acc: 0.538 Test Loss: 25.792 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.710031032562256
Epoch: 7, Steps: 34 | Train Loss: 13.570 Vali Loss: 32.947 Vali Acc: 0.630 Test Loss: 32.947 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.536498546600342
Epoch: 8, Steps: 34 | Train Loss: 8.392 Vali Loss: 19.697 Vali Acc: 0.751 Test Loss: 19.697 Test Acc: 0.751
Validation loss decreased (-0.705008 --> -0.751248).  Saving model ...
Epoch: 9 cost time: 21.044567584991455
Epoch: 9, Steps: 34 | Train Loss: 5.086 Vali Loss: 21.036 Vali Acc: 0.642 Test Loss: 21.036 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.03678870201111
Epoch: 10, Steps: 34 | Train Loss: 7.182 Vali Loss: 15.772 Vali Acc: 0.740 Test Loss: 15.772 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.680497884750366
Epoch: 11, Steps: 34 | Train Loss: 3.797 Vali Loss: 30.243 Vali Acc: 0.769 Test Loss: 30.243 Test Acc: 0.769
Validation loss decreased (-0.751248 --> -0.768484).  Saving model ...
Epoch: 12 cost time: 20.8662052154541
Epoch: 12, Steps: 34 | Train Loss: 2.657 Vali Loss: 26.235 Vali Acc: 0.676 Test Loss: 26.235 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.901668787002563
Epoch: 13, Steps: 34 | Train Loss: 5.835 Vali Loss: 26.932 Vali Acc: 0.723 Test Loss: 26.932 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.168981313705444
Epoch: 14, Steps: 34 | Train Loss: 2.931 Vali Loss: 23.295 Vali Acc: 0.723 Test Loss: 23.295 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.423112154006958
Epoch: 15, Steps: 34 | Train Loss: 4.542 Vali Loss: 24.329 Vali Acc: 0.734 Test Loss: 24.329 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.533885955810547
Epoch: 16, Steps: 34 | Train Loss: 12.384 Vali Loss: 23.548 Vali Acc: 0.746 Test Loss: 23.548 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.525702238082886
Epoch: 17, Steps: 34 | Train Loss: 4.254 Vali Loss: 26.299 Vali Acc: 0.775 Test Loss: 26.299 Test Acc: 0.775
Validation loss decreased (-0.768484 --> -0.774303).  Saving model ...
Epoch: 18 cost time: 21.667264938354492
Epoch: 18, Steps: 34 | Train Loss: 0.410 Vali Loss: 30.735 Vali Acc: 0.671 Test Loss: 30.735 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.117348432540894
Epoch: 19, Steps: 34 | Train Loss: 1.494 Vali Loss: 27.195 Vali Acc: 0.728 Test Loss: 27.195 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.729682683944702
Epoch: 20, Steps: 34 | Train Loss: 1.845 Vali Loss: 23.897 Vali Acc: 0.815 Test Loss: 23.897 Test Acc: 0.815
Validation loss decreased (-0.774303 --> -0.814790).  Saving model ...
Epoch: 21 cost time: 21.81440281867981
Epoch: 21, Steps: 34 | Train Loss: 2.901 Vali Loss: 25.468 Vali Acc: 0.746 Test Loss: 25.468 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 21.68585467338562
Epoch: 22, Steps: 34 | Train Loss: 1.242 Vali Loss: 18.664 Vali Acc: 0.780 Test Loss: 18.664 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 22.634926795959473
Epoch: 23, Steps: 34 | Train Loss: 1.402 Vali Loss: 19.666 Vali Acc: 0.821 Test Loss: 19.666 Test Acc: 0.821
Validation loss decreased (-0.814790 --> -0.820613).  Saving model ...
Epoch: 24 cost time: 22.03267526626587
Epoch: 24, Steps: 34 | Train Loss: 2.561 Vali Loss: 30.451 Vali Acc: 0.728 Test Loss: 30.451 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 21.490833520889282
Epoch: 25, Steps: 34 | Train Loss: 4.512 Vali Loss: 33.838 Vali Acc: 0.688 Test Loss: 33.838 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 22.147611141204834
Epoch: 26, Steps: 34 | Train Loss: 5.505 Vali Loss: 62.053 Vali Acc: 0.630 Test Loss: 62.053 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 23.374368906021118
Epoch: 27, Steps: 34 | Train Loss: 5.637 Vali Loss: 91.178 Vali Acc: 0.468 Test Loss: 91.178 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 24.495996236801147
Epoch: 28, Steps: 34 | Train Loss: 12.824 Vali Loss: 27.141 Vali Acc: 0.694 Test Loss: 27.141 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 25.250096321105957
Epoch: 29, Steps: 34 | Train Loss: 14.220 Vali Loss: 19.222 Vali Acc: 0.751 Test Loss: 19.222 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 23.02626371383667
Epoch: 30, Steps: 34 | Train Loss: 6.831 Vali Loss: 30.519 Vali Acc: 0.688 Test Loss: 30.519 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 21.079295873641968
Epoch: 31, Steps: 34 | Train Loss: 5.163 Vali Loss: 28.450 Vali Acc: 0.671 Test Loss: 28.450 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 21.52040433883667
Epoch: 32, Steps: 34 | Train Loss: 5.570 Vali Loss: 30.209 Vali Acc: 0.711 Test Loss: 30.209 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 18.477607011795044
Epoch: 33, Steps: 34 | Train Loss: 8.645 Vali Loss: 14.518 Vali Acc: 0.665 Test Loss: 14.518 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 21236523
model size : 86.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.83027696609497
Epoch: 1, Steps: 34 | Train Loss: 22.855 Vali Loss: 24.320 Vali Acc: 0.335 Test Loss: 24.320 Test Acc: 0.335
Validation loss decreased (inf --> -0.335017).  Saving model ...
Epoch: 2 cost time: 18.752549409866333
Epoch: 2, Steps: 34 | Train Loss: 34.090 Vali Loss: 65.858 Vali Acc: 0.451 Test Loss: 65.858 Test Acc: 0.451
Validation loss decreased (-0.335017 --> -0.450208).  Saving model ...
Epoch: 3 cost time: 20.068510055541992
Epoch: 3, Steps: 34 | Train Loss: 47.811 Vali Loss: 51.803 Vali Acc: 0.347 Test Loss: 51.803 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.128628253936768
Epoch: 4, Steps: 34 | Train Loss: 31.153 Vali Loss: 16.455 Vali Acc: 0.595 Test Loss: 16.455 Test Acc: 0.595
Validation loss decreased (-0.450208 --> -0.595211).  Saving model ...
Epoch: 5 cost time: 20.24430751800537
Epoch: 5, Steps: 34 | Train Loss: 20.861 Vali Loss: 39.162 Vali Acc: 0.514 Test Loss: 39.162 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.024673461914062
Epoch: 6, Steps: 34 | Train Loss: 21.882 Vali Loss: 50.890 Vali Acc: 0.578 Test Loss: 50.890 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.83330750465393
Epoch: 7, Steps: 34 | Train Loss: 19.620 Vali Loss: 85.031 Vali Acc: 0.434 Test Loss: 85.031 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.217503786087036
Epoch: 8, Steps: 34 | Train Loss: 16.096 Vali Loss: 42.190 Vali Acc: 0.572 Test Loss: 42.190 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 22.190645456314087
Epoch: 9, Steps: 34 | Train Loss: 7.703 Vali Loss: 32.353 Vali Acc: 0.688 Test Loss: 32.353 Test Acc: 0.688
Validation loss decreased (-0.595211 --> -0.687538).  Saving model ...
Epoch: 10 cost time: 20.13500952720642
Epoch: 10, Steps: 34 | Train Loss: 10.180 Vali Loss: 23.015 Vali Acc: 0.676 Test Loss: 23.015 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.160727500915527
Epoch: 11, Steps: 34 | Train Loss: 6.440 Vali Loss: 50.482 Vali Acc: 0.682 Test Loss: 50.482 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.120291233062744
Epoch: 12, Steps: 34 | Train Loss: 3.975 Vali Loss: 52.816 Vali Acc: 0.451 Test Loss: 52.816 Test Acc: 0.451
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 20.35215139389038
Epoch: 13, Steps: 34 | Train Loss: 4.390 Vali Loss: 20.589 Vali Acc: 0.751 Test Loss: 20.589 Test Acc: 0.751
Validation loss decreased (-0.687538 --> -0.751239).  Saving model ...
Epoch: 14 cost time: 20.516658782958984
Epoch: 14, Steps: 34 | Train Loss: 3.954 Vali Loss: 37.301 Vali Acc: 0.671 Test Loss: 37.301 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.233656883239746
Epoch: 15, Steps: 34 | Train Loss: 2.168 Vali Loss: 23.593 Vali Acc: 0.792 Test Loss: 23.593 Test Acc: 0.792
Validation loss decreased (-0.751239 --> -0.791672).  Saving model ...
Epoch: 16 cost time: 19.377022743225098
Epoch: 16, Steps: 34 | Train Loss: 7.687 Vali Loss: 33.136 Vali Acc: 0.711 Test Loss: 33.136 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.285736322402954
Epoch: 17, Steps: 34 | Train Loss: 4.446 Vali Loss: 32.629 Vali Acc: 0.786 Test Loss: 32.629 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.152470588684082
Epoch: 18, Steps: 34 | Train Loss: 3.993 Vali Loss: 27.687 Vali Acc: 0.775 Test Loss: 27.687 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 19.3438241481781
Epoch: 19, Steps: 34 | Train Loss: 3.772 Vali Loss: 33.120 Vali Acc: 0.676 Test Loss: 33.120 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 20.076788902282715
Epoch: 20, Steps: 34 | Train Loss: 14.346 Vali Loss: 41.671 Vali Acc: 0.694 Test Loss: 41.671 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 18.259281158447266
Epoch: 21, Steps: 34 | Train Loss: 5.010 Vali Loss: 15.883 Vali Acc: 0.775 Test Loss: 15.883 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 21.831121921539307
Epoch: 22, Steps: 34 | Train Loss: 3.857 Vali Loss: 42.473 Vali Acc: 0.699 Test Loss: 42.473 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 20.31316876411438
Epoch: 23, Steps: 34 | Train Loss: 5.374 Vali Loss: 13.598 Vali Acc: 0.821 Test Loss: 13.598 Test Acc: 0.821
Validation loss decreased (-0.791672 --> -0.820673).  Saving model ...
Epoch: 24 cost time: 19.725600481033325
Epoch: 24, Steps: 34 | Train Loss: 2.582 Vali Loss: 23.818 Vali Acc: 0.717 Test Loss: 23.818 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 20.272944450378418
Epoch: 25, Steps: 34 | Train Loss: 2.594 Vali Loss: 35.369 Vali Acc: 0.757 Test Loss: 35.369 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 19.159263610839844
Epoch: 26, Steps: 34 | Train Loss: 4.133 Vali Loss: 17.998 Vali Acc: 0.798 Test Loss: 17.998 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 19.048722982406616
Epoch: 27, Steps: 34 | Train Loss: 2.129 Vali Loss: 39.352 Vali Acc: 0.734 Test Loss: 39.352 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 19.722737312316895
Epoch: 28, Steps: 34 | Train Loss: 2.641 Vali Loss: 31.025 Vali Acc: 0.728 Test Loss: 31.025 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 20.077540636062622
Epoch: 29, Steps: 34 | Train Loss: 4.423 Vali Loss: 75.076 Vali Acc: 0.618 Test Loss: 75.076 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 19.455076456069946
Epoch: 30, Steps: 34 | Train Loss: 6.077 Vali Loss: 32.595 Vali Acc: 0.775 Test Loss: 32.595 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 18.951263427734375
Epoch: 31, Steps: 34 | Train Loss: 2.998 Vali Loss: 21.949 Vali Acc: 0.803 Test Loss: 21.949 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 18.663697242736816
Epoch: 32, Steps: 34 | Train Loss: 2.864 Vali Loss: 30.437 Vali Acc: 0.728 Test Loss: 30.437 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 19.486146688461304
Epoch: 33, Steps: 34 | Train Loss: 6.106 Vali Loss: 30.987 Vali Acc: 0.711 Test Loss: 30.987 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 19937067
model size : 81.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.123074769973755
Epoch: 1, Steps: 34 | Train Loss: 14.829 Vali Loss: 15.426 Vali Acc: 0.387 Test Loss: 15.426 Test Acc: 0.387
Validation loss decreased (inf --> -0.387129).  Saving model ...
Epoch: 2 cost time: 21.596610069274902
Epoch: 2, Steps: 34 | Train Loss: 36.627 Vali Loss: 55.472 Vali Acc: 0.254 Test Loss: 55.472 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.267608642578125
Epoch: 3, Steps: 34 | Train Loss: 33.956 Vali Loss: 27.953 Vali Acc: 0.688 Test Loss: 27.953 Test Acc: 0.688
Validation loss decreased (-0.387129 --> -0.687582).  Saving model ...
Epoch: 4 cost time: 18.867696523666382
Epoch: 4, Steps: 34 | Train Loss: 39.230 Vali Loss: 42.192 Vali Acc: 0.503 Test Loss: 42.192 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.41831922531128
Epoch: 5, Steps: 34 | Train Loss: 18.201 Vali Loss: 44.811 Vali Acc: 0.410 Test Loss: 44.811 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.749824047088623
Epoch: 6, Steps: 34 | Train Loss: 17.423 Vali Loss: 26.412 Vali Acc: 0.607 Test Loss: 26.412 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.94017219543457
Epoch: 7, Steps: 34 | Train Loss: 9.688 Vali Loss: 23.306 Vali Acc: 0.584 Test Loss: 23.306 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.13288116455078
Epoch: 8, Steps: 34 | Train Loss: 9.908 Vali Loss: 40.092 Vali Acc: 0.618 Test Loss: 40.092 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.814711570739746
Epoch: 9, Steps: 34 | Train Loss: 10.598 Vali Loss: 27.408 Vali Acc: 0.665 Test Loss: 27.408 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.989572525024414
Epoch: 10, Steps: 34 | Train Loss: 7.867 Vali Loss: 15.904 Vali Acc: 0.728 Test Loss: 15.904 Test Acc: 0.728
Validation loss decreased (-0.687582 --> -0.728165).  Saving model ...
Epoch: 11 cost time: 18.65169382095337
Epoch: 11, Steps: 34 | Train Loss: 2.195 Vali Loss: 16.687 Vali Acc: 0.711 Test Loss: 16.687 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.64913034439087
Epoch: 12, Steps: 34 | Train Loss: 2.746 Vali Loss: 25.688 Vali Acc: 0.723 Test Loss: 25.688 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.658352375030518
Epoch: 13, Steps: 34 | Train Loss: 3.153 Vali Loss: 35.753 Vali Acc: 0.699 Test Loss: 35.753 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.737379789352417
Epoch: 14, Steps: 34 | Train Loss: 6.131 Vali Loss: 21.766 Vali Acc: 0.734 Test Loss: 21.766 Test Acc: 0.734
Validation loss decreased (-0.728165 --> -0.733886).  Saving model ...
Epoch: 15 cost time: 19.708107948303223
Epoch: 15, Steps: 34 | Train Loss: 5.731 Vali Loss: 36.777 Vali Acc: 0.699 Test Loss: 36.777 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.477102994918823
Epoch: 16, Steps: 34 | Train Loss: 1.608 Vali Loss: 24.080 Vali Acc: 0.699 Test Loss: 24.080 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.07328701019287
Epoch: 17, Steps: 34 | Train Loss: 1.192 Vali Loss: 34.906 Vali Acc: 0.746 Test Loss: 34.906 Test Acc: 0.746
Validation loss decreased (-0.733886 --> -0.745316).  Saving model ...
Epoch: 18 cost time: 18.979365348815918
Epoch: 18, Steps: 34 | Train Loss: 4.206 Vali Loss: 47.970 Vali Acc: 0.705 Test Loss: 47.970 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 18.71557092666626
Epoch: 19, Steps: 34 | Train Loss: 2.458 Vali Loss: 11.224 Vali Acc: 0.821 Test Loss: 11.224 Test Acc: 0.821
Validation loss decreased (-0.745316 --> -0.820697).  Saving model ...
Epoch: 20 cost time: 17.589176416397095
Epoch: 20, Steps: 34 | Train Loss: 3.874 Vali Loss: 41.159 Vali Acc: 0.688 Test Loss: 41.159 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 18.476215839385986
Epoch: 21, Steps: 34 | Train Loss: 3.698 Vali Loss: 14.382 Vali Acc: 0.798 Test Loss: 14.382 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.342929124832153
Epoch: 22, Steps: 34 | Train Loss: 2.317 Vali Loss: 66.103 Vali Acc: 0.659 Test Loss: 66.103 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 19.374375343322754
Epoch: 23, Steps: 34 | Train Loss: 3.527 Vali Loss: 13.586 Vali Acc: 0.809 Test Loss: 13.586 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 17.35216736793518
Epoch: 24, Steps: 34 | Train Loss: 3.649 Vali Loss: 37.476 Vali Acc: 0.728 Test Loss: 37.476 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 18.020095348358154
Epoch: 25, Steps: 34 | Train Loss: 5.200 Vali Loss: 15.568 Vali Acc: 0.798 Test Loss: 15.568 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 19.1644070148468
Epoch: 26, Steps: 34 | Train Loss: 5.311 Vali Loss: 30.910 Vali Acc: 0.705 Test Loss: 30.910 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 18.90425395965576
Epoch: 27, Steps: 34 | Train Loss: 2.285 Vali Loss: 29.484 Vali Acc: 0.728 Test Loss: 29.484 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 17.57527446746826
Epoch: 28, Steps: 34 | Train Loss: 2.755 Vali Loss: 26.373 Vali Acc: 0.775 Test Loss: 26.373 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 21.368390560150146
Epoch: 29, Steps: 34 | Train Loss: 3.936 Vali Loss: 23.224 Vali Acc: 0.757 Test Loss: 23.224 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 19932459
model size : 81.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.537245988845825
Epoch: 1, Steps: 34 | Train Loss: 20.236 Vali Loss: 34.023 Vali Acc: 0.329 Test Loss: 34.023 Test Acc: 0.329
Validation loss decreased (inf --> -0.329140).  Saving model ...
Epoch: 2 cost time: 22.04041075706482
Epoch: 2, Steps: 34 | Train Loss: 33.585 Vali Loss: 27.573 Vali Acc: 0.480 Test Loss: 27.573 Test Acc: 0.480
Validation loss decreased (-0.329140 --> -0.479493).  Saving model ...
Epoch: 3 cost time: 18.786129474639893
Epoch: 3, Steps: 34 | Train Loss: 48.917 Vali Loss: 92.150 Vali Acc: 0.376 Test Loss: 92.150 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.707377195358276
Epoch: 4, Steps: 34 | Train Loss: 45.697 Vali Loss: 71.179 Vali Acc: 0.445 Test Loss: 71.179 Test Acc: 0.445
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.98450231552124
Epoch: 5, Steps: 34 | Train Loss: 30.367 Vali Loss: 21.102 Vali Acc: 0.636 Test Loss: 21.102 Test Acc: 0.636
Validation loss decreased (-0.479493 --> -0.635627).  Saving model ...
Epoch: 6 cost time: 18.532727241516113
Epoch: 6, Steps: 34 | Train Loss: 15.579 Vali Loss: 40.783 Vali Acc: 0.607 Test Loss: 40.783 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.030601263046265
Epoch: 7, Steps: 34 | Train Loss: 9.955 Vali Loss: 25.362 Vali Acc: 0.682 Test Loss: 25.362 Test Acc: 0.682
Validation loss decreased (-0.635627 --> -0.681827).  Saving model ...
Epoch: 8 cost time: 19.647547960281372
Epoch: 8, Steps: 34 | Train Loss: 13.555 Vali Loss: 28.854 Vali Acc: 0.578 Test Loss: 28.854 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.530954360961914
Epoch: 9, Steps: 34 | Train Loss: 10.295 Vali Loss: 26.926 Vali Acc: 0.653 Test Loss: 26.926 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.46458148956299
Epoch: 10, Steps: 34 | Train Loss: 3.006 Vali Loss: 19.705 Vali Acc: 0.728 Test Loss: 19.705 Test Acc: 0.728
Validation loss decreased (-0.681827 --> -0.728127).  Saving model ...
Epoch: 11 cost time: 19.034746170043945
Epoch: 11, Steps: 34 | Train Loss: 5.634 Vali Loss: 28.698 Vali Acc: 0.757 Test Loss: 28.698 Test Acc: 0.757
Validation loss decreased (-0.728127 --> -0.756938).  Saving model ...
Epoch: 12 cost time: 18.044183015823364
Epoch: 12, Steps: 34 | Train Loss: 2.398 Vali Loss: 23.003 Vali Acc: 0.717 Test Loss: 23.003 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.309894800186157
Epoch: 13, Steps: 34 | Train Loss: 3.559 Vali Loss: 35.194 Vali Acc: 0.711 Test Loss: 35.194 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 21.342525243759155
Epoch: 14, Steps: 34 | Train Loss: 6.396 Vali Loss: 23.020 Vali Acc: 0.717 Test Loss: 23.020 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.81031084060669
Epoch: 15, Steps: 34 | Train Loss: 2.121 Vali Loss: 30.607 Vali Acc: 0.711 Test Loss: 30.607 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.65092921257019
Epoch: 16, Steps: 34 | Train Loss: 3.693 Vali Loss: 44.461 Vali Acc: 0.694 Test Loss: 44.461 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.48961114883423
Epoch: 17, Steps: 34 | Train Loss: 3.303 Vali Loss: 20.334 Vali Acc: 0.769 Test Loss: 20.334 Test Acc: 0.769
Validation loss decreased (-0.756938 --> -0.768583).  Saving model ...
Epoch: 18 cost time: 15.911852359771729
Epoch: 18, Steps: 34 | Train Loss: 0.700 Vali Loss: 27.149 Vali Acc: 0.763 Test Loss: 27.149 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 18.33701229095459
Epoch: 19, Steps: 34 | Train Loss: 4.222 Vali Loss: 28.070 Vali Acc: 0.746 Test Loss: 28.070 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.615118265151978
Epoch: 20, Steps: 34 | Train Loss: 0.537 Vali Loss: 26.528 Vali Acc: 0.763 Test Loss: 26.528 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 18.33978533744812
Epoch: 21, Steps: 34 | Train Loss: 1.110 Vali Loss: 35.848 Vali Acc: 0.723 Test Loss: 35.848 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 18.599021673202515
Epoch: 22, Steps: 34 | Train Loss: 0.188 Vali Loss: 33.384 Vali Acc: 0.746 Test Loss: 33.384 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 19.03253412246704
Epoch: 23, Steps: 34 | Train Loss: 1.409 Vali Loss: 46.875 Vali Acc: 0.699 Test Loss: 46.875 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 19.29017949104309
Epoch: 24, Steps: 34 | Train Loss: 1.289 Vali Loss: 46.746 Vali Acc: 0.705 Test Loss: 46.746 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 18.26251792907715
Epoch: 25, Steps: 34 | Train Loss: 3.099 Vali Loss: 18.503 Vali Acc: 0.803 Test Loss: 18.503 Test Acc: 0.803
Validation loss decreased (-0.768583 --> -0.803283).  Saving model ...
Epoch: 26 cost time: 17.883978605270386
Epoch: 26, Steps: 34 | Train Loss: 0.437 Vali Loss: 36.624 Vali Acc: 0.734 Test Loss: 36.624 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 19.331432580947876
Epoch: 27, Steps: 34 | Train Loss: 6.775 Vali Loss: 55.067 Vali Acc: 0.636 Test Loss: 55.067 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 20.170265913009644
Epoch: 28, Steps: 34 | Train Loss: 9.185 Vali Loss: 74.587 Vali Acc: 0.601 Test Loss: 74.587 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 19.67838764190674
Epoch: 29, Steps: 34 | Train Loss: 10.929 Vali Loss: 20.480 Vali Acc: 0.751 Test Loss: 20.480 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 20.893630027770996
Epoch: 30, Steps: 34 | Train Loss: 11.754 Vali Loss: 19.991 Vali Acc: 0.728 Test Loss: 19.991 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 19.363909244537354
Epoch: 31, Steps: 34 | Train Loss: 8.135 Vali Loss: 27.573 Vali Acc: 0.780 Test Loss: 27.573 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 18.519703149795532
Epoch: 32, Steps: 34 | Train Loss: 19.349 Vali Loss: 27.542 Vali Acc: 0.705 Test Loss: 27.542 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 18.058401107788086
Epoch: 33, Steps: 34 | Train Loss: 8.096 Vali Loss: 78.696 Vali Acc: 0.520 Test Loss: 78.696 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 18.186665058135986
Epoch: 34, Steps: 34 | Train Loss: 17.254 Vali Loss: 30.387 Vali Acc: 0.688 Test Loss: 30.387 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 16.786593437194824
Epoch: 35, Steps: 34 | Train Loss: 16.636 Vali Loss: 30.453 Vali Acc: 0.555 Test Loss: 30.453 Test Acc: 0.555
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 19927851
model size : 81.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.546979904174805
Epoch: 1, Steps: 34 | Train Loss: 18.486 Vali Loss: 51.126 Vali Acc: 0.243 Test Loss: 51.126 Test Acc: 0.243
Validation loss decreased (inf --> -0.242263).  Saving model ...
Epoch: 2 cost time: 18.888991594314575
Epoch: 2, Steps: 34 | Train Loss: 36.014 Vali Loss: 37.627 Vali Acc: 0.376 Test Loss: 37.627 Test Acc: 0.376
Validation loss decreased (-0.242263 --> -0.375346).  Saving model ...
Epoch: 3 cost time: 17.62125277519226
Epoch: 3, Steps: 34 | Train Loss: 33.946 Vali Loss: 25.438 Vali Acc: 0.526 Test Loss: 25.438 Test Acc: 0.526
Validation loss decreased (-0.375346 --> -0.525757).  Saving model ...
Epoch: 4 cost time: 18.883150577545166
Epoch: 4, Steps: 34 | Train Loss: 30.025 Vali Loss: 33.462 Vali Acc: 0.578 Test Loss: 33.462 Test Acc: 0.578
Validation loss decreased (-0.525757 --> -0.577700).  Saving model ...
Epoch: 5 cost time: 18.796723127365112
Epoch: 5, Steps: 34 | Train Loss: 33.665 Vali Loss: 78.971 Vali Acc: 0.457 Test Loss: 78.971 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.06964898109436
Epoch: 6, Steps: 34 | Train Loss: 35.740 Vali Loss: 45.913 Vali Acc: 0.555 Test Loss: 45.913 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.348345518112183
Epoch: 7, Steps: 34 | Train Loss: 19.374 Vali Loss: 28.182 Vali Acc: 0.676 Test Loss: 28.182 Test Acc: 0.676
Validation loss decreased (-0.577700 --> -0.676019).  Saving model ...
Epoch: 8 cost time: 20.088176012039185
Epoch: 8, Steps: 34 | Train Loss: 18.841 Vali Loss: 46.411 Vali Acc: 0.572 Test Loss: 46.411 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.222456693649292
Epoch: 9, Steps: 34 | Train Loss: 16.488 Vali Loss: 40.988 Vali Acc: 0.694 Test Loss: 40.988 Test Acc: 0.694
Validation loss decreased (-0.676019 --> -0.693232).  Saving model ...
Epoch: 10 cost time: 19.08155083656311
Epoch: 10, Steps: 34 | Train Loss: 17.770 Vali Loss: 45.286 Vali Acc: 0.561 Test Loss: 45.286 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.671796560287476
Epoch: 11, Steps: 34 | Train Loss: 9.426 Vali Loss: 26.753 Vali Acc: 0.717 Test Loss: 26.753 Test Acc: 0.717
Validation loss decreased (-0.693232 --> -0.716495).  Saving model ...
Epoch: 12 cost time: 17.03203511238098
Epoch: 12, Steps: 34 | Train Loss: 2.728 Vali Loss: 37.475 Vali Acc: 0.590 Test Loss: 37.475 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.414316654205322
Epoch: 13, Steps: 34 | Train Loss: 5.777 Vali Loss: 23.363 Vali Acc: 0.838 Test Loss: 23.363 Test Acc: 0.838
Validation loss decreased (-0.716495 --> -0.837917).  Saving model ...
Epoch: 14 cost time: 17.26504945755005
Epoch: 14, Steps: 34 | Train Loss: 5.703 Vali Loss: 48.741 Vali Acc: 0.682 Test Loss: 48.741 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.54269051551819
Epoch: 15, Steps: 34 | Train Loss: 5.350 Vali Loss: 27.073 Vali Acc: 0.763 Test Loss: 27.073 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.396652221679688
Epoch: 16, Steps: 34 | Train Loss: 2.244 Vali Loss: 26.915 Vali Acc: 0.740 Test Loss: 26.915 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.621085166931152
Epoch: 17, Steps: 34 | Train Loss: 1.719 Vali Loss: 58.851 Vali Acc: 0.642 Test Loss: 58.851 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.300957679748535
Epoch: 18, Steps: 34 | Train Loss: 3.906 Vali Loss: 29.961 Vali Acc: 0.682 Test Loss: 29.961 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.526647567749023
Epoch: 19, Steps: 34 | Train Loss: 3.394 Vali Loss: 17.447 Vali Acc: 0.844 Test Loss: 17.447 Test Acc: 0.844
Validation loss decreased (-0.837917 --> -0.843756).  Saving model ...
Epoch: 20 cost time: 19.34455966949463
Epoch: 20, Steps: 34 | Train Loss: 2.844 Vali Loss: 15.508 Vali Acc: 0.809 Test Loss: 15.508 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 17.14609694480896
Epoch: 21, Steps: 34 | Train Loss: 0.895 Vali Loss: 16.896 Vali Acc: 0.780 Test Loss: 16.896 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.778300046920776
Epoch: 22, Steps: 34 | Train Loss: 8.728 Vali Loss: 32.070 Vali Acc: 0.775 Test Loss: 32.070 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 17.039150714874268
Epoch: 23, Steps: 34 | Train Loss: 3.457 Vali Loss: 51.367 Vali Acc: 0.740 Test Loss: 51.367 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 18.2146897315979
Epoch: 24, Steps: 34 | Train Loss: 1.848 Vali Loss: 22.842 Vali Acc: 0.780 Test Loss: 22.842 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 16.658602714538574
Epoch: 25, Steps: 34 | Train Loss: 1.418 Vali Loss: 15.121 Vali Acc: 0.832 Test Loss: 15.121 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 17.345006942749023
Epoch: 26, Steps: 34 | Train Loss: 1.685 Vali Loss: 99.120 Vali Acc: 0.595 Test Loss: 99.120 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 17.648552656173706
Epoch: 27, Steps: 34 | Train Loss: 4.988 Vali Loss: 41.765 Vali Acc: 0.711 Test Loss: 41.765 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 17.61952519416809
Epoch: 28, Steps: 34 | Train Loss: 6.192 Vali Loss: 33.148 Vali Acc: 0.769 Test Loss: 33.148 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 17.783894062042236
Epoch: 29, Steps: 34 | Train Loss: 7.345 Vali Loss: 23.354 Vali Acc: 0.786 Test Loss: 23.354 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 19923243
model size : 80.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.92712378501892
Epoch: 1, Steps: 34 | Train Loss: 21.967 Vali Loss: 40.979 Vali Acc: 0.341 Test Loss: 40.979 Test Acc: 0.341
Validation loss decreased (inf --> -0.340631).  Saving model ...
Epoch: 2 cost time: 17.051394939422607
Epoch: 2, Steps: 34 | Train Loss: 53.954 Vali Loss: 60.748 Vali Acc: 0.312 Test Loss: 60.748 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.926106452941895
Epoch: 3, Steps: 34 | Train Loss: 47.132 Vali Loss: 25.975 Vali Acc: 0.566 Test Loss: 25.975 Test Acc: 0.566
Validation loss decreased (-0.340631 --> -0.566214).  Saving model ...
Epoch: 4 cost time: 18.53779935836792
Epoch: 4, Steps: 34 | Train Loss: 26.804 Vali Loss: 21.978 Vali Acc: 0.659 Test Loss: 21.978 Test Acc: 0.659
Validation loss decreased (-0.566214 --> -0.658740).  Saving model ...
Epoch: 5 cost time: 20.235658645629883
Epoch: 5, Steps: 34 | Train Loss: 31.101 Vali Loss: 65.573 Vali Acc: 0.520 Test Loss: 65.573 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.40571641921997
Epoch: 6, Steps: 34 | Train Loss: 24.011 Vali Loss: 16.443 Vali Acc: 0.711 Test Loss: 16.443 Test Acc: 0.711
Validation loss decreased (-0.658740 --> -0.710818).  Saving model ...
Epoch: 7 cost time: 15.872629880905151
Epoch: 7, Steps: 34 | Train Loss: 15.211 Vali Loss: 39.858 Vali Acc: 0.618 Test Loss: 39.858 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.493082523345947
Epoch: 8, Steps: 34 | Train Loss: 13.051 Vali Loss: 18.869 Vali Acc: 0.723 Test Loss: 18.869 Test Acc: 0.723
Validation loss decreased (-0.710818 --> -0.722355).  Saving model ...
Epoch: 9 cost time: 17.395784616470337
Epoch: 9, Steps: 34 | Train Loss: 8.216 Vali Loss: 65.264 Vali Acc: 0.491 Test Loss: 65.264 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.813925743103027
Epoch: 10, Steps: 34 | Train Loss: 6.967 Vali Loss: 13.032 Vali Acc: 0.815 Test Loss: 13.032 Test Acc: 0.815
Validation loss decreased (-0.722355 --> -0.814899).  Saving model ...
Epoch: 11 cost time: 18.56224298477173
Epoch: 11, Steps: 34 | Train Loss: 9.546 Vali Loss: 32.817 Vali Acc: 0.624 Test Loss: 32.817 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.988051176071167
Epoch: 12, Steps: 34 | Train Loss: 7.937 Vali Loss: 52.766 Vali Acc: 0.607 Test Loss: 52.766 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.40728521347046
Epoch: 13, Steps: 34 | Train Loss: 4.165 Vali Loss: 30.938 Vali Acc: 0.723 Test Loss: 30.938 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.841991662979126
Epoch: 14, Steps: 34 | Train Loss: 2.067 Vali Loss: 45.808 Vali Acc: 0.699 Test Loss: 45.808 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.619080543518066
Epoch: 15, Steps: 34 | Train Loss: 4.686 Vali Loss: 26.195 Vali Acc: 0.751 Test Loss: 26.195 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.81110191345215
Epoch: 16, Steps: 34 | Train Loss: 4.730 Vali Loss: 36.558 Vali Acc: 0.775 Test Loss: 36.558 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 19.39729070663452
Epoch: 17, Steps: 34 | Train Loss: 2.693 Vali Loss: 38.573 Vali Acc: 0.803 Test Loss: 38.573 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.233614444732666
Epoch: 18, Steps: 34 | Train Loss: 1.380 Vali Loss: 51.288 Vali Acc: 0.728 Test Loss: 51.288 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 18.14833927154541
Epoch: 19, Steps: 34 | Train Loss: 2.911 Vali Loss: 98.530 Vali Acc: 0.457 Test Loss: 98.530 Test Acc: 0.457
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 19.581020832061768
Epoch: 20, Steps: 34 | Train Loss: 3.462 Vali Loss: 32.202 Vali Acc: 0.775 Test Loss: 32.202 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 19280427
model size : 78.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.496785163879395
Epoch: 1, Steps: 34 | Train Loss: 13.860 Vali Loss: 23.794 Vali Acc: 0.329 Test Loss: 23.794 Test Acc: 0.329
Validation loss decreased (inf --> -0.329242).  Saving model ...
Epoch: 2 cost time: 18.244023323059082
Epoch: 2, Steps: 34 | Train Loss: 24.282 Vali Loss: 32.940 Vali Acc: 0.462 Test Loss: 32.940 Test Acc: 0.462
Validation loss decreased (-0.329242 --> -0.462098).  Saving model ...
Epoch: 3 cost time: 17.72580647468567
Epoch: 3, Steps: 34 | Train Loss: 75.622 Vali Loss: 101.389 Vali Acc: 0.168 Test Loss: 101.389 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.17337155342102
Epoch: 4, Steps: 34 | Train Loss: 44.868 Vali Loss: 122.047 Vali Acc: 0.416 Test Loss: 122.047 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.000600576400757
Epoch: 5, Steps: 34 | Train Loss: 46.905 Vali Loss: 41.418 Vali Acc: 0.613 Test Loss: 41.418 Test Acc: 0.613
Validation loss decreased (-0.462098 --> -0.612303).  Saving model ...
Epoch: 6 cost time: 17.49595880508423
Epoch: 6, Steps: 34 | Train Loss: 32.907 Vali Loss: 65.500 Vali Acc: 0.688 Test Loss: 65.500 Test Acc: 0.688
Validation loss decreased (-0.612303 --> -0.687206).  Saving model ...
Epoch: 7 cost time: 17.7865731716156
Epoch: 7, Steps: 34 | Train Loss: 37.206 Vali Loss: 77.264 Vali Acc: 0.590 Test Loss: 77.264 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.776383638381958
Epoch: 8, Steps: 34 | Train Loss: 26.181 Vali Loss: 35.558 Vali Acc: 0.757 Test Loss: 35.558 Test Acc: 0.757
Validation loss decreased (-0.687206 --> -0.756870).  Saving model ...
Epoch: 9 cost time: 18.17105722427368
Epoch: 9, Steps: 34 | Train Loss: 15.550 Vali Loss: 29.128 Vali Acc: 0.665 Test Loss: 29.128 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.39688014984131
Epoch: 10, Steps: 34 | Train Loss: 10.658 Vali Loss: 46.413 Vali Acc: 0.642 Test Loss: 46.413 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.09811782836914
Epoch: 11, Steps: 34 | Train Loss: 5.353 Vali Loss: 32.295 Vali Acc: 0.740 Test Loss: 32.295 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 20.698047399520874
Epoch: 12, Steps: 34 | Train Loss: 7.769 Vali Loss: 30.715 Vali Acc: 0.734 Test Loss: 30.715 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.71938419342041
Epoch: 13, Steps: 34 | Train Loss: 4.916 Vali Loss: 14.200 Vali Acc: 0.838 Test Loss: 14.200 Test Acc: 0.838
Validation loss decreased (-0.756870 --> -0.838008).  Saving model ...
Epoch: 14 cost time: 17.893863439559937
Epoch: 14, Steps: 34 | Train Loss: 12.183 Vali Loss: 21.806 Vali Acc: 0.798 Test Loss: 21.806 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.286905765533447
Epoch: 15, Steps: 34 | Train Loss: 9.711 Vali Loss: 34.458 Vali Acc: 0.798 Test Loss: 34.458 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.533379793167114
Epoch: 16, Steps: 34 | Train Loss: 14.270 Vali Loss: 45.056 Vali Acc: 0.746 Test Loss: 45.056 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.06775188446045
Epoch: 17, Steps: 34 | Train Loss: 3.549 Vali Loss: 23.533 Vali Acc: 0.769 Test Loss: 23.533 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 16.785471439361572
Epoch: 18, Steps: 34 | Train Loss: 1.646 Vali Loss: 16.336 Vali Acc: 0.815 Test Loss: 16.336 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 18.198289394378662
Epoch: 19, Steps: 34 | Train Loss: 2.255 Vali Loss: 64.068 Vali Acc: 0.699 Test Loss: 64.068 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.890146732330322
Epoch: 20, Steps: 34 | Train Loss: 2.795 Vali Loss: 25.198 Vali Acc: 0.821 Test Loss: 25.198 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 16.586700677871704
Epoch: 21, Steps: 34 | Train Loss: 6.629 Vali Loss: 17.973 Vali Acc: 0.803 Test Loss: 17.973 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.758448362350464
Epoch: 22, Steps: 34 | Train Loss: 5.348 Vali Loss: 41.070 Vali Acc: 0.676 Test Loss: 41.070 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 17.648658275604248
Epoch: 23, Steps: 34 | Train Loss: 6.498 Vali Loss: 49.808 Vali Acc: 0.711 Test Loss: 49.808 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 19275819
model size : 78.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.408323287963867
Epoch: 1, Steps: 34 | Train Loss: 22.516 Vali Loss: 26.562 Vali Acc: 0.283 Test Loss: 26.562 Test Acc: 0.283
Validation loss decreased (inf --> -0.282971).  Saving model ...
Epoch: 2 cost time: 18.694406032562256
Epoch: 2, Steps: 34 | Train Loss: 26.266 Vali Loss: 28.679 Vali Acc: 0.364 Test Loss: 28.679 Test Acc: 0.364
Validation loss decreased (-0.282971 --> -0.363875).  Saving model ...
Epoch: 3 cost time: 18.744945287704468
Epoch: 3, Steps: 34 | Train Loss: 39.739 Vali Loss: 37.000 Vali Acc: 0.480 Test Loss: 37.000 Test Acc: 0.480
Validation loss decreased (-0.363875 --> -0.479399).  Saving model ...
Epoch: 4 cost time: 18.286067247390747
Epoch: 4, Steps: 34 | Train Loss: 26.520 Vali Loss: 34.183 Vali Acc: 0.497 Test Loss: 34.183 Test Acc: 0.497
Validation loss decreased (-0.479399 --> -0.496768).  Saving model ...
Epoch: 5 cost time: 17.699194192886353
Epoch: 5, Steps: 34 | Train Loss: 25.171 Vali Loss: 35.052 Vali Acc: 0.566 Test Loss: 35.052 Test Acc: 0.566
Validation loss decreased (-0.496768 --> -0.566123).  Saving model ...
Epoch: 6 cost time: 16.863254070281982
Epoch: 6, Steps: 34 | Train Loss: 15.128 Vali Loss: 12.104 Vali Acc: 0.705 Test Loss: 12.104 Test Acc: 0.705
Validation loss decreased (-0.566123 --> -0.705081).  Saving model ...
Epoch: 7 cost time: 16.39786672592163
Epoch: 7, Steps: 34 | Train Loss: 7.806 Vali Loss: 26.812 Vali Acc: 0.659 Test Loss: 26.812 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.694801568984985
Epoch: 8, Steps: 34 | Train Loss: 6.789 Vali Loss: 23.842 Vali Acc: 0.711 Test Loss: 23.842 Test Acc: 0.711
Validation loss decreased (-0.705081 --> -0.710744).  Saving model ...
Epoch: 9 cost time: 17.448880434036255
Epoch: 9, Steps: 34 | Train Loss: 7.440 Vali Loss: 37.319 Vali Acc: 0.584 Test Loss: 37.319 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.261752128601074
Epoch: 10, Steps: 34 | Train Loss: 6.880 Vali Loss: 37.471 Vali Acc: 0.740 Test Loss: 37.471 Test Acc: 0.740
Validation loss decreased (-0.710744 --> -0.739510).  Saving model ...
Epoch: 11 cost time: 17.599465370178223
Epoch: 11, Steps: 34 | Train Loss: 6.844 Vali Loss: 22.969 Vali Acc: 0.659 Test Loss: 22.969 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.179254293441772
Epoch: 12, Steps: 34 | Train Loss: 2.036 Vali Loss: 26.204 Vali Acc: 0.676 Test Loss: 26.204 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.721146821975708
Epoch: 13, Steps: 34 | Train Loss: 5.830 Vali Loss: 14.719 Vali Acc: 0.786 Test Loss: 14.719 Test Acc: 0.786
Validation loss decreased (-0.739510 --> -0.785980).  Saving model ...
Epoch: 14 cost time: 19.323673963546753
Epoch: 14, Steps: 34 | Train Loss: 3.545 Vali Loss: 22.104 Vali Acc: 0.815 Test Loss: 22.104 Test Acc: 0.815
Validation loss decreased (-0.785980 --> -0.814808).  Saving model ...
Epoch: 15 cost time: 18.46918034553528
Epoch: 15, Steps: 34 | Train Loss: 2.669 Vali Loss: 49.516 Vali Acc: 0.642 Test Loss: 49.516 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.26683473587036
Epoch: 16, Steps: 34 | Train Loss: 2.544 Vali Loss: 19.664 Vali Acc: 0.815 Test Loss: 19.664 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814832).  Saving model ...
Epoch: 17 cost time: 19.47291326522827
Epoch: 17, Steps: 34 | Train Loss: 3.195 Vali Loss: 21.432 Vali Acc: 0.792 Test Loss: 21.432 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.25143003463745
Epoch: 18, Steps: 34 | Train Loss: 3.101 Vali Loss: 28.163 Vali Acc: 0.740 Test Loss: 28.163 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.335322856903076
Epoch: 19, Steps: 34 | Train Loss: 3.596 Vali Loss: 40.134 Vali Acc: 0.717 Test Loss: 40.134 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.212249755859375
Epoch: 20, Steps: 34 | Train Loss: 4.245 Vali Loss: 29.188 Vali Acc: 0.746 Test Loss: 29.188 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.020928621292114
Epoch: 21, Steps: 34 | Train Loss: 3.208 Vali Loss: 28.106 Vali Acc: 0.746 Test Loss: 28.106 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.034776210784912
Epoch: 22, Steps: 34 | Train Loss: 3.419 Vali Loss: 31.839 Vali Acc: 0.751 Test Loss: 31.839 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 18.092761993408203
Epoch: 23, Steps: 34 | Train Loss: 2.281 Vali Loss: 28.116 Vali Acc: 0.786 Test Loss: 28.116 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 17.206230640411377
Epoch: 24, Steps: 34 | Train Loss: 1.635 Vali Loss: 18.907 Vali Acc: 0.815 Test Loss: 18.907 Test Acc: 0.815
Validation loss decreased (-0.814832 --> -0.814840).  Saving model ...
Epoch: 25 cost time: 16.720924615859985
Epoch: 25, Steps: 34 | Train Loss: 0.783 Vali Loss: 27.957 Vali Acc: 0.740 Test Loss: 27.957 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 18.26583981513977
Epoch: 26, Steps: 34 | Train Loss: 2.567 Vali Loss: 40.718 Vali Acc: 0.676 Test Loss: 40.718 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 15.429205417633057
Epoch: 27, Steps: 34 | Train Loss: 1.741 Vali Loss: 25.907 Vali Acc: 0.699 Test Loss: 25.907 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 17.70700764656067
Epoch: 28, Steps: 34 | Train Loss: 1.229 Vali Loss: 33.678 Vali Acc: 0.775 Test Loss: 33.678 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 20.282851934432983
Epoch: 29, Steps: 34 | Train Loss: 0.958 Vali Loss: 25.400 Vali Acc: 0.769 Test Loss: 25.400 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 17.30190348625183
Epoch: 30, Steps: 34 | Train Loss: 0.330 Vali Loss: 22.176 Vali Acc: 0.786 Test Loss: 22.176 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 18.81356167793274
Epoch: 31, Steps: 34 | Train Loss: 0.942 Vali Loss: 28.073 Vali Acc: 0.809 Test Loss: 28.073 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 18.93692111968994
Epoch: 32, Steps: 34 | Train Loss: 1.610 Vali Loss: 59.240 Vali Acc: 0.728 Test Loss: 59.240 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 17.251906871795654
Epoch: 33, Steps: 34 | Train Loss: 4.198 Vali Loss: 25.385 Vali Acc: 0.780 Test Loss: 25.385 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 17.809959650039673
Epoch: 34, Steps: 34 | Train Loss: 4.470 Vali Loss: 28.829 Vali Acc: 0.711 Test Loss: 28.829 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 19271211
model size : 78.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.06151580810547
Epoch: 1, Steps: 34 | Train Loss: 19.750 Vali Loss: 25.128 Vali Acc: 0.457 Test Loss: 25.128 Test Acc: 0.457
Validation loss decreased (inf --> -0.456396).  Saving model ...
Epoch: 2 cost time: 16.395875215530396
Epoch: 2, Steps: 34 | Train Loss: 45.384 Vali Loss: 60.743 Vali Acc: 0.364 Test Loss: 60.743 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.293538331985474
Epoch: 3, Steps: 34 | Train Loss: 45.990 Vali Loss: 26.080 Vali Acc: 0.543 Test Loss: 26.080 Test Acc: 0.543
Validation loss decreased (-0.456396 --> -0.543092).  Saving model ...
Epoch: 4 cost time: 16.0549099445343
Epoch: 4, Steps: 34 | Train Loss: 18.258 Vali Loss: 22.552 Vali Acc: 0.491 Test Loss: 22.552 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.315674781799316
Epoch: 5, Steps: 34 | Train Loss: 22.693 Vali Loss: 41.817 Vali Acc: 0.618 Test Loss: 41.817 Test Acc: 0.618
Validation loss decreased (-0.543092 --> -0.618079).  Saving model ...
Epoch: 6 cost time: 16.817089557647705
Epoch: 6, Steps: 34 | Train Loss: 21.630 Vali Loss: 18.589 Vali Acc: 0.763 Test Loss: 18.589 Test Acc: 0.763
Validation loss decreased (-0.618079 --> -0.762820).  Saving model ...
Epoch: 7 cost time: 17.76964235305786
Epoch: 7, Steps: 34 | Train Loss: 33.981 Vali Loss: 35.624 Vali Acc: 0.584 Test Loss: 35.624 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.70703935623169
Epoch: 8, Steps: 34 | Train Loss: 11.210 Vali Loss: 31.138 Vali Acc: 0.723 Test Loss: 31.138 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.400331020355225
Epoch: 9, Steps: 34 | Train Loss: 11.679 Vali Loss: 94.385 Vali Acc: 0.486 Test Loss: 94.385 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.65627408027649
Epoch: 10, Steps: 34 | Train Loss: 15.155 Vali Loss: 54.248 Vali Acc: 0.647 Test Loss: 54.248 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.067340850830078
Epoch: 11, Steps: 34 | Train Loss: 15.858 Vali Loss: 38.454 Vali Acc: 0.734 Test Loss: 38.454 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.5325825214386
Epoch: 12, Steps: 34 | Train Loss: 6.588 Vali Loss: 60.828 Vali Acc: 0.757 Test Loss: 60.828 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.69972586631775
Epoch: 13, Steps: 34 | Train Loss: 10.646 Vali Loss: 36.246 Vali Acc: 0.786 Test Loss: 36.246 Test Acc: 0.786
Validation loss decreased (-0.762820 --> -0.785765).  Saving model ...
Epoch: 14 cost time: 16.155273914337158
Epoch: 14, Steps: 34 | Train Loss: 13.018 Vali Loss: 57.045 Vali Acc: 0.630 Test Loss: 57.045 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.66398000717163
Epoch: 15, Steps: 34 | Train Loss: 17.137 Vali Loss: 45.760 Vali Acc: 0.705 Test Loss: 45.760 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.90035843849182
Epoch: 16, Steps: 34 | Train Loss: 5.275 Vali Loss: 23.517 Vali Acc: 0.821 Test Loss: 23.517 Test Acc: 0.821
Validation loss decreased (-0.785765 --> -0.820574).  Saving model ...
Epoch: 17 cost time: 16.013042211532593
Epoch: 17, Steps: 34 | Train Loss: 4.967 Vali Loss: 22.379 Vali Acc: 0.815 Test Loss: 22.379 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.447877645492554
Epoch: 18, Steps: 34 | Train Loss: 3.576 Vali Loss: 34.467 Vali Acc: 0.798 Test Loss: 34.467 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 16.023418188095093
Epoch: 19, Steps: 34 | Train Loss: 2.607 Vali Loss: 28.210 Vali Acc: 0.844 Test Loss: 28.210 Test Acc: 0.844
Validation loss decreased (-0.820574 --> -0.843649).  Saving model ...
Epoch: 20 cost time: 15.165374279022217
Epoch: 20, Steps: 34 | Train Loss: 2.751 Vali Loss: 78.669 Vali Acc: 0.705 Test Loss: 78.669 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 18.115763187408447
Epoch: 21, Steps: 34 | Train Loss: 14.318 Vali Loss: 52.976 Vali Acc: 0.694 Test Loss: 52.976 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.717366456985474
Epoch: 22, Steps: 34 | Train Loss: 4.935 Vali Loss: 39.796 Vali Acc: 0.751 Test Loss: 39.796 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 17.424177885055542
Epoch: 23, Steps: 34 | Train Loss: 2.103 Vali Loss: 48.448 Vali Acc: 0.780 Test Loss: 48.448 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 18.383473873138428
Epoch: 24, Steps: 34 | Train Loss: 2.356 Vali Loss: 38.166 Vali Acc: 0.798 Test Loss: 38.166 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 18.960829734802246
Epoch: 25, Steps: 34 | Train Loss: 0.652 Vali Loss: 38.281 Vali Acc: 0.798 Test Loss: 38.281 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 18.106751203536987
Epoch: 26, Steps: 34 | Train Loss: 0.618 Vali Loss: 32.494 Vali Acc: 0.798 Test Loss: 32.494 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 17.06133484840393
Epoch: 27, Steps: 34 | Train Loss: 0.293 Vali Loss: 58.458 Vali Acc: 0.717 Test Loss: 58.458 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 17.055004596710205
Epoch: 28, Steps: 34 | Train Loss: 5.034 Vali Loss: 31.650 Vali Acc: 0.775 Test Loss: 31.650 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 16.409654140472412
Epoch: 29, Steps: 34 | Train Loss: 2.117 Vali Loss: 28.782 Vali Acc: 0.780 Test Loss: 28.782 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 19266603
model size : 78.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.126417636871338
Epoch: 1, Steps: 34 | Train Loss: 27.461 Vali Loss: 31.348 Vali Acc: 0.370 Test Loss: 31.348 Test Acc: 0.370
Validation loss decreased (inf --> -0.369629).  Saving model ...
Epoch: 2 cost time: 15.122272253036499
Epoch: 2, Steps: 34 | Train Loss: 38.184 Vali Loss: 56.545 Vali Acc: 0.382 Test Loss: 56.545 Test Acc: 0.382
Validation loss decreased (-0.369629 --> -0.380937).  Saving model ...
Epoch: 3 cost time: 16.42162322998047
Epoch: 3, Steps: 34 | Train Loss: 49.923 Vali Loss: 44.003 Vali Acc: 0.474 Test Loss: 44.003 Test Acc: 0.474
Validation loss decreased (-0.380937 --> -0.473548).  Saving model ...
Epoch: 4 cost time: 17.153753757476807
Epoch: 4, Steps: 34 | Train Loss: 44.838 Vali Loss: 64.345 Vali Acc: 0.405 Test Loss: 64.345 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.573658466339111
Epoch: 5, Steps: 34 | Train Loss: 33.049 Vali Loss: 35.476 Vali Acc: 0.624 Test Loss: 35.476 Test Acc: 0.624
Validation loss decreased (-0.473548 --> -0.623923).  Saving model ...
Epoch: 6 cost time: 18.256826400756836
Epoch: 6, Steps: 34 | Train Loss: 42.056 Vali Loss: 60.694 Vali Acc: 0.572 Test Loss: 60.694 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.08190608024597
Epoch: 7, Steps: 34 | Train Loss: 22.314 Vali Loss: 26.351 Vali Acc: 0.653 Test Loss: 26.351 Test Acc: 0.653
Validation loss decreased (-0.623923 --> -0.652916).  Saving model ...
Epoch: 8 cost time: 17.34365963935852
Epoch: 8, Steps: 34 | Train Loss: 22.232 Vali Loss: 53.970 Vali Acc: 0.497 Test Loss: 53.970 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.340325355529785
Epoch: 9, Steps: 34 | Train Loss: 6.470 Vali Loss: 24.722 Vali Acc: 0.653 Test Loss: 24.722 Test Acc: 0.653
Validation loss decreased (-0.652916 --> -0.652932).  Saving model ...
Epoch: 10 cost time: 16.940038204193115
Epoch: 10, Steps: 34 | Train Loss: 12.704 Vali Loss: 30.298 Vali Acc: 0.740 Test Loss: 30.298 Test Acc: 0.740
Validation loss decreased (-0.652932 --> -0.739581).  Saving model ...
Epoch: 11 cost time: 16.75069522857666
Epoch: 11, Steps: 34 | Train Loss: 6.176 Vali Loss: 27.857 Vali Acc: 0.751 Test Loss: 27.857 Test Acc: 0.751
Validation loss decreased (-0.739581 --> -0.751167).  Saving model ...
Epoch: 12 cost time: 16.90598750114441
Epoch: 12, Steps: 34 | Train Loss: 6.803 Vali Loss: 36.472 Vali Acc: 0.728 Test Loss: 36.472 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.695576906204224
Epoch: 13, Steps: 34 | Train Loss: 6.038 Vali Loss: 22.137 Vali Acc: 0.780 Test Loss: 22.137 Test Acc: 0.780
Validation loss decreased (-0.751167 --> -0.780125).  Saving model ...
Epoch: 14 cost time: 15.810511589050293
Epoch: 14, Steps: 34 | Train Loss: 6.719 Vali Loss: 72.452 Vali Acc: 0.578 Test Loss: 72.452 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.906172513961792
Epoch: 15, Steps: 34 | Train Loss: 2.349 Vali Loss: 37.351 Vali Acc: 0.723 Test Loss: 37.351 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.771511554718018
Epoch: 16, Steps: 34 | Train Loss: 3.086 Vali Loss: 19.689 Vali Acc: 0.798 Test Loss: 19.689 Test Acc: 0.798
Validation loss decreased (-0.780125 --> -0.797491).  Saving model ...
Epoch: 17 cost time: 16.75912570953369
Epoch: 17, Steps: 34 | Train Loss: 4.572 Vali Loss: 46.098 Vali Acc: 0.728 Test Loss: 46.098 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.220108032226562
Epoch: 18, Steps: 34 | Train Loss: 4.473 Vali Loss: 31.598 Vali Acc: 0.780 Test Loss: 31.598 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.20788264274597
Epoch: 19, Steps: 34 | Train Loss: 0.608 Vali Loss: 24.937 Vali Acc: 0.792 Test Loss: 24.937 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.8279128074646
Epoch: 20, Steps: 34 | Train Loss: 0.988 Vali Loss: 28.736 Vali Acc: 0.803 Test Loss: 28.736 Test Acc: 0.803
Validation loss decreased (-0.797491 --> -0.803181).  Saving model ...
Epoch: 21 cost time: 17.628522872924805
Epoch: 21, Steps: 34 | Train Loss: 3.413 Vali Loss: 77.950 Vali Acc: 0.613 Test Loss: 77.950 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 19.453178644180298
Epoch: 22, Steps: 34 | Train Loss: 7.411 Vali Loss: 37.531 Vali Acc: 0.734 Test Loss: 37.531 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 16.52373743057251
Epoch: 23, Steps: 34 | Train Loss: 4.638 Vali Loss: 31.239 Vali Acc: 0.775 Test Loss: 31.239 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 16.044230222702026
Epoch: 24, Steps: 34 | Train Loss: 8.103 Vali Loss: 46.015 Vali Acc: 0.636 Test Loss: 46.015 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 13.318397760391235
Epoch: 25, Steps: 34 | Train Loss: 2.659 Vali Loss: 48.337 Vali Acc: 0.642 Test Loss: 48.337 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.993440389633179
Epoch: 26, Steps: 34 | Train Loss: 2.780 Vali Loss: 29.142 Vali Acc: 0.757 Test Loss: 29.142 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.305207252502441
Epoch: 27, Steps: 34 | Train Loss: 1.724 Vali Loss: 43.787 Vali Acc: 0.775 Test Loss: 43.787 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 13.785701990127563
Epoch: 28, Steps: 34 | Train Loss: 4.192 Vali Loss: 52.738 Vali Acc: 0.740 Test Loss: 52.738 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 14.172602415084839
Epoch: 29, Steps: 34 | Train Loss: 2.528 Vali Loss: 30.433 Vali Acc: 0.798 Test Loss: 30.433 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 13.652186393737793
Epoch: 30, Steps: 34 | Train Loss: 2.216 Vali Loss: 18.778 Vali Acc: 0.850 Test Loss: 18.778 Test Acc: 0.850
Validation loss decreased (-0.803181 --> -0.849523).  Saving model ...
Epoch: 31 cost time: 14.271509885787964
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 20.981 Vali Acc: 0.855 Test Loss: 20.981 Test Acc: 0.855
Validation loss decreased (-0.849523 --> -0.855282).  Saving model ...
Epoch: 32 cost time: 13.082789897918701
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.371 Vali Acc: 0.855 Test Loss: 21.371 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 13.730658769607544
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 15.425502061843872
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 16.585962057113647
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 16.2361581325531
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 13.928592681884766
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 14.351887226104736
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 13.374406099319458
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 13.96242904663086
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 14.557361364364624
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.382 Vali Acc: 0.855 Test Loss: 21.382 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 18952107
model size : 77.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.700923919677734
Epoch: 1, Steps: 34 | Train Loss: 20.106 Vali Loss: 41.891 Vali Acc: 0.156 Test Loss: 41.891 Test Acc: 0.156
Validation loss decreased (inf --> -0.155650).  Saving model ...
Epoch: 2 cost time: 13.937911987304688
Epoch: 2, Steps: 34 | Train Loss: 41.475 Vali Loss: 72.043 Vali Acc: 0.405 Test Loss: 72.043 Test Acc: 0.405
Validation loss decreased (-0.155650 --> -0.403904).  Saving model ...
Epoch: 3 cost time: 12.508944034576416
Epoch: 3, Steps: 34 | Train Loss: 38.038 Vali Loss: 45.345 Vali Acc: 0.497 Test Loss: 45.345 Test Acc: 0.497
Validation loss decreased (-0.403904 --> -0.496656).  Saving model ...
Epoch: 4 cost time: 13.60279655456543
Epoch: 4, Steps: 34 | Train Loss: 30.325 Vali Loss: 23.102 Vali Acc: 0.497 Test Loss: 23.102 Test Acc: 0.497
Validation loss decreased (-0.496656 --> -0.496879).  Saving model ...
Epoch: 5 cost time: 15.185730695724487
Epoch: 5, Steps: 34 | Train Loss: 32.972 Vali Loss: 91.112 Vali Acc: 0.439 Test Loss: 91.112 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.3814754486084
Epoch: 6, Steps: 34 | Train Loss: 51.837 Vali Loss: 35.408 Vali Acc: 0.676 Test Loss: 35.408 Test Acc: 0.676
Validation loss decreased (-0.496879 --> -0.675946).  Saving model ...
Epoch: 7 cost time: 15.118353843688965
Epoch: 7, Steps: 34 | Train Loss: 29.116 Vali Loss: 32.483 Vali Acc: 0.647 Test Loss: 32.483 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.063517808914185
Epoch: 8, Steps: 34 | Train Loss: 24.666 Vali Loss: 54.571 Vali Acc: 0.653 Test Loss: 54.571 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.57237696647644
Epoch: 9, Steps: 34 | Train Loss: 17.795 Vali Loss: 48.617 Vali Acc: 0.630 Test Loss: 48.617 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.890923023223877
Epoch: 10, Steps: 34 | Train Loss: 7.860 Vali Loss: 30.097 Vali Acc: 0.746 Test Loss: 30.097 Test Acc: 0.746
Validation loss decreased (-0.675946 --> -0.745364).  Saving model ...
Epoch: 11 cost time: 13.63309931755066
Epoch: 11, Steps: 34 | Train Loss: 8.412 Vali Loss: 29.439 Vali Acc: 0.728 Test Loss: 29.439 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.697427034378052
Epoch: 12, Steps: 34 | Train Loss: 8.442 Vali Loss: 28.517 Vali Acc: 0.751 Test Loss: 28.517 Test Acc: 0.751
Validation loss decreased (-0.745364 --> -0.751160).  Saving model ...
Epoch: 13 cost time: 13.42303204536438
Epoch: 13, Steps: 34 | Train Loss: 9.100 Vali Loss: 35.894 Vali Acc: 0.699 Test Loss: 35.894 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.570943832397461
Epoch: 14, Steps: 34 | Train Loss: 7.150 Vali Loss: 25.547 Vali Acc: 0.786 Test Loss: 25.547 Test Acc: 0.786
Validation loss decreased (-0.751160 --> -0.785872).  Saving model ...
Epoch: 15 cost time: 14.453200340270996
Epoch: 15, Steps: 34 | Train Loss: 9.138 Vali Loss: 20.732 Vali Acc: 0.821 Test Loss: 20.732 Test Acc: 0.821
Validation loss decreased (-0.785872 --> -0.820602).  Saving model ...
Epoch: 16 cost time: 13.365008354187012
Epoch: 16, Steps: 34 | Train Loss: 3.842 Vali Loss: 19.600 Vali Acc: 0.792 Test Loss: 19.600 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.51534652709961
Epoch: 17, Steps: 34 | Train Loss: 5.610 Vali Loss: 30.024 Vali Acc: 0.780 Test Loss: 30.024 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.427093029022217
Epoch: 18, Steps: 34 | Train Loss: 5.609 Vali Loss: 31.508 Vali Acc: 0.740 Test Loss: 31.508 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.575365781784058
Epoch: 19, Steps: 34 | Train Loss: 3.723 Vali Loss: 51.937 Vali Acc: 0.723 Test Loss: 51.937 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.093312978744507
Epoch: 20, Steps: 34 | Train Loss: 3.145 Vali Loss: 43.944 Vali Acc: 0.757 Test Loss: 43.944 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.555303812026978
Epoch: 21, Steps: 34 | Train Loss: 9.988 Vali Loss: 27.209 Vali Acc: 0.798 Test Loss: 27.209 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 13.304708003997803
Epoch: 22, Steps: 34 | Train Loss: 6.818 Vali Loss: 33.470 Vali Acc: 0.775 Test Loss: 33.470 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 14.082859754562378
Epoch: 23, Steps: 34 | Train Loss: 1.658 Vali Loss: 84.579 Vali Acc: 0.682 Test Loss: 84.579 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 13.420605897903442
Epoch: 24, Steps: 34 | Train Loss: 5.589 Vali Loss: 25.847 Vali Acc: 0.769 Test Loss: 25.847 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.180383205413818
Epoch: 25, Steps: 34 | Train Loss: 3.372 Vali Loss: 28.152 Vali Acc: 0.746 Test Loss: 28.152 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 18947499
model size : 77.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.872994184494019
Epoch: 1, Steps: 34 | Train Loss: 24.439 Vali Loss: 23.254 Vali Acc: 0.410 Test Loss: 23.254 Test Acc: 0.410
Validation loss decreased (inf --> -0.410172).  Saving model ...
Epoch: 2 cost time: 13.72533392906189
Epoch: 2, Steps: 34 | Train Loss: 37.191 Vali Loss: 29.200 Vali Acc: 0.410 Test Loss: 29.200 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.574867725372314
Epoch: 3, Steps: 34 | Train Loss: 26.897 Vali Loss: 37.623 Vali Acc: 0.457 Test Loss: 37.623 Test Acc: 0.457
Validation loss decreased (-0.410172 --> -0.456271).  Saving model ...
Epoch: 4 cost time: 13.867405414581299
Epoch: 4, Steps: 34 | Train Loss: 40.777 Vali Loss: 49.270 Vali Acc: 0.543 Test Loss: 49.270 Test Acc: 0.543
Validation loss decreased (-0.456271 --> -0.542860).  Saving model ...
Epoch: 5 cost time: 13.599018573760986
Epoch: 5, Steps: 34 | Train Loss: 27.732 Vali Loss: 31.345 Vali Acc: 0.578 Test Loss: 31.345 Test Acc: 0.578
Validation loss decreased (-0.542860 --> -0.577721).  Saving model ...
Epoch: 6 cost time: 16.383098602294922
Epoch: 6, Steps: 34 | Train Loss: 19.610 Vali Loss: 80.109 Vali Acc: 0.462 Test Loss: 80.109 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.343649864196777
Epoch: 7, Steps: 34 | Train Loss: 32.252 Vali Loss: 27.894 Vali Acc: 0.613 Test Loss: 27.894 Test Acc: 0.613
Validation loss decreased (-0.577721 --> -0.612438).  Saving model ...
Epoch: 8 cost time: 15.587227582931519
Epoch: 8, Steps: 34 | Train Loss: 26.661 Vali Loss: 91.751 Vali Acc: 0.590 Test Loss: 91.751 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.24895691871643
Epoch: 9, Steps: 34 | Train Loss: 24.506 Vali Loss: 26.420 Vali Acc: 0.740 Test Loss: 26.420 Test Acc: 0.740
Validation loss decreased (-0.612438 --> -0.739620).  Saving model ...
Epoch: 10 cost time: 14.321063995361328
Epoch: 10, Steps: 34 | Train Loss: 6.903 Vali Loss: 44.118 Vali Acc: 0.618 Test Loss: 44.118 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.026461839675903
Epoch: 11, Steps: 34 | Train Loss: 12.959 Vali Loss: 35.940 Vali Acc: 0.705 Test Loss: 35.940 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.180727243423462
Epoch: 12, Steps: 34 | Train Loss: 7.062 Vali Loss: 48.023 Vali Acc: 0.746 Test Loss: 48.023 Test Acc: 0.746
Validation loss decreased (-0.739620 --> -0.745185).  Saving model ...
Epoch: 13 cost time: 14.720047950744629
Epoch: 13, Steps: 34 | Train Loss: 4.030 Vali Loss: 27.502 Vali Acc: 0.786 Test Loss: 27.502 Test Acc: 0.786
Validation loss decreased (-0.745185 --> -0.785852).  Saving model ...
Epoch: 14 cost time: 13.713305711746216
Epoch: 14, Steps: 34 | Train Loss: 4.117 Vali Loss: 16.359 Vali Acc: 0.827 Test Loss: 16.359 Test Acc: 0.827
Validation loss decreased (-0.785852 --> -0.826426).  Saving model ...
Epoch: 15 cost time: 13.859683275222778
Epoch: 15, Steps: 34 | Train Loss: 3.281 Vali Loss: 31.032 Vali Acc: 0.763 Test Loss: 31.032 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.814980030059814
Epoch: 16, Steps: 34 | Train Loss: 7.177 Vali Loss: 41.662 Vali Acc: 0.711 Test Loss: 41.662 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.246515989303589
Epoch: 17, Steps: 34 | Train Loss: 6.590 Vali Loss: 37.998 Vali Acc: 0.746 Test Loss: 37.998 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.592429637908936
Epoch: 18, Steps: 34 | Train Loss: 3.757 Vali Loss: 18.346 Vali Acc: 0.803 Test Loss: 18.346 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.804343938827515
Epoch: 19, Steps: 34 | Train Loss: 1.237 Vali Loss: 47.893 Vali Acc: 0.694 Test Loss: 47.893 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.549860715866089
Epoch: 20, Steps: 34 | Train Loss: 1.298 Vali Loss: 53.303 Vali Acc: 0.740 Test Loss: 53.303 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.414948463439941
Epoch: 21, Steps: 34 | Train Loss: 0.941 Vali Loss: 52.765 Vali Acc: 0.613 Test Loss: 52.765 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 16.994696140289307
Epoch: 22, Steps: 34 | Train Loss: 3.452 Vali Loss: 53.740 Vali Acc: 0.723 Test Loss: 53.740 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 13.881009578704834
Epoch: 23, Steps: 34 | Train Loss: 3.522 Vali Loss: 28.049 Vali Acc: 0.786 Test Loss: 28.049 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.3392653465271
Epoch: 24, Steps: 34 | Train Loss: 6.751 Vali Loss: 64.025 Vali Acc: 0.665 Test Loss: 64.025 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 18942891
model size : 77.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.735736846923828
Epoch: 1, Steps: 34 | Train Loss: 25.642 Vali Loss: 47.249 Vali Acc: 0.191 Test Loss: 47.249 Test Acc: 0.191
Validation loss decreased (inf --> -0.190279).  Saving model ...
Epoch: 2 cost time: 13.920627355575562
Epoch: 2, Steps: 34 | Train Loss: 31.150 Vali Loss: 30.130 Vali Acc: 0.474 Test Loss: 30.130 Test Acc: 0.474
Validation loss decreased (-0.190279 --> -0.473687).  Saving model ...
Epoch: 3 cost time: 14.113523483276367
Epoch: 3, Steps: 34 | Train Loss: 53.272 Vali Loss: 66.268 Vali Acc: 0.243 Test Loss: 66.268 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.755236148834229
Epoch: 4, Steps: 34 | Train Loss: 39.576 Vali Loss: 98.030 Vali Acc: 0.503 Test Loss: 98.030 Test Acc: 0.503
Validation loss decreased (-0.473687 --> -0.501910).  Saving model ...
Epoch: 5 cost time: 14.612542390823364
Epoch: 5, Steps: 34 | Train Loss: 37.310 Vali Loss: 91.360 Vali Acc: 0.422 Test Loss: 91.360 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.594486474990845
Epoch: 6, Steps: 34 | Train Loss: 46.250 Vali Loss: 69.746 Vali Acc: 0.468 Test Loss: 69.746 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.872779607772827
Epoch: 7, Steps: 34 | Train Loss: 34.597 Vali Loss: 30.176 Vali Acc: 0.723 Test Loss: 30.176 Test Acc: 0.723
Validation loss decreased (-0.501910 --> -0.722242).  Saving model ...
Epoch: 8 cost time: 15.72961974143982
Epoch: 8, Steps: 34 | Train Loss: 17.458 Vali Loss: 39.384 Vali Acc: 0.613 Test Loss: 39.384 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.210436582565308
Epoch: 9, Steps: 34 | Train Loss: 10.243 Vali Loss: 41.355 Vali Acc: 0.636 Test Loss: 41.355 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.622633457183838
Epoch: 10, Steps: 34 | Train Loss: 8.863 Vali Loss: 50.992 Vali Acc: 0.659 Test Loss: 50.992 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.620984554290771
Epoch: 11, Steps: 34 | Train Loss: 5.013 Vali Loss: 28.409 Vali Acc: 0.711 Test Loss: 28.409 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.051252365112305
Epoch: 12, Steps: 34 | Train Loss: 6.260 Vali Loss: 41.794 Vali Acc: 0.676 Test Loss: 41.794 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.856340408325195
Epoch: 13, Steps: 34 | Train Loss: 9.009 Vali Loss: 44.202 Vali Acc: 0.728 Test Loss: 44.202 Test Acc: 0.728
Validation loss decreased (-0.722242 --> -0.727882).  Saving model ...
Epoch: 14 cost time: 13.853968620300293
Epoch: 14, Steps: 34 | Train Loss: 4.338 Vali Loss: 45.690 Vali Acc: 0.682 Test Loss: 45.690 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.795082330703735
Epoch: 15, Steps: 34 | Train Loss: 3.708 Vali Loss: 35.485 Vali Acc: 0.792 Test Loss: 35.485 Test Acc: 0.792
Validation loss decreased (-0.727882 --> -0.791553).  Saving model ...
Epoch: 16 cost time: 13.705234050750732
Epoch: 16, Steps: 34 | Train Loss: 2.372 Vali Loss: 29.770 Vali Acc: 0.775 Test Loss: 29.770 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.032840490341187
Epoch: 17, Steps: 34 | Train Loss: 6.739 Vali Loss: 23.074 Vali Acc: 0.809 Test Loss: 23.074 Test Acc: 0.809
Validation loss decreased (-0.791553 --> -0.809018).  Saving model ...
Epoch: 18 cost time: 14.055169105529785
Epoch: 18, Steps: 34 | Train Loss: 4.483 Vali Loss: 57.195 Vali Acc: 0.717 Test Loss: 57.195 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 13.0467529296875
Epoch: 19, Steps: 34 | Train Loss: 1.924 Vali Loss: 63.387 Vali Acc: 0.699 Test Loss: 63.387 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 13.293840885162354
Epoch: 20, Steps: 34 | Train Loss: 3.846 Vali Loss: 45.243 Vali Acc: 0.751 Test Loss: 45.243 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 14.242596626281738
Epoch: 21, Steps: 34 | Train Loss: 3.058 Vali Loss: 24.465 Vali Acc: 0.809 Test Loss: 24.465 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 15.041747093200684
Epoch: 22, Steps: 34 | Train Loss: 6.233 Vali Loss: 21.334 Vali Acc: 0.815 Test Loss: 21.334 Test Acc: 0.815
Validation loss decreased (-0.809018 --> -0.814816).  Saving model ...
Epoch: 23 cost time: 14.877135038375854
Epoch: 23, Steps: 34 | Train Loss: 12.377 Vali Loss: 89.394 Vali Acc: 0.491 Test Loss: 89.394 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 15.794696807861328
Epoch: 24, Steps: 34 | Train Loss: 12.801 Vali Loss: 33.421 Vali Acc: 0.780 Test Loss: 33.421 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 15.116180419921875
Epoch: 25, Steps: 34 | Train Loss: 3.838 Vali Loss: 40.527 Vali Acc: 0.786 Test Loss: 40.527 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 14.014755487442017
Epoch: 26, Steps: 34 | Train Loss: 3.472 Vali Loss: 25.369 Vali Acc: 0.786 Test Loss: 25.369 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 13.44141173362732
Epoch: 27, Steps: 34 | Train Loss: 2.171 Vali Loss: 35.120 Vali Acc: 0.809 Test Loss: 35.120 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.868355512619019
Epoch: 28, Steps: 34 | Train Loss: 2.713 Vali Loss: 21.570 Vali Acc: 0.832 Test Loss: 21.570 Test Acc: 0.832
Validation loss decreased (-0.814816 --> -0.832154).  Saving model ...
Epoch: 29 cost time: 14.07826280593872
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.381 Vali Acc: 0.798 Test Loss: 29.381 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 13.616853713989258
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.478 Vali Acc: 0.803 Test Loss: 29.478 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 13.695856094360352
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.480 Vali Acc: 0.803 Test Loss: 29.480 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 13.39945387840271
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.400 Vali Acc: 0.792 Test Loss: 27.400 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 13.211193799972534
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.617 Vali Acc: 0.792 Test Loss: 27.617 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 13.561779260635376
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.623 Vali Acc: 0.792 Test Loss: 27.623 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 13.924759864807129
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.623 Vali Acc: 0.792 Test Loss: 27.623 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 14.459458827972412
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.623 Vali Acc: 0.792 Test Loss: 27.623 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 15.058870553970337
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.623 Vali Acc: 0.792 Test Loss: 27.623 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 15.778282880783081
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.623 Vali Acc: 0.792 Test Loss: 27.623 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 18938283
model size : 77.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.849102258682251
Epoch: 1, Steps: 34 | Train Loss: 13.289 Vali Loss: 27.996 Vali Acc: 0.266 Test Loss: 27.996 Test Acc: 0.266
Validation loss decreased (inf --> -0.265616).  Saving model ...
Epoch: 2 cost time: 11.440149068832397
Epoch: 2, Steps: 34 | Train Loss: 15.607 Vali Loss: 16.100 Vali Acc: 0.341 Test Loss: 16.100 Test Acc: 0.341
Validation loss decreased (-0.265616 --> -0.340879).  Saving model ...
Epoch: 3 cost time: 11.012454748153687
Epoch: 3, Steps: 34 | Train Loss: 15.893 Vali Loss: 39.076 Vali Acc: 0.428 Test Loss: 39.076 Test Acc: 0.428
Validation loss decreased (-0.340879 --> -0.427355).  Saving model ...
Epoch: 4 cost time: 11.01291799545288
Epoch: 4, Steps: 34 | Train Loss: 24.269 Vali Loss: 19.082 Vali Acc: 0.445 Test Loss: 19.082 Test Acc: 0.445
Validation loss decreased (-0.427355 --> -0.444896).  Saving model ...
Epoch: 5 cost time: 11.159004211425781
Epoch: 5, Steps: 34 | Train Loss: 14.391 Vali Loss: 25.517 Vali Acc: 0.486 Test Loss: 25.517 Test Acc: 0.486
Validation loss decreased (-0.444896 --> -0.485294).  Saving model ...
Epoch: 6 cost time: 11.42291784286499
Epoch: 6, Steps: 34 | Train Loss: 13.464 Vali Loss: 23.808 Vali Acc: 0.578 Test Loss: 23.808 Test Acc: 0.578
Validation loss decreased (-0.485294 --> -0.577797).  Saving model ...
Epoch: 7 cost time: 10.289638757705688
Epoch: 7, Steps: 34 | Train Loss: 9.656 Vali Loss: 8.131 Vali Acc: 0.694 Test Loss: 8.131 Test Acc: 0.694
Validation loss decreased (-0.577797 --> -0.693560).  Saving model ...
Epoch: 8 cost time: 11.3457510471344
Epoch: 8, Steps: 34 | Train Loss: 1.858 Vali Loss: 12.124 Vali Acc: 0.705 Test Loss: 12.124 Test Acc: 0.705
Validation loss decreased (-0.693560 --> -0.705081).  Saving model ...
Epoch: 9 cost time: 12.012403964996338
Epoch: 9, Steps: 34 | Train Loss: 4.444 Vali Loss: 12.157 Vali Acc: 0.757 Test Loss: 12.157 Test Acc: 0.757
Validation loss decreased (-0.705081 --> -0.757104).  Saving model ...
Epoch: 10 cost time: 11.657309293746948
Epoch: 10, Steps: 34 | Train Loss: 3.282 Vali Loss: 6.677 Vali Acc: 0.815 Test Loss: 6.677 Test Acc: 0.815
Validation loss decreased (-0.757104 --> -0.814962).  Saving model ...
Epoch: 11 cost time: 11.708318710327148
Epoch: 11, Steps: 34 | Train Loss: 1.455 Vali Loss: 9.836 Vali Acc: 0.746 Test Loss: 9.836 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.266356468200684
Epoch: 12, Steps: 34 | Train Loss: 0.693 Vali Loss: 6.659 Vali Acc: 0.803 Test Loss: 6.659 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.874627351760864
Epoch: 13, Steps: 34 | Train Loss: 1.108 Vali Loss: 11.044 Vali Acc: 0.803 Test Loss: 11.044 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.933226346969604
Epoch: 14, Steps: 34 | Train Loss: 2.006 Vali Loss: 14.022 Vali Acc: 0.734 Test Loss: 14.022 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.916764974594116
Epoch: 15, Steps: 34 | Train Loss: 2.192 Vali Loss: 15.757 Vali Acc: 0.647 Test Loss: 15.757 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.12975001335144
Epoch: 16, Steps: 34 | Train Loss: 2.351 Vali Loss: 13.311 Vali Acc: 0.740 Test Loss: 13.311 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.802254915237427
Epoch: 17, Steps: 34 | Train Loss: 0.746 Vali Loss: 12.547 Vali Acc: 0.757 Test Loss: 12.547 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.572925329208374
Epoch: 18, Steps: 34 | Train Loss: 0.671 Vali Loss: 16.515 Vali Acc: 0.676 Test Loss: 16.515 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.618410587310791
Epoch: 19, Steps: 34 | Train Loss: 1.612 Vali Loss: 14.749 Vali Acc: 0.763 Test Loss: 14.749 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.230347156524658
Epoch: 20, Steps: 34 | Train Loss: 0.331 Vali Loss: 16.727 Vali Acc: 0.740 Test Loss: 16.727 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 9317035
model size : 38.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.182118892669678
Epoch: 1, Steps: 34 | Train Loss: 14.472 Vali Loss: 24.652 Vali Acc: 0.393 Test Loss: 24.652 Test Acc: 0.393
Validation loss decreased (inf --> -0.392817).  Saving model ...
Epoch: 2 cost time: 11.38689112663269
Epoch: 2, Steps: 34 | Train Loss: 15.409 Vali Loss: 26.671 Vali Acc: 0.301 Test Loss: 26.671 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.908330202102661
Epoch: 3, Steps: 34 | Train Loss: 23.974 Vali Loss: 50.300 Vali Acc: 0.243 Test Loss: 50.300 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.468702554702759
Epoch: 4, Steps: 34 | Train Loss: 20.787 Vali Loss: 27.977 Vali Acc: 0.405 Test Loss: 27.977 Test Acc: 0.405
Validation loss decreased (-0.392817 --> -0.404345).  Saving model ...
Epoch: 5 cost time: 11.303483724594116
Epoch: 5, Steps: 34 | Train Loss: 15.362 Vali Loss: 25.467 Vali Acc: 0.514 Test Loss: 25.467 Test Acc: 0.514
Validation loss decreased (-0.404345 --> -0.514196).  Saving model ...
Epoch: 6 cost time: 11.576294898986816
Epoch: 6, Steps: 34 | Train Loss: 12.933 Vali Loss: 5.401 Vali Acc: 0.723 Test Loss: 5.401 Test Acc: 0.723
Validation loss decreased (-0.514196 --> -0.722489).  Saving model ...
Epoch: 7 cost time: 12.460883855819702
Epoch: 7, Steps: 34 | Train Loss: 5.398 Vali Loss: 44.307 Vali Acc: 0.301 Test Loss: 44.307 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.494767189025879
Epoch: 8, Steps: 34 | Train Loss: 7.069 Vali Loss: 7.811 Vali Acc: 0.723 Test Loss: 7.811 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.43779993057251
Epoch: 9, Steps: 34 | Train Loss: 6.515 Vali Loss: 29.654 Vali Acc: 0.462 Test Loss: 29.654 Test Acc: 0.462
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.968900203704834
Epoch: 10, Steps: 34 | Train Loss: 6.599 Vali Loss: 11.318 Vali Acc: 0.728 Test Loss: 11.318 Test Acc: 0.728
Validation loss decreased (-0.722489 --> -0.728211).  Saving model ...
Epoch: 11 cost time: 13.302265167236328
Epoch: 11, Steps: 34 | Train Loss: 3.886 Vali Loss: 19.412 Vali Acc: 0.630 Test Loss: 19.412 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.311402797698975
Epoch: 12, Steps: 34 | Train Loss: 2.482 Vali Loss: 12.048 Vali Acc: 0.717 Test Loss: 12.048 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.624794244766235
Epoch: 13, Steps: 34 | Train Loss: 4.631 Vali Loss: 11.742 Vali Acc: 0.751 Test Loss: 11.742 Test Acc: 0.751
Validation loss decreased (-0.728211 --> -0.751328).  Saving model ...
Epoch: 14 cost time: 12.050516843795776
Epoch: 14, Steps: 34 | Train Loss: 1.309 Vali Loss: 8.597 Vali Acc: 0.821 Test Loss: 8.597 Test Acc: 0.821
Validation loss decreased (-0.751328 --> -0.820723).  Saving model ...
Epoch: 15 cost time: 11.792531251907349
Epoch: 15, Steps: 34 | Train Loss: 1.204 Vali Loss: 13.023 Vali Acc: 0.809 Test Loss: 13.023 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.146812677383423
Epoch: 16, Steps: 34 | Train Loss: 1.342 Vali Loss: 13.060 Vali Acc: 0.803 Test Loss: 13.060 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.319857597351074
Epoch: 17, Steps: 34 | Train Loss: 1.789 Vali Loss: 14.371 Vali Acc: 0.798 Test Loss: 14.371 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.929556846618652
Epoch: 18, Steps: 34 | Train Loss: 1.066 Vali Loss: 15.370 Vali Acc: 0.786 Test Loss: 15.370 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.751219987869263
Epoch: 19, Steps: 34 | Train Loss: 0.281 Vali Loss: 16.581 Vali Acc: 0.746 Test Loss: 16.581 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.508683204650879
Epoch: 20, Steps: 34 | Train Loss: 0.524 Vali Loss: 11.447 Vali Acc: 0.792 Test Loss: 11.447 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.522931575775146
Epoch: 21, Steps: 34 | Train Loss: 0.181 Vali Loss: 14.612 Vali Acc: 0.757 Test Loss: 14.612 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.679041862487793
Epoch: 22, Steps: 34 | Train Loss: 2.173 Vali Loss: 15.980 Vali Acc: 0.827 Test Loss: 15.980 Test Acc: 0.827
Validation loss decreased (-0.820723 --> -0.826430).  Saving model ...
Epoch: 23 cost time: 12.91004753112793
Epoch: 23, Steps: 34 | Train Loss: 1.677 Vali Loss: 22.942 Vali Acc: 0.671 Test Loss: 22.942 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.375755071640015
Epoch: 24, Steps: 34 | Train Loss: 1.404 Vali Loss: 13.072 Vali Acc: 0.798 Test Loss: 13.072 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 13.876580953598022
Epoch: 25, Steps: 34 | Train Loss: 0.673 Vali Loss: 14.416 Vali Acc: 0.763 Test Loss: 14.416 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.713604211807251
Epoch: 26, Steps: 34 | Train Loss: 0.390 Vali Loss: 10.923 Vali Acc: 0.792 Test Loss: 10.923 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.926414489746094
Epoch: 27, Steps: 34 | Train Loss: 0.884 Vali Loss: 29.746 Vali Acc: 0.717 Test Loss: 29.746 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.080405473709106
Epoch: 28, Steps: 34 | Train Loss: 3.101 Vali Loss: 28.943 Vali Acc: 0.728 Test Loss: 28.943 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 11.24855661392212
Epoch: 29, Steps: 34 | Train Loss: 0.925 Vali Loss: 16.995 Vali Acc: 0.798 Test Loss: 16.995 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.450259923934937
Epoch: 30, Steps: 34 | Train Loss: 1.157 Vali Loss: 21.011 Vali Acc: 0.763 Test Loss: 21.011 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 11.17297077178955
Epoch: 31, Steps: 34 | Train Loss: 1.173 Vali Loss: 10.332 Vali Acc: 0.832 Test Loss: 10.332 Test Acc: 0.832
Validation loss decreased (-0.826430 --> -0.832267).  Saving model ...
Epoch: 32 cost time: 12.088289737701416
Epoch: 32, Steps: 34 | Train Loss: 0.916 Vali Loss: 34.212 Vali Acc: 0.751 Test Loss: 34.212 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 11.558837652206421
Epoch: 33, Steps: 34 | Train Loss: 2.188 Vali Loss: 23.957 Vali Acc: 0.798 Test Loss: 23.957 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 11.691118240356445
Epoch: 34, Steps: 34 | Train Loss: 3.020 Vali Loss: 33.373 Vali Acc: 0.671 Test Loss: 33.373 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 12.06176209449768
Epoch: 35, Steps: 34 | Train Loss: 1.870 Vali Loss: 16.817 Vali Acc: 0.740 Test Loss: 16.817 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 11.915518760681152
Epoch: 36, Steps: 34 | Train Loss: 1.212 Vali Loss: 21.996 Vali Acc: 0.751 Test Loss: 21.996 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 11.441832304000854
Epoch: 37, Steps: 34 | Train Loss: 1.366 Vali Loss: 19.805 Vali Acc: 0.699 Test Loss: 19.805 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 11.559849262237549
Epoch: 38, Steps: 34 | Train Loss: 1.049 Vali Loss: 29.815 Vali Acc: 0.740 Test Loss: 29.815 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 13.904277801513672
Epoch: 39, Steps: 34 | Train Loss: 0.776 Vali Loss: 22.483 Vali Acc: 0.769 Test Loss: 22.483 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 12.7758150100708
Epoch: 40, Steps: 34 | Train Loss: 0.256 Vali Loss: 21.947 Vali Acc: 0.798 Test Loss: 21.947 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 12.949808359146118
Epoch: 41, Steps: 34 | Train Loss: 1.307 Vali Loss: 17.676 Vali Acc: 0.815 Test Loss: 17.676 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 9314731
model size : 38.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.137939453125
Epoch: 1, Steps: 34 | Train Loss: 6.901 Vali Loss: 25.056 Vali Acc: 0.254 Test Loss: 25.056 Test Acc: 0.254
Validation loss decreased (inf --> -0.254085).  Saving model ...
Epoch: 2 cost time: 11.490704536437988
Epoch: 2, Steps: 34 | Train Loss: 25.499 Vali Loss: 19.083 Vali Acc: 0.393 Test Loss: 19.083 Test Acc: 0.393
Validation loss decreased (-0.254085 --> -0.392873).  Saving model ...
Epoch: 3 cost time: 11.3219633102417
Epoch: 3, Steps: 34 | Train Loss: 32.283 Vali Loss: 36.001 Vali Acc: 0.341 Test Loss: 36.001 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.43345856666565
Epoch: 4, Steps: 34 | Train Loss: 17.846 Vali Loss: 27.284 Vali Acc: 0.503 Test Loss: 27.284 Test Acc: 0.503
Validation loss decreased (-0.392873 --> -0.502617).  Saving model ...
Epoch: 5 cost time: 11.085959196090698
Epoch: 5, Steps: 34 | Train Loss: 19.323 Vali Loss: 14.984 Vali Acc: 0.682 Test Loss: 14.984 Test Acc: 0.682
Validation loss decreased (-0.502617 --> -0.681931).  Saving model ...
Epoch: 6 cost time: 11.522211074829102
Epoch: 6, Steps: 34 | Train Loss: 9.918 Vali Loss: 17.538 Vali Acc: 0.601 Test Loss: 17.538 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.763924598693848
Epoch: 7, Steps: 34 | Train Loss: 9.891 Vali Loss: 13.568 Vali Acc: 0.699 Test Loss: 13.568 Test Acc: 0.699
Validation loss decreased (-0.681931 --> -0.699286).  Saving model ...
Epoch: 8 cost time: 10.711171627044678
Epoch: 8, Steps: 34 | Train Loss: 6.853 Vali Loss: 23.833 Vali Acc: 0.601 Test Loss: 23.833 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.0402090549469
Epoch: 9, Steps: 34 | Train Loss: 7.361 Vali Loss: 13.547 Vali Acc: 0.723 Test Loss: 13.547 Test Acc: 0.723
Validation loss decreased (-0.699286 --> -0.722408).  Saving model ...
Epoch: 10 cost time: 11.526212215423584
Epoch: 10, Steps: 34 | Train Loss: 3.811 Vali Loss: 23.041 Vali Acc: 0.665 Test Loss: 23.041 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.213877201080322
Epoch: 11, Steps: 34 | Train Loss: 6.242 Vali Loss: 29.890 Vali Acc: 0.676 Test Loss: 29.890 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.2199227809906
Epoch: 12, Steps: 34 | Train Loss: 6.662 Vali Loss: 24.898 Vali Acc: 0.624 Test Loss: 24.898 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.207929134368896
Epoch: 13, Steps: 34 | Train Loss: 5.528 Vali Loss: 17.961 Vali Acc: 0.671 Test Loss: 17.961 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.856650352478027
Epoch: 14, Steps: 34 | Train Loss: 1.800 Vali Loss: 11.081 Vali Acc: 0.786 Test Loss: 11.081 Test Acc: 0.786
Validation loss decreased (-0.722408 --> -0.786016).  Saving model ...
Epoch: 15 cost time: 12.663641691207886
Epoch: 15, Steps: 34 | Train Loss: 0.963 Vali Loss: 14.217 Vali Acc: 0.786 Test Loss: 14.217 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.094885349273682
Epoch: 16, Steps: 34 | Train Loss: 0.627 Vali Loss: 18.910 Vali Acc: 0.763 Test Loss: 18.910 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.804982662200928
Epoch: 17, Steps: 34 | Train Loss: 0.343 Vali Loss: 8.713 Vali Acc: 0.815 Test Loss: 8.713 Test Acc: 0.815
Validation loss decreased (-0.786016 --> -0.814942).  Saving model ...
Epoch: 18 cost time: 11.428961753845215
Epoch: 18, Steps: 34 | Train Loss: 0.751 Vali Loss: 17.001 Vali Acc: 0.769 Test Loss: 17.001 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.588419198989868
Epoch: 19, Steps: 34 | Train Loss: 0.357 Vali Loss: 13.361 Vali Acc: 0.775 Test Loss: 13.361 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.146606206893921
Epoch: 20, Steps: 34 | Train Loss: 0.429 Vali Loss: 14.152 Vali Acc: 0.803 Test Loss: 14.152 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.755278825759888
Epoch: 21, Steps: 34 | Train Loss: 1.773 Vali Loss: 20.999 Vali Acc: 0.699 Test Loss: 20.999 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.642241716384888
Epoch: 22, Steps: 34 | Train Loss: 2.345 Vali Loss: 16.991 Vali Acc: 0.769 Test Loss: 16.991 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.167935848236084
Epoch: 23, Steps: 34 | Train Loss: 6.308 Vali Loss: 32.728 Vali Acc: 0.618 Test Loss: 32.728 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.289197444915771
Epoch: 24, Steps: 34 | Train Loss: 3.761 Vali Loss: 12.893 Vali Acc: 0.798 Test Loss: 12.893 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.040572166442871
Epoch: 25, Steps: 34 | Train Loss: 5.253 Vali Loss: 14.793 Vali Acc: 0.780 Test Loss: 14.793 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.571300268173218
Epoch: 26, Steps: 34 | Train Loss: 0.773 Vali Loss: 18.436 Vali Acc: 0.728 Test Loss: 18.436 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.93631362915039
Epoch: 27, Steps: 34 | Train Loss: 1.547 Vali Loss: 15.184 Vali Acc: 0.798 Test Loss: 15.184 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 9312427
model size : 38.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.792658805847168
Epoch: 1, Steps: 34 | Train Loss: 11.301 Vali Loss: 3.889 Vali Acc: 0.457 Test Loss: 3.889 Test Acc: 0.457
Validation loss decreased (inf --> -0.456609).  Saving model ...
Epoch: 2 cost time: 13.45274043083191
Epoch: 2, Steps: 34 | Train Loss: 13.804 Vali Loss: 18.351 Vali Acc: 0.277 Test Loss: 18.351 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.832489728927612
Epoch: 3, Steps: 34 | Train Loss: 18.426 Vali Loss: 28.536 Vali Acc: 0.387 Test Loss: 28.536 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.547335863113403
Epoch: 4, Steps: 34 | Train Loss: 17.029 Vali Loss: 27.422 Vali Acc: 0.543 Test Loss: 27.422 Test Acc: 0.543
Validation loss decreased (-0.456609 --> -0.543078).  Saving model ...
Epoch: 5 cost time: 10.898109436035156
Epoch: 5, Steps: 34 | Train Loss: 14.115 Vali Loss: 23.385 Vali Acc: 0.462 Test Loss: 23.385 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.6334228515625
Epoch: 6, Steps: 34 | Train Loss: 12.141 Vali Loss: 23.736 Vali Acc: 0.422 Test Loss: 23.736 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.549630641937256
Epoch: 7, Steps: 34 | Train Loss: 8.011 Vali Loss: 18.330 Vali Acc: 0.665 Test Loss: 18.330 Test Acc: 0.665
Validation loss decreased (-0.543078 --> -0.664557).  Saving model ...
Epoch: 8 cost time: 10.545340061187744
Epoch: 8, Steps: 34 | Train Loss: 6.065 Vali Loss: 18.893 Vali Acc: 0.659 Test Loss: 18.893 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.044373750686646
Epoch: 9, Steps: 34 | Train Loss: 3.761 Vali Loss: 12.248 Vali Acc: 0.688 Test Loss: 12.248 Test Acc: 0.688
Validation loss decreased (-0.664557 --> -0.687739).  Saving model ...
Epoch: 10 cost time: 10.894203424453735
Epoch: 10, Steps: 34 | Train Loss: 4.456 Vali Loss: 25.459 Vali Acc: 0.526 Test Loss: 25.459 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.749351978302002
Epoch: 11, Steps: 34 | Train Loss: 3.892 Vali Loss: 18.149 Vali Acc: 0.717 Test Loss: 18.149 Test Acc: 0.717
Validation loss decreased (-0.687739 --> -0.716582).  Saving model ...
Epoch: 12 cost time: 10.175212144851685
Epoch: 12, Steps: 34 | Train Loss: 2.298 Vali Loss: 9.462 Vali Acc: 0.798 Test Loss: 9.462 Test Acc: 0.798
Validation loss decreased (-0.716582 --> -0.797593).  Saving model ...
Epoch: 13 cost time: 10.801288366317749
Epoch: 13, Steps: 34 | Train Loss: 2.238 Vali Loss: 16.353 Vali Acc: 0.775 Test Loss: 16.353 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.421918869018555
Epoch: 14, Steps: 34 | Train Loss: 3.033 Vali Loss: 18.684 Vali Acc: 0.780 Test Loss: 18.684 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.93549919128418
Epoch: 15, Steps: 34 | Train Loss: 2.285 Vali Loss: 26.925 Vali Acc: 0.682 Test Loss: 26.925 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.624859094619751
Epoch: 16, Steps: 34 | Train Loss: 8.248 Vali Loss: 20.432 Vali Acc: 0.728 Test Loss: 20.432 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.779426574707031
Epoch: 17, Steps: 34 | Train Loss: 2.917 Vali Loss: 15.149 Vali Acc: 0.728 Test Loss: 15.149 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.37921953201294
Epoch: 18, Steps: 34 | Train Loss: 6.884 Vali Loss: 11.798 Vali Acc: 0.775 Test Loss: 11.798 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.985560894012451
Epoch: 19, Steps: 34 | Train Loss: 1.931 Vali Loss: 15.977 Vali Acc: 0.792 Test Loss: 15.977 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.66750192642212
Epoch: 20, Steps: 34 | Train Loss: 0.620 Vali Loss: 24.193 Vali Acc: 0.734 Test Loss: 24.193 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.38242506980896
Epoch: 21, Steps: 34 | Train Loss: 0.895 Vali Loss: 23.614 Vali Acc: 0.757 Test Loss: 23.614 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.043987035751343
Epoch: 22, Steps: 34 | Train Loss: 0.694 Vali Loss: 24.906 Vali Acc: 0.734 Test Loss: 24.906 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 9310123
model size : 38.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.354770421981812
Epoch: 1, Steps: 34 | Train Loss: 10.413 Vali Loss: 17.119 Vali Acc: 0.324 Test Loss: 17.119 Test Acc: 0.324
Validation loss decreased (inf --> -0.323528).  Saving model ...
Epoch: 2 cost time: 9.52390432357788
Epoch: 2, Steps: 34 | Train Loss: 13.250 Vali Loss: 7.098 Vali Acc: 0.520 Test Loss: 7.098 Test Acc: 0.520
Validation loss decreased (-0.323528 --> -0.520160).  Saving model ...
Epoch: 3 cost time: 9.761502027511597
Epoch: 3, Steps: 34 | Train Loss: 17.231 Vali Loss: 17.680 Vali Acc: 0.503 Test Loss: 17.680 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.123551607131958
Epoch: 4, Steps: 34 | Train Loss: 13.346 Vali Loss: 17.160 Vali Acc: 0.520 Test Loss: 17.160 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.634806871414185
Epoch: 5, Steps: 34 | Train Loss: 15.983 Vali Loss: 33.188 Vali Acc: 0.491 Test Loss: 33.188 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.877335786819458
Epoch: 6, Steps: 34 | Train Loss: 18.231 Vali Loss: 18.587 Vali Acc: 0.578 Test Loss: 18.587 Test Acc: 0.578
Validation loss decreased (-0.520160 --> -0.577849).  Saving model ...
Epoch: 7 cost time: 9.876350402832031
Epoch: 7, Steps: 34 | Train Loss: 9.735 Vali Loss: 20.572 Vali Acc: 0.688 Test Loss: 20.572 Test Acc: 0.688
Validation loss decreased (-0.577849 --> -0.687656).  Saving model ...
Epoch: 8 cost time: 9.691098690032959
Epoch: 8, Steps: 34 | Train Loss: 15.098 Vali Loss: 39.762 Vali Acc: 0.491 Test Loss: 39.762 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.651123523712158
Epoch: 9, Steps: 34 | Train Loss: 11.654 Vali Loss: 20.245 Vali Acc: 0.595 Test Loss: 20.245 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.900333881378174
Epoch: 10, Steps: 34 | Train Loss: 4.173 Vali Loss: 11.096 Vali Acc: 0.763 Test Loss: 11.096 Test Acc: 0.763
Validation loss decreased (-0.687656 --> -0.762895).  Saving model ...
Epoch: 11 cost time: 11.40787959098816
Epoch: 11, Steps: 34 | Train Loss: 2.745 Vali Loss: 13.554 Vali Acc: 0.746 Test Loss: 13.554 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.091310024261475
Epoch: 12, Steps: 34 | Train Loss: 1.619 Vali Loss: 7.043 Vali Acc: 0.821 Test Loss: 7.043 Test Acc: 0.821
Validation loss decreased (-0.762895 --> -0.820739).  Saving model ...
Epoch: 13 cost time: 10.616341590881348
Epoch: 13, Steps: 34 | Train Loss: 1.646 Vali Loss: 10.290 Vali Acc: 0.769 Test Loss: 10.290 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.578978538513184
Epoch: 14, Steps: 34 | Train Loss: 3.458 Vali Loss: 34.900 Vali Acc: 0.694 Test Loss: 34.900 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.270011186599731
Epoch: 15, Steps: 34 | Train Loss: 6.920 Vali Loss: 29.442 Vali Acc: 0.769 Test Loss: 29.442 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.562676429748535
Epoch: 16, Steps: 34 | Train Loss: 2.672 Vali Loss: 20.199 Vali Acc: 0.734 Test Loss: 20.199 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.061986207962036
Epoch: 17, Steps: 34 | Train Loss: 1.005 Vali Loss: 41.760 Vali Acc: 0.659 Test Loss: 41.760 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.903939247131348
Epoch: 18, Steps: 34 | Train Loss: 5.564 Vali Loss: 12.350 Vali Acc: 0.827 Test Loss: 12.350 Test Acc: 0.827
Validation loss decreased (-0.820739 --> -0.826466).  Saving model ...
Epoch: 19 cost time: 9.994314432144165
Epoch: 19, Steps: 34 | Train Loss: 1.451 Vali Loss: 23.498 Vali Acc: 0.746 Test Loss: 23.498 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.96408748626709
Epoch: 20, Steps: 34 | Train Loss: 1.199 Vali Loss: 19.478 Vali Acc: 0.757 Test Loss: 19.478 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.825825691223145
Epoch: 21, Steps: 34 | Train Loss: 1.774 Vali Loss: 26.987 Vali Acc: 0.751 Test Loss: 26.987 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.263433933258057
Epoch: 22, Steps: 34 | Train Loss: 3.497 Vali Loss: 34.138 Vali Acc: 0.723 Test Loss: 34.138 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.9440016746521
Epoch: 23, Steps: 34 | Train Loss: 0.787 Vali Loss: 15.656 Vali Acc: 0.803 Test Loss: 15.656 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.860097646713257
Epoch: 24, Steps: 34 | Train Loss: 0.719 Vali Loss: 16.449 Vali Acc: 0.809 Test Loss: 16.449 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.80612850189209
Epoch: 25, Steps: 34 | Train Loss: 0.509 Vali Loss: 21.269 Vali Acc: 0.780 Test Loss: 21.269 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 10.0321204662323
Epoch: 26, Steps: 34 | Train Loss: 0.331 Vali Loss: 18.819 Vali Acc: 0.815 Test Loss: 18.819 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.353225231170654
Epoch: 27, Steps: 34 | Train Loss: 0.146 Vali Loss: 20.978 Vali Acc: 0.786 Test Loss: 20.978 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 11.005505323410034
Epoch: 28, Steps: 34 | Train Loss: 1.873 Vali Loss: 26.262 Vali Acc: 0.763 Test Loss: 26.262 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 8659115
model size : 35.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.855638980865479
Epoch: 1, Steps: 34 | Train Loss: 12.690 Vali Loss: 23.324 Vali Acc: 0.335 Test Loss: 23.324 Test Acc: 0.335
Validation loss decreased (inf --> -0.335027).  Saving model ...
Epoch: 2 cost time: 9.653158187866211
Epoch: 2, Steps: 34 | Train Loss: 21.052 Vali Loss: 22.350 Vali Acc: 0.364 Test Loss: 22.350 Test Acc: 0.364
Validation loss decreased (-0.335027 --> -0.363938).  Saving model ...
Epoch: 3 cost time: 9.858231544494629
Epoch: 3, Steps: 34 | Train Loss: 16.927 Vali Loss: 26.145 Vali Acc: 0.393 Test Loss: 26.145 Test Acc: 0.393
Validation loss decreased (-0.363938 --> -0.392802).  Saving model ...
Epoch: 4 cost time: 10.115259885787964
Epoch: 4, Steps: 34 | Train Loss: 19.591 Vali Loss: 21.525 Vali Acc: 0.451 Test Loss: 21.525 Test Acc: 0.451
Validation loss decreased (-0.392802 --> -0.450652).  Saving model ...
Epoch: 5 cost time: 9.870978355407715
Epoch: 5, Steps: 34 | Train Loss: 11.742 Vali Loss: 25.426 Vali Acc: 0.538 Test Loss: 25.426 Test Acc: 0.538
Validation loss decreased (-0.450652 --> -0.537318).  Saving model ...
Epoch: 6 cost time: 9.615816116333008
Epoch: 6, Steps: 34 | Train Loss: 10.232 Vali Loss: 27.684 Vali Acc: 0.624 Test Loss: 27.684 Test Acc: 0.624
Validation loss decreased (-0.537318 --> -0.624001).  Saving model ...
Epoch: 7 cost time: 10.359140157699585
Epoch: 7, Steps: 34 | Train Loss: 10.438 Vali Loss: 16.826 Vali Acc: 0.723 Test Loss: 16.826 Test Acc: 0.723
Validation loss decreased (-0.624001 --> -0.722375).  Saving model ...
Epoch: 8 cost time: 9.938651084899902
Epoch: 8, Steps: 34 | Train Loss: 8.410 Vali Loss: 9.855 Vali Acc: 0.624 Test Loss: 9.855 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.62743353843689
Epoch: 9, Steps: 34 | Train Loss: 8.395 Vali Loss: 29.084 Vali Acc: 0.543 Test Loss: 29.084 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.848785161972046
Epoch: 10, Steps: 34 | Train Loss: 7.732 Vali Loss: 15.870 Vali Acc: 0.734 Test Loss: 15.870 Test Acc: 0.734
Validation loss decreased (-0.722375 --> -0.733945).  Saving model ...
Epoch: 11 cost time: 10.206979036331177
Epoch: 11, Steps: 34 | Train Loss: 3.283 Vali Loss: 21.531 Vali Acc: 0.642 Test Loss: 21.531 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.55809211730957
Epoch: 12, Steps: 34 | Train Loss: 6.089 Vali Loss: 11.721 Vali Acc: 0.717 Test Loss: 11.721 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.698149919509888
Epoch: 13, Steps: 34 | Train Loss: 1.565 Vali Loss: 22.093 Vali Acc: 0.624 Test Loss: 22.093 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.132650375366211
Epoch: 14, Steps: 34 | Train Loss: 3.167 Vali Loss: 42.372 Vali Acc: 0.630 Test Loss: 42.372 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.419576644897461
Epoch: 15, Steps: 34 | Train Loss: 2.142 Vali Loss: 24.152 Vali Acc: 0.659 Test Loss: 24.152 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.105083465576172
Epoch: 16, Steps: 34 | Train Loss: 2.405 Vali Loss: 38.412 Vali Acc: 0.636 Test Loss: 38.412 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.798100471496582
Epoch: 17, Steps: 34 | Train Loss: 1.877 Vali Loss: 25.072 Vali Acc: 0.769 Test Loss: 25.072 Test Acc: 0.769
Validation loss decreased (-0.733945 --> -0.768535).  Saving model ...
Epoch: 18 cost time: 11.245025157928467
Epoch: 18, Steps: 34 | Train Loss: 2.533 Vali Loss: 14.508 Vali Acc: 0.844 Test Loss: 14.508 Test Acc: 0.844
Validation loss decreased (-0.768535 --> -0.843786).  Saving model ...
Epoch: 19 cost time: 9.451539278030396
Epoch: 19, Steps: 34 | Train Loss: 0.892 Vali Loss: 33.290 Vali Acc: 0.769 Test Loss: 33.290 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.95274019241333
Epoch: 20, Steps: 34 | Train Loss: 2.041 Vali Loss: 13.499 Vali Acc: 0.838 Test Loss: 13.499 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.055976629257202
Epoch: 21, Steps: 34 | Train Loss: 1.371 Vali Loss: 14.441 Vali Acc: 0.792 Test Loss: 14.441 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.420876502990723
Epoch: 22, Steps: 34 | Train Loss: 1.766 Vali Loss: 23.140 Vali Acc: 0.780 Test Loss: 23.140 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.906322479248047
Epoch: 23, Steps: 34 | Train Loss: 2.554 Vali Loss: 10.816 Vali Acc: 0.798 Test Loss: 10.816 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.741756439208984
Epoch: 24, Steps: 34 | Train Loss: 2.196 Vali Loss: 31.313 Vali Acc: 0.717 Test Loss: 31.313 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 10.058727502822876
Epoch: 25, Steps: 34 | Train Loss: 1.301 Vali Loss: 13.065 Vali Acc: 0.838 Test Loss: 13.065 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.907482624053955
Epoch: 26, Steps: 34 | Train Loss: 1.208 Vali Loss: 22.234 Vali Acc: 0.717 Test Loss: 22.234 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.840141534805298
Epoch: 27, Steps: 34 | Train Loss: 0.326 Vali Loss: 22.467 Vali Acc: 0.757 Test Loss: 22.467 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.54056978225708
Epoch: 28, Steps: 34 | Train Loss: 0.042 Vali Loss: 21.755 Vali Acc: 0.769 Test Loss: 21.755 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 8656811
model size : 35.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.562158346176147
Epoch: 1, Steps: 34 | Train Loss: 11.360 Vali Loss: 9.909 Vali Acc: 0.341 Test Loss: 9.909 Test Acc: 0.341
Validation loss decreased (inf --> -0.340941).  Saving model ...
Epoch: 2 cost time: 11.875977516174316
Epoch: 2, Steps: 34 | Train Loss: 13.183 Vali Loss: 18.453 Vali Acc: 0.439 Test Loss: 18.453 Test Acc: 0.439
Validation loss decreased (-0.340941 --> -0.439122).  Saving model ...
Epoch: 3 cost time: 10.565150260925293
Epoch: 3, Steps: 34 | Train Loss: 15.098 Vali Loss: 11.136 Vali Acc: 0.642 Test Loss: 11.136 Test Acc: 0.642
Validation loss decreased (-0.439122 --> -0.641507).  Saving model ...
Epoch: 4 cost time: 11.185000896453857
Epoch: 4, Steps: 34 | Train Loss: 31.834 Vali Loss: 20.606 Vali Acc: 0.491 Test Loss: 20.606 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.833162307739258
Epoch: 5, Steps: 34 | Train Loss: 13.995 Vali Loss: 17.455 Vali Acc: 0.590 Test Loss: 17.455 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.04518175125122
Epoch: 6, Steps: 34 | Train Loss: 14.138 Vali Loss: 28.204 Vali Acc: 0.578 Test Loss: 28.204 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.975058317184448
Epoch: 7, Steps: 34 | Train Loss: 11.788 Vali Loss: 14.985 Vali Acc: 0.636 Test Loss: 14.985 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.814027547836304
Epoch: 8, Steps: 34 | Train Loss: 3.267 Vali Loss: 21.065 Vali Acc: 0.642 Test Loss: 21.065 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.856876134872437
Epoch: 9, Steps: 34 | Train Loss: 5.284 Vali Loss: 15.649 Vali Acc: 0.624 Test Loss: 15.649 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.017387628555298
Epoch: 10, Steps: 34 | Train Loss: 5.954 Vali Loss: 16.320 Vali Acc: 0.694 Test Loss: 16.320 Test Acc: 0.694
Validation loss decreased (-0.641507 --> -0.693478).  Saving model ...
Epoch: 11 cost time: 9.618390560150146
Epoch: 11, Steps: 34 | Train Loss: 3.151 Vali Loss: 16.031 Vali Acc: 0.659 Test Loss: 16.031 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.476705312728882
Epoch: 12, Steps: 34 | Train Loss: 3.438 Vali Loss: 8.642 Vali Acc: 0.815 Test Loss: 8.642 Test Acc: 0.815
Validation loss decreased (-0.693478 --> -0.814942).  Saving model ...
Epoch: 13 cost time: 9.812867403030396
Epoch: 13, Steps: 34 | Train Loss: 2.392 Vali Loss: 28.209 Vali Acc: 0.642 Test Loss: 28.209 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.92102837562561
Epoch: 14, Steps: 34 | Train Loss: 3.373 Vali Loss: 9.342 Vali Acc: 0.815 Test Loss: 9.342 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.650310277938843
Epoch: 15, Steps: 34 | Train Loss: 1.704 Vali Loss: 9.332 Vali Acc: 0.786 Test Loss: 9.332 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.756165981292725
Epoch: 16, Steps: 34 | Train Loss: 2.104 Vali Loss: 12.398 Vali Acc: 0.746 Test Loss: 12.398 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.877045154571533
Epoch: 17, Steps: 34 | Train Loss: 1.562 Vali Loss: 13.097 Vali Acc: 0.792 Test Loss: 13.097 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.994163036346436
Epoch: 18, Steps: 34 | Train Loss: 0.107 Vali Loss: 14.785 Vali Acc: 0.734 Test Loss: 14.785 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.679049015045166
Epoch: 19, Steps: 34 | Train Loss: 0.131 Vali Loss: 9.887 Vali Acc: 0.780 Test Loss: 9.887 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.00316858291626
Epoch: 20, Steps: 34 | Train Loss: 1.005 Vali Loss: 18.589 Vali Acc: 0.757 Test Loss: 18.589 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.25289511680603
Epoch: 21, Steps: 34 | Train Loss: 0.443 Vali Loss: 13.847 Vali Acc: 0.798 Test Loss: 13.847 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.703312158584595
Epoch: 22, Steps: 34 | Train Loss: 0.243 Vali Loss: 7.311 Vali Acc: 0.827 Test Loss: 7.311 Test Acc: 0.827
Validation loss decreased (-0.814942 --> -0.826516).  Saving model ...
Epoch: 23 cost time: 10.584264039993286
Epoch: 23, Steps: 34 | Train Loss: 0.368 Vali Loss: 12.910 Vali Acc: 0.815 Test Loss: 12.910 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.830616235733032
Epoch: 24, Steps: 34 | Train Loss: 0.765 Vali Loss: 18.409 Vali Acc: 0.769 Test Loss: 18.409 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.120271921157837
Epoch: 25, Steps: 34 | Train Loss: 1.123 Vali Loss: 9.425 Vali Acc: 0.815 Test Loss: 9.425 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.193908929824829
Epoch: 26, Steps: 34 | Train Loss: 0.278 Vali Loss: 8.562 Vali Acc: 0.827 Test Loss: 8.562 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.662497282028198
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.157 Vali Acc: 0.792 Test Loss: 10.157 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.531764268875122
Epoch: 28, Steps: 34 | Train Loss: 0.050 Vali Loss: 8.135 Vali Acc: 0.838 Test Loss: 8.135 Test Acc: 0.838
Validation loss decreased (-0.826516 --> -0.838069).  Saving model ...
Epoch: 29 cost time: 9.936825037002563
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.564 Vali Acc: 0.855 Test Loss: 7.564 Test Acc: 0.855
Validation loss decreased (-0.838069 --> -0.855416).  Saving model ...
Epoch: 30 cost time: 9.759629011154175
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.377 Vali Acc: 0.855 Test Loss: 7.377 Test Acc: 0.855
Validation loss decreased (-0.855416 --> -0.855418).  Saving model ...
Epoch: 31 cost time: 9.66067385673523
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 32 cost time: 9.741281270980835
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 33 cost time: 9.955801010131836
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 34 cost time: 9.904409885406494
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 35 cost time: 9.697898149490356
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 36 cost time: 11.204897165298462
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 37 cost time: 11.318777561187744
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 38 cost time: 9.911775350570679
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 11.186299085617065
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 11.241647720336914
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 41 cost time: 10.262764692306519
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 42 cost time: 9.494941473007202
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 43 cost time: 9.58133840560913
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 44 cost time: 9.96730661392212
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 45 cost time: 10.024333000183105
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 9.835888624191284
Epoch: 46, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 47 cost time: 9.581071376800537
Epoch: 47, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 48 cost time: 9.970844984054565
Epoch: 48, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 49 cost time: 10.004003524780273
Epoch: 49, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 50 cost time: 9.433852672576904
Epoch: 50, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 51 cost time: 9.959049224853516
Epoch: 51, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 52 cost time: 9.798755168914795
Epoch: 52, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 53 cost time: 11.52681016921997
Epoch: 53, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 54 cost time: 10.863521575927734
Epoch: 54, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 55 cost time: 10.444350004196167
Epoch: 55, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 56 cost time: 11.985682249069214
Epoch: 56, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 57 cost time: 11.259060621261597
Epoch: 57, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 58 cost time: 12.305058717727661
Epoch: 58, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 59 cost time: 12.497994661331177
Epoch: 59, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 60 cost time: 8.593706607818604
Epoch: 60, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 61 cost time: 10.02096939086914
Epoch: 61, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 62 cost time: 9.520705699920654
Epoch: 62, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 63 cost time: 9.697602033615112
Epoch: 63, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 64 cost time: 10.010775327682495
Epoch: 64, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 65 cost time: 9.757893562316895
Epoch: 65, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 9.332294702529907
Epoch: 66, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 9.824537515640259
Epoch: 67, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 10.084251403808594
Epoch: 68, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 10.063739776611328
Epoch: 69, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 9.639748334884644
Epoch: 70, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 71 cost time: 10.114099025726318
Epoch: 71, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 72 cost time: 10.064616203308105
Epoch: 72, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 73 cost time: 11.299830436706543
Epoch: 73, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 74 cost time: 11.382533311843872
Epoch: 74, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.372 Vali Acc: 0.855 Test Loss: 7.372 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 75 cost time: 11.65006160736084
Epoch: 75, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 76 cost time: 11.575514793395996
Epoch: 76, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 77 cost time: 10.932246685028076
Epoch: 77, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 78 cost time: 9.753804206848145
Epoch: 78, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 79 cost time: 10.134386777877808
Epoch: 79, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 80 cost time: 9.541369915008545
Epoch: 80, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 81 cost time: 9.65510106086731
Epoch: 81, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 82 cost time: 9.751646041870117
Epoch: 82, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
Validation loss decreased (-0.855418 --> -0.855418).  Saving model ...
Epoch: 83 cost time: 9.457590818405151
Epoch: 83, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 9.536569595336914
Epoch: 84, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 10.206639528274536
Epoch: 85, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 9.679818391799927
Epoch: 86, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 10.032584190368652
Epoch: 87, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 9.86506986618042
Epoch: 88, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 11.058909893035889
Epoch: 89, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 11.49781084060669
Epoch: 90, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 10.789813756942749
Epoch: 91, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 11.756038188934326
Epoch: 92, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.371 Vali Acc: 0.855 Test Loss: 7.371 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 8654507
model size : 35.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.22295355796814
Epoch: 1, Steps: 34 | Train Loss: 12.085 Vali Loss: 8.472 Vali Acc: 0.335 Test Loss: 8.472 Test Acc: 0.335
Validation loss decreased (inf --> -0.335175).  Saving model ...
Epoch: 2 cost time: 9.66838788986206
Epoch: 2, Steps: 34 | Train Loss: 12.965 Vali Loss: 32.962 Vali Acc: 0.277 Test Loss: 32.962 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.117387771606445
Epoch: 3, Steps: 34 | Train Loss: 17.025 Vali Loss: 14.476 Vali Acc: 0.503 Test Loss: 14.476 Test Acc: 0.503
Validation loss decreased (-0.335175 --> -0.502745).  Saving model ...
Epoch: 4 cost time: 9.598198175430298
Epoch: 4, Steps: 34 | Train Loss: 16.145 Vali Loss: 22.545 Vali Acc: 0.416 Test Loss: 22.545 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.434403657913208
Epoch: 5, Steps: 34 | Train Loss: 11.276 Vali Loss: 26.191 Vali Acc: 0.503 Test Loss: 26.191 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.96573519706726
Epoch: 6, Steps: 34 | Train Loss: 17.262 Vali Loss: 26.926 Vali Acc: 0.526 Test Loss: 26.926 Test Acc: 0.526
Validation loss decreased (-0.502745 --> -0.525742).  Saving model ...
Epoch: 7 cost time: 9.212306261062622
Epoch: 7, Steps: 34 | Train Loss: 11.478 Vali Loss: 60.810 Vali Acc: 0.364 Test Loss: 60.810 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.461614608764648
Epoch: 8, Steps: 34 | Train Loss: 12.826 Vali Loss: 13.174 Vali Acc: 0.711 Test Loss: 13.174 Test Acc: 0.711
Validation loss decreased (-0.525742 --> -0.710851).  Saving model ...
Epoch: 9 cost time: 9.610156774520874
Epoch: 9, Steps: 34 | Train Loss: 11.378 Vali Loss: 31.780 Vali Acc: 0.601 Test Loss: 31.780 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.115168571472168
Epoch: 10, Steps: 34 | Train Loss: 3.741 Vali Loss: 21.301 Vali Acc: 0.653 Test Loss: 21.301 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.439659118652344
Epoch: 11, Steps: 34 | Train Loss: 9.801 Vali Loss: 29.688 Vali Acc: 0.618 Test Loss: 29.688 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.233938455581665
Epoch: 12, Steps: 34 | Train Loss: 5.051 Vali Loss: 24.677 Vali Acc: 0.694 Test Loss: 24.677 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.175629138946533
Epoch: 13, Steps: 34 | Train Loss: 4.344 Vali Loss: 18.729 Vali Acc: 0.682 Test Loss: 18.729 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.42906904220581
Epoch: 14, Steps: 34 | Train Loss: 5.727 Vali Loss: 11.464 Vali Acc: 0.855 Test Loss: 11.464 Test Acc: 0.855
Validation loss decreased (-0.710851 --> -0.855377).  Saving model ...
Epoch: 15 cost time: 11.087079048156738
Epoch: 15, Steps: 34 | Train Loss: 5.355 Vali Loss: 29.700 Vali Acc: 0.659 Test Loss: 29.700 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.394752502441406
Epoch: 16, Steps: 34 | Train Loss: 2.485 Vali Loss: 9.083 Vali Acc: 0.821 Test Loss: 9.083 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.45663046836853
Epoch: 17, Steps: 34 | Train Loss: 2.493 Vali Loss: 25.287 Vali Acc: 0.717 Test Loss: 25.287 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.748464822769165
Epoch: 18, Steps: 34 | Train Loss: 0.713 Vali Loss: 15.535 Vali Acc: 0.775 Test Loss: 15.535 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.348149538040161
Epoch: 19, Steps: 34 | Train Loss: 0.286 Vali Loss: 27.847 Vali Acc: 0.769 Test Loss: 27.847 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.543816089630127
Epoch: 20, Steps: 34 | Train Loss: 2.216 Vali Loss: 19.578 Vali Acc: 0.699 Test Loss: 19.578 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.448891639709473
Epoch: 21, Steps: 34 | Train Loss: 1.556 Vali Loss: 24.562 Vali Acc: 0.757 Test Loss: 24.562 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.826109409332275
Epoch: 22, Steps: 34 | Train Loss: 0.351 Vali Loss: 39.033 Vali Acc: 0.613 Test Loss: 39.033 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.429815292358398
Epoch: 23, Steps: 34 | Train Loss: 2.852 Vali Loss: 16.201 Vali Acc: 0.780 Test Loss: 16.201 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.523483753204346
Epoch: 24, Steps: 34 | Train Loss: 1.682 Vali Loss: 14.462 Vali Acc: 0.803 Test Loss: 14.462 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 8652203
model size : 35.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.342345714569092
Epoch: 1, Steps: 34 | Train Loss: 11.406 Vali Loss: 8.286 Vali Acc: 0.231 Test Loss: 8.286 Test Acc: 0.231
Validation loss decreased (inf --> -0.231131).  Saving model ...
Epoch: 2 cost time: 8.686755657196045
Epoch: 2, Steps: 34 | Train Loss: 12.942 Vali Loss: 14.181 Vali Acc: 0.410 Test Loss: 14.181 Test Acc: 0.410
Validation loss decreased (-0.231131 --> -0.410263).  Saving model ...
Epoch: 3 cost time: 9.709795951843262
Epoch: 3, Steps: 34 | Train Loss: 17.749 Vali Loss: 40.838 Vali Acc: 0.353 Test Loss: 40.838 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.275072813034058
Epoch: 4, Steps: 34 | Train Loss: 32.409 Vali Loss: 37.929 Vali Acc: 0.497 Test Loss: 37.929 Test Acc: 0.497
Validation loss decreased (-0.410263 --> -0.496731).  Saving model ...
Epoch: 5 cost time: 10.967978954315186
Epoch: 5, Steps: 34 | Train Loss: 24.309 Vali Loss: 18.786 Vali Acc: 0.584 Test Loss: 18.786 Test Acc: 0.584
Validation loss decreased (-0.496731 --> -0.583627).  Saving model ...
Epoch: 6 cost time: 10.976877212524414
Epoch: 6, Steps: 34 | Train Loss: 22.721 Vali Loss: 52.303 Vali Acc: 0.364 Test Loss: 52.303 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.800196170806885
Epoch: 7, Steps: 34 | Train Loss: 20.480 Vali Loss: 17.849 Vali Acc: 0.590 Test Loss: 17.849 Test Acc: 0.590
Validation loss decreased (-0.583627 --> -0.589417).  Saving model ...
Epoch: 8 cost time: 10.011672019958496
Epoch: 8, Steps: 34 | Train Loss: 12.082 Vali Loss: 18.754 Vali Acc: 0.676 Test Loss: 18.754 Test Acc: 0.676
Validation loss decreased (-0.589417 --> -0.676113).  Saving model ...
Epoch: 9 cost time: 9.509498119354248
Epoch: 9, Steps: 34 | Train Loss: 9.434 Vali Loss: 32.410 Vali Acc: 0.647 Test Loss: 32.410 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.12588906288147
Epoch: 10, Steps: 34 | Train Loss: 8.305 Vali Loss: 25.244 Vali Acc: 0.624 Test Loss: 25.244 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.373713493347168
Epoch: 11, Steps: 34 | Train Loss: 9.581 Vali Loss: 41.820 Vali Acc: 0.497 Test Loss: 41.820 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.396734714508057
Epoch: 12, Steps: 34 | Train Loss: 10.214 Vali Loss: 20.601 Vali Acc: 0.792 Test Loss: 20.601 Test Acc: 0.792
Validation loss decreased (-0.676113 --> -0.791702).  Saving model ...
Epoch: 13 cost time: 9.440962791442871
Epoch: 13, Steps: 34 | Train Loss: 5.921 Vali Loss: 31.685 Vali Acc: 0.699 Test Loss: 31.685 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.257628917694092
Epoch: 14, Steps: 34 | Train Loss: 4.611 Vali Loss: 14.204 Vali Acc: 0.775 Test Loss: 14.204 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.22097110748291
Epoch: 15, Steps: 34 | Train Loss: 6.193 Vali Loss: 19.751 Vali Acc: 0.740 Test Loss: 19.751 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.602434396743774
Epoch: 16, Steps: 34 | Train Loss: 2.086 Vali Loss: 29.423 Vali Acc: 0.688 Test Loss: 29.423 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.508803606033325
Epoch: 17, Steps: 34 | Train Loss: 1.390 Vali Loss: 14.627 Vali Acc: 0.821 Test Loss: 14.627 Test Acc: 0.821
Validation loss decreased (-0.791702 --> -0.820663).  Saving model ...
Epoch: 18 cost time: 9.551269054412842
Epoch: 18, Steps: 34 | Train Loss: 3.949 Vali Loss: 30.133 Vali Acc: 0.688 Test Loss: 30.133 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.311429023742676
Epoch: 19, Steps: 34 | Train Loss: 0.908 Vali Loss: 15.175 Vali Acc: 0.821 Test Loss: 15.175 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.351769208908081
Epoch: 20, Steps: 34 | Train Loss: 0.580 Vali Loss: 52.401 Vali Acc: 0.653 Test Loss: 52.401 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.497134447097778
Epoch: 21, Steps: 34 | Train Loss: 2.067 Vali Loss: 61.618 Vali Acc: 0.642 Test Loss: 61.618 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.642690658569336
Epoch: 22, Steps: 34 | Train Loss: 1.334 Vali Loss: 18.801 Vali Acc: 0.769 Test Loss: 18.801 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.109841108322144
Epoch: 23, Steps: 34 | Train Loss: 1.980 Vali Loss: 25.019 Vali Acc: 0.728 Test Loss: 25.019 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.606029033660889
Epoch: 24, Steps: 34 | Train Loss: 0.417 Vali Loss: 50.199 Vali Acc: 0.694 Test Loss: 50.199 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.735100746154785
Epoch: 25, Steps: 34 | Train Loss: 1.985 Vali Loss: 16.053 Vali Acc: 0.769 Test Loss: 16.053 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.444454431533813
Epoch: 26, Steps: 34 | Train Loss: 1.588 Vali Loss: 18.358 Vali Acc: 0.786 Test Loss: 18.358 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.406866788864136
Epoch: 27, Steps: 34 | Train Loss: 0.732 Vali Loss: 20.308 Vali Acc: 0.757 Test Loss: 20.308 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 8330155
model size : 34.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.352733373641968
Epoch: 1, Steps: 34 | Train Loss: 14.073 Vali Loss: 15.888 Vali Acc: 0.353 Test Loss: 15.888 Test Acc: 0.353
Validation loss decreased (inf --> -0.352442).  Saving model ...
Epoch: 2 cost time: 9.528738498687744
Epoch: 2, Steps: 34 | Train Loss: 19.900 Vali Loss: 40.164 Vali Acc: 0.266 Test Loss: 40.164 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.360561609268188
Epoch: 3, Steps: 34 | Train Loss: 23.716 Vali Loss: 24.700 Vali Acc: 0.405 Test Loss: 24.700 Test Acc: 0.405
Validation loss decreased (-0.352442 --> -0.404377).  Saving model ...
Epoch: 4 cost time: 9.79026198387146
Epoch: 4, Steps: 34 | Train Loss: 21.595 Vali Loss: 28.447 Vali Acc: 0.566 Test Loss: 28.447 Test Acc: 0.566
Validation loss decreased (-0.404377 --> -0.566190).  Saving model ...
Epoch: 5 cost time: 9.66083312034607
Epoch: 5, Steps: 34 | Train Loss: 19.430 Vali Loss: 21.678 Vali Acc: 0.520 Test Loss: 21.678 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.380380630493164
Epoch: 6, Steps: 34 | Train Loss: 18.803 Vali Loss: 36.178 Vali Acc: 0.462 Test Loss: 36.178 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.565824747085571
Epoch: 7, Steps: 34 | Train Loss: 14.075 Vali Loss: 11.565 Vali Acc: 0.699 Test Loss: 11.565 Test Acc: 0.699
Validation loss decreased (-0.566190 --> -0.699306).  Saving model ...
Epoch: 8 cost time: 10.305727005004883
Epoch: 8, Steps: 34 | Train Loss: 8.772 Vali Loss: 27.804 Vali Acc: 0.636 Test Loss: 27.804 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.979485273361206
Epoch: 9, Steps: 34 | Train Loss: 7.862 Vali Loss: 24.633 Vali Acc: 0.613 Test Loss: 24.633 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.023554563522339
Epoch: 10, Steps: 34 | Train Loss: 10.140 Vali Loss: 36.839 Vali Acc: 0.509 Test Loss: 36.839 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.863501071929932
Epoch: 11, Steps: 34 | Train Loss: 6.994 Vali Loss: 15.654 Vali Acc: 0.740 Test Loss: 15.654 Test Acc: 0.740
Validation loss decreased (-0.699306 --> -0.739728).  Saving model ...
Epoch: 12 cost time: 11.725053787231445
Epoch: 12, Steps: 34 | Train Loss: 2.244 Vali Loss: 8.981 Vali Acc: 0.769 Test Loss: 8.981 Test Acc: 0.769
Validation loss decreased (-0.739728 --> -0.768696).  Saving model ...
Epoch: 13 cost time: 10.427875280380249
Epoch: 13, Steps: 34 | Train Loss: 3.098 Vali Loss: 17.904 Vali Acc: 0.734 Test Loss: 17.904 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.412709712982178
Epoch: 14, Steps: 34 | Train Loss: 1.773 Vali Loss: 8.566 Vali Acc: 0.803 Test Loss: 8.566 Test Acc: 0.803
Validation loss decreased (-0.768696 --> -0.803383).  Saving model ...
Epoch: 15 cost time: 9.30022644996643
Epoch: 15, Steps: 34 | Train Loss: 0.399 Vali Loss: 14.917 Vali Acc: 0.769 Test Loss: 14.917 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.949979782104492
Epoch: 16, Steps: 34 | Train Loss: 2.644 Vali Loss: 11.756 Vali Acc: 0.751 Test Loss: 11.756 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.835055112838745
Epoch: 17, Steps: 34 | Train Loss: 1.896 Vali Loss: 19.609 Vali Acc: 0.786 Test Loss: 19.609 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.326713800430298
Epoch: 18, Steps: 34 | Train Loss: 5.956 Vali Loss: 13.898 Vali Acc: 0.786 Test Loss: 13.898 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.421130895614624
Epoch: 19, Steps: 34 | Train Loss: 1.156 Vali Loss: 28.347 Vali Acc: 0.746 Test Loss: 28.347 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.116284608840942
Epoch: 20, Steps: 34 | Train Loss: 0.998 Vali Loss: 16.775 Vali Acc: 0.792 Test Loss: 16.775 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.623091697692871
Epoch: 21, Steps: 34 | Train Loss: 0.563 Vali Loss: 13.519 Vali Acc: 0.827 Test Loss: 13.519 Test Acc: 0.827
Validation loss decreased (-0.803383 --> -0.826454).  Saving model ...
Epoch: 22 cost time: 9.277443170547485
Epoch: 22, Steps: 34 | Train Loss: 0.718 Vali Loss: 18.882 Vali Acc: 0.746 Test Loss: 18.882 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.311233758926392
Epoch: 23, Steps: 34 | Train Loss: 0.602 Vali Loss: 11.903 Vali Acc: 0.855 Test Loss: 11.903 Test Acc: 0.855
Validation loss decreased (-0.826454 --> -0.855372).  Saving model ...
Epoch: 24 cost time: 9.64721941947937
Epoch: 24, Steps: 34 | Train Loss: 0.404 Vali Loss: 19.577 Vali Acc: 0.798 Test Loss: 19.577 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 9.62612795829773
Epoch: 25, Steps: 34 | Train Loss: 0.179 Vali Loss: 20.063 Vali Acc: 0.786 Test Loss: 20.063 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.122063875198364
Epoch: 26, Steps: 34 | Train Loss: 0.420 Vali Loss: 12.427 Vali Acc: 0.809 Test Loss: 12.427 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 10.546856164932251
Epoch: 27, Steps: 34 | Train Loss: 0.796 Vali Loss: 12.395 Vali Acc: 0.832 Test Loss: 12.395 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 11.395860433578491
Epoch: 28, Steps: 34 | Train Loss: 1.571 Vali Loss: 15.785 Vali Acc: 0.803 Test Loss: 15.785 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.951749801635742
Epoch: 29, Steps: 34 | Train Loss: 1.348 Vali Loss: 23.470 Vali Acc: 0.763 Test Loss: 23.470 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 11.15982460975647
Epoch: 30, Steps: 34 | Train Loss: 2.000 Vali Loss: 26.329 Vali Acc: 0.786 Test Loss: 26.329 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 9.405559062957764
Epoch: 31, Steps: 34 | Train Loss: 2.627 Vali Loss: 11.791 Vali Acc: 0.803 Test Loss: 11.791 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 9.318603515625
Epoch: 32, Steps: 34 | Train Loss: 1.164 Vali Loss: 15.369 Vali Acc: 0.775 Test Loss: 15.369 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 9.21542763710022
Epoch: 33, Steps: 34 | Train Loss: 0.614 Vali Loss: 7.672 Vali Acc: 0.873 Test Loss: 7.672 Test Acc: 0.873
Validation loss decreased (-0.855372 --> -0.872756).  Saving model ...
Epoch: 34 cost time: 9.453478336334229
Epoch: 34, Steps: 34 | Train Loss: 0.414 Vali Loss: 23.242 Vali Acc: 0.792 Test Loss: 23.242 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 9.667309522628784
Epoch: 35, Steps: 34 | Train Loss: 1.806 Vali Loss: 20.723 Vali Acc: 0.775 Test Loss: 20.723 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 9.329248666763306
Epoch: 36, Steps: 34 | Train Loss: 1.120 Vali Loss: 19.627 Vali Acc: 0.827 Test Loss: 19.627 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 8.89970874786377
Epoch: 37, Steps: 34 | Train Loss: 0.846 Vali Loss: 10.010 Vali Acc: 0.832 Test Loss: 10.010 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 9.691298246383667
Epoch: 38, Steps: 34 | Train Loss: 0.022 Vali Loss: 15.223 Vali Acc: 0.740 Test Loss: 15.223 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 9.764134645462036
Epoch: 39, Steps: 34 | Train Loss: 1.012 Vali Loss: 26.266 Vali Acc: 0.792 Test Loss: 26.266 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 9.287861824035645
Epoch: 40, Steps: 34 | Train Loss: 0.425 Vali Loss: 27.287 Vali Acc: 0.780 Test Loss: 27.287 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 9.250510215759277
Epoch: 41, Steps: 34 | Train Loss: 1.235 Vali Loss: 20.287 Vali Acc: 0.798 Test Loss: 20.287 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 9.387232542037964
Epoch: 42, Steps: 34 | Train Loss: 2.412 Vali Loss: 15.566 Vali Acc: 0.746 Test Loss: 15.566 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 11.124641180038452
Epoch: 43, Steps: 34 | Train Loss: 2.821 Vali Loss: 24.464 Vali Acc: 0.751 Test Loss: 24.464 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 8327851
model size : 34.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.385605096817017
Epoch: 1, Steps: 34 | Train Loss: 12.023 Vali Loss: 22.047 Vali Acc: 0.272 Test Loss: 22.047 Test Acc: 0.272
Validation loss decreased (inf --> -0.271456).  Saving model ...
Epoch: 2 cost time: 11.009464740753174
Epoch: 2, Steps: 34 | Train Loss: 21.926 Vali Loss: 27.689 Vali Acc: 0.306 Test Loss: 27.689 Test Acc: 0.306
Validation loss decreased (-0.271456 --> -0.306081).  Saving model ...
Epoch: 3 cost time: 10.132386445999146
Epoch: 3, Steps: 34 | Train Loss: 25.308 Vali Loss: 19.353 Vali Acc: 0.514 Test Loss: 19.353 Test Acc: 0.514
Validation loss decreased (-0.306081 --> -0.514257).  Saving model ...
Epoch: 4 cost time: 9.245085000991821
Epoch: 4, Steps: 34 | Train Loss: 14.472 Vali Loss: 12.735 Vali Acc: 0.590 Test Loss: 12.735 Test Acc: 0.590
Validation loss decreased (-0.514257 --> -0.589468).  Saving model ...
Epoch: 5 cost time: 9.476645231246948
Epoch: 5, Steps: 34 | Train Loss: 22.290 Vali Loss: 17.034 Vali Acc: 0.590 Test Loss: 17.034 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.379258394241333
Epoch: 6, Steps: 34 | Train Loss: 14.930 Vali Loss: 25.366 Vali Acc: 0.474 Test Loss: 25.366 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.425420761108398
Epoch: 7, Steps: 34 | Train Loss: 19.774 Vali Loss: 18.168 Vali Acc: 0.746 Test Loss: 18.168 Test Acc: 0.746
Validation loss decreased (-0.589468 --> -0.745483).  Saving model ...
Epoch: 8 cost time: 8.858514070510864
Epoch: 8, Steps: 34 | Train Loss: 6.389 Vali Loss: 19.452 Vali Acc: 0.676 Test Loss: 19.452 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.569886445999146
Epoch: 9, Steps: 34 | Train Loss: 11.642 Vali Loss: 16.856 Vali Acc: 0.676 Test Loss: 16.856 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.096877813339233
Epoch: 10, Steps: 34 | Train Loss: 9.846 Vali Loss: 48.169 Vali Acc: 0.578 Test Loss: 48.169 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.114089727401733
Epoch: 11, Steps: 34 | Train Loss: 9.154 Vali Loss: 15.615 Vali Acc: 0.694 Test Loss: 15.615 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.015608549118042
Epoch: 12, Steps: 34 | Train Loss: 3.183 Vali Loss: 11.324 Vali Acc: 0.827 Test Loss: 11.324 Test Acc: 0.827
Validation loss decreased (-0.745483 --> -0.826476).  Saving model ...
Epoch: 13 cost time: 9.57143783569336
Epoch: 13, Steps: 34 | Train Loss: 4.395 Vali Loss: 19.067 Vali Acc: 0.769 Test Loss: 19.067 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.453831911087036
Epoch: 14, Steps: 34 | Train Loss: 2.829 Vali Loss: 28.925 Vali Acc: 0.665 Test Loss: 28.925 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.268954277038574
Epoch: 15, Steps: 34 | Train Loss: 2.592 Vali Loss: 35.250 Vali Acc: 0.642 Test Loss: 35.250 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.660142421722412
Epoch: 16, Steps: 34 | Train Loss: 2.844 Vali Loss: 17.014 Vali Acc: 0.763 Test Loss: 17.014 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.138218879699707
Epoch: 17, Steps: 34 | Train Loss: 0.597 Vali Loss: 13.890 Vali Acc: 0.809 Test Loss: 13.890 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.640888452529907
Epoch: 18, Steps: 34 | Train Loss: 0.689 Vali Loss: 10.431 Vali Acc: 0.809 Test Loss: 10.431 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.454646825790405
Epoch: 19, Steps: 34 | Train Loss: 1.625 Vali Loss: 24.207 Vali Acc: 0.763 Test Loss: 24.207 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.992104291915894
Epoch: 20, Steps: 34 | Train Loss: 1.743 Vali Loss: 8.835 Vali Acc: 0.809 Test Loss: 8.835 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.645300388336182
Epoch: 21, Steps: 34 | Train Loss: 0.455 Vali Loss: 37.420 Vali Acc: 0.705 Test Loss: 37.420 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.501659393310547
Epoch: 22, Steps: 34 | Train Loss: 0.105 Vali Loss: 28.230 Vali Acc: 0.751 Test Loss: 28.230 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 8325547
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.792482614517212
Epoch: 1, Steps: 34 | Train Loss: 8.964 Vali Loss: 7.175 Vali Acc: 0.341 Test Loss: 7.175 Test Acc: 0.341
Validation loss decreased (inf --> -0.340969).  Saving model ...
Epoch: 2 cost time: 9.198312282562256
Epoch: 2, Steps: 34 | Train Loss: 12.722 Vali Loss: 17.823 Vali Acc: 0.382 Test Loss: 17.823 Test Acc: 0.382
Validation loss decreased (-0.340969 --> -0.381325).  Saving model ...
Epoch: 3 cost time: 9.140425205230713
Epoch: 3, Steps: 34 | Train Loss: 22.656 Vali Loss: 13.963 Vali Acc: 0.549 Test Loss: 13.963 Test Acc: 0.549
Validation loss decreased (-0.381325 --> -0.548993).  Saving model ...
Epoch: 4 cost time: 9.384201049804688
Epoch: 4, Steps: 34 | Train Loss: 14.571 Vali Loss: 10.421 Vali Acc: 0.601 Test Loss: 10.421 Test Acc: 0.601
Validation loss decreased (-0.548993 --> -0.601052).  Saving model ...
Epoch: 5 cost time: 9.409740686416626
Epoch: 5, Steps: 34 | Train Loss: 18.393 Vali Loss: 30.091 Vali Acc: 0.624 Test Loss: 30.091 Test Acc: 0.624
Validation loss decreased (-0.601052 --> -0.623977).  Saving model ...
Epoch: 6 cost time: 9.16788625717163
Epoch: 6, Steps: 34 | Train Loss: 15.796 Vali Loss: 33.746 Vali Acc: 0.549 Test Loss: 33.746 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.927698612213135
Epoch: 7, Steps: 34 | Train Loss: 24.164 Vali Loss: 29.232 Vali Acc: 0.642 Test Loss: 29.232 Test Acc: 0.642
Validation loss decreased (-0.623977 --> -0.641326).  Saving model ...
Epoch: 8 cost time: 9.16512131690979
Epoch: 8, Steps: 34 | Train Loss: 19.498 Vali Loss: 15.973 Vali Acc: 0.688 Test Loss: 15.973 Test Acc: 0.688
Validation loss decreased (-0.641326 --> -0.687702).  Saving model ...
Epoch: 9 cost time: 10.214187860488892
Epoch: 9, Steps: 34 | Train Loss: 3.028 Vali Loss: 18.709 Vali Acc: 0.728 Test Loss: 18.709 Test Acc: 0.728
Validation loss decreased (-0.687702 --> -0.728137).  Saving model ...
Epoch: 10 cost time: 10.176112651824951
Epoch: 10, Steps: 34 | Train Loss: 9.612 Vali Loss: 12.967 Vali Acc: 0.775 Test Loss: 12.967 Test Acc: 0.775
Validation loss decreased (-0.728137 --> -0.774437).  Saving model ...
Epoch: 11 cost time: 10.692649126052856
Epoch: 11, Steps: 34 | Train Loss: 4.407 Vali Loss: 14.777 Vali Acc: 0.769 Test Loss: 14.777 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.449440479278564
Epoch: 12, Steps: 34 | Train Loss: 11.851 Vali Loss: 34.264 Vali Acc: 0.624 Test Loss: 34.264 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.943928241729736
Epoch: 13, Steps: 34 | Train Loss: 5.555 Vali Loss: 35.489 Vali Acc: 0.653 Test Loss: 35.489 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.754488945007324
Epoch: 14, Steps: 34 | Train Loss: 3.785 Vali Loss: 14.689 Vali Acc: 0.803 Test Loss: 14.689 Test Acc: 0.803
Validation loss decreased (-0.774437 --> -0.803321).  Saving model ...
Epoch: 15 cost time: 9.226276874542236
Epoch: 15, Steps: 34 | Train Loss: 2.392 Vali Loss: 20.603 Vali Acc: 0.723 Test Loss: 20.603 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.959417581558228
Epoch: 16, Steps: 34 | Train Loss: 4.975 Vali Loss: 8.339 Vali Acc: 0.798 Test Loss: 8.339 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.126088380813599
Epoch: 17, Steps: 34 | Train Loss: 2.418 Vali Loss: 39.050 Vali Acc: 0.584 Test Loss: 39.050 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.442187309265137
Epoch: 18, Steps: 34 | Train Loss: 4.534 Vali Loss: 24.284 Vali Acc: 0.792 Test Loss: 24.284 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.935661792755127
Epoch: 19, Steps: 34 | Train Loss: 2.516 Vali Loss: 26.647 Vali Acc: 0.728 Test Loss: 26.647 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.980200290679932
Epoch: 20, Steps: 34 | Train Loss: 2.770 Vali Loss: 25.630 Vali Acc: 0.775 Test Loss: 25.630 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.183980226516724
Epoch: 21, Steps: 34 | Train Loss: 0.844 Vali Loss: 16.254 Vali Acc: 0.803 Test Loss: 16.254 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.371207475662231
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.667 Vali Acc: 0.775 Test Loss: 22.667 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.973365306854248
Epoch: 23, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.749 Vali Acc: 0.786 Test Loss: 21.749 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.141399383544922
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 21.731 Vali Acc: 0.786 Test Loss: 21.731 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 8323243
model size : 34.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.61620306968689
Epoch: 1, Steps: 34 | Train Loss: 8.648 Vali Loss: 32.151 Vali Acc: 0.145 Test Loss: 32.151 Test Acc: 0.145
Validation loss decreased (inf --> -0.144187).  Saving model ...
Epoch: 2 cost time: 9.578511714935303
Epoch: 2, Steps: 34 | Train Loss: 16.424 Vali Loss: 32.629 Vali Acc: 0.225 Test Loss: 32.629 Test Acc: 0.225
Validation loss decreased (-0.144187 --> -0.225107).  Saving model ...
Epoch: 3 cost time: 10.435947895050049
Epoch: 3, Steps: 34 | Train Loss: 32.585 Vali Loss: 36.097 Vali Acc: 0.439 Test Loss: 36.097 Test Acc: 0.439
Validation loss decreased (-0.225107 --> -0.438945).  Saving model ...
Epoch: 4 cost time: 10.77449345588684
Epoch: 4, Steps: 34 | Train Loss: 21.634 Vali Loss: 26.719 Vali Acc: 0.595 Test Loss: 26.719 Test Acc: 0.595
Validation loss decreased (-0.438945 --> -0.595109).  Saving model ...
Epoch: 5 cost time: 10.34835147857666
Epoch: 5, Steps: 34 | Train Loss: 26.494 Vali Loss: 32.452 Vali Acc: 0.399 Test Loss: 32.452 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.88813304901123
Epoch: 6, Steps: 34 | Train Loss: 13.260 Vali Loss: 42.737 Vali Acc: 0.382 Test Loss: 42.737 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.771499395370483
Epoch: 7, Steps: 34 | Train Loss: 12.277 Vali Loss: 16.565 Vali Acc: 0.676 Test Loss: 16.565 Test Acc: 0.676
Validation loss decreased (-0.595109 --> -0.676135).  Saving model ...
Epoch: 8 cost time: 8.541797399520874
Epoch: 8, Steps: 34 | Train Loss: 12.450 Vali Loss: 11.879 Vali Acc: 0.665 Test Loss: 11.879 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.386627197265625
Epoch: 9, Steps: 34 | Train Loss: 4.079 Vali Loss: 22.689 Vali Acc: 0.676 Test Loss: 22.689 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.721783876419067
Epoch: 10, Steps: 34 | Train Loss: 3.709 Vali Loss: 11.409 Vali Acc: 0.705 Test Loss: 11.409 Test Acc: 0.705
Validation loss decreased (-0.676135 --> -0.705088).  Saving model ...
Epoch: 11 cost time: 8.860549926757812
Epoch: 11, Steps: 34 | Train Loss: 2.364 Vali Loss: 26.539 Vali Acc: 0.607 Test Loss: 26.539 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.815752267837524
Epoch: 12, Steps: 34 | Train Loss: 4.929 Vali Loss: 16.286 Vali Acc: 0.659 Test Loss: 16.286 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.659181594848633
Epoch: 13, Steps: 34 | Train Loss: 1.513 Vali Loss: 11.767 Vali Acc: 0.769 Test Loss: 11.767 Test Acc: 0.769
Validation loss decreased (-0.705088 --> -0.768668).  Saving model ...
Epoch: 14 cost time: 8.690800905227661
Epoch: 14, Steps: 34 | Train Loss: 2.105 Vali Loss: 8.448 Vali Acc: 0.798 Test Loss: 8.448 Test Acc: 0.798
Validation loss decreased (-0.768668 --> -0.797603).  Saving model ...
Epoch: 15 cost time: 8.582884073257446
Epoch: 15, Steps: 34 | Train Loss: 1.998 Vali Loss: 8.135 Vali Acc: 0.775 Test Loss: 8.135 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.995090007781982
Epoch: 16, Steps: 34 | Train Loss: 1.330 Vali Loss: 11.851 Vali Acc: 0.746 Test Loss: 11.851 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.604455947875977
Epoch: 17, Steps: 34 | Train Loss: 8.477 Vali Loss: 19.656 Vali Acc: 0.792 Test Loss: 19.656 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.909144401550293
Epoch: 18, Steps: 34 | Train Loss: 4.183 Vali Loss: 27.696 Vali Acc: 0.688 Test Loss: 27.696 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.657100200653076
Epoch: 19, Steps: 34 | Train Loss: 4.371 Vali Loss: 14.959 Vali Acc: 0.775 Test Loss: 14.959 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.019279956817627
Epoch: 20, Steps: 34 | Train Loss: 1.870 Vali Loss: 14.650 Vali Acc: 0.809 Test Loss: 14.650 Test Acc: 0.809
Validation loss decreased (-0.797603 --> -0.809102).  Saving model ...
Epoch: 21 cost time: 8.679153203964233
Epoch: 21, Steps: 34 | Train Loss: 0.472 Vali Loss: 20.953 Vali Acc: 0.798 Test Loss: 20.953 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.80115270614624
Epoch: 22, Steps: 34 | Train Loss: 1.309 Vali Loss: 24.226 Vali Acc: 0.751 Test Loss: 24.226 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.048393249511719
Epoch: 23, Steps: 34 | Train Loss: 0.749 Vali Loss: 14.670 Vali Acc: 0.815 Test Loss: 14.670 Test Acc: 0.815
Validation loss decreased (-0.809102 --> -0.814882).  Saving model ...
Epoch: 24 cost time: 10.63078784942627
Epoch: 24, Steps: 34 | Train Loss: 0.522 Vali Loss: 20.814 Vali Acc: 0.763 Test Loss: 20.814 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.098870277404785
Epoch: 25, Steps: 34 | Train Loss: 1.327 Vali Loss: 13.423 Vali Acc: 0.780 Test Loss: 13.423 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 9.962327480316162
Epoch: 26, Steps: 34 | Train Loss: 1.063 Vali Loss: 12.607 Vali Acc: 0.815 Test Loss: 12.607 Test Acc: 0.815
Validation loss decreased (-0.814882 --> -0.814903).  Saving model ...
Epoch: 27 cost time: 9.813241243362427
Epoch: 27, Steps: 34 | Train Loss: 2.475 Vali Loss: 44.660 Vali Acc: 0.595 Test Loss: 44.660 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.855531692504883
Epoch: 28, Steps: 34 | Train Loss: 2.607 Vali Loss: 21.724 Vali Acc: 0.769 Test Loss: 21.724 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 9.106186389923096
Epoch: 29, Steps: 34 | Train Loss: 2.650 Vali Loss: 13.185 Vali Acc: 0.815 Test Loss: 13.185 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 8.569089412689209
Epoch: 30, Steps: 34 | Train Loss: 1.098 Vali Loss: 20.800 Vali Acc: 0.751 Test Loss: 20.800 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 8.801702976226807
Epoch: 31, Steps: 34 | Train Loss: 0.533 Vali Loss: 17.538 Vali Acc: 0.792 Test Loss: 17.538 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 8.864537477493286
Epoch: 32, Steps: 34 | Train Loss: 0.083 Vali Loss: 19.906 Vali Acc: 0.792 Test Loss: 19.906 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 9.213025569915771
Epoch: 33, Steps: 34 | Train Loss: 1.214 Vali Loss: 22.772 Vali Acc: 0.769 Test Loss: 22.772 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 8.488620281219482
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.037 Vali Acc: 0.763 Test Loss: 22.037 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 8.720771074295044
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.048 Vali Acc: 0.763 Test Loss: 22.048 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 8.68826675415039
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.049 Vali Acc: 0.763 Test Loss: 22.049 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 8165675
model size : 33.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.73528265953064
Epoch: 1, Steps: 34 | Train Loss: 7.950 Vali Loss: 12.131 Vali Acc: 0.376 Test Loss: 12.131 Test Acc: 0.376
Validation loss decreased (inf --> -0.375601).  Saving model ...
Epoch: 2 cost time: 8.224394798278809
Epoch: 2, Steps: 34 | Train Loss: 28.598 Vali Loss: 19.849 Vali Acc: 0.405 Test Loss: 19.849 Test Acc: 0.405
Validation loss decreased (-0.375601 --> -0.404426).  Saving model ...
Epoch: 3 cost time: 10.264576435089111
Epoch: 3, Steps: 34 | Train Loss: 18.229 Vali Loss: 13.228 Vali Acc: 0.532 Test Loss: 13.228 Test Acc: 0.532
Validation loss decreased (-0.404426 --> -0.531660).  Saving model ...
Epoch: 4 cost time: 9.671360731124878
Epoch: 4, Steps: 34 | Train Loss: 18.972 Vali Loss: 25.497 Vali Acc: 0.457 Test Loss: 25.497 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.633134365081787
Epoch: 5, Steps: 34 | Train Loss: 10.936 Vali Loss: 8.377 Vali Acc: 0.705 Test Loss: 8.377 Test Acc: 0.705
Validation loss decreased (-0.531660 --> -0.705119).  Saving model ...
Epoch: 6 cost time: 10.335426807403564
Epoch: 6, Steps: 34 | Train Loss: 10.287 Vali Loss: 17.948 Vali Acc: 0.590 Test Loss: 17.948 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.152464389801025
Epoch: 7, Steps: 34 | Train Loss: 11.979 Vali Loss: 26.653 Vali Acc: 0.514 Test Loss: 26.653 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.878048658370972
Epoch: 8, Steps: 34 | Train Loss: 13.089 Vali Loss: 26.207 Vali Acc: 0.659 Test Loss: 26.207 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.125825881958008
Epoch: 9, Steps: 34 | Train Loss: 5.403 Vali Loss: 43.930 Vali Acc: 0.595 Test Loss: 43.930 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.551554441452026
Epoch: 10, Steps: 34 | Train Loss: 3.206 Vali Loss: 16.064 Vali Acc: 0.723 Test Loss: 16.064 Test Acc: 0.723
Validation loss decreased (-0.705119 --> -0.722383).  Saving model ...
Epoch: 11 cost time: 8.996820211410522
Epoch: 11, Steps: 34 | Train Loss: 4.473 Vali Loss: 12.758 Vali Acc: 0.728 Test Loss: 12.758 Test Acc: 0.728
Validation loss decreased (-0.722383 --> -0.728196).  Saving model ...
Epoch: 12 cost time: 8.707603693008423
Epoch: 12, Steps: 34 | Train Loss: 7.593 Vali Loss: 26.446 Vali Acc: 0.682 Test Loss: 26.446 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.981436967849731
Epoch: 13, Steps: 34 | Train Loss: 5.925 Vali Loss: 10.087 Vali Acc: 0.809 Test Loss: 10.087 Test Acc: 0.809
Validation loss decreased (-0.728196 --> -0.809148).  Saving model ...
Epoch: 14 cost time: 8.821349382400513
Epoch: 14, Steps: 34 | Train Loss: 4.345 Vali Loss: 9.279 Vali Acc: 0.832 Test Loss: 9.279 Test Acc: 0.832
Validation loss decreased (-0.809148 --> -0.832277).  Saving model ...
Epoch: 15 cost time: 8.84874153137207
Epoch: 15, Steps: 34 | Train Loss: 3.522 Vali Loss: 10.907 Vali Acc: 0.751 Test Loss: 10.907 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.713796615600586
Epoch: 16, Steps: 34 | Train Loss: 1.429 Vali Loss: 12.954 Vali Acc: 0.786 Test Loss: 12.954 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.079830884933472
Epoch: 17, Steps: 34 | Train Loss: 2.285 Vali Loss: 27.274 Vali Acc: 0.723 Test Loss: 27.274 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.845114707946777
Epoch: 18, Steps: 34 | Train Loss: 3.488 Vali Loss: 29.516 Vali Acc: 0.642 Test Loss: 29.516 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.859390020370483
Epoch: 19, Steps: 34 | Train Loss: 2.416 Vali Loss: 7.035 Vali Acc: 0.844 Test Loss: 7.035 Test Acc: 0.844
Validation loss decreased (-0.832277 --> -0.843860).  Saving model ...
Epoch: 20 cost time: 8.4681875705719
Epoch: 20, Steps: 34 | Train Loss: 0.231 Vali Loss: 14.486 Vali Acc: 0.815 Test Loss: 14.486 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.470698356628418
Epoch: 21, Steps: 34 | Train Loss: 1.416 Vali Loss: 58.216 Vali Acc: 0.601 Test Loss: 58.216 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.299171686172485
Epoch: 22, Steps: 34 | Train Loss: 3.915 Vali Loss: 36.626 Vali Acc: 0.699 Test Loss: 36.626 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.462859153747559
Epoch: 23, Steps: 34 | Train Loss: 4.275 Vali Loss: 18.150 Vali Acc: 0.786 Test Loss: 18.150 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.764846563339233
Epoch: 24, Steps: 34 | Train Loss: 1.666 Vali Loss: 22.224 Vali Acc: 0.815 Test Loss: 22.224 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 9.882526159286499
Epoch: 25, Steps: 34 | Train Loss: 1.352 Vali Loss: 17.875 Vali Acc: 0.827 Test Loss: 17.875 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 9.057640314102173
Epoch: 26, Steps: 34 | Train Loss: 2.091 Vali Loss: 29.597 Vali Acc: 0.803 Test Loss: 29.597 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.556480407714844
Epoch: 27, Steps: 34 | Train Loss: 4.042 Vali Loss: 20.133 Vali Acc: 0.740 Test Loss: 20.133 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 8.949617624282837
Epoch: 28, Steps: 34 | Train Loss: 1.279 Vali Loss: 45.659 Vali Acc: 0.734 Test Loss: 45.659 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 8.721087217330933
Epoch: 29, Steps: 34 | Train Loss: 1.594 Vali Loss: 36.414 Vali Acc: 0.734 Test Loss: 36.414 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 8163371
model size : 33.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.752714157104492
Epoch: 1, Steps: 34 | Train Loss: 12.026 Vali Loss: 14.948 Vali Acc: 0.306 Test Loss: 14.948 Test Acc: 0.306
Validation loss decreased (inf --> -0.306209).  Saving model ...
Epoch: 2 cost time: 8.457599401473999
Epoch: 2, Steps: 34 | Train Loss: 21.662 Vali Loss: 17.324 Vali Acc: 0.514 Test Loss: 17.324 Test Acc: 0.514
Validation loss decreased (-0.306209 --> -0.514278).  Saving model ...
Epoch: 3 cost time: 9.183244705200195
Epoch: 3, Steps: 34 | Train Loss: 23.881 Vali Loss: 24.807 Vali Acc: 0.520 Test Loss: 24.807 Test Acc: 0.520
Validation loss decreased (-0.514278 --> -0.519983).  Saving model ...
Epoch: 4 cost time: 8.898556232452393
Epoch: 4, Steps: 34 | Train Loss: 22.850 Vali Loss: 17.779 Vali Acc: 0.601 Test Loss: 17.779 Test Acc: 0.601
Validation loss decreased (-0.519983 --> -0.600978).  Saving model ...
Epoch: 5 cost time: 8.937017679214478
Epoch: 5, Steps: 34 | Train Loss: 11.699 Vali Loss: 7.039 Vali Acc: 0.624 Test Loss: 7.039 Test Acc: 0.624
Validation loss decreased (-0.600978 --> -0.624207).  Saving model ...
Epoch: 6 cost time: 8.843895435333252
Epoch: 6, Steps: 34 | Train Loss: 16.217 Vali Loss: 35.295 Vali Acc: 0.451 Test Loss: 35.295 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.14163088798523
Epoch: 7, Steps: 34 | Train Loss: 28.771 Vali Loss: 21.668 Vali Acc: 0.618 Test Loss: 21.668 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.353734731674194
Epoch: 8, Steps: 34 | Train Loss: 15.578 Vali Loss: 17.669 Vali Acc: 0.607 Test Loss: 17.669 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.972535848617554
Epoch: 9, Steps: 34 | Train Loss: 6.889 Vali Loss: 31.508 Vali Acc: 0.503 Test Loss: 31.508 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.780122995376587
Epoch: 10, Steps: 34 | Train Loss: 6.785 Vali Loss: 20.445 Vali Acc: 0.682 Test Loss: 20.445 Test Acc: 0.682
Validation loss decreased (-0.624207 --> -0.681876).  Saving model ...
Epoch: 11 cost time: 10.652283430099487
Epoch: 11, Steps: 34 | Train Loss: 7.650 Vali Loss: 31.628 Vali Acc: 0.642 Test Loss: 31.628 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.081154108047485
Epoch: 12, Steps: 34 | Train Loss: 6.038 Vali Loss: 38.680 Vali Acc: 0.636 Test Loss: 38.680 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.411006450653076
Epoch: 13, Steps: 34 | Train Loss: 8.528 Vali Loss: 20.875 Vali Acc: 0.688 Test Loss: 20.875 Test Acc: 0.688
Validation loss decreased (-0.681876 --> -0.687653).  Saving model ...
Epoch: 14 cost time: 8.861431121826172
Epoch: 14, Steps: 34 | Train Loss: 3.129 Vali Loss: 46.189 Vali Acc: 0.607 Test Loss: 46.189 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.835800886154175
Epoch: 15, Steps: 34 | Train Loss: 4.204 Vali Loss: 16.618 Vali Acc: 0.775 Test Loss: 16.618 Test Acc: 0.775
Validation loss decreased (-0.687653 --> -0.774400).  Saving model ...
Epoch: 16 cost time: 9.330045461654663
Epoch: 16, Steps: 34 | Train Loss: 1.860 Vali Loss: 10.940 Vali Acc: 0.798 Test Loss: 10.940 Test Acc: 0.798
Validation loss decreased (-0.774400 --> -0.797578).  Saving model ...
Epoch: 17 cost time: 8.75482702255249
Epoch: 17, Steps: 34 | Train Loss: 3.619 Vali Loss: 14.862 Vali Acc: 0.723 Test Loss: 14.862 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.88113284111023
Epoch: 18, Steps: 34 | Train Loss: 4.521 Vali Loss: 29.000 Vali Acc: 0.786 Test Loss: 29.000 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.858643054962158
Epoch: 19, Steps: 34 | Train Loss: 2.610 Vali Loss: 19.629 Vali Acc: 0.792 Test Loss: 19.629 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.09754467010498
Epoch: 20, Steps: 34 | Train Loss: 4.188 Vali Loss: 16.709 Vali Acc: 0.821 Test Loss: 16.709 Test Acc: 0.821
Validation loss decreased (-0.797578 --> -0.820642).  Saving model ...
Epoch: 21 cost time: 8.927241325378418
Epoch: 21, Steps: 34 | Train Loss: 1.551 Vali Loss: 18.902 Vali Acc: 0.809 Test Loss: 18.902 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.607271194458008
Epoch: 22, Steps: 34 | Train Loss: 1.204 Vali Loss: 14.120 Vali Acc: 0.832 Test Loss: 14.120 Test Acc: 0.832
Validation loss decreased (-0.820642 --> -0.832229).  Saving model ...
Epoch: 23 cost time: 9.02691125869751
Epoch: 23, Steps: 34 | Train Loss: 0.725 Vali Loss: 20.543 Vali Acc: 0.746 Test Loss: 20.543 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.991227388381958
Epoch: 24, Steps: 34 | Train Loss: 1.334 Vali Loss: 23.162 Vali Acc: 0.792 Test Loss: 23.162 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.68822193145752
Epoch: 25, Steps: 34 | Train Loss: 0.806 Vali Loss: 22.546 Vali Acc: 0.769 Test Loss: 22.546 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.773324251174927
Epoch: 26, Steps: 34 | Train Loss: 0.631 Vali Loss: 16.853 Vali Acc: 0.815 Test Loss: 16.853 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.970037460327148
Epoch: 27, Steps: 34 | Train Loss: 0.654 Vali Loss: 20.750 Vali Acc: 0.809 Test Loss: 20.750 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.166627883911133
Epoch: 28, Steps: 34 | Train Loss: 0.729 Vali Loss: 14.532 Vali Acc: 0.809 Test Loss: 14.532 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.802840232849121
Epoch: 29, Steps: 34 | Train Loss: 0.612 Vali Loss: 13.832 Vali Acc: 0.821 Test Loss: 13.832 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.708446741104126
Epoch: 30, Steps: 34 | Train Loss: 0.251 Vali Loss: 42.250 Vali Acc: 0.763 Test Loss: 42.250 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 8.771289110183716
Epoch: 31, Steps: 34 | Train Loss: 1.907 Vali Loss: 22.108 Vali Acc: 0.757 Test Loss: 22.108 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 9.06818699836731
Epoch: 32, Steps: 34 | Train Loss: 1.291 Vali Loss: 29.082 Vali Acc: 0.803 Test Loss: 29.082 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 8161067
model size : 33.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.358268737792969
Epoch: 1, Steps: 34 | Train Loss: 8.450 Vali Loss: 20.578 Vali Acc: 0.434 Test Loss: 20.578 Test Acc: 0.434
Validation loss decreased (inf --> -0.433320).  Saving model ...
Epoch: 2 cost time: 8.806139707565308
Epoch: 2, Steps: 34 | Train Loss: 18.923 Vali Loss: 49.184 Vali Acc: 0.289 Test Loss: 49.184 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.045029640197754
Epoch: 3, Steps: 34 | Train Loss: 28.785 Vali Loss: 51.207 Vali Acc: 0.370 Test Loss: 51.207 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.556219577789307
Epoch: 4, Steps: 34 | Train Loss: 28.072 Vali Loss: 18.058 Vali Acc: 0.607 Test Loss: 18.058 Test Acc: 0.607
Validation loss decreased (-0.433320 --> -0.606756).  Saving model ...
Epoch: 5 cost time: 8.756190299987793
Epoch: 5, Steps: 34 | Train Loss: 33.025 Vali Loss: 32.074 Vali Acc: 0.636 Test Loss: 32.074 Test Acc: 0.636
Validation loss decreased (-0.606756 --> -0.635517).  Saving model ...
Epoch: 6 cost time: 8.990399837493896
Epoch: 6, Steps: 34 | Train Loss: 26.886 Vali Loss: 31.392 Vali Acc: 0.555 Test Loss: 31.392 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.918518304824829
Epoch: 7, Steps: 34 | Train Loss: 16.765 Vali Loss: 10.340 Vali Acc: 0.723 Test Loss: 10.340 Test Acc: 0.723
Validation loss decreased (-0.635517 --> -0.722440).  Saving model ...
Epoch: 8 cost time: 8.5920569896698
Epoch: 8, Steps: 34 | Train Loss: 12.769 Vali Loss: 20.999 Vali Acc: 0.590 Test Loss: 20.999 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.764053344726562
Epoch: 9, Steps: 34 | Train Loss: 8.847 Vali Loss: 13.521 Vali Acc: 0.705 Test Loss: 13.521 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.138787269592285
Epoch: 10, Steps: 34 | Train Loss: 8.335 Vali Loss: 9.520 Vali Acc: 0.803 Test Loss: 9.520 Test Acc: 0.803
Validation loss decreased (-0.722440 --> -0.803373).  Saving model ...
Epoch: 11 cost time: 10.066642999649048
Epoch: 11, Steps: 34 | Train Loss: 3.434 Vali Loss: 13.978 Vali Acc: 0.699 Test Loss: 13.978 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.067464828491211
Epoch: 12, Steps: 34 | Train Loss: 5.078 Vali Loss: 26.100 Vali Acc: 0.647 Test Loss: 26.100 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.718213081359863
Epoch: 13, Steps: 34 | Train Loss: 5.014 Vali Loss: 13.611 Vali Acc: 0.763 Test Loss: 13.611 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.63474988937378
Epoch: 14, Steps: 34 | Train Loss: 2.707 Vali Loss: 4.504 Vali Acc: 0.838 Test Loss: 4.504 Test Acc: 0.838
Validation loss decreased (-0.803373 --> -0.838105).  Saving model ...
Epoch: 15 cost time: 8.746610879898071
Epoch: 15, Steps: 34 | Train Loss: 1.625 Vali Loss: 18.808 Vali Acc: 0.775 Test Loss: 18.808 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.347722053527832
Epoch: 16, Steps: 34 | Train Loss: 3.394 Vali Loss: 18.997 Vali Acc: 0.769 Test Loss: 18.997 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.629982709884644
Epoch: 17, Steps: 34 | Train Loss: 2.511 Vali Loss: 9.546 Vali Acc: 0.827 Test Loss: 9.546 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.260677099227905
Epoch: 18, Steps: 34 | Train Loss: 2.503 Vali Loss: 24.076 Vali Acc: 0.763 Test Loss: 24.076 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.553762435913086
Epoch: 19, Steps: 34 | Train Loss: 1.188 Vali Loss: 12.012 Vali Acc: 0.838 Test Loss: 12.012 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.68448281288147
Epoch: 20, Steps: 34 | Train Loss: 4.403 Vali Loss: 29.518 Vali Acc: 0.671 Test Loss: 29.518 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.556919574737549
Epoch: 21, Steps: 34 | Train Loss: 4.452 Vali Loss: 29.896 Vali Acc: 0.751 Test Loss: 29.896 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.503720045089722
Epoch: 22, Steps: 34 | Train Loss: 0.919 Vali Loss: 14.170 Vali Acc: 0.832 Test Loss: 14.170 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.983706951141357
Epoch: 23, Steps: 34 | Train Loss: 1.200 Vali Loss: 14.197 Vali Acc: 0.809 Test Loss: 14.197 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.733955144882202
Epoch: 24, Steps: 34 | Train Loss: 0.216 Vali Loss: 18.645 Vali Acc: 0.792 Test Loss: 18.645 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 8158763
model size : 33.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.904502630233765
Epoch: 1, Steps: 34 | Train Loss: 3.842 Vali Loss: 5.270 Vali Acc: 0.341 Test Loss: 5.270 Test Acc: 0.341
Validation loss decreased (inf --> -0.340988).  Saving model ...
Epoch: 2 cost time: 8.62653136253357
Epoch: 2, Steps: 34 | Train Loss: 7.850 Vali Loss: 19.938 Vali Acc: 0.289 Test Loss: 19.938 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.901724576950073
Epoch: 3, Steps: 34 | Train Loss: 14.137 Vali Loss: 13.559 Vali Acc: 0.434 Test Loss: 13.559 Test Acc: 0.434
Validation loss decreased (-0.340988 --> -0.433390).  Saving model ...
Epoch: 4 cost time: 8.74381971359253
Epoch: 4, Steps: 34 | Train Loss: 15.322 Vali Loss: 9.202 Vali Acc: 0.543 Test Loss: 9.202 Test Acc: 0.543
Validation loss decreased (-0.433390 --> -0.543261).  Saving model ...
Epoch: 5 cost time: 9.542330026626587
Epoch: 5, Steps: 34 | Train Loss: 8.999 Vali Loss: 8.923 Vali Acc: 0.595 Test Loss: 8.923 Test Acc: 0.595
Validation loss decreased (-0.543261 --> -0.595286).  Saving model ...
Epoch: 6 cost time: 9.10219144821167
Epoch: 6, Steps: 34 | Train Loss: 4.509 Vali Loss: 16.184 Vali Acc: 0.549 Test Loss: 16.184 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.165495157241821
Epoch: 7, Steps: 34 | Train Loss: 9.259 Vali Loss: 10.855 Vali Acc: 0.613 Test Loss: 10.855 Test Acc: 0.613
Validation loss decreased (-0.595286 --> -0.612608).  Saving model ...
Epoch: 8 cost time: 7.6766088008880615
Epoch: 8, Steps: 34 | Train Loss: 5.682 Vali Loss: 8.459 Vali Acc: 0.659 Test Loss: 8.459 Test Acc: 0.659
Validation loss decreased (-0.612608 --> -0.658875).  Saving model ...
Epoch: 9 cost time: 7.9259419441223145
Epoch: 9, Steps: 34 | Train Loss: 5.600 Vali Loss: 12.265 Vali Acc: 0.601 Test Loss: 12.265 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.681740760803223
Epoch: 10, Steps: 34 | Train Loss: 3.481 Vali Loss: 8.291 Vali Acc: 0.728 Test Loss: 8.291 Test Acc: 0.728
Validation loss decreased (-0.658875 --> -0.728241).  Saving model ...
Epoch: 11 cost time: 7.359216213226318
Epoch: 11, Steps: 34 | Train Loss: 5.021 Vali Loss: 20.784 Vali Acc: 0.457 Test Loss: 20.784 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.006160736083984
Epoch: 12, Steps: 34 | Train Loss: 2.880 Vali Loss: 12.005 Vali Acc: 0.682 Test Loss: 12.005 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.85746693611145
Epoch: 13, Steps: 34 | Train Loss: 0.780 Vali Loss: 11.905 Vali Acc: 0.682 Test Loss: 11.905 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.568710088729858
Epoch: 14, Steps: 34 | Train Loss: 1.052 Vali Loss: 13.105 Vali Acc: 0.746 Test Loss: 13.105 Test Acc: 0.746
Validation loss decreased (-0.728241 --> -0.745534).  Saving model ...
Epoch: 15 cost time: 7.84560227394104
Epoch: 15, Steps: 34 | Train Loss: 0.351 Vali Loss: 4.640 Vali Acc: 0.815 Test Loss: 4.640 Test Acc: 0.815
Validation loss decreased (-0.745534 --> -0.814982).  Saving model ...
Epoch: 16 cost time: 7.784233808517456
Epoch: 16, Steps: 34 | Train Loss: 0.215 Vali Loss: 7.801 Vali Acc: 0.786 Test Loss: 7.801 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.796475172042847
Epoch: 17, Steps: 34 | Train Loss: 1.807 Vali Loss: 7.339 Vali Acc: 0.746 Test Loss: 7.339 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.692021131515503
Epoch: 18, Steps: 34 | Train Loss: 1.612 Vali Loss: 20.494 Vali Acc: 0.630 Test Loss: 20.494 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.665180921554565
Epoch: 19, Steps: 34 | Train Loss: 4.238 Vali Loss: 8.900 Vali Acc: 0.757 Test Loss: 8.900 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.695088863372803
Epoch: 20, Steps: 34 | Train Loss: 1.680 Vali Loss: 8.171 Vali Acc: 0.763 Test Loss: 8.171 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.063539028167725
Epoch: 21, Steps: 34 | Train Loss: 1.566 Vali Loss: 11.869 Vali Acc: 0.821 Test Loss: 11.869 Test Acc: 0.821
Validation loss decreased (-0.814982 --> -0.820691).  Saving model ...
Epoch: 22 cost time: 8.838028907775879
Epoch: 22, Steps: 34 | Train Loss: 1.490 Vali Loss: 11.011 Vali Acc: 0.786 Test Loss: 11.011 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.564496278762817
Epoch: 23, Steps: 34 | Train Loss: 1.086 Vali Loss: 6.394 Vali Acc: 0.832 Test Loss: 6.394 Test Acc: 0.832
Validation loss decreased (-0.820691 --> -0.832306).  Saving model ...
Epoch: 24 cost time: 8.896971464157104
Epoch: 24, Steps: 34 | Train Loss: 0.709 Vali Loss: 16.229 Vali Acc: 0.775 Test Loss: 16.229 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 9.222346544265747
Epoch: 25, Steps: 34 | Train Loss: 1.536 Vali Loss: 9.583 Vali Acc: 0.763 Test Loss: 9.583 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.877992153167725
Epoch: 26, Steps: 34 | Train Loss: 1.364 Vali Loss: 12.225 Vali Acc: 0.728 Test Loss: 12.225 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.7347447872161865
Epoch: 27, Steps: 34 | Train Loss: 1.824 Vali Loss: 9.314 Vali Acc: 0.792 Test Loss: 9.314 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 8.004380941390991
Epoch: 28, Steps: 34 | Train Loss: 1.509 Vali Loss: 9.355 Vali Acc: 0.815 Test Loss: 9.355 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.504216909408569
Epoch: 29, Steps: 34 | Train Loss: 0.995 Vali Loss: 7.106 Vali Acc: 0.803 Test Loss: 7.106 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 8.175037384033203
Epoch: 30, Steps: 34 | Train Loss: 1.171 Vali Loss: 7.201 Vali Acc: 0.769 Test Loss: 7.201 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.55289101600647
Epoch: 31, Steps: 34 | Train Loss: 0.204 Vali Loss: 20.423 Vali Acc: 0.751 Test Loss: 20.423 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.805246353149414
Epoch: 32, Steps: 34 | Train Loss: 0.344 Vali Loss: 7.916 Vali Acc: 0.809 Test Loss: 7.916 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.573427438735962
Epoch: 33, Steps: 34 | Train Loss: 0.520 Vali Loss: 6.638 Vali Acc: 0.827 Test Loss: 6.638 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4333419
model size : 17.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.534323930740356
Epoch: 1, Steps: 34 | Train Loss: 5.501 Vali Loss: 8.607 Vali Acc: 0.329 Test Loss: 8.607 Test Acc: 0.329
Validation loss decreased (inf --> -0.329394).  Saving model ...
Epoch: 2 cost time: 7.590708255767822
Epoch: 2, Steps: 34 | Train Loss: 8.449 Vali Loss: 9.633 Vali Acc: 0.387 Test Loss: 9.633 Test Acc: 0.387
Validation loss decreased (-0.329394 --> -0.387187).  Saving model ...
Epoch: 3 cost time: 7.427708387374878
Epoch: 3, Steps: 34 | Train Loss: 11.955 Vali Loss: 20.765 Vali Acc: 0.306 Test Loss: 20.765 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.365262508392334
Epoch: 4, Steps: 34 | Train Loss: 11.501 Vali Loss: 16.344 Vali Acc: 0.520 Test Loss: 16.344 Test Acc: 0.520
Validation loss decreased (-0.387187 --> -0.520068).  Saving model ...
Epoch: 5 cost time: 8.571450233459473
Epoch: 5, Steps: 34 | Train Loss: 8.429 Vali Loss: 18.780 Vali Acc: 0.497 Test Loss: 18.780 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.180938720703125
Epoch: 6, Steps: 34 | Train Loss: 8.651 Vali Loss: 14.241 Vali Acc: 0.590 Test Loss: 14.241 Test Acc: 0.590
Validation loss decreased (-0.520068 --> -0.589453).  Saving model ...
Epoch: 7 cost time: 7.845698118209839
Epoch: 7, Steps: 34 | Train Loss: 6.320 Vali Loss: 10.277 Vali Acc: 0.653 Test Loss: 10.277 Test Acc: 0.653
Validation loss decreased (-0.589453 --> -0.653076).  Saving model ...
Epoch: 8 cost time: 8.503055810928345
Epoch: 8, Steps: 34 | Train Loss: 3.557 Vali Loss: 11.700 Vali Acc: 0.624 Test Loss: 11.700 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.126039266586304
Epoch: 9, Steps: 34 | Train Loss: 5.219 Vali Loss: 8.968 Vali Acc: 0.595 Test Loss: 8.968 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.2653226852417
Epoch: 10, Steps: 34 | Train Loss: 4.424 Vali Loss: 16.548 Vali Acc: 0.636 Test Loss: 16.548 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.046306848526001
Epoch: 11, Steps: 34 | Train Loss: 7.098 Vali Loss: 20.853 Vali Acc: 0.590 Test Loss: 20.853 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.398020505905151
Epoch: 12, Steps: 34 | Train Loss: 6.998 Vali Loss: 8.729 Vali Acc: 0.769 Test Loss: 8.729 Test Acc: 0.769
Validation loss decreased (-0.653076 --> -0.768699).  Saving model ...
Epoch: 13 cost time: 7.441835880279541
Epoch: 13, Steps: 34 | Train Loss: 3.182 Vali Loss: 13.537 Vali Acc: 0.682 Test Loss: 13.537 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.539462327957153
Epoch: 14, Steps: 34 | Train Loss: 1.588 Vali Loss: 15.358 Vali Acc: 0.665 Test Loss: 15.358 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.296426057815552
Epoch: 15, Steps: 34 | Train Loss: 2.765 Vali Loss: 7.949 Vali Acc: 0.775 Test Loss: 7.949 Test Acc: 0.775
Validation loss decreased (-0.768699 --> -0.774487).  Saving model ...
Epoch: 16 cost time: 7.46799635887146
Epoch: 16, Steps: 34 | Train Loss: 1.762 Vali Loss: 14.921 Vali Acc: 0.763 Test Loss: 14.921 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.238351106643677
Epoch: 17, Steps: 34 | Train Loss: 0.798 Vali Loss: 11.884 Vali Acc: 0.728 Test Loss: 11.884 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.4287426471710205
Epoch: 18, Steps: 34 | Train Loss: 1.263 Vali Loss: 12.867 Vali Acc: 0.728 Test Loss: 12.867 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.554866552352905
Epoch: 19, Steps: 34 | Train Loss: 1.040 Vali Loss: 7.535 Vali Acc: 0.832 Test Loss: 7.535 Test Acc: 0.832
Validation loss decreased (-0.774487 --> -0.832295).  Saving model ...
Epoch: 20 cost time: 7.5171122550964355
Epoch: 20, Steps: 34 | Train Loss: 1.132 Vali Loss: 12.525 Vali Acc: 0.775 Test Loss: 12.525 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.4002861976623535
Epoch: 21, Steps: 34 | Train Loss: 1.386 Vali Loss: 13.290 Vali Acc: 0.699 Test Loss: 13.290 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.622190713882446
Epoch: 22, Steps: 34 | Train Loss: 1.589 Vali Loss: 21.367 Vali Acc: 0.653 Test Loss: 21.367 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.689658164978027
Epoch: 23, Steps: 34 | Train Loss: 0.283 Vali Loss: 12.437 Vali Acc: 0.763 Test Loss: 12.437 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.437347412109375
Epoch: 24, Steps: 34 | Train Loss: 0.612 Vali Loss: 16.255 Vali Acc: 0.671 Test Loss: 16.255 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.636675119400024
Epoch: 25, Steps: 34 | Train Loss: 2.220 Vali Loss: 13.783 Vali Acc: 0.723 Test Loss: 13.783 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.20449161529541
Epoch: 26, Steps: 34 | Train Loss: 1.183 Vali Loss: 11.390 Vali Acc: 0.815 Test Loss: 11.390 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.39015007019043
Epoch: 27, Steps: 34 | Train Loss: 0.189 Vali Loss: 9.113 Vali Acc: 0.809 Test Loss: 9.113 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.112971782684326
Epoch: 28, Steps: 34 | Train Loss: 0.108 Vali Loss: 14.118 Vali Acc: 0.780 Test Loss: 14.118 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.678312301635742
Epoch: 29, Steps: 34 | Train Loss: 0.140 Vali Loss: 12.896 Vali Acc: 0.786 Test Loss: 12.896 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4332267
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.334423780441284
Epoch: 1, Steps: 34 | Train Loss: 4.968 Vali Loss: 6.672 Vali Acc: 0.347 Test Loss: 6.672 Test Acc: 0.347
Validation loss decreased (inf --> -0.346754).  Saving model ...
Epoch: 2 cost time: 7.296175718307495
Epoch: 2, Steps: 34 | Train Loss: 7.739 Vali Loss: 9.414 Vali Acc: 0.468 Test Loss: 9.414 Test Acc: 0.468
Validation loss decreased (-0.346754 --> -0.468114).  Saving model ...
Epoch: 3 cost time: 7.350512504577637
Epoch: 3, Steps: 34 | Train Loss: 7.442 Vali Loss: 11.986 Vali Acc: 0.561 Test Loss: 11.986 Test Acc: 0.561
Validation loss decreased (-0.468114 --> -0.560574).  Saving model ...
Epoch: 4 cost time: 7.448136568069458
Epoch: 4, Steps: 34 | Train Loss: 16.005 Vali Loss: 10.130 Vali Acc: 0.520 Test Loss: 10.130 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.425808429718018
Epoch: 5, Steps: 34 | Train Loss: 10.020 Vali Loss: 17.261 Vali Acc: 0.405 Test Loss: 17.261 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.55739951133728
Epoch: 6, Steps: 34 | Train Loss: 5.909 Vali Loss: 14.571 Vali Acc: 0.642 Test Loss: 14.571 Test Acc: 0.642
Validation loss decreased (-0.560574 --> -0.641473).  Saving model ...
Epoch: 7 cost time: 7.618247985839844
Epoch: 7, Steps: 34 | Train Loss: 6.411 Vali Loss: 11.577 Vali Acc: 0.647 Test Loss: 11.577 Test Acc: 0.647
Validation loss decreased (-0.641473 --> -0.647283).  Saving model ...
Epoch: 8 cost time: 7.435105085372925
Epoch: 8, Steps: 34 | Train Loss: 9.050 Vali Loss: 20.403 Vali Acc: 0.491 Test Loss: 20.403 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.628834247589111
Epoch: 9, Steps: 34 | Train Loss: 5.569 Vali Loss: 8.129 Vali Acc: 0.601 Test Loss: 8.129 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.588226079940796
Epoch: 10, Steps: 34 | Train Loss: 2.174 Vali Loss: 6.905 Vali Acc: 0.740 Test Loss: 6.905 Test Acc: 0.740
Validation loss decreased (-0.647283 --> -0.739815).  Saving model ...
Epoch: 11 cost time: 7.46673583984375
Epoch: 11, Steps: 34 | Train Loss: 2.795 Vali Loss: 17.978 Vali Acc: 0.566 Test Loss: 17.978 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.556498765945435
Epoch: 12, Steps: 34 | Train Loss: 2.190 Vali Loss: 5.133 Vali Acc: 0.769 Test Loss: 5.133 Test Acc: 0.769
Validation loss decreased (-0.739815 --> -0.768735).  Saving model ...
Epoch: 13 cost time: 8.790438890457153
Epoch: 13, Steps: 34 | Train Loss: 2.196 Vali Loss: 8.912 Vali Acc: 0.728 Test Loss: 8.912 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.834803819656372
Epoch: 14, Steps: 34 | Train Loss: 1.811 Vali Loss: 16.701 Vali Acc: 0.647 Test Loss: 16.701 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.895039558410645
Epoch: 15, Steps: 34 | Train Loss: 1.557 Vali Loss: 13.334 Vali Acc: 0.734 Test Loss: 13.334 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.381125450134277
Epoch: 16, Steps: 34 | Train Loss: 2.138 Vali Loss: 12.218 Vali Acc: 0.699 Test Loss: 12.218 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.649131536483765
Epoch: 17, Steps: 34 | Train Loss: 2.257 Vali Loss: 10.272 Vali Acc: 0.763 Test Loss: 10.272 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.219718933105469
Epoch: 18, Steps: 34 | Train Loss: 0.344 Vali Loss: 6.648 Vali Acc: 0.809 Test Loss: 6.648 Test Acc: 0.809
Validation loss decreased (-0.768735 --> -0.809182).  Saving model ...
Epoch: 19 cost time: 7.905889987945557
Epoch: 19, Steps: 34 | Train Loss: 0.360 Vali Loss: 12.123 Vali Acc: 0.728 Test Loss: 12.123 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.752046346664429
Epoch: 20, Steps: 34 | Train Loss: 0.052 Vali Loss: 6.502 Vali Acc: 0.786 Test Loss: 6.502 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.6196064949035645
Epoch: 21, Steps: 34 | Train Loss: 0.253 Vali Loss: 8.124 Vali Acc: 0.757 Test Loss: 8.124 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.704070806503296
Epoch: 22, Steps: 34 | Train Loss: 0.326 Vali Loss: 9.932 Vali Acc: 0.763 Test Loss: 9.932 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.853303670883179
Epoch: 23, Steps: 34 | Train Loss: 1.169 Vali Loss: 8.571 Vali Acc: 0.821 Test Loss: 8.571 Test Acc: 0.821
Validation loss decreased (-0.809182 --> -0.820724).  Saving model ...
Epoch: 24 cost time: 7.307811975479126
Epoch: 24, Steps: 34 | Train Loss: 1.009 Vali Loss: 20.299 Vali Acc: 0.711 Test Loss: 20.299 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.763745546340942
Epoch: 25, Steps: 34 | Train Loss: 1.406 Vali Loss: 15.476 Vali Acc: 0.763 Test Loss: 15.476 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.507134675979614
Epoch: 26, Steps: 34 | Train Loss: 1.202 Vali Loss: 16.745 Vali Acc: 0.763 Test Loss: 16.745 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.4684929847717285
Epoch: 27, Steps: 34 | Train Loss: 0.577 Vali Loss: 22.296 Vali Acc: 0.682 Test Loss: 22.296 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.655167579650879
Epoch: 28, Steps: 34 | Train Loss: 1.986 Vali Loss: 11.184 Vali Acc: 0.717 Test Loss: 11.184 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.866779565811157
Epoch: 29, Steps: 34 | Train Loss: 0.801 Vali Loss: 14.354 Vali Acc: 0.682 Test Loss: 14.354 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.5305962562561035
Epoch: 30, Steps: 34 | Train Loss: 0.453 Vali Loss: 19.003 Vali Acc: 0.647 Test Loss: 19.003 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.486266851425171
Epoch: 31, Steps: 34 | Train Loss: 0.453 Vali Loss: 6.308 Vali Acc: 0.821 Test Loss: 6.308 Test Acc: 0.821
Validation loss decreased (-0.820724 --> -0.820746).  Saving model ...
Epoch: 32 cost time: 8.024518251419067
Epoch: 32, Steps: 34 | Train Loss: 0.254 Vali Loss: 10.691 Vali Acc: 0.798 Test Loss: 10.691 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 8.94691801071167
Epoch: 33, Steps: 34 | Train Loss: 0.359 Vali Loss: 12.316 Vali Acc: 0.763 Test Loss: 12.316 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 8.537680625915527
Epoch: 34, Steps: 34 | Train Loss: 0.674 Vali Loss: 12.946 Vali Acc: 0.775 Test Loss: 12.946 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 8.241233110427856
Epoch: 35, Steps: 34 | Train Loss: 2.378 Vali Loss: 11.681 Vali Acc: 0.734 Test Loss: 11.681 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 8.568666458129883
Epoch: 36, Steps: 34 | Train Loss: 0.474 Vali Loss: 17.535 Vali Acc: 0.699 Test Loss: 17.535 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 8.495248079299927
Epoch: 37, Steps: 34 | Train Loss: 2.041 Vali Loss: 11.358 Vali Acc: 0.792 Test Loss: 11.358 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 7.143377304077148
Epoch: 38, Steps: 34 | Train Loss: 0.741 Vali Loss: 10.892 Vali Acc: 0.792 Test Loss: 10.892 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 7.586822509765625
Epoch: 39, Steps: 34 | Train Loss: 1.406 Vali Loss: 13.015 Vali Acc: 0.803 Test Loss: 13.015 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 7.46050238609314
Epoch: 40, Steps: 34 | Train Loss: 0.844 Vali Loss: 27.154 Vali Acc: 0.746 Test Loss: 27.154 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 7.474084854125977
Epoch: 41, Steps: 34 | Train Loss: 0.856 Vali Loss: 17.375 Vali Acc: 0.775 Test Loss: 17.375 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 4331115
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.09174132347107
Epoch: 1, Steps: 34 | Train Loss: 4.345 Vali Loss: 4.961 Vali Acc: 0.277 Test Loss: 4.961 Test Acc: 0.277
Validation loss decreased (inf --> -0.277407).  Saving model ...
Epoch: 2 cost time: 7.3473005294799805
Epoch: 2, Steps: 34 | Train Loss: 5.003 Vali Loss: 6.554 Vali Acc: 0.393 Test Loss: 6.554 Test Acc: 0.393
Validation loss decreased (-0.277407 --> -0.392998).  Saving model ...
Epoch: 3 cost time: 7.4169251918792725
Epoch: 3, Steps: 34 | Train Loss: 7.675 Vali Loss: 9.200 Vali Acc: 0.653 Test Loss: 9.200 Test Acc: 0.653
Validation loss decreased (-0.392998 --> -0.653087).  Saving model ...
Epoch: 4 cost time: 7.526248931884766
Epoch: 4, Steps: 34 | Train Loss: 9.182 Vali Loss: 18.868 Vali Acc: 0.480 Test Loss: 18.868 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.428396940231323
Epoch: 5, Steps: 34 | Train Loss: 9.179 Vali Loss: 5.954 Vali Acc: 0.653 Test Loss: 5.954 Test Acc: 0.653
Validation loss decreased (-0.653087 --> -0.653120).  Saving model ...
Epoch: 6 cost time: 7.256536960601807
Epoch: 6, Steps: 34 | Train Loss: 9.179 Vali Loss: 8.161 Vali Acc: 0.549 Test Loss: 8.161 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.407965660095215
Epoch: 7, Steps: 34 | Train Loss: 6.308 Vali Loss: 11.646 Vali Acc: 0.595 Test Loss: 11.646 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.4293372631073
Epoch: 8, Steps: 34 | Train Loss: 4.245 Vali Loss: 8.339 Vali Acc: 0.676 Test Loss: 8.339 Test Acc: 0.676
Validation loss decreased (-0.653120 --> -0.676217).  Saving model ...
Epoch: 9 cost time: 8.70760178565979
Epoch: 9, Steps: 34 | Train Loss: 2.016 Vali Loss: 3.709 Vali Acc: 0.809 Test Loss: 3.709 Test Acc: 0.809
Validation loss decreased (-0.676217 --> -0.809211).  Saving model ...
Epoch: 10 cost time: 7.52673602104187
Epoch: 10, Steps: 34 | Train Loss: 2.012 Vali Loss: 7.291 Vali Acc: 0.676 Test Loss: 7.291 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.273913145065308
Epoch: 11, Steps: 34 | Train Loss: 3.894 Vali Loss: 7.997 Vali Acc: 0.676 Test Loss: 7.997 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.7830491065979
Epoch: 12, Steps: 34 | Train Loss: 2.126 Vali Loss: 8.918 Vali Acc: 0.763 Test Loss: 8.918 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.491276025772095
Epoch: 13, Steps: 34 | Train Loss: 1.538 Vali Loss: 5.409 Vali Acc: 0.838 Test Loss: 5.409 Test Acc: 0.838
Validation loss decreased (-0.809211 --> -0.838096).  Saving model ...
Epoch: 14 cost time: 6.997844219207764
Epoch: 14, Steps: 34 | Train Loss: 0.525 Vali Loss: 10.388 Vali Acc: 0.717 Test Loss: 10.388 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.411690711975098
Epoch: 15, Steps: 34 | Train Loss: 1.927 Vali Loss: 14.197 Vali Acc: 0.653 Test Loss: 14.197 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.353013515472412
Epoch: 16, Steps: 34 | Train Loss: 1.411 Vali Loss: 6.663 Vali Acc: 0.832 Test Loss: 6.663 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.250355005264282
Epoch: 17, Steps: 34 | Train Loss: 0.900 Vali Loss: 8.659 Vali Acc: 0.786 Test Loss: 8.659 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.206634521484375
Epoch: 18, Steps: 34 | Train Loss: 1.814 Vali Loss: 12.688 Vali Acc: 0.671 Test Loss: 12.688 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.316950798034668
Epoch: 19, Steps: 34 | Train Loss: 2.205 Vali Loss: 7.442 Vali Acc: 0.780 Test Loss: 7.442 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.376666069030762
Epoch: 20, Steps: 34 | Train Loss: 2.235 Vali Loss: 15.073 Vali Acc: 0.699 Test Loss: 15.073 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.61883544921875
Epoch: 21, Steps: 34 | Train Loss: 2.510 Vali Loss: 9.390 Vali Acc: 0.809 Test Loss: 9.390 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.2306883335113525
Epoch: 22, Steps: 34 | Train Loss: 1.759 Vali Loss: 22.567 Vali Acc: 0.647 Test Loss: 22.567 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.367950439453125
Epoch: 23, Steps: 34 | Train Loss: 0.692 Vali Loss: 14.157 Vali Acc: 0.740 Test Loss: 14.157 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 4329963
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.649502992630005
Epoch: 1, Steps: 34 | Train Loss: 7.050 Vali Loss: 8.661 Vali Acc: 0.382 Test Loss: 8.661 Test Acc: 0.382
Validation loss decreased (inf --> -0.381416).  Saving model ...
Epoch: 2 cost time: 7.1259236335754395
Epoch: 2, Steps: 34 | Train Loss: 9.121 Vali Loss: 14.102 Vali Acc: 0.347 Test Loss: 14.102 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.3541364669799805
Epoch: 3, Steps: 34 | Train Loss: 11.072 Vali Loss: 17.621 Vali Acc: 0.405 Test Loss: 17.621 Test Acc: 0.405
Validation loss decreased (-0.381416 --> -0.404448).  Saving model ...
Epoch: 4 cost time: 8.616298198699951
Epoch: 4, Steps: 34 | Train Loss: 13.806 Vali Loss: 31.009 Vali Acc: 0.434 Test Loss: 31.009 Test Acc: 0.434
Validation loss decreased (-0.404448 --> -0.433216).  Saving model ...
Epoch: 5 cost time: 7.289282321929932
Epoch: 5, Steps: 34 | Train Loss: 12.028 Vali Loss: 29.777 Vali Acc: 0.382 Test Loss: 29.777 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.00610899925232
Epoch: 6, Steps: 34 | Train Loss: 10.317 Vali Loss: 26.347 Vali Acc: 0.387 Test Loss: 26.347 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.558884382247925
Epoch: 7, Steps: 34 | Train Loss: 13.773 Vali Loss: 22.985 Vali Acc: 0.578 Test Loss: 22.985 Test Acc: 0.578
Validation loss decreased (-0.433216 --> -0.577805).  Saving model ...
Epoch: 8 cost time: 6.901707172393799
Epoch: 8, Steps: 34 | Train Loss: 9.807 Vali Loss: 15.704 Vali Acc: 0.682 Test Loss: 15.704 Test Acc: 0.682
Validation loss decreased (-0.577805 --> -0.681924).  Saving model ...
Epoch: 9 cost time: 6.965588331222534
Epoch: 9, Steps: 34 | Train Loss: 5.979 Vali Loss: 10.715 Vali Acc: 0.723 Test Loss: 10.715 Test Acc: 0.723
Validation loss decreased (-0.681924 --> -0.722436).  Saving model ...
Epoch: 10 cost time: 6.969747304916382
Epoch: 10, Steps: 34 | Train Loss: 4.728 Vali Loss: 15.372 Vali Acc: 0.601 Test Loss: 15.372 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.975461483001709
Epoch: 11, Steps: 34 | Train Loss: 3.373 Vali Loss: 15.006 Vali Acc: 0.653 Test Loss: 15.006 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.875831127166748
Epoch: 12, Steps: 34 | Train Loss: 5.927 Vali Loss: 11.236 Vali Acc: 0.746 Test Loss: 11.236 Test Acc: 0.746
Validation loss decreased (-0.722436 --> -0.745552).  Saving model ...
Epoch: 13 cost time: 7.079021453857422
Epoch: 13, Steps: 34 | Train Loss: 4.805 Vali Loss: 10.446 Vali Acc: 0.746 Test Loss: 10.446 Test Acc: 0.746
Validation loss decreased (-0.745552 --> -0.745560).  Saving model ...
Epoch: 14 cost time: 6.794488191604614
Epoch: 14, Steps: 34 | Train Loss: 2.233 Vali Loss: 9.921 Vali Acc: 0.740 Test Loss: 9.921 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.216282367706299
Epoch: 15, Steps: 34 | Train Loss: 1.889 Vali Loss: 6.708 Vali Acc: 0.786 Test Loss: 6.708 Test Acc: 0.786
Validation loss decreased (-0.745560 --> -0.786060).  Saving model ...
Epoch: 16 cost time: 6.772014856338501
Epoch: 16, Steps: 34 | Train Loss: 1.958 Vali Loss: 7.983 Vali Acc: 0.775 Test Loss: 7.983 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.885821580886841
Epoch: 17, Steps: 34 | Train Loss: 0.984 Vali Loss: 7.929 Vali Acc: 0.740 Test Loss: 7.929 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.846257448196411
Epoch: 18, Steps: 34 | Train Loss: 3.238 Vali Loss: 11.636 Vali Acc: 0.775 Test Loss: 11.636 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.114087104797363
Epoch: 19, Steps: 34 | Train Loss: 1.544 Vali Loss: 7.258 Vali Acc: 0.838 Test Loss: 7.258 Test Acc: 0.838
Validation loss decreased (-0.786060 --> -0.838078).  Saving model ...
Epoch: 20 cost time: 6.96272873878479
Epoch: 20, Steps: 34 | Train Loss: 1.294 Vali Loss: 6.439 Vali Acc: 0.803 Test Loss: 6.439 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.8262763023376465
Epoch: 21, Steps: 34 | Train Loss: 0.589 Vali Loss: 6.141 Vali Acc: 0.815 Test Loss: 6.141 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.862690448760986
Epoch: 22, Steps: 34 | Train Loss: 0.170 Vali Loss: 13.145 Vali Acc: 0.780 Test Loss: 13.145 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.437540531158447
Epoch: 23, Steps: 34 | Train Loss: 0.389 Vali Loss: 14.248 Vali Acc: 0.798 Test Loss: 14.248 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.290300607681274
Epoch: 24, Steps: 34 | Train Loss: 0.252 Vali Loss: 5.825 Vali Acc: 0.827 Test Loss: 5.825 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.937537908554077
Epoch: 25, Steps: 34 | Train Loss: 1.087 Vali Loss: 6.896 Vali Acc: 0.838 Test Loss: 6.896 Test Acc: 0.838
Validation loss decreased (-0.838078 --> -0.838081).  Saving model ...
Epoch: 26 cost time: 7.374536037445068
Epoch: 26, Steps: 34 | Train Loss: 3.619 Vali Loss: 8.719 Vali Acc: 0.821 Test Loss: 8.719 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.4741809368133545
Epoch: 27, Steps: 34 | Train Loss: 1.159 Vali Loss: 8.691 Vali Acc: 0.803 Test Loss: 8.691 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.460042953491211
Epoch: 28, Steps: 34 | Train Loss: 0.862 Vali Loss: 35.962 Vali Acc: 0.526 Test Loss: 35.962 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.16719388961792
Epoch: 29, Steps: 34 | Train Loss: 2.230 Vali Loss: 12.676 Vali Acc: 0.746 Test Loss: 12.676 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.093526124954224
Epoch: 30, Steps: 34 | Train Loss: 2.375 Vali Loss: 8.126 Vali Acc: 0.821 Test Loss: 8.126 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.8921873569488525
Epoch: 31, Steps: 34 | Train Loss: 0.519 Vali Loss: 12.257 Vali Acc: 0.809 Test Loss: 12.257 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.709919452667236
Epoch: 32, Steps: 34 | Train Loss: 2.017 Vali Loss: 26.915 Vali Acc: 0.746 Test Loss: 26.915 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.849419832229614
Epoch: 33, Steps: 34 | Train Loss: 1.301 Vali Loss: 11.287 Vali Acc: 0.792 Test Loss: 11.287 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.990003347396851
Epoch: 34, Steps: 34 | Train Loss: 0.560 Vali Loss: 14.546 Vali Acc: 0.757 Test Loss: 14.546 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.147790431976318
Epoch: 35, Steps: 34 | Train Loss: 0.819 Vali Loss: 13.873 Vali Acc: 0.757 Test Loss: 13.873 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 4003179
model size : 16.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.690932989120483
Epoch: 1, Steps: 34 | Train Loss: 5.180 Vali Loss: 5.204 Vali Acc: 0.341 Test Loss: 5.204 Test Acc: 0.341
Validation loss decreased (inf --> -0.340988).  Saving model ...
Epoch: 2 cost time: 7.0622453689575195
Epoch: 2, Steps: 34 | Train Loss: 6.942 Vali Loss: 9.902 Vali Acc: 0.428 Test Loss: 9.902 Test Acc: 0.428
Validation loss decreased (-0.340988 --> -0.427647).  Saving model ...
Epoch: 3 cost time: 6.925679683685303
Epoch: 3, Steps: 34 | Train Loss: 10.410 Vali Loss: 14.886 Vali Acc: 0.462 Test Loss: 14.886 Test Acc: 0.462
Validation loss decreased (-0.427647 --> -0.462279).  Saving model ...
Epoch: 4 cost time: 6.4113640785217285
Epoch: 4, Steps: 34 | Train Loss: 13.424 Vali Loss: 16.804 Vali Acc: 0.532 Test Loss: 16.804 Test Acc: 0.532
Validation loss decreased (-0.462279 --> -0.531624).  Saving model ...
Epoch: 5 cost time: 7.022941589355469
Epoch: 5, Steps: 34 | Train Loss: 9.553 Vali Loss: 17.685 Vali Acc: 0.468 Test Loss: 17.685 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.274070739746094
Epoch: 6, Steps: 34 | Train Loss: 13.862 Vali Loss: 15.842 Vali Acc: 0.561 Test Loss: 15.842 Test Acc: 0.561
Validation loss decreased (-0.531624 --> -0.560535).  Saving model ...
Epoch: 7 cost time: 8.26897931098938
Epoch: 7, Steps: 34 | Train Loss: 8.912 Vali Loss: 8.324 Vali Acc: 0.630 Test Loss: 8.324 Test Acc: 0.630
Validation loss decreased (-0.560535 --> -0.629975).  Saving model ...
Epoch: 8 cost time: 7.519876718521118
Epoch: 8, Steps: 34 | Train Loss: 8.095 Vali Loss: 10.876 Vali Acc: 0.734 Test Loss: 10.876 Test Acc: 0.734
Validation loss decreased (-0.629975 --> -0.733995).  Saving model ...
Epoch: 9 cost time: 7.382957220077515
Epoch: 9, Steps: 34 | Train Loss: 5.718 Vali Loss: 11.597 Vali Acc: 0.682 Test Loss: 11.597 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.830349445343018
Epoch: 10, Steps: 34 | Train Loss: 2.218 Vali Loss: 14.045 Vali Acc: 0.676 Test Loss: 14.045 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.307290315628052
Epoch: 11, Steps: 34 | Train Loss: 3.416 Vali Loss: 14.118 Vali Acc: 0.642 Test Loss: 14.118 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.628424167633057
Epoch: 12, Steps: 34 | Train Loss: 4.447 Vali Loss: 13.308 Vali Acc: 0.746 Test Loss: 13.308 Test Acc: 0.746
Validation loss decreased (-0.733995 --> -0.745532).  Saving model ...
Epoch: 13 cost time: 6.908998966217041
Epoch: 13, Steps: 34 | Train Loss: 3.422 Vali Loss: 22.255 Vali Acc: 0.590 Test Loss: 22.255 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.886469841003418
Epoch: 14, Steps: 34 | Train Loss: 2.192 Vali Loss: 7.279 Vali Acc: 0.815 Test Loss: 7.279 Test Acc: 0.815
Validation loss decreased (-0.745532 --> -0.814956).  Saving model ...
Epoch: 15 cost time: 6.4496753215789795
Epoch: 15, Steps: 34 | Train Loss: 1.583 Vali Loss: 14.253 Vali Acc: 0.671 Test Loss: 14.253 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.5860443115234375
Epoch: 16, Steps: 34 | Train Loss: 0.613 Vali Loss: 14.441 Vali Acc: 0.728 Test Loss: 14.441 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.181353807449341
Epoch: 17, Steps: 34 | Train Loss: 4.802 Vali Loss: 21.720 Vali Acc: 0.676 Test Loss: 21.720 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.8560631275177
Epoch: 18, Steps: 34 | Train Loss: 4.520 Vali Loss: 18.279 Vali Acc: 0.751 Test Loss: 18.279 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.894010782241821
Epoch: 19, Steps: 34 | Train Loss: 2.503 Vali Loss: 12.284 Vali Acc: 0.775 Test Loss: 12.284 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.907407760620117
Epoch: 20, Steps: 34 | Train Loss: 3.245 Vali Loss: 20.095 Vali Acc: 0.728 Test Loss: 20.095 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.204789638519287
Epoch: 21, Steps: 34 | Train Loss: 1.530 Vali Loss: 17.935 Vali Acc: 0.699 Test Loss: 17.935 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.072415351867676
Epoch: 22, Steps: 34 | Train Loss: 2.036 Vali Loss: 12.468 Vali Acc: 0.717 Test Loss: 12.468 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.702028751373291
Epoch: 23, Steps: 34 | Train Loss: 0.662 Vali Loss: 8.973 Vali Acc: 0.821 Test Loss: 8.973 Test Acc: 0.821
Validation loss decreased (-0.814956 --> -0.820720).  Saving model ...
Epoch: 24 cost time: 6.774124622344971
Epoch: 24, Steps: 34 | Train Loss: 0.131 Vali Loss: 14.104 Vali Acc: 0.728 Test Loss: 14.104 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.846662759780884
Epoch: 25, Steps: 34 | Train Loss: 2.263 Vali Loss: 13.466 Vali Acc: 0.757 Test Loss: 13.466 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.004131078720093
Epoch: 26, Steps: 34 | Train Loss: 0.249 Vali Loss: 24.555 Vali Acc: 0.728 Test Loss: 24.555 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.58930516242981
Epoch: 27, Steps: 34 | Train Loss: 5.129 Vali Loss: 24.893 Vali Acc: 0.676 Test Loss: 24.893 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.541894912719727
Epoch: 28, Steps: 34 | Train Loss: 2.217 Vali Loss: 19.953 Vali Acc: 0.734 Test Loss: 19.953 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.909130334854126
Epoch: 29, Steps: 34 | Train Loss: 0.705 Vali Loss: 15.582 Vali Acc: 0.803 Test Loss: 15.582 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.374283313751221
Epoch: 30, Steps: 34 | Train Loss: 0.672 Vali Loss: 25.635 Vali Acc: 0.798 Test Loss: 25.635 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 8.071587562561035
Epoch: 31, Steps: 34 | Train Loss: 1.242 Vali Loss: 11.367 Vali Acc: 0.798 Test Loss: 11.367 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.961047649383545
Epoch: 32, Steps: 34 | Train Loss: 1.598 Vali Loss: 14.738 Vali Acc: 0.798 Test Loss: 14.738 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.1588544845581055
Epoch: 33, Steps: 34 | Train Loss: 1.379 Vali Loss: 27.122 Vali Acc: 0.717 Test Loss: 27.122 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 4002027
model size : 16.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.531839847564697
Epoch: 1, Steps: 34 | Train Loss: 4.931 Vali Loss: 12.264 Vali Acc: 0.249 Test Loss: 12.264 Test Acc: 0.249
Validation loss decreased (inf --> -0.248432).  Saving model ...
Epoch: 2 cost time: 6.85645604133606
Epoch: 2, Steps: 34 | Train Loss: 8.818 Vali Loss: 20.757 Vali Acc: 0.254 Test Loss: 20.757 Test Acc: 0.254
Validation loss decreased (-0.248432 --> -0.254128).  Saving model ...
Epoch: 3 cost time: 6.834148168563843
Epoch: 3, Steps: 34 | Train Loss: 14.056 Vali Loss: 13.805 Vali Acc: 0.410 Test Loss: 13.805 Test Acc: 0.410
Validation loss decreased (-0.254128 --> -0.410267).  Saving model ...
Epoch: 4 cost time: 6.749884128570557
Epoch: 4, Steps: 34 | Train Loss: 8.705 Vali Loss: 10.709 Vali Acc: 0.653 Test Loss: 10.709 Test Acc: 0.653
Validation loss decreased (-0.410267 --> -0.653072).  Saving model ...
Epoch: 5 cost time: 7.153165102005005
Epoch: 5, Steps: 34 | Train Loss: 9.188 Vali Loss: 17.571 Vali Acc: 0.410 Test Loss: 17.571 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.860172510147095
Epoch: 6, Steps: 34 | Train Loss: 13.327 Vali Loss: 20.176 Vali Acc: 0.393 Test Loss: 20.176 Test Acc: 0.393
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.930931091308594
Epoch: 7, Steps: 34 | Train Loss: 10.601 Vali Loss: 14.864 Vali Acc: 0.549 Test Loss: 14.864 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.961148738861084
Epoch: 8, Steps: 34 | Train Loss: 12.033 Vali Loss: 30.511 Vali Acc: 0.590 Test Loss: 30.511 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.721737384796143
Epoch: 9, Steps: 34 | Train Loss: 5.789 Vali Loss: 11.902 Vali Acc: 0.688 Test Loss: 11.902 Test Acc: 0.688
Validation loss decreased (-0.653072 --> -0.687742).  Saving model ...
Epoch: 10 cost time: 7.099916934967041
Epoch: 10, Steps: 34 | Train Loss: 5.469 Vali Loss: 22.218 Vali Acc: 0.578 Test Loss: 22.218 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.9724814891815186
Epoch: 11, Steps: 34 | Train Loss: 4.432 Vali Loss: 6.204 Vali Acc: 0.728 Test Loss: 6.204 Test Acc: 0.728
Validation loss decreased (-0.687742 --> -0.728262).  Saving model ...
Epoch: 12 cost time: 6.6720356941223145
Epoch: 12, Steps: 34 | Train Loss: 2.379 Vali Loss: 20.611 Vali Acc: 0.503 Test Loss: 20.611 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.41962194442749
Epoch: 13, Steps: 34 | Train Loss: 1.558 Vali Loss: 26.341 Vali Acc: 0.607 Test Loss: 26.341 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.774019241333008
Epoch: 14, Steps: 34 | Train Loss: 3.760 Vali Loss: 16.992 Vali Acc: 0.624 Test Loss: 16.992 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.03805923461914
Epoch: 15, Steps: 34 | Train Loss: 2.800 Vali Loss: 6.203 Vali Acc: 0.763 Test Loss: 6.203 Test Acc: 0.763
Validation loss decreased (-0.728262 --> -0.762944).  Saving model ...
Epoch: 16 cost time: 7.646425485610962
Epoch: 16, Steps: 34 | Train Loss: 1.304 Vali Loss: 8.388 Vali Acc: 0.769 Test Loss: 8.388 Test Acc: 0.769
Validation loss decreased (-0.762944 --> -0.768702).  Saving model ...
Epoch: 17 cost time: 7.824265480041504
Epoch: 17, Steps: 34 | Train Loss: 2.346 Vali Loss: 17.474 Vali Acc: 0.711 Test Loss: 17.474 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.514043569564819
Epoch: 18, Steps: 34 | Train Loss: 1.276 Vali Loss: 17.552 Vali Acc: 0.728 Test Loss: 17.552 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.873114824295044
Epoch: 19, Steps: 34 | Train Loss: 1.096 Vali Loss: 12.139 Vali Acc: 0.780 Test Loss: 12.139 Test Acc: 0.780
Validation loss decreased (-0.768702 --> -0.780225).  Saving model ...
Epoch: 20 cost time: 6.715262413024902
Epoch: 20, Steps: 34 | Train Loss: 0.569 Vali Loss: 11.336 Vali Acc: 0.803 Test Loss: 11.336 Test Acc: 0.803
Validation loss decreased (-0.780225 --> -0.803355).  Saving model ...
Epoch: 21 cost time: 6.967615842819214
Epoch: 21, Steps: 34 | Train Loss: 0.404 Vali Loss: 7.394 Vali Acc: 0.861 Test Loss: 7.394 Test Acc: 0.861
Validation loss decreased (-0.803355 --> -0.861198).  Saving model ...
Epoch: 22 cost time: 6.795545816421509
Epoch: 22, Steps: 34 | Train Loss: 0.014 Vali Loss: 4.990 Vali Acc: 0.879 Test Loss: 4.990 Test Acc: 0.879
Validation loss decreased (-0.861198 --> -0.878563).  Saving model ...
Epoch: 23 cost time: 6.615389347076416
Epoch: 23, Steps: 34 | Train Loss: 0.177 Vali Loss: 8.409 Vali Acc: 0.786 Test Loss: 8.409 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.474642753601074
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 9.007 Vali Acc: 0.780 Test Loss: 9.007 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.808959245681763
Epoch: 25, Steps: 34 | Train Loss: 0.184 Vali Loss: 6.916 Vali Acc: 0.827 Test Loss: 6.916 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.886934280395508
Epoch: 26, Steps: 34 | Train Loss: 0.270 Vali Loss: 6.447 Vali Acc: 0.792 Test Loss: 6.447 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.906040906906128
Epoch: 27, Steps: 34 | Train Loss: 0.004 Vali Loss: 9.425 Vali Acc: 0.821 Test Loss: 9.425 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.807175874710083
Epoch: 28, Steps: 34 | Train Loss: 0.182 Vali Loss: 7.911 Vali Acc: 0.827 Test Loss: 7.911 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.60538387298584
Epoch: 29, Steps: 34 | Train Loss: 0.241 Vali Loss: 17.056 Vali Acc: 0.728 Test Loss: 17.056 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.82308292388916
Epoch: 30, Steps: 34 | Train Loss: 0.536 Vali Loss: 13.386 Vali Acc: 0.734 Test Loss: 13.386 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.855159044265747
Epoch: 31, Steps: 34 | Train Loss: 1.383 Vali Loss: 25.090 Vali Acc: 0.694 Test Loss: 25.090 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.9750566482543945
Epoch: 32, Steps: 34 | Train Loss: 1.662 Vali Loss: 9.847 Vali Acc: 0.803 Test Loss: 9.847 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 4000875
model size : 16.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.200554847717285
Epoch: 1, Steps: 34 | Train Loss: 6.021 Vali Loss: 10.730 Vali Acc: 0.329 Test Loss: 10.730 Test Acc: 0.329
Validation loss decreased (inf --> -0.329372).  Saving model ...
Epoch: 2 cost time: 7.31881046295166
Epoch: 2, Steps: 34 | Train Loss: 11.434 Vali Loss: 4.301 Vali Acc: 0.497 Test Loss: 4.301 Test Acc: 0.497
Validation loss decreased (-0.329372 --> -0.497067).  Saving model ...
Epoch: 3 cost time: 7.396685600280762
Epoch: 3, Steps: 34 | Train Loss: 11.306 Vali Loss: 29.288 Vali Acc: 0.254 Test Loss: 29.288 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.8162147998809814
Epoch: 4, Steps: 34 | Train Loss: 13.746 Vali Loss: 13.373 Vali Acc: 0.509 Test Loss: 13.373 Test Acc: 0.509
Validation loss decreased (-0.497067 --> -0.508537).  Saving model ...
Epoch: 5 cost time: 7.865116119384766
Epoch: 5, Steps: 34 | Train Loss: 7.600 Vali Loss: 12.500 Vali Acc: 0.486 Test Loss: 12.500 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.6287877559661865
Epoch: 6, Steps: 34 | Train Loss: 7.474 Vali Loss: 13.727 Vali Acc: 0.468 Test Loss: 13.727 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.588802099227905
Epoch: 7, Steps: 34 | Train Loss: 7.895 Vali Loss: 18.100 Vali Acc: 0.514 Test Loss: 18.100 Test Acc: 0.514
Validation loss decreased (-0.508537 --> -0.514270).  Saving model ...
Epoch: 8 cost time: 6.698749780654907
Epoch: 8, Steps: 34 | Train Loss: 3.825 Vali Loss: 7.543 Vali Acc: 0.688 Test Loss: 7.543 Test Acc: 0.688
Validation loss decreased (-0.514270 --> -0.687786).  Saving model ...
Epoch: 9 cost time: 6.646045684814453
Epoch: 9, Steps: 34 | Train Loss: 2.498 Vali Loss: 17.099 Vali Acc: 0.532 Test Loss: 17.099 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.829124689102173
Epoch: 10, Steps: 34 | Train Loss: 3.078 Vali Loss: 14.717 Vali Acc: 0.601 Test Loss: 14.717 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.445892810821533
Epoch: 11, Steps: 34 | Train Loss: 8.948 Vali Loss: 20.906 Vali Acc: 0.618 Test Loss: 20.906 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.748167514801025
Epoch: 12, Steps: 34 | Train Loss: 7.154 Vali Loss: 22.427 Vali Acc: 0.682 Test Loss: 22.427 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.687572479248047
Epoch: 13, Steps: 34 | Train Loss: 9.704 Vali Loss: 27.835 Vali Acc: 0.630 Test Loss: 27.835 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.019493341445923
Epoch: 14, Steps: 34 | Train Loss: 3.125 Vali Loss: 8.555 Vali Acc: 0.827 Test Loss: 8.555 Test Acc: 0.827
Validation loss decreased (-0.687786 --> -0.826504).  Saving model ...
Epoch: 15 cost time: 6.6575026512146
Epoch: 15, Steps: 34 | Train Loss: 2.222 Vali Loss: 13.781 Vali Acc: 0.746 Test Loss: 13.781 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.786092758178711
Epoch: 16, Steps: 34 | Train Loss: 1.339 Vali Loss: 9.797 Vali Acc: 0.751 Test Loss: 9.797 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.82196044921875
Epoch: 17, Steps: 34 | Train Loss: 0.652 Vali Loss: 7.688 Vali Acc: 0.809 Test Loss: 7.688 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.596903085708618
Epoch: 18, Steps: 34 | Train Loss: 1.059 Vali Loss: 18.465 Vali Acc: 0.717 Test Loss: 18.465 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.744089841842651
Epoch: 19, Steps: 34 | Train Loss: 0.930 Vali Loss: 17.839 Vali Acc: 0.705 Test Loss: 17.839 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.545742511749268
Epoch: 20, Steps: 34 | Train Loss: 0.603 Vali Loss: 10.989 Vali Acc: 0.798 Test Loss: 10.989 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.528324604034424
Epoch: 21, Steps: 34 | Train Loss: 0.669 Vali Loss: 7.711 Vali Acc: 0.780 Test Loss: 7.711 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.306581020355225
Epoch: 22, Steps: 34 | Train Loss: 0.715 Vali Loss: 26.280 Vali Acc: 0.613 Test Loss: 26.280 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.856785535812378
Epoch: 23, Steps: 34 | Train Loss: 1.822 Vali Loss: 19.027 Vali Acc: 0.694 Test Loss: 19.027 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.643524408340454
Epoch: 24, Steps: 34 | Train Loss: 0.942 Vali Loss: 9.962 Vali Acc: 0.798 Test Loss: 9.962 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3999723
model size : 16.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.266087770462036
Epoch: 1, Steps: 34 | Train Loss: 4.460 Vali Loss: 2.904 Vali Acc: 0.480 Test Loss: 2.904 Test Acc: 0.480
Validation loss decreased (inf --> -0.479740).  Saving model ...
Epoch: 2 cost time: 6.053699731826782
Epoch: 2, Steps: 34 | Train Loss: 5.027 Vali Loss: 15.153 Vali Acc: 0.353 Test Loss: 15.153 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.130094766616821
Epoch: 3, Steps: 34 | Train Loss: 6.842 Vali Loss: 9.394 Vali Acc: 0.474 Test Loss: 9.394 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.256535053253174
Epoch: 4, Steps: 34 | Train Loss: 6.214 Vali Loss: 17.139 Vali Acc: 0.364 Test Loss: 17.139 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.398632049560547
Epoch: 5, Steps: 34 | Train Loss: 11.490 Vali Loss: 18.473 Vali Acc: 0.503 Test Loss: 18.473 Test Acc: 0.503
Validation loss decreased (-0.479740 --> -0.502705).  Saving model ...
Epoch: 6 cost time: 5.945743799209595
Epoch: 6, Steps: 34 | Train Loss: 16.283 Vali Loss: 13.993 Vali Acc: 0.474 Test Loss: 13.993 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.57732892036438
Epoch: 7, Steps: 34 | Train Loss: 11.158 Vali Loss: 12.897 Vali Acc: 0.665 Test Loss: 12.897 Test Acc: 0.665
Validation loss decreased (-0.502705 --> -0.664611).  Saving model ...
Epoch: 8 cost time: 6.280200958251953
Epoch: 8, Steps: 34 | Train Loss: 5.689 Vali Loss: 10.767 Vali Acc: 0.653 Test Loss: 10.767 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.831769704818726
Epoch: 9, Steps: 34 | Train Loss: 2.276 Vali Loss: 9.495 Vali Acc: 0.665 Test Loss: 9.495 Test Acc: 0.665
Validation loss decreased (-0.664611 --> -0.664645).  Saving model ...
Epoch: 10 cost time: 6.490495204925537
Epoch: 10, Steps: 34 | Train Loss: 2.265 Vali Loss: 14.870 Vali Acc: 0.607 Test Loss: 14.870 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.959705829620361
Epoch: 11, Steps: 34 | Train Loss: 5.574 Vali Loss: 8.157 Vali Acc: 0.630 Test Loss: 8.157 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.466904163360596
Epoch: 12, Steps: 34 | Train Loss: 8.131 Vali Loss: 38.984 Vali Acc: 0.474 Test Loss: 38.984 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.424644231796265
Epoch: 13, Steps: 34 | Train Loss: 4.484 Vali Loss: 13.589 Vali Acc: 0.653 Test Loss: 13.589 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.107590675354004
Epoch: 14, Steps: 34 | Train Loss: 3.955 Vali Loss: 6.162 Vali Acc: 0.855 Test Loss: 6.162 Test Acc: 0.855
Validation loss decreased (-0.664645 --> -0.855430).  Saving model ...
Epoch: 15 cost time: 6.343240737915039
Epoch: 15, Steps: 34 | Train Loss: 0.689 Vali Loss: 5.474 Vali Acc: 0.803 Test Loss: 5.474 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.910937309265137
Epoch: 16, Steps: 34 | Train Loss: 0.450 Vali Loss: 5.566 Vali Acc: 0.850 Test Loss: 5.566 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.094853639602661
Epoch: 17, Steps: 34 | Train Loss: 0.753 Vali Loss: 7.720 Vali Acc: 0.769 Test Loss: 7.720 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.370976686477661
Epoch: 18, Steps: 34 | Train Loss: 2.004 Vali Loss: 4.247 Vali Acc: 0.803 Test Loss: 4.247 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.395105361938477
Epoch: 19, Steps: 34 | Train Loss: 3.430 Vali Loss: 15.776 Vali Acc: 0.798 Test Loss: 15.776 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.591583967208862
Epoch: 20, Steps: 34 | Train Loss: 4.357 Vali Loss: 17.741 Vali Acc: 0.705 Test Loss: 17.741 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.631476163864136
Epoch: 21, Steps: 34 | Train Loss: 4.031 Vali Loss: 16.226 Vali Acc: 0.798 Test Loss: 16.226 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.019174814224243
Epoch: 22, Steps: 34 | Train Loss: 1.716 Vali Loss: 7.159 Vali Acc: 0.861 Test Loss: 7.159 Test Acc: 0.861
Validation loss decreased (-0.855430 --> -0.861200).  Saving model ...
Epoch: 23 cost time: 7.0459678173065186
Epoch: 23, Steps: 34 | Train Loss: 0.384 Vali Loss: 6.912 Vali Acc: 0.792 Test Loss: 6.912 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.232737064361572
Epoch: 24, Steps: 34 | Train Loss: 0.115 Vali Loss: 8.842 Vali Acc: 0.803 Test Loss: 8.842 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.3913655281066895
Epoch: 25, Steps: 34 | Train Loss: 0.420 Vali Loss: 9.360 Vali Acc: 0.809 Test Loss: 9.360 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.980179786682129
Epoch: 26, Steps: 34 | Train Loss: 0.075 Vali Loss: 11.676 Vali Acc: 0.821 Test Loss: 11.676 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.345049619674683
Epoch: 27, Steps: 34 | Train Loss: 0.205 Vali Loss: 10.100 Vali Acc: 0.821 Test Loss: 10.100 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.122168302536011
Epoch: 28, Steps: 34 | Train Loss: 0.173 Vali Loss: 8.865 Vali Acc: 0.821 Test Loss: 8.865 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.25870418548584
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 18.183 Vali Acc: 0.798 Test Loss: 18.183 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.47491192817688
Epoch: 30, Steps: 34 | Train Loss: 0.514 Vali Loss: 8.942 Vali Acc: 0.809 Test Loss: 8.942 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.23674464225769
Epoch: 31, Steps: 34 | Train Loss: 0.565 Vali Loss: 12.439 Vali Acc: 0.786 Test Loss: 12.439 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.254712820053101
Epoch: 32, Steps: 34 | Train Loss: 0.034 Vali Loss: 7.273 Vali Acc: 0.815 Test Loss: 7.273 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3838059
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.936312198638916
Epoch: 1, Steps: 34 | Train Loss: 5.625 Vali Loss: 8.324 Vali Acc: 0.249 Test Loss: 8.324 Test Acc: 0.249
Validation loss decreased (inf --> -0.248472).  Saving model ...
Epoch: 2 cost time: 6.14476203918457
Epoch: 2, Steps: 34 | Train Loss: 9.463 Vali Loss: 10.044 Vali Acc: 0.353 Test Loss: 10.044 Test Acc: 0.353
Validation loss decreased (-0.248472 --> -0.352501).  Saving model ...
Epoch: 3 cost time: 6.027441740036011
Epoch: 3, Steps: 34 | Train Loss: 19.407 Vali Loss: 29.550 Vali Acc: 0.497 Test Loss: 29.550 Test Acc: 0.497
Validation loss decreased (-0.352501 --> -0.496814).  Saving model ...
Epoch: 4 cost time: 5.896134614944458
Epoch: 4, Steps: 34 | Train Loss: 15.934 Vali Loss: 23.305 Vali Acc: 0.566 Test Loss: 23.305 Test Acc: 0.566
Validation loss decreased (-0.496814 --> -0.566241).  Saving model ...
Epoch: 5 cost time: 7.450606107711792
Epoch: 5, Steps: 34 | Train Loss: 14.681 Vali Loss: 16.973 Vali Acc: 0.439 Test Loss: 16.973 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.264357328414917
Epoch: 6, Steps: 34 | Train Loss: 11.719 Vali Loss: 19.599 Vali Acc: 0.578 Test Loss: 19.599 Test Acc: 0.578
Validation loss decreased (-0.566241 --> -0.577839).  Saving model ...
Epoch: 7 cost time: 6.929781913757324
Epoch: 7, Steps: 34 | Train Loss: 11.407 Vali Loss: 13.452 Vali Acc: 0.584 Test Loss: 13.452 Test Acc: 0.584
Validation loss decreased (-0.577839 --> -0.583681).  Saving model ...
Epoch: 8 cost time: 6.44154167175293
Epoch: 8, Steps: 34 | Train Loss: 7.123 Vali Loss: 6.453 Vali Acc: 0.751 Test Loss: 6.453 Test Acc: 0.751
Validation loss decreased (-0.583681 --> -0.751381).  Saving model ...
Epoch: 9 cost time: 6.740200042724609
Epoch: 9, Steps: 34 | Train Loss: 5.313 Vali Loss: 16.450 Vali Acc: 0.538 Test Loss: 16.450 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.1347880363464355
Epoch: 10, Steps: 34 | Train Loss: 4.910 Vali Loss: 15.600 Vali Acc: 0.584 Test Loss: 15.600 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.1017985343933105
Epoch: 11, Steps: 34 | Train Loss: 5.745 Vali Loss: 11.987 Vali Acc: 0.642 Test Loss: 11.987 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.182519912719727
Epoch: 12, Steps: 34 | Train Loss: 4.229 Vali Loss: 17.580 Vali Acc: 0.566 Test Loss: 17.580 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.284092426300049
Epoch: 13, Steps: 34 | Train Loss: 3.134 Vali Loss: 6.419 Vali Acc: 0.746 Test Loss: 6.419 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.27198600769043
Epoch: 14, Steps: 34 | Train Loss: 2.301 Vali Loss: 5.471 Vali Acc: 0.775 Test Loss: 5.471 Test Acc: 0.775
Validation loss decreased (-0.751381 --> -0.774512).  Saving model ...
Epoch: 15 cost time: 6.202575206756592
Epoch: 15, Steps: 34 | Train Loss: 1.019 Vali Loss: 8.903 Vali Acc: 0.786 Test Loss: 8.903 Test Acc: 0.786
Validation loss decreased (-0.774512 --> -0.786038).  Saving model ...
Epoch: 16 cost time: 6.119933605194092
Epoch: 16, Steps: 34 | Train Loss: 0.744 Vali Loss: 10.153 Vali Acc: 0.711 Test Loss: 10.153 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.493945598602295
Epoch: 17, Steps: 34 | Train Loss: 0.566 Vali Loss: 13.108 Vali Acc: 0.688 Test Loss: 13.108 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.917639493942261
Epoch: 18, Steps: 34 | Train Loss: 1.233 Vali Loss: 8.929 Vali Acc: 0.780 Test Loss: 8.929 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.108442544937134
Epoch: 19, Steps: 34 | Train Loss: 0.435 Vali Loss: 21.477 Vali Acc: 0.694 Test Loss: 21.477 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.446241617202759
Epoch: 20, Steps: 34 | Train Loss: 1.017 Vali Loss: 19.395 Vali Acc: 0.642 Test Loss: 19.395 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.597238063812256
Epoch: 21, Steps: 34 | Train Loss: 2.131 Vali Loss: 13.951 Vali Acc: 0.671 Test Loss: 13.951 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.472812175750732
Epoch: 22, Steps: 34 | Train Loss: 1.660 Vali Loss: 8.857 Vali Acc: 0.809 Test Loss: 8.857 Test Acc: 0.809
Validation loss decreased (-0.786038 --> -0.809160).  Saving model ...
Epoch: 23 cost time: 6.279398202896118
Epoch: 23, Steps: 34 | Train Loss: 1.610 Vali Loss: 7.911 Vali Acc: 0.780 Test Loss: 7.911 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.198583602905273
Epoch: 24, Steps: 34 | Train Loss: 1.785 Vali Loss: 14.392 Vali Acc: 0.769 Test Loss: 14.392 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.090744733810425
Epoch: 25, Steps: 34 | Train Loss: 0.817 Vali Loss: 12.650 Vali Acc: 0.757 Test Loss: 12.650 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.572505950927734
Epoch: 26, Steps: 34 | Train Loss: 0.502 Vali Loss: 11.623 Vali Acc: 0.775 Test Loss: 11.623 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.244707345962524
Epoch: 27, Steps: 34 | Train Loss: 0.779 Vali Loss: 9.324 Vali Acc: 0.803 Test Loss: 9.324 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.045730113983154
Epoch: 28, Steps: 34 | Train Loss: 0.252 Vali Loss: 13.654 Vali Acc: 0.775 Test Loss: 13.654 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.008941173553467
Epoch: 29, Steps: 34 | Train Loss: 0.822 Vali Loss: 11.506 Vali Acc: 0.798 Test Loss: 11.506 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.6532511711120605
Epoch: 30, Steps: 34 | Train Loss: 1.148 Vali Loss: 12.567 Vali Acc: 0.769 Test Loss: 12.567 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.989233016967773
Epoch: 31, Steps: 34 | Train Loss: 0.647 Vali Loss: 18.865 Vali Acc: 0.746 Test Loss: 18.865 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.028674602508545
Epoch: 32, Steps: 34 | Train Loss: 0.362 Vali Loss: 11.896 Vali Acc: 0.775 Test Loss: 11.896 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 3836907
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.95629096031189
Epoch: 1, Steps: 34 | Train Loss: 4.555 Vali Loss: 4.323 Vali Acc: 0.393 Test Loss: 4.323 Test Acc: 0.393
Validation loss decreased (inf --> -0.393020).  Saving model ...
Epoch: 2 cost time: 6.1946635246276855
Epoch: 2, Steps: 34 | Train Loss: 8.936 Vali Loss: 9.983 Vali Acc: 0.277 Test Loss: 9.983 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0975182056427
Epoch: 3, Steps: 34 | Train Loss: 8.008 Vali Loss: 12.513 Vali Acc: 0.399 Test Loss: 12.513 Test Acc: 0.399
Validation loss decreased (-0.393020 --> -0.398719).  Saving model ...
Epoch: 4 cost time: 5.752885341644287
Epoch: 4, Steps: 34 | Train Loss: 11.604 Vali Loss: 19.895 Vali Acc: 0.509 Test Loss: 19.895 Test Acc: 0.509
Validation loss decreased (-0.398719 --> -0.508472).  Saving model ...
Epoch: 5 cost time: 5.880621671676636
Epoch: 5, Steps: 34 | Train Loss: 11.160 Vali Loss: 13.084 Vali Acc: 0.636 Test Loss: 13.084 Test Acc: 0.636
Validation loss decreased (-0.508472 --> -0.635707).  Saving model ...
Epoch: 6 cost time: 6.447981357574463
Epoch: 6, Steps: 34 | Train Loss: 11.541 Vali Loss: 14.172 Vali Acc: 0.538 Test Loss: 14.172 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.2881178855896
Epoch: 7, Steps: 34 | Train Loss: 6.957 Vali Loss: 16.860 Vali Acc: 0.566 Test Loss: 16.860 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.006225109100342
Epoch: 8, Steps: 34 | Train Loss: 4.812 Vali Loss: 12.974 Vali Acc: 0.578 Test Loss: 12.974 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.032306432723999
Epoch: 9, Steps: 34 | Train Loss: 9.080 Vali Loss: 13.855 Vali Acc: 0.705 Test Loss: 13.855 Test Acc: 0.705
Validation loss decreased (-0.635707 --> -0.705064).  Saving model ...
Epoch: 10 cost time: 6.128190755844116
Epoch: 10, Steps: 34 | Train Loss: 9.516 Vali Loss: 22.539 Vali Acc: 0.555 Test Loss: 22.539 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.973906755447388
Epoch: 11, Steps: 34 | Train Loss: 7.879 Vali Loss: 22.399 Vali Acc: 0.642 Test Loss: 22.399 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.199706792831421
Epoch: 12, Steps: 34 | Train Loss: 3.427 Vali Loss: 8.216 Vali Acc: 0.717 Test Loss: 8.216 Test Acc: 0.717
Validation loss decreased (-0.705064 --> -0.716681).  Saving model ...
Epoch: 13 cost time: 6.193694591522217
Epoch: 13, Steps: 34 | Train Loss: 5.736 Vali Loss: 17.749 Vali Acc: 0.682 Test Loss: 17.749 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.934736967086792
Epoch: 14, Steps: 34 | Train Loss: 3.745 Vali Loss: 9.841 Vali Acc: 0.769 Test Loss: 9.841 Test Acc: 0.769
Validation loss decreased (-0.716681 --> -0.768688).  Saving model ...
Epoch: 15 cost time: 7.048793315887451
Epoch: 15, Steps: 34 | Train Loss: 2.679 Vali Loss: 6.754 Vali Acc: 0.780 Test Loss: 6.754 Test Acc: 0.780
Validation loss decreased (-0.768688 --> -0.780279).  Saving model ...
Epoch: 16 cost time: 6.773549795150757
Epoch: 16, Steps: 34 | Train Loss: 1.098 Vali Loss: 8.965 Vali Acc: 0.734 Test Loss: 8.965 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.569761753082275
Epoch: 17, Steps: 34 | Train Loss: 0.933 Vali Loss: 17.497 Vali Acc: 0.699 Test Loss: 17.497 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.029630899429321
Epoch: 18, Steps: 34 | Train Loss: 1.499 Vali Loss: 16.753 Vali Acc: 0.751 Test Loss: 16.753 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.349644184112549
Epoch: 19, Steps: 34 | Train Loss: 0.514 Vali Loss: 13.999 Vali Acc: 0.717 Test Loss: 13.999 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.89212703704834
Epoch: 20, Steps: 34 | Train Loss: 2.119 Vali Loss: 4.936 Vali Acc: 0.855 Test Loss: 4.936 Test Acc: 0.855
Validation loss decreased (-0.780279 --> -0.855442).  Saving model ...
Epoch: 21 cost time: 6.6403703689575195
Epoch: 21, Steps: 34 | Train Loss: 1.620 Vali Loss: 12.506 Vali Acc: 0.786 Test Loss: 12.506 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.757394552230835
Epoch: 22, Steps: 34 | Train Loss: 1.881 Vali Loss: 11.028 Vali Acc: 0.792 Test Loss: 11.028 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.170818328857422
Epoch: 23, Steps: 34 | Train Loss: 2.800 Vali Loss: 12.163 Vali Acc: 0.827 Test Loss: 12.163 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.0854856967926025
Epoch: 24, Steps: 34 | Train Loss: 2.405 Vali Loss: 9.893 Vali Acc: 0.815 Test Loss: 9.893 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.050584077835083
Epoch: 25, Steps: 34 | Train Loss: 1.129 Vali Loss: 31.486 Vali Acc: 0.676 Test Loss: 31.486 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.876746416091919
Epoch: 26, Steps: 34 | Train Loss: 1.624 Vali Loss: 8.694 Vali Acc: 0.815 Test Loss: 8.694 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.859018802642822
Epoch: 27, Steps: 34 | Train Loss: 1.183 Vali Loss: 15.525 Vali Acc: 0.711 Test Loss: 15.525 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.350823402404785
Epoch: 28, Steps: 34 | Train Loss: 0.538 Vali Loss: 12.729 Vali Acc: 0.728 Test Loss: 12.729 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.155192852020264
Epoch: 29, Steps: 34 | Train Loss: 0.926 Vali Loss: 18.314 Vali Acc: 0.711 Test Loss: 18.314 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.412395477294922
Epoch: 30, Steps: 34 | Train Loss: 0.900 Vali Loss: 10.575 Vali Acc: 0.815 Test Loss: 10.575 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 3835755
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.580565929412842
Epoch: 1, Steps: 34 | Train Loss: 5.494 Vali Loss: 6.396 Vali Acc: 0.329 Test Loss: 6.396 Test Acc: 0.329
Validation loss decreased (inf --> -0.329416).  Saving model ...
Epoch: 2 cost time: 5.37115478515625
Epoch: 2, Steps: 34 | Train Loss: 6.051 Vali Loss: 4.823 Vali Acc: 0.491 Test Loss: 4.823 Test Acc: 0.491
Validation loss decreased (-0.329416 --> -0.491281).  Saving model ...
Epoch: 3 cost time: 5.681001663208008
Epoch: 3, Steps: 34 | Train Loss: 8.396 Vali Loss: 29.367 Vali Acc: 0.376 Test Loss: 29.367 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.238734245300293
Epoch: 4, Steps: 34 | Train Loss: 13.560 Vali Loss: 11.591 Vali Acc: 0.555 Test Loss: 11.591 Test Acc: 0.555
Validation loss decreased (-0.491281 --> -0.554797).  Saving model ...
Epoch: 5 cost time: 7.071466684341431
Epoch: 5, Steps: 34 | Train Loss: 11.739 Vali Loss: 10.183 Vali Acc: 0.590 Test Loss: 10.183 Test Acc: 0.590
Validation loss decreased (-0.554797 --> -0.589494).  Saving model ...
Epoch: 6 cost time: 6.885225057601929
Epoch: 6, Steps: 34 | Train Loss: 10.147 Vali Loss: 8.347 Vali Acc: 0.665 Test Loss: 8.347 Test Acc: 0.665
Validation loss decreased (-0.589494 --> -0.664656).  Saving model ...
Epoch: 7 cost time: 6.6126368045806885
Epoch: 7, Steps: 34 | Train Loss: 13.108 Vali Loss: 25.828 Vali Acc: 0.659 Test Loss: 25.828 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.3583526611328125
Epoch: 8, Steps: 34 | Train Loss: 17.460 Vali Loss: 21.280 Vali Acc: 0.543 Test Loss: 21.280 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.833139181137085
Epoch: 9, Steps: 34 | Train Loss: 13.312 Vali Loss: 5.509 Vali Acc: 0.775 Test Loss: 5.509 Test Acc: 0.775
Validation loss decreased (-0.664656 --> -0.774511).  Saving model ...
Epoch: 10 cost time: 7.297030687332153
Epoch: 10, Steps: 34 | Train Loss: 5.149 Vali Loss: 23.986 Vali Acc: 0.590 Test Loss: 23.986 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.604687452316284
Epoch: 11, Steps: 34 | Train Loss: 2.474 Vali Loss: 20.235 Vali Acc: 0.566 Test Loss: 20.235 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.600056171417236
Epoch: 12, Steps: 34 | Train Loss: 4.271 Vali Loss: 12.804 Vali Acc: 0.757 Test Loss: 12.804 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.286867618560791
Epoch: 13, Steps: 34 | Train Loss: 1.667 Vali Loss: 8.767 Vali Acc: 0.734 Test Loss: 8.767 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.267673015594482
Epoch: 14, Steps: 34 | Train Loss: 1.056 Vali Loss: 13.827 Vali Acc: 0.665 Test Loss: 13.827 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.004495620727539
Epoch: 15, Steps: 34 | Train Loss: 2.091 Vali Loss: 13.293 Vali Acc: 0.723 Test Loss: 13.293 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.541095972061157
Epoch: 16, Steps: 34 | Train Loss: 1.239 Vali Loss: 32.441 Vali Acc: 0.520 Test Loss: 32.441 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.850017070770264
Epoch: 17, Steps: 34 | Train Loss: 3.163 Vali Loss: 12.282 Vali Acc: 0.751 Test Loss: 12.282 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.848873853683472
Epoch: 18, Steps: 34 | Train Loss: 0.912 Vali Loss: 5.378 Vali Acc: 0.803 Test Loss: 5.378 Test Acc: 0.803
Validation loss decreased (-0.774511 --> -0.803414).  Saving model ...
Epoch: 19 cost time: 5.843783140182495
Epoch: 19, Steps: 34 | Train Loss: 0.433 Vali Loss: 7.248 Vali Acc: 0.803 Test Loss: 7.248 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.100230932235718
Epoch: 20, Steps: 34 | Train Loss: 0.594 Vali Loss: 18.406 Vali Acc: 0.711 Test Loss: 18.406 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.152820110321045
Epoch: 21, Steps: 34 | Train Loss: 2.082 Vali Loss: 7.140 Vali Acc: 0.815 Test Loss: 7.140 Test Acc: 0.815
Validation loss decreased (-0.803414 --> -0.814958).  Saving model ...
Epoch: 22 cost time: 5.597444772720337
Epoch: 22, Steps: 34 | Train Loss: 1.328 Vali Loss: 9.116 Vali Acc: 0.717 Test Loss: 9.116 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.351281642913818
Epoch: 23, Steps: 34 | Train Loss: 0.202 Vali Loss: 10.334 Vali Acc: 0.746 Test Loss: 10.334 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.99708890914917
Epoch: 24, Steps: 34 | Train Loss: 0.703 Vali Loss: 6.646 Vali Acc: 0.850 Test Loss: 6.646 Test Acc: 0.850
Validation loss decreased (-0.814958 --> -0.849645).  Saving model ...
Epoch: 25 cost time: 5.982680797576904
Epoch: 25, Steps: 34 | Train Loss: 0.310 Vali Loss: 12.652 Vali Acc: 0.734 Test Loss: 12.652 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.162073373794556
Epoch: 26, Steps: 34 | Train Loss: 0.300 Vali Loss: 9.050 Vali Acc: 0.792 Test Loss: 9.050 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.61014723777771
Epoch: 27, Steps: 34 | Train Loss: 0.411 Vali Loss: 14.040 Vali Acc: 0.769 Test Loss: 14.040 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.733982801437378
Epoch: 28, Steps: 34 | Train Loss: 0.434 Vali Loss: 17.508 Vali Acc: 0.746 Test Loss: 17.508 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.064053535461426
Epoch: 29, Steps: 34 | Train Loss: 0.408 Vali Loss: 8.652 Vali Acc: 0.792 Test Loss: 8.652 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.663879632949829
Epoch: 30, Steps: 34 | Train Loss: 0.201 Vali Loss: 11.087 Vali Acc: 0.763 Test Loss: 11.087 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.049068927764893
Epoch: 31, Steps: 34 | Train Loss: 0.394 Vali Loss: 5.747 Vali Acc: 0.861 Test Loss: 5.747 Test Acc: 0.861
Validation loss decreased (-0.849645 --> -0.861214).  Saving model ...
Epoch: 32 cost time: 6.89252495765686
Epoch: 32, Steps: 34 | Train Loss: 0.388 Vali Loss: 10.817 Vali Acc: 0.780 Test Loss: 10.817 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.365745306015015
Epoch: 33, Steps: 34 | Train Loss: 1.406 Vali Loss: 19.440 Vali Acc: 0.786 Test Loss: 19.440 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.817705154418945
Epoch: 34, Steps: 34 | Train Loss: 0.578 Vali Loss: 19.856 Vali Acc: 0.746 Test Loss: 19.856 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.2806642055511475
Epoch: 35, Steps: 34 | Train Loss: 1.403 Vali Loss: 7.888 Vali Acc: 0.827 Test Loss: 7.888 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 7.111564874649048
Epoch: 36, Steps: 34 | Train Loss: 0.471 Vali Loss: 9.003 Vali Acc: 0.809 Test Loss: 9.003 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 7.084745645523071
Epoch: 37, Steps: 34 | Train Loss: 1.833 Vali Loss: 16.074 Vali Acc: 0.757 Test Loss: 16.074 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 6.485621929168701
Epoch: 38, Steps: 34 | Train Loss: 0.791 Vali Loss: 17.564 Vali Acc: 0.792 Test Loss: 17.564 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.907825708389282
Epoch: 39, Steps: 34 | Train Loss: 1.161 Vali Loss: 11.783 Vali Acc: 0.792 Test Loss: 11.783 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 5.621876239776611
Epoch: 40, Steps: 34 | Train Loss: 1.707 Vali Loss: 16.148 Vali Acc: 0.780 Test Loss: 16.148 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 6.165096282958984
Epoch: 41, Steps: 34 | Train Loss: 0.670 Vali Loss: 21.754 Vali Acc: 0.751 Test Loss: 21.754 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3834603
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.959535837173462
Epoch: 1, Steps: 34 | Train Loss: 6.202 Vali Loss: 10.451 Vali Acc: 0.237 Test Loss: 10.451 Test Acc: 0.237
Validation loss decreased (inf --> -0.236890).  Saving model ...
Epoch: 2 cost time: 5.637137413024902
Epoch: 2, Steps: 34 | Train Loss: 9.422 Vali Loss: 14.001 Vali Acc: 0.324 Test Loss: 14.001 Test Acc: 0.324
Validation loss decreased (-0.236890 --> -0.323559).  Saving model ...
Epoch: 3 cost time: 6.452640056610107
Epoch: 3, Steps: 34 | Train Loss: 9.018 Vali Loss: 15.081 Vali Acc: 0.491 Test Loss: 15.081 Test Acc: 0.491
Validation loss decreased (-0.323559 --> -0.491179).  Saving model ...
Epoch: 4 cost time: 5.729053497314453
Epoch: 4, Steps: 34 | Train Loss: 6.989 Vali Loss: 9.744 Vali Acc: 0.509 Test Loss: 9.744 Test Acc: 0.509
Validation loss decreased (-0.491179 --> -0.508573).  Saving model ...
Epoch: 5 cost time: 6.178563833236694
Epoch: 5, Steps: 34 | Train Loss: 8.437 Vali Loss: 14.449 Vali Acc: 0.601 Test Loss: 14.449 Test Acc: 0.601
Validation loss decreased (-0.508573 --> -0.601012).  Saving model ...
Epoch: 6 cost time: 5.746816396713257
Epoch: 6, Steps: 34 | Train Loss: 11.507 Vali Loss: 18.258 Vali Acc: 0.462 Test Loss: 18.258 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.771124362945557
Epoch: 7, Steps: 34 | Train Loss: 7.810 Vali Loss: 14.343 Vali Acc: 0.497 Test Loss: 14.343 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.235445022583008
Epoch: 8, Steps: 34 | Train Loss: 6.501 Vali Loss: 15.307 Vali Acc: 0.699 Test Loss: 15.307 Test Acc: 0.699
Validation loss decreased (-0.601012 --> -0.699269).  Saving model ...
Epoch: 9 cost time: 6.031817197799683
Epoch: 9, Steps: 34 | Train Loss: 5.655 Vali Loss: 6.984 Vali Acc: 0.723 Test Loss: 6.984 Test Acc: 0.723
Validation loss decreased (-0.699269 --> -0.722474).  Saving model ...
Epoch: 10 cost time: 6.164780855178833
Epoch: 10, Steps: 34 | Train Loss: 3.256 Vali Loss: 22.385 Vali Acc: 0.647 Test Loss: 22.385 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.65303373336792
Epoch: 11, Steps: 34 | Train Loss: 4.442 Vali Loss: 13.375 Vali Acc: 0.671 Test Loss: 13.375 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.114705324172974
Epoch: 12, Steps: 34 | Train Loss: 2.535 Vali Loss: 8.086 Vali Acc: 0.734 Test Loss: 8.086 Test Acc: 0.734
Validation loss decreased (-0.722474 --> -0.734023).  Saving model ...
Epoch: 13 cost time: 7.106070041656494
Epoch: 13, Steps: 34 | Train Loss: 5.809 Vali Loss: 24.397 Vali Acc: 0.613 Test Loss: 24.397 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.300992965698242
Epoch: 14, Steps: 34 | Train Loss: 4.217 Vali Loss: 11.639 Vali Acc: 0.728 Test Loss: 11.639 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.258856534957886
Epoch: 15, Steps: 34 | Train Loss: 2.054 Vali Loss: 15.607 Vali Acc: 0.746 Test Loss: 15.607 Test Acc: 0.746
Validation loss decreased (-0.734023 --> -0.745509).  Saving model ...
Epoch: 16 cost time: 6.8264617919921875
Epoch: 16, Steps: 34 | Train Loss: 2.766 Vali Loss: 14.815 Vali Acc: 0.757 Test Loss: 14.815 Test Acc: 0.757
Validation loss decreased (-0.745509 --> -0.757077).  Saving model ...
Epoch: 17 cost time: 5.901416063308716
Epoch: 17, Steps: 34 | Train Loss: 1.275 Vali Loss: 17.224 Vali Acc: 0.699 Test Loss: 17.224 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.172458648681641
Epoch: 18, Steps: 34 | Train Loss: 2.194 Vali Loss: 16.818 Vali Acc: 0.769 Test Loss: 16.818 Test Acc: 0.769
Validation loss decreased (-0.757077 --> -0.768618).  Saving model ...
Epoch: 19 cost time: 6.299992561340332
Epoch: 19, Steps: 34 | Train Loss: 2.797 Vali Loss: 10.512 Vali Acc: 0.809 Test Loss: 10.512 Test Acc: 0.809
Validation loss decreased (-0.768618 --> -0.809143).  Saving model ...
Epoch: 20 cost time: 5.892237186431885
Epoch: 20, Steps: 34 | Train Loss: 0.476 Vali Loss: 10.598 Vali Acc: 0.809 Test Loss: 10.598 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.815047979354858
Epoch: 21, Steps: 34 | Train Loss: 0.199 Vali Loss: 18.291 Vali Acc: 0.734 Test Loss: 18.291 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.997163772583008
Epoch: 22, Steps: 34 | Train Loss: 0.122 Vali Loss: 6.409 Vali Acc: 0.832 Test Loss: 6.409 Test Acc: 0.832
Validation loss decreased (-0.809143 --> -0.832306).  Saving model ...
Epoch: 23 cost time: 6.227701187133789
Epoch: 23, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.369927406311035
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.051608324050903
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.894325256347656
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.158780097961426
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.171473264694214
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.207482099533081
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.72349739074707
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.186922311782837
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.519015312194824
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.832 Test Loss: 6.410 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3755499
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.500194787979126
Epoch: 1, Steps: 34 | Train Loss: 5.558 Vali Loss: 11.041 Vali Acc: 0.329 Test Loss: 11.041 Test Acc: 0.329
Validation loss decreased (inf --> -0.329369).  Saving model ...
Epoch: 2 cost time: 6.996557712554932
Epoch: 2, Steps: 34 | Train Loss: 8.425 Vali Loss: 3.724 Vali Acc: 0.451 Test Loss: 3.724 Test Acc: 0.451
Validation loss decreased (-0.329369 --> -0.450830).  Saving model ...
Epoch: 3 cost time: 6.698920726776123
Epoch: 3, Steps: 34 | Train Loss: 6.528 Vali Loss: 10.187 Vali Acc: 0.370 Test Loss: 10.187 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.575716018676758
Epoch: 4, Steps: 34 | Train Loss: 9.296 Vali Loss: 6.905 Vali Acc: 0.584 Test Loss: 6.905 Test Acc: 0.584
Validation loss decreased (-0.450830 --> -0.583746).  Saving model ...
Epoch: 5 cost time: 6.341845989227295
Epoch: 5, Steps: 34 | Train Loss: 15.764 Vali Loss: 20.275 Vali Acc: 0.387 Test Loss: 20.275 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.854615688323975
Epoch: 6, Steps: 34 | Train Loss: 8.586 Vali Loss: 22.262 Vali Acc: 0.613 Test Loss: 22.262 Test Acc: 0.613
Validation loss decreased (-0.583746 --> -0.612494).  Saving model ...
Epoch: 7 cost time: 5.7922704219818115
Epoch: 7, Steps: 34 | Train Loss: 15.792 Vali Loss: 10.790 Vali Acc: 0.618 Test Loss: 10.790 Test Acc: 0.618
Validation loss decreased (-0.612494 --> -0.618389).  Saving model ...
Epoch: 8 cost time: 6.19521689414978
Epoch: 8, Steps: 34 | Train Loss: 10.790 Vali Loss: 17.335 Vali Acc: 0.584 Test Loss: 17.335 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.105371475219727
Epoch: 9, Steps: 34 | Train Loss: 2.788 Vali Loss: 6.134 Vali Acc: 0.705 Test Loss: 6.134 Test Acc: 0.705
Validation loss decreased (-0.618389 --> -0.705141).  Saving model ...
Epoch: 10 cost time: 6.189758062362671
Epoch: 10, Steps: 34 | Train Loss: 1.535 Vali Loss: 12.189 Vali Acc: 0.671 Test Loss: 12.189 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.998459577560425
Epoch: 11, Steps: 34 | Train Loss: 4.976 Vali Loss: 8.206 Vali Acc: 0.757 Test Loss: 8.206 Test Acc: 0.757
Validation loss decreased (-0.705141 --> -0.757143).  Saving model ...
Epoch: 12 cost time: 5.878154516220093
Epoch: 12, Steps: 34 | Train Loss: 1.722 Vali Loss: 7.821 Vali Acc: 0.757 Test Loss: 7.821 Test Acc: 0.757
Validation loss decreased (-0.757143 --> -0.757147).  Saving model ...
Epoch: 13 cost time: 5.903028249740601
Epoch: 13, Steps: 34 | Train Loss: 2.483 Vali Loss: 11.097 Vali Acc: 0.717 Test Loss: 11.097 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.013125419616699
Epoch: 14, Steps: 34 | Train Loss: 4.688 Vali Loss: 8.476 Vali Acc: 0.809 Test Loss: 8.476 Test Acc: 0.809
Validation loss decreased (-0.757147 --> -0.809164).  Saving model ...
Epoch: 15 cost time: 6.164971113204956
Epoch: 15, Steps: 34 | Train Loss: 1.446 Vali Loss: 11.031 Vali Acc: 0.769 Test Loss: 11.031 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.036480903625488
Epoch: 16, Steps: 34 | Train Loss: 4.755 Vali Loss: 15.427 Vali Acc: 0.740 Test Loss: 15.427 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.871894598007202
Epoch: 17, Steps: 34 | Train Loss: 4.112 Vali Loss: 7.749 Vali Acc: 0.803 Test Loss: 7.749 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.002041816711426
Epoch: 18, Steps: 34 | Train Loss: 1.544 Vali Loss: 15.763 Vali Acc: 0.723 Test Loss: 15.763 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.763597726821899
Epoch: 19, Steps: 34 | Train Loss: 2.958 Vali Loss: 8.524 Vali Acc: 0.775 Test Loss: 8.524 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.580549955368042
Epoch: 20, Steps: 34 | Train Loss: 4.765 Vali Loss: 27.077 Vali Acc: 0.642 Test Loss: 27.077 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.330373525619507
Epoch: 21, Steps: 34 | Train Loss: 1.282 Vali Loss: 13.356 Vali Acc: 0.705 Test Loss: 13.356 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.620965003967285
Epoch: 22, Steps: 34 | Train Loss: 1.511 Vali Loss: 8.234 Vali Acc: 0.792 Test Loss: 8.234 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.79188084602356
Epoch: 23, Steps: 34 | Train Loss: 1.389 Vali Loss: 15.708 Vali Acc: 0.792 Test Loss: 15.708 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.764315605163574
Epoch: 24, Steps: 34 | Train Loss: 1.431 Vali Loss: 20.434 Vali Acc: 0.763 Test Loss: 20.434 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 3754347
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.643413543701172
Epoch: 1, Steps: 34 | Train Loss: 4.022 Vali Loss: 2.800 Vali Acc: 0.341 Test Loss: 2.800 Test Acc: 0.341
Validation loss decreased (inf --> -0.341012).  Saving model ...
Epoch: 2 cost time: 5.742092847824097
Epoch: 2, Steps: 34 | Train Loss: 6.478 Vali Loss: 8.524 Vali Acc: 0.451 Test Loss: 8.524 Test Acc: 0.451
Validation loss decreased (-0.341012 --> -0.450782).  Saving model ...
Epoch: 3 cost time: 5.813351392745972
Epoch: 3, Steps: 34 | Train Loss: 7.417 Vali Loss: 7.272 Vali Acc: 0.532 Test Loss: 7.272 Test Acc: 0.532
Validation loss decreased (-0.450782 --> -0.531719).  Saving model ...
Epoch: 4 cost time: 6.017608404159546
Epoch: 4, Steps: 34 | Train Loss: 6.705 Vali Loss: 8.566 Vali Acc: 0.434 Test Loss: 8.566 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.996829986572266
Epoch: 5, Steps: 34 | Train Loss: 7.992 Vali Loss: 14.211 Vali Acc: 0.416 Test Loss: 14.211 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.277483940124512
Epoch: 6, Steps: 34 | Train Loss: 13.253 Vali Loss: 44.770 Vali Acc: 0.393 Test Loss: 44.770 Test Acc: 0.393
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.900867938995361
Epoch: 7, Steps: 34 | Train Loss: 18.683 Vali Loss: 21.042 Vali Acc: 0.486 Test Loss: 21.042 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.0059709548950195
Epoch: 8, Steps: 34 | Train Loss: 11.060 Vali Loss: 11.334 Vali Acc: 0.659 Test Loss: 11.334 Test Acc: 0.659
Validation loss decreased (-0.531719 --> -0.658846).  Saving model ...
Epoch: 9 cost time: 5.89632511138916
Epoch: 9, Steps: 34 | Train Loss: 5.617 Vali Loss: 10.550 Vali Acc: 0.642 Test Loss: 10.550 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.234330892562866
Epoch: 10, Steps: 34 | Train Loss: 5.572 Vali Loss: 8.330 Vali Acc: 0.676 Test Loss: 8.330 Test Acc: 0.676
Validation loss decreased (-0.658846 --> -0.676217).  Saving model ...
Epoch: 11 cost time: 5.915107727050781
Epoch: 11, Steps: 34 | Train Loss: 3.929 Vali Loss: 14.176 Vali Acc: 0.636 Test Loss: 14.176 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.119019985198975
Epoch: 12, Steps: 34 | Train Loss: 3.523 Vali Loss: 18.973 Vali Acc: 0.711 Test Loss: 18.973 Test Acc: 0.711
Validation loss decreased (-0.676217 --> -0.710793).  Saving model ...
Epoch: 13 cost time: 6.02986478805542
Epoch: 13, Steps: 34 | Train Loss: 3.839 Vali Loss: 21.738 Vali Acc: 0.653 Test Loss: 21.738 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.027334213256836
Epoch: 14, Steps: 34 | Train Loss: 5.623 Vali Loss: 9.657 Vali Acc: 0.740 Test Loss: 9.657 Test Acc: 0.740
Validation loss decreased (-0.710793 --> -0.739788).  Saving model ...
Epoch: 15 cost time: 6.061095237731934
Epoch: 15, Steps: 34 | Train Loss: 1.551 Vali Loss: 10.682 Vali Acc: 0.757 Test Loss: 10.682 Test Acc: 0.757
Validation loss decreased (-0.739788 --> -0.757119).  Saving model ...
Epoch: 16 cost time: 6.188938617706299
Epoch: 16, Steps: 34 | Train Loss: 1.051 Vali Loss: 12.697 Vali Acc: 0.769 Test Loss: 12.697 Test Acc: 0.769
Validation loss decreased (-0.757119 --> -0.768659).  Saving model ...
Epoch: 17 cost time: 6.678081035614014
Epoch: 17, Steps: 34 | Train Loss: 2.872 Vali Loss: 12.596 Vali Acc: 0.717 Test Loss: 12.596 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.8594136238098145
Epoch: 18, Steps: 34 | Train Loss: 1.478 Vali Loss: 4.419 Vali Acc: 0.832 Test Loss: 4.419 Test Acc: 0.832
Validation loss decreased (-0.768659 --> -0.832326).  Saving model ...
Epoch: 19 cost time: 6.805507183074951
Epoch: 19, Steps: 34 | Train Loss: 0.658 Vali Loss: 10.065 Vali Acc: 0.821 Test Loss: 10.065 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.331501483917236
Epoch: 20, Steps: 34 | Train Loss: 0.351 Vali Loss: 12.480 Vali Acc: 0.775 Test Loss: 12.480 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.220821380615234
Epoch: 21, Steps: 34 | Train Loss: 0.452 Vali Loss: 6.191 Vali Acc: 0.873 Test Loss: 6.191 Test Acc: 0.873
Validation loss decreased (-0.832326 --> -0.872770).  Saving model ...
Epoch: 22 cost time: 6.855737924575806
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 7.468 Vali Acc: 0.838 Test Loss: 7.468 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.2847740650177
Epoch: 23, Steps: 34 | Train Loss: 1.154 Vali Loss: 11.572 Vali Acc: 0.827 Test Loss: 11.572 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.704846620559692
Epoch: 24, Steps: 34 | Train Loss: 1.885 Vali Loss: 26.690 Vali Acc: 0.642 Test Loss: 26.690 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.722328424453735
Epoch: 25, Steps: 34 | Train Loss: 3.204 Vali Loss: 11.405 Vali Acc: 0.775 Test Loss: 11.405 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.749695301055908
Epoch: 26, Steps: 34 | Train Loss: 2.871 Vali Loss: 36.543 Vali Acc: 0.647 Test Loss: 36.543 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.723541259765625
Epoch: 27, Steps: 34 | Train Loss: 3.849 Vali Loss: 9.100 Vali Acc: 0.775 Test Loss: 9.100 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.743189334869385
Epoch: 28, Steps: 34 | Train Loss: 4.071 Vali Loss: 34.155 Vali Acc: 0.642 Test Loss: 34.155 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.9191460609436035
Epoch: 29, Steps: 34 | Train Loss: 2.141 Vali Loss: 9.266 Vali Acc: 0.838 Test Loss: 9.266 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.081247806549072
Epoch: 30, Steps: 34 | Train Loss: 0.858 Vali Loss: 8.047 Vali Acc: 0.838 Test Loss: 8.047 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.904427766799927
Epoch: 31, Steps: 34 | Train Loss: 0.727 Vali Loss: 13.556 Vali Acc: 0.775 Test Loss: 13.556 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 3753195
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.634262561798096
Epoch: 1, Steps: 34 | Train Loss: 6.125 Vali Loss: 8.782 Vali Acc: 0.208 Test Loss: 8.782 Test Acc: 0.208
Validation loss decreased (inf --> -0.208005).  Saving model ...
Epoch: 2 cost time: 5.51435923576355
Epoch: 2, Steps: 34 | Train Loss: 10.518 Vali Loss: 16.340 Vali Acc: 0.405 Test Loss: 16.340 Test Acc: 0.405
Validation loss decreased (-0.208005 --> -0.404461).  Saving model ...
Epoch: 3 cost time: 5.522924900054932
Epoch: 3, Steps: 34 | Train Loss: 15.620 Vali Loss: 32.674 Vali Acc: 0.306 Test Loss: 32.674 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.552630186080933
Epoch: 4, Steps: 34 | Train Loss: 16.752 Vali Loss: 17.733 Vali Acc: 0.387 Test Loss: 17.733 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.688220262527466
Epoch: 5, Steps: 34 | Train Loss: 15.850 Vali Loss: 26.793 Vali Acc: 0.532 Test Loss: 26.793 Test Acc: 0.532
Validation loss decreased (-0.404461 --> -0.531524).  Saving model ...
Epoch: 6 cost time: 6.650851726531982
Epoch: 6, Steps: 34 | Train Loss: 24.027 Vali Loss: 14.454 Vali Acc: 0.636 Test Loss: 14.454 Test Acc: 0.636
Validation loss decreased (-0.531524 --> -0.635694).  Saving model ...
Epoch: 7 cost time: 6.782787799835205
Epoch: 7, Steps: 34 | Train Loss: 12.659 Vali Loss: 9.880 Vali Acc: 0.590 Test Loss: 9.880 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.360894203186035
Epoch: 8, Steps: 34 | Train Loss: 5.317 Vali Loss: 15.314 Vali Acc: 0.624 Test Loss: 15.314 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.18720006942749
Epoch: 9, Steps: 34 | Train Loss: 4.923 Vali Loss: 15.142 Vali Acc: 0.630 Test Loss: 15.142 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.590571403503418
Epoch: 10, Steps: 34 | Train Loss: 5.358 Vali Loss: 14.945 Vali Acc: 0.590 Test Loss: 14.945 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.672062635421753
Epoch: 11, Steps: 34 | Train Loss: 4.610 Vali Loss: 21.800 Vali Acc: 0.688 Test Loss: 21.800 Test Acc: 0.688
Validation loss decreased (-0.635694 --> -0.687643).  Saving model ...
Epoch: 12 cost time: 6.492994785308838
Epoch: 12, Steps: 34 | Train Loss: 3.043 Vali Loss: 16.074 Vali Acc: 0.699 Test Loss: 16.074 Test Acc: 0.699
Validation loss decreased (-0.687643 --> -0.699261).  Saving model ...
Epoch: 13 cost time: 5.420499563217163
Epoch: 13, Steps: 34 | Train Loss: 2.829 Vali Loss: 9.247 Vali Acc: 0.723 Test Loss: 9.247 Test Acc: 0.723
Validation loss decreased (-0.699261 --> -0.722451).  Saving model ...
Epoch: 14 cost time: 5.546355962753296
Epoch: 14, Steps: 34 | Train Loss: 2.241 Vali Loss: 14.738 Vali Acc: 0.665 Test Loss: 14.738 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.661884784698486
Epoch: 15, Steps: 34 | Train Loss: 6.809 Vali Loss: 22.844 Vali Acc: 0.659 Test Loss: 22.844 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.599702596664429
Epoch: 16, Steps: 34 | Train Loss: 4.367 Vali Loss: 14.243 Vali Acc: 0.728 Test Loss: 14.243 Test Acc: 0.728
Validation loss decreased (-0.722451 --> -0.728181).  Saving model ...
Epoch: 17 cost time: 5.651116847991943
Epoch: 17, Steps: 34 | Train Loss: 2.305 Vali Loss: 13.511 Vali Acc: 0.676 Test Loss: 13.511 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.624613046646118
Epoch: 18, Steps: 34 | Train Loss: 2.520 Vali Loss: 10.737 Vali Acc: 0.786 Test Loss: 10.737 Test Acc: 0.786
Validation loss decreased (-0.728181 --> -0.786020).  Saving model ...
Epoch: 19 cost time: 5.4688966274261475
Epoch: 19, Steps: 34 | Train Loss: 1.384 Vali Loss: 14.554 Vali Acc: 0.786 Test Loss: 14.554 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.7017998695373535
Epoch: 20, Steps: 34 | Train Loss: 1.220 Vali Loss: 7.221 Vali Acc: 0.844 Test Loss: 7.221 Test Acc: 0.844
Validation loss decreased (-0.786020 --> -0.843858).  Saving model ...
Epoch: 21 cost time: 5.420014142990112
Epoch: 21, Steps: 34 | Train Loss: 1.771 Vali Loss: 14.328 Vali Acc: 0.734 Test Loss: 14.328 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.677033424377441
Epoch: 22, Steps: 34 | Train Loss: 0.740 Vali Loss: 5.439 Vali Acc: 0.855 Test Loss: 5.439 Test Acc: 0.855
Validation loss decreased (-0.843858 --> -0.855437).  Saving model ...
Epoch: 23 cost time: 5.861002445220947
Epoch: 23, Steps: 34 | Train Loss: 0.872 Vali Loss: 17.122 Vali Acc: 0.699 Test Loss: 17.122 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.466095685958862
Epoch: 24, Steps: 34 | Train Loss: 1.014 Vali Loss: 17.122 Vali Acc: 0.746 Test Loss: 17.122 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.696492671966553
Epoch: 25, Steps: 34 | Train Loss: 0.448 Vali Loss: 16.082 Vali Acc: 0.798 Test Loss: 16.082 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.576372146606445
Epoch: 26, Steps: 34 | Train Loss: 1.412 Vali Loss: 9.430 Vali Acc: 0.769 Test Loss: 9.430 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.7598066329956055
Epoch: 27, Steps: 34 | Train Loss: 0.609 Vali Loss: 7.215 Vali Acc: 0.803 Test Loss: 7.215 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.705461740493774
Epoch: 28, Steps: 34 | Train Loss: 0.829 Vali Loss: 11.904 Vali Acc: 0.763 Test Loss: 11.904 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.414781332015991
Epoch: 29, Steps: 34 | Train Loss: 0.704 Vali Loss: 16.767 Vali Acc: 0.751 Test Loss: 16.767 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.48906397819519
Epoch: 30, Steps: 34 | Train Loss: 0.458 Vali Loss: 11.400 Vali Acc: 0.798 Test Loss: 11.400 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.421698093414307
Epoch: 31, Steps: 34 | Train Loss: 0.284 Vali Loss: 8.012 Vali Acc: 0.844 Test Loss: 8.012 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.22287130355835
Epoch: 32, Steps: 34 | Train Loss: 0.063 Vali Loss: 13.620 Vali Acc: 0.775 Test Loss: 13.620 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 3752043
model size : 15.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.55903697013855
Epoch: 1, Steps: 34 | Train Loss: 3.351 Vali Loss: 6.274 Vali Acc: 0.243 Test Loss: 6.274 Test Acc: 0.243
Validation loss decreased (inf --> -0.242712).  Saving model ...
Epoch: 2 cost time: 5.637169122695923
Epoch: 2, Steps: 34 | Train Loss: 3.200 Vali Loss: 3.868 Vali Acc: 0.277 Test Loss: 3.868 Test Acc: 0.277
Validation loss decreased (-0.242712 --> -0.277418).  Saving model ...
Epoch: 3 cost time: 5.905611753463745
Epoch: 3, Steps: 34 | Train Loss: 4.546 Vali Loss: 6.546 Vali Acc: 0.399 Test Loss: 6.546 Test Acc: 0.399
Validation loss decreased (-0.277418 --> -0.398778).  Saving model ...
Epoch: 4 cost time: 6.047237396240234
Epoch: 4, Steps: 34 | Train Loss: 5.487 Vali Loss: 7.270 Vali Acc: 0.497 Test Loss: 7.270 Test Acc: 0.497
Validation loss decreased (-0.398778 --> -0.497037).  Saving model ...
Epoch: 5 cost time: 6.013599872589111
Epoch: 5, Steps: 34 | Train Loss: 4.226 Vali Loss: 6.793 Vali Acc: 0.422 Test Loss: 6.793 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.819077968597412
Epoch: 6, Steps: 34 | Train Loss: 3.433 Vali Loss: 5.063 Vali Acc: 0.601 Test Loss: 5.063 Test Acc: 0.601
Validation loss decreased (-0.497037 --> -0.601105).  Saving model ...
Epoch: 7 cost time: 5.839494943618774
Epoch: 7, Steps: 34 | Train Loss: 2.968 Vali Loss: 2.843 Vali Acc: 0.757 Test Loss: 2.843 Test Acc: 0.757
Validation loss decreased (-0.601105 --> -0.757197).  Saving model ...
Epoch: 8 cost time: 5.921611070632935
Epoch: 8, Steps: 34 | Train Loss: 2.318 Vali Loss: 4.581 Vali Acc: 0.561 Test Loss: 4.581 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.9477033615112305
Epoch: 9, Steps: 34 | Train Loss: 1.397 Vali Loss: 5.703 Vali Acc: 0.618 Test Loss: 5.703 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.009284496307373
Epoch: 10, Steps: 34 | Train Loss: 0.971 Vali Loss: 2.868 Vali Acc: 0.775 Test Loss: 2.868 Test Acc: 0.775
Validation loss decreased (-0.757197 --> -0.774538).  Saving model ...
Epoch: 11 cost time: 6.084494590759277
Epoch: 11, Steps: 34 | Train Loss: 1.381 Vali Loss: 5.885 Vali Acc: 0.613 Test Loss: 5.885 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.964138746261597
Epoch: 12, Steps: 34 | Train Loss: 1.330 Vali Loss: 5.254 Vali Acc: 0.728 Test Loss: 5.254 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.869711637496948
Epoch: 13, Steps: 34 | Train Loss: 1.074 Vali Loss: 3.742 Vali Acc: 0.728 Test Loss: 3.742 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.867724895477295
Epoch: 14, Steps: 34 | Train Loss: 0.427 Vali Loss: 4.714 Vali Acc: 0.763 Test Loss: 4.714 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.067935466766357
Epoch: 15, Steps: 34 | Train Loss: 0.100 Vali Loss: 3.898 Vali Acc: 0.792 Test Loss: 3.898 Test Acc: 0.792
Validation loss decreased (-0.774538 --> -0.791869).  Saving model ...
Epoch: 16 cost time: 6.051300525665283
Epoch: 16, Steps: 34 | Train Loss: 0.132 Vali Loss: 6.291 Vali Acc: 0.647 Test Loss: 6.291 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.941220998764038
Epoch: 17, Steps: 34 | Train Loss: 0.605 Vali Loss: 1.607 Vali Acc: 0.861 Test Loss: 1.607 Test Acc: 0.861
Validation loss decreased (-0.791869 --> -0.861256).  Saving model ...
Epoch: 18 cost time: 5.718355894088745
Epoch: 18, Steps: 34 | Train Loss: 0.323 Vali Loss: 2.981 Vali Acc: 0.809 Test Loss: 2.981 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.716565132141113
Epoch: 19, Steps: 34 | Train Loss: 0.386 Vali Loss: 3.014 Vali Acc: 0.769 Test Loss: 3.014 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.8694329261779785
Epoch: 20, Steps: 34 | Train Loss: 0.372 Vali Loss: 3.667 Vali Acc: 0.832 Test Loss: 3.667 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.864007472991943
Epoch: 21, Steps: 34 | Train Loss: 0.364 Vali Loss: 6.560 Vali Acc: 0.723 Test Loss: 6.560 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.91099739074707
Epoch: 22, Steps: 34 | Train Loss: 0.394 Vali Loss: 5.036 Vali Acc: 0.740 Test Loss: 5.036 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.347034931182861
Epoch: 23, Steps: 34 | Train Loss: 0.403 Vali Loss: 4.851 Vali Acc: 0.746 Test Loss: 4.851 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.336014747619629
Epoch: 24, Steps: 34 | Train Loss: 1.206 Vali Loss: 8.197 Vali Acc: 0.642 Test Loss: 8.197 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.363314151763916
Epoch: 25, Steps: 34 | Train Loss: 0.857 Vali Loss: 4.364 Vali Acc: 0.780 Test Loss: 4.364 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.562171936035156
Epoch: 26, Steps: 34 | Train Loss: 0.177 Vali Loss: 5.614 Vali Acc: 0.780 Test Loss: 5.614 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.910478353500366
Epoch: 27, Steps: 34 | Train Loss: 0.314 Vali Loss: 3.923 Vali Acc: 0.832 Test Loss: 3.923 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 2087371
model size : 8.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.50200343132019
Epoch: 1, Steps: 34 | Train Loss: 2.720 Vali Loss: 8.867 Vali Acc: 0.272 Test Loss: 8.867 Test Acc: 0.272
Validation loss decreased (inf --> -0.271588).  Saving model ...
Epoch: 2 cost time: 5.753565311431885
Epoch: 2, Steps: 34 | Train Loss: 7.657 Vali Loss: 8.972 Vali Acc: 0.277 Test Loss: 8.972 Test Acc: 0.277
Validation loss decreased (-0.271588 --> -0.277367).  Saving model ...
Epoch: 3 cost time: 5.860896587371826
Epoch: 3, Steps: 34 | Train Loss: 6.685 Vali Loss: 11.841 Vali Acc: 0.347 Test Loss: 11.841 Test Acc: 0.347
Validation loss decreased (-0.277367 --> -0.346702).  Saving model ...
Epoch: 4 cost time: 5.907113552093506
Epoch: 4, Steps: 34 | Train Loss: 7.374 Vali Loss: 4.243 Vali Acc: 0.618 Test Loss: 4.243 Test Acc: 0.618
Validation loss decreased (-0.346702 --> -0.618455).  Saving model ...
Epoch: 5 cost time: 5.818242073059082
Epoch: 5, Steps: 34 | Train Loss: 3.997 Vali Loss: 5.570 Vali Acc: 0.491 Test Loss: 5.570 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.68255352973938
Epoch: 6, Steps: 34 | Train Loss: 3.169 Vali Loss: 4.445 Vali Acc: 0.595 Test Loss: 4.445 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.8088157176971436
Epoch: 7, Steps: 34 | Train Loss: 1.985 Vali Loss: 6.238 Vali Acc: 0.613 Test Loss: 6.238 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.903955698013306
Epoch: 8, Steps: 34 | Train Loss: 4.656 Vali Loss: 6.184 Vali Acc: 0.607 Test Loss: 6.184 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.863801002502441
Epoch: 9, Steps: 34 | Train Loss: 2.232 Vali Loss: 7.700 Vali Acc: 0.590 Test Loss: 7.700 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.021421670913696
Epoch: 10, Steps: 34 | Train Loss: 1.066 Vali Loss: 5.175 Vali Acc: 0.561 Test Loss: 5.175 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.824250221252441
Epoch: 11, Steps: 34 | Train Loss: 0.775 Vali Loss: 7.937 Vali Acc: 0.618 Test Loss: 7.937 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.756750822067261
Epoch: 12, Steps: 34 | Train Loss: 1.870 Vali Loss: 11.589 Vali Acc: 0.509 Test Loss: 11.589 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.990050315856934
Epoch: 13, Steps: 34 | Train Loss: 1.869 Vali Loss: 2.435 Vali Acc: 0.815 Test Loss: 2.435 Test Acc: 0.815
Validation loss decreased (-0.618455 --> -0.815005).  Saving model ...
Epoch: 14 cost time: 6.566471338272095
Epoch: 14, Steps: 34 | Train Loss: 2.178 Vali Loss: 10.852 Vali Acc: 0.491 Test Loss: 10.852 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.0306315422058105
Epoch: 15, Steps: 34 | Train Loss: 1.050 Vali Loss: 10.438 Vali Acc: 0.688 Test Loss: 10.438 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.812164545059204
Epoch: 16, Steps: 34 | Train Loss: 2.031 Vali Loss: 6.936 Vali Acc: 0.671 Test Loss: 6.936 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.35541844367981
Epoch: 17, Steps: 34 | Train Loss: 0.806 Vali Loss: 4.578 Vali Acc: 0.798 Test Loss: 4.578 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.48281455039978
Epoch: 18, Steps: 34 | Train Loss: 0.411 Vali Loss: 3.815 Vali Acc: 0.757 Test Loss: 3.815 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.6244189739227295
Epoch: 19, Steps: 34 | Train Loss: 0.108 Vali Loss: 2.515 Vali Acc: 0.798 Test Loss: 2.515 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.590749979019165
Epoch: 20, Steps: 34 | Train Loss: 0.231 Vali Loss: 2.170 Vali Acc: 0.873 Test Loss: 2.170 Test Acc: 0.873
Validation loss decreased (-0.815005 --> -0.872811).  Saving model ...
Epoch: 21 cost time: 5.8094000816345215
Epoch: 21, Steps: 34 | Train Loss: 0.056 Vali Loss: 2.345 Vali Acc: 0.832 Test Loss: 2.345 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.805000066757202
Epoch: 22, Steps: 34 | Train Loss: 0.031 Vali Loss: 5.212 Vali Acc: 0.757 Test Loss: 5.212 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.748626708984375
Epoch: 23, Steps: 34 | Train Loss: 0.846 Vali Loss: 5.488 Vali Acc: 0.757 Test Loss: 5.488 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.79688286781311
Epoch: 24, Steps: 34 | Train Loss: 0.241 Vali Loss: 5.857 Vali Acc: 0.780 Test Loss: 5.857 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.601755142211914
Epoch: 25, Steps: 34 | Train Loss: 0.276 Vali Loss: 6.741 Vali Acc: 0.763 Test Loss: 6.741 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.832488775253296
Epoch: 26, Steps: 34 | Train Loss: 0.037 Vali Loss: 4.799 Vali Acc: 0.763 Test Loss: 4.799 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.92020583152771
Epoch: 27, Steps: 34 | Train Loss: 0.245 Vali Loss: 2.774 Vali Acc: 0.815 Test Loss: 2.774 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.784816265106201
Epoch: 28, Steps: 34 | Train Loss: 0.133 Vali Loss: 3.480 Vali Acc: 0.798 Test Loss: 3.480 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.749018669128418
Epoch: 29, Steps: 34 | Train Loss: 1.044 Vali Loss: 4.549 Vali Acc: 0.809 Test Loss: 4.549 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.7810351848602295
Epoch: 30, Steps: 34 | Train Loss: 0.816 Vali Loss: 7.229 Vali Acc: 0.723 Test Loss: 7.229 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 2086795
model size : 8.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.699993848800659
Epoch: 1, Steps: 34 | Train Loss: 4.108 Vali Loss: 7.177 Vali Acc: 0.249 Test Loss: 7.177 Test Acc: 0.249
Validation loss decreased (inf --> -0.248483).  Saving model ...
Epoch: 2 cost time: 5.762730598449707
Epoch: 2, Steps: 34 | Train Loss: 6.745 Vali Loss: 7.115 Vali Acc: 0.457 Test Loss: 7.115 Test Acc: 0.457
Validation loss decreased (-0.248483 --> -0.456576).  Saving model ...
Epoch: 3 cost time: 5.741171836853027
Epoch: 3, Steps: 34 | Train Loss: 6.105 Vali Loss: 2.709 Vali Acc: 0.555 Test Loss: 2.709 Test Acc: 0.555
Validation loss decreased (-0.456576 --> -0.554886).  Saving model ...
Epoch: 4 cost time: 5.813978910446167
Epoch: 4, Steps: 34 | Train Loss: 2.391 Vali Loss: 5.482 Vali Acc: 0.514 Test Loss: 5.482 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.3897926807403564
Epoch: 5, Steps: 34 | Train Loss: 5.368 Vali Loss: 7.882 Vali Acc: 0.410 Test Loss: 7.882 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.842187404632568
Epoch: 6, Steps: 34 | Train Loss: 5.051 Vali Loss: 5.388 Vali Acc: 0.630 Test Loss: 5.388 Test Acc: 0.630
Validation loss decreased (-0.554886 --> -0.630004).  Saving model ...
Epoch: 7 cost time: 7.140497922897339
Epoch: 7, Steps: 34 | Train Loss: 3.909 Vali Loss: 4.633 Vali Acc: 0.601 Test Loss: 4.633 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.610024690628052
Epoch: 8, Steps: 34 | Train Loss: 2.985 Vali Loss: 6.366 Vali Acc: 0.572 Test Loss: 6.366 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.502368688583374
Epoch: 9, Steps: 34 | Train Loss: 4.248 Vali Loss: 11.836 Vali Acc: 0.457 Test Loss: 11.836 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.7214250564575195
Epoch: 10, Steps: 34 | Train Loss: 2.698 Vali Loss: 3.455 Vali Acc: 0.711 Test Loss: 3.455 Test Acc: 0.711
Validation loss decreased (-0.630004 --> -0.710948).  Saving model ...
Epoch: 11 cost time: 6.860924482345581
Epoch: 11, Steps: 34 | Train Loss: 1.022 Vali Loss: 7.372 Vali Acc: 0.653 Test Loss: 7.372 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.302056550979614
Epoch: 12, Steps: 34 | Train Loss: 0.624 Vali Loss: 4.060 Vali Acc: 0.694 Test Loss: 4.060 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.872561693191528
Epoch: 13, Steps: 34 | Train Loss: 0.818 Vali Loss: 5.066 Vali Acc: 0.775 Test Loss: 5.066 Test Acc: 0.775
Validation loss decreased (-0.710948 --> -0.774516).  Saving model ...
Epoch: 14 cost time: 5.8390703201293945
Epoch: 14, Steps: 34 | Train Loss: 1.402 Vali Loss: 6.068 Vali Acc: 0.671 Test Loss: 6.068 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.962786436080933
Epoch: 15, Steps: 34 | Train Loss: 0.672 Vali Loss: 2.601 Vali Acc: 0.815 Test Loss: 2.601 Test Acc: 0.815
Validation loss decreased (-0.774516 --> -0.815003).  Saving model ...
Epoch: 16 cost time: 5.6821510791778564
Epoch: 16, Steps: 34 | Train Loss: 0.474 Vali Loss: 2.798 Vali Acc: 0.821 Test Loss: 2.798 Test Acc: 0.821
Validation loss decreased (-0.815003 --> -0.820781).  Saving model ...
Epoch: 17 cost time: 6.020599126815796
Epoch: 17, Steps: 34 | Train Loss: 0.449 Vali Loss: 6.496 Vali Acc: 0.711 Test Loss: 6.496 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.108661890029907
Epoch: 18, Steps: 34 | Train Loss: 1.536 Vali Loss: 8.935 Vali Acc: 0.624 Test Loss: 8.935 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.872579097747803
Epoch: 19, Steps: 34 | Train Loss: 0.956 Vali Loss: 7.465 Vali Acc: 0.676 Test Loss: 7.465 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.901355504989624
Epoch: 20, Steps: 34 | Train Loss: 1.295 Vali Loss: 6.736 Vali Acc: 0.746 Test Loss: 6.736 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.73716139793396
Epoch: 21, Steps: 34 | Train Loss: 0.661 Vali Loss: 4.476 Vali Acc: 0.798 Test Loss: 4.476 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.838305234909058
Epoch: 22, Steps: 34 | Train Loss: 0.637 Vali Loss: 6.407 Vali Acc: 0.775 Test Loss: 6.407 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.066915035247803
Epoch: 23, Steps: 34 | Train Loss: 0.165 Vali Loss: 7.668 Vali Acc: 0.723 Test Loss: 7.668 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.845022201538086
Epoch: 24, Steps: 34 | Train Loss: 0.523 Vali Loss: 9.984 Vali Acc: 0.711 Test Loss: 9.984 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.889048099517822
Epoch: 25, Steps: 34 | Train Loss: 0.545 Vali Loss: 6.497 Vali Acc: 0.751 Test Loss: 6.497 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.8646934032440186
Epoch: 26, Steps: 34 | Train Loss: 0.202 Vali Loss: 6.169 Vali Acc: 0.746 Test Loss: 6.169 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2086219
model size : 8.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.151813983917236
Epoch: 1, Steps: 34 | Train Loss: 3.079 Vali Loss: 3.655 Vali Acc: 0.405 Test Loss: 3.655 Test Acc: 0.405
Validation loss decreased (inf --> -0.404588).  Saving model ...
Epoch: 2 cost time: 6.1589155197143555
Epoch: 2, Steps: 34 | Train Loss: 4.480 Vali Loss: 5.659 Vali Acc: 0.416 Test Loss: 5.659 Test Acc: 0.416
Validation loss decreased (-0.404588 --> -0.416128).  Saving model ...
Epoch: 3 cost time: 6.3377015590667725
Epoch: 3, Steps: 34 | Train Loss: 4.779 Vali Loss: 3.932 Vali Acc: 0.439 Test Loss: 3.932 Test Acc: 0.439
Validation loss decreased (-0.416128 --> -0.439267).  Saving model ...
Epoch: 4 cost time: 5.944481611251831
Epoch: 4, Steps: 34 | Train Loss: 3.884 Vali Loss: 8.896 Vali Acc: 0.434 Test Loss: 8.896 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.356723785400391
Epoch: 5, Steps: 34 | Train Loss: 7.631 Vali Loss: 6.683 Vali Acc: 0.572 Test Loss: 6.683 Test Acc: 0.572
Validation loss decreased (-0.439267 --> -0.572188).  Saving model ...
Epoch: 6 cost time: 6.3440117835998535
Epoch: 6, Steps: 34 | Train Loss: 3.795 Vali Loss: 3.730 Vali Acc: 0.618 Test Loss: 3.730 Test Acc: 0.618
Validation loss decreased (-0.572188 --> -0.618460).  Saving model ...
Epoch: 7 cost time: 6.140190839767456
Epoch: 7, Steps: 34 | Train Loss: 3.294 Vali Loss: 3.918 Vali Acc: 0.671 Test Loss: 3.918 Test Acc: 0.671
Validation loss decreased (-0.618460 --> -0.670481).  Saving model ...
Epoch: 8 cost time: 5.339498043060303
Epoch: 8, Steps: 34 | Train Loss: 2.702 Vali Loss: 6.256 Vali Acc: 0.595 Test Loss: 6.256 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.628891706466675
Epoch: 9, Steps: 34 | Train Loss: 2.978 Vali Loss: 7.350 Vali Acc: 0.566 Test Loss: 7.350 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.704237461090088
Epoch: 10, Steps: 34 | Train Loss: 3.924 Vali Loss: 4.538 Vali Acc: 0.763 Test Loss: 4.538 Test Acc: 0.763
Validation loss decreased (-0.670481 --> -0.762960).  Saving model ...
Epoch: 11 cost time: 5.480149745941162
Epoch: 11, Steps: 34 | Train Loss: 3.237 Vali Loss: 4.097 Vali Acc: 0.676 Test Loss: 4.097 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.442763805389404
Epoch: 12, Steps: 34 | Train Loss: 0.570 Vali Loss: 6.435 Vali Acc: 0.630 Test Loss: 6.435 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.514915227890015
Epoch: 13, Steps: 34 | Train Loss: 1.663 Vali Loss: 5.350 Vali Acc: 0.671 Test Loss: 5.350 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.6857123374938965
Epoch: 14, Steps: 34 | Train Loss: 1.177 Vali Loss: 8.819 Vali Acc: 0.694 Test Loss: 8.819 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.456238508224487
Epoch: 15, Steps: 34 | Train Loss: 1.397 Vali Loss: 6.595 Vali Acc: 0.751 Test Loss: 6.595 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.606128454208374
Epoch: 16, Steps: 34 | Train Loss: 0.492 Vali Loss: 7.306 Vali Acc: 0.723 Test Loss: 7.306 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.4842143058776855
Epoch: 17, Steps: 34 | Train Loss: 0.052 Vali Loss: 3.014 Vali Acc: 0.775 Test Loss: 3.014 Test Acc: 0.775
Validation loss decreased (-0.762960 --> -0.774536).  Saving model ...
Epoch: 18 cost time: 5.4159324169158936
Epoch: 18, Steps: 34 | Train Loss: 0.304 Vali Loss: 5.321 Vali Acc: 0.786 Test Loss: 5.321 Test Acc: 0.786
Validation loss decreased (-0.774536 --> -0.786074).  Saving model ...
Epoch: 19 cost time: 5.401856899261475
Epoch: 19, Steps: 34 | Train Loss: 0.381 Vali Loss: 6.900 Vali Acc: 0.751 Test Loss: 6.900 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.601166009902954
Epoch: 20, Steps: 34 | Train Loss: 0.544 Vali Loss: 5.170 Vali Acc: 0.827 Test Loss: 5.170 Test Acc: 0.827
Validation loss decreased (-0.786074 --> -0.826538).  Saving model ...
Epoch: 21 cost time: 5.648413896560669
Epoch: 21, Steps: 34 | Train Loss: 0.382 Vali Loss: 4.450 Vali Acc: 0.786 Test Loss: 4.450 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.488491058349609
Epoch: 22, Steps: 34 | Train Loss: 0.387 Vali Loss: 8.039 Vali Acc: 0.688 Test Loss: 8.039 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.338590621948242
Epoch: 23, Steps: 34 | Train Loss: 2.960 Vali Loss: 4.866 Vali Acc: 0.705 Test Loss: 4.866 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.43484902381897
Epoch: 24, Steps: 34 | Train Loss: 0.987 Vali Loss: 7.761 Vali Acc: 0.757 Test Loss: 7.761 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.725846290588379
Epoch: 25, Steps: 34 | Train Loss: 0.289 Vali Loss: 5.356 Vali Acc: 0.757 Test Loss: 5.356 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.381972789764404
Epoch: 26, Steps: 34 | Train Loss: 0.059 Vali Loss: 5.621 Vali Acc: 0.809 Test Loss: 5.621 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.614377021789551
Epoch: 27, Steps: 34 | Train Loss: 0.295 Vali Loss: 4.041 Vali Acc: 0.803 Test Loss: 4.041 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.031634569168091
Epoch: 28, Steps: 34 | Train Loss: 0.517 Vali Loss: 5.662 Vali Acc: 0.792 Test Loss: 5.662 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.223288536071777
Epoch: 29, Steps: 34 | Train Loss: 0.153 Vali Loss: 6.184 Vali Acc: 0.763 Test Loss: 6.184 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.267879486083984
Epoch: 30, Steps: 34 | Train Loss: 0.620 Vali Loss: 10.190 Vali Acc: 0.723 Test Loss: 10.190 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2085643
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.913266181945801
Epoch: 1, Steps: 34 | Train Loss: 2.965 Vali Loss: 4.121 Vali Acc: 0.289 Test Loss: 4.121 Test Acc: 0.289
Validation loss decreased (inf --> -0.288976).  Saving model ...
Epoch: 2 cost time: 5.036166191101074
Epoch: 2, Steps: 34 | Train Loss: 4.448 Vali Loss: 3.166 Vali Acc: 0.370 Test Loss: 3.166 Test Acc: 0.370
Validation loss decreased (-0.288976 --> -0.369911).  Saving model ...
Epoch: 3 cost time: 5.017960071563721
Epoch: 3, Steps: 34 | Train Loss: 6.811 Vali Loss: 8.997 Vali Acc: 0.480 Test Loss: 8.997 Test Acc: 0.480
Validation loss decreased (-0.369911 --> -0.479679).  Saving model ...
Epoch: 4 cost time: 4.982409954071045
Epoch: 4, Steps: 34 | Train Loss: 5.152 Vali Loss: 14.263 Vali Acc: 0.439 Test Loss: 14.263 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.090808629989624
Epoch: 5, Steps: 34 | Train Loss: 6.012 Vali Loss: 4.224 Vali Acc: 0.543 Test Loss: 4.224 Test Acc: 0.543
Validation loss decreased (-0.479679 --> -0.543310).  Saving model ...
Epoch: 6 cost time: 5.387001276016235
Epoch: 6, Steps: 34 | Train Loss: 6.694 Vali Loss: 6.384 Vali Acc: 0.566 Test Loss: 6.384 Test Acc: 0.566
Validation loss decreased (-0.543310 --> -0.566410).  Saving model ...
Epoch: 7 cost time: 5.015911340713501
Epoch: 7, Steps: 34 | Train Loss: 2.661 Vali Loss: 7.142 Vali Acc: 0.618 Test Loss: 7.142 Test Acc: 0.618
Validation loss decreased (-0.566410 --> -0.618426).  Saving model ...
Epoch: 8 cost time: 5.062483310699463
Epoch: 8, Steps: 34 | Train Loss: 3.512 Vali Loss: 3.307 Vali Acc: 0.647 Test Loss: 3.307 Test Acc: 0.647
Validation loss decreased (-0.618426 --> -0.647366).  Saving model ...
Epoch: 9 cost time: 5.160152912139893
Epoch: 9, Steps: 34 | Train Loss: 2.006 Vali Loss: 6.547 Vali Acc: 0.653 Test Loss: 6.547 Test Acc: 0.653
Validation loss decreased (-0.647366 --> -0.653114).  Saving model ...
Epoch: 10 cost time: 4.962709426879883
Epoch: 10, Steps: 34 | Train Loss: 2.428 Vali Loss: 5.185 Vali Acc: 0.740 Test Loss: 5.185 Test Acc: 0.740
Validation loss decreased (-0.653114 --> -0.739833).  Saving model ...
Epoch: 11 cost time: 5.108348608016968
Epoch: 11, Steps: 34 | Train Loss: 0.758 Vali Loss: 2.138 Vali Acc: 0.792 Test Loss: 2.138 Test Acc: 0.792
Validation loss decreased (-0.739833 --> -0.791886).  Saving model ...
Epoch: 12 cost time: 4.852760076522827
Epoch: 12, Steps: 34 | Train Loss: 1.179 Vali Loss: 4.502 Vali Acc: 0.665 Test Loss: 4.502 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.171851396560669
Epoch: 13, Steps: 34 | Train Loss: 1.071 Vali Loss: 2.973 Vali Acc: 0.775 Test Loss: 2.973 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.097250461578369
Epoch: 14, Steps: 34 | Train Loss: 1.326 Vali Loss: 6.291 Vali Acc: 0.682 Test Loss: 6.291 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.886250734329224
Epoch: 15, Steps: 34 | Train Loss: 1.542 Vali Loss: 5.614 Vali Acc: 0.746 Test Loss: 5.614 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.110100507736206
Epoch: 16, Steps: 34 | Train Loss: 0.582 Vali Loss: 5.286 Vali Acc: 0.786 Test Loss: 5.286 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.052218675613403
Epoch: 17, Steps: 34 | Train Loss: 0.683 Vali Loss: 7.392 Vali Acc: 0.751 Test Loss: 7.392 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.814594268798828
Epoch: 18, Steps: 34 | Train Loss: 1.255 Vali Loss: 10.104 Vali Acc: 0.676 Test Loss: 10.104 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.693446159362793
Epoch: 19, Steps: 34 | Train Loss: 0.894 Vali Loss: 2.072 Vali Acc: 0.867 Test Loss: 2.072 Test Acc: 0.867
Validation loss decreased (-0.791886 --> -0.867031).  Saving model ...
Epoch: 20 cost time: 5.754311800003052
Epoch: 20, Steps: 34 | Train Loss: 0.888 Vali Loss: 8.605 Vali Acc: 0.723 Test Loss: 8.605 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.6106858253479
Epoch: 21, Steps: 34 | Train Loss: 0.421 Vali Loss: 9.322 Vali Acc: 0.746 Test Loss: 9.322 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.412807941436768
Epoch: 22, Steps: 34 | Train Loss: 0.443 Vali Loss: 6.716 Vali Acc: 0.728 Test Loss: 6.716 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.9952170848846436
Epoch: 23, Steps: 34 | Train Loss: 0.829 Vali Loss: 6.858 Vali Acc: 0.723 Test Loss: 6.858 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.114112615585327
Epoch: 24, Steps: 34 | Train Loss: 0.999 Vali Loss: 6.032 Vali Acc: 0.734 Test Loss: 6.032 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.713638067245483
Epoch: 25, Steps: 34 | Train Loss: 0.487 Vali Loss: 8.193 Vali Acc: 0.723 Test Loss: 8.193 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.902598857879639
Epoch: 26, Steps: 34 | Train Loss: 0.551 Vali Loss: 5.995 Vali Acc: 0.780 Test Loss: 5.995 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.199445486068726
Epoch: 27, Steps: 34 | Train Loss: 0.618 Vali Loss: 3.241 Vali Acc: 0.832 Test Loss: 3.241 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.196272850036621
Epoch: 28, Steps: 34 | Train Loss: 0.081 Vali Loss: 10.663 Vali Acc: 0.775 Test Loss: 10.663 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.282698631286621
Epoch: 29, Steps: 34 | Train Loss: 0.168 Vali Loss: 7.134 Vali Acc: 0.780 Test Loss: 7.134 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1920971
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.883186340332031
Epoch: 1, Steps: 34 | Train Loss: 3.004 Vali Loss: 5.691 Vali Acc: 0.399 Test Loss: 5.691 Test Acc: 0.399
Validation loss decreased (inf --> -0.398787).  Saving model ...
Epoch: 2 cost time: 5.082675933837891
Epoch: 2, Steps: 34 | Train Loss: 3.624 Vali Loss: 7.294 Vali Acc: 0.283 Test Loss: 7.294 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.1114301681518555
Epoch: 3, Steps: 34 | Train Loss: 5.929 Vali Loss: 6.927 Vali Acc: 0.410 Test Loss: 6.927 Test Acc: 0.410
Validation loss decreased (-0.398787 --> -0.410335).  Saving model ...
Epoch: 4 cost time: 4.6747589111328125
Epoch: 4, Steps: 34 | Train Loss: 4.930 Vali Loss: 4.299 Vali Acc: 0.549 Test Loss: 4.299 Test Acc: 0.549
Validation loss decreased (-0.410335 --> -0.549090).  Saving model ...
Epoch: 5 cost time: 5.055448055267334
Epoch: 5, Steps: 34 | Train Loss: 4.055 Vali Loss: 7.348 Vali Acc: 0.549 Test Loss: 7.348 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.061676740646362
Epoch: 6, Steps: 34 | Train Loss: 3.340 Vali Loss: 3.075 Vali Acc: 0.682 Test Loss: 3.075 Test Acc: 0.682
Validation loss decreased (-0.549090 --> -0.682050).  Saving model ...
Epoch: 7 cost time: 4.927653789520264
Epoch: 7, Steps: 34 | Train Loss: 3.980 Vali Loss: 12.591 Vali Acc: 0.439 Test Loss: 12.591 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.191423416137695
Epoch: 8, Steps: 34 | Train Loss: 3.123 Vali Loss: 4.645 Vali Acc: 0.728 Test Loss: 4.645 Test Acc: 0.728
Validation loss decreased (-0.682050 --> -0.728277).  Saving model ...
Epoch: 9 cost time: 4.796313762664795
Epoch: 9, Steps: 34 | Train Loss: 4.866 Vali Loss: 17.258 Vali Acc: 0.422 Test Loss: 17.258 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.038883447647095
Epoch: 10, Steps: 34 | Train Loss: 3.546 Vali Loss: 2.778 Vali Acc: 0.780 Test Loss: 2.778 Test Acc: 0.780
Validation loss decreased (-0.728277 --> -0.780319).  Saving model ...
Epoch: 11 cost time: 5.054940938949585
Epoch: 11, Steps: 34 | Train Loss: 1.776 Vali Loss: 3.946 Vali Acc: 0.809 Test Loss: 3.946 Test Acc: 0.809
Validation loss decreased (-0.780319 --> -0.809209).  Saving model ...
Epoch: 12 cost time: 5.561885595321655
Epoch: 12, Steps: 34 | Train Loss: 1.429 Vali Loss: 3.100 Vali Acc: 0.769 Test Loss: 3.100 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.6161534786224365
Epoch: 13, Steps: 34 | Train Loss: 1.593 Vali Loss: 11.695 Vali Acc: 0.555 Test Loss: 11.695 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.789338111877441
Epoch: 14, Steps: 34 | Train Loss: 1.642 Vali Loss: 4.670 Vali Acc: 0.746 Test Loss: 4.670 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.803870916366577
Epoch: 15, Steps: 34 | Train Loss: 0.819 Vali Loss: 4.645 Vali Acc: 0.769 Test Loss: 4.645 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.57804536819458
Epoch: 16, Steps: 34 | Train Loss: 1.670 Vali Loss: 9.434 Vali Acc: 0.699 Test Loss: 9.434 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.667442560195923
Epoch: 17, Steps: 34 | Train Loss: 0.821 Vali Loss: 8.787 Vali Acc: 0.682 Test Loss: 8.787 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.477237701416016
Epoch: 18, Steps: 34 | Train Loss: 1.524 Vali Loss: 5.444 Vali Acc: 0.792 Test Loss: 5.444 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.5174736976623535
Epoch: 19, Steps: 34 | Train Loss: 0.235 Vali Loss: 5.080 Vali Acc: 0.780 Test Loss: 5.080 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.292727947235107
Epoch: 20, Steps: 34 | Train Loss: 0.129 Vali Loss: 4.899 Vali Acc: 0.746 Test Loss: 4.899 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.054430723190308
Epoch: 21, Steps: 34 | Train Loss: 0.323 Vali Loss: 5.632 Vali Acc: 0.798 Test Loss: 5.632 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1920395
model size : 8.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.765246868133545
Epoch: 1, Steps: 34 | Train Loss: 2.748 Vali Loss: 3.084 Vali Acc: 0.312 Test Loss: 3.084 Test Acc: 0.312
Validation loss decreased (inf --> -0.312108).  Saving model ...
Epoch: 2 cost time: 4.939735651016235
Epoch: 2, Steps: 34 | Train Loss: 2.973 Vali Loss: 3.315 Vali Acc: 0.445 Test Loss: 3.315 Test Acc: 0.445
Validation loss decreased (-0.312108 --> -0.445054).  Saving model ...
Epoch: 3 cost time: 4.912748575210571
Epoch: 3, Steps: 34 | Train Loss: 3.084 Vali Loss: 8.011 Vali Acc: 0.434 Test Loss: 8.011 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.126185417175293
Epoch: 4, Steps: 34 | Train Loss: 4.157 Vali Loss: 8.846 Vali Acc: 0.486 Test Loss: 8.846 Test Acc: 0.486
Validation loss decreased (-0.445054 --> -0.485461).  Saving model ...
Epoch: 5 cost time: 5.048646450042725
Epoch: 5, Steps: 34 | Train Loss: 8.467 Vali Loss: 4.553 Vali Acc: 0.532 Test Loss: 4.553 Test Acc: 0.532
Validation loss decreased (-0.485461 --> -0.531746).  Saving model ...
Epoch: 6 cost time: 4.805959463119507
Epoch: 6, Steps: 34 | Train Loss: 3.999 Vali Loss: 4.737 Vali Acc: 0.509 Test Loss: 4.737 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.770331621170044
Epoch: 7, Steps: 34 | Train Loss: 4.996 Vali Loss: 7.023 Vali Acc: 0.584 Test Loss: 7.023 Test Acc: 0.584
Validation loss decreased (-0.531746 --> -0.583745).  Saving model ...
Epoch: 8 cost time: 4.88939642906189
Epoch: 8, Steps: 34 | Train Loss: 4.735 Vali Loss: 11.832 Vali Acc: 0.543 Test Loss: 11.832 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.196369886398315
Epoch: 9, Steps: 34 | Train Loss: 3.557 Vali Loss: 14.161 Vali Acc: 0.538 Test Loss: 14.161 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.794483661651611
Epoch: 10, Steps: 34 | Train Loss: 3.188 Vali Loss: 5.810 Vali Acc: 0.653 Test Loss: 5.810 Test Acc: 0.653
Validation loss decreased (-0.583745 --> -0.653121).  Saving model ...
Epoch: 11 cost time: 5.0022783279418945
Epoch: 11, Steps: 34 | Train Loss: 3.058 Vali Loss: 11.801 Vali Acc: 0.688 Test Loss: 11.801 Test Acc: 0.688
Validation loss decreased (-0.653121 --> -0.687743).  Saving model ...
Epoch: 12 cost time: 5.050724029541016
Epoch: 12, Steps: 34 | Train Loss: 2.012 Vali Loss: 13.929 Vali Acc: 0.549 Test Loss: 13.929 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.822814464569092
Epoch: 13, Steps: 34 | Train Loss: 1.644 Vali Loss: 2.845 Vali Acc: 0.821 Test Loss: 2.845 Test Acc: 0.821
Validation loss decreased (-0.687743 --> -0.820781).  Saving model ...
Epoch: 14 cost time: 4.679616689682007
Epoch: 14, Steps: 34 | Train Loss: 0.316 Vali Loss: 5.149 Vali Acc: 0.769 Test Loss: 5.149 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.779818058013916
Epoch: 15, Steps: 34 | Train Loss: 0.667 Vali Loss: 2.520 Vali Acc: 0.780 Test Loss: 2.520 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.159357070922852
Epoch: 16, Steps: 34 | Train Loss: 1.134 Vali Loss: 5.284 Vali Acc: 0.711 Test Loss: 5.284 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.898320436477661
Epoch: 17, Steps: 34 | Train Loss: 0.440 Vali Loss: 5.766 Vali Acc: 0.775 Test Loss: 5.766 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.215611696243286
Epoch: 18, Steps: 34 | Train Loss: 0.196 Vali Loss: 2.822 Vali Acc: 0.844 Test Loss: 2.822 Test Acc: 0.844
Validation loss decreased (-0.820781 --> -0.843902).  Saving model ...
Epoch: 19 cost time: 5.552909851074219
Epoch: 19, Steps: 34 | Train Loss: 0.248 Vali Loss: 3.369 Vali Acc: 0.850 Test Loss: 3.369 Test Acc: 0.850
Validation loss decreased (-0.843902 --> -0.849677).  Saving model ...
Epoch: 20 cost time: 5.577900409698486
Epoch: 20, Steps: 34 | Train Loss: 0.118 Vali Loss: 2.978 Vali Acc: 0.780 Test Loss: 2.978 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.437406301498413
Epoch: 21, Steps: 34 | Train Loss: 0.045 Vali Loss: 2.501 Vali Acc: 0.798 Test Loss: 2.501 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.936479330062866
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.015 Vali Acc: 0.792 Test Loss: 3.015 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.055312633514404
Epoch: 23, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.084 Vali Acc: 0.803 Test Loss: 3.084 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.003619909286499
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.085 Vali Acc: 0.803 Test Loss: 3.085 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.987505674362183
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.075 Vali Acc: 0.803 Test Loss: 3.075 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.149484634399414
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.069 Vali Acc: 0.803 Test Loss: 3.069 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.010800838470459
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.065 Vali Acc: 0.803 Test Loss: 3.065 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.201927423477173
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.061 Vali Acc: 0.803 Test Loss: 3.061 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.0125627517700195
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.058 Vali Acc: 0.803 Test Loss: 3.058 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1919819
model size : 8.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.5162434577941895
Epoch: 1, Steps: 34 | Train Loss: 3.367 Vali Loss: 5.543 Vali Acc: 0.249 Test Loss: 5.543 Test Acc: 0.249
Validation loss decreased (inf --> -0.248499).  Saving model ...
Epoch: 2 cost time: 4.623263835906982
Epoch: 2, Steps: 34 | Train Loss: 3.987 Vali Loss: 6.053 Vali Acc: 0.358 Test Loss: 6.053 Test Acc: 0.358
Validation loss decreased (-0.248499 --> -0.358321).  Saving model ...
Epoch: 3 cost time: 4.486836671829224
Epoch: 3, Steps: 34 | Train Loss: 4.346 Vali Loss: 3.289 Vali Acc: 0.555 Test Loss: 3.289 Test Acc: 0.555
Validation loss decreased (-0.358321 --> -0.554880).  Saving model ...
Epoch: 4 cost time: 4.505372762680054
Epoch: 4, Steps: 34 | Train Loss: 6.638 Vali Loss: 14.449 Vali Acc: 0.439 Test Loss: 14.449 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.559855222702026
Epoch: 5, Steps: 34 | Train Loss: 7.408 Vali Loss: 23.397 Vali Acc: 0.382 Test Loss: 23.397 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.7081475257873535
Epoch: 6, Steps: 34 | Train Loss: 6.175 Vali Loss: 7.427 Vali Acc: 0.561 Test Loss: 7.427 Test Acc: 0.561
Validation loss decreased (-0.554880 --> -0.560619).  Saving model ...
Epoch: 7 cost time: 4.769279718399048
Epoch: 7, Steps: 34 | Train Loss: 4.135 Vali Loss: 4.627 Vali Acc: 0.601 Test Loss: 4.627 Test Acc: 0.601
Validation loss decreased (-0.560619 --> -0.601110).  Saving model ...
Epoch: 8 cost time: 4.734019994735718
Epoch: 8, Steps: 34 | Train Loss: 1.808 Vali Loss: 4.417 Vali Acc: 0.676 Test Loss: 4.417 Test Acc: 0.676
Validation loss decreased (-0.601110 --> -0.676256).  Saving model ...
Epoch: 9 cost time: 5.378805637359619
Epoch: 9, Steps: 34 | Train Loss: 3.184 Vali Loss: 7.824 Vali Acc: 0.561 Test Loss: 7.824 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.136245489120483
Epoch: 10, Steps: 34 | Train Loss: 2.875 Vali Loss: 6.652 Vali Acc: 0.682 Test Loss: 6.652 Test Acc: 0.682
Validation loss decreased (-0.676256 --> -0.682014).  Saving model ...
Epoch: 11 cost time: 5.260754585266113
Epoch: 11, Steps: 34 | Train Loss: 2.307 Vali Loss: 3.421 Vali Acc: 0.763 Test Loss: 3.421 Test Acc: 0.763
Validation loss decreased (-0.682014 --> -0.762972).  Saving model ...
Epoch: 12 cost time: 5.240662574768066
Epoch: 12, Steps: 34 | Train Loss: 1.984 Vali Loss: 3.890 Vali Acc: 0.688 Test Loss: 3.890 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.793036699295044
Epoch: 13, Steps: 34 | Train Loss: 2.656 Vali Loss: 6.523 Vali Acc: 0.671 Test Loss: 6.523 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.399705648422241
Epoch: 14, Steps: 34 | Train Loss: 1.071 Vali Loss: 6.452 Vali Acc: 0.717 Test Loss: 6.452 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.338844537734985
Epoch: 15, Steps: 34 | Train Loss: 1.647 Vali Loss: 4.679 Vali Acc: 0.751 Test Loss: 4.679 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.317464590072632
Epoch: 16, Steps: 34 | Train Loss: 0.433 Vali Loss: 3.779 Vali Acc: 0.751 Test Loss: 3.779 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.1972551345825195
Epoch: 17, Steps: 34 | Train Loss: 0.426 Vali Loss: 4.720 Vali Acc: 0.723 Test Loss: 4.720 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.603759527206421
Epoch: 18, Steps: 34 | Train Loss: 0.451 Vali Loss: 2.999 Vali Acc: 0.786 Test Loss: 2.999 Test Acc: 0.786
Validation loss decreased (-0.762972 --> -0.786097).  Saving model ...
Epoch: 19 cost time: 4.540385484695435
Epoch: 19, Steps: 34 | Train Loss: 0.256 Vali Loss: 4.900 Vali Acc: 0.740 Test Loss: 4.900 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.594390630722046
Epoch: 20, Steps: 34 | Train Loss: 0.463 Vali Loss: 8.058 Vali Acc: 0.728 Test Loss: 8.058 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.863306999206543
Epoch: 21, Steps: 34 | Train Loss: 0.904 Vali Loss: 5.493 Vali Acc: 0.694 Test Loss: 5.493 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.76678466796875
Epoch: 22, Steps: 34 | Train Loss: 0.140 Vali Loss: 5.892 Vali Acc: 0.717 Test Loss: 5.892 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.5857133865356445
Epoch: 23, Steps: 34 | Train Loss: 0.513 Vali Loss: 4.988 Vali Acc: 0.769 Test Loss: 4.988 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.5445098876953125
Epoch: 24, Steps: 34 | Train Loss: 0.132 Vali Loss: 4.600 Vali Acc: 0.803 Test Loss: 4.600 Test Acc: 0.803
Validation loss decreased (-0.786097 --> -0.803422).  Saving model ...
Epoch: 25 cost time: 4.61432671546936
Epoch: 25, Steps: 34 | Train Loss: 0.676 Vali Loss: 5.192 Vali Acc: 0.850 Test Loss: 5.192 Test Acc: 0.850
Validation loss decreased (-0.803422 --> -0.849659).  Saving model ...
Epoch: 26 cost time: 4.6277923583984375
Epoch: 26, Steps: 34 | Train Loss: 0.455 Vali Loss: 9.780 Vali Acc: 0.746 Test Loss: 9.780 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.758195400238037
Epoch: 27, Steps: 34 | Train Loss: 1.437 Vali Loss: 14.842 Vali Acc: 0.665 Test Loss: 14.842 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.67484974861145
Epoch: 28, Steps: 34 | Train Loss: 1.122 Vali Loss: 3.962 Vali Acc: 0.821 Test Loss: 3.962 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.825947046279907
Epoch: 29, Steps: 34 | Train Loss: 0.147 Vali Loss: 5.585 Vali Acc: 0.769 Test Loss: 5.585 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.6906819343566895
Epoch: 30, Steps: 34 | Train Loss: 0.062 Vali Loss: 7.928 Vali Acc: 0.780 Test Loss: 7.928 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.512213230133057
Epoch: 31, Steps: 34 | Train Loss: 0.444 Vali Loss: 8.986 Vali Acc: 0.757 Test Loss: 8.986 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.507504940032959
Epoch: 32, Steps: 34 | Train Loss: 0.614 Vali Loss: 5.514 Vali Acc: 0.775 Test Loss: 5.514 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.478886127471924
Epoch: 33, Steps: 34 | Train Loss: 0.468 Vali Loss: 7.071 Vali Acc: 0.763 Test Loss: 7.071 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.616074800491333
Epoch: 34, Steps: 34 | Train Loss: 0.725 Vali Loss: 9.496 Vali Acc: 0.775 Test Loss: 9.496 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.374665260314941
Epoch: 35, Steps: 34 | Train Loss: 0.036 Vali Loss: 6.013 Vali Acc: 0.809 Test Loss: 6.013 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1919243
model size : 8.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.568571090698242
Epoch: 1, Steps: 34 | Train Loss: 4.102 Vali Loss: 5.977 Vali Acc: 0.480 Test Loss: 5.977 Test Acc: 0.480
Validation loss decreased (inf --> -0.479709).  Saving model ...
Epoch: 2 cost time: 5.079994440078735
Epoch: 2, Steps: 34 | Train Loss: 4.465 Vali Loss: 4.576 Vali Acc: 0.434 Test Loss: 4.576 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.2909815311431885
Epoch: 3, Steps: 34 | Train Loss: 4.328 Vali Loss: 7.307 Vali Acc: 0.543 Test Loss: 7.307 Test Acc: 0.543
Validation loss decreased (-0.479709 --> -0.543280).  Saving model ...
Epoch: 4 cost time: 5.285987377166748
Epoch: 4, Steps: 34 | Train Loss: 4.585 Vali Loss: 3.676 Vali Acc: 0.468 Test Loss: 3.676 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.253235340118408
Epoch: 5, Steps: 34 | Train Loss: 4.045 Vali Loss: 5.494 Vali Acc: 0.520 Test Loss: 5.494 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.421658277511597
Epoch: 6, Steps: 34 | Train Loss: 3.025 Vali Loss: 6.395 Vali Acc: 0.474 Test Loss: 6.395 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.097486257553101
Epoch: 7, Steps: 34 | Train Loss: 3.197 Vali Loss: 9.823 Vali Acc: 0.578 Test Loss: 9.823 Test Acc: 0.578
Validation loss decreased (-0.543280 --> -0.577936).  Saving model ...
Epoch: 8 cost time: 4.747963190078735
Epoch: 8, Steps: 34 | Train Loss: 3.707 Vali Loss: 10.374 Vali Acc: 0.370 Test Loss: 10.374 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.757719278335571
Epoch: 9, Steps: 34 | Train Loss: 4.815 Vali Loss: 5.870 Vali Acc: 0.665 Test Loss: 5.870 Test Acc: 0.665
Validation loss decreased (-0.577936 --> -0.664681).  Saving model ...
Epoch: 10 cost time: 4.6938464641571045
Epoch: 10, Steps: 34 | Train Loss: 1.919 Vali Loss: 5.692 Vali Acc: 0.624 Test Loss: 5.692 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.561290979385376
Epoch: 11, Steps: 34 | Train Loss: 3.314 Vali Loss: 7.489 Vali Acc: 0.647 Test Loss: 7.489 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.789170742034912
Epoch: 12, Steps: 34 | Train Loss: 3.047 Vali Loss: 4.334 Vali Acc: 0.601 Test Loss: 4.334 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.86685037612915
Epoch: 13, Steps: 34 | Train Loss: 1.870 Vali Loss: 3.025 Vali Acc: 0.751 Test Loss: 3.025 Test Acc: 0.751
Validation loss decreased (-0.664681 --> -0.751415).  Saving model ...
Epoch: 14 cost time: 4.859711647033691
Epoch: 14, Steps: 34 | Train Loss: 1.142 Vali Loss: 5.225 Vali Acc: 0.659 Test Loss: 5.225 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.577956676483154
Epoch: 15, Steps: 34 | Train Loss: 1.447 Vali Loss: 6.321 Vali Acc: 0.728 Test Loss: 6.321 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.541515111923218
Epoch: 16, Steps: 34 | Train Loss: 0.940 Vali Loss: 4.055 Vali Acc: 0.775 Test Loss: 4.055 Test Acc: 0.775
Validation loss decreased (-0.751415 --> -0.774526).  Saving model ...
Epoch: 17 cost time: 4.917271852493286
Epoch: 17, Steps: 34 | Train Loss: 0.568 Vali Loss: 2.987 Vali Acc: 0.780 Test Loss: 2.987 Test Acc: 0.780
Validation loss decreased (-0.774526 --> -0.780317).  Saving model ...
Epoch: 18 cost time: 4.611576557159424
Epoch: 18, Steps: 34 | Train Loss: 0.256 Vali Loss: 4.254 Vali Acc: 0.757 Test Loss: 4.254 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.948812007904053
Epoch: 19, Steps: 34 | Train Loss: 0.304 Vali Loss: 3.305 Vali Acc: 0.757 Test Loss: 3.305 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.862761974334717
Epoch: 20, Steps: 34 | Train Loss: 0.629 Vali Loss: 3.037 Vali Acc: 0.798 Test Loss: 3.037 Test Acc: 0.798
Validation loss decreased (-0.780317 --> -0.797657).  Saving model ...
Epoch: 21 cost time: 4.747665882110596
Epoch: 21, Steps: 34 | Train Loss: 0.211 Vali Loss: 2.739 Vali Acc: 0.815 Test Loss: 2.739 Test Acc: 0.815
Validation loss decreased (-0.797657 --> -0.815002).  Saving model ...
Epoch: 22 cost time: 4.759402275085449
Epoch: 22, Steps: 34 | Train Loss: 0.274 Vali Loss: 4.660 Vali Acc: 0.780 Test Loss: 4.660 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.810543060302734
Epoch: 23, Steps: 34 | Train Loss: 0.761 Vali Loss: 6.101 Vali Acc: 0.775 Test Loss: 6.101 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.766857862472534
Epoch: 24, Steps: 34 | Train Loss: 0.194 Vali Loss: 5.885 Vali Acc: 0.723 Test Loss: 5.885 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.90261173248291
Epoch: 25, Steps: 34 | Train Loss: 0.083 Vali Loss: 4.513 Vali Acc: 0.803 Test Loss: 4.513 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.714174270629883
Epoch: 26, Steps: 34 | Train Loss: 0.345 Vali Loss: 3.346 Vali Acc: 0.809 Test Loss: 3.346 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.463167905807495
Epoch: 27, Steps: 34 | Train Loss: 0.317 Vali Loss: 5.886 Vali Acc: 0.780 Test Loss: 5.886 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.564372777938843
Epoch: 28, Steps: 34 | Train Loss: 0.176 Vali Loss: 3.538 Vali Acc: 0.815 Test Loss: 3.538 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.281046152114868
Epoch: 29, Steps: 34 | Train Loss: 0.029 Vali Loss: 5.410 Vali Acc: 0.809 Test Loss: 5.410 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.116008758544922
Epoch: 30, Steps: 34 | Train Loss: 0.200 Vali Loss: 6.340 Vali Acc: 0.769 Test Loss: 6.340 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.367891788482666
Epoch: 31, Steps: 34 | Train Loss: 0.260 Vali Loss: 3.399 Vali Acc: 0.827 Test Loss: 3.399 Test Acc: 0.827
Validation loss decreased (-0.815002 --> -0.826556).  Saving model ...
Epoch: 32 cost time: 5.68904185295105
Epoch: 32, Steps: 34 | Train Loss: 0.032 Vali Loss: 2.882 Vali Acc: 0.855 Test Loss: 2.882 Test Acc: 0.855
Validation loss decreased (-0.826556 --> -0.855463).  Saving model ...
Epoch: 33 cost time: 5.479895830154419
Epoch: 33, Steps: 34 | Train Loss: 0.060 Vali Loss: 5.825 Vali Acc: 0.775 Test Loss: 5.825 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.648196697235107
Epoch: 34, Steps: 34 | Train Loss: 0.094 Vali Loss: 3.542 Vali Acc: 0.850 Test Loss: 3.542 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.760493993759155
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.530 Vali Acc: 0.850 Test Loss: 3.530 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.569506406784058
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.747 Vali Acc: 0.844 Test Loss: 3.747 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.747473478317261
Epoch: 37, Steps: 34 | Train Loss: 0.448 Vali Loss: 6.180 Vali Acc: 0.803 Test Loss: 6.180 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.738089561462402
Epoch: 38, Steps: 34 | Train Loss: 0.065 Vali Loss: 7.020 Vali Acc: 0.769 Test Loss: 7.020 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 4.790812015533447
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.073 Vali Acc: 0.809 Test Loss: 5.073 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.603665113449097
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.007 Vali Acc: 0.803 Test Loss: 5.007 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.722870588302612
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.005 Vali Acc: 0.803 Test Loss: 5.005 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.664978742599487
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.004 Vali Acc: 0.803 Test Loss: 5.004 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1837771
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.36433744430542
Epoch: 1, Steps: 34 | Train Loss: 2.268 Vali Loss: 3.661 Vali Acc: 0.277 Test Loss: 3.661 Test Acc: 0.277
Validation loss decreased (inf --> -0.277420).  Saving model ...
Epoch: 2 cost time: 4.396672248840332
Epoch: 2, Steps: 34 | Train Loss: 2.539 Vali Loss: 1.509 Vali Acc: 0.630 Test Loss: 1.509 Test Acc: 0.630
Validation loss decreased (-0.277420 --> -0.630043).  Saving model ...
Epoch: 3 cost time: 4.571715593338013
Epoch: 3, Steps: 34 | Train Loss: 4.140 Vali Loss: 6.334 Vali Acc: 0.318 Test Loss: 6.334 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.575340986251831
Epoch: 4, Steps: 34 | Train Loss: 5.534 Vali Loss: 8.252 Vali Acc: 0.358 Test Loss: 8.252 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.4918553829193115
Epoch: 5, Steps: 34 | Train Loss: 4.586 Vali Loss: 6.743 Vali Acc: 0.607 Test Loss: 6.743 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.302246332168579
Epoch: 6, Steps: 34 | Train Loss: 3.411 Vali Loss: 8.455 Vali Acc: 0.624 Test Loss: 8.455 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.575609445571899
Epoch: 7, Steps: 34 | Train Loss: 11.819 Vali Loss: 15.070 Vali Acc: 0.486 Test Loss: 15.070 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.45104193687439
Epoch: 8, Steps: 34 | Train Loss: 10.443 Vali Loss: 8.652 Vali Acc: 0.486 Test Loss: 8.652 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.180505990982056
Epoch: 9, Steps: 34 | Train Loss: 2.874 Vali Loss: 4.591 Vali Acc: 0.682 Test Loss: 4.591 Test Acc: 0.682
Validation loss decreased (-0.630043 --> -0.682035).  Saving model ...
Epoch: 10 cost time: 4.921738147735596
Epoch: 10, Steps: 34 | Train Loss: 1.682 Vali Loss: 7.679 Vali Acc: 0.555 Test Loss: 7.679 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.103515148162842
Epoch: 11, Steps: 34 | Train Loss: 2.103 Vali Loss: 12.643 Vali Acc: 0.480 Test Loss: 12.643 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.9744861125946045
Epoch: 12, Steps: 34 | Train Loss: 1.910 Vali Loss: 2.106 Vali Acc: 0.809 Test Loss: 2.106 Test Acc: 0.809
Validation loss decreased (-0.682035 --> -0.809227).  Saving model ...
Epoch: 13 cost time: 5.168205738067627
Epoch: 13, Steps: 34 | Train Loss: 1.530 Vali Loss: 9.481 Vali Acc: 0.676 Test Loss: 9.481 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.4258317947387695
Epoch: 14, Steps: 34 | Train Loss: 2.188 Vali Loss: 5.963 Vali Acc: 0.711 Test Loss: 5.963 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.3967084884643555
Epoch: 15, Steps: 34 | Train Loss: 0.450 Vali Loss: 4.526 Vali Acc: 0.717 Test Loss: 4.526 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.10069465637207
Epoch: 16, Steps: 34 | Train Loss: 0.573 Vali Loss: 3.420 Vali Acc: 0.798 Test Loss: 3.420 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.554616689682007
Epoch: 17, Steps: 34 | Train Loss: 0.799 Vali Loss: 7.219 Vali Acc: 0.734 Test Loss: 7.219 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.700898170471191
Epoch: 18, Steps: 34 | Train Loss: 0.735 Vali Loss: 3.172 Vali Acc: 0.792 Test Loss: 3.172 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.629386901855469
Epoch: 19, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.002 Vali Acc: 0.792 Test Loss: 3.002 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.654038190841675
Epoch: 20, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.993 Vali Acc: 0.792 Test Loss: 2.993 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.662400007247925
Epoch: 21, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.991 Vali Acc: 0.792 Test Loss: 2.991 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.659018039703369
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 2.990 Vali Acc: 0.792 Test Loss: 2.990 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1837195
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.321837425231934
Epoch: 1, Steps: 34 | Train Loss: 3.191 Vali Loss: 4.303 Vali Acc: 0.266 Test Loss: 4.303 Test Acc: 0.266
Validation loss decreased (inf --> -0.265853).  Saving model ...
Epoch: 2 cost time: 4.623089075088501
Epoch: 2, Steps: 34 | Train Loss: 2.340 Vali Loss: 6.375 Vali Acc: 0.283 Test Loss: 6.375 Test Acc: 0.283
Validation loss decreased (-0.265853 --> -0.283173).  Saving model ...
Epoch: 3 cost time: 4.571844577789307
Epoch: 3, Steps: 34 | Train Loss: 4.290 Vali Loss: 13.909 Vali Acc: 0.451 Test Loss: 13.909 Test Acc: 0.451
Validation loss decreased (-0.283173 --> -0.450728).  Saving model ...
Epoch: 4 cost time: 4.68654465675354
Epoch: 4, Steps: 34 | Train Loss: 8.644 Vali Loss: 1.565 Vali Acc: 0.694 Test Loss: 1.565 Test Acc: 0.694
Validation loss decreased (-0.450728 --> -0.693626).  Saving model ...
Epoch: 5 cost time: 4.546182155609131
Epoch: 5, Steps: 34 | Train Loss: 2.826 Vali Loss: 6.038 Vali Acc: 0.462 Test Loss: 6.038 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.756117105484009
Epoch: 6, Steps: 34 | Train Loss: 3.761 Vali Loss: 6.270 Vali Acc: 0.578 Test Loss: 6.270 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.913589239120483
Epoch: 7, Steps: 34 | Train Loss: 2.585 Vali Loss: 4.027 Vali Acc: 0.636 Test Loss: 4.027 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.8161234855651855
Epoch: 8, Steps: 34 | Train Loss: 4.171 Vali Loss: 2.697 Vali Acc: 0.723 Test Loss: 2.697 Test Acc: 0.723
Validation loss decreased (-0.693626 --> -0.722516).  Saving model ...
Epoch: 9 cost time: 4.638006687164307
Epoch: 9, Steps: 34 | Train Loss: 2.060 Vali Loss: 4.736 Vali Acc: 0.711 Test Loss: 4.736 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.766474962234497
Epoch: 10, Steps: 34 | Train Loss: 3.383 Vali Loss: 5.743 Vali Acc: 0.694 Test Loss: 5.743 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.245002508163452
Epoch: 11, Steps: 34 | Train Loss: 1.696 Vali Loss: 5.964 Vali Acc: 0.613 Test Loss: 5.964 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.214133024215698
Epoch: 12, Steps: 34 | Train Loss: 2.654 Vali Loss: 4.852 Vali Acc: 0.751 Test Loss: 4.852 Test Acc: 0.751
Validation loss decreased (-0.722516 --> -0.751397).  Saving model ...
Epoch: 13 cost time: 5.672224283218384
Epoch: 13, Steps: 34 | Train Loss: 2.712 Vali Loss: 4.289 Vali Acc: 0.780 Test Loss: 4.289 Test Acc: 0.780
Validation loss decreased (-0.751397 --> -0.780304).  Saving model ...
Epoch: 14 cost time: 5.1979053020477295
Epoch: 14, Steps: 34 | Train Loss: 0.683 Vali Loss: 4.574 Vali Acc: 0.757 Test Loss: 4.574 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.760261535644531
Epoch: 15, Steps: 34 | Train Loss: 0.588 Vali Loss: 6.148 Vali Acc: 0.763 Test Loss: 6.148 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.218125581741333
Epoch: 16, Steps: 34 | Train Loss: 0.463 Vali Loss: 3.355 Vali Acc: 0.827 Test Loss: 3.355 Test Acc: 0.827
Validation loss decreased (-0.780304 --> -0.826556).  Saving model ...
Epoch: 17 cost time: 5.2449705600738525
Epoch: 17, Steps: 34 | Train Loss: 0.331 Vali Loss: 2.956 Vali Acc: 0.786 Test Loss: 2.956 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.405480146408081
Epoch: 18, Steps: 34 | Train Loss: 0.624 Vali Loss: 4.001 Vali Acc: 0.803 Test Loss: 4.001 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.7172582149505615
Epoch: 19, Steps: 34 | Train Loss: 1.275 Vali Loss: 10.513 Vali Acc: 0.682 Test Loss: 10.513 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.72384238243103
Epoch: 20, Steps: 34 | Train Loss: 0.735 Vali Loss: 3.639 Vali Acc: 0.775 Test Loss: 3.639 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.863658666610718
Epoch: 21, Steps: 34 | Train Loss: 0.267 Vali Loss: 7.316 Vali Acc: 0.775 Test Loss: 7.316 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.79495644569397
Epoch: 22, Steps: 34 | Train Loss: 0.565 Vali Loss: 6.469 Vali Acc: 0.734 Test Loss: 6.469 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.704991579055786
Epoch: 23, Steps: 34 | Train Loss: 0.560 Vali Loss: 6.328 Vali Acc: 0.780 Test Loss: 6.328 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.800750494003296
Epoch: 24, Steps: 34 | Train Loss: 1.112 Vali Loss: 4.640 Vali Acc: 0.751 Test Loss: 4.640 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.8239452838897705
Epoch: 25, Steps: 34 | Train Loss: 1.671 Vali Loss: 11.881 Vali Acc: 0.740 Test Loss: 11.881 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.82220983505249
Epoch: 26, Steps: 34 | Train Loss: 0.737 Vali Loss: 6.402 Vali Acc: 0.780 Test Loss: 6.402 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1836619
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.401547431945801
Epoch: 1, Steps: 34 | Train Loss: 3.277 Vali Loss: 4.218 Vali Acc: 0.266 Test Loss: 4.218 Test Acc: 0.266
Validation loss decreased (inf --> -0.265854).  Saving model ...
Epoch: 2 cost time: 4.21108341217041
Epoch: 2, Steps: 34 | Train Loss: 3.480 Vali Loss: 6.064 Vali Acc: 0.364 Test Loss: 6.064 Test Acc: 0.364
Validation loss decreased (-0.265854 --> -0.364101).  Saving model ...
Epoch: 3 cost time: 4.253564119338989
Epoch: 3, Steps: 34 | Train Loss: 4.445 Vali Loss: 2.582 Vali Acc: 0.618 Test Loss: 2.582 Test Acc: 0.618
Validation loss decreased (-0.364101 --> -0.618471).  Saving model ...
Epoch: 4 cost time: 4.362231254577637
Epoch: 4, Steps: 34 | Train Loss: 5.082 Vali Loss: 5.827 Vali Acc: 0.532 Test Loss: 5.827 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.247823238372803
Epoch: 5, Steps: 34 | Train Loss: 4.373 Vali Loss: 13.286 Vali Acc: 0.405 Test Loss: 13.286 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.292839288711548
Epoch: 6, Steps: 34 | Train Loss: 5.976 Vali Loss: 3.128 Vali Acc: 0.618 Test Loss: 3.128 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.248480558395386
Epoch: 7, Steps: 34 | Train Loss: 2.461 Vali Loss: 11.657 Vali Acc: 0.653 Test Loss: 11.657 Test Acc: 0.653
Validation loss decreased (-0.618471 --> -0.653063).  Saving model ...
Epoch: 8 cost time: 4.87345814704895
Epoch: 8, Steps: 34 | Train Loss: 4.148 Vali Loss: 5.574 Vali Acc: 0.636 Test Loss: 5.574 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.157122850418091
Epoch: 9, Steps: 34 | Train Loss: 1.917 Vali Loss: 5.252 Vali Acc: 0.595 Test Loss: 5.252 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.02565598487854
Epoch: 10, Steps: 34 | Train Loss: 2.542 Vali Loss: 6.201 Vali Acc: 0.665 Test Loss: 6.201 Test Acc: 0.665
Validation loss decreased (-0.653063 --> -0.664678).  Saving model ...
Epoch: 11 cost time: 5.193691968917847
Epoch: 11, Steps: 34 | Train Loss: 1.638 Vali Loss: 7.390 Vali Acc: 0.659 Test Loss: 7.390 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.670689582824707
Epoch: 12, Steps: 34 | Train Loss: 2.889 Vali Loss: 16.188 Vali Acc: 0.671 Test Loss: 16.188 Test Acc: 0.671
Validation loss decreased (-0.664678 --> -0.670358).  Saving model ...
Epoch: 13 cost time: 4.898160219192505
Epoch: 13, Steps: 34 | Train Loss: 4.745 Vali Loss: 8.408 Vali Acc: 0.653 Test Loss: 8.408 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.679422855377197
Epoch: 14, Steps: 34 | Train Loss: 2.386 Vali Loss: 13.664 Vali Acc: 0.636 Test Loss: 13.664 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.888428211212158
Epoch: 15, Steps: 34 | Train Loss: 1.590 Vali Loss: 7.873 Vali Acc: 0.746 Test Loss: 7.873 Test Acc: 0.746
Validation loss decreased (-0.670358 --> -0.745586).  Saving model ...
Epoch: 16 cost time: 5.013217449188232
Epoch: 16, Steps: 34 | Train Loss: 1.370 Vali Loss: 5.475 Vali Acc: 0.757 Test Loss: 5.475 Test Acc: 0.757
Validation loss decreased (-0.745586 --> -0.757171).  Saving model ...
Epoch: 17 cost time: 4.302879571914673
Epoch: 17, Steps: 34 | Train Loss: 2.632 Vali Loss: 2.474 Vali Acc: 0.827 Test Loss: 2.474 Test Acc: 0.827
Validation loss decreased (-0.757171 --> -0.826565).  Saving model ...
Epoch: 18 cost time: 4.407435655593872
Epoch: 18, Steps: 34 | Train Loss: 0.263 Vali Loss: 3.292 Vali Acc: 0.809 Test Loss: 3.292 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.2388856410980225
Epoch: 19, Steps: 34 | Train Loss: 0.173 Vali Loss: 3.638 Vali Acc: 0.821 Test Loss: 3.638 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.296411514282227
Epoch: 20, Steps: 34 | Train Loss: 0.326 Vali Loss: 6.595 Vali Acc: 0.740 Test Loss: 6.595 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.286194801330566
Epoch: 21, Steps: 34 | Train Loss: 0.065 Vali Loss: 4.703 Vali Acc: 0.769 Test Loss: 4.703 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.259497880935669
Epoch: 22, Steps: 34 | Train Loss: 0.975 Vali Loss: 14.035 Vali Acc: 0.647 Test Loss: 14.035 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.433090686798096
Epoch: 23, Steps: 34 | Train Loss: 1.301 Vali Loss: 2.987 Vali Acc: 0.838 Test Loss: 2.987 Test Acc: 0.838
Validation loss decreased (-0.826565 --> -0.838120).  Saving model ...
Epoch: 24 cost time: 4.315255880355835
Epoch: 24, Steps: 34 | Train Loss: 0.091 Vali Loss: 8.487 Vali Acc: 0.751 Test Loss: 8.487 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.4202210903167725
Epoch: 25, Steps: 34 | Train Loss: 0.743 Vali Loss: 7.114 Vali Acc: 0.775 Test Loss: 7.114 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.28863787651062
Epoch: 26, Steps: 34 | Train Loss: 0.110 Vali Loss: 3.657 Vali Acc: 0.832 Test Loss: 3.657 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.299777984619141
Epoch: 27, Steps: 34 | Train Loss: 0.025 Vali Loss: 5.242 Vali Acc: 0.809 Test Loss: 5.242 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.35219669342041
Epoch: 28, Steps: 34 | Train Loss: 0.404 Vali Loss: 6.268 Vali Acc: 0.769 Test Loss: 6.268 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.158886432647705
Epoch: 29, Steps: 34 | Train Loss: 0.280 Vali Loss: 6.758 Vali Acc: 0.746 Test Loss: 6.758 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.478117227554321
Epoch: 30, Steps: 34 | Train Loss: 0.320 Vali Loss: 6.068 Vali Acc: 0.798 Test Loss: 6.068 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.415804147720337
Epoch: 31, Steps: 34 | Train Loss: 1.844 Vali Loss: 8.190 Vali Acc: 0.728 Test Loss: 8.190 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.379932403564453
Epoch: 32, Steps: 34 | Train Loss: 0.468 Vali Loss: 9.540 Vali Acc: 0.728 Test Loss: 9.540 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.318174600601196
Epoch: 33, Steps: 34 | Train Loss: 0.653 Vali Loss: 7.288 Vali Acc: 0.751 Test Loss: 7.288 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1836043
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.24142050743103
Epoch: 1, Steps: 34 | Train Loss: 2.936 Vali Loss: 2.508 Vali Acc: 0.306 Test Loss: 2.508 Test Acc: 0.306
Validation loss decreased (inf --> -0.306333).  Saving model ...
Epoch: 2 cost time: 5.208179235458374
Epoch: 2, Steps: 34 | Train Loss: 5.263 Vali Loss: 4.650 Vali Acc: 0.428 Test Loss: 4.650 Test Acc: 0.428
Validation loss decreased (-0.306333 --> -0.427699).  Saving model ...
Epoch: 3 cost time: 5.105408191680908
Epoch: 3, Steps: 34 | Train Loss: 3.817 Vali Loss: 2.074 Vali Acc: 0.601 Test Loss: 2.074 Test Acc: 0.601
Validation loss decreased (-0.427699 --> -0.601135).  Saving model ...
Epoch: 4 cost time: 5.209225654602051
Epoch: 4, Steps: 34 | Train Loss: 3.392 Vali Loss: 7.214 Vali Acc: 0.474 Test Loss: 7.214 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.128561973571777
Epoch: 5, Steps: 34 | Train Loss: 4.616 Vali Loss: 6.877 Vali Acc: 0.462 Test Loss: 6.877 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.204394102096558
Epoch: 6, Steps: 34 | Train Loss: 3.599 Vali Loss: 5.260 Vali Acc: 0.491 Test Loss: 5.260 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.460611343383789
Epoch: 7, Steps: 34 | Train Loss: 4.424 Vali Loss: 7.602 Vali Acc: 0.578 Test Loss: 7.602 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.468041658401489
Epoch: 8, Steps: 34 | Train Loss: 5.382 Vali Loss: 9.208 Vali Acc: 0.520 Test Loss: 9.208 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.145211935043335
Epoch: 9, Steps: 34 | Train Loss: 4.352 Vali Loss: 9.342 Vali Acc: 0.497 Test Loss: 9.342 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.781827211380005
Epoch: 10, Steps: 34 | Train Loss: 1.340 Vali Loss: 4.674 Vali Acc: 0.694 Test Loss: 4.674 Test Acc: 0.694
Validation loss decreased (-0.601135 --> -0.693595).  Saving model ...
Epoch: 11 cost time: 5.67708945274353
Epoch: 11, Steps: 34 | Train Loss: 1.639 Vali Loss: 4.705 Vali Acc: 0.751 Test Loss: 4.705 Test Acc: 0.751
Validation loss decreased (-0.693595 --> -0.751398).  Saving model ...
Epoch: 12 cost time: 5.017016649246216
Epoch: 12, Steps: 34 | Train Loss: 4.048 Vali Loss: 3.537 Vali Acc: 0.734 Test Loss: 3.537 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7209599018096924
Epoch: 13, Steps: 34 | Train Loss: 1.398 Vali Loss: 10.107 Vali Acc: 0.676 Test Loss: 10.107 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.139095067977905
Epoch: 14, Steps: 34 | Train Loss: 1.256 Vali Loss: 4.401 Vali Acc: 0.717 Test Loss: 4.401 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.6862287521362305
Epoch: 15, Steps: 34 | Train Loss: 2.423 Vali Loss: 16.906 Vali Acc: 0.457 Test Loss: 16.906 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.69811487197876
Epoch: 16, Steps: 34 | Train Loss: 2.335 Vali Loss: 4.808 Vali Acc: 0.809 Test Loss: 4.808 Test Acc: 0.809
Validation loss decreased (-0.751398 --> -0.809200).  Saving model ...
Epoch: 17 cost time: 4.5602333545684814
Epoch: 17, Steps: 34 | Train Loss: 1.432 Vali Loss: 3.867 Vali Acc: 0.803 Test Loss: 3.867 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.5340893268585205
Epoch: 18, Steps: 34 | Train Loss: 1.336 Vali Loss: 4.547 Vali Acc: 0.821 Test Loss: 4.547 Test Acc: 0.821
Validation loss decreased (-0.809200 --> -0.820764).  Saving model ...
Epoch: 19 cost time: 4.629028081893921
Epoch: 19, Steps: 34 | Train Loss: 0.885 Vali Loss: 6.123 Vali Acc: 0.746 Test Loss: 6.123 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.646301507949829
Epoch: 20, Steps: 34 | Train Loss: 3.052 Vali Loss: 17.693 Vali Acc: 0.624 Test Loss: 17.693 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.375459671020508
Epoch: 21, Steps: 34 | Train Loss: 2.751 Vali Loss: 7.398 Vali Acc: 0.769 Test Loss: 7.398 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.365748643875122
Epoch: 22, Steps: 34 | Train Loss: 3.155 Vali Loss: 14.627 Vali Acc: 0.699 Test Loss: 14.627 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.617653131484985
Epoch: 23, Steps: 34 | Train Loss: 0.977 Vali Loss: 4.899 Vali Acc: 0.873 Test Loss: 4.899 Test Acc: 0.873
Validation loss decreased (-0.820764 --> -0.872783).  Saving model ...
Epoch: 24 cost time: 4.807022571563721
Epoch: 24, Steps: 34 | Train Loss: 0.066 Vali Loss: 4.156 Vali Acc: 0.873 Test Loss: 4.156 Test Acc: 0.873
Validation loss decreased (-0.872783 --> -0.872791).  Saving model ...
Epoch: 25 cost time: 4.8458168506622314
Epoch: 25, Steps: 34 | Train Loss: 0.222 Vali Loss: 8.868 Vali Acc: 0.815 Test Loss: 8.868 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.708341836929321
Epoch: 26, Steps: 34 | Train Loss: 0.369 Vali Loss: 7.991 Vali Acc: 0.809 Test Loss: 7.991 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.640056848526001
Epoch: 27, Steps: 34 | Train Loss: 1.667 Vali Loss: 7.714 Vali Acc: 0.803 Test Loss: 7.714 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.715903043746948
Epoch: 28, Steps: 34 | Train Loss: 1.820 Vali Loss: 13.914 Vali Acc: 0.717 Test Loss: 13.914 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.786986827850342
Epoch: 29, Steps: 34 | Train Loss: 0.830 Vali Loss: 11.037 Vali Acc: 0.705 Test Loss: 11.037 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.68793797492981
Epoch: 30, Steps: 34 | Train Loss: 0.337 Vali Loss: 7.088 Vali Acc: 0.844 Test Loss: 7.088 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.786928176879883
Epoch: 31, Steps: 34 | Train Loss: 0.826 Vali Loss: 8.942 Vali Acc: 0.815 Test Loss: 8.942 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.706885576248169
Epoch: 32, Steps: 34 | Train Loss: 0.001 Vali Loss: 13.031 Vali Acc: 0.763 Test Loss: 13.031 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.176410913467407
Epoch: 33, Steps: 34 | Train Loss: 0.099 Vali Loss: 12.493 Vali Acc: 0.798 Test Loss: 12.493 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.201968193054199
Epoch: 34, Steps: 34 | Train Loss: 0.937 Vali Loss: 9.256 Vali Acc: 0.792 Test Loss: 9.256 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1796171
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.648004055023193
Epoch: 1, Steps: 34 | Train Loss: 3.677 Vali Loss: 7.220 Vali Acc: 0.324 Test Loss: 7.220 Test Acc: 0.324
Validation loss decreased (inf --> -0.323627).  Saving model ...
Epoch: 2 cost time: 4.8108251094818115
Epoch: 2, Steps: 34 | Train Loss: 4.576 Vali Loss: 4.651 Vali Acc: 0.353 Test Loss: 4.651 Test Acc: 0.353
Validation loss decreased (-0.323627 --> -0.352555).  Saving model ...
Epoch: 3 cost time: 4.640309810638428
Epoch: 3, Steps: 34 | Train Loss: 3.871 Vali Loss: 6.348 Vali Acc: 0.422 Test Loss: 6.348 Test Acc: 0.422
Validation loss decreased (-0.352555 --> -0.421902).  Saving model ...
Epoch: 4 cost time: 4.801483631134033
Epoch: 4, Steps: 34 | Train Loss: 4.752 Vali Loss: 4.813 Vali Acc: 0.624 Test Loss: 4.813 Test Acc: 0.624
Validation loss decreased (-0.421902 --> -0.624229).  Saving model ...
Epoch: 5 cost time: 4.572961330413818
Epoch: 5, Steps: 34 | Train Loss: 4.838 Vali Loss: 7.788 Vali Acc: 0.376 Test Loss: 7.788 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.538474798202515
Epoch: 6, Steps: 34 | Train Loss: 6.457 Vali Loss: 6.178 Vali Acc: 0.584 Test Loss: 6.178 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.607390403747559
Epoch: 7, Steps: 34 | Train Loss: 5.232 Vali Loss: 14.929 Vali Acc: 0.480 Test Loss: 14.929 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.424831390380859
Epoch: 8, Steps: 34 | Train Loss: 9.919 Vali Loss: 14.024 Vali Acc: 0.358 Test Loss: 14.024 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.376457929611206
Epoch: 9, Steps: 34 | Train Loss: 3.313 Vali Loss: 13.950 Vali Acc: 0.549 Test Loss: 13.950 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.422056674957275
Epoch: 10, Steps: 34 | Train Loss: 7.503 Vali Loss: 6.934 Vali Acc: 0.676 Test Loss: 6.934 Test Acc: 0.676
Validation loss decreased (-0.624229 --> -0.676231).  Saving model ...
Epoch: 11 cost time: 4.526368856430054
Epoch: 11, Steps: 34 | Train Loss: 7.384 Vali Loss: 14.981 Vali Acc: 0.526 Test Loss: 14.981 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.469926357269287
Epoch: 12, Steps: 34 | Train Loss: 6.369 Vali Loss: 6.109 Vali Acc: 0.682 Test Loss: 6.109 Test Acc: 0.682
Validation loss decreased (-0.676231 --> -0.682020).  Saving model ...
Epoch: 13 cost time: 4.4867072105407715
Epoch: 13, Steps: 34 | Train Loss: 2.800 Vali Loss: 9.580 Vali Acc: 0.659 Test Loss: 9.580 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.587350845336914
Epoch: 14, Steps: 34 | Train Loss: 3.101 Vali Loss: 12.692 Vali Acc: 0.555 Test Loss: 12.692 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.342508554458618
Epoch: 15, Steps: 34 | Train Loss: 2.965 Vali Loss: 4.210 Vali Acc: 0.803 Test Loss: 4.210 Test Acc: 0.803
Validation loss decreased (-0.682020 --> -0.803426).  Saving model ...
Epoch: 16 cost time: 4.384759902954102
Epoch: 16, Steps: 34 | Train Loss: 1.783 Vali Loss: 10.138 Vali Acc: 0.723 Test Loss: 10.138 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.443201303482056
Epoch: 17, Steps: 34 | Train Loss: 1.790 Vali Loss: 12.724 Vali Acc: 0.618 Test Loss: 12.724 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.498160362243652
Epoch: 18, Steps: 34 | Train Loss: 2.655 Vali Loss: 11.099 Vali Acc: 0.780 Test Loss: 11.099 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.495851039886475
Epoch: 19, Steps: 34 | Train Loss: 1.939 Vali Loss: 7.402 Vali Acc: 0.792 Test Loss: 7.402 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.521718263626099
Epoch: 20, Steps: 34 | Train Loss: 0.440 Vali Loss: 3.035 Vali Acc: 0.803 Test Loss: 3.035 Test Acc: 0.803
Validation loss decreased (-0.803426 --> -0.803438).  Saving model ...
Epoch: 21 cost time: 4.645278453826904
Epoch: 21, Steps: 34 | Train Loss: 0.250 Vali Loss: 8.096 Vali Acc: 0.728 Test Loss: 8.096 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.4517457485198975
Epoch: 22, Steps: 34 | Train Loss: 1.117 Vali Loss: 9.516 Vali Acc: 0.746 Test Loss: 9.516 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.4379565715789795
Epoch: 23, Steps: 34 | Train Loss: 0.294 Vali Loss: 6.200 Vali Acc: 0.827 Test Loss: 6.200 Test Acc: 0.827
Validation loss decreased (-0.803438 --> -0.826528).  Saving model ...
Epoch: 24 cost time: 4.9510276317596436
Epoch: 24, Steps: 34 | Train Loss: 0.055 Vali Loss: 7.370 Vali Acc: 0.763 Test Loss: 7.370 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.981688022613525
Epoch: 25, Steps: 34 | Train Loss: 1.556 Vali Loss: 27.867 Vali Acc: 0.532 Test Loss: 27.867 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.242938756942749
Epoch: 26, Steps: 34 | Train Loss: 2.616 Vali Loss: 17.518 Vali Acc: 0.526 Test Loss: 17.518 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.179466247558594
Epoch: 27, Steps: 34 | Train Loss: 4.180 Vali Loss: 25.939 Vali Acc: 0.561 Test Loss: 25.939 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.073408603668213
Epoch: 28, Steps: 34 | Train Loss: 1.841 Vali Loss: 9.018 Vali Acc: 0.757 Test Loss: 9.018 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.914275884628296
Epoch: 29, Steps: 34 | Train Loss: 0.424 Vali Loss: 6.318 Vali Acc: 0.798 Test Loss: 6.318 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.681950330734253
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 9.529 Vali Acc: 0.746 Test Loss: 9.529 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.898828029632568
Epoch: 31, Steps: 34 | Train Loss: 0.443 Vali Loss: 21.945 Vali Acc: 0.520 Test Loss: 21.945 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.97806191444397
Epoch: 32, Steps: 34 | Train Loss: 0.813 Vali Loss: 13.619 Vali Acc: 0.746 Test Loss: 13.619 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.463055849075317
Epoch: 33, Steps: 34 | Train Loss: 0.348 Vali Loss: 4.619 Vali Acc: 0.850 Test Loss: 4.619 Test Acc: 0.850
Validation loss decreased (-0.826528 --> -0.849665).  Saving model ...
Epoch: 34 cost time: 4.54844331741333
Epoch: 34, Steps: 34 | Train Loss: 0.167 Vali Loss: 11.781 Vali Acc: 0.751 Test Loss: 11.781 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.580686807632446
Epoch: 35, Steps: 34 | Train Loss: 0.213 Vali Loss: 3.822 Vali Acc: 0.850 Test Loss: 3.822 Test Acc: 0.850
Validation loss decreased (-0.849665 --> -0.849673).  Saving model ...
Epoch: 36 cost time: 4.370938539505005
Epoch: 36, Steps: 34 | Train Loss: 0.052 Vali Loss: 3.961 Vali Acc: 0.850 Test Loss: 3.961 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.379774570465088
Epoch: 37, Steps: 34 | Train Loss: 0.002 Vali Loss: 7.797 Vali Acc: 0.827 Test Loss: 7.797 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.398966550827026
Epoch: 38, Steps: 34 | Train Loss: 0.078 Vali Loss: 8.825 Vali Acc: 0.798 Test Loss: 8.825 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.470104455947876
Epoch: 39, Steps: 34 | Train Loss: 0.103 Vali Loss: 4.006 Vali Acc: 0.844 Test Loss: 4.006 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.4661736488342285
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.613 Vali Acc: 0.838 Test Loss: 4.613 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.508302927017212
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.633 Vali Acc: 0.827 Test Loss: 4.633 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.529783725738525
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.827 Test Loss: 4.634 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.402830123901367
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.827 Test Loss: 4.634 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.379443407058716
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.827 Test Loss: 4.634 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.43509578704834
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.827 Test Loss: 4.634 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1795595
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.173766613006592
Epoch: 1, Steps: 34 | Train Loss: 2.975 Vali Loss: 7.995 Vali Acc: 0.266 Test Loss: 7.995 Test Acc: 0.266
Validation loss decreased (inf --> -0.265816).  Saving model ...
Epoch: 2 cost time: 4.356409311294556
Epoch: 2, Steps: 34 | Train Loss: 4.918 Vali Loss: 6.773 Vali Acc: 0.410 Test Loss: 6.773 Test Acc: 0.410
Validation loss decreased (-0.265816 --> -0.410337).  Saving model ...
Epoch: 3 cost time: 4.465083360671997
Epoch: 3, Steps: 34 | Train Loss: 5.011 Vali Loss: 9.406 Vali Acc: 0.289 Test Loss: 9.406 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.090134620666504
Epoch: 4, Steps: 34 | Train Loss: 5.110 Vali Loss: 8.535 Vali Acc: 0.503 Test Loss: 8.535 Test Acc: 0.503
Validation loss decreased (-0.410337 --> -0.502805).  Saving model ...
Epoch: 5 cost time: 5.205384016036987
Epoch: 5, Steps: 34 | Train Loss: 9.333 Vali Loss: 18.093 Vali Acc: 0.283 Test Loss: 18.093 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.031914949417114
Epoch: 6, Steps: 34 | Train Loss: 6.129 Vali Loss: 5.805 Vali Acc: 0.671 Test Loss: 5.805 Test Acc: 0.671
Validation loss decreased (-0.502805 --> -0.670462).  Saving model ...
Epoch: 7 cost time: 5.3526318073272705
Epoch: 7, Steps: 34 | Train Loss: 3.431 Vali Loss: 6.246 Vali Acc: 0.520 Test Loss: 6.246 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.9651875495910645
Epoch: 8, Steps: 34 | Train Loss: 3.420 Vali Loss: 9.101 Vali Acc: 0.566 Test Loss: 9.101 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.877639532089233
Epoch: 9, Steps: 34 | Train Loss: 4.754 Vali Loss: 2.450 Vali Acc: 0.815 Test Loss: 2.450 Test Acc: 0.815
Validation loss decreased (-0.670462 --> -0.815004).  Saving model ...
Epoch: 10 cost time: 4.933701992034912
Epoch: 10, Steps: 34 | Train Loss: 4.573 Vali Loss: 6.599 Vali Acc: 0.659 Test Loss: 6.599 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.066821575164795
Epoch: 11, Steps: 34 | Train Loss: 2.511 Vali Loss: 4.227 Vali Acc: 0.757 Test Loss: 4.227 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.988602876663208
Epoch: 12, Steps: 34 | Train Loss: 1.539 Vali Loss: 9.689 Vali Acc: 0.671 Test Loss: 9.689 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.646950721740723
Epoch: 13, Steps: 34 | Train Loss: 1.742 Vali Loss: 5.835 Vali Acc: 0.734 Test Loss: 5.835 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.562422275543213
Epoch: 14, Steps: 34 | Train Loss: 1.802 Vali Loss: 3.577 Vali Acc: 0.763 Test Loss: 3.577 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.546324968338013
Epoch: 15, Steps: 34 | Train Loss: 0.868 Vali Loss: 3.519 Vali Acc: 0.792 Test Loss: 3.519 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.46340274810791
Epoch: 16, Steps: 34 | Train Loss: 0.697 Vali Loss: 4.580 Vali Acc: 0.699 Test Loss: 4.580 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.607335090637207
Epoch: 17, Steps: 34 | Train Loss: 1.093 Vali Loss: 3.604 Vali Acc: 0.815 Test Loss: 3.604 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.644019842147827
Epoch: 18, Steps: 34 | Train Loss: 0.187 Vali Loss: 4.760 Vali Acc: 0.803 Test Loss: 4.760 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.531486511230469
Epoch: 19, Steps: 34 | Train Loss: 0.072 Vali Loss: 7.379 Vali Acc: 0.734 Test Loss: 7.379 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1795019
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.043328523635864
Epoch: 1, Steps: 34 | Train Loss: 3.119 Vali Loss: 2.250 Vali Acc: 0.462 Test Loss: 2.250 Test Acc: 0.462
Validation loss decreased (inf --> -0.462405).  Saving model ...
Epoch: 2 cost time: 4.024044990539551
Epoch: 2, Steps: 34 | Train Loss: 3.067 Vali Loss: 3.785 Vali Acc: 0.422 Test Loss: 3.785 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.057050466537476
Epoch: 3, Steps: 34 | Train Loss: 4.290 Vali Loss: 9.032 Vali Acc: 0.526 Test Loss: 9.032 Test Acc: 0.526
Validation loss decreased (-0.462405 --> -0.525921).  Saving model ...
Epoch: 4 cost time: 4.106482744216919
Epoch: 4, Steps: 34 | Train Loss: 11.646 Vali Loss: 3.578 Vali Acc: 0.468 Test Loss: 3.578 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.022582292556763
Epoch: 5, Steps: 34 | Train Loss: 7.399 Vali Loss: 9.222 Vali Acc: 0.566 Test Loss: 9.222 Test Acc: 0.566
Validation loss decreased (-0.525921 --> -0.566382).  Saving model ...
Epoch: 6 cost time: 3.8836758136749268
Epoch: 6, Steps: 34 | Train Loss: 5.863 Vali Loss: 12.729 Vali Acc: 0.514 Test Loss: 12.729 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9274826049804688
Epoch: 7, Steps: 34 | Train Loss: 8.922 Vali Loss: 7.197 Vali Acc: 0.607 Test Loss: 7.197 Test Acc: 0.607
Validation loss decreased (-0.566382 --> -0.606864).  Saving model ...
Epoch: 8 cost time: 4.036710739135742
Epoch: 8, Steps: 34 | Train Loss: 4.958 Vali Loss: 6.836 Vali Acc: 0.572 Test Loss: 6.836 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.151843547821045
Epoch: 9, Steps: 34 | Train Loss: 2.405 Vali Loss: 14.056 Vali Acc: 0.543 Test Loss: 14.056 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.272629022598267
Epoch: 10, Steps: 34 | Train Loss: 2.051 Vali Loss: 14.511 Vali Acc: 0.480 Test Loss: 14.511 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.76578164100647
Epoch: 11, Steps: 34 | Train Loss: 3.664 Vali Loss: 6.612 Vali Acc: 0.699 Test Loss: 6.612 Test Acc: 0.699
Validation loss decreased (-0.606864 --> -0.699356).  Saving model ...
Epoch: 12 cost time: 4.602609634399414
Epoch: 12, Steps: 34 | Train Loss: 3.942 Vali Loss: 5.588 Vali Acc: 0.723 Test Loss: 5.588 Test Acc: 0.723
Validation loss decreased (-0.699356 --> -0.722487).  Saving model ...
Epoch: 13 cost time: 4.39303994178772
Epoch: 13, Steps: 34 | Train Loss: 3.939 Vali Loss: 9.558 Vali Acc: 0.653 Test Loss: 9.558 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.354691743850708
Epoch: 14, Steps: 34 | Train Loss: 3.239 Vali Loss: 3.115 Vali Acc: 0.757 Test Loss: 3.115 Test Acc: 0.757
Validation loss decreased (-0.722487 --> -0.757194).  Saving model ...
Epoch: 15 cost time: 4.418933153152466
Epoch: 15, Steps: 34 | Train Loss: 1.699 Vali Loss: 11.019 Vali Acc: 0.566 Test Loss: 11.019 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.541484355926514
Epoch: 16, Steps: 34 | Train Loss: 0.423 Vali Loss: 5.698 Vali Acc: 0.728 Test Loss: 5.698 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.665182590484619
Epoch: 17, Steps: 34 | Train Loss: 1.614 Vali Loss: 3.205 Vali Acc: 0.803 Test Loss: 3.205 Test Acc: 0.803
Validation loss decreased (-0.757194 --> -0.803436).  Saving model ...
Epoch: 18 cost time: 4.78743052482605
Epoch: 18, Steps: 34 | Train Loss: 1.125 Vali Loss: 13.336 Vali Acc: 0.624 Test Loss: 13.336 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.667420387268066
Epoch: 19, Steps: 34 | Train Loss: 2.119 Vali Loss: 4.030 Vali Acc: 0.780 Test Loss: 4.030 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.001348495483398
Epoch: 20, Steps: 34 | Train Loss: 0.084 Vali Loss: 2.796 Vali Acc: 0.838 Test Loss: 2.796 Test Acc: 0.838
Validation loss decreased (-0.803436 --> -0.838122).  Saving model ...
Epoch: 21 cost time: 3.8950419425964355
Epoch: 21, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.488 Vali Acc: 0.844 Test Loss: 3.488 Test Acc: 0.844
Validation loss decreased (-0.838122 --> -0.843896).  Saving model ...
Epoch: 22 cost time: 4.125631332397461
Epoch: 22, Steps: 34 | Train Loss: 0.076 Vali Loss: 5.956 Vali Acc: 0.740 Test Loss: 5.956 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.030515909194946
Epoch: 23, Steps: 34 | Train Loss: 0.169 Vali Loss: 6.309 Vali Acc: 0.751 Test Loss: 6.309 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.104058265686035
Epoch: 24, Steps: 34 | Train Loss: 0.935 Vali Loss: 3.326 Vali Acc: 0.827 Test Loss: 3.326 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.2063069343566895
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.507 Vali Acc: 0.827 Test Loss: 3.507 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.147596597671509
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.245 Vali Acc: 0.832 Test Loss: 3.245 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.95772647857666
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.231 Vali Acc: 0.832 Test Loss: 3.231 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.0298871994018555
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.231 Vali Acc: 0.832 Test Loss: 3.231 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.0433690547943115
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.230 Vali Acc: 0.832 Test Loss: 3.230 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.042084217071533
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.229 Vali Acc: 0.832 Test Loss: 3.229 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.108496189117432
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 3.227 Vali Acc: 0.832 Test Loss: 3.227 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1794443
model size : 7.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.112937211990356
Epoch: 1, Steps: 34 | Train Loss: 42.748 Vali Loss: 137.547 Vali Acc: 0.243 Test Loss: 137.547 Test Acc: 0.243
Validation loss decreased (inf --> -0.241399).  Saving model ...
Epoch: 2 cost time: 10.582827806472778
Epoch: 2, Steps: 34 | Train Loss: 90.290 Vali Loss: 110.478 Vali Acc: 0.376 Test Loss: 110.478 Test Acc: 0.376
Validation loss decreased (-0.241399 --> -0.374618).  Saving model ...
Epoch: 3 cost time: 10.670090198516846
Epoch: 3, Steps: 34 | Train Loss: 108.173 Vali Loss: 97.668 Vali Acc: 0.543 Test Loss: 97.668 Test Acc: 0.543
Validation loss decreased (-0.374618 --> -0.542376).  Saving model ...
Epoch: 4 cost time: 11.3336923122406
Epoch: 4, Steps: 34 | Train Loss: 83.478 Vali Loss: 65.894 Vali Acc: 0.486 Test Loss: 65.894 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.587146282196045
Epoch: 5, Steps: 34 | Train Loss: 43.210 Vali Loss: 42.087 Vali Acc: 0.601 Test Loss: 42.087 Test Acc: 0.601
Validation loss decreased (-0.542376 --> -0.600735).  Saving model ...
Epoch: 6 cost time: 12.621235609054565
Epoch: 6, Steps: 34 | Train Loss: 56.482 Vali Loss: 48.281 Vali Acc: 0.688 Test Loss: 48.281 Test Acc: 0.688
Validation loss decreased (-0.600735 --> -0.687378).  Saving model ...
Epoch: 7 cost time: 11.574475765228271
Epoch: 7, Steps: 34 | Train Loss: 45.838 Vali Loss: 112.167 Vali Acc: 0.543 Test Loss: 112.167 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.513533592224121
Epoch: 8, Steps: 34 | Train Loss: 34.501 Vali Loss: 57.570 Vali Acc: 0.705 Test Loss: 57.570 Test Acc: 0.705
Validation loss decreased (-0.687378 --> -0.704627).  Saving model ...
Epoch: 9 cost time: 10.564049482345581
Epoch: 9, Steps: 34 | Train Loss: 16.291 Vali Loss: 91.741 Vali Acc: 0.595 Test Loss: 91.741 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.857209205627441
Epoch: 10, Steps: 34 | Train Loss: 30.807 Vali Loss: 78.517 Vali Acc: 0.613 Test Loss: 78.517 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.676475763320923
Epoch: 11, Steps: 34 | Train Loss: 7.899 Vali Loss: 39.517 Vali Acc: 0.728 Test Loss: 39.517 Test Acc: 0.728
Validation loss decreased (-0.704627 --> -0.727929).  Saving model ...
Epoch: 12 cost time: 10.324859142303467
Epoch: 12, Steps: 34 | Train Loss: 5.475 Vali Loss: 76.233 Vali Acc: 0.682 Test Loss: 76.233 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.78883409500122
Epoch: 13, Steps: 34 | Train Loss: 18.476 Vali Loss: 54.959 Vali Acc: 0.717 Test Loss: 54.959 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.298401832580566
Epoch: 14, Steps: 34 | Train Loss: 10.384 Vali Loss: 83.866 Vali Acc: 0.728 Test Loss: 83.866 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.514779567718506
Epoch: 15, Steps: 34 | Train Loss: 13.366 Vali Loss: 35.558 Vali Acc: 0.803 Test Loss: 35.558 Test Acc: 0.803
Validation loss decreased (-0.727929 --> -0.803113).  Saving model ...
Epoch: 16 cost time: 10.46063756942749
Epoch: 16, Steps: 34 | Train Loss: 8.006 Vali Loss: 40.689 Vali Acc: 0.763 Test Loss: 40.689 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.70814299583435
Epoch: 17, Steps: 34 | Train Loss: 8.124 Vali Loss: 58.905 Vali Acc: 0.671 Test Loss: 58.905 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.548466920852661
Epoch: 18, Steps: 34 | Train Loss: 11.764 Vali Loss: 77.697 Vali Acc: 0.763 Test Loss: 77.697 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.473232507705688
Epoch: 19, Steps: 34 | Train Loss: 8.496 Vali Loss: 101.187 Vali Acc: 0.618 Test Loss: 101.187 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 12.397693634033203
Epoch: 20, Steps: 34 | Train Loss: 7.834 Vali Loss: 100.510 Vali Acc: 0.740 Test Loss: 100.510 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.762992143630981
Epoch: 21, Steps: 34 | Train Loss: 8.287 Vali Loss: 200.312 Vali Acc: 0.491 Test Loss: 200.312 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.054729700088501
Epoch: 22, Steps: 34 | Train Loss: 15.932 Vali Loss: 28.693 Vali Acc: 0.850 Test Loss: 28.693 Test Acc: 0.850
Validation loss decreased (-0.803113 --> -0.849424).  Saving model ...
Epoch: 23 cost time: 11.307579278945923
Epoch: 23, Steps: 34 | Train Loss: 3.392 Vali Loss: 92.624 Vali Acc: 0.746 Test Loss: 92.624 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.935225009918213
Epoch: 24, Steps: 34 | Train Loss: 3.073 Vali Loss: 72.247 Vali Acc: 0.775 Test Loss: 72.247 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.33822751045227
Epoch: 25, Steps: 34 | Train Loss: 4.773 Vali Loss: 71.198 Vali Acc: 0.838 Test Loss: 71.198 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.01320195198059
Epoch: 26, Steps: 34 | Train Loss: 6.685 Vali Loss: 85.869 Vali Acc: 0.751 Test Loss: 85.869 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.695299625396729
Epoch: 27, Steps: 34 | Train Loss: 1.012 Vali Loss: 84.404 Vali Acc: 0.699 Test Loss: 84.404 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.667870998382568
Epoch: 28, Steps: 34 | Train Loss: 3.768 Vali Loss: 73.598 Vali Acc: 0.734 Test Loss: 73.598 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 10.397642135620117
Epoch: 29, Steps: 34 | Train Loss: 0.421 Vali Loss: 65.527 Vali Acc: 0.734 Test Loss: 65.527 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 10.516291379928589
Epoch: 30, Steps: 34 | Train Loss: 3.258 Vali Loss: 109.095 Vali Acc: 0.688 Test Loss: 109.095 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 10.271481275558472
Epoch: 31, Steps: 34 | Train Loss: 5.450 Vali Loss: 80.195 Vali Acc: 0.740 Test Loss: 80.195 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 10.859541177749634
Epoch: 32, Steps: 34 | Train Loss: 2.121 Vali Loss: 46.211 Vali Acc: 0.798 Test Loss: 46.211 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28432415
model size : 113.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.358598709106445
Epoch: 1, Steps: 34 | Train Loss: 53.137 Vali Loss: 58.197 Vali Acc: 0.197 Test Loss: 58.197 Test Acc: 0.197
Validation loss decreased (inf --> -0.195950).  Saving model ...
Epoch: 2 cost time: 11.490815877914429
Epoch: 2, Steps: 34 | Train Loss: 86.462 Vali Loss: 143.743 Vali Acc: 0.318 Test Loss: 143.743 Test Acc: 0.318
Validation loss decreased (-0.195950 --> -0.316482).  Saving model ...
Epoch: 3 cost time: 11.51109004020691
Epoch: 3, Steps: 34 | Train Loss: 79.209 Vali Loss: 86.944 Vali Acc: 0.439 Test Loss: 86.944 Test Acc: 0.439
Validation loss decreased (-0.316482 --> -0.438437).  Saving model ...
Epoch: 4 cost time: 12.032834768295288
Epoch: 4, Steps: 34 | Train Loss: 87.302 Vali Loss: 129.733 Vali Acc: 0.486 Test Loss: 129.733 Test Acc: 0.486
Validation loss decreased (-0.438437 --> -0.484252).  Saving model ...
Epoch: 5 cost time: 10.513048887252808
Epoch: 5, Steps: 34 | Train Loss: 59.523 Vali Loss: 84.098 Vali Acc: 0.572 Test Loss: 84.098 Test Acc: 0.572
Validation loss decreased (-0.484252 --> -0.571413).  Saving model ...
Epoch: 6 cost time: 10.112362384796143
Epoch: 6, Steps: 34 | Train Loss: 51.163 Vali Loss: 117.132 Vali Acc: 0.393 Test Loss: 117.132 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.52907919883728
Epoch: 7, Steps: 34 | Train Loss: 54.812 Vali Loss: 95.492 Vali Acc: 0.647 Test Loss: 95.492 Test Acc: 0.647
Validation loss decreased (-0.571413 --> -0.646444).  Saving model ...
Epoch: 8 cost time: 10.765427350997925
Epoch: 8, Steps: 34 | Train Loss: 33.557 Vali Loss: 40.867 Vali Acc: 0.699 Test Loss: 40.867 Test Acc: 0.699
Validation loss decreased (-0.646444 --> -0.699013).  Saving model ...
Epoch: 9 cost time: 10.206651210784912
Epoch: 9, Steps: 34 | Train Loss: 16.790 Vali Loss: 34.610 Vali Acc: 0.809 Test Loss: 34.610 Test Acc: 0.809
Validation loss decreased (-0.699013 --> -0.808902).  Saving model ...
Epoch: 10 cost time: 10.365342617034912
Epoch: 10, Steps: 34 | Train Loss: 20.020 Vali Loss: 61.225 Vali Acc: 0.751 Test Loss: 61.225 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.347795248031616
Epoch: 11, Steps: 34 | Train Loss: 16.918 Vali Loss: 39.178 Vali Acc: 0.786 Test Loss: 39.178 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.462325096130371
Epoch: 12, Steps: 34 | Train Loss: 10.908 Vali Loss: 89.024 Vali Acc: 0.717 Test Loss: 89.024 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.252010822296143
Epoch: 13, Steps: 34 | Train Loss: 9.687 Vali Loss: 53.829 Vali Acc: 0.798 Test Loss: 53.829 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.502958297729492
Epoch: 14, Steps: 34 | Train Loss: 19.056 Vali Loss: 54.404 Vali Acc: 0.798 Test Loss: 54.404 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.360854148864746
Epoch: 15, Steps: 34 | Train Loss: 26.296 Vali Loss: 72.337 Vali Acc: 0.676 Test Loss: 72.337 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.262653112411499
Epoch: 16, Steps: 34 | Train Loss: 17.950 Vali Loss: 92.389 Vali Acc: 0.653 Test Loss: 92.389 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.355641603469849
Epoch: 17, Steps: 34 | Train Loss: 17.076 Vali Loss: 151.355 Vali Acc: 0.630 Test Loss: 151.355 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.193026065826416
Epoch: 18, Steps: 34 | Train Loss: 13.342 Vali Loss: 154.978 Vali Acc: 0.694 Test Loss: 154.978 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.204319953918457
Epoch: 19, Steps: 34 | Train Loss: 7.203 Vali Loss: 54.936 Vali Acc: 0.792 Test Loss: 54.936 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 28429343
model size : 113.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.251041412353516
Epoch: 1, Steps: 34 | Train Loss: 39.352 Vali Loss: 67.643 Vali Acc: 0.277 Test Loss: 67.643 Test Acc: 0.277
Validation loss decreased (inf --> -0.276780).  Saving model ...
Epoch: 2 cost time: 10.553769826889038
Epoch: 2, Steps: 34 | Train Loss: 40.610 Vali Loss: 41.815 Vali Acc: 0.416 Test Loss: 41.815 Test Acc: 0.416
Validation loss decreased (-0.276780 --> -0.415767).  Saving model ...
Epoch: 3 cost time: 10.26778507232666
Epoch: 3, Steps: 34 | Train Loss: 85.200 Vali Loss: 28.456 Vali Acc: 0.595 Test Loss: 28.456 Test Acc: 0.595
Validation loss decreased (-0.415767 --> -0.595091).  Saving model ...
Epoch: 4 cost time: 10.513588428497314
Epoch: 4, Steps: 34 | Train Loss: 53.800 Vali Loss: 102.315 Vali Acc: 0.532 Test Loss: 102.315 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.25178050994873
Epoch: 5, Steps: 34 | Train Loss: 49.308 Vali Loss: 35.970 Vali Acc: 0.538 Test Loss: 35.970 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.80841612815857
Epoch: 6, Steps: 34 | Train Loss: 32.033 Vali Loss: 31.304 Vali Acc: 0.717 Test Loss: 31.304 Test Acc: 0.717
Validation loss decreased (-0.595091 --> -0.716450).  Saving model ...
Epoch: 7 cost time: 10.079439163208008
Epoch: 7, Steps: 34 | Train Loss: 63.128 Vali Loss: 133.427 Vali Acc: 0.428 Test Loss: 133.427 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.753112554550171
Epoch: 8, Steps: 34 | Train Loss: 23.023 Vali Loss: 53.236 Vali Acc: 0.694 Test Loss: 53.236 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.605008840560913
Epoch: 9, Steps: 34 | Train Loss: 17.289 Vali Loss: 40.603 Vali Acc: 0.734 Test Loss: 40.603 Test Acc: 0.734
Validation loss decreased (-0.716450 --> -0.733698).  Saving model ...
Epoch: 10 cost time: 10.176036834716797
Epoch: 10, Steps: 34 | Train Loss: 11.549 Vali Loss: 48.696 Vali Acc: 0.723 Test Loss: 48.696 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.335024118423462
Epoch: 11, Steps: 34 | Train Loss: 21.183 Vali Loss: 42.819 Vali Acc: 0.711 Test Loss: 42.819 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.808796167373657
Epoch: 12, Steps: 34 | Train Loss: 5.899 Vali Loss: 38.767 Vali Acc: 0.757 Test Loss: 38.767 Test Acc: 0.757
Validation loss decreased (-0.733698 --> -0.756838).  Saving model ...
Epoch: 13 cost time: 11.09717321395874
Epoch: 13, Steps: 34 | Train Loss: 11.599 Vali Loss: 46.365 Vali Acc: 0.699 Test Loss: 46.365 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.903019189834595
Epoch: 14, Steps: 34 | Train Loss: 8.365 Vali Loss: 73.322 Vali Acc: 0.705 Test Loss: 73.322 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.894680976867676
Epoch: 15, Steps: 34 | Train Loss: 10.606 Vali Loss: 53.939 Vali Acc: 0.780 Test Loss: 53.939 Test Acc: 0.780
Validation loss decreased (-0.756838 --> -0.779807).  Saving model ...
Epoch: 16 cost time: 9.95390009880066
Epoch: 16, Steps: 34 | Train Loss: 7.021 Vali Loss: 58.622 Vali Acc: 0.618 Test Loss: 58.622 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.213557004928589
Epoch: 17, Steps: 34 | Train Loss: 11.518 Vali Loss: 103.899 Vali Acc: 0.624 Test Loss: 103.899 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.83191704750061
Epoch: 18, Steps: 34 | Train Loss: 3.506 Vali Loss: 56.959 Vali Acc: 0.809 Test Loss: 56.959 Test Acc: 0.809
Validation loss decreased (-0.779807 --> -0.808679).  Saving model ...
Epoch: 19 cost time: 10.048347473144531
Epoch: 19, Steps: 34 | Train Loss: 7.587 Vali Loss: 44.915 Vali Acc: 0.775 Test Loss: 44.915 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.003714323043823
Epoch: 20, Steps: 34 | Train Loss: 4.951 Vali Loss: 44.265 Vali Acc: 0.815 Test Loss: 44.265 Test Acc: 0.815
Validation loss decreased (-0.808679 --> -0.814586).  Saving model ...
Epoch: 21 cost time: 10.397873401641846
Epoch: 21, Steps: 34 | Train Loss: 1.561 Vali Loss: 54.622 Vali Acc: 0.757 Test Loss: 54.622 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.956865549087524
Epoch: 22, Steps: 34 | Train Loss: 0.707 Vali Loss: 138.771 Vali Acc: 0.671 Test Loss: 138.771 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.348129510879517
Epoch: 23, Steps: 34 | Train Loss: 1.751 Vali Loss: 46.511 Vali Acc: 0.798 Test Loss: 46.511 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.303967475891113
Epoch: 24, Steps: 34 | Train Loss: 2.233 Vali Loss: 38.163 Vali Acc: 0.786 Test Loss: 38.163 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 10.398160696029663
Epoch: 25, Steps: 34 | Train Loss: 1.810 Vali Loss: 66.260 Vali Acc: 0.786 Test Loss: 66.260 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.729650020599365
Epoch: 26, Steps: 34 | Train Loss: 5.968 Vali Loss: 72.221 Vali Acc: 0.723 Test Loss: 72.221 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.803523302078247
Epoch: 27, Steps: 34 | Train Loss: 6.489 Vali Loss: 82.558 Vali Acc: 0.780 Test Loss: 82.558 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.055673122406006
Epoch: 28, Steps: 34 | Train Loss: 3.572 Vali Loss: 72.202 Vali Acc: 0.728 Test Loss: 72.202 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.390363693237305
Epoch: 29, Steps: 34 | Train Loss: 2.855 Vali Loss: 37.234 Vali Acc: 0.844 Test Loss: 37.234 Test Acc: 0.844
Validation loss decreased (-0.814586 --> -0.843558).  Saving model ...
Epoch: 30 cost time: 10.154441595077515
Epoch: 30, Steps: 34 | Train Loss: 1.336 Vali Loss: 56.901 Vali Acc: 0.798 Test Loss: 56.901 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 10.240951538085938
Epoch: 31, Steps: 34 | Train Loss: 3.131 Vali Loss: 40.354 Vali Acc: 0.815 Test Loss: 40.354 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 11.025107622146606
Epoch: 32, Steps: 34 | Train Loss: 7.846 Vali Loss: 74.261 Vali Acc: 0.803 Test Loss: 74.261 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 10.628666162490845
Epoch: 33, Steps: 34 | Train Loss: 7.422 Vali Loss: 79.744 Vali Acc: 0.711 Test Loss: 79.744 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 10.176784753799438
Epoch: 34, Steps: 34 | Train Loss: 2.588 Vali Loss: 48.668 Vali Acc: 0.786 Test Loss: 48.668 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 11.131651878356934
Epoch: 35, Steps: 34 | Train Loss: 1.775 Vali Loss: 67.914 Vali Acc: 0.827 Test Loss: 67.914 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 9.979836702346802
Epoch: 36, Steps: 34 | Train Loss: 1.903 Vali Loss: 51.716 Vali Acc: 0.850 Test Loss: 51.716 Test Acc: 0.850
Validation loss decreased (-0.843558 --> -0.849194).  Saving model ...
Epoch: 37 cost time: 10.343955278396606
Epoch: 37, Steps: 34 | Train Loss: 2.152 Vali Loss: 38.950 Vali Acc: 0.844 Test Loss: 38.950 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 10.451380729675293
Epoch: 38, Steps: 34 | Train Loss: 0.231 Vali Loss: 66.098 Vali Acc: 0.786 Test Loss: 66.098 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 10.731081008911133
Epoch: 39, Steps: 34 | Train Loss: 0.696 Vali Loss: 31.813 Vali Acc: 0.832 Test Loss: 31.813 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 10.582403898239136
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 73.906 Vali Acc: 0.803 Test Loss: 73.906 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 11.213470458984375
Epoch: 41, Steps: 34 | Train Loss: 2.150 Vali Loss: 61.972 Vali Acc: 0.844 Test Loss: 61.972 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 12.774450063705444
Epoch: 42, Steps: 34 | Train Loss: 2.277 Vali Loss: 48.012 Vali Acc: 0.809 Test Loss: 48.012 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 11.34057068824768
Epoch: 43, Steps: 34 | Train Loss: 0.706 Vali Loss: 66.008 Vali Acc: 0.763 Test Loss: 66.008 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 11.434991359710693
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 70.955 Vali Acc: 0.751 Test Loss: 70.955 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 11.123713731765747
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 71.093 Vali Acc: 0.751 Test Loss: 71.093 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 10.389186382293701
Epoch: 46, Steps: 34 | Train Loss: 0.000 Vali Loss: 71.019 Vali Acc: 0.751 Test Loss: 71.019 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28426271
model size : 113.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.328149557113647
Epoch: 1, Steps: 34 | Train Loss: 51.171 Vali Loss: 51.221 Vali Acc: 0.364 Test Loss: 51.221 Test Acc: 0.364
Validation loss decreased (inf --> -0.363650).  Saving model ...
Epoch: 2 cost time: 10.234193325042725
Epoch: 2, Steps: 34 | Train Loss: 71.964 Vali Loss: 59.647 Vali Acc: 0.503 Test Loss: 59.647 Test Acc: 0.503
Validation loss decreased (-0.363650 --> -0.502294).  Saving model ...
Epoch: 3 cost time: 10.207698583602905
Epoch: 3, Steps: 34 | Train Loss: 92.334 Vali Loss: 119.131 Vali Acc: 0.462 Test Loss: 119.131 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.568701267242432
Epoch: 4, Steps: 34 | Train Loss: 85.652 Vali Loss: 33.644 Vali Acc: 0.584 Test Loss: 33.644 Test Acc: 0.584
Validation loss decreased (-0.502294 --> -0.583479).  Saving model ...
Epoch: 5 cost time: 9.981797695159912
Epoch: 5, Steps: 34 | Train Loss: 34.304 Vali Loss: 48.646 Vali Acc: 0.723 Test Loss: 48.646 Test Acc: 0.723
Validation loss decreased (-0.583479 --> -0.722057).  Saving model ...
Epoch: 6 cost time: 10.362706661224365
Epoch: 6, Steps: 34 | Train Loss: 27.738 Vali Loss: 19.346 Vali Acc: 0.740 Test Loss: 19.346 Test Acc: 0.740
Validation loss decreased (-0.722057 --> -0.739691).  Saving model ...
Epoch: 7 cost time: 9.81003212928772
Epoch: 7, Steps: 34 | Train Loss: 23.579 Vali Loss: 105.840 Vali Acc: 0.514 Test Loss: 105.840 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.590804815292358
Epoch: 8, Steps: 34 | Train Loss: 19.811 Vali Loss: 14.117 Vali Acc: 0.827 Test Loss: 14.117 Test Acc: 0.827
Validation loss decreased (-0.739691 --> -0.826448).  Saving model ...
Epoch: 9 cost time: 12.577303171157837
Epoch: 9, Steps: 34 | Train Loss: 30.148 Vali Loss: 65.357 Vali Acc: 0.653 Test Loss: 65.357 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.25683069229126
Epoch: 10, Steps: 34 | Train Loss: 17.528 Vali Loss: 92.083 Vali Acc: 0.659 Test Loss: 92.083 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.903985977172852
Epoch: 11, Steps: 34 | Train Loss: 27.865 Vali Loss: 47.125 Vali Acc: 0.671 Test Loss: 47.125 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.381791591644287
Epoch: 12, Steps: 34 | Train Loss: 13.557 Vali Loss: 139.738 Vali Acc: 0.462 Test Loss: 139.738 Test Acc: 0.462
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.3849196434021
Epoch: 13, Steps: 34 | Train Loss: 20.280 Vali Loss: 40.481 Vali Acc: 0.751 Test Loss: 40.481 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.030359745025635
Epoch: 14, Steps: 34 | Train Loss: 12.219 Vali Loss: 58.042 Vali Acc: 0.717 Test Loss: 58.042 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.16070008277893
Epoch: 15, Steps: 34 | Train Loss: 13.764 Vali Loss: 70.409 Vali Acc: 0.705 Test Loss: 70.409 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.86536455154419
Epoch: 16, Steps: 34 | Train Loss: 12.649 Vali Loss: 119.470 Vali Acc: 0.688 Test Loss: 119.470 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.114302396774292
Epoch: 17, Steps: 34 | Train Loss: 14.497 Vali Loss: 38.401 Vali Acc: 0.803 Test Loss: 38.401 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.830977201461792
Epoch: 18, Steps: 34 | Train Loss: 4.392 Vali Loss: 75.316 Vali Acc: 0.694 Test Loss: 75.316 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 28423199
model size : 113.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.986494064331055
Epoch: 1, Steps: 34 | Train Loss: 36.408 Vali Loss: 82.094 Vali Acc: 0.347 Test Loss: 82.094 Test Acc: 0.347
Validation loss decreased (inf --> -0.346000).  Saving model ...
Epoch: 2 cost time: 9.023437261581421
Epoch: 2, Steps: 34 | Train Loss: 62.301 Vali Loss: 72.019 Vali Acc: 0.434 Test Loss: 72.019 Test Acc: 0.434
Validation loss decreased (-0.346000 --> -0.432806).  Saving model ...
Epoch: 3 cost time: 9.855283975601196
Epoch: 3, Steps: 34 | Train Loss: 108.470 Vali Loss: 212.687 Vali Acc: 0.335 Test Loss: 212.687 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.01944088935852
Epoch: 4, Steps: 34 | Train Loss: 152.012 Vali Loss: 181.753 Vali Acc: 0.370 Test Loss: 181.753 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.380747079849243
Epoch: 5, Steps: 34 | Train Loss: 98.659 Vali Loss: 69.425 Vali Acc: 0.503 Test Loss: 69.425 Test Acc: 0.503
Validation loss decreased (-0.432806 --> -0.502196).  Saving model ...
Epoch: 6 cost time: 10.74583888053894
Epoch: 6, Steps: 34 | Train Loss: 66.480 Vali Loss: 61.815 Vali Acc: 0.642 Test Loss: 61.815 Test Acc: 0.642
Validation loss decreased (-0.502196 --> -0.641000).  Saving model ...
Epoch: 7 cost time: 10.89992642402649
Epoch: 7, Steps: 34 | Train Loss: 31.189 Vali Loss: 48.979 Vali Acc: 0.665 Test Loss: 48.979 Test Acc: 0.665
Validation loss decreased (-0.641000 --> -0.664250).  Saving model ...
Epoch: 8 cost time: 9.38773798942566
Epoch: 8, Steps: 34 | Train Loss: 55.600 Vali Loss: 109.182 Vali Acc: 0.439 Test Loss: 109.182 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.302603244781494
Epoch: 9, Steps: 34 | Train Loss: 37.813 Vali Loss: 193.442 Vali Acc: 0.480 Test Loss: 193.442 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.132493257522583
Epoch: 10, Steps: 34 | Train Loss: 50.742 Vali Loss: 171.801 Vali Acc: 0.514 Test Loss: 171.801 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.54092001914978
Epoch: 11, Steps: 34 | Train Loss: 28.829 Vali Loss: 51.516 Vali Acc: 0.775 Test Loss: 51.516 Test Acc: 0.775
Validation loss decreased (-0.664250 --> -0.774051).  Saving model ...
Epoch: 12 cost time: 9.053866863250732
Epoch: 12, Steps: 34 | Train Loss: 20.661 Vali Loss: 67.463 Vali Acc: 0.763 Test Loss: 67.463 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.247674465179443
Epoch: 13, Steps: 34 | Train Loss: 11.451 Vali Loss: 140.162 Vali Acc: 0.584 Test Loss: 140.162 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.487733840942383
Epoch: 14, Steps: 34 | Train Loss: 8.617 Vali Loss: 63.343 Vali Acc: 0.746 Test Loss: 63.343 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.417554378509521
Epoch: 15, Steps: 34 | Train Loss: 11.629 Vali Loss: 119.913 Vali Acc: 0.705 Test Loss: 119.913 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.532885551452637
Epoch: 16, Steps: 34 | Train Loss: 10.859 Vali Loss: 63.959 Vali Acc: 0.792 Test Loss: 63.959 Test Acc: 0.792
Validation loss decreased (-0.774051 --> -0.791268).  Saving model ...
Epoch: 17 cost time: 9.075335264205933
Epoch: 17, Steps: 34 | Train Loss: 26.039 Vali Loss: 106.400 Vali Acc: 0.682 Test Loss: 106.400 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.678173542022705
Epoch: 18, Steps: 34 | Train Loss: 29.358 Vali Loss: 84.300 Vali Acc: 0.699 Test Loss: 84.300 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.249496698379517
Epoch: 19, Steps: 34 | Train Loss: 11.909 Vali Loss: 116.134 Vali Acc: 0.601 Test Loss: 116.134 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.46036982536316
Epoch: 20, Steps: 34 | Train Loss: 4.954 Vali Loss: 124.439 Vali Acc: 0.717 Test Loss: 124.439 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.384467124938965
Epoch: 21, Steps: 34 | Train Loss: 5.327 Vali Loss: 47.493 Vali Acc: 0.850 Test Loss: 47.493 Test Acc: 0.850
Validation loss decreased (-0.791268 --> -0.849236).  Saving model ...
Epoch: 22 cost time: 10.78068995475769
Epoch: 22, Steps: 34 | Train Loss: 8.088 Vali Loss: 54.330 Vali Acc: 0.821 Test Loss: 54.330 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.970336198806763
Epoch: 23, Steps: 34 | Train Loss: 1.316 Vali Loss: 103.699 Vali Acc: 0.682 Test Loss: 103.699 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.635353088378906
Epoch: 24, Steps: 34 | Train Loss: 6.545 Vali Loss: 60.346 Vali Acc: 0.809 Test Loss: 60.346 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.489721775054932
Epoch: 25, Steps: 34 | Train Loss: 1.123 Vali Loss: 118.778 Vali Acc: 0.746 Test Loss: 118.778 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.687068939208984
Epoch: 26, Steps: 34 | Train Loss: 4.142 Vali Loss: 59.177 Vali Acc: 0.809 Test Loss: 59.177 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.138837575912476
Epoch: 27, Steps: 34 | Train Loss: 0.275 Vali Loss: 122.706 Vali Acc: 0.682 Test Loss: 122.706 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.647743225097656
Epoch: 28, Steps: 34 | Train Loss: 5.140 Vali Loss: 143.995 Vali Acc: 0.723 Test Loss: 143.995 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.73949933052063
Epoch: 29, Steps: 34 | Train Loss: 4.940 Vali Loss: 90.103 Vali Acc: 0.728 Test Loss: 90.103 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.363248109817505
Epoch: 30, Steps: 34 | Train Loss: 1.320 Vali Loss: 44.007 Vali Acc: 0.821 Test Loss: 44.007 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.261499643325806
Epoch: 31, Steps: 34 | Train Loss: 0.814 Vali Loss: 84.946 Vali Acc: 0.775 Test Loss: 84.946 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 27644447
model size : 110.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.347562789916992
Epoch: 1, Steps: 34 | Train Loss: 56.252 Vali Loss: 104.074 Vali Acc: 0.301 Test Loss: 104.074 Test Acc: 0.301
Validation loss decreased (inf --> -0.299537).  Saving model ...
Epoch: 2 cost time: 9.07636833190918
Epoch: 2, Steps: 34 | Train Loss: 81.918 Vali Loss: 115.535 Vali Acc: 0.370 Test Loss: 115.535 Test Acc: 0.370
Validation loss decreased (-0.299537 --> -0.368787).  Saving model ...
Epoch: 3 cost time: 11.372005701065063
Epoch: 3, Steps: 34 | Train Loss: 81.042 Vali Loss: 111.243 Vali Acc: 0.370 Test Loss: 111.243 Test Acc: 0.370
Validation loss decreased (-0.368787 --> -0.368830).  Saving model ...
Epoch: 4 cost time: 11.435806035995483
Epoch: 4, Steps: 34 | Train Loss: 103.290 Vali Loss: 100.205 Vali Acc: 0.405 Test Loss: 100.205 Test Acc: 0.405
Validation loss decreased (-0.368830 --> -0.403622).  Saving model ...
Epoch: 5 cost time: 10.233788251876831
Epoch: 5, Steps: 34 | Train Loss: 84.542 Vali Loss: 283.947 Vali Acc: 0.358 Test Loss: 283.947 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.052735328674316
Epoch: 6, Steps: 34 | Train Loss: 71.679 Vali Loss: 145.469 Vali Acc: 0.566 Test Loss: 145.469 Test Acc: 0.566
Validation loss decreased (-0.403622 --> -0.565019).  Saving model ...
Epoch: 7 cost time: 9.670045614242554
Epoch: 7, Steps: 34 | Train Loss: 87.410 Vali Loss: 116.600 Vali Acc: 0.665 Test Loss: 116.600 Test Acc: 0.665
Validation loss decreased (-0.565019 --> -0.663574).  Saving model ...
Epoch: 8 cost time: 9.115641832351685
Epoch: 8, Steps: 34 | Train Loss: 54.376 Vali Loss: 40.609 Vali Acc: 0.757 Test Loss: 40.609 Test Acc: 0.757
Validation loss decreased (-0.663574 --> -0.756819).  Saving model ...
Epoch: 9 cost time: 9.403403759002686
Epoch: 9, Steps: 34 | Train Loss: 22.734 Vali Loss: 48.532 Vali Acc: 0.728 Test Loss: 48.532 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.565537691116333
Epoch: 10, Steps: 34 | Train Loss: 12.964 Vali Loss: 124.016 Vali Acc: 0.555 Test Loss: 124.016 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.596971035003662
Epoch: 11, Steps: 34 | Train Loss: 51.596 Vali Loss: 42.056 Vali Acc: 0.728 Test Loss: 42.056 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.502676248550415
Epoch: 12, Steps: 34 | Train Loss: 14.338 Vali Loss: 95.705 Vali Acc: 0.566 Test Loss: 95.705 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.199881792068481
Epoch: 13, Steps: 34 | Train Loss: 13.124 Vali Loss: 91.486 Vali Acc: 0.607 Test Loss: 91.486 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.802749872207642
Epoch: 14, Steps: 34 | Train Loss: 12.678 Vali Loss: 75.169 Vali Acc: 0.734 Test Loss: 75.169 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.399585008621216
Epoch: 15, Steps: 34 | Train Loss: 14.089 Vali Loss: 58.664 Vali Acc: 0.746 Test Loss: 58.664 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.254347324371338
Epoch: 16, Steps: 34 | Train Loss: 5.458 Vali Loss: 80.832 Vali Acc: 0.751 Test Loss: 80.832 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.58970308303833
Epoch: 17, Steps: 34 | Train Loss: 5.887 Vali Loss: 60.053 Vali Acc: 0.809 Test Loss: 60.053 Test Acc: 0.809
Validation loss decreased (-0.756819 --> -0.808648).  Saving model ...
Epoch: 18 cost time: 10.853517293930054
Epoch: 18, Steps: 34 | Train Loss: 4.851 Vali Loss: 39.258 Vali Acc: 0.855 Test Loss: 39.258 Test Acc: 0.855
Validation loss decreased (-0.808648 --> -0.855099).  Saving model ...
Epoch: 19 cost time: 10.452857971191406
Epoch: 19, Steps: 34 | Train Loss: 1.232 Vali Loss: 51.933 Vali Acc: 0.780 Test Loss: 51.933 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.225239038467407
Epoch: 20, Steps: 34 | Train Loss: 6.011 Vali Loss: 71.941 Vali Acc: 0.769 Test Loss: 71.941 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.211000442504883
Epoch: 21, Steps: 34 | Train Loss: 3.423 Vali Loss: 114.364 Vali Acc: 0.746 Test Loss: 114.364 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.92431116104126
Epoch: 22, Steps: 34 | Train Loss: 4.911 Vali Loss: 58.112 Vali Acc: 0.786 Test Loss: 58.112 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.32129693031311
Epoch: 23, Steps: 34 | Train Loss: 10.361 Vali Loss: 87.947 Vali Acc: 0.705 Test Loss: 87.947 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.27846360206604
Epoch: 24, Steps: 34 | Train Loss: 7.215 Vali Loss: 36.751 Vali Acc: 0.815 Test Loss: 36.751 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.585751056671143
Epoch: 25, Steps: 34 | Train Loss: 12.457 Vali Loss: 106.743 Vali Acc: 0.757 Test Loss: 106.743 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.867807626724243
Epoch: 26, Steps: 34 | Train Loss: 10.423 Vali Loss: 99.400 Vali Acc: 0.682 Test Loss: 99.400 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.55815839767456
Epoch: 27, Steps: 34 | Train Loss: 4.599 Vali Loss: 48.481 Vali Acc: 0.821 Test Loss: 48.481 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.34656023979187
Epoch: 28, Steps: 34 | Train Loss: 4.650 Vali Loss: 88.305 Vali Acc: 0.803 Test Loss: 88.305 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 27641375
model size : 110.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.52271580696106
Epoch: 1, Steps: 34 | Train Loss: 50.292 Vali Loss: 96.961 Vali Acc: 0.272 Test Loss: 96.961 Test Acc: 0.272
Validation loss decreased (inf --> -0.270707).  Saving model ...
Epoch: 2 cost time: 9.18032193183899
Epoch: 2, Steps: 34 | Train Loss: 84.813 Vali Loss: 128.896 Vali Acc: 0.393 Test Loss: 128.896 Test Acc: 0.393
Validation loss decreased (-0.270707 --> -0.391775).  Saving model ...
Epoch: 3 cost time: 9.544968605041504
Epoch: 3, Steps: 34 | Train Loss: 108.628 Vali Loss: 205.364 Vali Acc: 0.358 Test Loss: 205.364 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.882423639297485
Epoch: 4, Steps: 34 | Train Loss: 105.367 Vali Loss: 84.075 Vali Acc: 0.636 Test Loss: 84.075 Test Acc: 0.636
Validation loss decreased (-0.391775 --> -0.634997).  Saving model ...
Epoch: 5 cost time: 10.812894582748413
Epoch: 5, Steps: 34 | Train Loss: 58.164 Vali Loss: 106.415 Vali Acc: 0.549 Test Loss: 106.415 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.243822813034058
Epoch: 6, Steps: 34 | Train Loss: 55.667 Vali Loss: 54.281 Vali Acc: 0.723 Test Loss: 54.281 Test Acc: 0.723
Validation loss decreased (-0.634997 --> -0.722001).  Saving model ...
Epoch: 7 cost time: 11.124715328216553
Epoch: 7, Steps: 34 | Train Loss: 64.795 Vali Loss: 163.945 Vali Acc: 0.451 Test Loss: 163.945 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.129039525985718
Epoch: 8, Steps: 34 | Train Loss: 42.006 Vali Loss: 108.136 Vali Acc: 0.578 Test Loss: 108.136 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.138344049453735
Epoch: 9, Steps: 34 | Train Loss: 40.955 Vali Loss: 96.902 Vali Acc: 0.584 Test Loss: 96.902 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.096707344055176
Epoch: 10, Steps: 34 | Train Loss: 19.820 Vali Loss: 97.224 Vali Acc: 0.659 Test Loss: 97.224 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.78031873703003
Epoch: 11, Steps: 34 | Train Loss: 29.556 Vali Loss: 202.150 Vali Acc: 0.659 Test Loss: 202.150 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.087487936019897
Epoch: 12, Steps: 34 | Train Loss: 39.497 Vali Loss: 51.902 Vali Acc: 0.792 Test Loss: 51.902 Test Acc: 0.792
Validation loss decreased (-0.722001 --> -0.791388).  Saving model ...
Epoch: 13 cost time: 9.051825046539307
Epoch: 13, Steps: 34 | Train Loss: 17.340 Vali Loss: 137.097 Vali Acc: 0.618 Test Loss: 137.097 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.218782663345337
Epoch: 14, Steps: 34 | Train Loss: 26.242 Vali Loss: 95.838 Vali Acc: 0.653 Test Loss: 95.838 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.8604097366333
Epoch: 15, Steps: 34 | Train Loss: 24.836 Vali Loss: 38.380 Vali Acc: 0.757 Test Loss: 38.380 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.324684143066406
Epoch: 16, Steps: 34 | Train Loss: 20.623 Vali Loss: 48.610 Vali Acc: 0.786 Test Loss: 48.610 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.350897789001465
Epoch: 17, Steps: 34 | Train Loss: 9.938 Vali Loss: 84.691 Vali Acc: 0.717 Test Loss: 84.691 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.341853857040405
Epoch: 18, Steps: 34 | Train Loss: 7.286 Vali Loss: 54.054 Vali Acc: 0.786 Test Loss: 54.054 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.109878063201904
Epoch: 19, Steps: 34 | Train Loss: 2.987 Vali Loss: 100.704 Vali Acc: 0.763 Test Loss: 100.704 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.976942539215088
Epoch: 20, Steps: 34 | Train Loss: 9.163 Vali Loss: 128.741 Vali Acc: 0.694 Test Loss: 128.741 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.134621620178223
Epoch: 21, Steps: 34 | Train Loss: 8.685 Vali Loss: 175.213 Vali Acc: 0.613 Test Loss: 175.213 Test Acc: 0.613
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.86411190032959
Epoch: 22, Steps: 34 | Train Loss: 3.127 Vali Loss: 95.431 Vali Acc: 0.757 Test Loss: 95.431 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 27638303
model size : 110.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.981691837310791
Epoch: 1, Steps: 34 | Train Loss: 49.716 Vali Loss: 44.655 Vali Acc: 0.249 Test Loss: 44.655 Test Acc: 0.249
Validation loss decreased (inf --> -0.248108).  Saving model ...
Epoch: 2 cost time: 9.176865100860596
Epoch: 2, Steps: 34 | Train Loss: 84.861 Vali Loss: 73.927 Vali Acc: 0.457 Test Loss: 73.927 Test Acc: 0.457
Validation loss decreased (-0.248108 --> -0.455908).  Saving model ...
Epoch: 3 cost time: 9.070633172988892
Epoch: 3, Steps: 34 | Train Loss: 76.449 Vali Loss: 129.032 Vali Acc: 0.439 Test Loss: 129.032 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.63155198097229
Epoch: 4, Steps: 34 | Train Loss: 107.370 Vali Loss: 59.740 Vali Acc: 0.543 Test Loss: 59.740 Test Acc: 0.543
Validation loss decreased (-0.455908 --> -0.542755).  Saving model ...
Epoch: 5 cost time: 9.348384141921997
Epoch: 5, Steps: 34 | Train Loss: 43.714 Vali Loss: 47.984 Vali Acc: 0.642 Test Loss: 47.984 Test Acc: 0.642
Validation loss decreased (-0.542755 --> -0.641139).  Saving model ...
Epoch: 6 cost time: 8.96804141998291
Epoch: 6, Steps: 34 | Train Loss: 51.020 Vali Loss: 80.148 Vali Acc: 0.595 Test Loss: 80.148 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.13726258277893
Epoch: 7, Steps: 34 | Train Loss: 76.629 Vali Loss: 142.244 Vali Acc: 0.595 Test Loss: 142.244 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.864232301712036
Epoch: 8, Steps: 34 | Train Loss: 47.224 Vali Loss: 90.653 Vali Acc: 0.566 Test Loss: 90.653 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.49354600906372
Epoch: 9, Steps: 34 | Train Loss: 26.481 Vali Loss: 105.474 Vali Acc: 0.630 Test Loss: 105.474 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.345300197601318
Epoch: 10, Steps: 34 | Train Loss: 40.649 Vali Loss: 45.031 Vali Acc: 0.740 Test Loss: 45.031 Test Acc: 0.740
Validation loss decreased (-0.641139 --> -0.739434).  Saving model ...
Epoch: 11 cost time: 9.184672355651855
Epoch: 11, Steps: 34 | Train Loss: 32.129 Vali Loss: 138.194 Vali Acc: 0.526 Test Loss: 138.194 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.588606595993042
Epoch: 12, Steps: 34 | Train Loss: 37.137 Vali Loss: 190.521 Vali Acc: 0.509 Test Loss: 190.521 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.169842720031738
Epoch: 13, Steps: 34 | Train Loss: 45.724 Vali Loss: 111.220 Vali Acc: 0.728 Test Loss: 111.220 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.401532411575317
Epoch: 14, Steps: 34 | Train Loss: 21.034 Vali Loss: 122.917 Vali Acc: 0.682 Test Loss: 122.917 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.618478775024414
Epoch: 15, Steps: 34 | Train Loss: 29.415 Vali Loss: 76.534 Vali Acc: 0.734 Test Loss: 76.534 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.899758338928223
Epoch: 16, Steps: 34 | Train Loss: 26.826 Vali Loss: 178.130 Vali Acc: 0.595 Test Loss: 178.130 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.804821252822876
Epoch: 17, Steps: 34 | Train Loss: 30.820 Vali Loss: 85.995 Vali Acc: 0.763 Test Loss: 85.995 Test Acc: 0.763
Validation loss decreased (-0.739434 --> -0.762146).  Saving model ...
Epoch: 18 cost time: 9.060485124588013
Epoch: 18, Steps: 34 | Train Loss: 7.319 Vali Loss: 113.093 Vali Acc: 0.769 Test Loss: 113.093 Test Acc: 0.769
Validation loss decreased (-0.762146 --> -0.767655).  Saving model ...
Epoch: 19 cost time: 9.248613357543945
Epoch: 19, Steps: 34 | Train Loss: 17.175 Vali Loss: 24.672 Vali Acc: 0.832 Test Loss: 24.672 Test Acc: 0.832
Validation loss decreased (-0.767655 --> -0.832123).  Saving model ...
Epoch: 20 cost time: 9.422521352767944
Epoch: 20, Steps: 34 | Train Loss: 9.500 Vali Loss: 91.269 Vali Acc: 0.740 Test Loss: 91.269 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.06201982498169
Epoch: 21, Steps: 34 | Train Loss: 19.853 Vali Loss: 42.908 Vali Acc: 0.827 Test Loss: 42.908 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.163866996765137
Epoch: 22, Steps: 34 | Train Loss: 4.904 Vali Loss: 88.737 Vali Acc: 0.746 Test Loss: 88.737 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.57107663154602
Epoch: 23, Steps: 34 | Train Loss: 7.151 Vali Loss: 116.311 Vali Acc: 0.728 Test Loss: 116.311 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.169039011001587
Epoch: 24, Steps: 34 | Train Loss: 5.120 Vali Loss: 108.200 Vali Acc: 0.792 Test Loss: 108.200 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 9.05090856552124
Epoch: 25, Steps: 34 | Train Loss: 8.332 Vali Loss: 73.086 Vali Acc: 0.734 Test Loss: 73.086 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.98671579360962
Epoch: 26, Steps: 34 | Train Loss: 4.623 Vali Loss: 72.904 Vali Acc: 0.769 Test Loss: 72.904 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 9.447411298751831
Epoch: 27, Steps: 34 | Train Loss: 3.358 Vali Loss: 106.224 Vali Acc: 0.740 Test Loss: 106.224 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.068267583847046
Epoch: 28, Steps: 34 | Train Loss: 1.106 Vali Loss: 99.731 Vali Acc: 0.746 Test Loss: 99.731 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 9.291984796524048
Epoch: 29, Steps: 34 | Train Loss: 1.435 Vali Loss: 90.133 Vali Acc: 0.798 Test Loss: 90.133 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 27635231
model size : 110.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.257311820983887
Epoch: 1, Steps: 34 | Train Loss: 45.527 Vali Loss: 55.214 Vali Acc: 0.405 Test Loss: 55.214 Test Acc: 0.405
Validation loss decreased (inf --> -0.404072).  Saving model ...
Epoch: 2 cost time: 9.968379974365234
Epoch: 2, Steps: 34 | Train Loss: 69.031 Vali Loss: 110.383 Vali Acc: 0.306 Test Loss: 110.383 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.354886054992676
Epoch: 3, Steps: 34 | Train Loss: 109.537 Vali Loss: 47.179 Vali Acc: 0.434 Test Loss: 47.179 Test Acc: 0.434
Validation loss decreased (-0.404072 --> -0.433054).  Saving model ...
Epoch: 4 cost time: 9.269423961639404
Epoch: 4, Steps: 34 | Train Loss: 112.833 Vali Loss: 85.545 Vali Acc: 0.462 Test Loss: 85.545 Test Acc: 0.462
Validation loss decreased (-0.433054 --> -0.461572).  Saving model ...
Epoch: 5 cost time: 8.901248455047607
Epoch: 5, Steps: 34 | Train Loss: 126.095 Vali Loss: 44.215 Vali Acc: 0.572 Test Loss: 44.215 Test Acc: 0.572
Validation loss decreased (-0.461572 --> -0.571812).  Saving model ...
Epoch: 6 cost time: 9.028365135192871
Epoch: 6, Steps: 34 | Train Loss: 48.447 Vali Loss: 140.685 Vali Acc: 0.578 Test Loss: 140.685 Test Acc: 0.578
Validation loss decreased (-0.571812 --> -0.576628).  Saving model ...
Epoch: 7 cost time: 9.1764554977417
Epoch: 7, Steps: 34 | Train Loss: 88.975 Vali Loss: 128.347 Vali Acc: 0.526 Test Loss: 128.347 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.453163146972656
Epoch: 8, Steps: 34 | Train Loss: 56.606 Vali Loss: 73.671 Vali Acc: 0.561 Test Loss: 73.671 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.263119220733643
Epoch: 9, Steps: 34 | Train Loss: 20.106 Vali Loss: 92.587 Vali Acc: 0.561 Test Loss: 92.587 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.080105781555176
Epoch: 10, Steps: 34 | Train Loss: 47.446 Vali Loss: 50.719 Vali Acc: 0.642 Test Loss: 50.719 Test Acc: 0.642
Validation loss decreased (-0.576628 --> -0.641111).  Saving model ...
Epoch: 11 cost time: 9.313737392425537
Epoch: 11, Steps: 34 | Train Loss: 12.722 Vali Loss: 159.281 Vali Acc: 0.549 Test Loss: 159.281 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.153039932250977
Epoch: 12, Steps: 34 | Train Loss: 16.414 Vali Loss: 33.847 Vali Acc: 0.769 Test Loss: 33.847 Test Acc: 0.769
Validation loss decreased (-0.641111 --> -0.768448).  Saving model ...
Epoch: 13 cost time: 9.046451330184937
Epoch: 13, Steps: 34 | Train Loss: 9.208 Vali Loss: 70.917 Vali Acc: 0.723 Test Loss: 70.917 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.810516595840454
Epoch: 14, Steps: 34 | Train Loss: 16.755 Vali Loss: 21.675 Vali Acc: 0.803 Test Loss: 21.675 Test Acc: 0.803
Validation loss decreased (-0.768448 --> -0.803251).  Saving model ...
Epoch: 15 cost time: 10.773062705993652
Epoch: 15, Steps: 34 | Train Loss: 7.009 Vali Loss: 68.470 Vali Acc: 0.775 Test Loss: 68.470 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.457016468048096
Epoch: 16, Steps: 34 | Train Loss: 10.568 Vali Loss: 44.174 Vali Acc: 0.780 Test Loss: 44.174 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.843397617340088
Epoch: 17, Steps: 34 | Train Loss: 6.289 Vali Loss: 63.823 Vali Acc: 0.694 Test Loss: 63.823 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.790189504623413
Epoch: 18, Steps: 34 | Train Loss: 9.243 Vali Loss: 48.911 Vali Acc: 0.786 Test Loss: 48.911 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.729719877243042
Epoch: 19, Steps: 34 | Train Loss: 6.719 Vali Loss: 117.768 Vali Acc: 0.671 Test Loss: 117.768 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.930896759033203
Epoch: 20, Steps: 34 | Train Loss: 6.549 Vali Loss: 68.983 Vali Acc: 0.699 Test Loss: 68.983 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.142331600189209
Epoch: 21, Steps: 34 | Train Loss: 11.446 Vali Loss: 107.612 Vali Acc: 0.653 Test Loss: 107.612 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.273048400878906
Epoch: 22, Steps: 34 | Train Loss: 16.287 Vali Loss: 46.712 Vali Acc: 0.792 Test Loss: 46.712 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.395684242248535
Epoch: 23, Steps: 34 | Train Loss: 5.560 Vali Loss: 46.127 Vali Acc: 0.832 Test Loss: 46.127 Test Acc: 0.832
Validation loss decreased (-0.803251 --> -0.831909).  Saving model ...
Epoch: 24 cost time: 9.198674440383911
Epoch: 24, Steps: 34 | Train Loss: 4.339 Vali Loss: 41.933 Vali Acc: 0.821 Test Loss: 41.933 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 9.113457441329956
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 51.749 Vali Acc: 0.815 Test Loss: 51.749 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 9.155503273010254
Epoch: 26, Steps: 34 | Train Loss: 0.718 Vali Loss: 51.849 Vali Acc: 0.809 Test Loss: 51.849 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 9.047356605529785
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.771 Vali Acc: 0.815 Test Loss: 54.771 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 9.047675609588623
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.860 Vali Acc: 0.815 Test Loss: 54.860 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.793824911117554
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.862 Vali Acc: 0.815 Test Loss: 54.862 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 8.797334432601929
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.862 Vali Acc: 0.815 Test Loss: 54.862 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 9.071193933486938
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.862 Vali Acc: 0.815 Test Loss: 54.862 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 10.23928165435791
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.862 Vali Acc: 0.815 Test Loss: 54.862 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 10.197938203811646
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.862 Vali Acc: 0.815 Test Loss: 54.862 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 27250463
model size : 108.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.342610359191895
Epoch: 1, Steps: 34 | Train Loss: 35.621 Vali Loss: 57.394 Vali Acc: 0.301 Test Loss: 57.394 Test Acc: 0.301
Validation loss decreased (inf --> -0.300004).  Saving model ...
Epoch: 2 cost time: 9.022322416305542
Epoch: 2, Steps: 34 | Train Loss: 57.910 Vali Loss: 36.778 Vali Acc: 0.422 Test Loss: 36.778 Test Acc: 0.422
Validation loss decreased (-0.300004 --> -0.421598).  Saving model ...
Epoch: 3 cost time: 9.450109004974365
Epoch: 3, Steps: 34 | Train Loss: 54.124 Vali Loss: 76.549 Vali Acc: 0.566 Test Loss: 76.549 Test Acc: 0.566
Validation loss decreased (-0.421598 --> -0.565709).  Saving model ...
Epoch: 4 cost time: 8.955824613571167
Epoch: 4, Steps: 34 | Train Loss: 96.552 Vali Loss: 118.848 Vali Acc: 0.358 Test Loss: 118.848 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.021955966949463
Epoch: 5, Steps: 34 | Train Loss: 74.173 Vali Loss: 90.036 Vali Acc: 0.474 Test Loss: 90.036 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.06286883354187
Epoch: 6, Steps: 34 | Train Loss: 68.149 Vali Loss: 231.537 Vali Acc: 0.457 Test Loss: 231.537 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.167059898376465
Epoch: 7, Steps: 34 | Train Loss: 72.362 Vali Loss: 74.641 Vali Acc: 0.607 Test Loss: 74.641 Test Acc: 0.607
Validation loss decreased (-0.565709 --> -0.606190).  Saving model ...
Epoch: 8 cost time: 8.894713878631592
Epoch: 8, Steps: 34 | Train Loss: 49.137 Vali Loss: 65.412 Vali Acc: 0.723 Test Loss: 65.412 Test Acc: 0.723
Validation loss decreased (-0.606190 --> -0.721889).  Saving model ...
Epoch: 9 cost time: 8.830003023147583
Epoch: 9, Steps: 34 | Train Loss: 34.270 Vali Loss: 104.068 Vali Acc: 0.711 Test Loss: 104.068 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.054805278778076
Epoch: 10, Steps: 34 | Train Loss: 31.312 Vali Loss: 144.496 Vali Acc: 0.671 Test Loss: 144.496 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.229220628738403
Epoch: 11, Steps: 34 | Train Loss: 61.018 Vali Loss: 108.683 Vali Acc: 0.688 Test Loss: 108.683 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.041715860366821
Epoch: 12, Steps: 34 | Train Loss: 16.992 Vali Loss: 148.941 Vali Acc: 0.734 Test Loss: 148.941 Test Acc: 0.734
Validation loss decreased (-0.721889 --> -0.732615).  Saving model ...
Epoch: 13 cost time: 8.86399793624878
Epoch: 13, Steps: 34 | Train Loss: 32.993 Vali Loss: 43.627 Vali Acc: 0.827 Test Loss: 43.627 Test Acc: 0.827
Validation loss decreased (-0.732615 --> -0.826153).  Saving model ...
Epoch: 14 cost time: 10.670460939407349
Epoch: 14, Steps: 34 | Train Loss: 14.642 Vali Loss: 60.037 Vali Acc: 0.728 Test Loss: 60.037 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.57931661605835
Epoch: 15, Steps: 34 | Train Loss: 39.944 Vali Loss: 51.340 Vali Acc: 0.780 Test Loss: 51.340 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.148571491241455
Epoch: 16, Steps: 34 | Train Loss: 14.308 Vali Loss: 265.167 Vali Acc: 0.538 Test Loss: 265.167 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.925012350082397
Epoch: 17, Steps: 34 | Train Loss: 27.973 Vali Loss: 90.734 Vali Acc: 0.746 Test Loss: 90.734 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.368239879608154
Epoch: 18, Steps: 34 | Train Loss: 27.650 Vali Loss: 94.322 Vali Acc: 0.705 Test Loss: 94.322 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.731822729110718
Epoch: 19, Steps: 34 | Train Loss: 9.495 Vali Loss: 69.366 Vali Acc: 0.769 Test Loss: 69.366 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.196871519088745
Epoch: 20, Steps: 34 | Train Loss: 13.801 Vali Loss: 75.742 Vali Acc: 0.775 Test Loss: 75.742 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.327243089675903
Epoch: 21, Steps: 34 | Train Loss: 32.684 Vali Loss: 114.582 Vali Acc: 0.659 Test Loss: 114.582 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.037086725234985
Epoch: 22, Steps: 34 | Train Loss: 10.783 Vali Loss: 66.210 Vali Acc: 0.809 Test Loss: 66.210 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.008557558059692
Epoch: 23, Steps: 34 | Train Loss: 24.601 Vali Loss: 102.408 Vali Acc: 0.717 Test Loss: 102.408 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 27247391
model size : 108.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.860176086425781
Epoch: 1, Steps: 34 | Train Loss: 42.060 Vali Loss: 56.522 Vali Acc: 0.243 Test Loss: 56.522 Test Acc: 0.243
Validation loss decreased (inf --> -0.242209).  Saving model ...
Epoch: 2 cost time: 9.064765691757202
Epoch: 2, Steps: 34 | Train Loss: 75.701 Vali Loss: 111.571 Vali Acc: 0.289 Test Loss: 111.571 Test Acc: 0.289
Validation loss decreased (-0.242209 --> -0.287902).  Saving model ...
Epoch: 3 cost time: 9.358497619628906
Epoch: 3, Steps: 34 | Train Loss: 65.565 Vali Loss: 94.817 Vali Acc: 0.561 Test Loss: 94.817 Test Acc: 0.561
Validation loss decreased (-0.287902 --> -0.559745).  Saving model ...
Epoch: 4 cost time: 9.071138858795166
Epoch: 4, Steps: 34 | Train Loss: 89.284 Vali Loss: 119.227 Vali Acc: 0.578 Test Loss: 119.227 Test Acc: 0.578
Validation loss decreased (-0.559745 --> -0.576842).  Saving model ...
Epoch: 5 cost time: 9.647088766098022
Epoch: 5, Steps: 34 | Train Loss: 58.687 Vali Loss: 67.375 Vali Acc: 0.653 Test Loss: 67.375 Test Acc: 0.653
Validation loss decreased (-0.576842 --> -0.652505).  Saving model ...
Epoch: 6 cost time: 10.46845555305481
Epoch: 6, Steps: 34 | Train Loss: 82.945 Vali Loss: 203.236 Vali Acc: 0.370 Test Loss: 203.236 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.477277994155884
Epoch: 7, Steps: 34 | Train Loss: 108.323 Vali Loss: 140.212 Vali Acc: 0.555 Test Loss: 140.212 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.076660633087158
Epoch: 8, Steps: 34 | Train Loss: 31.473 Vali Loss: 38.251 Vali Acc: 0.780 Test Loss: 38.251 Test Acc: 0.780
Validation loss decreased (-0.652505 --> -0.779964).  Saving model ...
Epoch: 9 cost time: 10.005141973495483
Epoch: 9, Steps: 34 | Train Loss: 15.795 Vali Loss: 19.405 Vali Acc: 0.844 Test Loss: 19.405 Test Acc: 0.844
Validation loss decreased (-0.779964 --> -0.843737).  Saving model ...
Epoch: 10 cost time: 9.17551589012146
Epoch: 10, Steps: 34 | Train Loss: 10.880 Vali Loss: 61.897 Vali Acc: 0.636 Test Loss: 61.897 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.01442265510559
Epoch: 11, Steps: 34 | Train Loss: 17.078 Vali Loss: 71.854 Vali Acc: 0.740 Test Loss: 71.854 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.918495416641235
Epoch: 12, Steps: 34 | Train Loss: 14.038 Vali Loss: 52.977 Vali Acc: 0.763 Test Loss: 52.977 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.083798885345459
Epoch: 13, Steps: 34 | Train Loss: 15.333 Vali Loss: 35.830 Vali Acc: 0.832 Test Loss: 35.830 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.100009441375732
Epoch: 14, Steps: 34 | Train Loss: 11.924 Vali Loss: 21.813 Vali Acc: 0.844 Test Loss: 21.813 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.023497819900513
Epoch: 15, Steps: 34 | Train Loss: 5.384 Vali Loss: 54.469 Vali Acc: 0.775 Test Loss: 54.469 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.800823450088501
Epoch: 16, Steps: 34 | Train Loss: 12.585 Vali Loss: 31.618 Vali Acc: 0.879 Test Loss: 31.618 Test Acc: 0.879
Validation loss decreased (-0.843737 --> -0.878297).  Saving model ...
Epoch: 17 cost time: 8.994678497314453
Epoch: 17, Steps: 34 | Train Loss: 6.243 Vali Loss: 88.701 Vali Acc: 0.705 Test Loss: 88.701 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.176002979278564
Epoch: 18, Steps: 34 | Train Loss: 18.432 Vali Loss: 168.326 Vali Acc: 0.532 Test Loss: 168.326 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.795675039291382
Epoch: 19, Steps: 34 | Train Loss: 8.928 Vali Loss: 76.478 Vali Acc: 0.659 Test Loss: 76.478 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.828337669372559
Epoch: 20, Steps: 34 | Train Loss: 17.325 Vali Loss: 76.350 Vali Acc: 0.717 Test Loss: 76.350 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.796312093734741
Epoch: 21, Steps: 34 | Train Loss: 9.195 Vali Loss: 58.073 Vali Acc: 0.769 Test Loss: 58.073 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.636546850204468
Epoch: 22, Steps: 34 | Train Loss: 7.547 Vali Loss: 58.422 Vali Acc: 0.803 Test Loss: 58.422 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.762122392654419
Epoch: 23, Steps: 34 | Train Loss: 5.258 Vali Loss: 69.264 Vali Acc: 0.763 Test Loss: 69.264 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 10.495857954025269
Epoch: 24, Steps: 34 | Train Loss: 7.013 Vali Loss: 108.952 Vali Acc: 0.688 Test Loss: 108.952 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 10.427024841308594
Epoch: 25, Steps: 34 | Train Loss: 2.796 Vali Loss: 99.424 Vali Acc: 0.699 Test Loss: 99.424 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 10.436590671539307
Epoch: 26, Steps: 34 | Train Loss: 2.940 Vali Loss: 80.582 Vali Acc: 0.751 Test Loss: 80.582 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 27244319
model size : 108.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.912008047103882
Epoch: 1, Steps: 34 | Train Loss: 53.641 Vali Loss: 65.521 Vali Acc: 0.329 Test Loss: 65.521 Test Acc: 0.329
Validation loss decreased (inf --> -0.328825).  Saving model ...
Epoch: 2 cost time: 7.9662065505981445
Epoch: 2, Steps: 34 | Train Loss: 88.154 Vali Loss: 56.970 Vali Acc: 0.410 Test Loss: 56.970 Test Acc: 0.410
Validation loss decreased (-0.328825 --> -0.409835).  Saving model ...
Epoch: 3 cost time: 8.932185888290405
Epoch: 3, Steps: 34 | Train Loss: 114.829 Vali Loss: 167.922 Vali Acc: 0.306 Test Loss: 167.922 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.03310227394104
Epoch: 4, Steps: 34 | Train Loss: 83.469 Vali Loss: 142.286 Vali Acc: 0.393 Test Loss: 142.286 Test Acc: 0.393
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.134874105453491
Epoch: 5, Steps: 34 | Train Loss: 70.608 Vali Loss: 44.493 Vali Acc: 0.642 Test Loss: 44.493 Test Acc: 0.642
Validation loss decreased (-0.409835 --> -0.641174).  Saving model ...
Epoch: 6 cost time: 8.379976511001587
Epoch: 6, Steps: 34 | Train Loss: 68.037 Vali Loss: 47.822 Vali Acc: 0.636 Test Loss: 47.822 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.116395711898804
Epoch: 7, Steps: 34 | Train Loss: 44.655 Vali Loss: 98.302 Vali Acc: 0.618 Test Loss: 98.302 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.905056715011597
Epoch: 8, Steps: 34 | Train Loss: 54.654 Vali Loss: 86.118 Vali Acc: 0.595 Test Loss: 86.118 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.08240818977356
Epoch: 9, Steps: 34 | Train Loss: 37.011 Vali Loss: 55.155 Vali Acc: 0.717 Test Loss: 55.155 Test Acc: 0.717
Validation loss decreased (-0.641174 --> -0.716211).  Saving model ...
Epoch: 10 cost time: 8.931206226348877
Epoch: 10, Steps: 34 | Train Loss: 32.399 Vali Loss: 27.595 Vali Acc: 0.809 Test Loss: 27.595 Test Acc: 0.809
Validation loss decreased (-0.716211 --> -0.808973).  Saving model ...
Epoch: 11 cost time: 9.124517440795898
Epoch: 11, Steps: 34 | Train Loss: 11.006 Vali Loss: 36.553 Vali Acc: 0.740 Test Loss: 36.553 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.202385187149048
Epoch: 12, Steps: 34 | Train Loss: 9.435 Vali Loss: 92.661 Vali Acc: 0.676 Test Loss: 92.661 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.960508346557617
Epoch: 13, Steps: 34 | Train Loss: 17.148 Vali Loss: 64.807 Vali Acc: 0.780 Test Loss: 64.807 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.420644760131836
Epoch: 14, Steps: 34 | Train Loss: 25.770 Vali Loss: 67.117 Vali Acc: 0.751 Test Loss: 67.117 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.005230903625488
Epoch: 15, Steps: 34 | Train Loss: 19.843 Vali Loss: 45.029 Vali Acc: 0.786 Test Loss: 45.029 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.869492530822754
Epoch: 16, Steps: 34 | Train Loss: 14.496 Vali Loss: 47.631 Vali Acc: 0.751 Test Loss: 47.631 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.70812702178955
Epoch: 17, Steps: 34 | Train Loss: 4.751 Vali Loss: 74.342 Vali Acc: 0.699 Test Loss: 74.342 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.200087070465088
Epoch: 18, Steps: 34 | Train Loss: 11.958 Vali Loss: 45.038 Vali Acc: 0.803 Test Loss: 45.038 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.07181167602539
Epoch: 19, Steps: 34 | Train Loss: 9.390 Vali Loss: 50.553 Vali Acc: 0.798 Test Loss: 50.553 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.138319730758667
Epoch: 20, Steps: 34 | Train Loss: 1.578 Vali Loss: 51.254 Vali Acc: 0.815 Test Loss: 51.254 Test Acc: 0.815
Validation loss decreased (-0.808973 --> -0.814516).  Saving model ...
Epoch: 21 cost time: 8.972202062606812
Epoch: 21, Steps: 34 | Train Loss: 4.379 Vali Loss: 49.549 Vali Acc: 0.775 Test Loss: 49.549 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.379333019256592
Epoch: 22, Steps: 34 | Train Loss: 24.990 Vali Loss: 116.810 Vali Acc: 0.630 Test Loss: 116.810 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.152958869934082
Epoch: 23, Steps: 34 | Train Loss: 4.576 Vali Loss: 129.265 Vali Acc: 0.601 Test Loss: 129.265 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.076945543289185
Epoch: 24, Steps: 34 | Train Loss: 11.662 Vali Loss: 104.052 Vali Acc: 0.751 Test Loss: 104.052 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.21131181716919
Epoch: 25, Steps: 34 | Train Loss: 7.737 Vali Loss: 81.726 Vali Acc: 0.786 Test Loss: 81.726 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.021674156188965
Epoch: 26, Steps: 34 | Train Loss: 10.600 Vali Loss: 70.217 Vali Acc: 0.769 Test Loss: 70.217 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.25541353225708
Epoch: 27, Steps: 34 | Train Loss: 4.469 Vali Loss: 76.512 Vali Acc: 0.757 Test Loss: 76.512 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.93377685546875
Epoch: 28, Steps: 34 | Train Loss: 9.950 Vali Loss: 71.575 Vali Acc: 0.786 Test Loss: 71.575 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.99251937866211
Epoch: 29, Steps: 34 | Train Loss: 2.969 Vali Loss: 76.094 Vali Acc: 0.728 Test Loss: 76.094 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.019645690917969
Epoch: 30, Steps: 34 | Train Loss: 4.493 Vali Loss: 41.963 Vali Acc: 0.838 Test Loss: 41.963 Test Acc: 0.838
Validation loss decreased (-0.814516 --> -0.837731).  Saving model ...
Epoch: 31 cost time: 11.040285587310791
Epoch: 31, Steps: 34 | Train Loss: 1.439 Vali Loss: 69.748 Vali Acc: 0.786 Test Loss: 69.748 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 10.34932017326355
Epoch: 32, Steps: 34 | Train Loss: 4.816 Vali Loss: 185.605 Vali Acc: 0.538 Test Loss: 185.605 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 10.063834190368652
Epoch: 33, Steps: 34 | Train Loss: 10.099 Vali Loss: 79.373 Vali Acc: 0.792 Test Loss: 79.373 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 10.373500347137451
Epoch: 34, Steps: 34 | Train Loss: 8.759 Vali Loss: 159.675 Vali Acc: 0.746 Test Loss: 159.675 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 9.811033964157104
Epoch: 35, Steps: 34 | Train Loss: 4.636 Vali Loss: 125.121 Vali Acc: 0.775 Test Loss: 125.121 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 8.647351264953613
Epoch: 36, Steps: 34 | Train Loss: 3.655 Vali Loss: 92.134 Vali Acc: 0.751 Test Loss: 92.134 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 9.172211408615112
Epoch: 37, Steps: 34 | Train Loss: 3.685 Vali Loss: 66.938 Vali Acc: 0.827 Test Loss: 66.938 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 8.998482704162598
Epoch: 38, Steps: 34 | Train Loss: 7.983 Vali Loss: 72.511 Vali Acc: 0.746 Test Loss: 72.511 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 9.253983974456787
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 39.434 Vali Acc: 0.861 Test Loss: 39.434 Test Acc: 0.861
Validation loss decreased (-0.837731 --> -0.860877).  Saving model ...
Epoch: 40 cost time: 8.882320404052734
Epoch: 40, Steps: 34 | Train Loss: 1.077 Vali Loss: 153.602 Vali Acc: 0.740 Test Loss: 153.602 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 8.911164999008179
Epoch: 41, Steps: 34 | Train Loss: 17.434 Vali Loss: 200.384 Vali Acc: 0.734 Test Loss: 200.384 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 9.364513158798218
Epoch: 42, Steps: 34 | Train Loss: 5.167 Vali Loss: 123.127 Vali Acc: 0.682 Test Loss: 123.127 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 9.16114354133606
Epoch: 43, Steps: 34 | Train Loss: 3.649 Vali Loss: 144.580 Vali Acc: 0.699 Test Loss: 144.580 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 8.78660273551941
Epoch: 44, Steps: 34 | Train Loss: 1.085 Vali Loss: 78.810 Vali Acc: 0.780 Test Loss: 78.810 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 8.945032596588135
Epoch: 45, Steps: 34 | Train Loss: 2.007 Vali Loss: 79.873 Vali Acc: 0.705 Test Loss: 79.873 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 9.078505516052246
Epoch: 46, Steps: 34 | Train Loss: 1.783 Vali Loss: 49.555 Vali Acc: 0.815 Test Loss: 49.555 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 8.968942403793335
Epoch: 47, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.634 Vali Acc: 0.809 Test Loss: 54.634 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 10.435718297958374
Epoch: 48, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.780 Vali Acc: 0.809 Test Loss: 54.780 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 10.322529554367065
Epoch: 49, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.784 Vali Acc: 0.809 Test Loss: 54.784 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 27241247
model size : 108.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.20828890800476
Epoch: 1, Steps: 34 | Train Loss: 53.446 Vali Loss: 113.570 Vali Acc: 0.301 Test Loss: 113.570 Test Acc: 0.301
Validation loss decreased (inf --> -0.299442).  Saving model ...
Epoch: 2 cost time: 8.911468982696533
Epoch: 2, Steps: 34 | Train Loss: 71.362 Vali Loss: 72.135 Vali Acc: 0.393 Test Loss: 72.135 Test Acc: 0.393
Validation loss decreased (-0.299442 --> -0.392342).  Saving model ...
Epoch: 3 cost time: 9.039412498474121
Epoch: 3, Steps: 34 | Train Loss: 58.628 Vali Loss: 67.181 Vali Acc: 0.457 Test Loss: 67.181 Test Acc: 0.457
Validation loss decreased (-0.392342 --> -0.455976).  Saving model ...
Epoch: 4 cost time: 8.807891845703125
Epoch: 4, Steps: 34 | Train Loss: 70.358 Vali Loss: 171.672 Vali Acc: 0.457 Test Loss: 171.672 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.96338701248169
Epoch: 5, Steps: 34 | Train Loss: 80.862 Vali Loss: 116.546 Vali Acc: 0.422 Test Loss: 116.546 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.869794845581055
Epoch: 6, Steps: 34 | Train Loss: 73.887 Vali Loss: 58.257 Vali Acc: 0.636 Test Loss: 58.257 Test Acc: 0.636
Validation loss decreased (-0.455976 --> -0.635256).  Saving model ...
Epoch: 7 cost time: 8.76562213897705
Epoch: 7, Steps: 34 | Train Loss: 59.232 Vali Loss: 43.538 Vali Acc: 0.647 Test Loss: 43.538 Test Acc: 0.647
Validation loss decreased (-0.635256 --> -0.646963).  Saving model ...
Epoch: 8 cost time: 8.7059006690979
Epoch: 8, Steps: 34 | Train Loss: 27.442 Vali Loss: 56.394 Vali Acc: 0.682 Test Loss: 56.394 Test Acc: 0.682
Validation loss decreased (-0.646963 --> -0.681517).  Saving model ...
Epoch: 9 cost time: 9.025859355926514
Epoch: 9, Steps: 34 | Train Loss: 57.588 Vali Loss: 49.036 Vali Acc: 0.740 Test Loss: 49.036 Test Acc: 0.740
Validation loss decreased (-0.681517 --> -0.739394).  Saving model ...
Epoch: 10 cost time: 8.875736951828003
Epoch: 10, Steps: 34 | Train Loss: 40.895 Vali Loss: 38.853 Vali Acc: 0.780 Test Loss: 38.853 Test Acc: 0.780
Validation loss decreased (-0.739394 --> -0.779958).  Saving model ...
Epoch: 11 cost time: 8.746232748031616
Epoch: 11, Steps: 34 | Train Loss: 29.400 Vali Loss: 87.138 Vali Acc: 0.653 Test Loss: 87.138 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.158658504486084
Epoch: 12, Steps: 34 | Train Loss: 38.549 Vali Loss: 110.427 Vali Acc: 0.723 Test Loss: 110.427 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.121928691864014
Epoch: 13, Steps: 34 | Train Loss: 47.641 Vali Loss: 78.130 Vali Acc: 0.613 Test Loss: 78.130 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.210399627685547
Epoch: 14, Steps: 34 | Train Loss: 20.667 Vali Loss: 60.927 Vali Acc: 0.711 Test Loss: 60.927 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.190780639648438
Epoch: 15, Steps: 34 | Train Loss: 15.182 Vali Loss: 32.768 Vali Acc: 0.821 Test Loss: 32.768 Test Acc: 0.821
Validation loss decreased (-0.779958 --> -0.820482).  Saving model ...
Epoch: 16 cost time: 10.743028402328491
Epoch: 16, Steps: 34 | Train Loss: 13.144 Vali Loss: 68.332 Vali Acc: 0.775 Test Loss: 68.332 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.63764214515686
Epoch: 17, Steps: 34 | Train Loss: 1.369 Vali Loss: 82.958 Vali Acc: 0.671 Test Loss: 82.958 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.352429628372192
Epoch: 18, Steps: 34 | Train Loss: 6.398 Vali Loss: 49.052 Vali Acc: 0.792 Test Loss: 49.052 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.723753452301025
Epoch: 19, Steps: 34 | Train Loss: 9.355 Vali Loss: 58.289 Vali Acc: 0.763 Test Loss: 58.289 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.061259984970093
Epoch: 20, Steps: 34 | Train Loss: 4.932 Vali Loss: 50.105 Vali Acc: 0.803 Test Loss: 50.105 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.9925377368927
Epoch: 21, Steps: 34 | Train Loss: 0.738 Vali Loss: 40.465 Vali Acc: 0.815 Test Loss: 40.465 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.773191452026367
Epoch: 22, Steps: 34 | Train Loss: 3.912 Vali Loss: 37.949 Vali Acc: 0.844 Test Loss: 37.949 Test Acc: 0.844
Validation loss decreased (-0.820482 --> -0.843551).  Saving model ...
Epoch: 23 cost time: 8.932617425918579
Epoch: 23, Steps: 34 | Train Loss: 2.271 Vali Loss: 42.726 Vali Acc: 0.769 Test Loss: 42.726 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.979032516479492
Epoch: 24, Steps: 34 | Train Loss: 1.877 Vali Loss: 28.551 Vali Acc: 0.838 Test Loss: 28.551 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.068754434585571
Epoch: 25, Steps: 34 | Train Loss: 1.899 Vali Loss: 36.570 Vali Acc: 0.792 Test Loss: 36.570 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.860356569290161
Epoch: 26, Steps: 34 | Train Loss: 2.544 Vali Loss: 50.740 Vali Acc: 0.780 Test Loss: 50.740 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.912600040435791
Epoch: 27, Steps: 34 | Train Loss: 2.451 Vali Loss: 129.647 Vali Acc: 0.642 Test Loss: 129.647 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.135233163833618
Epoch: 28, Steps: 34 | Train Loss: 26.805 Vali Loss: 23.248 Vali Acc: 0.827 Test Loss: 23.248 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.059491634368896
Epoch: 29, Steps: 34 | Train Loss: 13.352 Vali Loss: 48.812 Vali Acc: 0.815 Test Loss: 48.812 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 8.593168258666992
Epoch: 30, Steps: 34 | Train Loss: 10.120 Vali Loss: 223.807 Vali Acc: 0.607 Test Loss: 223.807 Test Acc: 0.607
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 10.436490774154663
Epoch: 31, Steps: 34 | Train Loss: 11.178 Vali Loss: 126.950 Vali Acc: 0.688 Test Loss: 126.950 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 10.548073291778564
Epoch: 32, Steps: 34 | Train Loss: 8.259 Vali Loss: 55.838 Vali Acc: 0.769 Test Loss: 55.838 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 27053471
model size : 108.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.12471628189087
Epoch: 1, Steps: 34 | Train Loss: 40.020 Vali Loss: 32.963 Vali Acc: 0.347 Test Loss: 32.963 Test Acc: 0.347
Validation loss decreased (inf --> -0.346491).  Saving model ...
Epoch: 2 cost time: 9.441849708557129
Epoch: 2, Steps: 34 | Train Loss: 66.750 Vali Loss: 130.813 Vali Acc: 0.468 Test Loss: 130.813 Test Acc: 0.468
Validation loss decreased (-0.346491 --> -0.466900).  Saving model ...
Epoch: 3 cost time: 9.038512229919434
Epoch: 3, Steps: 34 | Train Loss: 134.419 Vali Loss: 152.085 Vali Acc: 0.266 Test Loss: 152.085 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.101823091506958
Epoch: 4, Steps: 34 | Train Loss: 117.824 Vali Loss: 122.814 Vali Acc: 0.497 Test Loss: 122.814 Test Acc: 0.497
Validation loss decreased (-0.466900 --> -0.495882).  Saving model ...
Epoch: 5 cost time: 8.881451606750488
Epoch: 5, Steps: 34 | Train Loss: 69.101 Vali Loss: 252.173 Vali Acc: 0.474 Test Loss: 252.173 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.062785625457764
Epoch: 6, Steps: 34 | Train Loss: 79.504 Vali Loss: 79.156 Vali Acc: 0.555 Test Loss: 79.156 Test Acc: 0.555
Validation loss decreased (-0.495882 --> -0.554122).  Saving model ...
Epoch: 7 cost time: 8.823883771896362
Epoch: 7, Steps: 34 | Train Loss: 54.708 Vali Loss: 61.084 Vali Acc: 0.636 Test Loss: 61.084 Test Acc: 0.636
Validation loss decreased (-0.554122 --> -0.635227).  Saving model ...
Epoch: 8 cost time: 8.77019214630127
Epoch: 8, Steps: 34 | Train Loss: 75.713 Vali Loss: 44.779 Vali Acc: 0.746 Test Loss: 44.779 Test Acc: 0.746
Validation loss decreased (-0.635227 --> -0.745217).  Saving model ...
Epoch: 9 cost time: 8.88902473449707
Epoch: 9, Steps: 34 | Train Loss: 26.778 Vali Loss: 65.275 Vali Acc: 0.780 Test Loss: 65.275 Test Acc: 0.780
Validation loss decreased (-0.745217 --> -0.779694).  Saving model ...
Epoch: 10 cost time: 8.769785165786743
Epoch: 10, Steps: 34 | Train Loss: 19.750 Vali Loss: 195.545 Vali Acc: 0.416 Test Loss: 195.545 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.09804391860962
Epoch: 11, Steps: 34 | Train Loss: 21.016 Vali Loss: 66.218 Vali Acc: 0.728 Test Loss: 66.218 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.679260969161987
Epoch: 12, Steps: 34 | Train Loss: 38.990 Vali Loss: 46.259 Vali Acc: 0.734 Test Loss: 46.259 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.09375810623169
Epoch: 13, Steps: 34 | Train Loss: 6.900 Vali Loss: 40.776 Vali Acc: 0.757 Test Loss: 40.776 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.651428461074829
Epoch: 14, Steps: 34 | Train Loss: 11.470 Vali Loss: 183.530 Vali Acc: 0.555 Test Loss: 183.530 Test Acc: 0.555
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.51828384399414
Epoch: 15, Steps: 34 | Train Loss: 35.459 Vali Loss: 39.953 Vali Acc: 0.827 Test Loss: 39.953 Test Acc: 0.827
Validation loss decreased (-0.779694 --> -0.826190).  Saving model ...
Epoch: 16 cost time: 9.998454093933105
Epoch: 16, Steps: 34 | Train Loss: 51.135 Vali Loss: 152.338 Vali Acc: 0.618 Test Loss: 152.338 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.546313762664795
Epoch: 17, Steps: 34 | Train Loss: 29.029 Vali Loss: 120.483 Vali Acc: 0.699 Test Loss: 120.483 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.784709930419922
Epoch: 18, Steps: 34 | Train Loss: 18.491 Vali Loss: 43.102 Vali Acc: 0.815 Test Loss: 43.102 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.314555406570435
Epoch: 19, Steps: 34 | Train Loss: 13.698 Vali Loss: 89.030 Vali Acc: 0.705 Test Loss: 89.030 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.945342063903809
Epoch: 20, Steps: 34 | Train Loss: 9.723 Vali Loss: 55.574 Vali Acc: 0.803 Test Loss: 55.574 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.856995820999146
Epoch: 21, Steps: 34 | Train Loss: 4.817 Vali Loss: 79.518 Vali Acc: 0.711 Test Loss: 79.518 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.77641773223877
Epoch: 22, Steps: 34 | Train Loss: 4.941 Vali Loss: 63.795 Vali Acc: 0.775 Test Loss: 63.795 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.396567583084106
Epoch: 23, Steps: 34 | Train Loss: 6.134 Vali Loss: 79.872 Vali Acc: 0.751 Test Loss: 79.872 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.870213508605957
Epoch: 24, Steps: 34 | Train Loss: 5.420 Vali Loss: 194.648 Vali Acc: 0.647 Test Loss: 194.648 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.906347751617432
Epoch: 25, Steps: 34 | Train Loss: 10.853 Vali Loss: 47.826 Vali Acc: 0.786 Test Loss: 47.826 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 27050399
model size : 108.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.922268152236938
Epoch: 1, Steps: 34 | Train Loss: 39.015 Vali Loss: 86.093 Vali Acc: 0.272 Test Loss: 86.093 Test Acc: 0.272
Validation loss decreased (inf --> -0.270815).  Saving model ...
Epoch: 2 cost time: 8.819604635238647
Epoch: 2, Steps: 34 | Train Loss: 108.819 Vali Loss: 184.787 Vali Acc: 0.202 Test Loss: 184.787 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.700866937637329
Epoch: 3, Steps: 34 | Train Loss: 64.628 Vali Loss: 41.328 Vali Acc: 0.572 Test Loss: 41.328 Test Acc: 0.572
Validation loss decreased (-0.270815 --> -0.571841).  Saving model ...
Epoch: 4 cost time: 9.249699831008911
Epoch: 4, Steps: 34 | Train Loss: 59.875 Vali Loss: 121.257 Vali Acc: 0.566 Test Loss: 121.257 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.4089834690094
Epoch: 5, Steps: 34 | Train Loss: 69.761 Vali Loss: 111.435 Vali Acc: 0.468 Test Loss: 111.435 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.408288478851318
Epoch: 6, Steps: 34 | Train Loss: 47.933 Vali Loss: 156.214 Vali Acc: 0.526 Test Loss: 156.214 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.316358089447021
Epoch: 7, Steps: 34 | Train Loss: 58.278 Vali Loss: 60.344 Vali Acc: 0.584 Test Loss: 60.344 Test Acc: 0.584
Validation loss decreased (-0.571841 --> -0.583212).  Saving model ...
Epoch: 8 cost time: 9.820537567138672
Epoch: 8, Steps: 34 | Train Loss: 48.559 Vali Loss: 124.620 Vali Acc: 0.601 Test Loss: 124.620 Test Acc: 0.601
Validation loss decreased (-0.583212 --> -0.599910).  Saving model ...
Epoch: 9 cost time: 9.92922043800354
Epoch: 9, Steps: 34 | Train Loss: 45.144 Vali Loss: 62.194 Vali Acc: 0.665 Test Loss: 62.194 Test Acc: 0.665
Validation loss decreased (-0.599910 --> -0.664118).  Saving model ...
Epoch: 10 cost time: 8.877274513244629
Epoch: 10, Steps: 34 | Train Loss: 28.104 Vali Loss: 28.843 Vali Acc: 0.746 Test Loss: 28.843 Test Acc: 0.746
Validation loss decreased (-0.664118 --> -0.745376).  Saving model ...
Epoch: 11 cost time: 9.085051774978638
Epoch: 11, Steps: 34 | Train Loss: 32.835 Vali Loss: 46.869 Vali Acc: 0.751 Test Loss: 46.869 Test Acc: 0.751
Validation loss decreased (-0.745376 --> -0.750976).  Saving model ...
Epoch: 12 cost time: 9.166812181472778
Epoch: 12, Steps: 34 | Train Loss: 17.030 Vali Loss: 59.159 Vali Acc: 0.636 Test Loss: 59.159 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.028012037277222
Epoch: 13, Steps: 34 | Train Loss: 15.047 Vali Loss: 76.632 Vali Acc: 0.659 Test Loss: 76.632 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.09162449836731
Epoch: 14, Steps: 34 | Train Loss: 17.764 Vali Loss: 29.900 Vali Acc: 0.821 Test Loss: 29.900 Test Acc: 0.821
Validation loss decreased (-0.750976 --> -0.820510).  Saving model ...
Epoch: 15 cost time: 8.838717222213745
Epoch: 15, Steps: 34 | Train Loss: 17.526 Vali Loss: 40.200 Vali Acc: 0.723 Test Loss: 40.200 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.939382076263428
Epoch: 16, Steps: 34 | Train Loss: 4.976 Vali Loss: 19.170 Vali Acc: 0.827 Test Loss: 19.170 Test Acc: 0.827
Validation loss decreased (-0.820510 --> -0.826398).  Saving model ...
Epoch: 17 cost time: 9.026604890823364
Epoch: 17, Steps: 34 | Train Loss: 14.161 Vali Loss: 66.935 Vali Acc: 0.642 Test Loss: 66.935 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.257684230804443
Epoch: 18, Steps: 34 | Train Loss: 12.811 Vali Loss: 37.699 Vali Acc: 0.821 Test Loss: 37.699 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.132843971252441
Epoch: 19, Steps: 34 | Train Loss: 5.166 Vali Loss: 72.341 Vali Acc: 0.723 Test Loss: 72.341 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.888469219207764
Epoch: 20, Steps: 34 | Train Loss: 2.363 Vali Loss: 27.233 Vali Acc: 0.809 Test Loss: 27.233 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.319758653640747
Epoch: 21, Steps: 34 | Train Loss: 1.318 Vali Loss: 29.488 Vali Acc: 0.827 Test Loss: 29.488 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.093700885772705
Epoch: 22, Steps: 34 | Train Loss: 1.750 Vali Loss: 24.881 Vali Acc: 0.809 Test Loss: 24.881 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.579516410827637
Epoch: 23, Steps: 34 | Train Loss: 1.468 Vali Loss: 71.119 Vali Acc: 0.734 Test Loss: 71.119 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.560173034667969
Epoch: 24, Steps: 34 | Train Loss: 2.204 Vali Loss: 45.014 Vali Acc: 0.775 Test Loss: 45.014 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.080865621566772
Epoch: 25, Steps: 34 | Train Loss: 4.473 Vali Loss: 28.792 Vali Acc: 0.821 Test Loss: 28.792 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.34711480140686
Epoch: 26, Steps: 34 | Train Loss: 2.290 Vali Loss: 99.865 Vali Acc: 0.740 Test Loss: 99.865 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 27047327
model size : 108.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.85969066619873
Epoch: 1, Steps: 34 | Train Loss: 38.372 Vali Loss: 41.948 Vali Acc: 0.358 Test Loss: 41.948 Test Acc: 0.358
Validation loss decreased (inf --> -0.357962).  Saving model ...
Epoch: 2 cost time: 8.880785465240479
Epoch: 2, Steps: 34 | Train Loss: 57.813 Vali Loss: 36.940 Vali Acc: 0.480 Test Loss: 36.940 Test Acc: 0.480
Validation loss decreased (-0.357962 --> -0.479399).  Saving model ...
Epoch: 3 cost time: 9.112536191940308
Epoch: 3, Steps: 34 | Train Loss: 85.599 Vali Loss: 157.031 Vali Acc: 0.335 Test Loss: 157.031 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.027856349945068
Epoch: 4, Steps: 34 | Train Loss: 91.294 Vali Loss: 67.433 Vali Acc: 0.630 Test Loss: 67.433 Test Acc: 0.630
Validation loss decreased (-0.479399 --> -0.629383).  Saving model ...
Epoch: 5 cost time: 9.118416547775269
Epoch: 5, Steps: 34 | Train Loss: 131.133 Vali Loss: 250.331 Vali Acc: 0.422 Test Loss: 250.331 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.11168360710144
Epoch: 6, Steps: 34 | Train Loss: 87.255 Vali Loss: 173.974 Vali Acc: 0.520 Test Loss: 173.974 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.830320835113525
Epoch: 7, Steps: 34 | Train Loss: 78.801 Vali Loss: 140.265 Vali Acc: 0.526 Test Loss: 140.265 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.930829763412476
Epoch: 8, Steps: 34 | Train Loss: 48.087 Vali Loss: 86.406 Vali Acc: 0.578 Test Loss: 86.406 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.795360326766968
Epoch: 9, Steps: 34 | Train Loss: 42.302 Vali Loss: 78.237 Vali Acc: 0.717 Test Loss: 78.237 Test Acc: 0.717
Validation loss decreased (-0.629383 --> -0.715981).  Saving model ...
Epoch: 10 cost time: 9.029466152191162
Epoch: 10, Steps: 34 | Train Loss: 66.280 Vali Loss: 67.008 Vali Acc: 0.723 Test Loss: 67.008 Test Acc: 0.723
Validation loss decreased (-0.715981 --> -0.721873).  Saving model ...
Epoch: 11 cost time: 8.993040561676025
Epoch: 11, Steps: 34 | Train Loss: 37.659 Vali Loss: 112.803 Vali Acc: 0.572 Test Loss: 112.803 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.733283042907715
Epoch: 12, Steps: 34 | Train Loss: 22.892 Vali Loss: 114.861 Vali Acc: 0.555 Test Loss: 114.861 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.164683818817139
Epoch: 13, Steps: 34 | Train Loss: 17.006 Vali Loss: 73.528 Vali Acc: 0.769 Test Loss: 73.528 Test Acc: 0.769
Validation loss decreased (-0.721873 --> -0.768051).  Saving model ...
Epoch: 14 cost time: 10.447056770324707
Epoch: 14, Steps: 34 | Train Loss: 29.254 Vali Loss: 171.011 Vali Acc: 0.618 Test Loss: 171.011 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.33435869216919
Epoch: 15, Steps: 34 | Train Loss: 16.091 Vali Loss: 46.036 Vali Acc: 0.809 Test Loss: 46.036 Test Acc: 0.809
Validation loss decreased (-0.768051 --> -0.808788).  Saving model ...
Epoch: 16 cost time: 8.79168176651001
Epoch: 16, Steps: 34 | Train Loss: 7.605 Vali Loss: 78.100 Vali Acc: 0.734 Test Loss: 78.100 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.949361085891724
Epoch: 17, Steps: 34 | Train Loss: 5.239 Vali Loss: 61.959 Vali Acc: 0.780 Test Loss: 61.959 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.325308322906494
Epoch: 18, Steps: 34 | Train Loss: 11.653 Vali Loss: 259.390 Vali Acc: 0.543 Test Loss: 259.390 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.937201023101807
Epoch: 19, Steps: 34 | Train Loss: 20.064 Vali Loss: 78.844 Vali Acc: 0.780 Test Loss: 78.844 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.682853937149048
Epoch: 20, Steps: 34 | Train Loss: 4.737 Vali Loss: 48.223 Vali Acc: 0.821 Test Loss: 48.223 Test Acc: 0.821
Validation loss decreased (-0.808788 --> -0.820327).  Saving model ...
Epoch: 21 cost time: 9.218839406967163
Epoch: 21, Steps: 34 | Train Loss: 3.646 Vali Loss: 92.411 Vali Acc: 0.751 Test Loss: 92.411 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.930657386779785
Epoch: 22, Steps: 34 | Train Loss: 20.003 Vali Loss: 58.358 Vali Acc: 0.815 Test Loss: 58.358 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.137402772903442
Epoch: 23, Steps: 34 | Train Loss: 7.537 Vali Loss: 85.195 Vali Acc: 0.751 Test Loss: 85.195 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.808672428131104
Epoch: 24, Steps: 34 | Train Loss: 26.425 Vali Loss: 79.245 Vali Acc: 0.728 Test Loss: 79.245 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.965038537979126
Epoch: 25, Steps: 34 | Train Loss: 7.664 Vali Loss: 103.578 Vali Acc: 0.751 Test Loss: 103.578 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.076543092727661
Epoch: 26, Steps: 34 | Train Loss: 1.658 Vali Loss: 80.961 Vali Acc: 0.798 Test Loss: 80.961 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.016591787338257
Epoch: 27, Steps: 34 | Train Loss: 16.756 Vali Loss: 97.006 Vali Acc: 0.775 Test Loss: 97.006 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.534168243408203
Epoch: 28, Steps: 34 | Train Loss: 8.485 Vali Loss: 106.886 Vali Acc: 0.740 Test Loss: 106.886 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.60109829902649
Epoch: 29, Steps: 34 | Train Loss: 6.995 Vali Loss: 75.526 Vali Acc: 0.786 Test Loss: 75.526 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.927558898925781
Epoch: 30, Steps: 34 | Train Loss: 11.507 Vali Loss: 34.725 Vali Acc: 0.884 Test Loss: 34.725 Test Acc: 0.884
Validation loss decreased (-0.820327 --> -0.884046).  Saving model ...
Epoch: 31 cost time: 8.805782794952393
Epoch: 31, Steps: 34 | Train Loss: 0.870 Vali Loss: 68.025 Vali Acc: 0.809 Test Loss: 68.025 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 9.180498123168945
Epoch: 32, Steps: 34 | Train Loss: 3.460 Vali Loss: 64.352 Vali Acc: 0.821 Test Loss: 64.352 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 9.021512508392334
Epoch: 33, Steps: 34 | Train Loss: 0.328 Vali Loss: 160.839 Vali Acc: 0.751 Test Loss: 160.839 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 9.119450092315674
Epoch: 34, Steps: 34 | Train Loss: 9.090 Vali Loss: 35.583 Vali Acc: 0.850 Test Loss: 35.583 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 8.822713613510132
Epoch: 35, Steps: 34 | Train Loss: 3.118 Vali Loss: 200.085 Vali Acc: 0.595 Test Loss: 200.085 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 8.959516286849976
Epoch: 36, Steps: 34 | Train Loss: 13.908 Vali Loss: 47.826 Vali Acc: 0.844 Test Loss: 47.826 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 8.852153778076172
Epoch: 37, Steps: 34 | Train Loss: 4.511 Vali Loss: 60.774 Vali Acc: 0.832 Test Loss: 60.774 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 8.561797380447388
Epoch: 38, Steps: 34 | Train Loss: 1.056 Vali Loss: 36.005 Vali Acc: 0.855 Test Loss: 36.005 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 9.202407121658325
Epoch: 39, Steps: 34 | Train Loss: 4.539 Vali Loss: 70.992 Vali Acc: 0.780 Test Loss: 70.992 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 8.914160251617432
Epoch: 40, Steps: 34 | Train Loss: 4.874 Vali Loss: 58.901 Vali Acc: 0.803 Test Loss: 58.901 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 27044255
model size : 108.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.010037660598755
Epoch: 1, Steps: 34 | Train Loss: 19.703 Vali Loss: 46.500 Vali Acc: 0.266 Test Loss: 46.500 Test Acc: 0.266
Validation loss decreased (inf --> -0.265431).  Saving model ...
Epoch: 2 cost time: 7.044474124908447
Epoch: 2, Steps: 34 | Train Loss: 55.594 Vali Loss: 43.251 Vali Acc: 0.324 Test Loss: 43.251 Test Acc: 0.324
Validation loss decreased (-0.265431 --> -0.323267).  Saving model ...
Epoch: 3 cost time: 7.354341506958008
Epoch: 3, Steps: 34 | Train Loss: 39.456 Vali Loss: 44.569 Vali Acc: 0.601 Test Loss: 44.569 Test Acc: 0.601
Validation loss decreased (-0.323267 --> -0.600710).  Saving model ...
Epoch: 4 cost time: 7.061365842819214
Epoch: 4, Steps: 34 | Train Loss: 38.849 Vali Loss: 53.462 Vali Acc: 0.509 Test Loss: 53.462 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.6565752029418945
Epoch: 5, Steps: 34 | Train Loss: 21.620 Vali Loss: 44.830 Vali Acc: 0.595 Test Loss: 44.830 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.848302125930786
Epoch: 6, Steps: 34 | Train Loss: 23.482 Vali Loss: 22.753 Vali Acc: 0.532 Test Loss: 22.753 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.339212656021118
Epoch: 7, Steps: 34 | Train Loss: 15.183 Vali Loss: 31.471 Vali Acc: 0.578 Test Loss: 31.471 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.234880685806274
Epoch: 8, Steps: 34 | Train Loss: 22.241 Vali Loss: 35.961 Vali Acc: 0.734 Test Loss: 35.961 Test Acc: 0.734
Validation loss decreased (-0.600710 --> -0.733744).  Saving model ...
Epoch: 9 cost time: 7.017934799194336
Epoch: 9, Steps: 34 | Train Loss: 18.834 Vali Loss: 35.161 Vali Acc: 0.699 Test Loss: 35.161 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.127664089202881
Epoch: 10, Steps: 34 | Train Loss: 15.241 Vali Loss: 126.810 Vali Acc: 0.358 Test Loss: 126.810 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.543626546859741
Epoch: 11, Steps: 34 | Train Loss: 10.348 Vali Loss: 22.270 Vali Acc: 0.757 Test Loss: 22.270 Test Acc: 0.757
Validation loss decreased (-0.733744 --> -0.757003).  Saving model ...
Epoch: 12 cost time: 7.144038438796997
Epoch: 12, Steps: 34 | Train Loss: 5.710 Vali Loss: 26.293 Vali Acc: 0.775 Test Loss: 26.293 Test Acc: 0.775
Validation loss decreased (-0.757003 --> -0.774304).  Saving model ...
Epoch: 13 cost time: 7.0161826610565186
Epoch: 13, Steps: 34 | Train Loss: 7.038 Vali Loss: 34.008 Vali Acc: 0.798 Test Loss: 34.008 Test Acc: 0.798
Validation loss decreased (-0.774304 --> -0.797348).  Saving model ...
Epoch: 14 cost time: 7.143338203430176
Epoch: 14, Steps: 34 | Train Loss: 4.873 Vali Loss: 40.060 Vali Acc: 0.647 Test Loss: 40.060 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.043031692504883
Epoch: 15, Steps: 34 | Train Loss: 8.874 Vali Loss: 94.404 Vali Acc: 0.561 Test Loss: 94.404 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.818929195404053
Epoch: 16, Steps: 34 | Train Loss: 11.024 Vali Loss: 30.004 Vali Acc: 0.780 Test Loss: 30.004 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.3239545822143555
Epoch: 17, Steps: 34 | Train Loss: 12.102 Vali Loss: 40.780 Vali Acc: 0.746 Test Loss: 40.780 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.229206800460815
Epoch: 18, Steps: 34 | Train Loss: 7.037 Vali Loss: 64.070 Vali Acc: 0.734 Test Loss: 64.070 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.163758993148804
Epoch: 19, Steps: 34 | Train Loss: 4.912 Vali Loss: 15.988 Vali Acc: 0.855 Test Loss: 15.988 Test Acc: 0.855
Validation loss decreased (-0.797348 --> -0.855331).  Saving model ...
Epoch: 20 cost time: 7.120343446731567
Epoch: 20, Steps: 34 | Train Loss: 2.445 Vali Loss: 22.600 Vali Acc: 0.792 Test Loss: 22.600 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.6413960456848145
Epoch: 21, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.961 Vali Acc: 0.757 Test Loss: 33.961 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.295765161514282
Epoch: 22, Steps: 34 | Train Loss: 1.741 Vali Loss: 20.957 Vali Acc: 0.769 Test Loss: 20.957 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.093639373779297
Epoch: 23, Steps: 34 | Train Loss: 2.662 Vali Loss: 53.037 Vali Acc: 0.775 Test Loss: 53.037 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.1216347217559814
Epoch: 24, Steps: 34 | Train Loss: 1.381 Vali Loss: 48.702 Vali Acc: 0.751 Test Loss: 48.702 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.055016279220581
Epoch: 25, Steps: 34 | Train Loss: 6.257 Vali Loss: 25.600 Vali Acc: 0.821 Test Loss: 25.600 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.860590696334839
Epoch: 26, Steps: 34 | Train Loss: 4.315 Vali Loss: 49.505 Vali Acc: 0.775 Test Loss: 49.505 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.329135417938232
Epoch: 27, Steps: 34 | Train Loss: 0.774 Vali Loss: 37.440 Vali Acc: 0.769 Test Loss: 37.440 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.676509380340576
Epoch: 28, Steps: 34 | Train Loss: 4.231 Vali Loss: 18.588 Vali Acc: 0.855 Test Loss: 18.588 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.920004844665527
Epoch: 29, Steps: 34 | Train Loss: 1.387 Vali Loss: 96.590 Vali Acc: 0.734 Test Loss: 96.590 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 13431327
model size : 53.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.199500799179077
Epoch: 1, Steps: 34 | Train Loss: 18.129 Vali Loss: 15.106 Vali Acc: 0.358 Test Loss: 15.106 Test Acc: 0.358
Validation loss decreased (inf --> -0.358230).  Saving model ...
Epoch: 2 cost time: 6.784342050552368
Epoch: 2, Steps: 34 | Train Loss: 52.209 Vali Loss: 81.317 Vali Acc: 0.312 Test Loss: 81.317 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.058269262313843
Epoch: 3, Steps: 34 | Train Loss: 53.869 Vali Loss: 58.526 Vali Acc: 0.445 Test Loss: 58.526 Test Acc: 0.445
Validation loss decreased (-0.358230 --> -0.444501).  Saving model ...
Epoch: 4 cost time: 7.032953977584839
Epoch: 4, Steps: 34 | Train Loss: 66.388 Vali Loss: 67.722 Vali Acc: 0.353 Test Loss: 67.722 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.935119152069092
Epoch: 5, Steps: 34 | Train Loss: 49.207 Vali Loss: 57.040 Vali Acc: 0.486 Test Loss: 57.040 Test Acc: 0.486
Validation loss decreased (-0.444501 --> -0.484979).  Saving model ...
Epoch: 6 cost time: 7.0536346435546875
Epoch: 6, Steps: 34 | Train Loss: 26.602 Vali Loss: 59.808 Vali Acc: 0.549 Test Loss: 59.808 Test Acc: 0.549
Validation loss decreased (-0.484979 --> -0.548535).  Saving model ...
Epoch: 7 cost time: 6.800071716308594
Epoch: 7, Steps: 34 | Train Loss: 45.344 Vali Loss: 110.581 Vali Acc: 0.439 Test Loss: 110.581 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.869879245758057
Epoch: 8, Steps: 34 | Train Loss: 21.209 Vali Loss: 53.567 Vali Acc: 0.595 Test Loss: 53.567 Test Acc: 0.595
Validation loss decreased (-0.548535 --> -0.594840).  Saving model ...
Epoch: 9 cost time: 6.815598011016846
Epoch: 9, Steps: 34 | Train Loss: 14.608 Vali Loss: 51.908 Vali Acc: 0.578 Test Loss: 51.908 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.982676982879639
Epoch: 10, Steps: 34 | Train Loss: 9.877 Vali Loss: 20.018 Vali Acc: 0.798 Test Loss: 20.018 Test Acc: 0.798
Validation loss decreased (-0.594840 --> -0.797488).  Saving model ...
Epoch: 11 cost time: 6.750466346740723
Epoch: 11, Steps: 34 | Train Loss: 6.792 Vali Loss: 53.379 Vali Acc: 0.717 Test Loss: 53.379 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.279985427856445
Epoch: 12, Steps: 34 | Train Loss: 13.819 Vali Loss: 41.341 Vali Acc: 0.699 Test Loss: 41.341 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.126485586166382
Epoch: 13, Steps: 34 | Train Loss: 10.518 Vali Loss: 40.712 Vali Acc: 0.636 Test Loss: 40.712 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.884613037109375
Epoch: 14, Steps: 34 | Train Loss: 5.711 Vali Loss: 28.701 Vali Acc: 0.763 Test Loss: 28.701 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.084329843521118
Epoch: 15, Steps: 34 | Train Loss: 7.960 Vali Loss: 28.713 Vali Acc: 0.746 Test Loss: 28.713 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.306843042373657
Epoch: 16, Steps: 34 | Train Loss: 1.647 Vali Loss: 51.613 Vali Acc: 0.723 Test Loss: 51.613 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.828356504440308
Epoch: 17, Steps: 34 | Train Loss: 4.914 Vali Loss: 31.693 Vali Acc: 0.786 Test Loss: 31.693 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.04398512840271
Epoch: 18, Steps: 34 | Train Loss: 3.665 Vali Loss: 39.139 Vali Acc: 0.775 Test Loss: 39.139 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.132195711135864
Epoch: 19, Steps: 34 | Train Loss: 0.781 Vali Loss: 33.177 Vali Acc: 0.803 Test Loss: 33.177 Test Acc: 0.803
Validation loss decreased (-0.797488 --> -0.803136).  Saving model ...
Epoch: 20 cost time: 7.236434459686279
Epoch: 20, Steps: 34 | Train Loss: 1.089 Vali Loss: 61.458 Vali Acc: 0.734 Test Loss: 61.458 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.98231315612793
Epoch: 21, Steps: 34 | Train Loss: 4.431 Vali Loss: 120.746 Vali Acc: 0.566 Test Loss: 120.746 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.996990442276001
Epoch: 22, Steps: 34 | Train Loss: 7.148 Vali Loss: 37.776 Vali Acc: 0.792 Test Loss: 37.776 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.112586498260498
Epoch: 23, Steps: 34 | Train Loss: 2.492 Vali Loss: 30.076 Vali Acc: 0.809 Test Loss: 30.076 Test Acc: 0.809
Validation loss decreased (-0.803136 --> -0.808948).  Saving model ...
Epoch: 24 cost time: 7.200611114501953
Epoch: 24, Steps: 34 | Train Loss: 5.215 Vali Loss: 43.496 Vali Acc: 0.763 Test Loss: 43.496 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.291320085525513
Epoch: 25, Steps: 34 | Train Loss: 3.569 Vali Loss: 24.378 Vali Acc: 0.775 Test Loss: 24.378 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.788667917251587
Epoch: 26, Steps: 34 | Train Loss: 3.398 Vali Loss: 46.133 Vali Acc: 0.746 Test Loss: 46.133 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.870428085327148
Epoch: 27, Steps: 34 | Train Loss: 1.711 Vali Loss: 47.878 Vali Acc: 0.711 Test Loss: 47.878 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.832028150558472
Epoch: 28, Steps: 34 | Train Loss: 2.958 Vali Loss: 65.731 Vali Acc: 0.740 Test Loss: 65.731 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.761162757873535
Epoch: 29, Steps: 34 | Train Loss: 2.537 Vali Loss: 47.013 Vali Acc: 0.763 Test Loss: 47.013 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.783204078674316
Epoch: 30, Steps: 34 | Train Loss: 1.071 Vali Loss: 33.248 Vali Acc: 0.832 Test Loss: 33.248 Test Acc: 0.832
Validation loss decreased (-0.808948 --> -0.832037).  Saving model ...
Epoch: 31 cost time: 6.932650327682495
Epoch: 31, Steps: 34 | Train Loss: 0.329 Vali Loss: 49.118 Vali Acc: 0.780 Test Loss: 49.118 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.6957106590271
Epoch: 32, Steps: 34 | Train Loss: 1.234 Vali Loss: 50.286 Vali Acc: 0.769 Test Loss: 50.286 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.020399808883667
Epoch: 33, Steps: 34 | Train Loss: 2.007 Vali Loss: 91.383 Vali Acc: 0.688 Test Loss: 91.383 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 7.419238090515137
Epoch: 34, Steps: 34 | Train Loss: 9.771 Vali Loss: 51.331 Vali Acc: 0.792 Test Loss: 51.331 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 7.218529224395752
Epoch: 35, Steps: 34 | Train Loss: 4.672 Vali Loss: 34.271 Vali Acc: 0.821 Test Loss: 34.271 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.741460084915161
Epoch: 36, Steps: 34 | Train Loss: 2.518 Vali Loss: 32.205 Vali Acc: 0.879 Test Loss: 32.205 Test Acc: 0.879
Validation loss decreased (-0.832037 --> -0.878291).  Saving model ...
Epoch: 37 cost time: 6.769587278366089
Epoch: 37, Steps: 34 | Train Loss: 4.120 Vali Loss: 32.369 Vali Acc: 0.786 Test Loss: 32.369 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.835638761520386
Epoch: 38, Steps: 34 | Train Loss: 1.023 Vali Loss: 49.223 Vali Acc: 0.717 Test Loss: 49.223 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 7.2172815799713135
Epoch: 39, Steps: 34 | Train Loss: 2.968 Vali Loss: 36.866 Vali Acc: 0.769 Test Loss: 36.866 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.678771734237671
Epoch: 40, Steps: 34 | Train Loss: 2.419 Vali Loss: 53.807 Vali Acc: 0.775 Test Loss: 53.807 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 7.044098854064941
Epoch: 41, Steps: 34 | Train Loss: 0.289 Vali Loss: 67.958 Vali Acc: 0.763 Test Loss: 67.958 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.84376859664917
Epoch: 42, Steps: 34 | Train Loss: 0.789 Vali Loss: 58.560 Vali Acc: 0.740 Test Loss: 58.560 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 7.0838236808776855
Epoch: 43, Steps: 34 | Train Loss: 2.772 Vali Loss: 101.238 Vali Acc: 0.740 Test Loss: 101.238 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.717379331588745
Epoch: 44, Steps: 34 | Train Loss: 4.965 Vali Loss: 85.719 Vali Acc: 0.723 Test Loss: 85.719 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 6.987589597702026
Epoch: 45, Steps: 34 | Train Loss: 0.713 Vali Loss: 96.339 Vali Acc: 0.734 Test Loss: 96.339 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 7.149521827697754
Epoch: 46, Steps: 34 | Train Loss: 0.927 Vali Loss: 62.756 Vali Acc: 0.763 Test Loss: 62.756 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 13429791
model size : 53.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.498451232910156
Epoch: 1, Steps: 34 | Train Loss: 26.165 Vali Loss: 36.095 Vali Acc: 0.295 Test Loss: 36.095 Test Acc: 0.295
Validation loss decreased (inf --> -0.294437).  Saving model ...
Epoch: 2 cost time: 6.914602518081665
Epoch: 2, Steps: 34 | Train Loss: 41.532 Vali Loss: 51.202 Vali Acc: 0.434 Test Loss: 51.202 Test Acc: 0.434
Validation loss decreased (-0.294437 --> -0.433014).  Saving model ...
Epoch: 3 cost time: 6.8813512325286865
Epoch: 3, Steps: 34 | Train Loss: 53.245 Vali Loss: 51.171 Vali Acc: 0.422 Test Loss: 51.171 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.247947454452515
Epoch: 4, Steps: 34 | Train Loss: 45.254 Vali Loss: 65.530 Vali Acc: 0.549 Test Loss: 65.530 Test Acc: 0.549
Validation loss decreased (-0.433014 --> -0.548478).  Saving model ...
Epoch: 5 cost time: 7.249626159667969
Epoch: 5, Steps: 34 | Train Loss: 56.612 Vali Loss: 67.751 Vali Acc: 0.526 Test Loss: 67.751 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.938874959945679
Epoch: 6, Steps: 34 | Train Loss: 28.162 Vali Loss: 23.271 Vali Acc: 0.694 Test Loss: 23.271 Test Acc: 0.694
Validation loss decreased (-0.548478 --> -0.693409).  Saving model ...
Epoch: 7 cost time: 6.902064561843872
Epoch: 7, Steps: 34 | Train Loss: 25.764 Vali Loss: 32.151 Vali Acc: 0.676 Test Loss: 32.151 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.15330958366394
Epoch: 8, Steps: 34 | Train Loss: 15.342 Vali Loss: 48.797 Vali Acc: 0.509 Test Loss: 48.797 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.852576971054077
Epoch: 9, Steps: 34 | Train Loss: 37.719 Vali Loss: 34.920 Vali Acc: 0.671 Test Loss: 34.920 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.811047077178955
Epoch: 10, Steps: 34 | Train Loss: 9.094 Vali Loss: 42.806 Vali Acc: 0.751 Test Loss: 42.806 Test Acc: 0.751
Validation loss decreased (-0.693409 --> -0.751017).  Saving model ...
Epoch: 11 cost time: 6.92331337928772
Epoch: 11, Steps: 34 | Train Loss: 8.637 Vali Loss: 71.748 Vali Acc: 0.543 Test Loss: 71.748 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.8771703243255615
Epoch: 12, Steps: 34 | Train Loss: 18.744 Vali Loss: 29.518 Vali Acc: 0.769 Test Loss: 29.518 Test Acc: 0.769
Validation loss decreased (-0.751017 --> -0.768491).  Saving model ...
Epoch: 13 cost time: 6.868590831756592
Epoch: 13, Steps: 34 | Train Loss: 5.330 Vali Loss: 52.119 Vali Acc: 0.659 Test Loss: 52.119 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.889298915863037
Epoch: 14, Steps: 34 | Train Loss: 4.583 Vali Loss: 49.977 Vali Acc: 0.676 Test Loss: 49.977 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.853911638259888
Epoch: 15, Steps: 34 | Train Loss: 6.076 Vali Loss: 94.880 Vali Acc: 0.630 Test Loss: 94.880 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.298077583312988
Epoch: 16, Steps: 34 | Train Loss: 13.713 Vali Loss: 49.218 Vali Acc: 0.682 Test Loss: 49.218 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.878926038742065
Epoch: 17, Steps: 34 | Train Loss: 11.271 Vali Loss: 57.658 Vali Acc: 0.734 Test Loss: 57.658 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.6315271854400635
Epoch: 18, Steps: 34 | Train Loss: 3.411 Vali Loss: 22.571 Vali Acc: 0.792 Test Loss: 22.571 Test Acc: 0.792
Validation loss decreased (-0.768491 --> -0.791682).  Saving model ...
Epoch: 19 cost time: 6.8311028480529785
Epoch: 19, Steps: 34 | Train Loss: 2.423 Vali Loss: 69.581 Vali Acc: 0.682 Test Loss: 69.581 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.183351039886475
Epoch: 20, Steps: 34 | Train Loss: 5.466 Vali Loss: 35.767 Vali Acc: 0.780 Test Loss: 35.767 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.4233009815216064
Epoch: 21, Steps: 34 | Train Loss: 4.571 Vali Loss: 42.868 Vali Acc: 0.746 Test Loss: 42.868 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.901311635971069
Epoch: 22, Steps: 34 | Train Loss: 6.482 Vali Loss: 32.717 Vali Acc: 0.780 Test Loss: 32.717 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.050122976303101
Epoch: 23, Steps: 34 | Train Loss: 10.484 Vali Loss: 43.126 Vali Acc: 0.780 Test Loss: 43.126 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.016602993011475
Epoch: 24, Steps: 34 | Train Loss: 3.069 Vali Loss: 71.716 Vali Acc: 0.746 Test Loss: 71.716 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.022751331329346
Epoch: 25, Steps: 34 | Train Loss: 3.716 Vali Loss: 85.328 Vali Acc: 0.671 Test Loss: 85.328 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.781479120254517
Epoch: 26, Steps: 34 | Train Loss: 0.134 Vali Loss: 63.759 Vali Acc: 0.763 Test Loss: 63.759 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.269178152084351
Epoch: 27, Steps: 34 | Train Loss: 0.755 Vali Loss: 35.156 Vali Acc: 0.815 Test Loss: 35.156 Test Acc: 0.815
Validation loss decreased (-0.791682 --> -0.814677).  Saving model ...
Epoch: 28 cost time: 6.729159832000732
Epoch: 28, Steps: 34 | Train Loss: 1.921 Vali Loss: 15.613 Vali Acc: 0.838 Test Loss: 15.613 Test Acc: 0.838
Validation loss decreased (-0.814677 --> -0.837994).  Saving model ...
Epoch: 29 cost time: 6.598080158233643
Epoch: 29, Steps: 34 | Train Loss: 0.810 Vali Loss: 18.772 Vali Acc: 0.827 Test Loss: 18.772 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.56274938583374
Epoch: 30, Steps: 34 | Train Loss: 1.100 Vali Loss: 51.760 Vali Acc: 0.751 Test Loss: 51.760 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 7.0103583335876465
Epoch: 31, Steps: 34 | Train Loss: 1.637 Vali Loss: 47.252 Vali Acc: 0.769 Test Loss: 47.252 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 7.054523706436157
Epoch: 32, Steps: 34 | Train Loss: 1.912 Vali Loss: 95.142 Vali Acc: 0.711 Test Loss: 95.142 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 7.025444030761719
Epoch: 33, Steps: 34 | Train Loss: 3.932 Vali Loss: 44.272 Vali Acc: 0.792 Test Loss: 44.272 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 7.353610277175903
Epoch: 34, Steps: 34 | Train Loss: 1.683 Vali Loss: 43.900 Vali Acc: 0.786 Test Loss: 43.900 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 7.405717134475708
Epoch: 35, Steps: 34 | Train Loss: 1.298 Vali Loss: 46.843 Vali Acc: 0.763 Test Loss: 46.843 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 7.058897018432617
Epoch: 36, Steps: 34 | Train Loss: 0.839 Vali Loss: 35.691 Vali Acc: 0.815 Test Loss: 35.691 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 6.8615007400512695
Epoch: 37, Steps: 34 | Train Loss: 0.395 Vali Loss: 69.802 Vali Acc: 0.780 Test Loss: 69.802 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 7.487468481063843
Epoch: 38, Steps: 34 | Train Loss: 2.458 Vali Loss: 26.966 Vali Acc: 0.850 Test Loss: 26.966 Test Acc: 0.850
Validation loss decreased (-0.837994 --> -0.849441).  Saving model ...
Epoch: 39 cost time: 6.980313539505005
Epoch: 39, Steps: 34 | Train Loss: 2.565 Vali Loss: 56.362 Vali Acc: 0.775 Test Loss: 56.362 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.818710565567017
Epoch: 40, Steps: 34 | Train Loss: 7.820 Vali Loss: 73.586 Vali Acc: 0.798 Test Loss: 73.586 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 7.3919453620910645
Epoch: 41, Steps: 34 | Train Loss: 1.795 Vali Loss: 43.355 Vali Acc: 0.809 Test Loss: 43.355 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 7.226882457733154
Epoch: 42, Steps: 34 | Train Loss: 4.242 Vali Loss: 37.225 Vali Acc: 0.792 Test Loss: 37.225 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 7.312819957733154
Epoch: 43, Steps: 34 | Train Loss: 1.362 Vali Loss: 72.095 Vali Acc: 0.728 Test Loss: 72.095 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 7.051969051361084
Epoch: 44, Steps: 34 | Train Loss: 1.158 Vali Loss: 64.944 Vali Acc: 0.769 Test Loss: 64.944 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 6.949132442474365
Epoch: 45, Steps: 34 | Train Loss: 2.018 Vali Loss: 22.562 Vali Acc: 0.855 Test Loss: 22.562 Test Acc: 0.855
Validation loss decreased (-0.849441 --> -0.855266).  Saving model ...
Epoch: 46 cost time: 7.282175064086914
Epoch: 46, Steps: 34 | Train Loss: 0.448 Vali Loss: 30.529 Vali Acc: 0.803 Test Loss: 30.529 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.789803504943848
Epoch: 47, Steps: 34 | Train Loss: 1.299 Vali Loss: 34.032 Vali Acc: 0.827 Test Loss: 34.032 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 7.192456483840942
Epoch: 48, Steps: 34 | Train Loss: 1.186 Vali Loss: 58.861 Vali Acc: 0.769 Test Loss: 58.861 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 7.040053844451904
Epoch: 49, Steps: 34 | Train Loss: 0.187 Vali Loss: 53.936 Vali Acc: 0.792 Test Loss: 53.936 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 6.921778202056885
Epoch: 50, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.863 Vali Acc: 0.798 Test Loss: 54.863 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 6.6460583209991455
Epoch: 51, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.890 Vali Acc: 0.798 Test Loss: 54.890 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 6.991043329238892
Epoch: 52, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.891 Vali Acc: 0.798 Test Loss: 54.891 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 7.163613796234131
Epoch: 53, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.891 Vali Acc: 0.798 Test Loss: 54.891 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 7.046128273010254
Epoch: 54, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.891 Vali Acc: 0.798 Test Loss: 54.891 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 6.987047910690308
Epoch: 55, Steps: 34 | Train Loss: 0.000 Vali Loss: 54.891 Vali Acc: 0.798 Test Loss: 54.891 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 13428255
model size : 53.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.12729001045227
Epoch: 1, Steps: 34 | Train Loss: 22.376 Vali Loss: 16.897 Vali Acc: 0.237 Test Loss: 16.897 Test Acc: 0.237
Validation loss decreased (inf --> -0.236825).  Saving model ...
Epoch: 2 cost time: 6.49819803237915
Epoch: 2, Steps: 34 | Train Loss: 29.065 Vali Loss: 51.149 Vali Acc: 0.445 Test Loss: 51.149 Test Acc: 0.445
Validation loss decreased (-0.236825 --> -0.444575).  Saving model ...
Epoch: 3 cost time: 6.712704658508301
Epoch: 3, Steps: 34 | Train Loss: 52.850 Vali Loss: 46.682 Vali Acc: 0.532 Test Loss: 46.682 Test Acc: 0.532
Validation loss decreased (-0.444575 --> -0.531325).  Saving model ...
Epoch: 4 cost time: 7.022238731384277
Epoch: 4, Steps: 34 | Train Loss: 40.906 Vali Loss: 68.871 Vali Acc: 0.526 Test Loss: 68.871 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.350374698638916
Epoch: 5, Steps: 34 | Train Loss: 33.081 Vali Loss: 87.661 Vali Acc: 0.353 Test Loss: 87.661 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.0799760818481445
Epoch: 6, Steps: 34 | Train Loss: 26.870 Vali Loss: 29.277 Vali Acc: 0.642 Test Loss: 29.277 Test Acc: 0.642
Validation loss decreased (-0.531325 --> -0.641326).  Saving model ...
Epoch: 7 cost time: 7.051421403884888
Epoch: 7, Steps: 34 | Train Loss: 23.391 Vali Loss: 12.189 Vali Acc: 0.792 Test Loss: 12.189 Test Acc: 0.792
Validation loss decreased (-0.641326 --> -0.791786).  Saving model ...
Epoch: 8 cost time: 6.741515159606934
Epoch: 8, Steps: 34 | Train Loss: 10.551 Vali Loss: 36.782 Vali Acc: 0.613 Test Loss: 36.782 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.07714056968689
Epoch: 9, Steps: 34 | Train Loss: 15.766 Vali Loss: 58.684 Vali Acc: 0.659 Test Loss: 58.684 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.03011155128479
Epoch: 10, Steps: 34 | Train Loss: 21.498 Vali Loss: 20.848 Vali Acc: 0.757 Test Loss: 20.848 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.102877855300903
Epoch: 11, Steps: 34 | Train Loss: 10.974 Vali Loss: 64.790 Vali Acc: 0.561 Test Loss: 64.790 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.138806104660034
Epoch: 12, Steps: 34 | Train Loss: 6.406 Vali Loss: 59.501 Vali Acc: 0.682 Test Loss: 59.501 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.012399911880493
Epoch: 13, Steps: 34 | Train Loss: 5.747 Vali Loss: 36.840 Vali Acc: 0.728 Test Loss: 36.840 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.321537733078003
Epoch: 14, Steps: 34 | Train Loss: 3.212 Vali Loss: 55.430 Vali Acc: 0.717 Test Loss: 55.430 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.181672096252441
Epoch: 15, Steps: 34 | Train Loss: 5.786 Vali Loss: 49.977 Vali Acc: 0.618 Test Loss: 49.977 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.09832763671875
Epoch: 16, Steps: 34 | Train Loss: 6.441 Vali Loss: 39.497 Vali Acc: 0.723 Test Loss: 39.497 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.012192726135254
Epoch: 17, Steps: 34 | Train Loss: 10.900 Vali Loss: 61.625 Vali Acc: 0.607 Test Loss: 61.625 Test Acc: 0.607
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 13426719
model size : 53.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.23990511894226
Epoch: 1, Steps: 34 | Train Loss: 28.125 Vali Loss: 46.276 Vali Acc: 0.225 Test Loss: 46.276 Test Acc: 0.225
Validation loss decreased (inf --> -0.224971).  Saving model ...
Epoch: 2 cost time: 6.70580267906189
Epoch: 2, Steps: 34 | Train Loss: 46.165 Vali Loss: 31.718 Vali Acc: 0.468 Test Loss: 31.718 Test Acc: 0.468
Validation loss decreased (-0.224971 --> -0.467891).  Saving model ...
Epoch: 3 cost time: 7.068115234375
Epoch: 3, Steps: 34 | Train Loss: 26.162 Vali Loss: 48.508 Vali Acc: 0.439 Test Loss: 48.508 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.9375245571136475
Epoch: 4, Steps: 34 | Train Loss: 50.734 Vali Loss: 34.115 Vali Acc: 0.526 Test Loss: 34.115 Test Acc: 0.526
Validation loss decreased (-0.467891 --> -0.525670).  Saving model ...
Epoch: 5 cost time: 7.0816309452056885
Epoch: 5, Steps: 34 | Train Loss: 36.488 Vali Loss: 43.688 Vali Acc: 0.566 Test Loss: 43.688 Test Acc: 0.566
Validation loss decreased (-0.525670 --> -0.566037).  Saving model ...
Epoch: 6 cost time: 6.878608703613281
Epoch: 6, Steps: 34 | Train Loss: 32.682 Vali Loss: 95.242 Vali Acc: 0.543 Test Loss: 95.242 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.745510101318359
Epoch: 7, Steps: 34 | Train Loss: 33.422 Vali Loss: 77.541 Vali Acc: 0.451 Test Loss: 77.541 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.82285737991333
Epoch: 8, Steps: 34 | Train Loss: 39.350 Vali Loss: 68.260 Vali Acc: 0.584 Test Loss: 68.260 Test Acc: 0.584
Validation loss decreased (-0.566037 --> -0.583132).  Saving model ...
Epoch: 9 cost time: 6.901106834411621
Epoch: 9, Steps: 34 | Train Loss: 26.309 Vali Loss: 28.967 Vali Acc: 0.653 Test Loss: 28.967 Test Acc: 0.653
Validation loss decreased (-0.583132 --> -0.652890).  Saving model ...
Epoch: 10 cost time: 6.853665351867676
Epoch: 10, Steps: 34 | Train Loss: 8.986 Vali Loss: 44.783 Vali Acc: 0.642 Test Loss: 44.783 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.792627573013306
Epoch: 11, Steps: 34 | Train Loss: 13.917 Vali Loss: 36.259 Vali Acc: 0.694 Test Loss: 36.259 Test Acc: 0.694
Validation loss decreased (-0.652890 --> -0.693279).  Saving model ...
Epoch: 12 cost time: 6.960675239562988
Epoch: 12, Steps: 34 | Train Loss: 15.564 Vali Loss: 38.533 Vali Acc: 0.751 Test Loss: 38.533 Test Acc: 0.751
Validation loss decreased (-0.693279 --> -0.751060).  Saving model ...
Epoch: 13 cost time: 7.1386878490448
Epoch: 13, Steps: 34 | Train Loss: 6.510 Vali Loss: 52.295 Vali Acc: 0.705 Test Loss: 52.295 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.761538505554199
Epoch: 14, Steps: 34 | Train Loss: 8.317 Vali Loss: 19.290 Vali Acc: 0.844 Test Loss: 19.290 Test Acc: 0.844
Validation loss decreased (-0.751060 --> -0.843738).  Saving model ...
Epoch: 15 cost time: 6.840193271636963
Epoch: 15, Steps: 34 | Train Loss: 5.603 Vali Loss: 60.249 Vali Acc: 0.694 Test Loss: 60.249 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.764612674713135
Epoch: 16, Steps: 34 | Train Loss: 6.690 Vali Loss: 35.334 Vali Acc: 0.815 Test Loss: 35.334 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.880670070648193
Epoch: 17, Steps: 34 | Train Loss: 11.687 Vali Loss: 57.877 Vali Acc: 0.740 Test Loss: 57.877 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.871988296508789
Epoch: 18, Steps: 34 | Train Loss: 6.980 Vali Loss: 54.467 Vali Acc: 0.682 Test Loss: 54.467 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.698414087295532
Epoch: 19, Steps: 34 | Train Loss: 7.278 Vali Loss: 26.846 Vali Acc: 0.798 Test Loss: 26.846 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.906982660293579
Epoch: 20, Steps: 34 | Train Loss: 1.734 Vali Loss: 26.780 Vali Acc: 0.809 Test Loss: 26.780 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.922857046127319
Epoch: 21, Steps: 34 | Train Loss: 1.741 Vali Loss: 39.271 Vali Acc: 0.769 Test Loss: 39.271 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.42700982093811
Epoch: 22, Steps: 34 | Train Loss: 2.315 Vali Loss: 29.067 Vali Acc: 0.786 Test Loss: 29.067 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.282248497009277
Epoch: 23, Steps: 34 | Train Loss: 2.742 Vali Loss: 61.642 Vali Acc: 0.792 Test Loss: 61.642 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.98255729675293
Epoch: 24, Steps: 34 | Train Loss: 3.672 Vali Loss: 17.045 Vali Acc: 0.908 Test Loss: 17.045 Test Acc: 0.908
Validation loss decreased (-0.843738 --> -0.907344).  Saving model ...
Epoch: 25 cost time: 6.893158674240112
Epoch: 25, Steps: 34 | Train Loss: 1.791 Vali Loss: 27.541 Vali Acc: 0.821 Test Loss: 27.541 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.788320541381836
Epoch: 26, Steps: 34 | Train Loss: 0.093 Vali Loss: 49.049 Vali Acc: 0.803 Test Loss: 49.049 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.870577335357666
Epoch: 27, Steps: 34 | Train Loss: 0.311 Vali Loss: 35.607 Vali Acc: 0.838 Test Loss: 35.607 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.252699136734009
Epoch: 28, Steps: 34 | Train Loss: 1.101 Vali Loss: 53.748 Vali Acc: 0.803 Test Loss: 53.748 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.019513130187988
Epoch: 29, Steps: 34 | Train Loss: 1.105 Vali Loss: 55.169 Vali Acc: 0.803 Test Loss: 55.169 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.658682107925415
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.252 Vali Acc: 0.879 Test Loss: 27.252 Test Acc: 0.879
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 7.051738977432251
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.064 Vali Acc: 0.879 Test Loss: 27.064 Test Acc: 0.879
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.776673793792725
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.059 Vali Acc: 0.879 Test Loss: 27.059 Test Acc: 0.879
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 7.303689241409302
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.059 Vali Acc: 0.879 Test Loss: 27.059 Test Acc: 0.879
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.842289686203003
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 27.059 Vali Acc: 0.879 Test Loss: 27.059 Test Acc: 0.879
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.9075144508670521
model parameter : 13036575
model size : 52.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.70095181465149
Epoch: 1, Steps: 34 | Train Loss: 14.545 Vali Loss: 19.673 Vali Acc: 0.353 Test Loss: 19.673 Test Acc: 0.353
Validation loss decreased (inf --> -0.352404).  Saving model ...
Epoch: 2 cost time: 7.0800487995147705
Epoch: 2, Steps: 34 | Train Loss: 33.289 Vali Loss: 52.380 Vali Acc: 0.318 Test Loss: 52.380 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.52941370010376
Epoch: 3, Steps: 34 | Train Loss: 28.664 Vali Loss: 25.436 Vali Acc: 0.618 Test Loss: 25.436 Test Acc: 0.618
Validation loss decreased (-0.352404 --> -0.618243).  Saving model ...
Epoch: 4 cost time: 6.946997880935669
Epoch: 4, Steps: 34 | Train Loss: 18.699 Vali Loss: 67.884 Vali Acc: 0.491 Test Loss: 67.884 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.840622186660767
Epoch: 5, Steps: 34 | Train Loss: 48.830 Vali Loss: 22.250 Vali Acc: 0.595 Test Loss: 22.250 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.6993396282196045
Epoch: 6, Steps: 34 | Train Loss: 47.215 Vali Loss: 15.911 Vali Acc: 0.740 Test Loss: 15.911 Test Acc: 0.740
Validation loss decreased (-0.618243 --> -0.739725).  Saving model ...
Epoch: 7 cost time: 6.539840221405029
Epoch: 7, Steps: 34 | Train Loss: 51.677 Vali Loss: 42.920 Vali Acc: 0.613 Test Loss: 42.920 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1577324867248535
Epoch: 8, Steps: 34 | Train Loss: 31.909 Vali Loss: 53.619 Vali Acc: 0.636 Test Loss: 53.619 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.111668348312378
Epoch: 9, Steps: 34 | Train Loss: 21.431 Vali Loss: 26.673 Vali Acc: 0.705 Test Loss: 26.673 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.857011556625366
Epoch: 10, Steps: 34 | Train Loss: 24.801 Vali Loss: 53.057 Vali Acc: 0.705 Test Loss: 53.057 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.007313251495361
Epoch: 11, Steps: 34 | Train Loss: 21.657 Vali Loss: 24.293 Vali Acc: 0.798 Test Loss: 24.293 Test Acc: 0.798
Validation loss decreased (-0.739725 --> -0.797445).  Saving model ...
Epoch: 12 cost time: 6.963216304779053
Epoch: 12, Steps: 34 | Train Loss: 12.794 Vali Loss: 32.875 Vali Acc: 0.751 Test Loss: 32.875 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.73585057258606
Epoch: 13, Steps: 34 | Train Loss: 17.373 Vali Loss: 60.824 Vali Acc: 0.671 Test Loss: 60.824 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.634505748748779
Epoch: 14, Steps: 34 | Train Loss: 22.489 Vali Loss: 43.539 Vali Acc: 0.757 Test Loss: 43.539 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.904890537261963
Epoch: 15, Steps: 34 | Train Loss: 7.569 Vali Loss: 62.135 Vali Acc: 0.676 Test Loss: 62.135 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.744529724121094
Epoch: 16, Steps: 34 | Train Loss: 12.838 Vali Loss: 63.425 Vali Acc: 0.757 Test Loss: 63.425 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.1772449016571045
Epoch: 17, Steps: 34 | Train Loss: 8.778 Vali Loss: 31.011 Vali Acc: 0.786 Test Loss: 31.011 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.53731107711792
Epoch: 18, Steps: 34 | Train Loss: 4.700 Vali Loss: 46.287 Vali Acc: 0.740 Test Loss: 46.287 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.795602083206177
Epoch: 19, Steps: 34 | Train Loss: 2.322 Vali Loss: 50.074 Vali Acc: 0.775 Test Loss: 50.074 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.846730470657349
Epoch: 20, Steps: 34 | Train Loss: 2.245 Vali Loss: 30.909 Vali Acc: 0.711 Test Loss: 30.909 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.075562477111816
Epoch: 21, Steps: 34 | Train Loss: 26.190 Vali Loss: 59.774 Vali Acc: 0.734 Test Loss: 59.774 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 13035039
model size : 52.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.947151184082031
Epoch: 1, Steps: 34 | Train Loss: 16.775 Vali Loss: 31.904 Vali Acc: 0.301 Test Loss: 31.904 Test Acc: 0.301
Validation loss decreased (inf --> -0.300259).  Saving model ...
Epoch: 2 cost time: 6.585063219070435
Epoch: 2, Steps: 34 | Train Loss: 31.013 Vali Loss: 46.708 Vali Acc: 0.260 Test Loss: 46.708 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.688778400421143
Epoch: 3, Steps: 34 | Train Loss: 32.967 Vali Loss: 26.332 Vali Acc: 0.532 Test Loss: 26.332 Test Acc: 0.532
Validation loss decreased (-0.300259 --> -0.531529).  Saving model ...
Epoch: 4 cost time: 6.601165056228638
Epoch: 4, Steps: 34 | Train Loss: 27.184 Vali Loss: 46.593 Vali Acc: 0.480 Test Loss: 46.593 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.839686632156372
Epoch: 5, Steps: 34 | Train Loss: 21.125 Vali Loss: 79.685 Vali Acc: 0.318 Test Loss: 79.685 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.672674179077148
Epoch: 6, Steps: 34 | Train Loss: 57.368 Vali Loss: 53.809 Vali Acc: 0.468 Test Loss: 53.809 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.644977331161499
Epoch: 7, Steps: 34 | Train Loss: 39.991 Vali Loss: 45.059 Vali Acc: 0.642 Test Loss: 45.059 Test Acc: 0.642
Validation loss decreased (-0.531529 --> -0.641168).  Saving model ...
Epoch: 8 cost time: 6.873223066329956
Epoch: 8, Steps: 34 | Train Loss: 27.367 Vali Loss: 88.283 Vali Acc: 0.422 Test Loss: 88.283 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.508471250534058
Epoch: 9, Steps: 34 | Train Loss: 25.713 Vali Loss: 22.286 Vali Acc: 0.751 Test Loss: 22.286 Test Acc: 0.751
Validation loss decreased (-0.641168 --> -0.751222).  Saving model ...
Epoch: 10 cost time: 6.6288909912109375
Epoch: 10, Steps: 34 | Train Loss: 14.262 Vali Loss: 105.743 Vali Acc: 0.653 Test Loss: 105.743 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.524453639984131
Epoch: 11, Steps: 34 | Train Loss: 25.244 Vali Loss: 76.382 Vali Acc: 0.549 Test Loss: 76.382 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.90467381477356
Epoch: 12, Steps: 34 | Train Loss: 10.271 Vali Loss: 39.747 Vali Acc: 0.682 Test Loss: 39.747 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.830326557159424
Epoch: 13, Steps: 34 | Train Loss: 7.824 Vali Loss: 21.245 Vali Acc: 0.844 Test Loss: 21.245 Test Acc: 0.844
Validation loss decreased (-0.751222 --> -0.843718).  Saving model ...
Epoch: 14 cost time: 6.6416335105896
Epoch: 14, Steps: 34 | Train Loss: 4.689 Vali Loss: 32.220 Vali Acc: 0.769 Test Loss: 32.220 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.824573516845703
Epoch: 15, Steps: 34 | Train Loss: 5.955 Vali Loss: 40.814 Vali Acc: 0.763 Test Loss: 40.814 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.857791900634766
Epoch: 16, Steps: 34 | Train Loss: 9.973 Vali Loss: 39.825 Vali Acc: 0.746 Test Loss: 39.825 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.569814920425415
Epoch: 17, Steps: 34 | Train Loss: 3.233 Vali Loss: 21.329 Vali Acc: 0.815 Test Loss: 21.329 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.777667045593262
Epoch: 18, Steps: 34 | Train Loss: 2.246 Vali Loss: 41.263 Vali Acc: 0.740 Test Loss: 41.263 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.762722969055176
Epoch: 19, Steps: 34 | Train Loss: 6.234 Vali Loss: 115.766 Vali Acc: 0.618 Test Loss: 115.766 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.918517827987671
Epoch: 20, Steps: 34 | Train Loss: 20.637 Vali Loss: 73.881 Vali Acc: 0.711 Test Loss: 73.881 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.87386679649353
Epoch: 21, Steps: 34 | Train Loss: 9.917 Vali Loss: 101.593 Vali Acc: 0.618 Test Loss: 101.593 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.823792219161987
Epoch: 22, Steps: 34 | Train Loss: 5.095 Vali Loss: 60.915 Vali Acc: 0.642 Test Loss: 60.915 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.576064109802246
Epoch: 23, Steps: 34 | Train Loss: 4.728 Vali Loss: 50.538 Vali Acc: 0.717 Test Loss: 50.538 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 13033503
model size : 52.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.977940082550049
Epoch: 1, Steps: 34 | Train Loss: 23.183 Vali Loss: 17.440 Vali Acc: 0.353 Test Loss: 17.440 Test Acc: 0.353
Validation loss decreased (inf --> -0.352427).  Saving model ...
Epoch: 2 cost time: 6.2153215408325195
Epoch: 2, Steps: 34 | Train Loss: 28.492 Vali Loss: 41.893 Vali Acc: 0.272 Test Loss: 41.893 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.652849197387695
Epoch: 3, Steps: 34 | Train Loss: 53.024 Vali Loss: 69.387 Vali Acc: 0.416 Test Loss: 69.387 Test Acc: 0.416
Validation loss decreased (-0.352427 --> -0.415491).  Saving model ...
Epoch: 4 cost time: 6.629499673843384
Epoch: 4, Steps: 34 | Train Loss: 43.572 Vali Loss: 40.562 Vali Acc: 0.468 Test Loss: 40.562 Test Acc: 0.468
Validation loss decreased (-0.415491 --> -0.467802).  Saving model ...
Epoch: 5 cost time: 6.46611475944519
Epoch: 5, Steps: 34 | Train Loss: 40.932 Vali Loss: 31.654 Vali Acc: 0.572 Test Loss: 31.654 Test Acc: 0.572
Validation loss decreased (-0.467802 --> -0.571938).  Saving model ...
Epoch: 6 cost time: 6.543061017990112
Epoch: 6, Steps: 34 | Train Loss: 31.887 Vali Loss: 41.029 Vali Acc: 0.613 Test Loss: 41.029 Test Acc: 0.613
Validation loss decreased (-0.571938 --> -0.612306).  Saving model ...
Epoch: 7 cost time: 6.77223539352417
Epoch: 7, Steps: 34 | Train Loss: 16.453 Vali Loss: 33.770 Vali Acc: 0.618 Test Loss: 33.770 Test Acc: 0.618
Validation loss decreased (-0.612306 --> -0.618159).  Saving model ...
Epoch: 8 cost time: 6.47771143913269
Epoch: 8, Steps: 34 | Train Loss: 19.715 Vali Loss: 23.416 Vali Acc: 0.723 Test Loss: 23.416 Test Acc: 0.723
Validation loss decreased (-0.618159 --> -0.722309).  Saving model ...
Epoch: 9 cost time: 6.516882419586182
Epoch: 9, Steps: 34 | Train Loss: 11.928 Vali Loss: 18.227 Vali Acc: 0.803 Test Loss: 18.227 Test Acc: 0.803
Validation loss decreased (-0.722309 --> -0.803286).  Saving model ...
Epoch: 10 cost time: 6.673725366592407
Epoch: 10, Steps: 34 | Train Loss: 6.166 Vali Loss: 55.215 Vali Acc: 0.624 Test Loss: 55.215 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.651640892028809
Epoch: 11, Steps: 34 | Train Loss: 9.923 Vali Loss: 22.297 Vali Acc: 0.705 Test Loss: 22.297 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.600042819976807
Epoch: 12, Steps: 34 | Train Loss: 7.656 Vali Loss: 40.879 Vali Acc: 0.676 Test Loss: 40.879 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.659776926040649
Epoch: 13, Steps: 34 | Train Loss: 10.343 Vali Loss: 53.405 Vali Acc: 0.642 Test Loss: 53.405 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.644135236740112
Epoch: 14, Steps: 34 | Train Loss: 8.779 Vali Loss: 21.132 Vali Acc: 0.757 Test Loss: 21.132 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.690346956253052
Epoch: 15, Steps: 34 | Train Loss: 6.066 Vali Loss: 36.560 Vali Acc: 0.746 Test Loss: 36.560 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.725806474685669
Epoch: 16, Steps: 34 | Train Loss: 16.610 Vali Loss: 60.230 Vali Acc: 0.717 Test Loss: 60.230 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.641335725784302
Epoch: 17, Steps: 34 | Train Loss: 6.690 Vali Loss: 23.023 Vali Acc: 0.827 Test Loss: 23.023 Test Acc: 0.827
Validation loss decreased (-0.803286 --> -0.826359).  Saving model ...
Epoch: 18 cost time: 6.567436695098877
Epoch: 18, Steps: 34 | Train Loss: 8.721 Vali Loss: 57.725 Vali Acc: 0.740 Test Loss: 57.725 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.771056175231934
Epoch: 19, Steps: 34 | Train Loss: 9.308 Vali Loss: 15.660 Vali Acc: 0.844 Test Loss: 15.660 Test Acc: 0.844
Validation loss decreased (-0.826359 --> -0.843774).  Saving model ...
Epoch: 20 cost time: 6.641413450241089
Epoch: 20, Steps: 34 | Train Loss: 13.324 Vali Loss: 130.535 Vali Acc: 0.659 Test Loss: 130.535 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.630780458450317
Epoch: 21, Steps: 34 | Train Loss: 10.700 Vali Loss: 30.493 Vali Acc: 0.792 Test Loss: 30.493 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.5353615283966064
Epoch: 22, Steps: 34 | Train Loss: 0.903 Vali Loss: 66.402 Vali Acc: 0.734 Test Loss: 66.402 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.719121932983398
Epoch: 23, Steps: 34 | Train Loss: 1.964 Vali Loss: 34.298 Vali Acc: 0.780 Test Loss: 34.298 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.489707946777344
Epoch: 24, Steps: 34 | Train Loss: 0.581 Vali Loss: 24.467 Vali Acc: 0.821 Test Loss: 24.467 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.54831862449646
Epoch: 25, Steps: 34 | Train Loss: 1.707 Vali Loss: 47.662 Vali Acc: 0.780 Test Loss: 47.662 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.5818703174591064
Epoch: 26, Steps: 34 | Train Loss: 6.653 Vali Loss: 55.700 Vali Acc: 0.792 Test Loss: 55.700 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.531566619873047
Epoch: 27, Steps: 34 | Train Loss: 5.316 Vali Loss: 75.101 Vali Acc: 0.757 Test Loss: 75.101 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.555637836456299
Epoch: 28, Steps: 34 | Train Loss: 4.212 Vali Loss: 25.185 Vali Acc: 0.827 Test Loss: 25.185 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.5945658683776855
Epoch: 29, Steps: 34 | Train Loss: 0.781 Vali Loss: 35.083 Vali Acc: 0.798 Test Loss: 35.083 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 13031967
model size : 52.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.455670833587646
Epoch: 1, Steps: 34 | Train Loss: 25.556 Vali Loss: 38.237 Vali Acc: 0.318 Test Loss: 38.237 Test Acc: 0.318
Validation loss decreased (inf --> -0.317537).  Saving model ...
Epoch: 2 cost time: 6.5961079597473145
Epoch: 2, Steps: 34 | Train Loss: 39.460 Vali Loss: 33.638 Vali Acc: 0.462 Test Loss: 33.638 Test Acc: 0.462
Validation loss decreased (-0.317537 --> -0.462091).  Saving model ...
Epoch: 3 cost time: 6.7301108837127686
Epoch: 3, Steps: 34 | Train Loss: 31.748 Vali Loss: 33.676 Vali Acc: 0.538 Test Loss: 33.676 Test Acc: 0.538
Validation loss decreased (-0.462091 --> -0.537235).  Saving model ...
Epoch: 4 cost time: 6.494880437850952
Epoch: 4, Steps: 34 | Train Loss: 48.694 Vali Loss: 29.390 Vali Acc: 0.549 Test Loss: 29.390 Test Acc: 0.549
Validation loss decreased (-0.537235 --> -0.548839).  Saving model ...
Epoch: 5 cost time: 6.581801652908325
Epoch: 5, Steps: 34 | Train Loss: 45.864 Vali Loss: 34.127 Vali Acc: 0.613 Test Loss: 34.127 Test Acc: 0.613
Validation loss decreased (-0.548839 --> -0.612375).  Saving model ...
Epoch: 6 cost time: 6.460856914520264
Epoch: 6, Steps: 34 | Train Loss: 31.177 Vali Loss: 43.174 Vali Acc: 0.561 Test Loss: 43.174 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.510781288146973
Epoch: 7, Steps: 34 | Train Loss: 30.842 Vali Loss: 36.853 Vali Acc: 0.607 Test Loss: 36.853 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.501251459121704
Epoch: 8, Steps: 34 | Train Loss: 32.565 Vali Loss: 28.924 Vali Acc: 0.636 Test Loss: 28.924 Test Acc: 0.636
Validation loss decreased (-0.612375 --> -0.635549).  Saving model ...
Epoch: 9 cost time: 6.44673752784729
Epoch: 9, Steps: 34 | Train Loss: 25.696 Vali Loss: 91.265 Vali Acc: 0.555 Test Loss: 91.265 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.389459609985352
Epoch: 10, Steps: 34 | Train Loss: 33.453 Vali Loss: 44.083 Vali Acc: 0.671 Test Loss: 44.083 Test Acc: 0.671
Validation loss decreased (-0.635549 --> -0.670079).  Saving model ...
Epoch: 11 cost time: 6.882245063781738
Epoch: 11, Steps: 34 | Train Loss: 13.908 Vali Loss: 32.496 Vali Acc: 0.751 Test Loss: 32.496 Test Acc: 0.751
Validation loss decreased (-0.670079 --> -0.751120).  Saving model ...
Epoch: 12 cost time: 6.683362722396851
Epoch: 12, Steps: 34 | Train Loss: 16.109 Vali Loss: 49.615 Vali Acc: 0.734 Test Loss: 49.615 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.507354259490967
Epoch: 13, Steps: 34 | Train Loss: 10.627 Vali Loss: 19.892 Vali Acc: 0.803 Test Loss: 19.892 Test Acc: 0.803
Validation loss decreased (-0.751120 --> -0.803269).  Saving model ...
Epoch: 14 cost time: 6.538442850112915
Epoch: 14, Steps: 34 | Train Loss: 4.463 Vali Loss: 15.530 Vali Acc: 0.850 Test Loss: 15.530 Test Acc: 0.850
Validation loss decreased (-0.803269 --> -0.849556).  Saving model ...
Epoch: 15 cost time: 6.49543309211731
Epoch: 15, Steps: 34 | Train Loss: 6.695 Vali Loss: 72.577 Vali Acc: 0.717 Test Loss: 72.577 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.390051603317261
Epoch: 16, Steps: 34 | Train Loss: 2.082 Vali Loss: 38.020 Vali Acc: 0.751 Test Loss: 38.020 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.527986526489258
Epoch: 17, Steps: 34 | Train Loss: 4.613 Vali Loss: 113.223 Vali Acc: 0.584 Test Loss: 113.223 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.366673946380615
Epoch: 18, Steps: 34 | Train Loss: 11.606 Vali Loss: 25.848 Vali Acc: 0.827 Test Loss: 25.848 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.154827833175659
Epoch: 19, Steps: 34 | Train Loss: 12.521 Vali Loss: 47.576 Vali Acc: 0.751 Test Loss: 47.576 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.405520915985107
Epoch: 20, Steps: 34 | Train Loss: 16.303 Vali Loss: 63.321 Vali Acc: 0.694 Test Loss: 63.321 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.6088385581970215
Epoch: 21, Steps: 34 | Train Loss: 10.389 Vali Loss: 61.910 Vali Acc: 0.740 Test Loss: 61.910 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.350938558578491
Epoch: 22, Steps: 34 | Train Loss: 8.136 Vali Loss: 36.495 Vali Acc: 0.809 Test Loss: 36.495 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.558096408843994
Epoch: 23, Steps: 34 | Train Loss: 6.260 Vali Loss: 35.118 Vali Acc: 0.815 Test Loss: 35.118 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.48403787612915
Epoch: 24, Steps: 34 | Train Loss: 2.616 Vali Loss: 86.913 Vali Acc: 0.769 Test Loss: 86.913 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 12839199
model size : 51.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.727458000183105
Epoch: 1, Steps: 34 | Train Loss: 17.216 Vali Loss: 42.440 Vali Acc: 0.127 Test Loss: 42.440 Test Acc: 0.127
Validation loss decreased (inf --> -0.126743).  Saving model ...
Epoch: 2 cost time: 6.727803707122803
Epoch: 2, Steps: 34 | Train Loss: 31.715 Vali Loss: 36.010 Vali Acc: 0.318 Test Loss: 36.010 Test Acc: 0.318
Validation loss decreased (-0.126743 --> -0.317559).  Saving model ...
Epoch: 3 cost time: 6.650137662887573
Epoch: 3, Steps: 34 | Train Loss: 25.984 Vali Loss: 47.643 Vali Acc: 0.474 Test Loss: 47.643 Test Acc: 0.474
Validation loss decreased (-0.317559 --> -0.473512).  Saving model ...
Epoch: 4 cost time: 6.429158449172974
Epoch: 4, Steps: 34 | Train Loss: 36.234 Vali Loss: 83.229 Vali Acc: 0.364 Test Loss: 83.229 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.677325963973999
Epoch: 5, Steps: 34 | Train Loss: 50.235 Vali Loss: 50.840 Vali Acc: 0.555 Test Loss: 50.840 Test Acc: 0.555
Validation loss decreased (-0.473512 --> -0.554405).  Saving model ...
Epoch: 6 cost time: 6.524798154830933
Epoch: 6, Steps: 34 | Train Loss: 29.134 Vali Loss: 58.516 Vali Acc: 0.561 Test Loss: 58.516 Test Acc: 0.561
Validation loss decreased (-0.554405 --> -0.560108).  Saving model ...
Epoch: 7 cost time: 6.45139217376709
Epoch: 7, Steps: 34 | Train Loss: 43.117 Vali Loss: 68.986 Vali Acc: 0.595 Test Loss: 68.986 Test Acc: 0.595
Validation loss decreased (-0.560108 --> -0.594686).  Saving model ...
Epoch: 8 cost time: 6.803101539611816
Epoch: 8, Steps: 34 | Train Loss: 35.735 Vali Loss: 32.443 Vali Acc: 0.676 Test Loss: 32.443 Test Acc: 0.676
Validation loss decreased (-0.594686 --> -0.675976).  Saving model ...
Epoch: 9 cost time: 6.668502330780029
Epoch: 9, Steps: 34 | Train Loss: 9.683 Vali Loss: 56.229 Vali Acc: 0.653 Test Loss: 56.229 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.637759685516357
Epoch: 10, Steps: 34 | Train Loss: 15.637 Vali Loss: 61.606 Vali Acc: 0.613 Test Loss: 61.606 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.77146577835083
Epoch: 11, Steps: 34 | Train Loss: 21.054 Vali Loss: 34.657 Vali Acc: 0.717 Test Loss: 34.657 Test Acc: 0.717
Validation loss decreased (-0.675976 --> -0.716416).  Saving model ...
Epoch: 12 cost time: 6.688447952270508
Epoch: 12, Steps: 34 | Train Loss: 11.809 Vali Loss: 63.285 Vali Acc: 0.578 Test Loss: 63.285 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.767005920410156
Epoch: 13, Steps: 34 | Train Loss: 17.836 Vali Loss: 82.552 Vali Acc: 0.595 Test Loss: 82.552 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.6227264404296875
Epoch: 14, Steps: 34 | Train Loss: 12.601 Vali Loss: 50.920 Vali Acc: 0.734 Test Loss: 50.920 Test Acc: 0.734
Validation loss decreased (-0.716416 --> -0.733595).  Saving model ...
Epoch: 15 cost time: 6.51561713218689
Epoch: 15, Steps: 34 | Train Loss: 13.068 Vali Loss: 65.536 Vali Acc: 0.595 Test Loss: 65.536 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.571963548660278
Epoch: 16, Steps: 34 | Train Loss: 6.552 Vali Loss: 67.841 Vali Acc: 0.694 Test Loss: 67.841 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.954850673675537
Epoch: 17, Steps: 34 | Train Loss: 6.904 Vali Loss: 44.779 Vali Acc: 0.775 Test Loss: 44.779 Test Acc: 0.775
Validation loss decreased (-0.733595 --> -0.774119).  Saving model ...
Epoch: 18 cost time: 6.57224702835083
Epoch: 18, Steps: 34 | Train Loss: 8.052 Vali Loss: 70.263 Vali Acc: 0.636 Test Loss: 70.263 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.639686584472656
Epoch: 19, Steps: 34 | Train Loss: 2.292 Vali Loss: 37.976 Vali Acc: 0.775 Test Loss: 37.976 Test Acc: 0.775
Validation loss decreased (-0.774119 --> -0.774187).  Saving model ...
Epoch: 20 cost time: 6.54720401763916
Epoch: 20, Steps: 34 | Train Loss: 6.642 Vali Loss: 32.552 Vali Acc: 0.815 Test Loss: 32.552 Test Acc: 0.815
Validation loss decreased (-0.774187 --> -0.814703).  Saving model ...
Epoch: 21 cost time: 6.659867763519287
Epoch: 21, Steps: 34 | Train Loss: 9.648 Vali Loss: 56.900 Vali Acc: 0.763 Test Loss: 56.900 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.817031383514404
Epoch: 22, Steps: 34 | Train Loss: 11.516 Vali Loss: 49.155 Vali Acc: 0.769 Test Loss: 49.155 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.994677543640137
Epoch: 23, Steps: 34 | Train Loss: 3.379 Vali Loss: 38.616 Vali Acc: 0.780 Test Loss: 38.616 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.880134582519531
Epoch: 24, Steps: 34 | Train Loss: 0.785 Vali Loss: 34.688 Vali Acc: 0.763 Test Loss: 34.688 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.033616065979004
Epoch: 25, Steps: 34 | Train Loss: 1.186 Vali Loss: 50.677 Vali Acc: 0.751 Test Loss: 50.677 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.654131889343262
Epoch: 26, Steps: 34 | Train Loss: 0.766 Vali Loss: 59.603 Vali Acc: 0.740 Test Loss: 59.603 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.726384162902832
Epoch: 27, Steps: 34 | Train Loss: 0.821 Vali Loss: 30.405 Vali Acc: 0.838 Test Loss: 30.405 Test Acc: 0.838
Validation loss decreased (-0.814703 --> -0.837846).  Saving model ...
Epoch: 28 cost time: 6.903588771820068
Epoch: 28, Steps: 34 | Train Loss: 2.849 Vali Loss: 53.968 Vali Acc: 0.815 Test Loss: 53.968 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.8697309494018555
Epoch: 29, Steps: 34 | Train Loss: 2.997 Vali Loss: 23.970 Vali Acc: 0.867 Test Loss: 23.970 Test Acc: 0.867
Validation loss decreased (-0.837846 --> -0.866812).  Saving model ...
Epoch: 30 cost time: 6.620064973831177
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 28.783 Vali Acc: 0.873 Test Loss: 28.783 Test Acc: 0.873
Validation loss decreased (-0.866812 --> -0.872545).  Saving model ...
Epoch: 31 cost time: 6.697617769241333
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.606 Vali Acc: 0.861 Test Loss: 29.606 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.714914083480835
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.631 Vali Acc: 0.861 Test Loss: 29.631 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.739532470703125
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.581360340118408
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.739155292510986
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.629931688308716
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.544604063034058
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.899814605712891
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.638873338699341
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.676003456115723
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 29.632 Vali Acc: 0.861 Test Loss: 29.632 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 12837663
model size : 51.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.67784571647644
Epoch: 1, Steps: 34 | Train Loss: 19.848 Vali Loss: 22.771 Vali Acc: 0.324 Test Loss: 22.771 Test Acc: 0.324
Validation loss decreased (inf --> -0.323472).  Saving model ...
Epoch: 2 cost time: 6.448517799377441
Epoch: 2, Steps: 34 | Train Loss: 28.196 Vali Loss: 40.694 Vali Acc: 0.468 Test Loss: 40.694 Test Acc: 0.468
Validation loss decreased (-0.323472 --> -0.467801).  Saving model ...
Epoch: 3 cost time: 6.118114709854126
Epoch: 3, Steps: 34 | Train Loss: 35.136 Vali Loss: 35.894 Vali Acc: 0.370 Test Loss: 35.894 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.557256698608398
Epoch: 4, Steps: 34 | Train Loss: 34.688 Vali Loss: 37.688 Vali Acc: 0.393 Test Loss: 37.688 Test Acc: 0.393
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.836602210998535
Epoch: 5, Steps: 34 | Train Loss: 27.123 Vali Loss: 16.750 Vali Acc: 0.711 Test Loss: 16.750 Test Acc: 0.711
Validation loss decreased (-0.467801 --> -0.710815).  Saving model ...
Epoch: 6 cost time: 6.536034822463989
Epoch: 6, Steps: 34 | Train Loss: 25.099 Vali Loss: 55.718 Vali Acc: 0.566 Test Loss: 55.718 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.431837797164917
Epoch: 7, Steps: 34 | Train Loss: 46.606 Vali Loss: 26.135 Vali Acc: 0.613 Test Loss: 26.135 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.719893217086792
Epoch: 8, Steps: 34 | Train Loss: 29.859 Vali Loss: 85.485 Vali Acc: 0.520 Test Loss: 85.485 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.550522565841675
Epoch: 9, Steps: 34 | Train Loss: 28.948 Vali Loss: 32.072 Vali Acc: 0.636 Test Loss: 32.072 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.773033380508423
Epoch: 10, Steps: 34 | Train Loss: 14.691 Vali Loss: 44.486 Vali Acc: 0.711 Test Loss: 44.486 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.708916902542114
Epoch: 11, Steps: 34 | Train Loss: 30.906 Vali Loss: 27.716 Vali Acc: 0.711 Test Loss: 27.716 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.548410654067993
Epoch: 12, Steps: 34 | Train Loss: 14.375 Vali Loss: 35.284 Vali Acc: 0.717 Test Loss: 35.284 Test Acc: 0.717
Validation loss decreased (-0.710815 --> -0.716410).  Saving model ...
Epoch: 13 cost time: 6.582361221313477
Epoch: 13, Steps: 34 | Train Loss: 9.280 Vali Loss: 57.961 Vali Acc: 0.751 Test Loss: 57.961 Test Acc: 0.751
Validation loss decreased (-0.716410 --> -0.750865).  Saving model ...
Epoch: 14 cost time: 6.788775444030762
Epoch: 14, Steps: 34 | Train Loss: 20.868 Vali Loss: 57.612 Vali Acc: 0.717 Test Loss: 57.612 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.535852432250977
Epoch: 15, Steps: 34 | Train Loss: 11.132 Vali Loss: 24.431 Vali Acc: 0.844 Test Loss: 24.431 Test Acc: 0.844
Validation loss decreased (-0.750865 --> -0.843686).  Saving model ...
Epoch: 16 cost time: 6.792906284332275
Epoch: 16, Steps: 34 | Train Loss: 6.315 Vali Loss: 26.517 Vali Acc: 0.821 Test Loss: 26.517 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.496242523193359
Epoch: 17, Steps: 34 | Train Loss: 2.693 Vali Loss: 50.938 Vali Acc: 0.705 Test Loss: 50.938 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.34010648727417
Epoch: 18, Steps: 34 | Train Loss: 4.293 Vali Loss: 35.036 Vali Acc: 0.769 Test Loss: 35.036 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.797814607620239
Epoch: 19, Steps: 34 | Train Loss: 2.713 Vali Loss: 90.221 Vali Acc: 0.532 Test Loss: 90.221 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.769848346710205
Epoch: 20, Steps: 34 | Train Loss: 7.392 Vali Loss: 71.009 Vali Acc: 0.699 Test Loss: 71.009 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.935896635055542
Epoch: 21, Steps: 34 | Train Loss: 7.093 Vali Loss: 39.168 Vali Acc: 0.740 Test Loss: 39.168 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.545602798461914
Epoch: 22, Steps: 34 | Train Loss: 2.487 Vali Loss: 47.357 Vali Acc: 0.792 Test Loss: 47.357 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.57055139541626
Epoch: 23, Steps: 34 | Train Loss: 2.293 Vali Loss: 54.515 Vali Acc: 0.723 Test Loss: 54.515 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.7679455280303955
Epoch: 24, Steps: 34 | Train Loss: 3.665 Vali Loss: 37.219 Vali Acc: 0.809 Test Loss: 37.219 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.5653977394104
Epoch: 25, Steps: 34 | Train Loss: 1.047 Vali Loss: 42.634 Vali Acc: 0.786 Test Loss: 42.634 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 12836127
model size : 51.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.354371309280396
Epoch: 1, Steps: 34 | Train Loss: 18.289 Vali Loss: 36.296 Vali Acc: 0.341 Test Loss: 36.296 Test Acc: 0.341
Validation loss decreased (inf --> -0.340678).  Saving model ...
Epoch: 2 cost time: 6.762008428573608
Epoch: 2, Steps: 34 | Train Loss: 27.547 Vali Loss: 27.138 Vali Acc: 0.520 Test Loss: 27.138 Test Acc: 0.520
Validation loss decreased (-0.340678 --> -0.519960).  Saving model ...
Epoch: 3 cost time: 6.066059350967407
Epoch: 3, Steps: 34 | Train Loss: 37.668 Vali Loss: 86.072 Vali Acc: 0.272 Test Loss: 86.072 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.750922441482544
Epoch: 4, Steps: 34 | Train Loss: 52.113 Vali Loss: 60.329 Vali Acc: 0.543 Test Loss: 60.329 Test Acc: 0.543
Validation loss decreased (-0.519960 --> -0.542749).  Saving model ...
Epoch: 5 cost time: 6.983422040939331
Epoch: 5, Steps: 34 | Train Loss: 40.818 Vali Loss: 89.151 Vali Acc: 0.561 Test Loss: 89.151 Test Acc: 0.561
Validation loss decreased (-0.542749 --> -0.559802).  Saving model ...
Epoch: 6 cost time: 6.4334094524383545
Epoch: 6, Steps: 34 | Train Loss: 50.398 Vali Loss: 37.240 Vali Acc: 0.486 Test Loss: 37.240 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.868964195251465
Epoch: 7, Steps: 34 | Train Loss: 29.917 Vali Loss: 52.206 Vali Acc: 0.636 Test Loss: 52.206 Test Acc: 0.636
Validation loss decreased (-0.559802 --> -0.635316).  Saving model ...
Epoch: 8 cost time: 5.461432933807373
Epoch: 8, Steps: 34 | Train Loss: 50.960 Vali Loss: 76.849 Vali Acc: 0.468 Test Loss: 76.849 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.6148741245269775
Epoch: 9, Steps: 34 | Train Loss: 20.117 Vali Loss: 40.626 Vali Acc: 0.751 Test Loss: 40.626 Test Acc: 0.751
Validation loss decreased (-0.635316 --> -0.751039).  Saving model ...
Epoch: 10 cost time: 5.977950096130371
Epoch: 10, Steps: 34 | Train Loss: 37.182 Vali Loss: 45.055 Vali Acc: 0.705 Test Loss: 45.055 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.093449592590332
Epoch: 11, Steps: 34 | Train Loss: 21.205 Vali Loss: 33.749 Vali Acc: 0.682 Test Loss: 33.749 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.508565902709961
Epoch: 12, Steps: 34 | Train Loss: 25.606 Vali Loss: 45.625 Vali Acc: 0.590 Test Loss: 45.625 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.175821781158447
Epoch: 13, Steps: 34 | Train Loss: 9.820 Vali Loss: 63.404 Vali Acc: 0.607 Test Loss: 63.404 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.335104942321777
Epoch: 14, Steps: 34 | Train Loss: 15.128 Vali Loss: 46.657 Vali Acc: 0.740 Test Loss: 46.657 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.4099953174591064
Epoch: 15, Steps: 34 | Train Loss: 28.523 Vali Loss: 67.657 Vali Acc: 0.572 Test Loss: 67.657 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.4341254234313965
Epoch: 16, Steps: 34 | Train Loss: 12.514 Vali Loss: 63.951 Vali Acc: 0.671 Test Loss: 63.951 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.467145919799805
Epoch: 17, Steps: 34 | Train Loss: 3.667 Vali Loss: 29.428 Vali Acc: 0.798 Test Loss: 29.428 Test Acc: 0.798
Validation loss decreased (-0.751039 --> -0.797394).  Saving model ...
Epoch: 18 cost time: 6.3836681842803955
Epoch: 18, Steps: 34 | Train Loss: 5.597 Vali Loss: 29.546 Vali Acc: 0.780 Test Loss: 29.546 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.3314337730407715
Epoch: 19, Steps: 34 | Train Loss: 8.039 Vali Loss: 81.574 Vali Acc: 0.671 Test Loss: 81.574 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.623248338699341
Epoch: 20, Steps: 34 | Train Loss: 11.080 Vali Loss: 67.238 Vali Acc: 0.711 Test Loss: 67.238 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.74423623085022
Epoch: 21, Steps: 34 | Train Loss: 12.224 Vali Loss: 83.931 Vali Acc: 0.642 Test Loss: 83.931 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.730768918991089
Epoch: 22, Steps: 34 | Train Loss: 6.080 Vali Loss: 63.676 Vali Acc: 0.688 Test Loss: 63.676 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.549766302108765
Epoch: 23, Steps: 34 | Train Loss: 5.517 Vali Loss: 73.446 Vali Acc: 0.671 Test Loss: 73.446 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.672362327575684
Epoch: 24, Steps: 34 | Train Loss: 4.123 Vali Loss: 39.238 Vali Acc: 0.786 Test Loss: 39.238 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.551865816116333
Epoch: 25, Steps: 34 | Train Loss: 3.461 Vali Loss: 49.228 Vali Acc: 0.803 Test Loss: 49.228 Test Acc: 0.803
Validation loss decreased (-0.797394 --> -0.802976).  Saving model ...
Epoch: 26 cost time: 6.49136757850647
Epoch: 26, Steps: 34 | Train Loss: 3.236 Vali Loss: 37.769 Vali Acc: 0.763 Test Loss: 37.769 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.376352787017822
Epoch: 27, Steps: 34 | Train Loss: 2.866 Vali Loss: 51.022 Vali Acc: 0.775 Test Loss: 51.022 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.460949182510376
Epoch: 28, Steps: 34 | Train Loss: 1.142 Vali Loss: 101.538 Vali Acc: 0.642 Test Loss: 101.538 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.541732549667358
Epoch: 29, Steps: 34 | Train Loss: 3.530 Vali Loss: 51.446 Vali Acc: 0.728 Test Loss: 51.446 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.509317398071289
Epoch: 30, Steps: 34 | Train Loss: 0.836 Vali Loss: 42.642 Vali Acc: 0.780 Test Loss: 42.642 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.6183295249938965
Epoch: 31, Steps: 34 | Train Loss: 3.525 Vali Loss: 91.814 Vali Acc: 0.769 Test Loss: 91.814 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.4475257396698
Epoch: 32, Steps: 34 | Train Loss: 6.292 Vali Loss: 68.449 Vali Acc: 0.775 Test Loss: 68.449 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.533464670181274
Epoch: 33, Steps: 34 | Train Loss: 4.475 Vali Loss: 46.666 Vali Acc: 0.827 Test Loss: 46.666 Test Acc: 0.827
Validation loss decreased (-0.802976 --> -0.826123).  Saving model ...
Epoch: 34 cost time: 6.567823171615601
Epoch: 34, Steps: 34 | Train Loss: 2.151 Vali Loss: 62.267 Vali Acc: 0.740 Test Loss: 62.267 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.467355489730835
Epoch: 35, Steps: 34 | Train Loss: 2.106 Vali Loss: 42.755 Vali Acc: 0.809 Test Loss: 42.755 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.414658308029175
Epoch: 36, Steps: 34 | Train Loss: 0.618 Vali Loss: 83.113 Vali Acc: 0.792 Test Loss: 83.113 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.438287734985352
Epoch: 37, Steps: 34 | Train Loss: 2.308 Vali Loss: 61.455 Vali Acc: 0.809 Test Loss: 61.455 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 6.12297797203064
Epoch: 38, Steps: 34 | Train Loss: 1.443 Vali Loss: 32.927 Vali Acc: 0.832 Test Loss: 32.927 Test Acc: 0.832
Validation loss decreased (-0.826123 --> -0.832041).  Saving model ...
Epoch: 39 cost time: 6.485641002655029
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 36.438 Vali Acc: 0.844 Test Loss: 36.438 Test Acc: 0.844
Validation loss decreased (-0.832041 --> -0.843566).  Saving model ...
Epoch: 40 cost time: 6.279077529907227
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.611 Vali Acc: 0.838 Test Loss: 33.611 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.664308309555054
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.229 Vali Acc: 0.838 Test Loss: 33.229 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.424898624420166
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.400212287902832
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.295431137084961
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.459826469421387
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.3194191455841064
Epoch: 46, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.3694188594818115
Epoch: 47, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.276335000991821
Epoch: 48, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 6.317420721054077
Epoch: 49, Steps: 34 | Train Loss: 0.000 Vali Loss: 33.218 Vali Acc: 0.838 Test Loss: 33.218 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 12834591
model size : 51.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.552505970001221
Epoch: 1, Steps: 34 | Train Loss: 20.058 Vali Loss: 19.865 Vali Acc: 0.202 Test Loss: 19.865 Test Acc: 0.202
Validation loss decreased (inf --> -0.202113).  Saving model ...
Epoch: 2 cost time: 6.216854095458984
Epoch: 2, Steps: 34 | Train Loss: 45.191 Vali Loss: 45.425 Vali Acc: 0.462 Test Loss: 45.425 Test Acc: 0.462
Validation loss decreased (-0.202113 --> -0.461973).  Saving model ...
Epoch: 3 cost time: 6.224335432052612
Epoch: 3, Steps: 34 | Train Loss: 44.315 Vali Loss: 75.263 Vali Acc: 0.462 Test Loss: 75.263 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.36470890045166
Epoch: 4, Steps: 34 | Train Loss: 47.434 Vali Loss: 63.477 Vali Acc: 0.416 Test Loss: 63.477 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.3995373249053955
Epoch: 5, Steps: 34 | Train Loss: 60.823 Vali Loss: 84.280 Vali Acc: 0.520 Test Loss: 84.280 Test Acc: 0.520
Validation loss decreased (-0.461973 --> -0.519388).  Saving model ...
Epoch: 6 cost time: 6.551462888717651
Epoch: 6, Steps: 34 | Train Loss: 67.453 Vali Loss: 32.104 Vali Acc: 0.647 Test Loss: 32.104 Test Acc: 0.647
Validation loss decreased (-0.519388 --> -0.647078).  Saving model ...
Epoch: 7 cost time: 5.981024503707886
Epoch: 7, Steps: 34 | Train Loss: 40.699 Vali Loss: 61.959 Vali Acc: 0.584 Test Loss: 61.959 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.404736280441284
Epoch: 8, Steps: 34 | Train Loss: 29.224 Vali Loss: 96.898 Vali Acc: 0.659 Test Loss: 96.898 Test Acc: 0.659
Validation loss decreased (-0.647078 --> -0.657991).  Saving model ...
Epoch: 9 cost time: 6.557253122329712
Epoch: 9, Steps: 34 | Train Loss: 50.304 Vali Loss: 27.096 Vali Acc: 0.769 Test Loss: 27.096 Test Acc: 0.769
Validation loss decreased (-0.657991 --> -0.768515).  Saving model ...
Epoch: 10 cost time: 6.2042553424835205
Epoch: 10, Steps: 34 | Train Loss: 28.627 Vali Loss: 22.072 Vali Acc: 0.746 Test Loss: 22.072 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.479883193969727
Epoch: 11, Steps: 34 | Train Loss: 17.170 Vali Loss: 49.117 Vali Acc: 0.630 Test Loss: 49.117 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.280534267425537
Epoch: 12, Steps: 34 | Train Loss: 7.707 Vali Loss: 51.617 Vali Acc: 0.613 Test Loss: 51.617 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.356827974319458
Epoch: 13, Steps: 34 | Train Loss: 15.035 Vali Loss: 43.219 Vali Acc: 0.653 Test Loss: 43.219 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.185023546218872
Epoch: 14, Steps: 34 | Train Loss: 18.524 Vali Loss: 53.848 Vali Acc: 0.636 Test Loss: 53.848 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.227211952209473
Epoch: 15, Steps: 34 | Train Loss: 20.206 Vali Loss: 83.650 Vali Acc: 0.630 Test Loss: 83.650 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.182156801223755
Epoch: 16, Steps: 34 | Train Loss: 17.954 Vali Loss: 68.169 Vali Acc: 0.653 Test Loss: 68.169 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.020730018615723
Epoch: 17, Steps: 34 | Train Loss: 8.266 Vali Loss: 33.753 Vali Acc: 0.723 Test Loss: 33.753 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.281465530395508
Epoch: 18, Steps: 34 | Train Loss: 5.612 Vali Loss: 51.155 Vali Acc: 0.711 Test Loss: 51.155 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.352683067321777
Epoch: 19, Steps: 34 | Train Loss: 14.547 Vali Loss: 52.412 Vali Acc: 0.792 Test Loss: 52.412 Test Acc: 0.792
Validation loss decreased (-0.768515 --> -0.791383).  Saving model ...
Epoch: 20 cost time: 6.183098077774048
Epoch: 20, Steps: 34 | Train Loss: 11.660 Vali Loss: 76.036 Vali Acc: 0.665 Test Loss: 76.036 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.230715990066528
Epoch: 21, Steps: 34 | Train Loss: 12.139 Vali Loss: 77.077 Vali Acc: 0.734 Test Loss: 77.077 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.227186441421509
Epoch: 22, Steps: 34 | Train Loss: 9.669 Vali Loss: 32.373 Vali Acc: 0.809 Test Loss: 32.373 Test Acc: 0.809
Validation loss decreased (-0.791383 --> -0.808925).  Saving model ...
Epoch: 23 cost time: 6.135029077529907
Epoch: 23, Steps: 34 | Train Loss: 6.223 Vali Loss: 64.854 Vali Acc: 0.694 Test Loss: 64.854 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.41433310508728
Epoch: 24, Steps: 34 | Train Loss: 1.502 Vali Loss: 49.984 Vali Acc: 0.780 Test Loss: 49.984 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.429660797119141
Epoch: 25, Steps: 34 | Train Loss: 2.745 Vali Loss: 82.720 Vali Acc: 0.671 Test Loss: 82.720 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.367751359939575
Epoch: 26, Steps: 34 | Train Loss: 7.537 Vali Loss: 83.170 Vali Acc: 0.688 Test Loss: 83.170 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.394532680511475
Epoch: 27, Steps: 34 | Train Loss: 3.246 Vali Loss: 32.345 Vali Acc: 0.838 Test Loss: 32.345 Test Acc: 0.838
Validation loss decreased (-0.808925 --> -0.837827).  Saving model ...
Epoch: 28 cost time: 6.203519105911255
Epoch: 28, Steps: 34 | Train Loss: 1.211 Vali Loss: 44.466 Vali Acc: 0.815 Test Loss: 44.466 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.343634366989136
Epoch: 29, Steps: 34 | Train Loss: 1.521 Vali Loss: 75.421 Vali Acc: 0.769 Test Loss: 75.421 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.2983458042144775
Epoch: 30, Steps: 34 | Train Loss: 5.256 Vali Loss: 23.788 Vali Acc: 0.867 Test Loss: 23.788 Test Acc: 0.867
Validation loss decreased (-0.837827 --> -0.866814).  Saving model ...
Epoch: 31 cost time: 6.186113595962524
Epoch: 31, Steps: 34 | Train Loss: 6.082 Vali Loss: 44.079 Vali Acc: 0.838 Test Loss: 44.079 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.096815586090088
Epoch: 32, Steps: 34 | Train Loss: 4.649 Vali Loss: 62.818 Vali Acc: 0.751 Test Loss: 62.818 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.174439907073975
Epoch: 33, Steps: 34 | Train Loss: 1.567 Vali Loss: 54.996 Vali Acc: 0.734 Test Loss: 54.996 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.56375789642334
Epoch: 34, Steps: 34 | Train Loss: 1.325 Vali Loss: 47.392 Vali Acc: 0.775 Test Loss: 47.392 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.296960830688477
Epoch: 35, Steps: 34 | Train Loss: 3.836 Vali Loss: 27.546 Vali Acc: 0.769 Test Loss: 27.546 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.330968618392944
Epoch: 36, Steps: 34 | Train Loss: 1.745 Vali Loss: 58.643 Vali Acc: 0.740 Test Loss: 58.643 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.418821096420288
Epoch: 37, Steps: 34 | Train Loss: 0.794 Vali Loss: 43.155 Vali Acc: 0.780 Test Loss: 43.155 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 5.992143869400024
Epoch: 38, Steps: 34 | Train Loss: 0.432 Vali Loss: 48.273 Vali Acc: 0.757 Test Loss: 48.273 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.382947206497192
Epoch: 39, Steps: 34 | Train Loss: 4.857 Vali Loss: 77.306 Vali Acc: 0.717 Test Loss: 77.306 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.323472738265991
Epoch: 40, Steps: 34 | Train Loss: 1.857 Vali Loss: 73.320 Vali Acc: 0.740 Test Loss: 73.320 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 12740511
model size : 51.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.183380126953125
Epoch: 1, Steps: 34 | Train Loss: 24.551 Vali Loss: 45.591 Vali Acc: 0.249 Test Loss: 45.591 Test Acc: 0.249
Validation loss decreased (inf --> -0.248099).  Saving model ...
Epoch: 2 cost time: 5.992279529571533
Epoch: 2, Steps: 34 | Train Loss: 50.526 Vali Loss: 34.134 Vali Acc: 0.283 Test Loss: 34.134 Test Acc: 0.283
Validation loss decreased (-0.248099 --> -0.282896).  Saving model ...
Epoch: 3 cost time: 6.07536768913269
Epoch: 3, Steps: 34 | Train Loss: 37.488 Vali Loss: 63.640 Vali Acc: 0.451 Test Loss: 63.640 Test Acc: 0.451
Validation loss decreased (-0.282896 --> -0.450231).  Saving model ...
Epoch: 4 cost time: 6.185884237289429
Epoch: 4, Steps: 34 | Train Loss: 40.342 Vali Loss: 71.621 Vali Acc: 0.509 Test Loss: 71.621 Test Acc: 0.509
Validation loss decreased (-0.450231 --> -0.507954).  Saving model ...
Epoch: 5 cost time: 5.903935194015503
Epoch: 5, Steps: 34 | Train Loss: 32.588 Vali Loss: 57.270 Vali Acc: 0.497 Test Loss: 57.270 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.583605527877808
Epoch: 6, Steps: 34 | Train Loss: 33.732 Vali Loss: 63.526 Vali Acc: 0.595 Test Loss: 63.526 Test Acc: 0.595
Validation loss decreased (-0.507954 --> -0.594740).  Saving model ...
Epoch: 7 cost time: 6.0312371253967285
Epoch: 7, Steps: 34 | Train Loss: 23.509 Vali Loss: 28.455 Vali Acc: 0.636 Test Loss: 28.455 Test Acc: 0.636
Validation loss decreased (-0.594740 --> -0.635554).  Saving model ...
Epoch: 8 cost time: 6.400148391723633
Epoch: 8, Steps: 34 | Train Loss: 51.059 Vali Loss: 112.102 Vali Acc: 0.601 Test Loss: 112.102 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.095530271530151
Epoch: 9, Steps: 34 | Train Loss: 41.206 Vali Loss: 24.748 Vali Acc: 0.757 Test Loss: 24.748 Test Acc: 0.757
Validation loss decreased (-0.635554 --> -0.756978).  Saving model ...
Epoch: 10 cost time: 6.114044904708862
Epoch: 10, Steps: 34 | Train Loss: 34.988 Vali Loss: 35.700 Vali Acc: 0.636 Test Loss: 35.700 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.243148326873779
Epoch: 11, Steps: 34 | Train Loss: 26.923 Vali Loss: 59.667 Vali Acc: 0.578 Test Loss: 59.667 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.381829261779785
Epoch: 12, Steps: 34 | Train Loss: 16.337 Vali Loss: 50.302 Vali Acc: 0.624 Test Loss: 50.302 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.390212535858154
Epoch: 13, Steps: 34 | Train Loss: 14.548 Vali Loss: 42.028 Vali Acc: 0.711 Test Loss: 42.028 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.079733371734619
Epoch: 14, Steps: 34 | Train Loss: 7.797 Vali Loss: 55.146 Vali Acc: 0.734 Test Loss: 55.146 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.114924430847168
Epoch: 15, Steps: 34 | Train Loss: 6.037 Vali Loss: 28.570 Vali Acc: 0.757 Test Loss: 28.570 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.874614477157593
Epoch: 16, Steps: 34 | Train Loss: 1.251 Vali Loss: 27.648 Vali Acc: 0.809 Test Loss: 27.648 Test Acc: 0.809
Validation loss decreased (-0.756978 --> -0.808972).  Saving model ...
Epoch: 17 cost time: 6.150870084762573
Epoch: 17, Steps: 34 | Train Loss: 24.797 Vali Loss: 49.838 Vali Acc: 0.676 Test Loss: 49.838 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.9893224239349365
Epoch: 18, Steps: 34 | Train Loss: 16.497 Vali Loss: 39.885 Vali Acc: 0.780 Test Loss: 39.885 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.202648401260376
Epoch: 19, Steps: 34 | Train Loss: 4.837 Vali Loss: 49.834 Vali Acc: 0.728 Test Loss: 49.834 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.0885725021362305
Epoch: 20, Steps: 34 | Train Loss: 13.088 Vali Loss: 57.336 Vali Acc: 0.763 Test Loss: 57.336 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.266036033630371
Epoch: 21, Steps: 34 | Train Loss: 1.152 Vali Loss: 33.173 Vali Acc: 0.803 Test Loss: 33.173 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.249511480331421
Epoch: 22, Steps: 34 | Train Loss: 5.896 Vali Loss: 96.192 Vali Acc: 0.653 Test Loss: 96.192 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.188295602798462
Epoch: 23, Steps: 34 | Train Loss: 11.357 Vali Loss: 51.428 Vali Acc: 0.803 Test Loss: 51.428 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.138701438903809
Epoch: 24, Steps: 34 | Train Loss: 2.670 Vali Loss: 48.809 Vali Acc: 0.769 Test Loss: 48.809 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.326718330383301
Epoch: 25, Steps: 34 | Train Loss: 9.456 Vali Loss: 66.645 Vali Acc: 0.751 Test Loss: 66.645 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.028440237045288
Epoch: 26, Steps: 34 | Train Loss: 4.236 Vali Loss: 41.729 Vali Acc: 0.809 Test Loss: 41.729 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 12738975
model size : 51.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.163241386413574
Epoch: 1, Steps: 34 | Train Loss: 21.682 Vali Loss: 27.907 Vali Acc: 0.358 Test Loss: 27.907 Test Acc: 0.358
Validation loss decreased (inf --> -0.358102).  Saving model ...
Epoch: 2 cost time: 5.9428863525390625
Epoch: 2, Steps: 34 | Train Loss: 38.635 Vali Loss: 64.972 Vali Acc: 0.364 Test Loss: 64.972 Test Acc: 0.364
Validation loss decreased (-0.358102 --> -0.363512).  Saving model ...
Epoch: 3 cost time: 6.22150444984436
Epoch: 3, Steps: 34 | Train Loss: 49.212 Vali Loss: 86.770 Vali Acc: 0.306 Test Loss: 86.770 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.2286696434021
Epoch: 4, Steps: 34 | Train Loss: 75.158 Vali Loss: 74.436 Vali Acc: 0.416 Test Loss: 74.436 Test Acc: 0.416
Validation loss decreased (-0.363512 --> -0.415441).  Saving model ...
Epoch: 5 cost time: 6.140186309814453
Epoch: 5, Steps: 34 | Train Loss: 56.108 Vali Loss: 57.636 Vali Acc: 0.613 Test Loss: 57.636 Test Acc: 0.613
Validation loss decreased (-0.415441 --> -0.612140).  Saving model ...
Epoch: 6 cost time: 6.365878582000732
Epoch: 6, Steps: 34 | Train Loss: 52.214 Vali Loss: 51.595 Vali Acc: 0.630 Test Loss: 51.595 Test Acc: 0.630
Validation loss decreased (-0.612140 --> -0.629542).  Saving model ...
Epoch: 7 cost time: 6.180769920349121
Epoch: 7, Steps: 34 | Train Loss: 31.074 Vali Loss: 82.083 Vali Acc: 0.491 Test Loss: 82.083 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.477165937423706
Epoch: 8, Steps: 34 | Train Loss: 24.327 Vali Loss: 45.047 Vali Acc: 0.578 Test Loss: 45.047 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.741550922393799
Epoch: 9, Steps: 34 | Train Loss: 33.866 Vali Loss: 59.549 Vali Acc: 0.434 Test Loss: 59.549 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.440013885498047
Epoch: 10, Steps: 34 | Train Loss: 39.611 Vali Loss: 104.588 Vali Acc: 0.769 Test Loss: 104.588 Test Acc: 0.769
Validation loss decreased (-0.629542 --> -0.767740).  Saving model ...
Epoch: 11 cost time: 6.444874048233032
Epoch: 11, Steps: 34 | Train Loss: 20.149 Vali Loss: 55.417 Vali Acc: 0.618 Test Loss: 55.417 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.595583438873291
Epoch: 12, Steps: 34 | Train Loss: 14.478 Vali Loss: 116.440 Vali Acc: 0.382 Test Loss: 116.440 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.283437013626099
Epoch: 13, Steps: 34 | Train Loss: 13.137 Vali Loss: 35.239 Vali Acc: 0.751 Test Loss: 35.239 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.146595239639282
Epoch: 14, Steps: 34 | Train Loss: 13.604 Vali Loss: 39.929 Vali Acc: 0.659 Test Loss: 39.929 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.798249959945679
Epoch: 15, Steps: 34 | Train Loss: 1.718 Vali Loss: 43.639 Vali Acc: 0.688 Test Loss: 43.639 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.358268976211548
Epoch: 16, Steps: 34 | Train Loss: 13.226 Vali Loss: 85.622 Vali Acc: 0.543 Test Loss: 85.622 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.4361512660980225
Epoch: 17, Steps: 34 | Train Loss: 6.078 Vali Loss: 30.498 Vali Acc: 0.740 Test Loss: 30.498 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.679284572601318
Epoch: 18, Steps: 34 | Train Loss: 13.355 Vali Loss: 71.931 Vali Acc: 0.717 Test Loss: 71.931 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.49361515045166
Epoch: 19, Steps: 34 | Train Loss: 5.893 Vali Loss: 76.960 Vali Acc: 0.630 Test Loss: 76.960 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.643655300140381
Epoch: 20, Steps: 34 | Train Loss: 9.674 Vali Loss: 66.693 Vali Acc: 0.751 Test Loss: 66.693 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 12737439
model size : 51.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.7535319328308105
Epoch: 1, Steps: 34 | Train Loss: 18.746 Vali Loss: 23.217 Vali Acc: 0.306 Test Loss: 23.217 Test Acc: 0.306
Validation loss decreased (inf --> -0.306126).  Saving model ...
Epoch: 2 cost time: 5.758448600769043
Epoch: 2, Steps: 34 | Train Loss: 26.861 Vali Loss: 41.376 Vali Acc: 0.306 Test Loss: 41.376 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.502930164337158
Epoch: 3, Steps: 34 | Train Loss: 44.367 Vali Loss: 41.320 Vali Acc: 0.514 Test Loss: 41.320 Test Acc: 0.514
Validation loss decreased (-0.306126 --> -0.514038).  Saving model ...
Epoch: 4 cost time: 5.851164817810059
Epoch: 4, Steps: 34 | Train Loss: 33.388 Vali Loss: 31.978 Vali Acc: 0.538 Test Loss: 31.978 Test Acc: 0.538
Validation loss decreased (-0.514038 --> -0.537252).  Saving model ...
Epoch: 5 cost time: 5.948739528656006
Epoch: 5, Steps: 34 | Train Loss: 23.812 Vali Loss: 17.951 Vali Acc: 0.659 Test Loss: 17.951 Test Acc: 0.659
Validation loss decreased (-0.537252 --> -0.658780).  Saving model ...
Epoch: 6 cost time: 5.614075660705566
Epoch: 6, Steps: 34 | Train Loss: 45.929 Vali Loss: 43.447 Vali Acc: 0.624 Test Loss: 43.447 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.081012964248657
Epoch: 7, Steps: 34 | Train Loss: 54.710 Vali Loss: 39.179 Vali Acc: 0.613 Test Loss: 39.179 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.651775360107422
Epoch: 8, Steps: 34 | Train Loss: 10.370 Vali Loss: 77.211 Vali Acc: 0.474 Test Loss: 77.211 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.892150163650513
Epoch: 9, Steps: 34 | Train Loss: 24.560 Vali Loss: 64.089 Vali Acc: 0.630 Test Loss: 64.089 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.211300849914551
Epoch: 10, Steps: 34 | Train Loss: 38.205 Vali Loss: 42.813 Vali Acc: 0.665 Test Loss: 42.813 Test Acc: 0.665
Validation loss decreased (-0.658780 --> -0.664312).  Saving model ...
Epoch: 11 cost time: 6.305636644363403
Epoch: 11, Steps: 34 | Train Loss: 17.001 Vali Loss: 41.297 Vali Acc: 0.653 Test Loss: 41.297 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.1187965869903564
Epoch: 12, Steps: 34 | Train Loss: 31.970 Vali Loss: 200.951 Vali Acc: 0.439 Test Loss: 200.951 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.1862123012542725
Epoch: 13, Steps: 34 | Train Loss: 28.399 Vali Loss: 31.246 Vali Acc: 0.792 Test Loss: 31.246 Test Acc: 0.792
Validation loss decreased (-0.664312 --> -0.791595).  Saving model ...
Epoch: 14 cost time: 6.017303466796875
Epoch: 14, Steps: 34 | Train Loss: 25.739 Vali Loss: 75.947 Vali Acc: 0.601 Test Loss: 75.947 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.965681076049805
Epoch: 15, Steps: 34 | Train Loss: 11.547 Vali Loss: 26.586 Vali Acc: 0.838 Test Loss: 26.586 Test Acc: 0.838
Validation loss decreased (-0.791595 --> -0.837884).  Saving model ...
Epoch: 16 cost time: 6.150399208068848
Epoch: 16, Steps: 34 | Train Loss: 7.572 Vali Loss: 48.222 Vali Acc: 0.723 Test Loss: 48.222 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.064516305923462
Epoch: 17, Steps: 34 | Train Loss: 9.686 Vali Loss: 31.501 Vali Acc: 0.844 Test Loss: 31.501 Test Acc: 0.844
Validation loss decreased (-0.837884 --> -0.843616).  Saving model ...
Epoch: 18 cost time: 6.207457542419434
Epoch: 18, Steps: 34 | Train Loss: 6.833 Vali Loss: 54.405 Vali Acc: 0.746 Test Loss: 54.405 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.18658971786499
Epoch: 19, Steps: 34 | Train Loss: 8.607 Vali Loss: 68.114 Vali Acc: 0.740 Test Loss: 68.114 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.263698101043701
Epoch: 20, Steps: 34 | Train Loss: 4.542 Vali Loss: 23.604 Vali Acc: 0.786 Test Loss: 23.604 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.345568418502808
Epoch: 21, Steps: 34 | Train Loss: 1.943 Vali Loss: 37.932 Vali Acc: 0.803 Test Loss: 37.932 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.982053756713867
Epoch: 22, Steps: 34 | Train Loss: 1.045 Vali Loss: 21.475 Vali Acc: 0.844 Test Loss: 21.475 Test Acc: 0.844
Validation loss decreased (-0.843616 --> -0.843716).  Saving model ...
Epoch: 23 cost time: 5.947338342666626
Epoch: 23, Steps: 34 | Train Loss: 7.030 Vali Loss: 55.186 Vali Acc: 0.763 Test Loss: 55.186 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.909087181091309
Epoch: 24, Steps: 34 | Train Loss: 4.550 Vali Loss: 62.526 Vali Acc: 0.694 Test Loss: 62.526 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.022731065750122
Epoch: 25, Steps: 34 | Train Loss: 2.156 Vali Loss: 44.196 Vali Acc: 0.792 Test Loss: 44.196 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.121371030807495
Epoch: 26, Steps: 34 | Train Loss: 1.007 Vali Loss: 19.674 Vali Acc: 0.867 Test Loss: 19.674 Test Acc: 0.867
Validation loss decreased (-0.843716 --> -0.866855).  Saving model ...
Epoch: 27 cost time: 5.93303370475769
Epoch: 27, Steps: 34 | Train Loss: 0.328 Vali Loss: 28.790 Vali Acc: 0.838 Test Loss: 28.790 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.130969762802124
Epoch: 28, Steps: 34 | Train Loss: 2.584 Vali Loss: 43.186 Vali Acc: 0.792 Test Loss: 43.186 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.890484809875488
Epoch: 29, Steps: 34 | Train Loss: 2.179 Vali Loss: 27.985 Vali Acc: 0.815 Test Loss: 27.985 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.081889867782593
Epoch: 30, Steps: 34 | Train Loss: 6.106 Vali Loss: 78.224 Vali Acc: 0.694 Test Loss: 78.224 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.153201580047607
Epoch: 31, Steps: 34 | Train Loss: 6.919 Vali Loss: 48.989 Vali Acc: 0.694 Test Loss: 48.989 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.7499916553497314
Epoch: 32, Steps: 34 | Train Loss: 1.452 Vali Loss: 91.377 Vali Acc: 0.694 Test Loss: 91.377 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.30693507194519
Epoch: 33, Steps: 34 | Train Loss: 3.949 Vali Loss: 58.288 Vali Acc: 0.711 Test Loss: 58.288 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.17716121673584
Epoch: 34, Steps: 34 | Train Loss: 4.083 Vali Loss: 49.076 Vali Acc: 0.832 Test Loss: 49.076 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.965348482131958
Epoch: 35, Steps: 34 | Train Loss: 1.439 Vali Loss: 49.215 Vali Acc: 0.815 Test Loss: 49.215 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.100709676742554
Epoch: 36, Steps: 34 | Train Loss: 2.998 Vali Loss: 78.731 Vali Acc: 0.780 Test Loss: 78.731 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 12735903
model size : 51.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.80418062210083
Epoch: 1, Steps: 34 | Train Loss: 12.731 Vali Loss: 22.474 Vali Acc: 0.364 Test Loss: 22.474 Test Acc: 0.364
Validation loss decreased (inf --> -0.363937).  Saving model ...
Epoch: 2 cost time: 5.329458236694336
Epoch: 2, Steps: 34 | Train Loss: 16.997 Vali Loss: 16.093 Vali Acc: 0.491 Test Loss: 16.093 Test Acc: 0.491
Validation loss decreased (-0.363937 --> -0.491169).  Saving model ...
Epoch: 3 cost time: 5.152255296707153
Epoch: 3, Steps: 34 | Train Loss: 21.778 Vali Loss: 34.482 Vali Acc: 0.451 Test Loss: 34.482 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.288784742355347
Epoch: 4, Steps: 34 | Train Loss: 19.397 Vali Loss: 55.160 Vali Acc: 0.277 Test Loss: 55.160 Test Acc: 0.277
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.448549509048462
Epoch: 5, Steps: 34 | Train Loss: 22.167 Vali Loss: 21.865 Vali Acc: 0.653 Test Loss: 21.865 Test Acc: 0.653
Validation loss decreased (-0.491169 --> -0.652961).  Saving model ...
Epoch: 6 cost time: 5.557733535766602
Epoch: 6, Steps: 34 | Train Loss: 19.247 Vali Loss: 17.473 Vali Acc: 0.659 Test Loss: 17.473 Test Acc: 0.659
Validation loss decreased (-0.652961 --> -0.658785).  Saving model ...
Epoch: 7 cost time: 5.328466176986694
Epoch: 7, Steps: 34 | Train Loss: 29.513 Vali Loss: 61.831 Vali Acc: 0.607 Test Loss: 61.831 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.296614170074463
Epoch: 8, Steps: 34 | Train Loss: 25.916 Vali Loss: 32.922 Vali Acc: 0.601 Test Loss: 32.922 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.328559637069702
Epoch: 9, Steps: 34 | Train Loss: 12.419 Vali Loss: 22.315 Vali Acc: 0.653 Test Loss: 22.315 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.254678249359131
Epoch: 10, Steps: 34 | Train Loss: 8.367 Vali Loss: 17.755 Vali Acc: 0.694 Test Loss: 17.755 Test Acc: 0.694
Validation loss decreased (-0.658785 --> -0.693464).  Saving model ...
Epoch: 11 cost time: 5.318907737731934
Epoch: 11, Steps: 34 | Train Loss: 9.092 Vali Loss: 10.758 Vali Acc: 0.792 Test Loss: 10.758 Test Acc: 0.792
Validation loss decreased (-0.693464 --> -0.791800).  Saving model ...
Epoch: 12 cost time: 5.482604026794434
Epoch: 12, Steps: 34 | Train Loss: 2.426 Vali Loss: 8.397 Vali Acc: 0.821 Test Loss: 8.397 Test Acc: 0.821
Validation loss decreased (-0.791800 --> -0.820725).  Saving model ...
Epoch: 13 cost time: 5.317373037338257
Epoch: 13, Steps: 34 | Train Loss: 5.723 Vali Loss: 18.983 Vali Acc: 0.705 Test Loss: 18.983 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.369197130203247
Epoch: 14, Steps: 34 | Train Loss: 6.252 Vali Loss: 33.608 Vali Acc: 0.607 Test Loss: 33.608 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.205317497253418
Epoch: 15, Steps: 34 | Train Loss: 5.288 Vali Loss: 18.598 Vali Acc: 0.798 Test Loss: 18.598 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.397807836532593
Epoch: 16, Steps: 34 | Train Loss: 1.386 Vali Loss: 27.833 Vali Acc: 0.688 Test Loss: 27.833 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.330389738082886
Epoch: 17, Steps: 34 | Train Loss: 3.042 Vali Loss: 11.293 Vali Acc: 0.827 Test Loss: 11.293 Test Acc: 0.827
Validation loss decreased (-0.820725 --> -0.826477).  Saving model ...
Epoch: 18 cost time: 5.191081523895264
Epoch: 18, Steps: 34 | Train Loss: 1.799 Vali Loss: 28.840 Vali Acc: 0.734 Test Loss: 28.840 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.367358922958374
Epoch: 19, Steps: 34 | Train Loss: 1.281 Vali Loss: 15.211 Vali Acc: 0.803 Test Loss: 15.211 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.533242702484131
Epoch: 20, Steps: 34 | Train Loss: 1.276 Vali Loss: 10.531 Vali Acc: 0.803 Test Loss: 10.531 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.29382061958313
Epoch: 21, Steps: 34 | Train Loss: 1.525 Vali Loss: 14.155 Vali Acc: 0.786 Test Loss: 14.155 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.614811897277832
Epoch: 22, Steps: 34 | Train Loss: 0.731 Vali Loss: 11.684 Vali Acc: 0.850 Test Loss: 11.684 Test Acc: 0.850
Validation loss decreased (-0.826477 --> -0.849594).  Saving model ...
Epoch: 23 cost time: 5.410889387130737
Epoch: 23, Steps: 34 | Train Loss: 0.898 Vali Loss: 6.708 Vali Acc: 0.827 Test Loss: 6.708 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.527578830718994
Epoch: 24, Steps: 34 | Train Loss: 1.344 Vali Loss: 27.830 Vali Acc: 0.769 Test Loss: 27.830 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.178222417831421
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 19.527 Vali Acc: 0.786 Test Loss: 19.527 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.149463891983032
Epoch: 26, Steps: 34 | Train Loss: 0.964 Vali Loss: 16.209 Vali Acc: 0.803 Test Loss: 16.209 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.036754131317139
Epoch: 27, Steps: 34 | Train Loss: 3.165 Vali Loss: 23.405 Vali Acc: 0.723 Test Loss: 23.405 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.100268840789795
Epoch: 28, Steps: 34 | Train Loss: 1.644 Vali Loss: 13.525 Vali Acc: 0.769 Test Loss: 13.525 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.386719465255737
Epoch: 29, Steps: 34 | Train Loss: 2.345 Vali Loss: 17.479 Vali Acc: 0.861 Test Loss: 17.479 Test Acc: 0.861
Validation loss decreased (-0.849594 --> -0.861097).  Saving model ...
Epoch: 30 cost time: 5.213259696960449
Epoch: 30, Steps: 34 | Train Loss: 1.827 Vali Loss: 19.003 Vali Acc: 0.775 Test Loss: 19.003 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.418222427368164
Epoch: 31, Steps: 34 | Train Loss: 3.425 Vali Loss: 60.408 Vali Acc: 0.624 Test Loss: 60.408 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.273326635360718
Epoch: 32, Steps: 34 | Train Loss: 8.707 Vali Loss: 31.212 Vali Acc: 0.769 Test Loss: 31.212 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.261476278305054
Epoch: 33, Steps: 34 | Train Loss: 4.842 Vali Loss: 30.844 Vali Acc: 0.688 Test Loss: 30.844 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.525838613510132
Epoch: 34, Steps: 34 | Train Loss: 1.285 Vali Loss: 23.147 Vali Acc: 0.775 Test Loss: 23.147 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.411653757095337
Epoch: 35, Steps: 34 | Train Loss: 0.599 Vali Loss: 16.820 Vali Acc: 0.792 Test Loss: 16.820 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.318533897399902
Epoch: 36, Steps: 34 | Train Loss: 1.185 Vali Loss: 34.450 Vali Acc: 0.746 Test Loss: 34.450 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.403622627258301
Epoch: 37, Steps: 34 | Train Loss: 0.862 Vali Loss: 30.250 Vali Acc: 0.757 Test Loss: 30.250 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.398822069168091
Epoch: 38, Steps: 34 | Train Loss: 0.541 Vali Loss: 20.793 Vali Acc: 0.786 Test Loss: 20.793 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.182513475418091
Epoch: 39, Steps: 34 | Train Loss: 2.000 Vali Loss: 40.260 Vali Acc: 0.642 Test Loss: 40.260 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 6520607
model size : 26.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.983482837677002
Epoch: 1, Steps: 34 | Train Loss: 7.179 Vali Loss: 13.905 Vali Acc: 0.387 Test Loss: 13.905 Test Acc: 0.387
Validation loss decreased (inf --> -0.387144).  Saving model ...
Epoch: 2 cost time: 5.285715818405151
Epoch: 2, Steps: 34 | Train Loss: 14.820 Vali Loss: 22.439 Vali Acc: 0.457 Test Loss: 22.439 Test Acc: 0.457
Validation loss decreased (-0.387144 --> -0.456423).  Saving model ...
Epoch: 3 cost time: 4.965845584869385
Epoch: 3, Steps: 34 | Train Loss: 22.931 Vali Loss: 44.151 Vali Acc: 0.283 Test Loss: 44.151 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.320714473724365
Epoch: 4, Steps: 34 | Train Loss: 31.410 Vali Loss: 22.575 Vali Acc: 0.572 Test Loss: 22.575 Test Acc: 0.572
Validation loss decreased (-0.456423 --> -0.572029).  Saving model ...
Epoch: 5 cost time: 5.473033905029297
Epoch: 5, Steps: 34 | Train Loss: 20.397 Vali Loss: 16.197 Vali Acc: 0.630 Test Loss: 16.197 Test Acc: 0.630
Validation loss decreased (-0.572029 --> -0.629896).  Saving model ...
Epoch: 6 cost time: 5.3959832191467285
Epoch: 6, Steps: 34 | Train Loss: 17.598 Vali Loss: 26.636 Vali Acc: 0.497 Test Loss: 26.636 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.7442848682403564
Epoch: 7, Steps: 34 | Train Loss: 22.965 Vali Loss: 25.456 Vali Acc: 0.595 Test Loss: 25.456 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.439792156219482
Epoch: 8, Steps: 34 | Train Loss: 14.299 Vali Loss: 20.711 Vali Acc: 0.532 Test Loss: 20.711 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.480348825454712
Epoch: 9, Steps: 34 | Train Loss: 7.206 Vali Loss: 10.926 Vali Acc: 0.734 Test Loss: 10.926 Test Acc: 0.734
Validation loss decreased (-0.629896 --> -0.733995).  Saving model ...
Epoch: 10 cost time: 5.399358749389648
Epoch: 10, Steps: 34 | Train Loss: 11.526 Vali Loss: 19.912 Vali Acc: 0.624 Test Loss: 19.912 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.281499147415161
Epoch: 11, Steps: 34 | Train Loss: 6.058 Vali Loss: 19.041 Vali Acc: 0.682 Test Loss: 19.041 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.342865943908691
Epoch: 12, Steps: 34 | Train Loss: 7.836 Vali Loss: 37.050 Vali Acc: 0.595 Test Loss: 37.050 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.711567163467407
Epoch: 13, Steps: 34 | Train Loss: 5.220 Vali Loss: 37.483 Vali Acc: 0.682 Test Loss: 37.483 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.314568758010864
Epoch: 14, Steps: 34 | Train Loss: 4.150 Vali Loss: 27.946 Vali Acc: 0.711 Test Loss: 27.946 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.435741424560547
Epoch: 15, Steps: 34 | Train Loss: 6.168 Vali Loss: 30.043 Vali Acc: 0.688 Test Loss: 30.043 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.768470525741577
Epoch: 16, Steps: 34 | Train Loss: 4.251 Vali Loss: 15.858 Vali Acc: 0.786 Test Loss: 15.858 Test Acc: 0.786
Validation loss decreased (-0.733995 --> -0.785969).  Saving model ...
Epoch: 17 cost time: 5.495782375335693
Epoch: 17, Steps: 34 | Train Loss: 4.338 Vali Loss: 34.766 Vali Acc: 0.618 Test Loss: 34.766 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.642590761184692
Epoch: 18, Steps: 34 | Train Loss: 3.306 Vali Loss: 34.157 Vali Acc: 0.711 Test Loss: 34.157 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.693282127380371
Epoch: 19, Steps: 34 | Train Loss: 7.383 Vali Loss: 24.491 Vali Acc: 0.723 Test Loss: 24.491 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.393275737762451
Epoch: 20, Steps: 34 | Train Loss: 1.466 Vali Loss: 29.960 Vali Acc: 0.751 Test Loss: 29.960 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.4566261768341064
Epoch: 21, Steps: 34 | Train Loss: 2.671 Vali Loss: 27.999 Vali Acc: 0.694 Test Loss: 27.999 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.237685441970825
Epoch: 22, Steps: 34 | Train Loss: 1.212 Vali Loss: 27.844 Vali Acc: 0.728 Test Loss: 27.844 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.294193506240845
Epoch: 23, Steps: 34 | Train Loss: 7.468 Vali Loss: 22.806 Vali Acc: 0.740 Test Loss: 22.806 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.351893186569214
Epoch: 24, Steps: 34 | Train Loss: 1.452 Vali Loss: 12.606 Vali Acc: 0.838 Test Loss: 12.606 Test Acc: 0.838
Validation loss decreased (-0.785969 --> -0.838024).  Saving model ...
Epoch: 25 cost time: 5.367916107177734
Epoch: 25, Steps: 34 | Train Loss: 1.004 Vali Loss: 11.955 Vali Acc: 0.815 Test Loss: 11.955 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.432512283325195
Epoch: 26, Steps: 34 | Train Loss: 1.220 Vali Loss: 32.546 Vali Acc: 0.694 Test Loss: 32.546 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.48675274848938
Epoch: 27, Steps: 34 | Train Loss: 2.299 Vali Loss: 28.936 Vali Acc: 0.740 Test Loss: 28.936 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.278900384902954
Epoch: 28, Steps: 34 | Train Loss: 1.230 Vali Loss: 51.377 Vali Acc: 0.694 Test Loss: 51.377 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.907908916473389
Epoch: 29, Steps: 34 | Train Loss: 3.304 Vali Loss: 17.542 Vali Acc: 0.809 Test Loss: 17.542 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.394615411758423
Epoch: 30, Steps: 34 | Train Loss: 1.647 Vali Loss: 29.426 Vali Acc: 0.780 Test Loss: 29.426 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.578819751739502
Epoch: 31, Steps: 34 | Train Loss: 0.590 Vali Loss: 12.393 Vali Acc: 0.815 Test Loss: 12.393 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.324873685836792
Epoch: 32, Steps: 34 | Train Loss: 0.623 Vali Loss: 10.020 Vali Acc: 0.832 Test Loss: 10.020 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.4535746574401855
Epoch: 33, Steps: 34 | Train Loss: 0.053 Vali Loss: 28.110 Vali Acc: 0.757 Test Loss: 28.110 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.589678764343262
Epoch: 34, Steps: 34 | Train Loss: 1.077 Vali Loss: 18.199 Vali Acc: 0.809 Test Loss: 18.199 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6519839
model size : 26.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.316400051116943
Epoch: 1, Steps: 34 | Train Loss: 10.803 Vali Loss: 12.777 Vali Acc: 0.341 Test Loss: 12.777 Test Acc: 0.341
Validation loss decreased (inf --> -0.340913).  Saving model ...
Epoch: 2 cost time: 5.342158555984497
Epoch: 2, Steps: 34 | Train Loss: 15.938 Vali Loss: 10.967 Vali Acc: 0.434 Test Loss: 10.967 Test Acc: 0.434
Validation loss decreased (-0.340913 --> -0.433416).  Saving model ...
Epoch: 3 cost time: 5.248315334320068
Epoch: 3, Steps: 34 | Train Loss: 12.627 Vali Loss: 12.921 Vali Acc: 0.480 Test Loss: 12.921 Test Acc: 0.480
Validation loss decreased (-0.433416 --> -0.479640).  Saving model ...
Epoch: 4 cost time: 4.958980083465576
Epoch: 4, Steps: 34 | Train Loss: 25.173 Vali Loss: 30.551 Vali Acc: 0.364 Test Loss: 30.551 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.421067237854004
Epoch: 5, Steps: 34 | Train Loss: 26.758 Vali Loss: 30.222 Vali Acc: 0.595 Test Loss: 30.222 Test Acc: 0.595
Validation loss decreased (-0.479640 --> -0.595073).  Saving model ...
Epoch: 6 cost time: 5.391533374786377
Epoch: 6, Steps: 34 | Train Loss: 19.526 Vali Loss: 14.082 Vali Acc: 0.653 Test Loss: 14.082 Test Acc: 0.653
Validation loss decreased (-0.595073 --> -0.653038).  Saving model ...
Epoch: 7 cost time: 5.302931547164917
Epoch: 7, Steps: 34 | Train Loss: 14.760 Vali Loss: 13.463 Vali Acc: 0.665 Test Loss: 13.463 Test Acc: 0.665
Validation loss decreased (-0.653038 --> -0.664605).  Saving model ...
Epoch: 8 cost time: 5.5143632888793945
Epoch: 8, Steps: 34 | Train Loss: 11.261 Vali Loss: 30.085 Vali Acc: 0.543 Test Loss: 30.085 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.263766527175903
Epoch: 9, Steps: 34 | Train Loss: 14.990 Vali Loss: 18.041 Vali Acc: 0.694 Test Loss: 18.041 Test Acc: 0.694
Validation loss decreased (-0.664605 --> -0.693461).  Saving model ...
Epoch: 10 cost time: 5.245599746704102
Epoch: 10, Steps: 34 | Train Loss: 8.302 Vali Loss: 28.855 Vali Acc: 0.590 Test Loss: 28.855 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.358321189880371
Epoch: 11, Steps: 34 | Train Loss: 7.272 Vali Loss: 9.717 Vali Acc: 0.763 Test Loss: 9.717 Test Acc: 0.763
Validation loss decreased (-0.693461 --> -0.762909).  Saving model ...
Epoch: 12 cost time: 5.442612409591675
Epoch: 12, Steps: 34 | Train Loss: 1.629 Vali Loss: 7.906 Vali Acc: 0.815 Test Loss: 7.906 Test Acc: 0.815
Validation loss decreased (-0.762909 --> -0.814950).  Saving model ...
Epoch: 13 cost time: 5.357955694198608
Epoch: 13, Steps: 34 | Train Loss: 3.767 Vali Loss: 25.734 Vali Acc: 0.653 Test Loss: 25.734 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.522253036499023
Epoch: 14, Steps: 34 | Train Loss: 6.418 Vali Loss: 40.270 Vali Acc: 0.595 Test Loss: 40.270 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.6732423305511475
Epoch: 15, Steps: 34 | Train Loss: 2.601 Vali Loss: 13.180 Vali Acc: 0.780 Test Loss: 13.180 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.444924831390381
Epoch: 16, Steps: 34 | Train Loss: 1.896 Vali Loss: 7.756 Vali Acc: 0.861 Test Loss: 7.756 Test Acc: 0.861
Validation loss decreased (-0.814950 --> -0.861194).  Saving model ...
Epoch: 17 cost time: 5.263525485992432
Epoch: 17, Steps: 34 | Train Loss: 2.311 Vali Loss: 20.156 Vali Acc: 0.734 Test Loss: 20.156 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.391567945480347
Epoch: 18, Steps: 34 | Train Loss: 1.215 Vali Loss: 34.144 Vali Acc: 0.671 Test Loss: 34.144 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.3780786991119385
Epoch: 19, Steps: 34 | Train Loss: 3.419 Vali Loss: 10.671 Vali Acc: 0.803 Test Loss: 10.671 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.351341724395752
Epoch: 20, Steps: 34 | Train Loss: 2.135 Vali Loss: 18.991 Vali Acc: 0.746 Test Loss: 18.991 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.5894997119903564
Epoch: 21, Steps: 34 | Train Loss: 3.320 Vali Loss: 18.123 Vali Acc: 0.786 Test Loss: 18.123 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.546265125274658
Epoch: 22, Steps: 34 | Train Loss: 2.639 Vali Loss: 21.436 Vali Acc: 0.757 Test Loss: 21.436 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.207081317901611
Epoch: 23, Steps: 34 | Train Loss: 2.564 Vali Loss: 30.976 Vali Acc: 0.711 Test Loss: 30.976 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.468195199966431
Epoch: 24, Steps: 34 | Train Loss: 1.633 Vali Loss: 20.492 Vali Acc: 0.757 Test Loss: 20.492 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.307290315628052
Epoch: 25, Steps: 34 | Train Loss: 1.032 Vali Loss: 20.834 Vali Acc: 0.757 Test Loss: 20.834 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.302746534347534
Epoch: 26, Steps: 34 | Train Loss: 0.708 Vali Loss: 33.117 Vali Acc: 0.757 Test Loss: 33.117 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 6519071
model size : 26.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.160521507263184
Epoch: 1, Steps: 34 | Train Loss: 10.852 Vali Loss: 12.787 Vali Acc: 0.416 Test Loss: 12.787 Test Acc: 0.416
Validation loss decreased (inf --> -0.416057).  Saving model ...
Epoch: 2 cost time: 5.491800308227539
Epoch: 2, Steps: 34 | Train Loss: 26.298 Vali Loss: 58.332 Vali Acc: 0.324 Test Loss: 58.332 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.415988445281982
Epoch: 3, Steps: 34 | Train Loss: 37.258 Vali Loss: 27.665 Vali Acc: 0.399 Test Loss: 27.665 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.105867385864258
Epoch: 4, Steps: 34 | Train Loss: 27.834 Vali Loss: 29.262 Vali Acc: 0.422 Test Loss: 29.262 Test Acc: 0.422
Validation loss decreased (-0.416057 --> -0.421673).  Saving model ...
Epoch: 5 cost time: 5.482596397399902
Epoch: 5, Steps: 34 | Train Loss: 28.206 Vali Loss: 35.833 Vali Acc: 0.578 Test Loss: 35.833 Test Acc: 0.578
Validation loss decreased (-0.421673 --> -0.577676).  Saving model ...
Epoch: 6 cost time: 5.606804132461548
Epoch: 6, Steps: 34 | Train Loss: 18.359 Vali Loss: 41.095 Vali Acc: 0.497 Test Loss: 41.095 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.347949266433716
Epoch: 7, Steps: 34 | Train Loss: 16.587 Vali Loss: 23.835 Vali Acc: 0.618 Test Loss: 23.835 Test Acc: 0.618
Validation loss decreased (-0.577676 --> -0.618259).  Saving model ...
Epoch: 8 cost time: 5.3242058753967285
Epoch: 8, Steps: 34 | Train Loss: 21.821 Vali Loss: 26.815 Vali Acc: 0.659 Test Loss: 26.815 Test Acc: 0.659
Validation loss decreased (-0.618259 --> -0.658691).  Saving model ...
Epoch: 9 cost time: 5.372894763946533
Epoch: 9, Steps: 34 | Train Loss: 9.809 Vali Loss: 11.062 Vali Acc: 0.688 Test Loss: 11.062 Test Acc: 0.688
Validation loss decreased (-0.658691 --> -0.687751).  Saving model ...
Epoch: 10 cost time: 5.3254148960113525
Epoch: 10, Steps: 34 | Train Loss: 9.048 Vali Loss: 24.755 Vali Acc: 0.555 Test Loss: 24.755 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.512902021408081
Epoch: 11, Steps: 34 | Train Loss: 3.670 Vali Loss: 31.020 Vali Acc: 0.601 Test Loss: 31.020 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.614912033081055
Epoch: 12, Steps: 34 | Train Loss: 6.070 Vali Loss: 15.340 Vali Acc: 0.734 Test Loss: 15.340 Test Acc: 0.734
Validation loss decreased (-0.687751 --> -0.733951).  Saving model ...
Epoch: 13 cost time: 5.5337302684783936
Epoch: 13, Steps: 34 | Train Loss: 4.179 Vali Loss: 6.908 Vali Acc: 0.861 Test Loss: 6.908 Test Acc: 0.861
Validation loss decreased (-0.733951 --> -0.861203).  Saving model ...
Epoch: 14 cost time: 5.400338649749756
Epoch: 14, Steps: 34 | Train Loss: 6.176 Vali Loss: 13.044 Vali Acc: 0.751 Test Loss: 13.044 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.162585020065308
Epoch: 15, Steps: 34 | Train Loss: 4.216 Vali Loss: 16.220 Vali Acc: 0.769 Test Loss: 16.220 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.4167420864105225
Epoch: 16, Steps: 34 | Train Loss: 0.852 Vali Loss: 31.505 Vali Acc: 0.618 Test Loss: 31.505 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.418935775756836
Epoch: 17, Steps: 34 | Train Loss: 1.720 Vali Loss: 18.911 Vali Acc: 0.815 Test Loss: 18.911 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.271345615386963
Epoch: 18, Steps: 34 | Train Loss: 3.723 Vali Loss: 12.360 Vali Acc: 0.827 Test Loss: 12.360 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.525891542434692
Epoch: 19, Steps: 34 | Train Loss: 1.409 Vali Loss: 15.602 Vali Acc: 0.803 Test Loss: 15.602 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.523083686828613
Epoch: 20, Steps: 34 | Train Loss: 1.186 Vali Loss: 13.070 Vali Acc: 0.815 Test Loss: 13.070 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.366382598876953
Epoch: 21, Steps: 34 | Train Loss: 0.468 Vali Loss: 11.258 Vali Acc: 0.798 Test Loss: 11.258 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.5706212520599365
Epoch: 22, Steps: 34 | Train Loss: 2.243 Vali Loss: 18.146 Vali Acc: 0.809 Test Loss: 18.146 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.242815971374512
Epoch: 23, Steps: 34 | Train Loss: 4.165 Vali Loss: 12.459 Vali Acc: 0.838 Test Loss: 12.459 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 6518303
model size : 26.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.903335809707642
Epoch: 1, Steps: 34 | Train Loss: 9.383 Vali Loss: 14.875 Vali Acc: 0.254 Test Loss: 14.875 Test Acc: 0.254
Validation loss decreased (inf --> -0.254187).  Saving model ...
Epoch: 2 cost time: 5.052006721496582
Epoch: 2, Steps: 34 | Train Loss: 21.042 Vali Loss: 18.301 Vali Acc: 0.410 Test Loss: 18.301 Test Acc: 0.410
Validation loss decreased (-0.254187 --> -0.410222).  Saving model ...
Epoch: 3 cost time: 5.213293075561523
Epoch: 3, Steps: 34 | Train Loss: 20.219 Vali Loss: 24.025 Vali Acc: 0.422 Test Loss: 24.025 Test Acc: 0.422
Validation loss decreased (-0.410222 --> -0.421725).  Saving model ...
Epoch: 4 cost time: 5.3588666915893555
Epoch: 4, Steps: 34 | Train Loss: 27.114 Vali Loss: 30.930 Vali Acc: 0.353 Test Loss: 30.930 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.596713066101074
Epoch: 5, Steps: 34 | Train Loss: 17.831 Vali Loss: 11.621 Vali Acc: 0.699 Test Loss: 11.621 Test Acc: 0.699
Validation loss decreased (-0.421725 --> -0.699306).  Saving model ...
Epoch: 6 cost time: 4.872153997421265
Epoch: 6, Steps: 34 | Train Loss: 13.596 Vali Loss: 36.834 Vali Acc: 0.532 Test Loss: 36.834 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.238037824630737
Epoch: 7, Steps: 34 | Train Loss: 25.021 Vali Loss: 63.155 Vali Acc: 0.457 Test Loss: 63.155 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.977952480316162
Epoch: 8, Steps: 34 | Train Loss: 20.014 Vali Loss: 43.904 Vali Acc: 0.486 Test Loss: 43.904 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.131881475448608
Epoch: 9, Steps: 34 | Train Loss: 26.999 Vali Loss: 51.569 Vali Acc: 0.439 Test Loss: 51.569 Test Acc: 0.439
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.819859504699707
Epoch: 10, Steps: 34 | Train Loss: 10.766 Vali Loss: 14.412 Vali Acc: 0.763 Test Loss: 14.412 Test Acc: 0.763
Validation loss decreased (-0.699306 --> -0.762862).  Saving model ...
Epoch: 11 cost time: 4.797095060348511
Epoch: 11, Steps: 34 | Train Loss: 11.174 Vali Loss: 35.730 Vali Acc: 0.642 Test Loss: 35.730 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.9974119663238525
Epoch: 12, Steps: 34 | Train Loss: 9.744 Vali Loss: 20.276 Vali Acc: 0.723 Test Loss: 20.276 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.92207407951355
Epoch: 13, Steps: 34 | Train Loss: 6.741 Vali Loss: 16.756 Vali Acc: 0.740 Test Loss: 16.756 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.382424831390381
Epoch: 14, Steps: 34 | Train Loss: 6.690 Vali Loss: 26.734 Vali Acc: 0.711 Test Loss: 26.734 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.302282810211182
Epoch: 15, Steps: 34 | Train Loss: 8.228 Vali Loss: 20.824 Vali Acc: 0.780 Test Loss: 20.824 Test Acc: 0.780
Validation loss decreased (-0.762862 --> -0.780139).  Saving model ...
Epoch: 16 cost time: 5.033513784408569
Epoch: 16, Steps: 34 | Train Loss: 2.955 Vali Loss: 42.975 Vali Acc: 0.642 Test Loss: 42.975 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.01351261138916
Epoch: 17, Steps: 34 | Train Loss: 5.055 Vali Loss: 14.573 Vali Acc: 0.838 Test Loss: 14.573 Test Acc: 0.838
Validation loss decreased (-0.780139 --> -0.838005).  Saving model ...
Epoch: 18 cost time: 5.021982431411743
Epoch: 18, Steps: 34 | Train Loss: 4.401 Vali Loss: 19.682 Vali Acc: 0.734 Test Loss: 19.682 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.034862995147705
Epoch: 19, Steps: 34 | Train Loss: 3.984 Vali Loss: 40.082 Vali Acc: 0.630 Test Loss: 40.082 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.128904342651367
Epoch: 20, Steps: 34 | Train Loss: 4.746 Vali Loss: 39.485 Vali Acc: 0.630 Test Loss: 39.485 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.069120168685913
Epoch: 21, Steps: 34 | Train Loss: 9.427 Vali Loss: 20.963 Vali Acc: 0.803 Test Loss: 20.963 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.060183763504028
Epoch: 22, Steps: 34 | Train Loss: 2.903 Vali Loss: 41.595 Vali Acc: 0.694 Test Loss: 41.595 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.981715679168701
Epoch: 23, Steps: 34 | Train Loss: 1.985 Vali Loss: 19.186 Vali Acc: 0.792 Test Loss: 19.186 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.205056428909302
Epoch: 24, Steps: 34 | Train Loss: 0.492 Vali Loss: 15.289 Vali Acc: 0.763 Test Loss: 15.289 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.363391637802124
Epoch: 25, Steps: 34 | Train Loss: 1.321 Vali Loss: 16.851 Vali Acc: 0.832 Test Loss: 16.851 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.158358335494995
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.168 Vali Acc: 0.855 Test Loss: 14.168 Test Acc: 0.855
Validation loss decreased (-0.838005 --> -0.855350).  Saving model ...
Epoch: 27 cost time: 4.9422287940979
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.131 Vali Acc: 0.855 Test Loss: 14.131 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 28 cost time: 5.1073267459869385
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 29 cost time: 5.12037467956543
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 30 cost time: 5.275367975234985
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 31 cost time: 5.267491817474365
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 32 cost time: 5.017595052719116
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 33 cost time: 5.030370473861694
Epoch: 33, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 34 cost time: 5.091547727584839
Epoch: 34, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 35 cost time: 5.182038307189941
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 36 cost time: 4.955203533172607
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 37 cost time: 5.223930358886719
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 38 cost time: 5.146265745162964
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 39 cost time: 5.2787110805511475
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 40 cost time: 5.010420560836792
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 41 cost time: 5.023175477981567
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 42 cost time: 5.085912466049194
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 43 cost time: 5.189596891403198
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 44 cost time: 5.108943700790405
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 45 cost time: 5.028969764709473
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 46 cost time: 5.224213600158691
Epoch: 46, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 47 cost time: 4.917717456817627
Epoch: 47, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 48 cost time: 5.156678915023804
Epoch: 48, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 49 cost time: 5.147828817367554
Epoch: 49, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 50 cost time: 4.967806577682495
Epoch: 50, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 51 cost time: 5.071964979171753
Epoch: 51, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 52 cost time: 4.968930006027222
Epoch: 52, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 53 cost time: 5.274760723114014
Epoch: 53, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 54 cost time: 5.529057741165161
Epoch: 54, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 55 cost time: 5.350505113601685
Epoch: 55, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 56 cost time: 5.448772192001343
Epoch: 56, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 57 cost time: 5.293436527252197
Epoch: 57, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 58 cost time: 5.26616096496582
Epoch: 58, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 59 cost time: 5.148061990737915
Epoch: 59, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 60 cost time: 4.964632749557495
Epoch: 60, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 61 cost time: 5.1177942752838135
Epoch: 61, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 62 cost time: 4.901625394821167
Epoch: 62, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 63 cost time: 5.131243944168091
Epoch: 63, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 64 cost time: 5.203146457672119
Epoch: 64, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 65 cost time: 5.065710067749023
Epoch: 65, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 66 cost time: 5.0418572425842285
Epoch: 66, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 67 cost time: 5.001394748687744
Epoch: 67, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 68 cost time: 5.044239282608032
Epoch: 68, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 69 cost time: 5.071374416351318
Epoch: 69, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 70 cost time: 5.03005576133728
Epoch: 70, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 71 cost time: 5.285179615020752
Epoch: 71, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 72 cost time: 5.061623811721802
Epoch: 72, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 73 cost time: 4.995743036270142
Epoch: 73, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 74 cost time: 5.1845862865448
Epoch: 74, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 75 cost time: 5.02632999420166
Epoch: 75, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 76 cost time: 5.11176872253418
Epoch: 76, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 77 cost time: 4.889546871185303
Epoch: 77, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 78 cost time: 5.089568376541138
Epoch: 78, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 79 cost time: 5.01472020149231
Epoch: 79, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 80 cost time: 4.976860284805298
Epoch: 80, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 81 cost time: 5.161283254623413
Epoch: 81, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 82 cost time: 4.88105320930481
Epoch: 82, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 83 cost time: 5.1966233253479
Epoch: 83, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 84 cost time: 5.035092830657959
Epoch: 84, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 85 cost time: 5.114785194396973
Epoch: 85, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 86 cost time: 5.061860084533691
Epoch: 86, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 87 cost time: 5.198103904724121
Epoch: 87, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 88 cost time: 5.055753469467163
Epoch: 88, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 89 cost time: 5.049708127975464
Epoch: 89, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 90 cost time: 5.278788089752197
Epoch: 90, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 91 cost time: 5.01743483543396
Epoch: 91, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 92 cost time: 5.14981746673584
Epoch: 92, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 93 cost time: 5.299043893814087
Epoch: 93, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 94 cost time: 5.069453716278076
Epoch: 94, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 95 cost time: 4.702917098999023
Epoch: 95, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 96 cost time: 4.887386322021484
Epoch: 96, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 97 cost time: 5.074159622192383
Epoch: 97, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 98 cost time: 4.98212456703186
Epoch: 98, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 99 cost time: 5.064503192901611
Epoch: 99, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
Epoch: 100 cost time: 5.2577784061431885
Epoch: 100, Steps: 34 | Train Loss: 0.000 Vali Loss: 14.130 Vali Acc: 0.855 Test Loss: 14.130 Test Acc: 0.855
Validation loss decreased (-0.855350 --> -0.855350).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 6322463
model size : 25.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.345187664031982
Epoch: 1, Steps: 34 | Train Loss: 10.261 Vali Loss: 22.496 Vali Acc: 0.272 Test Loss: 22.496 Test Acc: 0.272
Validation loss decreased (inf --> -0.271451).  Saving model ...
Epoch: 2 cost time: 5.117750883102417
Epoch: 2, Steps: 34 | Train Loss: 15.038 Vali Loss: 17.513 Vali Acc: 0.393 Test Loss: 17.513 Test Acc: 0.393
Validation loss decreased (-0.271451 --> -0.392888).  Saving model ...
Epoch: 3 cost time: 4.854933500289917
Epoch: 3, Steps: 34 | Train Loss: 17.513 Vali Loss: 14.374 Vali Acc: 0.578 Test Loss: 14.374 Test Acc: 0.578
Validation loss decreased (-0.392888 --> -0.577891).  Saving model ...
Epoch: 4 cost time: 4.873446464538574
Epoch: 4, Steps: 34 | Train Loss: 22.104 Vali Loss: 21.249 Vali Acc: 0.439 Test Loss: 21.249 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.046719074249268
Epoch: 5, Steps: 34 | Train Loss: 22.758 Vali Loss: 31.096 Vali Acc: 0.497 Test Loss: 31.096 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.859665393829346
Epoch: 6, Steps: 34 | Train Loss: 17.246 Vali Loss: 28.078 Vali Acc: 0.520 Test Loss: 28.078 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.723430395126343
Epoch: 7, Steps: 34 | Train Loss: 8.524 Vali Loss: 37.777 Vali Acc: 0.566 Test Loss: 37.777 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.752192735671997
Epoch: 8, Steps: 34 | Train Loss: 14.389 Vali Loss: 60.023 Vali Acc: 0.538 Test Loss: 60.023 Test Acc: 0.538
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.896613359451294
Epoch: 9, Steps: 34 | Train Loss: 26.387 Vali Loss: 20.641 Vali Acc: 0.682 Test Loss: 20.641 Test Acc: 0.682
Validation loss decreased (-0.577891 --> -0.681875).  Saving model ...
Epoch: 10 cost time: 4.969768524169922
Epoch: 10, Steps: 34 | Train Loss: 15.381 Vali Loss: 25.174 Vali Acc: 0.665 Test Loss: 25.174 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.384814739227295
Epoch: 11, Steps: 34 | Train Loss: 4.252 Vali Loss: 30.518 Vali Acc: 0.694 Test Loss: 30.518 Test Acc: 0.694
Validation loss decreased (-0.681875 --> -0.693336).  Saving model ...
Epoch: 12 cost time: 4.908680200576782
Epoch: 12, Steps: 34 | Train Loss: 9.795 Vali Loss: 9.975 Vali Acc: 0.798 Test Loss: 9.975 Test Acc: 0.798
Validation loss decreased (-0.693336 --> -0.797588).  Saving model ...
Epoch: 13 cost time: 4.711087226867676
Epoch: 13, Steps: 34 | Train Loss: 7.007 Vali Loss: 42.263 Vali Acc: 0.665 Test Loss: 42.263 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.070148944854736
Epoch: 14, Steps: 34 | Train Loss: 7.470 Vali Loss: 16.559 Vali Acc: 0.751 Test Loss: 16.559 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.67395544052124
Epoch: 15, Steps: 34 | Train Loss: 3.783 Vali Loss: 21.108 Vali Acc: 0.751 Test Loss: 21.108 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.760906934738159
Epoch: 16, Steps: 34 | Train Loss: 3.483 Vali Loss: 11.725 Vali Acc: 0.792 Test Loss: 11.725 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.134400129318237
Epoch: 17, Steps: 34 | Train Loss: 3.970 Vali Loss: 12.332 Vali Acc: 0.821 Test Loss: 12.332 Test Acc: 0.821
Validation loss decreased (-0.797588 --> -0.820686).  Saving model ...
Epoch: 18 cost time: 4.890132904052734
Epoch: 18, Steps: 34 | Train Loss: 2.041 Vali Loss: 16.433 Vali Acc: 0.815 Test Loss: 16.433 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.857198715209961
Epoch: 19, Steps: 34 | Train Loss: 5.868 Vali Loss: 18.935 Vali Acc: 0.780 Test Loss: 18.935 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.155987024307251
Epoch: 20, Steps: 34 | Train Loss: 3.094 Vali Loss: 27.676 Vali Acc: 0.711 Test Loss: 27.676 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.80075216293335
Epoch: 21, Steps: 34 | Train Loss: 5.226 Vali Loss: 45.211 Vali Acc: 0.659 Test Loss: 45.211 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.857316970825195
Epoch: 22, Steps: 34 | Train Loss: 4.746 Vali Loss: 23.745 Vali Acc: 0.775 Test Loss: 23.745 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.122014760971069
Epoch: 23, Steps: 34 | Train Loss: 2.216 Vali Loss: 17.981 Vali Acc: 0.746 Test Loss: 17.981 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.9622626304626465
Epoch: 24, Steps: 34 | Train Loss: 3.049 Vali Loss: 82.836 Vali Acc: 0.630 Test Loss: 82.836 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.877497434616089
Epoch: 25, Steps: 34 | Train Loss: 21.694 Vali Loss: 42.718 Vali Acc: 0.671 Test Loss: 42.718 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.023577451705933
Epoch: 26, Steps: 34 | Train Loss: 4.203 Vali Loss: 71.529 Vali Acc: 0.613 Test Loss: 71.529 Test Acc: 0.613
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.9855616092681885
Epoch: 27, Steps: 34 | Train Loss: 4.544 Vali Loss: 33.761 Vali Acc: 0.751 Test Loss: 33.761 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 6321695
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.956690073013306
Epoch: 1, Steps: 34 | Train Loss: 10.295 Vali Loss: 19.096 Vali Acc: 0.312 Test Loss: 19.096 Test Acc: 0.312
Validation loss decreased (inf --> -0.311948).  Saving model ...
Epoch: 2 cost time: 4.889166593551636
Epoch: 2, Steps: 34 | Train Loss: 21.087 Vali Loss: 13.443 Vali Acc: 0.312 Test Loss: 13.443 Test Acc: 0.312
Validation loss decreased (-0.311948 --> -0.312004).  Saving model ...
Epoch: 3 cost time: 5.071340322494507
Epoch: 3, Steps: 34 | Train Loss: 10.733 Vali Loss: 19.181 Vali Acc: 0.445 Test Loss: 19.181 Test Acc: 0.445
Validation loss decreased (-0.312004 --> -0.444895).  Saving model ...
Epoch: 4 cost time: 5.205214977264404
Epoch: 4, Steps: 34 | Train Loss: 12.798 Vali Loss: 17.249 Vali Acc: 0.624 Test Loss: 17.249 Test Acc: 0.624
Validation loss decreased (-0.444895 --> -0.624105).  Saving model ...
Epoch: 5 cost time: 4.936099052429199
Epoch: 5, Steps: 34 | Train Loss: 23.369 Vali Loss: 40.982 Vali Acc: 0.486 Test Loss: 40.982 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.91216516494751
Epoch: 6, Steps: 34 | Train Loss: 17.918 Vali Loss: 21.790 Vali Acc: 0.561 Test Loss: 21.790 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.995049476623535
Epoch: 7, Steps: 34 | Train Loss: 15.484 Vali Loss: 16.953 Vali Acc: 0.711 Test Loss: 16.953 Test Acc: 0.711
Validation loss decreased (-0.624105 --> -0.710813).  Saving model ...
Epoch: 8 cost time: 5.11889123916626
Epoch: 8, Steps: 34 | Train Loss: 10.211 Vali Loss: 26.020 Vali Acc: 0.671 Test Loss: 26.020 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.25075364112854
Epoch: 9, Steps: 34 | Train Loss: 11.902 Vali Loss: 22.414 Vali Acc: 0.775 Test Loss: 22.414 Test Acc: 0.775
Validation loss decreased (-0.710813 --> -0.774342).  Saving model ...
Epoch: 10 cost time: 5.039168357849121
Epoch: 10, Steps: 34 | Train Loss: 17.113 Vali Loss: 17.250 Vali Acc: 0.705 Test Loss: 17.250 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.245391607284546
Epoch: 11, Steps: 34 | Train Loss: 11.742 Vali Loss: 30.174 Vali Acc: 0.630 Test Loss: 30.174 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.194021463394165
Epoch: 12, Steps: 34 | Train Loss: 15.916 Vali Loss: 37.498 Vali Acc: 0.647 Test Loss: 37.498 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.2526936531066895
Epoch: 13, Steps: 34 | Train Loss: 6.155 Vali Loss: 12.137 Vali Acc: 0.792 Test Loss: 12.137 Test Acc: 0.792
Validation loss decreased (-0.774342 --> -0.791786).  Saving model ...
Epoch: 14 cost time: 5.044468641281128
Epoch: 14, Steps: 34 | Train Loss: 2.752 Vali Loss: 67.770 Vali Acc: 0.543 Test Loss: 67.770 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.232206583023071
Epoch: 15, Steps: 34 | Train Loss: 7.560 Vali Loss: 25.547 Vali Acc: 0.694 Test Loss: 25.547 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.12276816368103
Epoch: 16, Steps: 34 | Train Loss: 1.977 Vali Loss: 24.116 Vali Acc: 0.711 Test Loss: 24.116 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.046933889389038
Epoch: 17, Steps: 34 | Train Loss: 3.307 Vali Loss: 15.299 Vali Acc: 0.746 Test Loss: 15.299 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.178838729858398
Epoch: 18, Steps: 34 | Train Loss: 2.005 Vali Loss: 18.341 Vali Acc: 0.798 Test Loss: 18.341 Test Acc: 0.798
Validation loss decreased (-0.791786 --> -0.797504).  Saving model ...
Epoch: 19 cost time: 4.887532711029053
Epoch: 19, Steps: 34 | Train Loss: 0.252 Vali Loss: 19.704 Vali Acc: 0.803 Test Loss: 19.704 Test Acc: 0.803
Validation loss decreased (-0.797504 --> -0.803271).  Saving model ...
Epoch: 20 cost time: 4.875564098358154
Epoch: 20, Steps: 34 | Train Loss: 9.858 Vali Loss: 17.249 Vali Acc: 0.780 Test Loss: 17.249 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.879878044128418
Epoch: 21, Steps: 34 | Train Loss: 1.043 Vali Loss: 18.664 Vali Acc: 0.717 Test Loss: 18.664 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.119604825973511
Epoch: 22, Steps: 34 | Train Loss: 2.976 Vali Loss: 26.980 Vali Acc: 0.792 Test Loss: 26.980 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.061341047286987
Epoch: 23, Steps: 34 | Train Loss: 1.208 Vali Loss: 17.166 Vali Acc: 0.786 Test Loss: 17.166 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.14780592918396
Epoch: 24, Steps: 34 | Train Loss: 2.256 Vali Loss: 15.497 Vali Acc: 0.815 Test Loss: 15.497 Test Acc: 0.815
Validation loss decreased (-0.803271 --> -0.814874).  Saving model ...
Epoch: 25 cost time: 5.194030284881592
Epoch: 25, Steps: 34 | Train Loss: 0.334 Vali Loss: 49.676 Vali Acc: 0.711 Test Loss: 49.676 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.123805522918701
Epoch: 26, Steps: 34 | Train Loss: 1.295 Vali Loss: 12.244 Vali Acc: 0.827 Test Loss: 12.244 Test Acc: 0.827
Validation loss decreased (-0.814874 --> -0.826467).  Saving model ...
Epoch: 27 cost time: 5.133180618286133
Epoch: 27, Steps: 34 | Train Loss: 0.452 Vali Loss: 32.981 Vali Acc: 0.734 Test Loss: 32.981 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.0218493938446045
Epoch: 28, Steps: 34 | Train Loss: 0.635 Vali Loss: 21.847 Vali Acc: 0.809 Test Loss: 21.847 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.044870138168335
Epoch: 29, Steps: 34 | Train Loss: 0.455 Vali Loss: 27.668 Vali Acc: 0.786 Test Loss: 27.668 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.9761247634887695
Epoch: 30, Steps: 34 | Train Loss: 2.397 Vali Loss: 18.700 Vali Acc: 0.838 Test Loss: 18.700 Test Acc: 0.838
Validation loss decreased (-0.826467 --> -0.837963).  Saving model ...
Epoch: 31 cost time: 4.96052885055542
Epoch: 31, Steps: 34 | Train Loss: 2.993 Vali Loss: 38.676 Vali Acc: 0.699 Test Loss: 38.676 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.024878978729248
Epoch: 32, Steps: 34 | Train Loss: 2.689 Vali Loss: 14.163 Vali Acc: 0.844 Test Loss: 14.163 Test Acc: 0.844
Validation loss decreased (-0.837963 --> -0.843789).  Saving model ...
Epoch: 33 cost time: 4.992589473724365
Epoch: 33, Steps: 34 | Train Loss: 0.461 Vali Loss: 37.926 Vali Acc: 0.659 Test Loss: 37.926 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.061522006988525
Epoch: 34, Steps: 34 | Train Loss: 1.804 Vali Loss: 24.265 Vali Acc: 0.815 Test Loss: 24.265 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.296069383621216
Epoch: 35, Steps: 34 | Train Loss: 0.804 Vali Loss: 26.437 Vali Acc: 0.769 Test Loss: 26.437 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.948458194732666
Epoch: 36, Steps: 34 | Train Loss: 1.415 Vali Loss: 12.593 Vali Acc: 0.821 Test Loss: 12.593 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.150288343429565
Epoch: 37, Steps: 34 | Train Loss: 0.595 Vali Loss: 53.588 Vali Acc: 0.717 Test Loss: 53.588 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.14497709274292
Epoch: 38, Steps: 34 | Train Loss: 0.759 Vali Loss: 31.564 Vali Acc: 0.780 Test Loss: 31.564 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.30709433555603
Epoch: 39, Steps: 34 | Train Loss: 1.647 Vali Loss: 42.168 Vali Acc: 0.769 Test Loss: 42.168 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 5.4192564487457275
Epoch: 40, Steps: 34 | Train Loss: 2.815 Vali Loss: 61.648 Vali Acc: 0.751 Test Loss: 61.648 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.2150959968566895
Epoch: 41, Steps: 34 | Train Loss: 0.428 Vali Loss: 25.058 Vali Acc: 0.798 Test Loss: 25.058 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.139223575592041
Epoch: 42, Steps: 34 | Train Loss: 0.118 Vali Loss: 21.987 Vali Acc: 0.798 Test Loss: 21.987 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6320927
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.25609827041626
Epoch: 1, Steps: 34 | Train Loss: 9.003 Vali Loss: 17.824 Vali Acc: 0.295 Test Loss: 17.824 Test Acc: 0.295
Validation loss decreased (inf --> -0.294619).  Saving model ...
Epoch: 2 cost time: 4.664677858352661
Epoch: 2, Steps: 34 | Train Loss: 20.669 Vali Loss: 11.495 Vali Acc: 0.434 Test Loss: 11.495 Test Acc: 0.434
Validation loss decreased (-0.294619 --> -0.433411).  Saving model ...
Epoch: 3 cost time: 4.75675368309021
Epoch: 3, Steps: 34 | Train Loss: 15.013 Vali Loss: 18.411 Vali Acc: 0.451 Test Loss: 18.411 Test Acc: 0.451
Validation loss decreased (-0.433411 --> -0.450683).  Saving model ...
Epoch: 4 cost time: 4.749274969100952
Epoch: 4, Steps: 34 | Train Loss: 13.853 Vali Loss: 22.302 Vali Acc: 0.520 Test Loss: 22.302 Test Acc: 0.520
Validation loss decreased (-0.450683 --> -0.520008).  Saving model ...
Epoch: 5 cost time: 4.2632341384887695
Epoch: 5, Steps: 34 | Train Loss: 12.228 Vali Loss: 23.168 Vali Acc: 0.503 Test Loss: 23.168 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.8109822273254395
Epoch: 6, Steps: 34 | Train Loss: 22.837 Vali Loss: 57.835 Vali Acc: 0.312 Test Loss: 57.835 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.708776950836182
Epoch: 7, Steps: 34 | Train Loss: 19.975 Vali Loss: 29.304 Vali Acc: 0.514 Test Loss: 29.304 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.444600582122803
Epoch: 8, Steps: 34 | Train Loss: 15.765 Vali Loss: 23.360 Vali Acc: 0.514 Test Loss: 23.360 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.615266561508179
Epoch: 9, Steps: 34 | Train Loss: 26.572 Vali Loss: 83.547 Vali Acc: 0.474 Test Loss: 83.547 Test Acc: 0.474
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.817394256591797
Epoch: 10, Steps: 34 | Train Loss: 17.431 Vali Loss: 38.112 Vali Acc: 0.601 Test Loss: 38.112 Test Acc: 0.601
Validation loss decreased (-0.520008 --> -0.600775).  Saving model ...
Epoch: 11 cost time: 4.691792011260986
Epoch: 11, Steps: 34 | Train Loss: 18.866 Vali Loss: 19.451 Vali Acc: 0.728 Test Loss: 19.451 Test Acc: 0.728
Validation loss decreased (-0.600775 --> -0.728129).  Saving model ...
Epoch: 12 cost time: 4.795312404632568
Epoch: 12, Steps: 34 | Train Loss: 9.051 Vali Loss: 28.012 Vali Acc: 0.671 Test Loss: 28.012 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.680242300033569
Epoch: 13, Steps: 34 | Train Loss: 5.028 Vali Loss: 52.526 Vali Acc: 0.694 Test Loss: 52.526 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.882077932357788
Epoch: 14, Steps: 34 | Train Loss: 17.428 Vali Loss: 22.565 Vali Acc: 0.780 Test Loss: 22.565 Test Acc: 0.780
Validation loss decreased (-0.728129 --> -0.780121).  Saving model ...
Epoch: 15 cost time: 4.72363805770874
Epoch: 15, Steps: 34 | Train Loss: 5.119 Vali Loss: 25.677 Vali Acc: 0.699 Test Loss: 25.677 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.60858154296875
Epoch: 16, Steps: 34 | Train Loss: 1.615 Vali Loss: 15.468 Vali Acc: 0.815 Test Loss: 15.468 Test Acc: 0.815
Validation loss decreased (-0.780121 --> -0.814874).  Saving model ...
Epoch: 17 cost time: 4.589421033859253
Epoch: 17, Steps: 34 | Train Loss: 0.352 Vali Loss: 20.246 Vali Acc: 0.780 Test Loss: 20.246 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.749866247177124
Epoch: 18, Steps: 34 | Train Loss: 3.730 Vali Loss: 24.360 Vali Acc: 0.792 Test Loss: 24.360 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.808140754699707
Epoch: 19, Steps: 34 | Train Loss: 1.194 Vali Loss: 16.176 Vali Acc: 0.786 Test Loss: 16.176 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.615133285522461
Epoch: 20, Steps: 34 | Train Loss: 0.617 Vali Loss: 28.177 Vali Acc: 0.740 Test Loss: 28.177 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.665780782699585
Epoch: 21, Steps: 34 | Train Loss: 1.907 Vali Loss: 13.389 Vali Acc: 0.832 Test Loss: 13.389 Test Acc: 0.832
Validation loss decreased (-0.814874 --> -0.832236).  Saving model ...
Epoch: 22 cost time: 4.942676067352295
Epoch: 22, Steps: 34 | Train Loss: 2.104 Vali Loss: 9.969 Vali Acc: 0.855 Test Loss: 9.969 Test Acc: 0.855
Validation loss decreased (-0.832236 --> -0.855392).  Saving model ...
Epoch: 23 cost time: 4.692455768585205
Epoch: 23, Steps: 34 | Train Loss: 1.013 Vali Loss: 35.286 Vali Acc: 0.699 Test Loss: 35.286 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.76372766494751
Epoch: 24, Steps: 34 | Train Loss: 3.733 Vali Loss: 23.023 Vali Acc: 0.763 Test Loss: 23.023 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.527853965759277
Epoch: 25, Steps: 34 | Train Loss: 5.562 Vali Loss: 31.518 Vali Acc: 0.699 Test Loss: 31.518 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.368010759353638
Epoch: 26, Steps: 34 | Train Loss: 2.428 Vali Loss: 79.201 Vali Acc: 0.624 Test Loss: 79.201 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.820446252822876
Epoch: 27, Steps: 34 | Train Loss: 5.644 Vali Loss: 30.343 Vali Acc: 0.728 Test Loss: 30.343 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.607866287231445
Epoch: 28, Steps: 34 | Train Loss: 3.490 Vali Loss: 41.720 Vali Acc: 0.757 Test Loss: 41.720 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.559439659118652
Epoch: 29, Steps: 34 | Train Loss: 1.967 Vali Loss: 18.195 Vali Acc: 0.832 Test Loss: 18.195 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.645033121109009
Epoch: 30, Steps: 34 | Train Loss: 0.184 Vali Loss: 20.854 Vali Acc: 0.786 Test Loss: 20.854 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.542783737182617
Epoch: 31, Steps: 34 | Train Loss: 0.888 Vali Loss: 15.911 Vali Acc: 0.844 Test Loss: 15.911 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.593060493469238
Epoch: 32, Steps: 34 | Train Loss: 0.994 Vali Loss: 24.991 Vali Acc: 0.763 Test Loss: 24.991 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 6320159
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.179922103881836
Epoch: 1, Steps: 34 | Train Loss: 12.434 Vali Loss: 37.402 Vali Acc: 0.127 Test Loss: 37.402 Test Acc: 0.127
Validation loss decreased (inf --> -0.126794).  Saving model ...
Epoch: 2 cost time: 4.616612672805786
Epoch: 2, Steps: 34 | Train Loss: 23.293 Vali Loss: 17.925 Vali Acc: 0.387 Test Loss: 17.925 Test Acc: 0.387
Validation loss decreased (-0.126794 --> -0.387104).  Saving model ...
Epoch: 3 cost time: 4.62566351890564
Epoch: 3, Steps: 34 | Train Loss: 26.705 Vali Loss: 6.515 Vali Acc: 0.711 Test Loss: 6.515 Test Acc: 0.711
Validation loss decreased (-0.387104 --> -0.710918).  Saving model ...
Epoch: 4 cost time: 4.530791521072388
Epoch: 4, Steps: 34 | Train Loss: 30.137 Vali Loss: 77.458 Vali Acc: 0.410 Test Loss: 77.458 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.522921562194824
Epoch: 5, Steps: 34 | Train Loss: 21.714 Vali Loss: 19.781 Vali Acc: 0.491 Test Loss: 19.781 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.575210332870483
Epoch: 6, Steps: 34 | Train Loss: 16.116 Vali Loss: 13.318 Vali Acc: 0.578 Test Loss: 13.318 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.551578044891357
Epoch: 7, Steps: 34 | Train Loss: 11.620 Vali Loss: 14.033 Vali Acc: 0.601 Test Loss: 14.033 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.574745178222656
Epoch: 8, Steps: 34 | Train Loss: 18.974 Vali Loss: 42.742 Vali Acc: 0.647 Test Loss: 42.742 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.527828931808472
Epoch: 9, Steps: 34 | Train Loss: 15.554 Vali Loss: 11.385 Vali Acc: 0.763 Test Loss: 11.385 Test Acc: 0.763
Validation loss decreased (-0.710918 --> -0.762892).  Saving model ...
Epoch: 10 cost time: 4.539492130279541
Epoch: 10, Steps: 34 | Train Loss: 14.757 Vali Loss: 115.165 Vali Acc: 0.243 Test Loss: 115.165 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.709178924560547
Epoch: 11, Steps: 34 | Train Loss: 16.152 Vali Loss: 40.471 Vali Acc: 0.682 Test Loss: 40.471 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.570824384689331
Epoch: 12, Steps: 34 | Train Loss: 11.914 Vali Loss: 29.979 Vali Acc: 0.607 Test Loss: 29.979 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.635707855224609
Epoch: 13, Steps: 34 | Train Loss: 5.605 Vali Loss: 28.274 Vali Acc: 0.711 Test Loss: 28.274 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.854380369186401
Epoch: 14, Steps: 34 | Train Loss: 4.966 Vali Loss: 34.746 Vali Acc: 0.699 Test Loss: 34.746 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.716111898422241
Epoch: 15, Steps: 34 | Train Loss: 14.882 Vali Loss: 26.833 Vali Acc: 0.659 Test Loss: 26.833 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.765772104263306
Epoch: 16, Steps: 34 | Train Loss: 6.606 Vali Loss: 39.115 Vali Acc: 0.688 Test Loss: 39.115 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.653200626373291
Epoch: 17, Steps: 34 | Train Loss: 7.378 Vali Loss: 37.264 Vali Acc: 0.751 Test Loss: 37.264 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.642599582672119
Epoch: 18, Steps: 34 | Train Loss: 10.843 Vali Loss: 33.891 Vali Acc: 0.636 Test Loss: 33.891 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.546794891357422
Epoch: 19, Steps: 34 | Train Loss: 5.739 Vali Loss: 38.073 Vali Acc: 0.699 Test Loss: 38.073 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 6223391
model size : 25.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.303330659866333
Epoch: 1, Steps: 34 | Train Loss: 11.798 Vali Loss: 39.052 Vali Acc: 0.301 Test Loss: 39.052 Test Acc: 0.301
Validation loss decreased (inf --> -0.300188).  Saving model ...
Epoch: 2 cost time: 4.40754771232605
Epoch: 2, Steps: 34 | Train Loss: 27.250 Vali Loss: 33.832 Vali Acc: 0.260 Test Loss: 33.832 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.588674306869507
Epoch: 3, Steps: 34 | Train Loss: 17.958 Vali Loss: 10.547 Vali Acc: 0.376 Test Loss: 10.547 Test Acc: 0.376
Validation loss decreased (-0.300188 --> -0.375617).  Saving model ...
Epoch: 4 cost time: 4.208869934082031
Epoch: 4, Steps: 34 | Train Loss: 23.041 Vali Loss: 40.486 Vali Acc: 0.468 Test Loss: 40.486 Test Acc: 0.468
Validation loss decreased (-0.375617 --> -0.467803).  Saving model ...
Epoch: 5 cost time: 4.459444284439087
Epoch: 5, Steps: 34 | Train Loss: 24.388 Vali Loss: 53.107 Vali Acc: 0.416 Test Loss: 53.107 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.580362796783447
Epoch: 6, Steps: 34 | Train Loss: 19.239 Vali Loss: 28.448 Vali Acc: 0.613 Test Loss: 28.448 Test Acc: 0.613
Validation loss decreased (-0.467803 --> -0.612432).  Saving model ...
Epoch: 7 cost time: 4.663188695907593
Epoch: 7, Steps: 34 | Train Loss: 13.447 Vali Loss: 33.046 Vali Acc: 0.520 Test Loss: 33.046 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.819948434829712
Epoch: 8, Steps: 34 | Train Loss: 19.081 Vali Loss: 24.561 Vali Acc: 0.682 Test Loss: 24.561 Test Acc: 0.682
Validation loss decreased (-0.612432 --> -0.681835).  Saving model ...
Epoch: 9 cost time: 4.588874340057373
Epoch: 9, Steps: 34 | Train Loss: 13.288 Vali Loss: 9.927 Vali Acc: 0.751 Test Loss: 9.927 Test Acc: 0.751
Validation loss decreased (-0.681835 --> -0.751346).  Saving model ...
Epoch: 10 cost time: 4.4880757331848145
Epoch: 10, Steps: 34 | Train Loss: 12.144 Vali Loss: 25.722 Vali Acc: 0.538 Test Loss: 25.722 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.579452276229858
Epoch: 11, Steps: 34 | Train Loss: 11.161 Vali Loss: 33.758 Vali Acc: 0.572 Test Loss: 33.758 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.672929286956787
Epoch: 12, Steps: 34 | Train Loss: 17.265 Vali Loss: 14.726 Vali Acc: 0.751 Test Loss: 14.726 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.6710100173950195
Epoch: 13, Steps: 34 | Train Loss: 11.843 Vali Loss: 39.605 Vali Acc: 0.613 Test Loss: 39.605 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.70156455039978
Epoch: 14, Steps: 34 | Train Loss: 24.000 Vali Loss: 42.503 Vali Acc: 0.659 Test Loss: 42.503 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.875023126602173
Epoch: 15, Steps: 34 | Train Loss: 13.217 Vali Loss: 21.912 Vali Acc: 0.665 Test Loss: 21.912 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.774677991867065
Epoch: 16, Steps: 34 | Train Loss: 10.501 Vali Loss: 53.351 Vali Acc: 0.601 Test Loss: 53.351 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.594851016998291
Epoch: 17, Steps: 34 | Train Loss: 8.853 Vali Loss: 25.411 Vali Acc: 0.711 Test Loss: 25.411 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.559295415878296
Epoch: 18, Steps: 34 | Train Loss: 0.677 Vali Loss: 42.298 Vali Acc: 0.682 Test Loss: 42.298 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.524200439453125
Epoch: 19, Steps: 34 | Train Loss: 3.960 Vali Loss: 20.232 Vali Acc: 0.832 Test Loss: 20.232 Test Acc: 0.832
Validation loss decreased (-0.751346 --> -0.832168).  Saving model ...
Epoch: 20 cost time: 4.7729651927948
Epoch: 20, Steps: 34 | Train Loss: 1.709 Vali Loss: 98.322 Vali Acc: 0.555 Test Loss: 98.322 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.647747039794922
Epoch: 21, Steps: 34 | Train Loss: 11.148 Vali Loss: 29.607 Vali Acc: 0.775 Test Loss: 29.607 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.694465398788452
Epoch: 22, Steps: 34 | Train Loss: 3.217 Vali Loss: 24.238 Vali Acc: 0.751 Test Loss: 24.238 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.856709957122803
Epoch: 23, Steps: 34 | Train Loss: 1.783 Vali Loss: 37.667 Vali Acc: 0.723 Test Loss: 37.667 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.608224630355835
Epoch: 24, Steps: 34 | Train Loss: 3.656 Vali Loss: 21.568 Vali Acc: 0.746 Test Loss: 21.568 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.6600425243377686
Epoch: 25, Steps: 34 | Train Loss: 1.246 Vali Loss: 22.817 Vali Acc: 0.798 Test Loss: 22.817 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.960769176483154
Epoch: 26, Steps: 34 | Train Loss: 0.366 Vali Loss: 21.367 Vali Acc: 0.798 Test Loss: 21.367 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.49060845375061
Epoch: 27, Steps: 34 | Train Loss: 0.909 Vali Loss: 27.645 Vali Acc: 0.792 Test Loss: 27.645 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.486451148986816
Epoch: 28, Steps: 34 | Train Loss: 0.153 Vali Loss: 16.602 Vali Acc: 0.798 Test Loss: 16.602 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.438864231109619
Epoch: 29, Steps: 34 | Train Loss: 0.561 Vali Loss: 56.385 Vali Acc: 0.717 Test Loss: 56.385 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 6222623
model size : 25.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.247710466384888
Epoch: 1, Steps: 34 | Train Loss: 9.627 Vali Loss: 21.488 Vali Acc: 0.277 Test Loss: 21.488 Test Acc: 0.277
Validation loss decreased (inf --> -0.277242).  Saving model ...
Epoch: 2 cost time: 4.839953899383545
Epoch: 2, Steps: 34 | Train Loss: 18.434 Vali Loss: 22.981 Vali Acc: 0.434 Test Loss: 22.981 Test Acc: 0.434
Validation loss decreased (-0.277242 --> -0.433296).  Saving model ...
Epoch: 3 cost time: 4.674956321716309
Epoch: 3, Steps: 34 | Train Loss: 25.178 Vali Loss: 38.015 Vali Acc: 0.370 Test Loss: 38.015 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.579746246337891
Epoch: 4, Steps: 34 | Train Loss: 32.003 Vali Loss: 27.293 Vali Acc: 0.451 Test Loss: 27.293 Test Acc: 0.451
Validation loss decreased (-0.433296 --> -0.450594).  Saving model ...
Epoch: 5 cost time: 4.697646379470825
Epoch: 5, Steps: 34 | Train Loss: 13.010 Vali Loss: 20.497 Vali Acc: 0.624 Test Loss: 20.497 Test Acc: 0.624
Validation loss decreased (-0.450594 --> -0.624072).  Saving model ...
Epoch: 6 cost time: 4.603043556213379
Epoch: 6, Steps: 34 | Train Loss: 22.094 Vali Loss: 34.033 Vali Acc: 0.584 Test Loss: 34.033 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.586148977279663
Epoch: 7, Steps: 34 | Train Loss: 13.972 Vali Loss: 21.583 Vali Acc: 0.514 Test Loss: 21.583 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.670669794082642
Epoch: 8, Steps: 34 | Train Loss: 15.579 Vali Loss: 41.075 Vali Acc: 0.671 Test Loss: 41.075 Test Acc: 0.671
Validation loss decreased (-0.624072 --> -0.670109).  Saving model ...
Epoch: 9 cost time: 4.692601680755615
Epoch: 9, Steps: 34 | Train Loss: 40.166 Vali Loss: 38.357 Vali Acc: 0.514 Test Loss: 38.357 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.345096111297607
Epoch: 10, Steps: 34 | Train Loss: 20.527 Vali Loss: 39.631 Vali Acc: 0.717 Test Loss: 39.631 Test Acc: 0.717
Validation loss decreased (-0.670109 --> -0.716367).  Saving model ...
Epoch: 11 cost time: 5.262025356292725
Epoch: 11, Steps: 34 | Train Loss: 13.797 Vali Loss: 22.657 Vali Acc: 0.613 Test Loss: 22.657 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.077079772949219
Epoch: 12, Steps: 34 | Train Loss: 7.608 Vali Loss: 62.372 Vali Acc: 0.422 Test Loss: 62.372 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.0637640953063965
Epoch: 13, Steps: 34 | Train Loss: 13.749 Vali Loss: 19.222 Vali Acc: 0.763 Test Loss: 19.222 Test Acc: 0.763
Validation loss decreased (-0.716367 --> -0.762814).  Saving model ...
Epoch: 14 cost time: 5.135229825973511
Epoch: 14, Steps: 34 | Train Loss: 9.570 Vali Loss: 34.229 Vali Acc: 0.746 Test Loss: 34.229 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.240473031997681
Epoch: 15, Steps: 34 | Train Loss: 7.001 Vali Loss: 9.775 Vali Acc: 0.861 Test Loss: 9.775 Test Acc: 0.861
Validation loss decreased (-0.762814 --> -0.861174).  Saving model ...
Epoch: 16 cost time: 4.009178161621094
Epoch: 16, Steps: 34 | Train Loss: 2.164 Vali Loss: 11.712 Vali Acc: 0.809 Test Loss: 11.712 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.269783973693848
Epoch: 17, Steps: 34 | Train Loss: 1.620 Vali Loss: 20.384 Vali Acc: 0.723 Test Loss: 20.384 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.438899278640747
Epoch: 18, Steps: 34 | Train Loss: 3.490 Vali Loss: 42.425 Vali Acc: 0.705 Test Loss: 42.425 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.594025135040283
Epoch: 19, Steps: 34 | Train Loss: 12.054 Vali Loss: 43.536 Vali Acc: 0.763 Test Loss: 43.536 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.620514869689941
Epoch: 20, Steps: 34 | Train Loss: 4.647 Vali Loss: 49.890 Vali Acc: 0.699 Test Loss: 49.890 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.469370126724243
Epoch: 21, Steps: 34 | Train Loss: 11.098 Vali Loss: 43.524 Vali Acc: 0.671 Test Loss: 43.524 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.710433483123779
Epoch: 22, Steps: 34 | Train Loss: 4.036 Vali Loss: 31.349 Vali Acc: 0.740 Test Loss: 31.349 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.896465301513672
Epoch: 23, Steps: 34 | Train Loss: 2.606 Vali Loss: 23.218 Vali Acc: 0.751 Test Loss: 23.218 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.610358476638794
Epoch: 24, Steps: 34 | Train Loss: 1.504 Vali Loss: 21.982 Vali Acc: 0.867 Test Loss: 21.982 Test Acc: 0.867
Validation loss decreased (-0.861174 --> -0.866832).  Saving model ...
Epoch: 25 cost time: 4.549268007278442
Epoch: 25, Steps: 34 | Train Loss: 7.654 Vali Loss: 29.854 Vali Acc: 0.780 Test Loss: 29.854 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.5969743728637695
Epoch: 26, Steps: 34 | Train Loss: 10.316 Vali Loss: 33.389 Vali Acc: 0.775 Test Loss: 33.389 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.391939878463745
Epoch: 27, Steps: 34 | Train Loss: 1.190 Vali Loss: 16.022 Vali Acc: 0.821 Test Loss: 16.022 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.661871910095215
Epoch: 28, Steps: 34 | Train Loss: 3.309 Vali Loss: 39.297 Vali Acc: 0.728 Test Loss: 39.297 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.726534366607666
Epoch: 29, Steps: 34 | Train Loss: 0.328 Vali Loss: 18.846 Vali Acc: 0.832 Test Loss: 18.846 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.610609769821167
Epoch: 30, Steps: 34 | Train Loss: 1.847 Vali Loss: 50.656 Vali Acc: 0.711 Test Loss: 50.656 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.412875413894653
Epoch: 31, Steps: 34 | Train Loss: 4.291 Vali Loss: 41.832 Vali Acc: 0.757 Test Loss: 41.832 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.551190137863159
Epoch: 32, Steps: 34 | Train Loss: 1.263 Vali Loss: 23.147 Vali Acc: 0.827 Test Loss: 23.147 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.68339729309082
Epoch: 33, Steps: 34 | Train Loss: 1.416 Vali Loss: 16.154 Vali Acc: 0.861 Test Loss: 16.154 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.62337851524353
Epoch: 34, Steps: 34 | Train Loss: 0.347 Vali Loss: 21.101 Vali Acc: 0.832 Test Loss: 21.101 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 6221855
model size : 25.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.362490653991699
Epoch: 1, Steps: 34 | Train Loss: 10.127 Vali Loss: 9.511 Vali Acc: 0.451 Test Loss: 9.511 Test Acc: 0.451
Validation loss decreased (inf --> -0.450772).  Saving model ...
Epoch: 2 cost time: 4.8098304271698
Epoch: 2, Steps: 34 | Train Loss: 17.179 Vali Loss: 16.804 Vali Acc: 0.439 Test Loss: 16.804 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.736404657363892
Epoch: 3, Steps: 34 | Train Loss: 19.844 Vali Loss: 40.461 Vali Acc: 0.410 Test Loss: 40.461 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.435435056686401
Epoch: 4, Steps: 34 | Train Loss: 22.525 Vali Loss: 28.091 Vali Acc: 0.353 Test Loss: 28.091 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.577915906906128
Epoch: 5, Steps: 34 | Train Loss: 12.432 Vali Loss: 41.563 Vali Acc: 0.347 Test Loss: 41.563 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.496099472045898
Epoch: 6, Steps: 34 | Train Loss: 20.444 Vali Loss: 12.057 Vali Acc: 0.699 Test Loss: 12.057 Test Acc: 0.699
Validation loss decreased (-0.450772 --> -0.699301).  Saving model ...
Epoch: 7 cost time: 4.499440908432007
Epoch: 7, Steps: 34 | Train Loss: 16.327 Vali Loss: 29.929 Vali Acc: 0.578 Test Loss: 29.929 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.751785755157471
Epoch: 8, Steps: 34 | Train Loss: 31.949 Vali Loss: 96.822 Vali Acc: 0.451 Test Loss: 96.822 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.662003040313721
Epoch: 9, Steps: 34 | Train Loss: 19.652 Vali Loss: 26.504 Vali Acc: 0.601 Test Loss: 26.504 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.656542062759399
Epoch: 10, Steps: 34 | Train Loss: 21.676 Vali Loss: 16.104 Vali Acc: 0.642 Test Loss: 16.104 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.7826924324035645
Epoch: 11, Steps: 34 | Train Loss: 21.604 Vali Loss: 15.621 Vali Acc: 0.723 Test Loss: 15.621 Test Acc: 0.723
Validation loss decreased (-0.699301 --> -0.722387).  Saving model ...
Epoch: 12 cost time: 4.853535890579224
Epoch: 12, Steps: 34 | Train Loss: 9.991 Vali Loss: 20.889 Vali Acc: 0.705 Test Loss: 20.889 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.691918134689331
Epoch: 13, Steps: 34 | Train Loss: 9.619 Vali Loss: 23.434 Vali Acc: 0.665 Test Loss: 23.434 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.671236276626587
Epoch: 14, Steps: 34 | Train Loss: 9.099 Vali Loss: 35.411 Vali Acc: 0.624 Test Loss: 35.411 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.722616672515869
Epoch: 15, Steps: 34 | Train Loss: 3.590 Vali Loss: 44.996 Vali Acc: 0.682 Test Loss: 44.996 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.717285633087158
Epoch: 16, Steps: 34 | Train Loss: 8.444 Vali Loss: 22.620 Vali Acc: 0.780 Test Loss: 22.620 Test Acc: 0.780
Validation loss decreased (-0.722387 --> -0.780121).  Saving model ...
Epoch: 17 cost time: 4.662684440612793
Epoch: 17, Steps: 34 | Train Loss: 3.797 Vali Loss: 45.377 Vali Acc: 0.671 Test Loss: 45.377 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.041163921356201
Epoch: 18, Steps: 34 | Train Loss: 4.736 Vali Loss: 42.075 Vali Acc: 0.723 Test Loss: 42.075 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.7231128215789795
Epoch: 19, Steps: 34 | Train Loss: 7.535 Vali Loss: 39.588 Vali Acc: 0.763 Test Loss: 39.588 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.759413957595825
Epoch: 20, Steps: 34 | Train Loss: 1.215 Vali Loss: 27.701 Vali Acc: 0.798 Test Loss: 27.701 Test Acc: 0.798
Validation loss decreased (-0.780121 --> -0.797411).  Saving model ...
Epoch: 21 cost time: 4.7411627769470215
Epoch: 21, Steps: 34 | Train Loss: 1.472 Vali Loss: 20.747 Vali Acc: 0.734 Test Loss: 20.747 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.5811262130737305
Epoch: 22, Steps: 34 | Train Loss: 1.362 Vali Loss: 12.945 Vali Acc: 0.838 Test Loss: 12.945 Test Acc: 0.838
Validation loss decreased (-0.797411 --> -0.838021).  Saving model ...
Epoch: 23 cost time: 4.61869215965271
Epoch: 23, Steps: 34 | Train Loss: 1.620 Vali Loss: 33.194 Vali Acc: 0.769 Test Loss: 33.194 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.576545476913452
Epoch: 24, Steps: 34 | Train Loss: 1.324 Vali Loss: 23.688 Vali Acc: 0.803 Test Loss: 23.688 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.614816427230835
Epoch: 25, Steps: 34 | Train Loss: 0.237 Vali Loss: 48.395 Vali Acc: 0.682 Test Loss: 48.395 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.468685626983643
Epoch: 26, Steps: 34 | Train Loss: 2.805 Vali Loss: 31.678 Vali Acc: 0.786 Test Loss: 31.678 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.516006708145142
Epoch: 27, Steps: 34 | Train Loss: 4.285 Vali Loss: 35.770 Vali Acc: 0.780 Test Loss: 35.770 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.608140230178833
Epoch: 28, Steps: 34 | Train Loss: 1.441 Vali Loss: 30.304 Vali Acc: 0.723 Test Loss: 30.304 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.603803396224976
Epoch: 29, Steps: 34 | Train Loss: 6.360 Vali Loss: 59.010 Vali Acc: 0.630 Test Loss: 59.010 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.774477005004883
Epoch: 30, Steps: 34 | Train Loss: 0.485 Vali Loss: 23.966 Vali Acc: 0.809 Test Loss: 23.966 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.70850944519043
Epoch: 31, Steps: 34 | Train Loss: 0.241 Vali Loss: 16.761 Vali Acc: 0.827 Test Loss: 16.761 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.5885169506073
Epoch: 32, Steps: 34 | Train Loss: 0.159 Vali Loss: 29.523 Vali Acc: 0.792 Test Loss: 29.523 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6221087
model size : 25.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.321712970733643
Epoch: 1, Steps: 34 | Train Loss: 18.371 Vali Loss: 40.949 Vali Acc: 0.283 Test Loss: 40.949 Test Acc: 0.283
Validation loss decreased (inf --> -0.282828).  Saving model ...
Epoch: 2 cost time: 4.564603328704834
Epoch: 2, Steps: 34 | Train Loss: 21.281 Vali Loss: 26.761 Vali Acc: 0.410 Test Loss: 26.761 Test Acc: 0.410
Validation loss decreased (-0.282828 --> -0.410137).  Saving model ...
Epoch: 3 cost time: 4.659494876861572
Epoch: 3, Steps: 34 | Train Loss: 12.202 Vali Loss: 24.441 Vali Acc: 0.416 Test Loss: 24.441 Test Acc: 0.416
Validation loss decreased (-0.410137 --> -0.415941).  Saving model ...
Epoch: 4 cost time: 4.81946063041687
Epoch: 4, Steps: 34 | Train Loss: 33.023 Vali Loss: 41.762 Vali Acc: 0.416 Test Loss: 41.762 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.704124927520752
Epoch: 5, Steps: 34 | Train Loss: 26.104 Vali Loss: 27.949 Vali Acc: 0.514 Test Loss: 27.949 Test Acc: 0.514
Validation loss decreased (-0.415941 --> -0.514171).  Saving model ...
Epoch: 6 cost time: 4.742914199829102
Epoch: 6, Steps: 34 | Train Loss: 32.666 Vali Loss: 54.926 Vali Acc: 0.538 Test Loss: 54.926 Test Acc: 0.538
Validation loss decreased (-0.514171 --> -0.537023).  Saving model ...
Epoch: 7 cost time: 5.086589574813843
Epoch: 7, Steps: 34 | Train Loss: 41.039 Vali Loss: 60.376 Vali Acc: 0.416 Test Loss: 60.376 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.0066001415252686
Epoch: 8, Steps: 34 | Train Loss: 16.131 Vali Loss: 37.931 Vali Acc: 0.474 Test Loss: 37.931 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.281354904174805
Epoch: 9, Steps: 34 | Train Loss: 19.339 Vali Loss: 10.722 Vali Acc: 0.751 Test Loss: 10.722 Test Acc: 0.751
Validation loss decreased (-0.537023 --> -0.751338).  Saving model ...
Epoch: 10 cost time: 5.078904628753662
Epoch: 10, Steps: 34 | Train Loss: 5.972 Vali Loss: 19.226 Vali Acc: 0.671 Test Loss: 19.226 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.04978084564209
Epoch: 11, Steps: 34 | Train Loss: 17.046 Vali Loss: 40.790 Vali Acc: 0.659 Test Loss: 40.790 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.467279672622681
Epoch: 12, Steps: 34 | Train Loss: 10.709 Vali Loss: 11.103 Vali Acc: 0.798 Test Loss: 11.103 Test Acc: 0.798
Validation loss decreased (-0.751338 --> -0.797577).  Saving model ...
Epoch: 13 cost time: 5.070354461669922
Epoch: 13, Steps: 34 | Train Loss: 5.313 Vali Loss: 42.574 Vali Acc: 0.572 Test Loss: 42.574 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.247901201248169
Epoch: 14, Steps: 34 | Train Loss: 6.499 Vali Loss: 15.598 Vali Acc: 0.786 Test Loss: 15.598 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.04163932800293
Epoch: 15, Steps: 34 | Train Loss: 7.055 Vali Loss: 38.110 Vali Acc: 0.555 Test Loss: 38.110 Test Acc: 0.555
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.147575855255127
Epoch: 16, Steps: 34 | Train Loss: 6.799 Vali Loss: 19.470 Vali Acc: 0.763 Test Loss: 19.470 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.0071752071380615
Epoch: 17, Steps: 34 | Train Loss: 7.364 Vali Loss: 37.264 Vali Acc: 0.699 Test Loss: 37.264 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.363929271697998
Epoch: 18, Steps: 34 | Train Loss: 11.082 Vali Loss: 22.365 Vali Acc: 0.786 Test Loss: 22.365 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.01159405708313
Epoch: 19, Steps: 34 | Train Loss: 5.374 Vali Loss: 31.023 Vali Acc: 0.751 Test Loss: 31.023 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.151714086532593
Epoch: 20, Steps: 34 | Train Loss: 8.807 Vali Loss: 55.822 Vali Acc: 0.642 Test Loss: 55.822 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.106553316116333
Epoch: 21, Steps: 34 | Train Loss: 4.908 Vali Loss: 19.150 Vali Acc: 0.815 Test Loss: 19.150 Test Acc: 0.815
Validation loss decreased (-0.797577 --> -0.814837).  Saving model ...
Epoch: 22 cost time: 5.208954095840454
Epoch: 22, Steps: 34 | Train Loss: 0.139 Vali Loss: 27.519 Vali Acc: 0.746 Test Loss: 27.519 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.196975469589233
Epoch: 23, Steps: 34 | Train Loss: 4.156 Vali Loss: 32.264 Vali Acc: 0.763 Test Loss: 32.264 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.955889701843262
Epoch: 24, Steps: 34 | Train Loss: 2.874 Vali Loss: 36.418 Vali Acc: 0.740 Test Loss: 36.418 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.165187358856201
Epoch: 25, Steps: 34 | Train Loss: 3.339 Vali Loss: 31.183 Vali Acc: 0.728 Test Loss: 31.183 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.384692907333374
Epoch: 26, Steps: 34 | Train Loss: 2.381 Vali Loss: 39.994 Vali Acc: 0.699 Test Loss: 39.994 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.353901624679565
Epoch: 27, Steps: 34 | Train Loss: 4.618 Vali Loss: 39.323 Vali Acc: 0.769 Test Loss: 39.323 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.551300048828125
Epoch: 28, Steps: 34 | Train Loss: 5.483 Vali Loss: 79.968 Vali Acc: 0.647 Test Loss: 79.968 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.368873596191406
Epoch: 29, Steps: 34 | Train Loss: 4.228 Vali Loss: 29.195 Vali Acc: 0.676 Test Loss: 29.195 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.243201732635498
Epoch: 30, Steps: 34 | Train Loss: 1.275 Vali Loss: 34.088 Vali Acc: 0.717 Test Loss: 34.088 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.014603853225708
Epoch: 31, Steps: 34 | Train Loss: 2.631 Vali Loss: 32.234 Vali Acc: 0.740 Test Loss: 32.234 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 6173855
model size : 24.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.614504337310791
Epoch: 1, Steps: 34 | Train Loss: 14.013 Vali Loss: 13.609 Vali Acc: 0.254 Test Loss: 13.609 Test Acc: 0.254
Validation loss decreased (inf --> -0.254199).  Saving model ...
Epoch: 2 cost time: 4.6720921993255615
Epoch: 2, Steps: 34 | Train Loss: 13.269 Vali Loss: 24.064 Vali Acc: 0.266 Test Loss: 24.064 Test Acc: 0.266
Validation loss decreased (-0.254199 --> -0.265655).  Saving model ...
Epoch: 3 cost time: 4.714761972427368
Epoch: 3, Steps: 34 | Train Loss: 23.487 Vali Loss: 27.973 Vali Acc: 0.468 Test Loss: 27.973 Test Acc: 0.468
Validation loss decreased (-0.265655 --> -0.467928).  Saving model ...
Epoch: 4 cost time: 4.844927549362183
Epoch: 4, Steps: 34 | Train Loss: 20.870 Vali Loss: 31.345 Vali Acc: 0.549 Test Loss: 31.345 Test Acc: 0.549
Validation loss decreased (-0.467928 --> -0.548819).  Saving model ...
Epoch: 5 cost time: 4.589428424835205
Epoch: 5, Steps: 34 | Train Loss: 19.811 Vali Loss: 52.562 Vali Acc: 0.393 Test Loss: 52.562 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.654400825500488
Epoch: 6, Steps: 34 | Train Loss: 41.273 Vali Loss: 90.922 Vali Acc: 0.277 Test Loss: 90.922 Test Acc: 0.277
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.849764585494995
Epoch: 7, Steps: 34 | Train Loss: 33.034 Vali Loss: 15.349 Vali Acc: 0.723 Test Loss: 15.349 Test Acc: 0.723
Validation loss decreased (-0.548819 --> -0.722390).  Saving model ...
Epoch: 8 cost time: 4.842473983764648
Epoch: 8, Steps: 34 | Train Loss: 19.495 Vali Loss: 38.973 Vali Acc: 0.601 Test Loss: 38.973 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.651155471801758
Epoch: 9, Steps: 34 | Train Loss: 29.764 Vali Loss: 16.267 Vali Acc: 0.682 Test Loss: 16.267 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.741514444351196
Epoch: 10, Steps: 34 | Train Loss: 11.078 Vali Loss: 11.644 Vali Acc: 0.763 Test Loss: 11.644 Test Acc: 0.763
Validation loss decreased (-0.722390 --> -0.762889).  Saving model ...
Epoch: 11 cost time: 4.616354942321777
Epoch: 11, Steps: 34 | Train Loss: 21.869 Vali Loss: 82.275 Vali Acc: 0.566 Test Loss: 82.275 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.320565938949585
Epoch: 12, Steps: 34 | Train Loss: 21.048 Vali Loss: 31.247 Vali Acc: 0.503 Test Loss: 31.247 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.050622224807739
Epoch: 13, Steps: 34 | Train Loss: 4.619 Vali Loss: 55.919 Vali Acc: 0.601 Test Loss: 55.919 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.587782859802246
Epoch: 14, Steps: 34 | Train Loss: 11.102 Vali Loss: 16.458 Vali Acc: 0.769 Test Loss: 16.458 Test Acc: 0.769
Validation loss decreased (-0.762889 --> -0.768622).  Saving model ...
Epoch: 15 cost time: 4.72835373878479
Epoch: 15, Steps: 34 | Train Loss: 2.591 Vali Loss: 18.488 Vali Acc: 0.798 Test Loss: 18.488 Test Acc: 0.798
Validation loss decreased (-0.768622 --> -0.797503).  Saving model ...
Epoch: 16 cost time: 4.467949151992798
Epoch: 16, Steps: 34 | Train Loss: 12.888 Vali Loss: 22.638 Vali Acc: 0.705 Test Loss: 22.638 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.865756034851074
Epoch: 17, Steps: 34 | Train Loss: 10.834 Vali Loss: 38.139 Vali Acc: 0.624 Test Loss: 38.139 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.769107103347778
Epoch: 18, Steps: 34 | Train Loss: 2.651 Vali Loss: 28.458 Vali Acc: 0.723 Test Loss: 28.458 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.777411460876465
Epoch: 19, Steps: 34 | Train Loss: 1.759 Vali Loss: 38.355 Vali Acc: 0.659 Test Loss: 38.355 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.608704328536987
Epoch: 20, Steps: 34 | Train Loss: 3.321 Vali Loss: 52.173 Vali Acc: 0.734 Test Loss: 52.173 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.617156028747559
Epoch: 21, Steps: 34 | Train Loss: 4.385 Vali Loss: 25.602 Vali Acc: 0.757 Test Loss: 25.602 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.631552457809448
Epoch: 22, Steps: 34 | Train Loss: 2.743 Vali Loss: 31.733 Vali Acc: 0.740 Test Loss: 31.733 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.617740631103516
Epoch: 23, Steps: 34 | Train Loss: 5.442 Vali Loss: 13.414 Vali Acc: 0.838 Test Loss: 13.414 Test Acc: 0.838
Validation loss decreased (-0.797503 --> -0.838016).  Saving model ...
Epoch: 24 cost time: 4.7868733406066895
Epoch: 24, Steps: 34 | Train Loss: 2.136 Vali Loss: 28.302 Vali Acc: 0.803 Test Loss: 28.302 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.8935160636901855
Epoch: 25, Steps: 34 | Train Loss: 3.771 Vali Loss: 33.859 Vali Acc: 0.682 Test Loss: 33.859 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.682588338851929
Epoch: 26, Steps: 34 | Train Loss: 0.809 Vali Loss: 15.650 Vali Acc: 0.838 Test Loss: 15.650 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.587079286575317
Epoch: 27, Steps: 34 | Train Loss: 2.388 Vali Loss: 25.279 Vali Acc: 0.792 Test Loss: 25.279 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.601133108139038
Epoch: 28, Steps: 34 | Train Loss: 0.480 Vali Loss: 42.590 Vali Acc: 0.717 Test Loss: 42.590 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.483850002288818
Epoch: 29, Steps: 34 | Train Loss: 1.438 Vali Loss: 21.805 Vali Acc: 0.775 Test Loss: 21.805 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.270539045333862
Epoch: 30, Steps: 34 | Train Loss: 3.190 Vali Loss: 33.954 Vali Acc: 0.757 Test Loss: 33.954 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.4759838581085205
Epoch: 31, Steps: 34 | Train Loss: 0.509 Vali Loss: 21.820 Vali Acc: 0.815 Test Loss: 21.820 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.735270977020264
Epoch: 32, Steps: 34 | Train Loss: 1.475 Vali Loss: 19.344 Vali Acc: 0.815 Test Loss: 19.344 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.66855525970459
Epoch: 33, Steps: 34 | Train Loss: 1.268 Vali Loss: 32.930 Vali Acc: 0.786 Test Loss: 32.930 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6173087
model size : 24.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.611088991165161
Epoch: 1, Steps: 34 | Train Loss: 9.641 Vali Loss: 15.694 Vali Acc: 0.358 Test Loss: 15.694 Test Acc: 0.358
Validation loss decreased (inf --> -0.358225).  Saving model ...
Epoch: 2 cost time: 4.6727211475372314
Epoch: 2, Steps: 34 | Train Loss: 12.066 Vali Loss: 12.021 Vali Acc: 0.347 Test Loss: 12.021 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.96004843711853
Epoch: 3, Steps: 34 | Train Loss: 26.979 Vali Loss: 24.223 Vali Acc: 0.272 Test Loss: 24.223 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.9180614948272705
Epoch: 4, Steps: 34 | Train Loss: 17.775 Vali Loss: 39.656 Vali Acc: 0.382 Test Loss: 39.656 Test Acc: 0.382
Validation loss decreased (-0.358225 --> -0.381106).  Saving model ...
Epoch: 5 cost time: 4.684086561203003
Epoch: 5, Steps: 34 | Train Loss: 29.979 Vali Loss: 123.700 Vali Acc: 0.254 Test Loss: 123.700 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.028014898300171
Epoch: 6, Steps: 34 | Train Loss: 28.404 Vali Loss: 34.750 Vali Acc: 0.566 Test Loss: 34.750 Test Acc: 0.566
Validation loss decreased (-0.381106 --> -0.566126).  Saving model ...
Epoch: 7 cost time: 5.053176164627075
Epoch: 7, Steps: 34 | Train Loss: 14.425 Vali Loss: 57.357 Vali Acc: 0.393 Test Loss: 57.357 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.762789964675903
Epoch: 8, Steps: 34 | Train Loss: 22.148 Vali Loss: 17.297 Vali Acc: 0.688 Test Loss: 17.297 Test Acc: 0.688
Validation loss decreased (-0.566126 --> -0.687688).  Saving model ...
Epoch: 9 cost time: 5.083768129348755
Epoch: 9, Steps: 34 | Train Loss: 17.872 Vali Loss: 12.610 Vali Acc: 0.717 Test Loss: 12.610 Test Acc: 0.717
Validation loss decreased (-0.687688 --> -0.716637).  Saving model ...
Epoch: 10 cost time: 4.652799844741821
Epoch: 10, Steps: 34 | Train Loss: 32.084 Vali Loss: 25.373 Vali Acc: 0.618 Test Loss: 25.373 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.859765291213989
Epoch: 11, Steps: 34 | Train Loss: 29.462 Vali Loss: 127.122 Vali Acc: 0.584 Test Loss: 127.122 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.306967496871948
Epoch: 12, Steps: 34 | Train Loss: 46.575 Vali Loss: 25.537 Vali Acc: 0.636 Test Loss: 25.537 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.4941675662994385
Epoch: 13, Steps: 34 | Train Loss: 10.798 Vali Loss: 32.996 Vali Acc: 0.751 Test Loss: 32.996 Test Acc: 0.751
Validation loss decreased (-0.716637 --> -0.751115).  Saving model ...
Epoch: 14 cost time: 4.835331678390503
Epoch: 14, Steps: 34 | Train Loss: 11.230 Vali Loss: 31.582 Vali Acc: 0.538 Test Loss: 31.582 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.942873239517212
Epoch: 15, Steps: 34 | Train Loss: 6.559 Vali Loss: 40.061 Vali Acc: 0.636 Test Loss: 40.061 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.345024824142456
Epoch: 16, Steps: 34 | Train Loss: 11.320 Vali Loss: 31.256 Vali Acc: 0.728 Test Loss: 31.256 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.789747714996338
Epoch: 17, Steps: 34 | Train Loss: 2.537 Vali Loss: 16.843 Vali Acc: 0.757 Test Loss: 16.843 Test Acc: 0.757
Validation loss decreased (-0.751115 --> -0.757057).  Saving model ...
Epoch: 18 cost time: 5.511673450469971
Epoch: 18, Steps: 34 | Train Loss: 6.075 Vali Loss: 40.025 Vali Acc: 0.642 Test Loss: 40.025 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.24772572517395
Epoch: 19, Steps: 34 | Train Loss: 17.628 Vali Loss: 61.785 Vali Acc: 0.607 Test Loss: 61.785 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.864137649536133
Epoch: 20, Steps: 34 | Train Loss: 6.412 Vali Loss: 16.632 Vali Acc: 0.815 Test Loss: 16.632 Test Acc: 0.815
Validation loss decreased (-0.757057 --> -0.814863).  Saving model ...
Epoch: 21 cost time: 4.838063478469849
Epoch: 21, Steps: 34 | Train Loss: 2.064 Vali Loss: 66.953 Vali Acc: 0.566 Test Loss: 66.953 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.899960041046143
Epoch: 22, Steps: 34 | Train Loss: 13.886 Vali Loss: 61.299 Vali Acc: 0.757 Test Loss: 61.299 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.127358436584473
Epoch: 23, Steps: 34 | Train Loss: 13.220 Vali Loss: 22.915 Vali Acc: 0.815 Test Loss: 22.915 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.099889755249023
Epoch: 24, Steps: 34 | Train Loss: 4.801 Vali Loss: 20.706 Vali Acc: 0.827 Test Loss: 20.706 Test Acc: 0.827
Validation loss decreased (-0.814863 --> -0.826383).  Saving model ...
Epoch: 25 cost time: 4.6486616134643555
Epoch: 25, Steps: 34 | Train Loss: 5.167 Vali Loss: 58.379 Vali Acc: 0.665 Test Loss: 58.379 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.858102560043335
Epoch: 26, Steps: 34 | Train Loss: 2.607 Vali Loss: 16.925 Vali Acc: 0.844 Test Loss: 16.925 Test Acc: 0.844
Validation loss decreased (-0.826383 --> -0.843761).  Saving model ...
Epoch: 27 cost time: 4.997699499130249
Epoch: 27, Steps: 34 | Train Loss: 0.312 Vali Loss: 30.708 Vali Acc: 0.809 Test Loss: 30.708 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.94291090965271
Epoch: 28, Steps: 34 | Train Loss: 0.347 Vali Loss: 30.403 Vali Acc: 0.798 Test Loss: 30.403 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.811400413513184
Epoch: 29, Steps: 34 | Train Loss: 1.522 Vali Loss: 27.689 Vali Acc: 0.734 Test Loss: 27.689 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.048256158828735
Epoch: 30, Steps: 34 | Train Loss: 1.863 Vali Loss: 70.498 Vali Acc: 0.642 Test Loss: 70.498 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.839826822280884
Epoch: 31, Steps: 34 | Train Loss: 4.454 Vali Loss: 21.332 Vali Acc: 0.809 Test Loss: 21.332 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.398414850234985
Epoch: 32, Steps: 34 | Train Loss: 0.132 Vali Loss: 24.488 Vali Acc: 0.850 Test Loss: 24.488 Test Acc: 0.850
Validation loss decreased (-0.843761 --> -0.849466).  Saving model ...
Epoch: 33 cost time: 5.081826448440552
Epoch: 33, Steps: 34 | Train Loss: 2.412 Vali Loss: 29.043 Vali Acc: 0.763 Test Loss: 29.043 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.785202264785767
Epoch: 34, Steps: 34 | Train Loss: 1.115 Vali Loss: 23.351 Vali Acc: 0.803 Test Loss: 23.351 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.857047080993652
Epoch: 35, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.194 Vali Acc: 0.809 Test Loss: 22.194 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.13161563873291
Epoch: 36, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.161 Vali Acc: 0.809 Test Loss: 22.161 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.807820796966553
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.160 Vali Acc: 0.809 Test Loss: 22.160 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.496888160705566
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.160 Vali Acc: 0.809 Test Loss: 22.160 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.246101140975952
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.160 Vali Acc: 0.809 Test Loss: 22.160 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.847745418548584
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.160 Vali Acc: 0.809 Test Loss: 22.160 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.9704060554504395
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.160 Vali Acc: 0.809 Test Loss: 22.160 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.0389649868011475
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 22.160 Vali Acc: 0.809 Test Loss: 22.160 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 6172319
model size : 24.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.236644506454468
Epoch: 1, Steps: 34 | Train Loss: 6.848 Vali Loss: 13.839 Vali Acc: 0.341 Test Loss: 13.839 Test Acc: 0.341
Validation loss decreased (inf --> -0.340902).  Saving model ...
Epoch: 2 cost time: 4.772878646850586
Epoch: 2, Steps: 34 | Train Loss: 12.168 Vali Loss: 15.543 Vali Acc: 0.370 Test Loss: 15.543 Test Acc: 0.370
Validation loss decreased (-0.340902 --> -0.369787).  Saving model ...
Epoch: 3 cost time: 4.817801475524902
Epoch: 3, Steps: 34 | Train Loss: 16.117 Vali Loss: 12.922 Vali Acc: 0.434 Test Loss: 12.922 Test Acc: 0.434
Validation loss decreased (-0.369787 --> -0.433397).  Saving model ...
Epoch: 4 cost time: 4.588929653167725
Epoch: 4, Steps: 34 | Train Loss: 19.952 Vali Loss: 23.333 Vali Acc: 0.613 Test Loss: 23.333 Test Acc: 0.613
Validation loss decreased (-0.433397 --> -0.612483).  Saving model ...
Epoch: 5 cost time: 5.3118908405303955
Epoch: 5, Steps: 34 | Train Loss: 21.932 Vali Loss: 38.474 Vali Acc: 0.520 Test Loss: 38.474 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.479998826980591
Epoch: 6, Steps: 34 | Train Loss: 21.552 Vali Loss: 21.527 Vali Acc: 0.630 Test Loss: 21.527 Test Acc: 0.630
Validation loss decreased (-0.612483 --> -0.629843).  Saving model ...
Epoch: 7 cost time: 5.023439407348633
Epoch: 7, Steps: 34 | Train Loss: 25.678 Vali Loss: 84.779 Vali Acc: 0.249 Test Loss: 84.779 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.652963876724243
Epoch: 8, Steps: 34 | Train Loss: 24.069 Vali Loss: 21.875 Vali Acc: 0.566 Test Loss: 21.875 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.082049369812012
Epoch: 9, Steps: 34 | Train Loss: 17.431 Vali Loss: 25.472 Vali Acc: 0.549 Test Loss: 25.472 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.497209787368774
Epoch: 10, Steps: 34 | Train Loss: 38.509 Vali Loss: 27.672 Vali Acc: 0.682 Test Loss: 27.672 Test Acc: 0.682
Validation loss decreased (-0.629843 --> -0.681804).  Saving model ...
Epoch: 11 cost time: 4.492923736572266
Epoch: 11, Steps: 34 | Train Loss: 23.168 Vali Loss: 35.538 Vali Acc: 0.676 Test Loss: 35.538 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.033772945404053
Epoch: 12, Steps: 34 | Train Loss: 10.297 Vali Loss: 27.977 Vali Acc: 0.688 Test Loss: 27.977 Test Acc: 0.688
Validation loss decreased (-0.681804 --> -0.687581).  Saving model ...
Epoch: 13 cost time: 4.6456098556518555
Epoch: 13, Steps: 34 | Train Loss: 7.527 Vali Loss: 15.087 Vali Acc: 0.723 Test Loss: 15.087 Test Acc: 0.723
Validation loss decreased (-0.687581 --> -0.722392).  Saving model ...
Epoch: 14 cost time: 4.790633201599121
Epoch: 14, Steps: 34 | Train Loss: 2.316 Vali Loss: 14.381 Vali Acc: 0.705 Test Loss: 14.381 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.591791152954102
Epoch: 15, Steps: 34 | Train Loss: 6.193 Vali Loss: 10.779 Vali Acc: 0.850 Test Loss: 10.779 Test Acc: 0.850
Validation loss decreased (-0.722392 --> -0.849603).  Saving model ...
Epoch: 16 cost time: 4.589489936828613
Epoch: 16, Steps: 34 | Train Loss: 7.562 Vali Loss: 31.218 Vali Acc: 0.786 Test Loss: 31.218 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.486415863037109
Epoch: 17, Steps: 34 | Train Loss: 7.399 Vali Loss: 23.916 Vali Acc: 0.734 Test Loss: 23.916 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.29296612739563
Epoch: 18, Steps: 34 | Train Loss: 2.686 Vali Loss: 27.605 Vali Acc: 0.734 Test Loss: 27.605 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.797538995742798
Epoch: 19, Steps: 34 | Train Loss: 1.025 Vali Loss: 45.161 Vali Acc: 0.630 Test Loss: 45.161 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.716154098510742
Epoch: 20, Steps: 34 | Train Loss: 3.682 Vali Loss: 20.351 Vali Acc: 0.815 Test Loss: 20.351 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.9826154708862305
Epoch: 21, Steps: 34 | Train Loss: 4.406 Vali Loss: 18.070 Vali Acc: 0.803 Test Loss: 18.070 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.902565240859985
Epoch: 22, Steps: 34 | Train Loss: 0.969 Vali Loss: 22.598 Vali Acc: 0.705 Test Loss: 22.598 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.348973035812378
Epoch: 23, Steps: 34 | Train Loss: 1.734 Vali Loss: 39.010 Vali Acc: 0.763 Test Loss: 39.010 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.634769916534424
Epoch: 24, Steps: 34 | Train Loss: 2.002 Vali Loss: 47.566 Vali Acc: 0.630 Test Loss: 47.566 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.6275410652160645
Epoch: 25, Steps: 34 | Train Loss: 12.239 Vali Loss: 11.684 Vali Acc: 0.861 Test Loss: 11.684 Test Acc: 0.861
Validation loss decreased (-0.849603 --> -0.861155).  Saving model ...
Epoch: 26 cost time: 4.8180975914001465
Epoch: 26, Steps: 34 | Train Loss: 1.117 Vali Loss: 15.629 Vali Acc: 0.832 Test Loss: 15.629 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.576404571533203
Epoch: 27, Steps: 34 | Train Loss: 0.674 Vali Loss: 25.245 Vali Acc: 0.751 Test Loss: 25.245 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.653764724731445
Epoch: 28, Steps: 34 | Train Loss: 0.620 Vali Loss: 12.272 Vali Acc: 0.861 Test Loss: 12.272 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.8252270221710205
Epoch: 29, Steps: 34 | Train Loss: 1.910 Vali Loss: 38.154 Vali Acc: 0.763 Test Loss: 38.154 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.13666296005249
Epoch: 30, Steps: 34 | Train Loss: 10.622 Vali Loss: 72.804 Vali Acc: 0.642 Test Loss: 72.804 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.459870100021362
Epoch: 31, Steps: 34 | Train Loss: 5.679 Vali Loss: 32.642 Vali Acc: 0.728 Test Loss: 32.642 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.616560697555542
Epoch: 32, Steps: 34 | Train Loss: 3.441 Vali Loss: 12.921 Vali Acc: 0.844 Test Loss: 12.921 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.55370020866394
Epoch: 33, Steps: 34 | Train Loss: 3.395 Vali Loss: 37.931 Vali Acc: 0.734 Test Loss: 37.931 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.726498126983643
Epoch: 34, Steps: 34 | Train Loss: 0.866 Vali Loss: 27.082 Vali Acc: 0.827 Test Loss: 27.082 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.703248977661133
Epoch: 35, Steps: 34 | Train Loss: 3.550 Vali Loss: 26.515 Vali Acc: 0.803 Test Loss: 26.515 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 6171551
model size : 24.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.536271572113037
Epoch: 1, Steps: 34 | Train Loss: 5.558 Vali Loss: 7.062 Vali Acc: 0.324 Test Loss: 7.062 Test Acc: 0.324
Validation loss decreased (inf --> -0.323629).  Saving model ...
Epoch: 2 cost time: 4.65874719619751
Epoch: 2, Steps: 34 | Train Loss: 8.728 Vali Loss: 7.886 Vali Acc: 0.347 Test Loss: 7.886 Test Acc: 0.347
Validation loss decreased (-0.323629 --> -0.346742).  Saving model ...
Epoch: 3 cost time: 4.423882007598877
Epoch: 3, Steps: 34 | Train Loss: 8.863 Vali Loss: 18.262 Vali Acc: 0.451 Test Loss: 18.262 Test Acc: 0.451
Validation loss decreased (-0.346742 --> -0.450684).  Saving model ...
Epoch: 4 cost time: 4.34824538230896
Epoch: 4, Steps: 34 | Train Loss: 9.425 Vali Loss: 11.976 Vali Acc: 0.439 Test Loss: 11.976 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.372498273849487
Epoch: 5, Steps: 34 | Train Loss: 9.575 Vali Loss: 10.988 Vali Acc: 0.491 Test Loss: 10.988 Test Acc: 0.491
Validation loss decreased (-0.450684 --> -0.491220).  Saving model ...
Epoch: 6 cost time: 4.392937421798706
Epoch: 6, Steps: 34 | Train Loss: 9.836 Vali Loss: 11.261 Vali Acc: 0.566 Test Loss: 11.261 Test Acc: 0.566
Validation loss decreased (-0.491220 --> -0.566361).  Saving model ...
Epoch: 7 cost time: 4.503544330596924
Epoch: 7, Steps: 34 | Train Loss: 4.221 Vali Loss: 7.630 Vali Acc: 0.601 Test Loss: 7.630 Test Acc: 0.601
Validation loss decreased (-0.566361 --> -0.601080).  Saving model ...
Epoch: 8 cost time: 4.800570011138916
Epoch: 8, Steps: 34 | Train Loss: 4.420 Vali Loss: 15.635 Vali Acc: 0.665 Test Loss: 15.635 Test Acc: 0.665
Validation loss decreased (-0.601080 --> -0.664584).  Saving model ...
Epoch: 9 cost time: 4.454746723175049
Epoch: 9, Steps: 34 | Train Loss: 6.297 Vali Loss: 10.187 Vali Acc: 0.590 Test Loss: 10.187 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.351317644119263
Epoch: 10, Steps: 34 | Train Loss: 8.435 Vali Loss: 23.435 Vali Acc: 0.595 Test Loss: 23.435 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.326562881469727
Epoch: 11, Steps: 34 | Train Loss: 6.931 Vali Loss: 17.810 Vali Acc: 0.584 Test Loss: 17.810 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.57018780708313
Epoch: 12, Steps: 34 | Train Loss: 3.395 Vali Loss: 5.146 Vali Acc: 0.775 Test Loss: 5.146 Test Acc: 0.775
Validation loss decreased (-0.664584 --> -0.774515).  Saving model ...
Epoch: 13 cost time: 4.376837730407715
Epoch: 13, Steps: 34 | Train Loss: 2.138 Vali Loss: 26.151 Vali Acc: 0.543 Test Loss: 26.151 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.615571975708008
Epoch: 14, Steps: 34 | Train Loss: 3.086 Vali Loss: 7.817 Vali Acc: 0.769 Test Loss: 7.817 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.508090496063232
Epoch: 15, Steps: 34 | Train Loss: 1.540 Vali Loss: 16.631 Vali Acc: 0.618 Test Loss: 16.631 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.797037601470947
Epoch: 16, Steps: 34 | Train Loss: 1.427 Vali Loss: 13.844 Vali Acc: 0.636 Test Loss: 13.844 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.690716981887817
Epoch: 17, Steps: 34 | Train Loss: 1.288 Vali Loss: 21.281 Vali Acc: 0.607 Test Loss: 21.281 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.971771478652954
Epoch: 18, Steps: 34 | Train Loss: 2.858 Vali Loss: 7.897 Vali Acc: 0.751 Test Loss: 7.897 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.8139660358428955
Epoch: 19, Steps: 34 | Train Loss: 1.021 Vali Loss: 8.700 Vali Acc: 0.751 Test Loss: 8.700 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.39664363861084
Epoch: 20, Steps: 34 | Train Loss: 3.447 Vali Loss: 16.762 Vali Acc: 0.734 Test Loss: 16.762 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.411862373352051
Epoch: 21, Steps: 34 | Train Loss: 1.564 Vali Loss: 10.374 Vali Acc: 0.780 Test Loss: 10.374 Test Acc: 0.780
Validation loss decreased (-0.774515 --> -0.780243).  Saving model ...
Epoch: 22 cost time: 4.068358421325684
Epoch: 22, Steps: 34 | Train Loss: 0.419 Vali Loss: 9.209 Vali Acc: 0.815 Test Loss: 9.209 Test Acc: 0.815
Validation loss decreased (-0.780243 --> -0.814937).  Saving model ...
Epoch: 23 cost time: 4.252912998199463
Epoch: 23, Steps: 34 | Train Loss: 0.357 Vali Loss: 6.894 Vali Acc: 0.809 Test Loss: 6.894 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.462451457977295
Epoch: 24, Steps: 34 | Train Loss: 7.840 Vali Loss: 18.454 Vali Acc: 0.642 Test Loss: 18.454 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.492925405502319
Epoch: 25, Steps: 34 | Train Loss: 1.951 Vali Loss: 42.233 Vali Acc: 0.457 Test Loss: 42.233 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.432662725448608
Epoch: 26, Steps: 34 | Train Loss: 1.516 Vali Loss: 11.935 Vali Acc: 0.798 Test Loss: 11.935 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.43807315826416
Epoch: 27, Steps: 34 | Train Loss: 0.489 Vali Loss: 12.143 Vali Acc: 0.792 Test Loss: 12.143 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.41149115562439
Epoch: 28, Steps: 34 | Train Loss: 2.632 Vali Loss: 13.681 Vali Acc: 0.746 Test Loss: 13.681 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.843354940414429
Epoch: 29, Steps: 34 | Train Loss: 0.511 Vali Loss: 8.964 Vali Acc: 0.838 Test Loss: 8.964 Test Acc: 0.838
Validation loss decreased (-0.814937 --> -0.838061).  Saving model ...
Epoch: 30 cost time: 4.846853017807007
Epoch: 30, Steps: 34 | Train Loss: 0.837 Vali Loss: 9.722 Vali Acc: 0.792 Test Loss: 9.722 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.835493087768555
Epoch: 31, Steps: 34 | Train Loss: 0.798 Vali Loss: 14.134 Vali Acc: 0.763 Test Loss: 14.134 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.153324842453003
Epoch: 32, Steps: 34 | Train Loss: 0.401 Vali Loss: 7.983 Vali Acc: 0.798 Test Loss: 7.983 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.8122172355651855
Epoch: 33, Steps: 34 | Train Loss: 0.939 Vali Loss: 15.659 Vali Acc: 0.775 Test Loss: 15.659 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.174747467041016
Epoch: 34, Steps: 34 | Train Loss: 0.346 Vali Loss: 15.662 Vali Acc: 0.682 Test Loss: 15.662 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.274521112442017
Epoch: 35, Steps: 34 | Train Loss: 0.203 Vali Loss: 16.953 Vali Acc: 0.792 Test Loss: 16.953 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.319683074951172
Epoch: 36, Steps: 34 | Train Loss: 0.160 Vali Loss: 11.989 Vali Acc: 0.769 Test Loss: 11.989 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.970649003982544
Epoch: 37, Steps: 34 | Train Loss: 0.805 Vali Loss: 15.211 Vali Acc: 0.728 Test Loss: 15.211 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.480787754058838
Epoch: 38, Steps: 34 | Train Loss: 1.312 Vali Loss: 16.777 Vali Acc: 0.786 Test Loss: 16.777 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.757016897201538
Epoch: 39, Steps: 34 | Train Loss: 0.193 Vali Loss: 10.209 Vali Acc: 0.867 Test Loss: 10.209 Test Acc: 0.867
Validation loss decreased (-0.838061 --> -0.866950).  Saving model ...
Epoch: 40 cost time: 4.6060569286346436
Epoch: 40, Steps: 34 | Train Loss: 0.101 Vali Loss: 7.418 Vali Acc: 0.821 Test Loss: 7.418 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.155736684799194
Epoch: 41, Steps: 34 | Train Loss: 0.275 Vali Loss: 10.325 Vali Acc: 0.815 Test Loss: 10.325 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.764415979385376
Epoch: 42, Steps: 34 | Train Loss: 0.100 Vali Loss: 12.985 Vali Acc: 0.786 Test Loss: 12.985 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.731064081192017
Epoch: 43, Steps: 34 | Train Loss: 0.105 Vali Loss: 14.503 Vali Acc: 0.786 Test Loss: 14.503 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.1273512840271
Epoch: 44, Steps: 34 | Train Loss: 0.106 Vali Loss: 12.435 Vali Acc: 0.757 Test Loss: 12.435 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.227343320846558
Epoch: 45, Steps: 34 | Train Loss: 0.263 Vali Loss: 17.230 Vali Acc: 0.763 Test Loss: 17.230 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.919849872589111
Epoch: 46, Steps: 34 | Train Loss: 0.210 Vali Loss: 10.292 Vali Acc: 0.809 Test Loss: 10.292 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 5.340390682220459
Epoch: 47, Steps: 34 | Train Loss: 0.098 Vali Loss: 12.859 Vali Acc: 0.832 Test Loss: 12.859 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 4.651324987411499
Epoch: 48, Steps: 34 | Train Loss: 0.098 Vali Loss: 10.477 Vali Acc: 0.861 Test Loss: 10.477 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 5.199622869491577
Epoch: 49, Steps: 34 | Train Loss: 0.263 Vali Loss: 21.549 Vali Acc: 0.763 Test Loss: 21.549 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 3212703
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.505867958068848
Epoch: 1, Steps: 34 | Train Loss: 3.557 Vali Loss: 6.643 Vali Acc: 0.202 Test Loss: 6.643 Test Acc: 0.202
Validation loss decreased (inf --> -0.202246).  Saving model ...
Epoch: 2 cost time: 4.454432249069214
Epoch: 2, Steps: 34 | Train Loss: 7.911 Vali Loss: 16.106 Vali Acc: 0.462 Test Loss: 16.106 Test Acc: 0.462
Validation loss decreased (-0.202246 --> -0.462267).  Saving model ...
Epoch: 3 cost time: 4.370258092880249
Epoch: 3, Steps: 34 | Train Loss: 13.794 Vali Loss: 10.315 Vali Acc: 0.474 Test Loss: 10.315 Test Acc: 0.474
Validation loss decreased (-0.462267 --> -0.473885).  Saving model ...
Epoch: 4 cost time: 4.893505573272705
Epoch: 4, Steps: 34 | Train Loss: 7.491 Vali Loss: 10.937 Vali Acc: 0.353 Test Loss: 10.937 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.715261936187744
Epoch: 5, Steps: 34 | Train Loss: 13.191 Vali Loss: 6.406 Vali Acc: 0.699 Test Loss: 6.406 Test Acc: 0.699
Validation loss decreased (-0.473885 --> -0.699358).  Saving model ...
Epoch: 6 cost time: 4.437567710876465
Epoch: 6, Steps: 34 | Train Loss: 6.837 Vali Loss: 10.447 Vali Acc: 0.676 Test Loss: 10.447 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.554098129272461
Epoch: 7, Steps: 34 | Train Loss: 8.892 Vali Loss: 5.844 Vali Acc: 0.665 Test Loss: 5.844 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.671746015548706
Epoch: 8, Steps: 34 | Train Loss: 7.896 Vali Loss: 17.136 Vali Acc: 0.636 Test Loss: 17.136 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.522653818130493
Epoch: 9, Steps: 34 | Train Loss: 13.517 Vali Loss: 12.579 Vali Acc: 0.561 Test Loss: 12.579 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.252734899520874
Epoch: 10, Steps: 34 | Train Loss: 6.733 Vali Loss: 22.776 Vali Acc: 0.561 Test Loss: 22.776 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.593905210494995
Epoch: 11, Steps: 34 | Train Loss: 5.673 Vali Loss: 15.503 Vali Acc: 0.699 Test Loss: 15.503 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.620490074157715
Epoch: 12, Steps: 34 | Train Loss: 8.128 Vali Loss: 20.275 Vali Acc: 0.630 Test Loss: 20.275 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.2759199142456055
Epoch: 13, Steps: 34 | Train Loss: 2.773 Vali Loss: 14.874 Vali Acc: 0.642 Test Loss: 14.874 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.741676330566406
Epoch: 14, Steps: 34 | Train Loss: 4.533 Vali Loss: 14.474 Vali Acc: 0.688 Test Loss: 14.474 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.374702453613281
Epoch: 15, Steps: 34 | Train Loss: 1.607 Vali Loss: 10.278 Vali Acc: 0.775 Test Loss: 10.278 Test Acc: 0.775
Validation loss decreased (-0.699358 --> -0.774464).  Saving model ...
Epoch: 16 cost time: 4.284503698348999
Epoch: 16, Steps: 34 | Train Loss: 2.256 Vali Loss: 9.267 Vali Acc: 0.763 Test Loss: 9.267 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.6290528774261475
Epoch: 17, Steps: 34 | Train Loss: 0.554 Vali Loss: 10.565 Vali Acc: 0.763 Test Loss: 10.565 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.366622686386108
Epoch: 18, Steps: 34 | Train Loss: 1.922 Vali Loss: 9.395 Vali Acc: 0.821 Test Loss: 9.395 Test Acc: 0.821
Validation loss decreased (-0.774464 --> -0.820715).  Saving model ...
Epoch: 19 cost time: 4.716613531112671
Epoch: 19, Steps: 34 | Train Loss: 1.406 Vali Loss: 12.446 Vali Acc: 0.740 Test Loss: 12.446 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.798389673233032
Epoch: 20, Steps: 34 | Train Loss: 3.075 Vali Loss: 10.737 Vali Acc: 0.780 Test Loss: 10.737 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.006847620010376
Epoch: 21, Steps: 34 | Train Loss: 0.689 Vali Loss: 35.052 Vali Acc: 0.474 Test Loss: 35.052 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.788262844085693
Epoch: 22, Steps: 34 | Train Loss: 1.629 Vali Loss: 14.170 Vali Acc: 0.699 Test Loss: 14.170 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.463006258010864
Epoch: 23, Steps: 34 | Train Loss: 2.023 Vali Loss: 21.129 Vali Acc: 0.688 Test Loss: 21.129 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.837766408920288
Epoch: 24, Steps: 34 | Train Loss: 0.811 Vali Loss: 10.376 Vali Acc: 0.763 Test Loss: 10.376 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.711369752883911
Epoch: 25, Steps: 34 | Train Loss: 0.036 Vali Loss: 8.387 Vali Acc: 0.740 Test Loss: 8.387 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.839716672897339
Epoch: 26, Steps: 34 | Train Loss: 0.373 Vali Loss: 8.617 Vali Acc: 0.803 Test Loss: 8.617 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.6699604988098145
Epoch: 27, Steps: 34 | Train Loss: 0.357 Vali Loss: 14.851 Vali Acc: 0.728 Test Loss: 14.851 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.420687675476074
Epoch: 28, Steps: 34 | Train Loss: 0.939 Vali Loss: 11.730 Vali Acc: 0.740 Test Loss: 11.730 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3212319
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.752751588821411
Epoch: 1, Steps: 34 | Train Loss: 6.404 Vali Loss: 11.683 Vali Acc: 0.410 Test Loss: 11.683 Test Acc: 0.410
Validation loss decreased (inf --> -0.410288).  Saving model ...
Epoch: 2 cost time: 5.284731149673462
Epoch: 2, Steps: 34 | Train Loss: 9.358 Vali Loss: 5.106 Vali Acc: 0.543 Test Loss: 5.106 Test Acc: 0.543
Validation loss decreased (-0.410288 --> -0.543302).  Saving model ...
Epoch: 3 cost time: 4.8619465827941895
Epoch: 3, Steps: 34 | Train Loss: 11.397 Vali Loss: 13.306 Vali Acc: 0.468 Test Loss: 13.306 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.637675046920776
Epoch: 4, Steps: 34 | Train Loss: 6.165 Vali Loss: 15.395 Vali Acc: 0.387 Test Loss: 15.395 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.543551921844482
Epoch: 5, Steps: 34 | Train Loss: 6.947 Vali Loss: 16.575 Vali Acc: 0.532 Test Loss: 16.575 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.01264500617981
Epoch: 6, Steps: 34 | Train Loss: 11.214 Vali Loss: 10.444 Vali Acc: 0.699 Test Loss: 10.444 Test Acc: 0.699
Validation loss decreased (-0.543302 --> -0.699318).  Saving model ...
Epoch: 7 cost time: 4.866469860076904
Epoch: 7, Steps: 34 | Train Loss: 8.630 Vali Loss: 12.486 Vali Acc: 0.699 Test Loss: 12.486 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.633007049560547
Epoch: 8, Steps: 34 | Train Loss: 8.722 Vali Loss: 11.659 Vali Acc: 0.566 Test Loss: 11.659 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.690014362335205
Epoch: 9, Steps: 34 | Train Loss: 3.846 Vali Loss: 12.787 Vali Acc: 0.642 Test Loss: 12.787 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.587292909622192
Epoch: 10, Steps: 34 | Train Loss: 5.188 Vali Loss: 11.466 Vali Acc: 0.694 Test Loss: 11.466 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.809367418289185
Epoch: 11, Steps: 34 | Train Loss: 8.633 Vali Loss: 35.927 Vali Acc: 0.474 Test Loss: 35.927 Test Acc: 0.474
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.742731332778931
Epoch: 12, Steps: 34 | Train Loss: 5.112 Vali Loss: 9.534 Vali Acc: 0.671 Test Loss: 9.534 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.592422723770142
Epoch: 13, Steps: 34 | Train Loss: 5.748 Vali Loss: 22.033 Vali Acc: 0.642 Test Loss: 22.033 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.932665586471558
Epoch: 14, Steps: 34 | Train Loss: 1.573 Vali Loss: 8.540 Vali Acc: 0.757 Test Loss: 8.540 Test Acc: 0.757
Validation loss decreased (-0.699318 --> -0.757140).  Saving model ...
Epoch: 15 cost time: 5.682117700576782
Epoch: 15, Steps: 34 | Train Loss: 2.333 Vali Loss: 8.409 Vali Acc: 0.734 Test Loss: 8.409 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.6250011920928955
Epoch: 16, Steps: 34 | Train Loss: 2.413 Vali Loss: 14.318 Vali Acc: 0.699 Test Loss: 14.318 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.5500264167785645
Epoch: 17, Steps: 34 | Train Loss: 1.392 Vali Loss: 17.446 Vali Acc: 0.728 Test Loss: 17.446 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.849681615829468
Epoch: 18, Steps: 34 | Train Loss: 2.382 Vali Loss: 16.499 Vali Acc: 0.746 Test Loss: 16.499 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.957971572875977
Epoch: 19, Steps: 34 | Train Loss: 2.907 Vali Loss: 10.702 Vali Acc: 0.803 Test Loss: 10.702 Test Acc: 0.803
Validation loss decreased (-0.757140 --> -0.803361).  Saving model ...
Epoch: 20 cost time: 4.788044691085815
Epoch: 20, Steps: 34 | Train Loss: 0.696 Vali Loss: 9.564 Vali Acc: 0.809 Test Loss: 9.564 Test Acc: 0.809
Validation loss decreased (-0.803361 --> -0.809153).  Saving model ...
Epoch: 21 cost time: 4.8060302734375
Epoch: 21, Steps: 34 | Train Loss: 2.275 Vali Loss: 6.658 Vali Acc: 0.809 Test Loss: 6.658 Test Acc: 0.809
Validation loss decreased (-0.809153 --> -0.809182).  Saving model ...
Epoch: 22 cost time: 5.029905080795288
Epoch: 22, Steps: 34 | Train Loss: 0.006 Vali Loss: 7.274 Vali Acc: 0.769 Test Loss: 7.274 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.837090969085693
Epoch: 23, Steps: 34 | Train Loss: 0.090 Vali Loss: 12.572 Vali Acc: 0.786 Test Loss: 12.572 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.935051679611206
Epoch: 24, Steps: 34 | Train Loss: 0.319 Vali Loss: 8.248 Vali Acc: 0.803 Test Loss: 8.248 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.514052152633667
Epoch: 25, Steps: 34 | Train Loss: 1.221 Vali Loss: 17.708 Vali Acc: 0.671 Test Loss: 17.708 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.764575958251953
Epoch: 26, Steps: 34 | Train Loss: 1.207 Vali Loss: 11.512 Vali Acc: 0.751 Test Loss: 11.512 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.238207817077637
Epoch: 27, Steps: 34 | Train Loss: 2.048 Vali Loss: 16.732 Vali Acc: 0.809 Test Loss: 16.732 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.727988958358765
Epoch: 28, Steps: 34 | Train Loss: 3.095 Vali Loss: 12.307 Vali Acc: 0.746 Test Loss: 12.307 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.190433740615845
Epoch: 29, Steps: 34 | Train Loss: 1.753 Vali Loss: 9.053 Vali Acc: 0.798 Test Loss: 9.053 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.767752408981323
Epoch: 30, Steps: 34 | Train Loss: 0.206 Vali Loss: 13.440 Vali Acc: 0.798 Test Loss: 13.440 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.646028280258179
Epoch: 31, Steps: 34 | Train Loss: 1.502 Vali Loss: 8.498 Vali Acc: 0.786 Test Loss: 8.498 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 3211935
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.617989540100098
Epoch: 1, Steps: 34 | Train Loss: 3.435 Vali Loss: 8.180 Vali Acc: 0.306 Test Loss: 8.180 Test Acc: 0.306
Validation loss decreased (inf --> -0.306277).  Saving model ...
Epoch: 2 cost time: 4.789348840713501
Epoch: 2, Steps: 34 | Train Loss: 8.597 Vali Loss: 9.375 Vali Acc: 0.393 Test Loss: 9.375 Test Acc: 0.393
Validation loss decreased (-0.306277 --> -0.392970).  Saving model ...
Epoch: 3 cost time: 4.768537998199463
Epoch: 3, Steps: 34 | Train Loss: 10.907 Vali Loss: 12.535 Vali Acc: 0.468 Test Loss: 12.535 Test Acc: 0.468
Validation loss decreased (-0.392970 --> -0.468083).  Saving model ...
Epoch: 4 cost time: 5.727297782897949
Epoch: 4, Steps: 34 | Train Loss: 10.201 Vali Loss: 11.672 Vali Acc: 0.578 Test Loss: 11.672 Test Acc: 0.578
Validation loss decreased (-0.468083 --> -0.577918).  Saving model ...
Epoch: 5 cost time: 4.612350940704346
Epoch: 5, Steps: 34 | Train Loss: 9.968 Vali Loss: 23.565 Vali Acc: 0.422 Test Loss: 23.565 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2617011070251465
Epoch: 6, Steps: 34 | Train Loss: 7.769 Vali Loss: 3.890 Vali Acc: 0.682 Test Loss: 3.890 Test Acc: 0.682
Validation loss decreased (-0.577918 --> -0.682042).  Saving model ...
Epoch: 7 cost time: 4.743300199508667
Epoch: 7, Steps: 34 | Train Loss: 7.251 Vali Loss: 21.958 Vali Acc: 0.434 Test Loss: 21.958 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7049949169158936
Epoch: 8, Steps: 34 | Train Loss: 7.670 Vali Loss: 8.212 Vali Acc: 0.688 Test Loss: 8.212 Test Acc: 0.688
Validation loss decreased (-0.682042 --> -0.687779).  Saving model ...
Epoch: 9 cost time: 4.796414613723755
Epoch: 9, Steps: 34 | Train Loss: 6.692 Vali Loss: 20.740 Vali Acc: 0.549 Test Loss: 20.740 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.832034349441528
Epoch: 10, Steps: 34 | Train Loss: 7.081 Vali Loss: 8.785 Vali Acc: 0.659 Test Loss: 8.785 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.97610068321228
Epoch: 11, Steps: 34 | Train Loss: 2.864 Vali Loss: 7.502 Vali Acc: 0.740 Test Loss: 7.502 Test Acc: 0.740
Validation loss decreased (-0.687779 --> -0.739809).  Saving model ...
Epoch: 12 cost time: 4.368178606033325
Epoch: 12, Steps: 34 | Train Loss: 3.844 Vali Loss: 13.430 Vali Acc: 0.549 Test Loss: 13.430 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.41517448425293
Epoch: 13, Steps: 34 | Train Loss: 1.840 Vali Loss: 8.807 Vali Acc: 0.763 Test Loss: 8.807 Test Acc: 0.763
Validation loss decreased (-0.739809 --> -0.762918).  Saving model ...
Epoch: 14 cost time: 4.667351007461548
Epoch: 14, Steps: 34 | Train Loss: 2.346 Vali Loss: 21.102 Vali Acc: 0.624 Test Loss: 21.102 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.812540531158447
Epoch: 15, Steps: 34 | Train Loss: 1.400 Vali Loss: 5.321 Vali Acc: 0.844 Test Loss: 5.321 Test Acc: 0.844
Validation loss decreased (-0.762918 --> -0.843877).  Saving model ...
Epoch: 16 cost time: 4.909853935241699
Epoch: 16, Steps: 34 | Train Loss: 0.949 Vali Loss: 4.062 Vali Acc: 0.803 Test Loss: 4.062 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.296258211135864
Epoch: 17, Steps: 34 | Train Loss: 1.089 Vali Loss: 6.917 Vali Acc: 0.792 Test Loss: 6.917 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.744983911514282
Epoch: 18, Steps: 34 | Train Loss: 1.135 Vali Loss: 7.523 Vali Acc: 0.751 Test Loss: 7.523 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.567310810089111
Epoch: 19, Steps: 34 | Train Loss: 1.654 Vali Loss: 10.964 Vali Acc: 0.786 Test Loss: 10.964 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.993584156036377
Epoch: 20, Steps: 34 | Train Loss: 1.099 Vali Loss: 13.887 Vali Acc: 0.740 Test Loss: 13.887 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.888684034347534
Epoch: 21, Steps: 34 | Train Loss: 1.455 Vali Loss: 16.444 Vali Acc: 0.780 Test Loss: 16.444 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.659252882003784
Epoch: 22, Steps: 34 | Train Loss: 1.556 Vali Loss: 8.318 Vali Acc: 0.803 Test Loss: 8.318 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.094523191452026
Epoch: 23, Steps: 34 | Train Loss: 1.866 Vali Loss: 8.643 Vali Acc: 0.769 Test Loss: 8.643 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.767719984054565
Epoch: 24, Steps: 34 | Train Loss: 0.044 Vali Loss: 13.414 Vali Acc: 0.786 Test Loss: 13.414 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.579311370849609
Epoch: 25, Steps: 34 | Train Loss: 0.354 Vali Loss: 12.915 Vali Acc: 0.769 Test Loss: 12.915 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3211551
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.429903268814087
Epoch: 1, Steps: 34 | Train Loss: 5.112 Vali Loss: 10.240 Vali Acc: 0.329 Test Loss: 10.240 Test Acc: 0.329
Validation loss decreased (inf --> -0.329377).  Saving model ...
Epoch: 2 cost time: 4.432463645935059
Epoch: 2, Steps: 34 | Train Loss: 12.050 Vali Loss: 7.603 Vali Acc: 0.318 Test Loss: 7.603 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.393716812133789
Epoch: 3, Steps: 34 | Train Loss: 8.672 Vali Loss: 9.069 Vali Acc: 0.370 Test Loss: 9.069 Test Acc: 0.370
Validation loss decreased (-0.329377 --> -0.369852).  Saving model ...
Epoch: 4 cost time: 4.562074899673462
Epoch: 4, Steps: 34 | Train Loss: 8.975 Vali Loss: 7.810 Vali Acc: 0.468 Test Loss: 7.810 Test Acc: 0.468
Validation loss decreased (-0.369852 --> -0.468130).  Saving model ...
Epoch: 5 cost time: 4.158392429351807
Epoch: 5, Steps: 34 | Train Loss: 6.530 Vali Loss: 15.963 Vali Acc: 0.566 Test Loss: 15.963 Test Acc: 0.566
Validation loss decreased (-0.468130 --> -0.566314).  Saving model ...
Epoch: 6 cost time: 4.639463424682617
Epoch: 6, Steps: 34 | Train Loss: 6.978 Vali Loss: 6.336 Vali Acc: 0.705 Test Loss: 6.336 Test Acc: 0.705
Validation loss decreased (-0.566314 --> -0.705139).  Saving model ...
Epoch: 7 cost time: 5.015155792236328
Epoch: 7, Steps: 34 | Train Loss: 7.483 Vali Loss: 5.742 Vali Acc: 0.688 Test Loss: 5.742 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.223110675811768
Epoch: 8, Steps: 34 | Train Loss: 11.502 Vali Loss: 25.948 Vali Acc: 0.370 Test Loss: 25.948 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.287490367889404
Epoch: 9, Steps: 34 | Train Loss: 5.360 Vali Loss: 6.962 Vali Acc: 0.769 Test Loss: 6.962 Test Acc: 0.769
Validation loss decreased (-0.705139 --> -0.768717).  Saving model ...
Epoch: 10 cost time: 4.802831649780273
Epoch: 10, Steps: 34 | Train Loss: 6.432 Vali Loss: 15.483 Vali Acc: 0.618 Test Loss: 15.483 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.3445775508880615
Epoch: 11, Steps: 34 | Train Loss: 4.542 Vali Loss: 38.514 Vali Acc: 0.486 Test Loss: 38.514 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.66218376159668
Epoch: 12, Steps: 34 | Train Loss: 5.297 Vali Loss: 32.046 Vali Acc: 0.434 Test Loss: 32.046 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.175621271133423
Epoch: 13, Steps: 34 | Train Loss: 3.991 Vali Loss: 9.542 Vali Acc: 0.803 Test Loss: 9.542 Test Acc: 0.803
Validation loss decreased (-0.768717 --> -0.803373).  Saving model ...
Epoch: 14 cost time: 4.35178279876709
Epoch: 14, Steps: 34 | Train Loss: 3.317 Vali Loss: 20.593 Vali Acc: 0.607 Test Loss: 20.593 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.513778924942017
Epoch: 15, Steps: 34 | Train Loss: 4.776 Vali Loss: 23.175 Vali Acc: 0.642 Test Loss: 23.175 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.567393779754639
Epoch: 16, Steps: 34 | Train Loss: 2.509 Vali Loss: 15.101 Vali Acc: 0.775 Test Loss: 15.101 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.475385427474976
Epoch: 17, Steps: 34 | Train Loss: 2.569 Vali Loss: 19.136 Vali Acc: 0.676 Test Loss: 19.136 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.258162975311279
Epoch: 18, Steps: 34 | Train Loss: 5.937 Vali Loss: 15.492 Vali Acc: 0.792 Test Loss: 15.492 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.8712639808654785
Epoch: 19, Steps: 34 | Train Loss: 6.663 Vali Loss: 12.963 Vali Acc: 0.699 Test Loss: 12.963 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.064012765884399
Epoch: 20, Steps: 34 | Train Loss: 2.054 Vali Loss: 6.820 Vali Acc: 0.827 Test Loss: 6.820 Test Acc: 0.827
Validation loss decreased (-0.803373 --> -0.826521).  Saving model ...
Epoch: 21 cost time: 4.654949426651001
Epoch: 21, Steps: 34 | Train Loss: 0.301 Vali Loss: 11.336 Vali Acc: 0.809 Test Loss: 11.336 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.393073558807373
Epoch: 22, Steps: 34 | Train Loss: 1.222 Vali Loss: 10.962 Vali Acc: 0.775 Test Loss: 10.962 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.270350456237793
Epoch: 23, Steps: 34 | Train Loss: 0.618 Vali Loss: 10.981 Vali Acc: 0.780 Test Loss: 10.981 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.257288217544556
Epoch: 24, Steps: 34 | Train Loss: 0.019 Vali Loss: 28.472 Vali Acc: 0.653 Test Loss: 28.472 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.2796618938446045
Epoch: 25, Steps: 34 | Train Loss: 1.224 Vali Loss: 8.422 Vali Acc: 0.827 Test Loss: 8.422 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.482330799102783
Epoch: 26, Steps: 34 | Train Loss: 0.424 Vali Loss: 11.307 Vali Acc: 0.746 Test Loss: 11.307 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.988184928894043
Epoch: 27, Steps: 34 | Train Loss: 2.269 Vali Loss: 15.399 Vali Acc: 0.647 Test Loss: 15.399 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.256869316101074
Epoch: 28, Steps: 34 | Train Loss: 1.599 Vali Loss: 18.224 Vali Acc: 0.723 Test Loss: 18.224 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.641495704650879
Epoch: 29, Steps: 34 | Train Loss: 0.233 Vali Loss: 19.312 Vali Acc: 0.775 Test Loss: 19.312 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.574239492416382
Epoch: 30, Steps: 34 | Train Loss: 0.183 Vali Loss: 11.612 Vali Acc: 0.792 Test Loss: 11.612 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3112863
model size : 12.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.262225389480591
Epoch: 1, Steps: 34 | Train Loss: 5.330 Vali Loss: 9.661 Vali Acc: 0.295 Test Loss: 9.661 Test Acc: 0.295
Validation loss decreased (inf --> -0.294701).  Saving model ...
Epoch: 2 cost time: 4.155614376068115
Epoch: 2, Steps: 34 | Train Loss: 7.224 Vali Loss: 12.928 Vali Acc: 0.358 Test Loss: 12.928 Test Acc: 0.358
Validation loss decreased (-0.294701 --> -0.358252).  Saving model ...
Epoch: 3 cost time: 4.656075716018677
Epoch: 3, Steps: 34 | Train Loss: 11.024 Vali Loss: 10.671 Vali Acc: 0.347 Test Loss: 10.671 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.372650861740112
Epoch: 4, Steps: 34 | Train Loss: 11.430 Vali Loss: 13.799 Vali Acc: 0.474 Test Loss: 13.799 Test Acc: 0.474
Validation loss decreased (-0.358252 --> -0.473850).  Saving model ...
Epoch: 5 cost time: 3.981745481491089
Epoch: 5, Steps: 34 | Train Loss: 15.402 Vali Loss: 24.227 Vali Acc: 0.566 Test Loss: 24.227 Test Acc: 0.566
Validation loss decreased (-0.473850 --> -0.566232).  Saving model ...
Epoch: 6 cost time: 4.556602954864502
Epoch: 6, Steps: 34 | Train Loss: 16.189 Vali Loss: 16.233 Vali Acc: 0.601 Test Loss: 16.233 Test Acc: 0.601
Validation loss decreased (-0.566232 --> -0.600994).  Saving model ...
Epoch: 7 cost time: 4.868496894836426
Epoch: 7, Steps: 34 | Train Loss: 10.776 Vali Loss: 19.812 Vali Acc: 0.549 Test Loss: 19.812 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.466245889663696
Epoch: 8, Steps: 34 | Train Loss: 12.987 Vali Loss: 16.509 Vali Acc: 0.642 Test Loss: 16.509 Test Acc: 0.642
Validation loss decreased (-0.600994 --> -0.641453).  Saving model ...
Epoch: 9 cost time: 5.144681215286255
Epoch: 9, Steps: 34 | Train Loss: 13.561 Vali Loss: 17.102 Vali Acc: 0.636 Test Loss: 17.102 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.6568686962127686
Epoch: 10, Steps: 34 | Train Loss: 5.941 Vali Loss: 10.553 Vali Acc: 0.676 Test Loss: 10.553 Test Acc: 0.676
Validation loss decreased (-0.641453 --> -0.676195).  Saving model ...
Epoch: 11 cost time: 4.32930850982666
Epoch: 11, Steps: 34 | Train Loss: 7.792 Vali Loss: 14.433 Vali Acc: 0.642 Test Loss: 14.433 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.406450271606445
Epoch: 12, Steps: 34 | Train Loss: 5.522 Vali Loss: 16.113 Vali Acc: 0.595 Test Loss: 16.113 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.295453071594238
Epoch: 13, Steps: 34 | Train Loss: 8.880 Vali Loss: 22.838 Vali Acc: 0.688 Test Loss: 22.838 Test Acc: 0.688
Validation loss decreased (-0.676195 --> -0.687633).  Saving model ...
Epoch: 14 cost time: 4.067028284072876
Epoch: 14, Steps: 34 | Train Loss: 2.347 Vali Loss: 19.386 Vali Acc: 0.601 Test Loss: 19.386 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.402549743652344
Epoch: 15, Steps: 34 | Train Loss: 2.104 Vali Loss: 14.966 Vali Acc: 0.676 Test Loss: 14.966 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.3819968700408936
Epoch: 16, Steps: 34 | Train Loss: 3.717 Vali Loss: 9.012 Vali Acc: 0.798 Test Loss: 9.012 Test Acc: 0.798
Validation loss decreased (-0.687633 --> -0.797598).  Saving model ...
Epoch: 17 cost time: 4.70113468170166
Epoch: 17, Steps: 34 | Train Loss: 1.795 Vali Loss: 14.039 Vali Acc: 0.688 Test Loss: 14.039 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.143877267837524
Epoch: 18, Steps: 34 | Train Loss: 1.554 Vali Loss: 13.669 Vali Acc: 0.728 Test Loss: 13.669 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.883659839630127
Epoch: 19, Steps: 34 | Train Loss: 0.569 Vali Loss: 9.676 Vali Acc: 0.728 Test Loss: 9.676 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.581270933151245
Epoch: 20, Steps: 34 | Train Loss: 3.508 Vali Loss: 22.314 Vali Acc: 0.728 Test Loss: 22.314 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.064154624938965
Epoch: 21, Steps: 34 | Train Loss: 2.049 Vali Loss: 13.611 Vali Acc: 0.740 Test Loss: 13.611 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.216594696044922
Epoch: 22, Steps: 34 | Train Loss: 2.853 Vali Loss: 11.396 Vali Acc: 0.792 Test Loss: 11.396 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.515000581741333
Epoch: 23, Steps: 34 | Train Loss: 0.704 Vali Loss: 9.653 Vali Acc: 0.821 Test Loss: 9.653 Test Acc: 0.821
Validation loss decreased (-0.797598 --> -0.820713).  Saving model ...
Epoch: 24 cost time: 4.768231391906738
Epoch: 24, Steps: 34 | Train Loss: 0.344 Vali Loss: 7.559 Vali Acc: 0.809 Test Loss: 7.559 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.880464792251587
Epoch: 25, Steps: 34 | Train Loss: 1.247 Vali Loss: 14.599 Vali Acc: 0.769 Test Loss: 14.599 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.308522462844849
Epoch: 26, Steps: 34 | Train Loss: 0.111 Vali Loss: 9.155 Vali Acc: 0.855 Test Loss: 9.155 Test Acc: 0.855
Validation loss decreased (-0.820713 --> -0.855400).  Saving model ...
Epoch: 27 cost time: 4.389378786087036
Epoch: 27, Steps: 34 | Train Loss: 0.099 Vali Loss: 15.787 Vali Acc: 0.821 Test Loss: 15.787 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.458987236022949
Epoch: 28, Steps: 34 | Train Loss: 0.121 Vali Loss: 16.780 Vali Acc: 0.809 Test Loss: 16.780 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.98747992515564
Epoch: 29, Steps: 34 | Train Loss: 1.080 Vali Loss: 11.557 Vali Acc: 0.844 Test Loss: 11.557 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.204932689666748
Epoch: 30, Steps: 34 | Train Loss: 0.251 Vali Loss: 13.395 Vali Acc: 0.786 Test Loss: 13.395 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.098621845245361
Epoch: 31, Steps: 34 | Train Loss: 1.218 Vali Loss: 33.776 Vali Acc: 0.642 Test Loss: 33.776 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.276347875595093
Epoch: 32, Steps: 34 | Train Loss: 5.722 Vali Loss: 26.877 Vali Acc: 0.647 Test Loss: 26.877 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.229487419128418
Epoch: 33, Steps: 34 | Train Loss: 1.688 Vali Loss: 7.807 Vali Acc: 0.809 Test Loss: 7.807 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.269041538238525
Epoch: 34, Steps: 34 | Train Loss: 0.292 Vali Loss: 11.848 Vali Acc: 0.792 Test Loss: 11.848 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.152322769165039
Epoch: 35, Steps: 34 | Train Loss: 0.028 Vali Loss: 14.171 Vali Acc: 0.780 Test Loss: 14.171 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.555676698684692
Epoch: 36, Steps: 34 | Train Loss: 0.345 Vali Loss: 8.497 Vali Acc: 0.821 Test Loss: 8.497 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 3112479
model size : 12.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.145865201950073
Epoch: 1, Steps: 34 | Train Loss: 3.914 Vali Loss: 8.827 Vali Acc: 0.139 Test Loss: 8.827 Test Acc: 0.139
Validation loss decreased (inf --> -0.138640).  Saving model ...
Epoch: 2 cost time: 3.9257991313934326
Epoch: 2, Steps: 34 | Train Loss: 7.424 Vali Loss: 11.445 Vali Acc: 0.260 Test Loss: 11.445 Test Acc: 0.260
Validation loss decreased (-0.138640 --> -0.260001).  Saving model ...
Epoch: 3 cost time: 3.993083953857422
Epoch: 3, Steps: 34 | Train Loss: 12.640 Vali Loss: 16.376 Vali Acc: 0.266 Test Loss: 16.376 Test Acc: 0.266
Validation loss decreased (-0.260001 --> -0.265732).  Saving model ...
Epoch: 4 cost time: 4.103761196136475
Epoch: 4, Steps: 34 | Train Loss: 9.195 Vali Loss: 12.592 Vali Acc: 0.451 Test Loss: 12.592 Test Acc: 0.451
Validation loss decreased (-0.265732 --> -0.450741).  Saving model ...
Epoch: 5 cost time: 4.104774713516235
Epoch: 5, Steps: 34 | Train Loss: 9.513 Vali Loss: 18.570 Vali Acc: 0.399 Test Loss: 18.570 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.929936170578003
Epoch: 6, Steps: 34 | Train Loss: 16.471 Vali Loss: 23.666 Vali Acc: 0.566 Test Loss: 23.666 Test Acc: 0.566
Validation loss decreased (-0.450741 --> -0.566237).  Saving model ...
Epoch: 7 cost time: 4.210675001144409
Epoch: 7, Steps: 34 | Train Loss: 6.509 Vali Loss: 10.641 Vali Acc: 0.532 Test Loss: 10.641 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.890536069869995
Epoch: 8, Steps: 34 | Train Loss: 4.749 Vali Loss: 11.836 Vali Acc: 0.532 Test Loss: 11.836 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.007528066635132
Epoch: 9, Steps: 34 | Train Loss: 6.667 Vali Loss: 20.590 Vali Acc: 0.399 Test Loss: 20.590 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.448389768600464
Epoch: 10, Steps: 34 | Train Loss: 6.351 Vali Loss: 8.405 Vali Acc: 0.688 Test Loss: 8.405 Test Acc: 0.688
Validation loss decreased (-0.566237 --> -0.687777).  Saving model ...
Epoch: 11 cost time: 3.9942715167999268
Epoch: 11, Steps: 34 | Train Loss: 7.030 Vali Loss: 24.458 Vali Acc: 0.491 Test Loss: 24.458 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.1303017139434814
Epoch: 12, Steps: 34 | Train Loss: 7.382 Vali Loss: 12.882 Vali Acc: 0.671 Test Loss: 12.882 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6340131759643555
Epoch: 13, Steps: 34 | Train Loss: 2.580 Vali Loss: 12.071 Vali Acc: 0.671 Test Loss: 12.071 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.388949871063232
Epoch: 14, Steps: 34 | Train Loss: 4.202 Vali Loss: 34.497 Vali Acc: 0.543 Test Loss: 34.497 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.69210147857666
Epoch: 15, Steps: 34 | Train Loss: 4.508 Vali Loss: 14.114 Vali Acc: 0.734 Test Loss: 14.114 Test Acc: 0.734
Validation loss decreased (-0.687777 --> -0.733963).  Saving model ...
Epoch: 16 cost time: 3.8416545391082764
Epoch: 16, Steps: 34 | Train Loss: 2.191 Vali Loss: 7.923 Vali Acc: 0.809 Test Loss: 7.923 Test Acc: 0.809
Validation loss decreased (-0.733963 --> -0.809169).  Saving model ...
Epoch: 17 cost time: 3.5123770236968994
Epoch: 17, Steps: 34 | Train Loss: 1.210 Vali Loss: 29.693 Vali Acc: 0.676 Test Loss: 29.693 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.954880475997925
Epoch: 18, Steps: 34 | Train Loss: 6.105 Vali Loss: 14.841 Vali Acc: 0.734 Test Loss: 14.841 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8513355255126953
Epoch: 19, Steps: 34 | Train Loss: 0.804 Vali Loss: 12.915 Vali Acc: 0.763 Test Loss: 12.915 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.962350845336914
Epoch: 20, Steps: 34 | Train Loss: 0.572 Vali Loss: 6.098 Vali Acc: 0.879 Test Loss: 6.098 Test Acc: 0.879
Validation loss decreased (-0.809169 --> -0.878552).  Saving model ...
Epoch: 21 cost time: 3.450115919113159
Epoch: 21, Steps: 34 | Train Loss: 0.000 Vali Loss: 9.026 Vali Acc: 0.798 Test Loss: 9.026 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.145338773727417
Epoch: 22, Steps: 34 | Train Loss: 0.136 Vali Loss: 5.293 Vali Acc: 0.884 Test Loss: 5.293 Test Acc: 0.884
Validation loss decreased (-0.878552 --> -0.884340).  Saving model ...
Epoch: 23 cost time: 3.921285629272461
Epoch: 23, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.887 Vali Acc: 0.861 Test Loss: 5.887 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.509331226348877
Epoch: 24, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.907 Vali Acc: 0.861 Test Loss: 5.907 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.187671661376953
Epoch: 25, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.907 Vali Acc: 0.861 Test Loss: 5.907 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.080392122268677
Epoch: 26, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.165525436401367
Epoch: 27, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.8109633922576904
Epoch: 28, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.1881773471832275
Epoch: 29, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.943748712539673
Epoch: 30, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.019737243652344
Epoch: 31, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.773287057876587
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.861 Test Loss: 5.906 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 3112095
model size : 12.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.650742769241333
Epoch: 1, Steps: 34 | Train Loss: 4.297 Vali Loss: 2.987 Vali Acc: 0.410 Test Loss: 2.987 Test Acc: 0.410
Validation loss decreased (inf --> -0.410375).  Saving model ...
Epoch: 2 cost time: 4.083999872207642
Epoch: 2, Steps: 34 | Train Loss: 9.316 Vali Loss: 20.604 Vali Acc: 0.318 Test Loss: 20.604 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.286434888839722
Epoch: 3, Steps: 34 | Train Loss: 16.285 Vali Loss: 31.060 Vali Acc: 0.283 Test Loss: 31.060 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.924938440322876
Epoch: 4, Steps: 34 | Train Loss: 11.612 Vali Loss: 13.657 Vali Acc: 0.578 Test Loss: 13.657 Test Acc: 0.578
Validation loss decreased (-0.410375 --> -0.577898).  Saving model ...
Epoch: 5 cost time: 3.7419137954711914
Epoch: 5, Steps: 34 | Train Loss: 12.501 Vali Loss: 7.445 Vali Acc: 0.578 Test Loss: 7.445 Test Acc: 0.578
Validation loss decreased (-0.577898 --> -0.577960).  Saving model ...
Epoch: 6 cost time: 4.250986099243164
Epoch: 6, Steps: 34 | Train Loss: 7.249 Vali Loss: 11.975 Vali Acc: 0.561 Test Loss: 11.975 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.207473039627075
Epoch: 7, Steps: 34 | Train Loss: 8.626 Vali Loss: 8.696 Vali Acc: 0.543 Test Loss: 8.696 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.117940902709961
Epoch: 8, Steps: 34 | Train Loss: 3.075 Vali Loss: 16.934 Vali Acc: 0.584 Test Loss: 16.934 Test Acc: 0.584
Validation loss decreased (-0.577960 --> -0.583646).  Saving model ...
Epoch: 9 cost time: 4.098384857177734
Epoch: 9, Steps: 34 | Train Loss: 10.498 Vali Loss: 17.119 Vali Acc: 0.572 Test Loss: 17.119 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.275050640106201
Epoch: 10, Steps: 34 | Train Loss: 9.763 Vali Loss: 14.339 Vali Acc: 0.671 Test Loss: 14.339 Test Acc: 0.671
Validation loss decreased (-0.583646 --> -0.670377).  Saving model ...
Epoch: 11 cost time: 4.67621111869812
Epoch: 11, Steps: 34 | Train Loss: 8.628 Vali Loss: 13.828 Vali Acc: 0.590 Test Loss: 13.828 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.388215780258179
Epoch: 12, Steps: 34 | Train Loss: 3.886 Vali Loss: 21.926 Vali Acc: 0.514 Test Loss: 21.926 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.242648363113403
Epoch: 13, Steps: 34 | Train Loss: 4.692 Vali Loss: 19.556 Vali Acc: 0.613 Test Loss: 19.556 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.282137870788574
Epoch: 14, Steps: 34 | Train Loss: 4.325 Vali Loss: 13.835 Vali Acc: 0.751 Test Loss: 13.835 Test Acc: 0.751
Validation loss decreased (-0.670377 --> -0.751307).  Saving model ...
Epoch: 15 cost time: 4.946108102798462
Epoch: 15, Steps: 34 | Train Loss: 1.869 Vali Loss: 7.006 Vali Acc: 0.809 Test Loss: 7.006 Test Acc: 0.809
Validation loss decreased (-0.751307 --> -0.809178).  Saving model ...
Epoch: 16 cost time: 4.1489667892456055
Epoch: 16, Steps: 34 | Train Loss: 0.257 Vali Loss: 17.509 Vali Acc: 0.682 Test Loss: 17.509 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.188344955444336
Epoch: 17, Steps: 34 | Train Loss: 3.483 Vali Loss: 32.989 Vali Acc: 0.595 Test Loss: 32.989 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.11552619934082
Epoch: 18, Steps: 34 | Train Loss: 7.113 Vali Loss: 32.624 Vali Acc: 0.549 Test Loss: 32.624 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.428972482681274
Epoch: 19, Steps: 34 | Train Loss: 4.916 Vali Loss: 14.403 Vali Acc: 0.780 Test Loss: 14.403 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8686084747314453
Epoch: 20, Steps: 34 | Train Loss: 2.108 Vali Loss: 20.211 Vali Acc: 0.699 Test Loss: 20.211 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.176996469497681
Epoch: 21, Steps: 34 | Train Loss: 0.497 Vali Loss: 5.239 Vali Acc: 0.792 Test Loss: 5.239 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.5860414505004883
Epoch: 22, Steps: 34 | Train Loss: 0.274 Vali Loss: 16.748 Vali Acc: 0.705 Test Loss: 16.748 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6838631629943848
Epoch: 23, Steps: 34 | Train Loss: 0.288 Vali Loss: 6.244 Vali Acc: 0.798 Test Loss: 6.244 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.8229057788848877
Epoch: 24, Steps: 34 | Train Loss: 2.140 Vali Loss: 17.533 Vali Acc: 0.705 Test Loss: 17.533 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.47428822517395
Epoch: 25, Steps: 34 | Train Loss: 0.609 Vali Loss: 9.406 Vali Acc: 0.803 Test Loss: 9.406 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 3111711
model size : 12.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.8970396518707275
Epoch: 1, Steps: 34 | Train Loss: 5.756 Vali Loss: 7.997 Vali Acc: 0.312 Test Loss: 7.997 Test Acc: 0.312
Validation loss decreased (inf --> -0.312059).  Saving model ...
Epoch: 2 cost time: 3.834703207015991
Epoch: 2, Steps: 34 | Train Loss: 10.392 Vali Loss: 7.572 Vali Acc: 0.434 Test Loss: 7.572 Test Acc: 0.434
Validation loss decreased (-0.312059 --> -0.433450).  Saving model ...
Epoch: 3 cost time: 4.903785228729248
Epoch: 3, Steps: 34 | Train Loss: 11.169 Vali Loss: 5.725 Vali Acc: 0.584 Test Loss: 5.725 Test Acc: 0.584
Validation loss decreased (-0.433450 --> -0.583758).  Saving model ...
Epoch: 4 cost time: 3.7856650352478027
Epoch: 4, Steps: 34 | Train Loss: 8.839 Vali Loss: 8.629 Vali Acc: 0.462 Test Loss: 8.629 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.322879791259766
Epoch: 5, Steps: 34 | Train Loss: 7.639 Vali Loss: 12.716 Vali Acc: 0.480 Test Loss: 12.716 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.185418128967285
Epoch: 6, Steps: 34 | Train Loss: 9.977 Vali Loss: 21.659 Vali Acc: 0.445 Test Loss: 21.659 Test Acc: 0.445
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.814460039138794
Epoch: 7, Steps: 34 | Train Loss: 15.645 Vali Loss: 24.509 Vali Acc: 0.370 Test Loss: 24.509 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.919499635696411
Epoch: 8, Steps: 34 | Train Loss: 10.919 Vali Loss: 12.865 Vali Acc: 0.630 Test Loss: 12.865 Test Acc: 0.630
Validation loss decreased (-0.583758 --> -0.629929).  Saving model ...
Epoch: 9 cost time: 4.013502836227417
Epoch: 9, Steps: 34 | Train Loss: 4.282 Vali Loss: 12.440 Vali Acc: 0.595 Test Loss: 12.440 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.748614549636841
Epoch: 10, Steps: 34 | Train Loss: 6.667 Vali Loss: 32.391 Vali Acc: 0.457 Test Loss: 32.391 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9772591590881348
Epoch: 11, Steps: 34 | Train Loss: 11.483 Vali Loss: 15.105 Vali Acc: 0.711 Test Loss: 15.105 Test Acc: 0.711
Validation loss decreased (-0.629929 --> -0.710832).  Saving model ...
Epoch: 12 cost time: 3.7999260425567627
Epoch: 12, Steps: 34 | Train Loss: 7.555 Vali Loss: 12.077 Vali Acc: 0.682 Test Loss: 12.077 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9430596828460693
Epoch: 13, Steps: 34 | Train Loss: 2.930 Vali Loss: 9.714 Vali Acc: 0.751 Test Loss: 9.714 Test Acc: 0.751
Validation loss decreased (-0.710832 --> -0.751348).  Saving model ...
Epoch: 14 cost time: 4.568976640701294
Epoch: 14, Steps: 34 | Train Loss: 2.488 Vali Loss: 12.273 Vali Acc: 0.642 Test Loss: 12.273 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.605940818786621
Epoch: 15, Steps: 34 | Train Loss: 1.784 Vali Loss: 6.179 Vali Acc: 0.803 Test Loss: 6.179 Test Acc: 0.803
Validation loss decreased (-0.751348 --> -0.803406).  Saving model ...
Epoch: 16 cost time: 5.007517576217651
Epoch: 16, Steps: 34 | Train Loss: 4.798 Vali Loss: 32.023 Vali Acc: 0.694 Test Loss: 32.023 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.2165539264678955
Epoch: 17, Steps: 34 | Train Loss: 5.521 Vali Loss: 6.008 Vali Acc: 0.821 Test Loss: 6.008 Test Acc: 0.821
Validation loss decreased (-0.803406 --> -0.820749).  Saving model ...
Epoch: 18 cost time: 4.335484981536865
Epoch: 18, Steps: 34 | Train Loss: 1.567 Vali Loss: 13.124 Vali Acc: 0.636 Test Loss: 13.124 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.396603345870972
Epoch: 19, Steps: 34 | Train Loss: 0.728 Vali Loss: 12.728 Vali Acc: 0.769 Test Loss: 12.728 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.847934246063232
Epoch: 20, Steps: 34 | Train Loss: 3.673 Vali Loss: 11.395 Vali Acc: 0.694 Test Loss: 11.395 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.046947479248047
Epoch: 21, Steps: 34 | Train Loss: 3.389 Vali Loss: 12.286 Vali Acc: 0.780 Test Loss: 12.286 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.940474271774292
Epoch: 22, Steps: 34 | Train Loss: 0.393 Vali Loss: 11.324 Vali Acc: 0.798 Test Loss: 11.324 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.5419580936431885
Epoch: 23, Steps: 34 | Train Loss: 0.439 Vali Loss: 20.235 Vali Acc: 0.688 Test Loss: 20.235 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.8345787525177
Epoch: 24, Steps: 34 | Train Loss: 1.845 Vali Loss: 13.131 Vali Acc: 0.740 Test Loss: 13.131 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.7234179973602295
Epoch: 25, Steps: 34 | Train Loss: 0.892 Vali Loss: 13.535 Vali Acc: 0.786 Test Loss: 13.535 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.24762749671936
Epoch: 26, Steps: 34 | Train Loss: 0.784 Vali Loss: 22.884 Vali Acc: 0.647 Test Loss: 22.884 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.600827693939209
Epoch: 27, Steps: 34 | Train Loss: 1.049 Vali Loss: 18.580 Vali Acc: 0.728 Test Loss: 18.580 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3062943
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.334702968597412
Epoch: 1, Steps: 34 | Train Loss: 4.878 Vali Loss: 7.028 Vali Acc: 0.318 Test Loss: 7.028 Test Acc: 0.318
Validation loss decreased (inf --> -0.317849).  Saving model ...
Epoch: 2 cost time: 4.454444408416748
Epoch: 2, Steps: 34 | Train Loss: 9.278 Vali Loss: 15.747 Vali Acc: 0.312 Test Loss: 15.747 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.335407972335815
Epoch: 3, Steps: 34 | Train Loss: 10.242 Vali Loss: 13.444 Vali Acc: 0.410 Test Loss: 13.444 Test Acc: 0.410
Validation loss decreased (-0.317849 --> -0.410270).  Saving model ...
Epoch: 4 cost time: 4.576277732849121
Epoch: 4, Steps: 34 | Train Loss: 8.710 Vali Loss: 20.843 Vali Acc: 0.439 Test Loss: 20.843 Test Acc: 0.439
Validation loss decreased (-0.410270 --> -0.439098).  Saving model ...
Epoch: 5 cost time: 4.843025207519531
Epoch: 5, Steps: 34 | Train Loss: 12.692 Vali Loss: 12.237 Vali Acc: 0.503 Test Loss: 12.237 Test Acc: 0.503
Validation loss decreased (-0.439098 --> -0.502768).  Saving model ...
Epoch: 6 cost time: 4.87147855758667
Epoch: 6, Steps: 34 | Train Loss: 13.241 Vali Loss: 25.476 Vali Acc: 0.439 Test Loss: 25.476 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.231566667556763
Epoch: 7, Steps: 34 | Train Loss: 13.452 Vali Loss: 6.424 Vali Acc: 0.723 Test Loss: 6.424 Test Acc: 0.723
Validation loss decreased (-0.502768 --> -0.722479).  Saving model ...
Epoch: 8 cost time: 5.016358137130737
Epoch: 8, Steps: 34 | Train Loss: 6.099 Vali Loss: 16.782 Vali Acc: 0.503 Test Loss: 16.782 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.611943244934082
Epoch: 9, Steps: 34 | Train Loss: 7.123 Vali Loss: 17.787 Vali Acc: 0.480 Test Loss: 17.787 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.6787497997283936
Epoch: 10, Steps: 34 | Train Loss: 7.301 Vali Loss: 7.295 Vali Acc: 0.723 Test Loss: 7.295 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.171997308731079
Epoch: 11, Steps: 34 | Train Loss: 7.257 Vali Loss: 28.748 Vali Acc: 0.451 Test Loss: 28.748 Test Acc: 0.451
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.74121618270874
Epoch: 12, Steps: 34 | Train Loss: 10.831 Vali Loss: 20.325 Vali Acc: 0.532 Test Loss: 20.325 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.4467058181762695
Epoch: 13, Steps: 34 | Train Loss: 4.996 Vali Loss: 25.836 Vali Acc: 0.699 Test Loss: 25.836 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.457842111587524
Epoch: 14, Steps: 34 | Train Loss: 4.038 Vali Loss: 18.238 Vali Acc: 0.630 Test Loss: 18.238 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.226817846298218
Epoch: 15, Steps: 34 | Train Loss: 5.413 Vali Loss: 14.191 Vali Acc: 0.624 Test Loss: 14.191 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.58921480178833
Epoch: 16, Steps: 34 | Train Loss: 2.527 Vali Loss: 10.162 Vali Acc: 0.711 Test Loss: 10.162 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.7420220375061035
Epoch: 17, Steps: 34 | Train Loss: 2.927 Vali Loss: 13.354 Vali Acc: 0.705 Test Loss: 13.354 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7225433526011561
model parameter : 3062559
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.508037328720093
Epoch: 1, Steps: 34 | Train Loss: 5.480 Vali Loss: 4.378 Vali Acc: 0.347 Test Loss: 4.378 Test Acc: 0.347
Validation loss decreased (inf --> -0.346777).  Saving model ...
Epoch: 2 cost time: 4.390007257461548
Epoch: 2, Steps: 34 | Train Loss: 8.115 Vali Loss: 10.205 Vali Acc: 0.335 Test Loss: 10.205 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.255003213882446
Epoch: 3, Steps: 34 | Train Loss: 9.389 Vali Loss: 7.050 Vali Acc: 0.538 Test Loss: 7.050 Test Acc: 0.538
Validation loss decreased (-0.346777 --> -0.537502).  Saving model ...
Epoch: 4 cost time: 4.737658977508545
Epoch: 4, Steps: 34 | Train Loss: 9.678 Vali Loss: 15.454 Vali Acc: 0.410 Test Loss: 15.454 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.329493999481201
Epoch: 5, Steps: 34 | Train Loss: 9.512 Vali Loss: 24.347 Vali Acc: 0.480 Test Loss: 24.347 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.627729415893555
Epoch: 6, Steps: 34 | Train Loss: 18.452 Vali Loss: 21.334 Vali Acc: 0.410 Test Loss: 21.334 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.399866342544556
Epoch: 7, Steps: 34 | Train Loss: 13.861 Vali Loss: 16.364 Vali Acc: 0.514 Test Loss: 16.364 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.0445780754089355
Epoch: 8, Steps: 34 | Train Loss: 12.692 Vali Loss: 32.754 Vali Acc: 0.428 Test Loss: 32.754 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.439905643463135
Epoch: 9, Steps: 34 | Train Loss: 15.690 Vali Loss: 9.646 Vali Acc: 0.607 Test Loss: 9.646 Test Acc: 0.607
Validation loss decreased (-0.537502 --> -0.606840).  Saving model ...
Epoch: 10 cost time: 4.319915294647217
Epoch: 10, Steps: 34 | Train Loss: 6.293 Vali Loss: 19.862 Vali Acc: 0.566 Test Loss: 19.862 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.173255681991577
Epoch: 11, Steps: 34 | Train Loss: 8.741 Vali Loss: 14.149 Vali Acc: 0.590 Test Loss: 14.149 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.113882541656494
Epoch: 12, Steps: 34 | Train Loss: 6.072 Vali Loss: 28.396 Vali Acc: 0.480 Test Loss: 28.396 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.956650972366333
Epoch: 13, Steps: 34 | Train Loss: 11.024 Vali Loss: 21.551 Vali Acc: 0.549 Test Loss: 21.551 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.854724168777466
Epoch: 14, Steps: 34 | Train Loss: 5.477 Vali Loss: 8.378 Vali Acc: 0.757 Test Loss: 8.378 Test Acc: 0.757
Validation loss decreased (-0.606840 --> -0.757142).  Saving model ...
Epoch: 15 cost time: 4.358427286148071
Epoch: 15, Steps: 34 | Train Loss: 3.835 Vali Loss: 11.113 Vali Acc: 0.757 Test Loss: 11.113 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.112896203994751
Epoch: 16, Steps: 34 | Train Loss: 3.368 Vali Loss: 13.714 Vali Acc: 0.699 Test Loss: 13.714 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.8020429611206055
Epoch: 17, Steps: 34 | Train Loss: 6.716 Vali Loss: 10.341 Vali Acc: 0.746 Test Loss: 10.341 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.370214939117432
Epoch: 18, Steps: 34 | Train Loss: 2.702 Vali Loss: 19.235 Vali Acc: 0.647 Test Loss: 19.235 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.3608012199401855
Epoch: 19, Steps: 34 | Train Loss: 0.877 Vali Loss: 8.835 Vali Acc: 0.751 Test Loss: 8.835 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.44743800163269
Epoch: 20, Steps: 34 | Train Loss: 0.239 Vali Loss: 11.618 Vali Acc: 0.751 Test Loss: 11.618 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.293603181838989
Epoch: 21, Steps: 34 | Train Loss: 2.918 Vali Loss: 47.574 Vali Acc: 0.572 Test Loss: 47.574 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.486403703689575
Epoch: 22, Steps: 34 | Train Loss: 3.719 Vali Loss: 15.083 Vali Acc: 0.775 Test Loss: 15.083 Test Acc: 0.775
Validation loss decreased (-0.757142 --> -0.774416).  Saving model ...
Epoch: 23 cost time: 4.492497682571411
Epoch: 23, Steps: 34 | Train Loss: 0.979 Vali Loss: 26.025 Vali Acc: 0.723 Test Loss: 26.025 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.21001672744751
Epoch: 24, Steps: 34 | Train Loss: 1.264 Vali Loss: 8.062 Vali Acc: 0.832 Test Loss: 8.062 Test Acc: 0.832
Validation loss decreased (-0.774416 --> -0.832289).  Saving model ...
Epoch: 25 cost time: 4.263922214508057
Epoch: 25, Steps: 34 | Train Loss: 1.342 Vali Loss: 37.834 Vali Acc: 0.601 Test Loss: 37.834 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.0430357456207275
Epoch: 26, Steps: 34 | Train Loss: 6.126 Vali Loss: 13.537 Vali Acc: 0.757 Test Loss: 13.537 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.336364030838013
Epoch: 27, Steps: 34 | Train Loss: 0.629 Vali Loss: 16.224 Vali Acc: 0.740 Test Loss: 16.224 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.442330598831177
Epoch: 28, Steps: 34 | Train Loss: 0.567 Vali Loss: 7.708 Vali Acc: 0.855 Test Loss: 7.708 Test Acc: 0.855
Validation loss decreased (-0.832289 --> -0.855414).  Saving model ...
Epoch: 29 cost time: 4.741137504577637
Epoch: 29, Steps: 34 | Train Loss: 0.747 Vali Loss: 14.941 Vali Acc: 0.734 Test Loss: 14.941 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.149890184402466
Epoch: 30, Steps: 34 | Train Loss: 0.375 Vali Loss: 34.300 Vali Acc: 0.647 Test Loss: 34.300 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.543283939361572
Epoch: 31, Steps: 34 | Train Loss: 1.930 Vali Loss: 11.990 Vali Acc: 0.821 Test Loss: 11.990 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.799036026000977
Epoch: 32, Steps: 34 | Train Loss: 1.419 Vali Loss: 11.530 Vali Acc: 0.809 Test Loss: 11.530 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.303714990615845
Epoch: 33, Steps: 34 | Train Loss: 0.696 Vali Loss: 18.598 Vali Acc: 0.694 Test Loss: 18.598 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.591680288314819
Epoch: 34, Steps: 34 | Train Loss: 0.481 Vali Loss: 5.122 Vali Acc: 0.861 Test Loss: 5.122 Test Acc: 0.861
Validation loss decreased (-0.855414 --> -0.861220).  Saving model ...
Epoch: 35 cost time: 4.112048387527466
Epoch: 35, Steps: 34 | Train Loss: 0.997 Vali Loss: 13.115 Vali Acc: 0.838 Test Loss: 13.115 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.546756029129028
Epoch: 36, Steps: 34 | Train Loss: 2.302 Vali Loss: 21.019 Vali Acc: 0.775 Test Loss: 21.019 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.005802869796753
Epoch: 37, Steps: 34 | Train Loss: 1.270 Vali Loss: 10.359 Vali Acc: 0.809 Test Loss: 10.359 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.817368268966675
Epoch: 38, Steps: 34 | Train Loss: 0.911 Vali Loss: 8.904 Vali Acc: 0.861 Test Loss: 8.904 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.238461971282959
Epoch: 39, Steps: 34 | Train Loss: 0.036 Vali Loss: 20.375 Vali Acc: 0.734 Test Loss: 20.375 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.215427875518799
Epoch: 40, Steps: 34 | Train Loss: 0.169 Vali Loss: 9.744 Vali Acc: 0.827 Test Loss: 9.744 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.098686933517456
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 11.018 Vali Acc: 0.809 Test Loss: 11.018 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.49442720413208
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 11.056 Vali Acc: 0.809 Test Loss: 11.056 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.12824559211731
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 11.057 Vali Acc: 0.809 Test Loss: 11.057 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.108295917510986
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 11.055 Vali Acc: 0.809 Test Loss: 11.055 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3062175
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.699250936508179
Epoch: 1, Steps: 34 | Train Loss: 6.586 Vali Loss: 7.712 Vali Acc: 0.277 Test Loss: 7.712 Test Acc: 0.277
Validation loss decreased (inf --> -0.277380).  Saving model ...
Epoch: 2 cost time: 3.9185056686401367
Epoch: 2, Steps: 34 | Train Loss: 8.394 Vali Loss: 10.117 Vali Acc: 0.358 Test Loss: 10.117 Test Acc: 0.358
Validation loss decreased (-0.277380 --> -0.358280).  Saving model ...
Epoch: 3 cost time: 3.8315885066986084
Epoch: 3, Steps: 34 | Train Loss: 9.176 Vali Loss: 7.410 Vali Acc: 0.613 Test Loss: 7.410 Test Acc: 0.613
Validation loss decreased (-0.358280 --> -0.612643).  Saving model ...
Epoch: 4 cost time: 4.41785192489624
Epoch: 4, Steps: 34 | Train Loss: 8.050 Vali Loss: 20.290 Vali Acc: 0.410 Test Loss: 20.290 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5340538024902344
Epoch: 5, Steps: 34 | Train Loss: 13.182 Vali Loss: 24.460 Vali Acc: 0.387 Test Loss: 24.460 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.702540874481201
Epoch: 6, Steps: 34 | Train Loss: 8.545 Vali Loss: 5.691 Vali Acc: 0.601 Test Loss: 5.691 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.337239027023315
Epoch: 7, Steps: 34 | Train Loss: 12.615 Vali Loss: 27.825 Vali Acc: 0.468 Test Loss: 27.825 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5686495304107666
Epoch: 8, Steps: 34 | Train Loss: 10.749 Vali Loss: 11.548 Vali Acc: 0.538 Test Loss: 11.548 Test Acc: 0.538
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6837217807769775
Epoch: 9, Steps: 34 | Train Loss: 11.647 Vali Loss: 19.866 Vali Acc: 0.578 Test Loss: 19.866 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.545891284942627
Epoch: 10, Steps: 34 | Train Loss: 7.693 Vali Loss: 8.742 Vali Acc: 0.688 Test Loss: 8.742 Test Acc: 0.688
Validation loss decreased (-0.612643 --> -0.687774).  Saving model ...
Epoch: 11 cost time: 4.02044415473938
Epoch: 11, Steps: 34 | Train Loss: 8.088 Vali Loss: 7.067 Vali Acc: 0.699 Test Loss: 7.067 Test Acc: 0.699
Validation loss decreased (-0.687774 --> -0.699351).  Saving model ...
Epoch: 12 cost time: 3.6581029891967773
Epoch: 12, Steps: 34 | Train Loss: 3.140 Vali Loss: 14.140 Vali Acc: 0.665 Test Loss: 14.140 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6855461597442627
Epoch: 13, Steps: 34 | Train Loss: 4.052 Vali Loss: 7.423 Vali Acc: 0.763 Test Loss: 7.423 Test Acc: 0.763
Validation loss decreased (-0.699351 --> -0.762932).  Saving model ...
Epoch: 14 cost time: 3.919563055038452
Epoch: 14, Steps: 34 | Train Loss: 1.892 Vali Loss: 7.944 Vali Acc: 0.723 Test Loss: 7.944 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6331372261047363
Epoch: 15, Steps: 34 | Train Loss: 2.589 Vali Loss: 8.867 Vali Acc: 0.740 Test Loss: 8.867 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.707979679107666
Epoch: 16, Steps: 34 | Train Loss: 5.843 Vali Loss: 7.056 Vali Acc: 0.734 Test Loss: 7.056 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.008090496063232
Epoch: 17, Steps: 34 | Train Loss: 2.975 Vali Loss: 7.894 Vali Acc: 0.786 Test Loss: 7.894 Test Acc: 0.786
Validation loss decreased (-0.762932 --> -0.786048).  Saving model ...
Epoch: 18 cost time: 3.8055851459503174
Epoch: 18, Steps: 34 | Train Loss: 1.780 Vali Loss: 5.060 Vali Acc: 0.844 Test Loss: 5.060 Test Acc: 0.844
Validation loss decreased (-0.786048 --> -0.843880).  Saving model ...
Epoch: 19 cost time: 3.491551637649536
Epoch: 19, Steps: 34 | Train Loss: 2.687 Vali Loss: 7.261 Vali Acc: 0.780 Test Loss: 7.261 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7166008949279785
Epoch: 20, Steps: 34 | Train Loss: 0.121 Vali Loss: 13.372 Vali Acc: 0.717 Test Loss: 13.372 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.371606826782227
Epoch: 21, Steps: 34 | Train Loss: 0.205 Vali Loss: 10.552 Vali Acc: 0.815 Test Loss: 10.552 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.530855894088745
Epoch: 22, Steps: 34 | Train Loss: 0.280 Vali Loss: 11.973 Vali Acc: 0.740 Test Loss: 11.973 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.8351125717163086
Epoch: 23, Steps: 34 | Train Loss: 0.928 Vali Loss: 16.715 Vali Acc: 0.757 Test Loss: 16.715 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.896744966506958
Epoch: 24, Steps: 34 | Train Loss: 1.389 Vali Loss: 10.257 Vali Acc: 0.751 Test Loss: 10.257 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.5349292755126953
Epoch: 25, Steps: 34 | Train Loss: 0.624 Vali Loss: 10.797 Vali Acc: 0.803 Test Loss: 10.797 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.617363691329956
Epoch: 26, Steps: 34 | Train Loss: 0.841 Vali Loss: 10.263 Vali Acc: 0.775 Test Loss: 10.263 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.5435473918914795
Epoch: 27, Steps: 34 | Train Loss: 0.895 Vali Loss: 7.144 Vali Acc: 0.832 Test Loss: 7.144 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.020435094833374
Epoch: 28, Steps: 34 | Train Loss: 0.461 Vali Loss: 7.848 Vali Acc: 0.832 Test Loss: 7.848 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3061791
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.911253929138184
Epoch: 1, Steps: 34 | Train Loss: 6.045 Vali Loss: 7.696 Vali Acc: 0.341 Test Loss: 7.696 Test Acc: 0.341
Validation loss decreased (inf --> -0.340964).  Saving model ...
Epoch: 2 cost time: 4.0974133014678955
Epoch: 2, Steps: 34 | Train Loss: 9.584 Vali Loss: 18.900 Vali Acc: 0.277 Test Loss: 18.900 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.228793144226074
Epoch: 3, Steps: 34 | Train Loss: 7.787 Vali Loss: 12.974 Vali Acc: 0.364 Test Loss: 12.974 Test Acc: 0.364
Validation loss decreased (-0.340964 --> -0.364032).  Saving model ...
Epoch: 4 cost time: 3.963303565979004
Epoch: 4, Steps: 34 | Train Loss: 11.027 Vali Loss: 9.150 Vali Acc: 0.405 Test Loss: 9.150 Test Acc: 0.405
Validation loss decreased (-0.364032 --> -0.404533).  Saving model ...
Epoch: 5 cost time: 3.8646936416625977
Epoch: 5, Steps: 34 | Train Loss: 5.825 Vali Loss: 23.488 Vali Acc: 0.462 Test Loss: 23.488 Test Acc: 0.462
Validation loss decreased (-0.404533 --> -0.462193).  Saving model ...
Epoch: 6 cost time: 3.7552452087402344
Epoch: 6, Steps: 34 | Train Loss: 11.539 Vali Loss: 7.493 Vali Acc: 0.584 Test Loss: 7.493 Test Acc: 0.584
Validation loss decreased (-0.462193 --> -0.583740).  Saving model ...
Epoch: 7 cost time: 4.733253479003906
Epoch: 7, Steps: 34 | Train Loss: 9.101 Vali Loss: 26.296 Vali Acc: 0.503 Test Loss: 26.296 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.943026304244995
Epoch: 8, Steps: 34 | Train Loss: 8.786 Vali Loss: 26.220 Vali Acc: 0.566 Test Loss: 26.220 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.092953205108643
Epoch: 9, Steps: 34 | Train Loss: 7.465 Vali Loss: 19.254 Vali Acc: 0.532 Test Loss: 19.254 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.534594297409058
Epoch: 10, Steps: 34 | Train Loss: 6.071 Vali Loss: 9.191 Vali Acc: 0.636 Test Loss: 9.191 Test Acc: 0.636
Validation loss decreased (-0.583740 --> -0.635746).  Saving model ...
Epoch: 11 cost time: 4.178337097167969
Epoch: 11, Steps: 34 | Train Loss: 7.402 Vali Loss: 26.075 Vali Acc: 0.630 Test Loss: 26.075 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.730389595031738
Epoch: 12, Steps: 34 | Train Loss: 10.465 Vali Loss: 7.752 Vali Acc: 0.763 Test Loss: 7.752 Test Acc: 0.763
Validation loss decreased (-0.635746 --> -0.762928).  Saving model ...
Epoch: 13 cost time: 4.206879138946533
Epoch: 13, Steps: 34 | Train Loss: 6.479 Vali Loss: 7.866 Vali Acc: 0.711 Test Loss: 7.866 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.350848436355591
Epoch: 14, Steps: 34 | Train Loss: 3.803 Vali Loss: 13.731 Vali Acc: 0.676 Test Loss: 13.731 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.451561689376831
Epoch: 15, Steps: 34 | Train Loss: 4.298 Vali Loss: 30.005 Vali Acc: 0.509 Test Loss: 30.005 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.172089099884033
Epoch: 16, Steps: 34 | Train Loss: 6.772 Vali Loss: 10.749 Vali Acc: 0.734 Test Loss: 10.749 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.25506591796875
Epoch: 17, Steps: 34 | Train Loss: 5.832 Vali Loss: 21.375 Vali Acc: 0.543 Test Loss: 21.375 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.02031683921814
Epoch: 18, Steps: 34 | Train Loss: 2.269 Vali Loss: 16.602 Vali Acc: 0.699 Test Loss: 16.602 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.1202392578125
Epoch: 19, Steps: 34 | Train Loss: 2.140 Vali Loss: 23.544 Vali Acc: 0.613 Test Loss: 23.544 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.4070963859558105
Epoch: 20, Steps: 34 | Train Loss: 1.712 Vali Loss: 10.365 Vali Acc: 0.769 Test Loss: 10.365 Test Acc: 0.769
Validation loss decreased (-0.762928 --> -0.768682).  Saving model ...
Epoch: 21 cost time: 4.679548978805542
Epoch: 21, Steps: 34 | Train Loss: 0.944 Vali Loss: 17.468 Vali Acc: 0.705 Test Loss: 17.468 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.31907320022583
Epoch: 22, Steps: 34 | Train Loss: 2.462 Vali Loss: 8.515 Vali Acc: 0.815 Test Loss: 8.515 Test Acc: 0.815
Validation loss decreased (-0.768682 --> -0.814944).  Saving model ...
Epoch: 23 cost time: 4.444952011108398
Epoch: 23, Steps: 34 | Train Loss: 1.245 Vali Loss: 14.933 Vali Acc: 0.717 Test Loss: 14.933 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.19456672668457
Epoch: 24, Steps: 34 | Train Loss: 2.059 Vali Loss: 17.844 Vali Acc: 0.723 Test Loss: 17.844 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.103923559188843
Epoch: 25, Steps: 34 | Train Loss: 0.750 Vali Loss: 29.552 Vali Acc: 0.618 Test Loss: 29.552 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.263452529907227
Epoch: 26, Steps: 34 | Train Loss: 2.577 Vali Loss: 12.452 Vali Acc: 0.734 Test Loss: 12.452 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.228578805923462
Epoch: 27, Steps: 34 | Train Loss: 1.746 Vali Loss: 9.996 Vali Acc: 0.786 Test Loss: 9.996 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.172308444976807
Epoch: 28, Steps: 34 | Train Loss: 0.377 Vali Loss: 7.638 Vali Acc: 0.798 Test Loss: 7.638 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.336303472518921
Epoch: 29, Steps: 34 | Train Loss: 0.224 Vali Loss: 12.082 Vali Acc: 0.792 Test Loss: 12.082 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.288917779922485
Epoch: 30, Steps: 34 | Train Loss: 0.739 Vali Loss: 14.759 Vali Acc: 0.798 Test Loss: 14.759 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.91800594329834
Epoch: 31, Steps: 34 | Train Loss: 1.560 Vali Loss: 9.834 Vali Acc: 0.821 Test Loss: 9.834 Test Acc: 0.821
Validation loss decreased (-0.814944 --> -0.820711).  Saving model ...
Epoch: 32 cost time: 4.132508993148804
Epoch: 32, Steps: 34 | Train Loss: 0.645 Vali Loss: 11.267 Vali Acc: 0.786 Test Loss: 11.267 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.2207348346710205
Epoch: 33, Steps: 34 | Train Loss: 1.181 Vali Loss: 32.115 Vali Acc: 0.555 Test Loss: 32.115 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.529778480529785
Epoch: 34, Steps: 34 | Train Loss: 3.639 Vali Loss: 12.459 Vali Acc: 0.786 Test Loss: 12.459 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.213719129562378
Epoch: 35, Steps: 34 | Train Loss: 1.261 Vali Loss: 10.939 Vali Acc: 0.844 Test Loss: 10.939 Test Acc: 0.844
Validation loss decreased (-0.820711 --> -0.843821).  Saving model ...
Epoch: 36 cost time: 4.131823301315308
Epoch: 36, Steps: 34 | Train Loss: 1.054 Vali Loss: 9.467 Vali Acc: 0.780 Test Loss: 9.467 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.3187432289123535
Epoch: 37, Steps: 34 | Train Loss: 0.000 Vali Loss: 11.970 Vali Acc: 0.786 Test Loss: 11.970 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.572906732559204
Epoch: 38, Steps: 34 | Train Loss: 0.000 Vali Loss: 11.883 Vali Acc: 0.786 Test Loss: 11.883 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.550817966461182
Epoch: 39, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.902 Vali Acc: 0.821 Test Loss: 10.902 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.050678014755249
Epoch: 40, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.823 Vali Acc: 0.821 Test Loss: 10.823 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.514662027359009
Epoch: 41, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.817 Vali Acc: 0.821 Test Loss: 10.817 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.056204080581665
Epoch: 42, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.812 Vali Acc: 0.821 Test Loss: 10.812 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.183670520782471
Epoch: 43, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.811 Vali Acc: 0.821 Test Loss: 10.811 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.1096227169036865
Epoch: 44, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.723 Vali Acc: 0.821 Test Loss: 10.723 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.707772970199585
Epoch: 45, Steps: 34 | Train Loss: 0.000 Vali Loss: 10.700 Vali Acc: 0.821 Test Loss: 10.700 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3037983
model size : 12.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.135868549346924
Epoch: 1, Steps: 34 | Train Loss: 5.350 Vali Loss: 5.823 Vali Acc: 0.283 Test Loss: 5.823 Test Acc: 0.283
Validation loss decreased (inf --> -0.283179).  Saving model ...
Epoch: 2 cost time: 3.9128546714782715
Epoch: 2, Steps: 34 | Train Loss: 7.608 Vali Loss: 6.979 Vali Acc: 0.410 Test Loss: 6.979 Test Acc: 0.410
Validation loss decreased (-0.283179 --> -0.410335).  Saving model ...
Epoch: 3 cost time: 4.100668907165527
Epoch: 3, Steps: 34 | Train Loss: 12.551 Vali Loss: 14.693 Vali Acc: 0.428 Test Loss: 14.693 Test Acc: 0.428
Validation loss decreased (-0.410335 --> -0.427599).  Saving model ...
Epoch: 4 cost time: 3.9400293827056885
Epoch: 4, Steps: 34 | Train Loss: 10.955 Vali Loss: 14.621 Vali Acc: 0.306 Test Loss: 14.621 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.012951135635376
Epoch: 5, Steps: 34 | Train Loss: 10.831 Vali Loss: 14.212 Vali Acc: 0.503 Test Loss: 14.212 Test Acc: 0.503
Validation loss decreased (-0.427599 --> -0.502748).  Saving model ...
Epoch: 6 cost time: 3.9477920532226562
Epoch: 6, Steps: 34 | Train Loss: 13.814 Vali Loss: 5.919 Vali Acc: 0.601 Test Loss: 5.919 Test Acc: 0.601
Validation loss decreased (-0.502748 --> -0.601097).  Saving model ...
Epoch: 7 cost time: 4.346881866455078
Epoch: 7, Steps: 34 | Train Loss: 17.240 Vali Loss: 30.186 Vali Acc: 0.474 Test Loss: 30.186 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6616992950439453
Epoch: 8, Steps: 34 | Train Loss: 11.830 Vali Loss: 33.210 Vali Acc: 0.445 Test Loss: 33.210 Test Acc: 0.445
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4839532375335693
Epoch: 9, Steps: 34 | Train Loss: 5.893 Vali Loss: 11.636 Vali Acc: 0.549 Test Loss: 11.636 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.789630651473999
Epoch: 10, Steps: 34 | Train Loss: 7.347 Vali Loss: 25.906 Vali Acc: 0.543 Test Loss: 25.906 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8583760261535645
Epoch: 11, Steps: 34 | Train Loss: 10.420 Vali Loss: 11.922 Vali Acc: 0.671 Test Loss: 11.922 Test Acc: 0.671
Validation loss decreased (-0.601097 --> -0.670401).  Saving model ...
Epoch: 12 cost time: 3.6002328395843506
Epoch: 12, Steps: 34 | Train Loss: 4.730 Vali Loss: 3.509 Vali Acc: 0.844 Test Loss: 3.509 Test Acc: 0.844
Validation loss decreased (-0.670401 --> -0.843896).  Saving model ...
Epoch: 13 cost time: 3.7591137886047363
Epoch: 13, Steps: 34 | Train Loss: 6.733 Vali Loss: 8.405 Vali Acc: 0.734 Test Loss: 8.405 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.662841558456421
Epoch: 14, Steps: 34 | Train Loss: 8.729 Vali Loss: 33.847 Vali Acc: 0.578 Test Loss: 33.847 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.608274459838867
Epoch: 15, Steps: 34 | Train Loss: 9.313 Vali Loss: 17.943 Vali Acc: 0.688 Test Loss: 17.943 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5556156635284424
Epoch: 16, Steps: 34 | Train Loss: 5.057 Vali Loss: 12.490 Vali Acc: 0.676 Test Loss: 12.490 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.440064191818237
Epoch: 17, Steps: 34 | Train Loss: 2.391 Vali Loss: 20.449 Vali Acc: 0.676 Test Loss: 20.449 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.764655828475952
Epoch: 18, Steps: 34 | Train Loss: 5.188 Vali Loss: 20.776 Vali Acc: 0.676 Test Loss: 20.776 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.101236581802368
Epoch: 19, Steps: 34 | Train Loss: 2.554 Vali Loss: 11.343 Vali Acc: 0.694 Test Loss: 11.343 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.984276294708252
Epoch: 20, Steps: 34 | Train Loss: 1.261 Vali Loss: 8.450 Vali Acc: 0.798 Test Loss: 8.450 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.397112131118774
Epoch: 21, Steps: 34 | Train Loss: 1.864 Vali Loss: 9.302 Vali Acc: 0.763 Test Loss: 9.302 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6319832801818848
Epoch: 22, Steps: 34 | Train Loss: 0.378 Vali Loss: 8.999 Vali Acc: 0.809 Test Loss: 8.999 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3037599
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.816265821456909
Epoch: 1, Steps: 34 | Train Loss: 4.725 Vali Loss: 4.088 Vali Acc: 0.243 Test Loss: 4.088 Test Acc: 0.243
Validation loss decreased (inf --> -0.242734).  Saving model ...
Epoch: 2 cost time: 4.3012566566467285
Epoch: 2, Steps: 34 | Train Loss: 4.405 Vali Loss: 6.407 Vali Acc: 0.538 Test Loss: 6.407 Test Acc: 0.538
Validation loss decreased (-0.242734 --> -0.537508).  Saving model ...
Epoch: 3 cost time: 3.78385066986084
Epoch: 3, Steps: 34 | Train Loss: 7.167 Vali Loss: 17.567 Vali Acc: 0.405 Test Loss: 17.567 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9228482246398926
Epoch: 4, Steps: 34 | Train Loss: 18.728 Vali Loss: 20.219 Vali Acc: 0.416 Test Loss: 20.219 Test Acc: 0.416
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.353020191192627
Epoch: 5, Steps: 34 | Train Loss: 12.275 Vali Loss: 19.234 Vali Acc: 0.428 Test Loss: 19.234 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.655738353729248
Epoch: 6, Steps: 34 | Train Loss: 9.306 Vali Loss: 12.986 Vali Acc: 0.509 Test Loss: 12.986 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.426182985305786
Epoch: 7, Steps: 34 | Train Loss: 7.686 Vali Loss: 15.534 Vali Acc: 0.549 Test Loss: 15.534 Test Acc: 0.549
Validation loss decreased (-0.537508 --> -0.548978).  Saving model ...
Epoch: 8 cost time: 4.537846326828003
Epoch: 8, Steps: 34 | Train Loss: 8.200 Vali Loss: 22.649 Vali Acc: 0.653 Test Loss: 22.649 Test Acc: 0.653
Validation loss decreased (-0.548978 --> -0.652953).  Saving model ...
Epoch: 9 cost time: 4.12857460975647
Epoch: 9, Steps: 34 | Train Loss: 9.232 Vali Loss: 8.210 Vali Acc: 0.711 Test Loss: 8.210 Test Acc: 0.711
Validation loss decreased (-0.652953 --> -0.710901).  Saving model ...
Epoch: 10 cost time: 4.271467447280884
Epoch: 10, Steps: 34 | Train Loss: 9.249 Vali Loss: 16.771 Vali Acc: 0.595 Test Loss: 16.771 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.859166383743286
Epoch: 11, Steps: 34 | Train Loss: 4.695 Vali Loss: 27.128 Vali Acc: 0.699 Test Loss: 27.128 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.764441013336182
Epoch: 12, Steps: 34 | Train Loss: 14.659 Vali Loss: 17.338 Vali Acc: 0.624 Test Loss: 17.338 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.589802265167236
Epoch: 13, Steps: 34 | Train Loss: 8.464 Vali Loss: 30.420 Vali Acc: 0.624 Test Loss: 30.420 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.843416452407837
Epoch: 14, Steps: 34 | Train Loss: 10.662 Vali Loss: 10.596 Vali Acc: 0.728 Test Loss: 10.596 Test Acc: 0.728
Validation loss decreased (-0.710901 --> -0.728218).  Saving model ...
Epoch: 15 cost time: 3.726123094558716
Epoch: 15, Steps: 34 | Train Loss: 4.494 Vali Loss: 29.514 Vali Acc: 0.595 Test Loss: 29.514 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.285262107849121
Epoch: 16, Steps: 34 | Train Loss: 10.281 Vali Loss: 28.583 Vali Acc: 0.549 Test Loss: 28.583 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.00620698928833
Epoch: 17, Steps: 34 | Train Loss: 1.756 Vali Loss: 6.902 Vali Acc: 0.827 Test Loss: 6.902 Test Acc: 0.827
Validation loss decreased (-0.728218 --> -0.826521).  Saving model ...
Epoch: 18 cost time: 3.8118908405303955
Epoch: 18, Steps: 34 | Train Loss: 3.068 Vali Loss: 17.195 Vali Acc: 0.734 Test Loss: 17.195 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.526384115219116
Epoch: 19, Steps: 34 | Train Loss: 6.810 Vali Loss: 10.879 Vali Acc: 0.734 Test Loss: 10.879 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.174414157867432
Epoch: 20, Steps: 34 | Train Loss: 5.648 Vali Loss: 38.836 Vali Acc: 0.497 Test Loss: 38.836 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.278653621673584
Epoch: 21, Steps: 34 | Train Loss: 1.581 Vali Loss: 15.997 Vali Acc: 0.676 Test Loss: 15.997 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.748772382736206
Epoch: 22, Steps: 34 | Train Loss: 1.331 Vali Loss: 14.608 Vali Acc: 0.728 Test Loss: 14.608 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.356761932373047
Epoch: 23, Steps: 34 | Train Loss: 1.300 Vali Loss: 10.899 Vali Acc: 0.740 Test Loss: 10.899 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.5422985553741455
Epoch: 24, Steps: 34 | Train Loss: 0.509 Vali Loss: 14.744 Vali Acc: 0.717 Test Loss: 14.744 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.502162456512451
Epoch: 25, Steps: 34 | Train Loss: 0.852 Vali Loss: 6.938 Vali Acc: 0.827 Test Loss: 6.938 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.243371248245239
Epoch: 26, Steps: 34 | Train Loss: 3.895 Vali Loss: 20.244 Vali Acc: 0.786 Test Loss: 20.244 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.9173336029052734
Epoch: 27, Steps: 34 | Train Loss: 4.273 Vali Loss: 17.826 Vali Acc: 0.694 Test Loss: 17.826 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3037215
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.081971883773804
Epoch: 1, Steps: 34 | Train Loss: 5.584 Vali Loss: 12.233 Vali Acc: 0.399 Test Loss: 12.233 Test Acc: 0.399
Validation loss decreased (inf --> -0.398722).  Saving model ...
Epoch: 2 cost time: 4.126366853713989
Epoch: 2, Steps: 34 | Train Loss: 10.653 Vali Loss: 13.412 Vali Acc: 0.364 Test Loss: 13.412 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.606126546859741
Epoch: 3, Steps: 34 | Train Loss: 9.646 Vali Loss: 14.549 Vali Acc: 0.410 Test Loss: 14.549 Test Acc: 0.410
Validation loss decreased (-0.398722 --> -0.410259).  Saving model ...
Epoch: 4 cost time: 3.8178300857543945
Epoch: 4, Steps: 34 | Train Loss: 12.801 Vali Loss: 8.698 Vali Acc: 0.486 Test Loss: 8.698 Test Acc: 0.486
Validation loss decreased (-0.410259 --> -0.485462).  Saving model ...
Epoch: 5 cost time: 3.514056444168091
Epoch: 5, Steps: 34 | Train Loss: 8.160 Vali Loss: 20.263 Vali Acc: 0.306 Test Loss: 20.263 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8635058403015137
Epoch: 6, Steps: 34 | Train Loss: 7.955 Vali Loss: 9.862 Vali Acc: 0.561 Test Loss: 9.862 Test Acc: 0.561
Validation loss decreased (-0.485462 --> -0.560595).  Saving model ...
Epoch: 7 cost time: 3.788773775100708
Epoch: 7, Steps: 34 | Train Loss: 8.474 Vali Loss: 12.848 Vali Acc: 0.532 Test Loss: 12.848 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9857728481292725
Epoch: 8, Steps: 34 | Train Loss: 11.162 Vali Loss: 24.530 Vali Acc: 0.503 Test Loss: 24.530 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9826316833496094
Epoch: 9, Steps: 34 | Train Loss: 6.827 Vali Loss: 8.746 Vali Acc: 0.572 Test Loss: 8.746 Test Acc: 0.572
Validation loss decreased (-0.560595 --> -0.572167).  Saving model ...
Epoch: 10 cost time: 4.19008469581604
Epoch: 10, Steps: 34 | Train Loss: 4.626 Vali Loss: 9.984 Vali Acc: 0.624 Test Loss: 9.984 Test Acc: 0.624
Validation loss decreased (-0.572167 --> -0.624178).  Saving model ...
Epoch: 11 cost time: 3.6683406829833984
Epoch: 11, Steps: 34 | Train Loss: 7.223 Vali Loss: 24.625 Vali Acc: 0.624 Test Loss: 24.625 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8073439598083496
Epoch: 12, Steps: 34 | Train Loss: 12.869 Vali Loss: 11.613 Vali Acc: 0.711 Test Loss: 11.613 Test Acc: 0.711
Validation loss decreased (-0.624178 --> -0.710867).  Saving model ...
Epoch: 13 cost time: 3.888040781021118
Epoch: 13, Steps: 34 | Train Loss: 2.300 Vali Loss: 17.336 Vali Acc: 0.659 Test Loss: 17.336 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.168530464172363
Epoch: 14, Steps: 34 | Train Loss: 11.294 Vali Loss: 9.279 Vali Acc: 0.746 Test Loss: 9.279 Test Acc: 0.746
Validation loss decreased (-0.710867 --> -0.745572).  Saving model ...
Epoch: 15 cost time: 4.0490217208862305
Epoch: 15, Steps: 34 | Train Loss: 5.237 Vali Loss: 12.313 Vali Acc: 0.711 Test Loss: 12.313 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8346917629241943
Epoch: 16, Steps: 34 | Train Loss: 5.225 Vali Loss: 20.536 Vali Acc: 0.682 Test Loss: 20.536 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7586724758148193
Epoch: 17, Steps: 34 | Train Loss: 6.213 Vali Loss: 35.534 Vali Acc: 0.624 Test Loss: 35.534 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9595768451690674
Epoch: 18, Steps: 34 | Train Loss: 3.897 Vali Loss: 5.408 Vali Acc: 0.803 Test Loss: 5.408 Test Acc: 0.803
Validation loss decreased (-0.745572 --> -0.803414).  Saving model ...
Epoch: 19 cost time: 3.7458934783935547
Epoch: 19, Steps: 34 | Train Loss: 1.404 Vali Loss: 9.823 Vali Acc: 0.751 Test Loss: 9.823 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6083014011383057
Epoch: 20, Steps: 34 | Train Loss: 1.380 Vali Loss: 13.367 Vali Acc: 0.717 Test Loss: 13.367 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7603373527526855
Epoch: 21, Steps: 34 | Train Loss: 0.769 Vali Loss: 24.451 Vali Acc: 0.671 Test Loss: 24.451 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.096055030822754
Epoch: 22, Steps: 34 | Train Loss: 4.064 Vali Loss: 9.990 Vali Acc: 0.821 Test Loss: 9.990 Test Acc: 0.821
Validation loss decreased (-0.803414 --> -0.820709).  Saving model ...
Epoch: 23 cost time: 4.449408054351807
Epoch: 23, Steps: 34 | Train Loss: 1.902 Vali Loss: 9.912 Vali Acc: 0.838 Test Loss: 9.912 Test Acc: 0.838
Validation loss decreased (-0.820709 --> -0.838051).  Saving model ...
Epoch: 24 cost time: 3.724424123764038
Epoch: 24, Steps: 34 | Train Loss: 0.985 Vali Loss: 6.986 Vali Acc: 0.815 Test Loss: 6.986 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4969685077667236
Epoch: 25, Steps: 34 | Train Loss: 0.594 Vali Loss: 5.500 Vali Acc: 0.832 Test Loss: 5.500 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8296597003936768
Epoch: 26, Steps: 34 | Train Loss: 1.181 Vali Loss: 46.829 Vali Acc: 0.520 Test Loss: 46.829 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.119906425476074
Epoch: 27, Steps: 34 | Train Loss: 4.089 Vali Loss: 11.412 Vali Acc: 0.699 Test Loss: 11.412 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.847865104675293
Epoch: 28, Steps: 34 | Train Loss: 3.413 Vali Loss: 58.339 Vali Acc: 0.497 Test Loss: 58.339 Test Acc: 0.497
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.284332752227783
Epoch: 29, Steps: 34 | Train Loss: 4.575 Vali Loss: 17.920 Vali Acc: 0.728 Test Loss: 17.920 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.052567958831787
Epoch: 30, Steps: 34 | Train Loss: 0.508 Vali Loss: 28.966 Vali Acc: 0.676 Test Loss: 28.966 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.1455323696136475
Epoch: 31, Steps: 34 | Train Loss: 1.219 Vali Loss: 22.190 Vali Acc: 0.699 Test Loss: 22.190 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.023360967636108
Epoch: 32, Steps: 34 | Train Loss: 2.887 Vali Loss: 13.487 Vali Acc: 0.803 Test Loss: 13.487 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.748443126678467
Epoch: 33, Steps: 34 | Train Loss: 1.017 Vali Loss: 18.968 Vali Acc: 0.763 Test Loss: 18.968 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_Crossformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 3036831
model size : 12.26MB
