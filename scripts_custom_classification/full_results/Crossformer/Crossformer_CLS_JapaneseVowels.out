Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.7880542278289795
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 1.862 Vali Acc: 0.403 Test Loss: 1.862 Test Acc: 0.403
Validation loss decreased (inf --> -0.402684).  Saving model ...
Epoch: 2 cost time: 2.9718377590179443
Epoch: 2, Steps: 17 | Train Loss: 1.344 Vali Loss: 0.729 Vali Acc: 0.830 Test Loss: 0.729 Test Acc: 0.830
Validation loss decreased (-0.402684 --> -0.829722).  Saving model ...
Epoch: 3 cost time: 2.9809389114379883
Epoch: 3, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.355 Vali Acc: 0.897 Test Loss: 0.355 Test Acc: 0.897
Validation loss decreased (-0.829722 --> -0.897294).  Saving model ...
Epoch: 4 cost time: 2.806535243988037
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.897294 --> -0.902699).  Saving model ...
Epoch: 5 cost time: 2.913050413131714
Epoch: 5, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.343 Vali Acc: 0.892 Test Loss: 0.343 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.802295446395874
Epoch: 6, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.902699 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 2.764620780944824
Epoch: 7, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 2.8078763484954834
Epoch: 8, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.6023762226104736
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.234 Vali Acc: 0.914 Test Loss: 0.234 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.004884719848633
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.60823917388916
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.695173978805542
Epoch: 12, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6043448448181152
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5389692783355713
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.935 Test Loss: 0.155 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2249255180358887
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.093127727508545
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.0059638023376465
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8192737102508545
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 14295365
model size : 59.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.2848358154296875
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.155 Vali Acc: 0.292 Test Loss: 2.155 Test Acc: 0.292
Validation loss decreased (inf --> -0.291870).  Saving model ...
Epoch: 2 cost time: 3.2906241416931152
Epoch: 2, Steps: 17 | Train Loss: 1.583 Vali Loss: 0.984 Vali Acc: 0.741 Test Loss: 0.984 Test Acc: 0.741
Validation loss decreased (-0.291870 --> -0.740531).  Saving model ...
Epoch: 3 cost time: 3.533790349960327
Epoch: 3, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.371 Vali Acc: 0.876 Test Loss: 0.371 Test Acc: 0.876
Validation loss decreased (-0.740531 --> -0.875672).  Saving model ...
Epoch: 4 cost time: 3.1706645488739014
Epoch: 4, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.253 Vali Acc: 0.914 Test Loss: 0.253 Test Acc: 0.914
Validation loss decreased (-0.875672 --> -0.913511).  Saving model ...
Epoch: 5 cost time: 3.567096471786499
Epoch: 5, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.329 Vali Acc: 0.873 Test Loss: 0.329 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.768069267272949
Epoch: 6, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.210 Vali Acc: 0.924 Test Loss: 0.210 Test Acc: 0.924
Validation loss decreased (-0.913511 --> -0.924322).  Saving model ...
Epoch: 7 cost time: 2.7241272926330566
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.242 Vali Acc: 0.914 Test Loss: 0.242 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.927729368209839
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.292 Vali Acc: 0.892 Test Loss: 0.292 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.646749258041382
Epoch: 9, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
Validation loss decreased (-0.924322 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 3.6143932342529297
Epoch: 10, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 3.01605224609375
Epoch: 11, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8060500621795654
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.237 Vali Acc: 0.924 Test Loss: 0.237 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1102678775787354
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.355 Vali Acc: 0.881 Test Loss: 0.355 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.492013692855835
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1288959980010986
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 3.4069275856018066
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3550004959106445
Epoch: 17, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7015771865844727
Epoch: 18, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.587251901626587
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4107625484466553
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1320533752441406
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.935 Test Loss: 0.164 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.960475444793701
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9801013469696045
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.158078908920288
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.068432331085205
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 14293573
model size : 59.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.06613564491272
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 1.778 Vali Acc: 0.262 Test Loss: 1.778 Test Acc: 0.262
Validation loss decreased (inf --> -0.262144).  Saving model ...
Epoch: 2 cost time: 2.630250930786133
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.058 Vali Acc: 0.792 Test Loss: 1.058 Test Acc: 0.792
Validation loss decreased (-0.262144 --> -0.791881).  Saving model ...
Epoch: 3 cost time: 2.7632267475128174
Epoch: 3, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.443 Vali Acc: 0.849 Test Loss: 0.443 Test Acc: 0.849
Validation loss decreased (-0.791881 --> -0.848644).  Saving model ...
Epoch: 4 cost time: 3.0164809226989746
Epoch: 4, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.262 Vali Acc: 0.892 Test Loss: 0.262 Test Acc: 0.892
Validation loss decreased (-0.848644 --> -0.891889).  Saving model ...
Epoch: 5 cost time: 3.219881534576416
Epoch: 5, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.268 Vali Acc: 0.924 Test Loss: 0.268 Test Acc: 0.924
Validation loss decreased (-0.891889 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 3.2408432960510254
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.198 Vali Acc: 0.927 Test Loss: 0.198 Test Acc: 0.927
Validation loss decreased (-0.924322 --> -0.927025).  Saving model ...
Epoch: 7 cost time: 3.274178981781006
Epoch: 7, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
Validation loss decreased (-0.927025 --> -0.940539).  Saving model ...
Epoch: 8 cost time: 2.99792218208313
Epoch: 8, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.681112766265869
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 2.8511910438537598
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.954053 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 2.9128947257995605
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.189 Vali Acc: 0.927 Test Loss: 0.189 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1152894496917725
Epoch: 12, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.861506223678589
Epoch: 13, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 3.109079122543335
Epoch: 14, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.816448450088501
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9961650371551514
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3508377075195312
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.889509916305542
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0531232357025146
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9458389282226562
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.00065016746521
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.568821668624878
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 23 cost time: 2.7625622749328613
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 3.470369577407837
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.317718982696533
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 2.2568352222442627
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1692147254943848
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.516007423400879
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.270512580871582
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3544955253601074
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.5211782455444336
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.975815773010254
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.0036163330078125
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3115720748901367
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.4891533851623535
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 14291781
model size : 59.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.4761340618133545
Epoch: 1, Steps: 17 | Train Loss: 2.286 Vali Loss: 2.100 Vali Acc: 0.232 Test Loss: 2.100 Test Acc: 0.232
Validation loss decreased (inf --> -0.232411).  Saving model ...
Epoch: 2 cost time: 2.7996275424957275
Epoch: 2, Steps: 17 | Train Loss: 1.586 Vali Loss: 0.935 Vali Acc: 0.743 Test Loss: 0.935 Test Acc: 0.743
Validation loss decreased (-0.232411 --> -0.743234).  Saving model ...
Epoch: 3 cost time: 3.1725025177001953
Epoch: 3, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
Validation loss decreased (-0.743234 --> -0.840536).  Saving model ...
Epoch: 4 cost time: 2.806486129760742
Epoch: 4, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
Validation loss decreased (-0.840536 --> -0.910808).  Saving model ...
Epoch: 5 cost time: 2.647705554962158
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
Validation loss decreased (-0.910808 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.6147825717926025
Epoch: 6, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.527 Vali Acc: 0.849 Test Loss: 0.527 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2416136264801025
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
Validation loss decreased (-0.935133 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.7879700660705566
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.473 Vali Acc: 0.843 Test Loss: 0.473 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.29148006439209
Epoch: 9, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6318893432617188
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9481661319732666
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 2.907841920852661
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.939420223236084
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4164187908172607
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.802250862121582
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5691230297088623
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0955257415771484
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.4262120723724365
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.93296217918396
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.042776584625244
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 3.7170193195343018
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1045124530792236
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967567).  Saving model ...
Epoch: 23 cost time: 3.462157964706421
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.525787591934204
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.629378318786621
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.349714756011963
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.932 Test Loss: 0.203 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5284905433654785
Epoch: 27, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.750314235687256
Epoch: 28, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.162749767303467
Epoch: 29, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7448441982269287
Epoch: 30, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.383 Vali Acc: 0.892 Test Loss: 0.383 Test Acc: 0.892
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.3447227478027344
Epoch: 31, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.331 Vali Acc: 0.886 Test Loss: 0.331 Test Acc: 0.886
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.739549398422241
Epoch: 32, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 14289989
model size : 59.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.085763454437256
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.605 Vali Acc: 0.151 Test Loss: 2.605 Test Acc: 0.151
Validation loss decreased (inf --> -0.151325).  Saving model ...
Epoch: 2 cost time: 2.687833786010742
Epoch: 2, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.305 Vali Acc: 0.414 Test Loss: 1.305 Test Acc: 0.414
Validation loss decreased (-0.151325 --> -0.413500).  Saving model ...
Epoch: 3 cost time: 2.4240660667419434
Epoch: 3, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.452 Vali Acc: 0.897 Test Loss: 0.452 Test Acc: 0.897
Validation loss decreased (-0.413500 --> -0.897293).  Saving model ...
Epoch: 4 cost time: 2.5559136867523193
Epoch: 4, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.213322162628174
Epoch: 5, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.897293 --> -0.921619).  Saving model ...
Epoch: 6 cost time: 2.895555019378662
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7569375038146973
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.921619 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 3.0627946853637695
Epoch: 8, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956756).  Saving model ...
Epoch: 9 cost time: 3.353717565536499
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.956756 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 3.4435694217681885
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.251 Vali Acc: 0.916 Test Loss: 0.251 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7768537998199463
Epoch: 11, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7022860050201416
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 13 cost time: 2.5913944244384766
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.662440776824951
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0511505603790283
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.52827787399292
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.72076153755188
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.291186809539795
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.994802713394165
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8689558506011963
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7529642581939697
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.9599132537841797
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.965 Test Loss: 0.084 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 11931461
model size : 50.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.074535131454468
Epoch: 1, Steps: 17 | Train Loss: 2.234 Vali Loss: 1.863 Vali Acc: 0.497 Test Loss: 1.863 Test Acc: 0.497
Validation loss decreased (inf --> -0.497279).  Saving model ...
Epoch: 2 cost time: 3.054537534713745
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 0.841 Vali Acc: 0.851 Test Loss: 0.841 Test Acc: 0.851
Validation loss decreased (-0.497279 --> -0.851343).  Saving model ...
Epoch: 3 cost time: 3.402860164642334
Epoch: 3, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.384 Vali Acc: 0.908 Test Loss: 0.384 Test Acc: 0.908
Validation loss decreased (-0.851343 --> -0.908104).  Saving model ...
Epoch: 4 cost time: 2.6471619606018066
Epoch: 4, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.247 Vali Acc: 0.924 Test Loss: 0.247 Test Acc: 0.924
Validation loss decreased (-0.908104 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 3.1097333431243896
Epoch: 5, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5248942375183105
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.262 Vali Acc: 0.905 Test Loss: 0.262 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.924455165863037
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
Validation loss decreased (-0.924322 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 2.654935359954834
Epoch: 8, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.932 Test Loss: 0.166 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.160156011581421
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.152 Vali Acc: 0.938 Test Loss: 0.152 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0020034313201904
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.927 Test Loss: 0.215 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.861236810684204
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.943 Test Loss: 0.134 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8525002002716064
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.317 Vali Acc: 0.908 Test Loss: 0.317 Test Acc: 0.908
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.311805248260498
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.406998634338379
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 15 cost time: 2.612746238708496
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.956756 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 2.909780979156494
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.330 Vali Acc: 0.895 Test Loss: 0.330 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.739396810531616
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4773359298706055
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.145402431488037
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.362936019897461
Epoch: 20, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4083034992218018
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.407909870147705
Epoch: 22, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.017698049545288
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.15956711769104
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.319 Vali Acc: 0.908 Test Loss: 0.319 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.998908281326294
Epoch: 25, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 11929669
model size : 50.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.189848184585571
Epoch: 1, Steps: 17 | Train Loss: 2.323 Vali Loss: 1.884 Vali Acc: 0.368 Test Loss: 1.884 Test Acc: 0.368
Validation loss decreased (inf --> -0.367549).  Saving model ...
Epoch: 2 cost time: 2.837071657180786
Epoch: 2, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.139 Vali Acc: 0.724 Test Loss: 1.139 Test Acc: 0.724
Validation loss decreased (-0.367549 --> -0.724313).  Saving model ...
Epoch: 3 cost time: 2.6680049896240234
Epoch: 3, Steps: 17 | Train Loss: 0.750 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
Validation loss decreased (-0.724313 --> -0.878374).  Saving model ...
Epoch: 4 cost time: 2.7957253456115723
Epoch: 4, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.369 Vali Acc: 0.873 Test Loss: 0.369 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0302340984344482
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.878374 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 2.8203799724578857
Epoch: 6, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 2.719430923461914
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 2.3919320106506348
Epoch: 8, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 3.054947853088379
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.226 Vali Acc: 0.927 Test Loss: 0.226 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.073711633682251
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.632506847381592
Epoch: 11, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.286 Vali Acc: 0.908 Test Loss: 0.286 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.980276584625244
Epoch: 12, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5566823482513428
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2913498878479004
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.326 Vali Acc: 0.908 Test Loss: 0.326 Test Acc: 0.908
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1583609580993652
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.673213481903076
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.076789379119873
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7782223224639893
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 11927877
model size : 50.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.550451040267944
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.025 Vali Acc: 0.186 Test Loss: 2.025 Test Acc: 0.186
Validation loss decreased (inf --> -0.186466).  Saving model ...
Epoch: 2 cost time: 2.8446905612945557
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.180 Vali Acc: 0.619 Test Loss: 1.180 Test Acc: 0.619
Validation loss decreased (-0.186466 --> -0.618907).  Saving model ...
Epoch: 3 cost time: 2.115541696548462
Epoch: 3, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
Validation loss decreased (-0.618907 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 2.4007034301757812
Epoch: 4, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.344 Vali Acc: 0.886 Test Loss: 0.344 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.549936056137085
Epoch: 5, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.910807 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.584106922149658
Epoch: 6, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9440107345581055
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 3.248595714569092
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1268210411071777
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 3.089057207107544
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.355 Vali Acc: 0.876 Test Loss: 0.355 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.503051280975342
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0133776664733887
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.453658103942871
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8088979721069336
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.481529951095581
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.981651544570923
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7868998050689697
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.299 Vali Acc: 0.905 Test Loss: 0.299 Test Acc: 0.905
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.690303325653076
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.158515691757202
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 11926085
model size : 50.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.7887067794799805
Epoch: 1, Steps: 17 | Train Loss: 2.335 Vali Loss: 1.976 Vali Acc: 0.389 Test Loss: 1.976 Test Acc: 0.389
Validation loss decreased (inf --> -0.389169).  Saving model ...
Epoch: 2 cost time: 2.7401156425476074
Epoch: 2, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.163 Vali Acc: 0.792 Test Loss: 1.163 Test Acc: 0.792
Validation loss decreased (-0.389169 --> -0.791880).  Saving model ...
Epoch: 3 cost time: 3.0975868701934814
Epoch: 3, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.435 Vali Acc: 0.876 Test Loss: 0.435 Test Acc: 0.876
Validation loss decreased (-0.791880 --> -0.875671).  Saving model ...
Epoch: 4 cost time: 2.9301109313964844
Epoch: 4, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.392 Vali Acc: 0.868 Test Loss: 0.392 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3575332164764404
Epoch: 5, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
Validation loss decreased (-0.875671 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 2.894798517227173
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5060219764709473
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9234795570373535
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.6125142574310303
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.923340082168579
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4217870235443115
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 2.8216285705566406
Epoch: 12, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7994258403778076
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.413645029067993
Epoch: 14, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.249 Vali Acc: 0.908 Test Loss: 0.249 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7145590782165527
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.962 Test Loss: 0.080 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 2.938187599182129
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.847386598587036
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 2.6880264282226562
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8907060623168945
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7485320568084717
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.957 Test Loss: 0.100 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0776681900024414
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 2.364226818084717
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 2.8723983764648438
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9008233547210693
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8341753482818604
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5941336154937744
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.9776177406311035
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.0165746212005615
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.9027767181396484
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.6189441680908203
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.667196035385132
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.861170530319214
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 10749509
model size : 46.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.6031224727630615
Epoch: 1, Steps: 17 | Train Loss: 2.351 Vali Loss: 1.934 Vali Acc: 0.235 Test Loss: 1.934 Test Acc: 0.235
Validation loss decreased (inf --> -0.235116).  Saving model ...
Epoch: 2 cost time: 2.5557641983032227
Epoch: 2, Steps: 17 | Train Loss: 1.761 Vali Loss: 1.163 Vali Acc: 0.692 Test Loss: 1.163 Test Acc: 0.692
Validation loss decreased (-0.235116 --> -0.691880).  Saving model ...
Epoch: 3 cost time: 3.140721082687378
Epoch: 3, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.343 Vali Acc: 0.930 Test Loss: 0.343 Test Acc: 0.930
Validation loss decreased (-0.691880 --> -0.929726).  Saving model ...
Epoch: 4 cost time: 3.099202871322632
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940539).  Saving model ...
Epoch: 5 cost time: 2.636256694793701
Epoch: 5, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9449682235717773
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.957672595977783
Epoch: 7, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.935 Test Loss: 0.161 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9080088138580322
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.219576835632324
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.274 Vali Acc: 0.895 Test Loss: 0.274 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.960516929626465
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0459604263305664
Epoch: 11, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2192604541778564
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 3.365185260772705
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.699042558670044
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 2.828327178955078
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 3.140918493270874
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 3.1752824783325195
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5065717697143555
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9906790256500244
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 2.5724918842315674
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7508046627044678
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.019402265548706
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.8050122261047363
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7521228790283203
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3676416873931885
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.6443867683410645
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.5904381275177
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.395045757293701
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.654240131378174
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 10747717
model size : 46.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.148951292037964
Epoch: 1, Steps: 17 | Train Loss: 2.311 Vali Loss: 1.951 Vali Acc: 0.346 Test Loss: 1.951 Test Acc: 0.346
Validation loss decreased (inf --> -0.345926).  Saving model ...
Epoch: 2 cost time: 2.6461522579193115
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.182 Vali Acc: 0.714 Test Loss: 1.182 Test Acc: 0.714
Validation loss decreased (-0.345926 --> -0.713502).  Saving model ...
Epoch: 3 cost time: 3.3590025901794434
Epoch: 3, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.363 Vali Acc: 0.914 Test Loss: 0.363 Test Acc: 0.914
Validation loss decreased (-0.713502 --> -0.913510).  Saving model ...
Epoch: 4 cost time: 3.3637614250183105
Epoch: 4, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.980024814605713
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.913510 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 3.4550721645355225
Epoch: 6, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 2.8719005584716797
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 3.230144739151001
Epoch: 8, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.200 Vali Acc: 0.919 Test Loss: 0.200 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1801319122314453
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.076941967010498
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7812795639038086
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.383 Vali Acc: 0.873 Test Loss: 0.383 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8765766620635986
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.225 Vali Acc: 0.924 Test Loss: 0.225 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.184512138366699
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9578022956848145
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7011213302612305
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.230 Vali Acc: 0.908 Test Loss: 0.230 Test Acc: 0.908
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.864640712738037
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.908 Test Loss: 0.244 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8615055084228516
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 10745925
model size : 46.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.9709413051605225
Epoch: 1, Steps: 17 | Train Loss: 2.312 Vali Loss: 2.021 Vali Acc: 0.243 Test Loss: 2.021 Test Acc: 0.243
Validation loss decreased (inf --> -0.243223).  Saving model ...
Epoch: 2 cost time: 2.883975028991699
Epoch: 2, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.487 Vali Acc: 0.532 Test Loss: 1.487 Test Acc: 0.532
Validation loss decreased (-0.243223 --> -0.532418).  Saving model ...
Epoch: 3 cost time: 2.649688482284546
Epoch: 3, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.394 Vali Acc: 0.914 Test Loss: 0.394 Test Acc: 0.914
Validation loss decreased (-0.532418 --> -0.913510).  Saving model ...
Epoch: 4 cost time: 3.0064163208007812
Epoch: 4, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.210244655609131
Epoch: 5, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.383 Vali Acc: 0.881 Test Loss: 0.383 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9517128467559814
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.913510 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 2.594965934753418
Epoch: 7, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9802377223968506
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.910594940185547
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.242 Vali Acc: 0.916 Test Loss: 0.242 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.835757255554199
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5963549613952637
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 2.751951217651367
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
Validation loss decreased (-0.954053 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 2.738199234008789
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4460878372192383
Epoch: 14, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.320 Vali Acc: 0.876 Test Loss: 0.320 Test Acc: 0.876
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.803046226501465
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.255 Vali Acc: 0.914 Test Loss: 0.255 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.818856954574585
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.298337936401367
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.16841459274292
Epoch: 18, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9196696281433105
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.967427968978882
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.908 Test Loss: 0.304 Test Acc: 0.908
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.750018835067749
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.884409189224243
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 10744133
model size : 46.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.971808910369873
Epoch: 1, Steps: 17 | Train Loss: 2.311 Vali Loss: 1.885 Vali Acc: 0.405 Test Loss: 1.885 Test Acc: 0.405
Validation loss decreased (inf --> -0.405387).  Saving model ...
Epoch: 2 cost time: 2.769472122192383
Epoch: 2, Steps: 17 | Train Loss: 1.707 Vali Loss: 0.996 Vali Acc: 0.781 Test Loss: 0.996 Test Acc: 0.781
Validation loss decreased (-0.405387 --> -0.781071).  Saving model ...
Epoch: 3 cost time: 3.2221007347106934
Epoch: 3, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
Validation loss decreased (-0.781071 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 3.3691375255584717
Epoch: 4, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.846486806869507
Epoch: 5, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.256 Vali Acc: 0.924 Test Loss: 0.256 Test Acc: 0.924
Validation loss decreased (-0.910807 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 3.059908628463745
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.723992109298706
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 2.9140141010284424
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.943241 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 3.138404130935669
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5014166831970215
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 3.308274984359741
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1270008087158203
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.788125991821289
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.943 Test Loss: 0.127 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1912388801574707
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 3.8768012523651123
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8411245346069336
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0165774822235107
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.500485420227051
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8833584785461426
Epoch: 19, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.335 Vali Acc: 0.914 Test Loss: 0.335 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.106783866882324
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7024827003479004
Epoch: 21, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.905 Test Loss: 0.266 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.2912182807922363
Epoch: 22, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.916 Test Loss: 0.261 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9836490154266357
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.628547430038452
Epoch: 24, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.178 Vali Acc: 0.932 Test Loss: 0.178 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 10158533
model size : 43.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.511691093444824
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 2.028 Vali Acc: 0.432 Test Loss: 2.028 Test Acc: 0.432
Validation loss decreased (inf --> -0.432412).  Saving model ...
Epoch: 2 cost time: 3.072129249572754
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.075 Vali Acc: 0.743 Test Loss: 1.075 Test Acc: 0.743
Validation loss decreased (-0.432412 --> -0.743232).  Saving model ...
Epoch: 3 cost time: 2.7637734413146973
Epoch: 3, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.400 Vali Acc: 0.905 Test Loss: 0.400 Test Acc: 0.905
Validation loss decreased (-0.743232 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 2.8257949352264404
Epoch: 4, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
Validation loss decreased (-0.905401 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 3.785447835922241
Epoch: 5, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.255 Vali Acc: 0.908 Test Loss: 0.255 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3120644092559814
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.260 Vali Acc: 0.914 Test Loss: 0.260 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8226115703582764
Epoch: 7, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 3.5195982456207275
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.170 Vali Acc: 0.938 Test Loss: 0.170 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.281179666519165
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 2.914013385772705
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5572187900543213
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 3.510310649871826
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3721859455108643
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.136451005935669
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.296600341796875
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.15142560005188
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8721823692321777
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.746368646621704
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.808746576309204
Epoch: 19, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.802095413208008
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.582653760910034
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 10156741
model size : 43.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.155156850814819
Epoch: 1, Steps: 17 | Train Loss: 2.285 Vali Loss: 2.065 Vali Acc: 0.292 Test Loss: 2.065 Test Acc: 0.292
Validation loss decreased (inf --> -0.291871).  Saving model ...
Epoch: 2 cost time: 2.5871565341949463
Epoch: 2, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.536 Vali Acc: 0.538 Test Loss: 1.536 Test Acc: 0.538
Validation loss decreased (-0.291871 --> -0.537822).  Saving model ...
Epoch: 3 cost time: 2.8567960262298584
Epoch: 3, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.414 Vali Acc: 0.892 Test Loss: 0.414 Test Acc: 0.892
Validation loss decreased (-0.537822 --> -0.891888).  Saving model ...
Epoch: 4 cost time: 2.2305619716644287
Epoch: 4, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.891888 --> -0.948647).  Saving model ...
Epoch: 5 cost time: 2.884467124938965
Epoch: 5, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4965107440948486
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 2.224677324295044
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.130277633666992
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.392 Vali Acc: 0.886 Test Loss: 0.392 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.528445243835449
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.223755121231079
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6988372802734375
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.948647 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 2.2204229831695557
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3767008781433105
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.319 Vali Acc: 0.897 Test Loss: 0.319 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7818427085876465
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.633070230484009
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.8979063034057617
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.568000316619873
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.014474630355835
Epoch: 18, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9423162937164307
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.416372776031494
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.614102602005005
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.914 Test Loss: 0.225 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.355313539505005
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.957 Test Loss: 0.101 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9707934856414795
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.6075220108032227
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.620368480682373
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 10154949
model size : 43.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.21592903137207
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 1.901 Vali Acc: 0.468 Test Loss: 1.901 Test Acc: 0.468
Validation loss decreased (inf --> -0.467549).  Saving model ...
Epoch: 2 cost time: 3.1180477142333984
Epoch: 2, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.037 Vali Acc: 0.770 Test Loss: 1.037 Test Acc: 0.770
Validation loss decreased (-0.467549 --> -0.770260).  Saving model ...
Epoch: 3 cost time: 3.1325910091400146
Epoch: 3, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.770260 --> -0.921618).  Saving model ...
Epoch: 4 cost time: 2.9579195976257324
Epoch: 4, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.264 Vali Acc: 0.927 Test Loss: 0.264 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 2.8020851612091064
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 6 cost time: 3.236732244491577
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.929727 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 2.487774133682251
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8024790287017822
Epoch: 8, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.263 Vali Acc: 0.905 Test Loss: 0.263 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0426127910614014
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.047060966491699
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 2.7531514167785645
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8263018131256104
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 2.6872220039367676
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4505224227905273
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.780395269393921
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.685676336288452
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5665299892425537
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.3502399921417236
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7900266647338867
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.721625328063965
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6959309577941895
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.923318862915039
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 10153157
model size : 43.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.501939296722412
Epoch: 1, Steps: 17 | Train Loss: 2.310 Vali Loss: 2.066 Vali Acc: 0.214 Test Loss: 2.066 Test Acc: 0.214
Validation loss decreased (inf --> -0.213493).  Saving model ...
Epoch: 2 cost time: 2.9628591537475586
Epoch: 2, Steps: 17 | Train Loss: 1.995 Vali Loss: 1.698 Vali Acc: 0.446 Test Loss: 1.698 Test Acc: 0.446
Validation loss decreased (-0.213493 --> -0.445929).  Saving model ...
Epoch: 3 cost time: 2.7306954860687256
Epoch: 3, Steps: 17 | Train Loss: 1.282 Vali Loss: 0.795 Vali Acc: 0.827 Test Loss: 0.795 Test Acc: 0.827
Validation loss decreased (-0.445929 --> -0.827019).  Saving model ...
Epoch: 4 cost time: 2.934124231338501
Epoch: 4, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.379 Vali Acc: 0.927 Test Loss: 0.379 Test Acc: 0.927
Validation loss decreased (-0.827019 --> -0.927023).  Saving model ...
Epoch: 5 cost time: 3.8579704761505127
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.298 Vali Acc: 0.905 Test Loss: 0.298 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0189523696899414
Epoch: 6, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929728).  Saving model ...
Epoch: 7 cost time: 2.8604249954223633
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
Validation loss decreased (-0.929728 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 2.806840419769287
Epoch: 8, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.943242 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 2.8730318546295166
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2987334728240967
Epoch: 10, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2367546558380127
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.144 Vali Acc: 0.941 Test Loss: 0.144 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2817373275756836
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9091858863830566
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.954 Test Loss: 0.118 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.942319869995117
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.275416612625122
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 3.367218494415283
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 3.189560651779175
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.914 Test Loss: 0.231 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8378965854644775
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.797823905944824
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9978461265563965
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 3.7220053672790527
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.466348648071289
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.957 Test Loss: 0.103 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.424016237258911
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1823906898498535
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.68568754196167
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.768540620803833
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1142382621765137
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4441514015197754
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.4524378776550293
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8070645332336426
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.962 Test Loss: 0.089 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4793029
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.270223379135132
Epoch: 1, Steps: 17 | Train Loss: 2.336 Vali Loss: 2.106 Vali Acc: 0.168 Test Loss: 2.106 Test Acc: 0.168
Validation loss decreased (inf --> -0.167547).  Saving model ...
Epoch: 2 cost time: 2.864197015762329
Epoch: 2, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.656 Vali Acc: 0.432 Test Loss: 1.656 Test Acc: 0.432
Validation loss decreased (-0.167547 --> -0.432416).  Saving model ...
Epoch: 3 cost time: 3.4577016830444336
Epoch: 3, Steps: 17 | Train Loss: 1.235 Vali Loss: 0.861 Vali Acc: 0.770 Test Loss: 0.861 Test Acc: 0.770
Validation loss decreased (-0.432416 --> -0.770262).  Saving model ...
Epoch: 4 cost time: 2.7078700065612793
Epoch: 4, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
Validation loss decreased (-0.770262 --> -0.921618).  Saving model ...
Epoch: 5 cost time: 3.071979284286499
Epoch: 5, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.328 Vali Acc: 0.914 Test Loss: 0.328 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.607180118560791
Epoch: 6, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
Validation loss decreased (-0.921618 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 3.012779951095581
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.238 Vali Acc: 0.914 Test Loss: 0.238 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.730562686920166
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 3.102963924407959
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.232 Vali Acc: 0.908 Test Loss: 0.232 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.836397647857666
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.170 Vali Acc: 0.938 Test Loss: 0.170 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3897035121917725
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.354694128036499
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.183 Vali Acc: 0.932 Test Loss: 0.183 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5912134647369385
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 3.325532913208008
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.233417510986328
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 2.617302179336548
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.6884384155273438
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.479386329650879
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.541372537612915
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 2.8365015983581543
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7984867095947266
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7401375770568848
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5634098052978516
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.7648916244506836
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.8763318061828613
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.889854669570923
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.722808361053467
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1248440742492676
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7049953937530518
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8064634799957275
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.8961470127105713
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.822476625442505
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.907334089279175
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 4792133
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.615036249160767
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 1.949 Vali Acc: 0.305 Test Loss: 1.949 Test Acc: 0.305
Validation loss decreased (inf --> -0.305386).  Saving model ...
Epoch: 2 cost time: 2.995112419128418
Epoch: 2, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.481 Vali Acc: 0.622 Test Loss: 1.481 Test Acc: 0.622
Validation loss decreased (-0.305386 --> -0.621607).  Saving model ...
Epoch: 3 cost time: 3.1625022888183594
Epoch: 3, Steps: 17 | Train Loss: 1.051 Vali Loss: 0.690 Vali Acc: 0.859 Test Loss: 0.690 Test Acc: 0.859
Validation loss decreased (-0.621607 --> -0.859453).  Saving model ...
Epoch: 4 cost time: 3.014615297317505
Epoch: 4, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
Validation loss decreased (-0.859453 --> -0.910807).  Saving model ...
Epoch: 5 cost time: 3.0241756439208984
Epoch: 5, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4721457958221436
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.252 Vali Acc: 0.932 Test Loss: 0.252 Test Acc: 0.932
Validation loss decreased (-0.910807 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 3.1256349086761475
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
Validation loss decreased (-0.932430 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 3.2768874168395996
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9189698696136475
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 2.380925416946411
Epoch: 10, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9440855979919434
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2823092937469482
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7857136726379395
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.919 Test Loss: 0.208 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6913340091705322
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 2.8107097148895264
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0201542377471924
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8473398685455322
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.779581308364868
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.487837553024292
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.954053 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 3.1736912727355957
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.832228183746338
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6998746395111084
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6471614837646484
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.854677200317383
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3674228191375732
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5663304328918457
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.156379222869873
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9479236602783203
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9260199069976807
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8273909091949463
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.6492161750793457
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.0762436389923096
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.9870283603668213
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 4791237
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.927007675170898
Epoch: 1, Steps: 17 | Train Loss: 2.252 Vali Loss: 2.189 Vali Acc: 0.143 Test Loss: 2.189 Test Acc: 0.143
Validation loss decreased (inf --> -0.143221).  Saving model ...
Epoch: 2 cost time: 3.228693962097168
Epoch: 2, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.577 Vali Acc: 0.419 Test Loss: 1.577 Test Acc: 0.419
Validation loss decreased (-0.143221 --> -0.418903).  Saving model ...
Epoch: 3 cost time: 2.7355873584747314
Epoch: 3, Steps: 17 | Train Loss: 1.163 Vali Loss: 0.771 Vali Acc: 0.841 Test Loss: 0.771 Test Acc: 0.841
Validation loss decreased (-0.418903 --> -0.840533).  Saving model ...
Epoch: 4 cost time: 3.0276875495910645
Epoch: 4, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.468 Vali Acc: 0.905 Test Loss: 0.468 Test Acc: 0.905
Validation loss decreased (-0.840533 --> -0.905401).  Saving model ...
Epoch: 5 cost time: 2.72615385055542
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.905401 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 2.87436842918396
Epoch: 6, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.962130069732666
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.568183422088623
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7031922340393066
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.215 Vali Acc: 0.932 Test Loss: 0.215 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.579949378967285
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.185 Vali Acc: 0.932 Test Loss: 0.185 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.52632737159729
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.940538 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 2.8851280212402344
Epoch: 12, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 13 cost time: 3.005040407180786
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.719904661178589
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.211674690246582
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.753174066543579
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0535483360290527
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8154690265655518
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.607696294784546
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.954 Test Loss: 0.110 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.314070701599121
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.723201274871826
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 2.9812264442443848
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4589438438415527
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.538783311843872
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7884812355041504
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.945004940032959
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.6824421882629395
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.246600866317749
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.025064468383789
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.7219736576080322
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.107578754425049
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4790341
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.349278926849365
Epoch: 1, Steps: 17 | Train Loss: 2.295 Vali Loss: 2.106 Vali Acc: 0.184 Test Loss: 2.106 Test Acc: 0.184
Validation loss decreased (inf --> -0.183763).  Saving model ...
Epoch: 2 cost time: 2.71283221244812
Epoch: 2, Steps: 17 | Train Loss: 2.009 Vali Loss: 1.641 Vali Acc: 0.724 Test Loss: 1.641 Test Acc: 0.724
Validation loss decreased (-0.183763 --> -0.724308).  Saving model ...
Epoch: 3 cost time: 2.8522613048553467
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 0.766 Vali Acc: 0.911 Test Loss: 0.766 Test Acc: 0.911
Validation loss decreased (-0.724308 --> -0.910803).  Saving model ...
Epoch: 4 cost time: 2.3513028621673584
Epoch: 4, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.401 Vali Acc: 0.924 Test Loss: 0.401 Test Acc: 0.924
Validation loss decreased (-0.910803 --> -0.924320).  Saving model ...
Epoch: 5 cost time: 2.6933743953704834
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.295 Vali Acc: 0.924 Test Loss: 0.295 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 2.918762445449829
Epoch: 6, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.924321 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 2.9559762477874756
Epoch: 7, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.231 Vali Acc: 0.924 Test Loss: 0.231 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.11354923248291
Epoch: 8, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5336453914642334
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8278186321258545
Epoch: 10, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 2.7502763271331787
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.710453510284424
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3073906898498535
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.9886109828948975
Epoch: 14, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.296663522720337
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.48638653755188
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.099550247192383
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 3.052389621734619
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0298991203308105
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.959 Test Loss: 0.090 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.782224178314209
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.102245807647705
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.783667802810669
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.9271128177642822
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.906459093093872
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.232746124267578
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9128189086914062
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 2.991095542907715
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 2.8809738159179688
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7260379791259766
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.094820499420166
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4350366592407227
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.029100179672241
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 3.1710071563720703
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 3.165943145751953
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6007165908813477
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.98685359954834
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 3.582552909851074
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 2.9730379581451416
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.6509974002838135
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.700831413269043
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.7936315536499023
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.625058650970459
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.1035561561584473
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 44 cost time: 2.9950740337371826
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.8793976306915283
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 46 cost time: 2.6033530235290527
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.993448257446289
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.1400327682495117
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.0603079795837402
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.21968936920166
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.1827735900878906
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.8866662979125977
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.9455127716064453
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.658019542694092
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.642810106277466
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 3608773
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.755268096923828
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 2.017 Vali Acc: 0.286 Test Loss: 2.017 Test Acc: 0.286
Validation loss decreased (inf --> -0.286466).  Saving model ...
Epoch: 2 cost time: 2.705650568008423
Epoch: 2, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.509 Vali Acc: 0.611 Test Loss: 1.509 Test Acc: 0.611
Validation loss decreased (-0.286466 --> -0.610796).  Saving model ...
Epoch: 3 cost time: 2.4399144649505615
Epoch: 3, Steps: 17 | Train Loss: 1.165 Vali Loss: 0.706 Vali Acc: 0.897 Test Loss: 0.706 Test Acc: 0.897
Validation loss decreased (-0.610796 --> -0.897290).  Saving model ...
Epoch: 4 cost time: 2.526167631149292
Epoch: 4, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.378 Vali Acc: 0.916 Test Loss: 0.378 Test Acc: 0.916
Validation loss decreased (-0.897290 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 2.4489266872406006
Epoch: 5, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.270 Vali Acc: 0.927 Test Loss: 0.270 Test Acc: 0.927
Validation loss decreased (-0.916212 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 2.4014012813568115
Epoch: 6, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.279 Vali Acc: 0.916 Test Loss: 0.279 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.707813024520874
Epoch: 7, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.927024 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.7584457397460938
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.466309070587158
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 2.999476671218872
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 2.8625895977020264
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.026085615158081
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.599547863006592
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.474364757537842
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9324944019317627
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7264163494110107
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6504123210906982
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 2.819580554962158
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4142448902130127
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 2.6040072441101074
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 3.8229963779449463
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.141331434249878
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0614874362945557
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1337976455688477
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9939169883728027
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.521613597869873
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4958746433258057
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5635299682617188
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.546771764755249
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.881042957305908
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 3607877
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.784518241882324
Epoch: 1, Steps: 17 | Train Loss: 2.235 Vali Loss: 2.000 Vali Acc: 0.341 Test Loss: 2.000 Test Acc: 0.341
Validation loss decreased (inf --> -0.340521).  Saving model ...
Epoch: 2 cost time: 2.90800404548645
Epoch: 2, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.524 Vali Acc: 0.632 Test Loss: 1.524 Test Acc: 0.632
Validation loss decreased (-0.340521 --> -0.632417).  Saving model ...
Epoch: 3 cost time: 3.1611642837524414
Epoch: 3, Steps: 17 | Train Loss: 1.273 Vali Loss: 0.845 Vali Acc: 0.835 Test Loss: 0.845 Test Acc: 0.835
Validation loss decreased (-0.632417 --> -0.835127).  Saving model ...
Epoch: 4 cost time: 2.7802846431732178
Epoch: 4, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
Validation loss decreased (-0.835127 --> -0.902699).  Saving model ...
Epoch: 5 cost time: 3.0256283283233643
Epoch: 5, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.292 Vali Acc: 0.916 Test Loss: 0.292 Test Acc: 0.916
Validation loss decreased (-0.902699 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 3.0942111015319824
Epoch: 6, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.212 Vali Acc: 0.938 Test Loss: 0.212 Test Acc: 0.938
Validation loss decreased (-0.916213 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 2.960421562194824
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 3.2156598567962646
Epoch: 8, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.256901502609253
Epoch: 9, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 3.414965867996216
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5371129512786865
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1205711364746094
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 2.8987488746643066
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 3.039921522140503
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 3.0575828552246094
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 3.4625425338745117
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.730417251586914
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2928640842437744
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4934613704681396
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.539590835571289
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.845597505569458
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.361243486404419
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 3.6450886726379395
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.569074869155884
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.7821669578552246
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 2.7784719467163086
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5724663734436035
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2669601440429688
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.068297863006592
Epoch: 29, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.332 Vali Acc: 0.892 Test Loss: 0.332 Test Acc: 0.892
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3946189880371094
Epoch: 30, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.200 Vali Acc: 0.932 Test Loss: 0.200 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.5527076721191406
Epoch: 31, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.145029306411743
Epoch: 32, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.3112940788269043
Epoch: 33, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.049504280090332
Epoch: 34, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2612698078155518
Epoch: 35, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3606981
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.462526082992554
Epoch: 1, Steps: 17 | Train Loss: 2.313 Vali Loss: 2.107 Vali Acc: 0.089 Test Loss: 2.107 Test Acc: 0.089
Validation loss decreased (inf --> -0.089168).  Saving model ...
Epoch: 2 cost time: 2.8350815773010254
Epoch: 2, Steps: 17 | Train Loss: 1.977 Vali Loss: 1.710 Vali Acc: 0.443 Test Loss: 1.710 Test Acc: 0.443
Validation loss decreased (-0.089168 --> -0.443226).  Saving model ...
Epoch: 3 cost time: 3.3336780071258545
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.031 Vali Acc: 0.705 Test Loss: 1.031 Test Acc: 0.705
Validation loss decreased (-0.443226 --> -0.705395).  Saving model ...
Epoch: 4 cost time: 2.561300754547119
Epoch: 4, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.454 Vali Acc: 0.911 Test Loss: 0.454 Test Acc: 0.911
Validation loss decreased (-0.705395 --> -0.910806).  Saving model ...
Epoch: 5 cost time: 2.735625982284546
Epoch: 5, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.336 Vali Acc: 0.914 Test Loss: 0.336 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913510).  Saving model ...
Epoch: 6 cost time: 2.7154042720794678
Epoch: 6, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
Validation loss decreased (-0.913510 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 3.298577070236206
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5524840354919434
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 2.9714136123657227
Epoch: 9, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.766221761703491
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 2.8894143104553223
Epoch: 11, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.954053 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 3.1646223068237305
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.916637420654297
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.474245071411133
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0441269874572754
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8216350078582764
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 3.402712821960449
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.183957815170288
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9651453495025635
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 3.522712469100952
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.001347064971924
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7429990768432617
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 2.750227928161621
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9732635021209717
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3337371349334717
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8703219890594482
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.874243974685669
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.75213360786438
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8263919353485107
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.2181506156921387
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.855875253677368
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.6268410682678223
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 3606085
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.133365631103516
Epoch: 1, Steps: 17 | Train Loss: 2.345 Vali Loss: 2.031 Vali Acc: 0.238 Test Loss: 2.031 Test Acc: 0.238
Validation loss decreased (inf --> -0.237818).  Saving model ...
Epoch: 2 cost time: 2.7118945121765137
Epoch: 2, Steps: 17 | Train Loss: 2.100 Vali Loss: 1.721 Vali Acc: 0.657 Test Loss: 1.721 Test Acc: 0.657
Validation loss decreased (-0.237818 --> -0.656740).  Saving model ...
Epoch: 3 cost time: 2.89687442779541
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 0.997 Vali Acc: 0.822 Test Loss: 0.997 Test Acc: 0.822
Validation loss decreased (-0.656740 --> -0.821612).  Saving model ...
Epoch: 4 cost time: 2.6021718978881836
Epoch: 4, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.541 Vali Acc: 0.892 Test Loss: 0.541 Test Acc: 0.892
Validation loss decreased (-0.821612 --> -0.891886).  Saving model ...
Epoch: 5 cost time: 2.5650405883789062
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.318 Vali Acc: 0.924 Test Loss: 0.318 Test Acc: 0.924
Validation loss decreased (-0.891886 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 3.47357439994812
Epoch: 6, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
Validation loss decreased (-0.924321 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 2.8612780570983887
Epoch: 7, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.387 Vali Acc: 0.886 Test Loss: 0.387 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.919524669647217
Epoch: 8, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 3.226328134536743
Epoch: 9, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7303593158721924
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 2.89311146736145
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.593564510345459
Epoch: 12, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6475234031677246
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 2.790109634399414
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 2.989506244659424
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 3.26069974899292
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.817850112915039
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.892615556716919
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 2.8666210174560547
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0139827728271484
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 3.127671480178833
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.407545804977417
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7927961349487305
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.943 Test Loss: 0.134 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.541262149810791
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.308237314224243
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.1672911643981934
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.0278968811035156
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 3.725027561187744
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.055576801300049
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1649913787841797
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.824953317642212
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6105847358703613
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.0294065475463867
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.852562189102173
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.3280200958251953
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.998535394668579
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.0749855041503906
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 3016645
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.79029655456543
Epoch: 1, Steps: 17 | Train Loss: 2.296 Vali Loss: 2.241 Vali Acc: 0.065 Test Loss: 2.241 Test Acc: 0.065
Validation loss decreased (inf --> -0.064842).  Saving model ...
Epoch: 2 cost time: 3.2725303173065186
Epoch: 2, Steps: 17 | Train Loss: 2.111 Vali Loss: 1.963 Vali Acc: 0.378 Test Loss: 1.963 Test Acc: 0.378
Validation loss decreased (-0.064842 --> -0.378359).  Saving model ...
Epoch: 3 cost time: 2.9710021018981934
Epoch: 3, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.231 Vali Acc: 0.768 Test Loss: 1.231 Test Acc: 0.768
Validation loss decreased (-0.378359 --> -0.767555).  Saving model ...
Epoch: 4 cost time: 3.371511220932007
Epoch: 4, Steps: 17 | Train Loss: 0.878 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
Validation loss decreased (-0.767555 --> -0.870265).  Saving model ...
Epoch: 5 cost time: 2.821603298187256
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
Validation loss decreased (-0.870265 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 3.65128493309021
Epoch: 6, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.343247890472412
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.289 Vali Acc: 0.905 Test Loss: 0.289 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0226058959960938
Epoch: 8, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.7075843811035156
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.948647 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.804715156555176
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.048142433166504
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.222 Vali Acc: 0.927 Test Loss: 0.222 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0577032566070557
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.864518165588379
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 3.270291566848755
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5505309104919434
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4757091999053955
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8839118480682373
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.824185609817505
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.139224052429199
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.983156442642212
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.219156265258789
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.67899489402771
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.955069065093994
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 3015749
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.137985706329346
Epoch: 1, Steps: 17 | Train Loss: 2.293 Vali Loss: 2.144 Vali Acc: 0.224 Test Loss: 2.144 Test Acc: 0.224
Validation loss decreased (inf --> -0.224303).  Saving model ...
Epoch: 2 cost time: 2.4008350372314453
Epoch: 2, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.797 Vali Acc: 0.519 Test Loss: 1.797 Test Acc: 0.519
Validation loss decreased (-0.224303 --> -0.518901).  Saving model ...
Epoch: 3 cost time: 2.6650102138519287
Epoch: 3, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.138 Vali Acc: 0.808 Test Loss: 1.138 Test Acc: 0.808
Validation loss decreased (-0.518901 --> -0.808097).  Saving model ...
Epoch: 4 cost time: 3.3621907234191895
Epoch: 4, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.808097 --> -0.899995).  Saving model ...
Epoch: 5 cost time: 3.08870267868042
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.265 Vali Acc: 0.946 Test Loss: 0.265 Test Acc: 0.946
Validation loss decreased (-0.899995 --> -0.945943).  Saving model ...
Epoch: 6 cost time: 3.0692787170410156
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.301 Vali Acc: 0.914 Test Loss: 0.301 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9914920330047607
Epoch: 7, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.27805233001709
Epoch: 8, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.180 Vali Acc: 0.932 Test Loss: 0.180 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0724170207977295
Epoch: 9, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.369980573654175
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.775315523147583
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.945943 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 2.742344379425049
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3688712120056152
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 3.0547146797180176
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.013889789581299
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.23725962638855
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4720311164855957
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 3.1520237922668457
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.05552339553833
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.799543857574463
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.816371440887451
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.096644163131714
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.052957057952881
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.732210159301758
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.935 Test Loss: 0.172 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.904254913330078
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9723408222198486
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.838921308517456
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3014853
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.956924200057983
Epoch: 1, Steps: 17 | Train Loss: 2.276 Vali Loss: 2.124 Vali Acc: 0.154 Test Loss: 2.124 Test Acc: 0.154
Validation loss decreased (inf --> -0.154033).  Saving model ...
Epoch: 2 cost time: 3.072972536087036
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.721 Vali Acc: 0.527 Test Loss: 1.721 Test Acc: 0.527
Validation loss decreased (-0.154033 --> -0.527010).  Saving model ...
Epoch: 3 cost time: 3.3332808017730713
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 0.979 Vali Acc: 0.838 Test Loss: 0.979 Test Acc: 0.838
Validation loss decreased (-0.527010 --> -0.837828).  Saving model ...
Epoch: 4 cost time: 3.7919626235961914
Epoch: 4, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.531 Vali Acc: 0.895 Test Loss: 0.531 Test Acc: 0.895
Validation loss decreased (-0.837828 --> -0.894589).  Saving model ...
Epoch: 5 cost time: 2.985405683517456
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
Validation loss decreased (-0.894589 --> -0.921619).  Saving model ...
Epoch: 6 cost time: 2.6830408573150635
Epoch: 6, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
Validation loss decreased (-0.921619 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 2.880113363265991
Epoch: 7, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1392908096313477
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.6960384845733643
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.847233772277832
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 3.0067317485809326
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6234233379364014
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0040090084075928
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7200775146484375
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.279 Vali Acc: 0.892 Test Loss: 0.279 Test Acc: 0.892
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.328138828277588
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.103881597518921
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4365947246551514
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1888155937194824
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.908 Test Loss: 0.239 Test Acc: 0.908
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.111747980117798
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6631579399108887
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.794313430786133
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1150028705596924
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.314852237701416
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7266650199890137
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.738340377807617
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.651590585708618
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.0011513233184814
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9330501556396484
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.830991506576538
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.010531187057495
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 3013957
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.7015461921691895
Epoch: 1, Steps: 17 | Train Loss: 2.402 Vali Loss: 2.114 Vali Acc: 0.211 Test Loss: 2.114 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 2.88480806350708
Epoch: 2, Steps: 17 | Train Loss: 2.084 Vali Loss: 1.842 Vali Acc: 0.395 Test Loss: 1.842 Test Acc: 0.395
Validation loss decreased (-0.210790 --> -0.394576).  Saving model ...
Epoch: 3 cost time: 3.0579288005828857
Epoch: 3, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.199 Vali Acc: 0.835 Test Loss: 1.199 Test Acc: 0.835
Validation loss decreased (-0.394576 --> -0.835123).  Saving model ...
Epoch: 4 cost time: 2.8660244941711426
Epoch: 4, Steps: 17 | Train Loss: 0.948 Vali Loss: 0.589 Vali Acc: 0.876 Test Loss: 0.589 Test Acc: 0.876
Validation loss decreased (-0.835123 --> -0.875670).  Saving model ...
Epoch: 5 cost time: 3.085075616836548
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
Validation loss decreased (-0.875670 --> -0.902699).  Saving model ...
Epoch: 6 cost time: 2.7498838901519775
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
Validation loss decreased (-0.902699 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 2.7131235599517822
Epoch: 7, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.243 Vali Acc: 0.924 Test Loss: 0.243 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9704768657684326
Epoch: 8, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.8496437072753906
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 2.5471463203430176
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.951406478881836
Epoch: 11, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.229 Vali Acc: 0.916 Test Loss: 0.229 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7921547889709473
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 2.6748952865600586
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4236373901367188
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5727500915527344
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6054768562316895
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.007563352584839
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4791858196258545
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.946 Test Loss: 0.121 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9051263332366943
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 2.6391265392303467
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.959 Test Loss: 0.083 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0876119136810303
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8763136863708496
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9676995277404785
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.342268228530884
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.965 Test Loss: 0.089 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6088953018188477
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.388327121734619
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 27 cost time: 2.868023633956909
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.209322452545166
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.767559051513672
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.436030626296997
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.4167001247406006
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.962 Test Loss: 0.091 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.652900218963623
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.0429511070251465
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.3752641677856445
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 3.2488389015197754
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.7757930755615234
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.7273032665252686
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.6713058948516846
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.5727317333221436
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.004315137863159
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.772183418273926
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.768264055252075
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.149078369140625
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.426220178604126
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2720581
model size : 13.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.845840930938721
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.071 Vali Acc: 0.146 Test Loss: 2.071 Test Acc: 0.146
Validation loss decreased (inf --> -0.145925).  Saving model ...
Epoch: 2 cost time: 3.0089733600616455
Epoch: 2, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.766 Vali Acc: 0.435 Test Loss: 1.766 Test Acc: 0.435
Validation loss decreased (-0.145925 --> -0.435117).  Saving model ...
Epoch: 3 cost time: 3.240677833557129
Epoch: 3, Steps: 17 | Train Loss: 1.309 Vali Loss: 0.847 Vali Acc: 0.832 Test Loss: 0.847 Test Acc: 0.832
Validation loss decreased (-0.435117 --> -0.832424).  Saving model ...
Epoch: 4 cost time: 2.9717001914978027
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.415 Vali Acc: 0.914 Test Loss: 0.415 Test Acc: 0.914
Validation loss decreased (-0.832424 --> -0.913509).  Saving model ...
Epoch: 5 cost time: 3.4088263511657715
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918916).  Saving model ...
Epoch: 6 cost time: 3.6691744327545166
Epoch: 6, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.918916 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.9222028255462646
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 2.840604305267334
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.504164934158325
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 2.913937568664551
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.69350528717041
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 3.0077707767486572
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.412402868270874
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.571718454360962
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.778320789337158
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6276841163635254
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.941 Test Loss: 0.137 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7942168712615967
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.1714508533477783
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.624279022216797
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5695278644561768
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.8365976810455322
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2719685
model size : 13.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.02410626411438
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.050 Vali Acc: 0.222 Test Loss: 2.050 Test Acc: 0.222
Validation loss decreased (inf --> -0.221601).  Saving model ...
Epoch: 2 cost time: 3.03230619430542
Epoch: 2, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.669 Vali Acc: 0.649 Test Loss: 1.669 Test Acc: 0.649
Validation loss decreased (-0.221601 --> -0.648632).  Saving model ...
Epoch: 3 cost time: 2.6762495040893555
Epoch: 3, Steps: 17 | Train Loss: 1.454 Vali Loss: 0.953 Vali Acc: 0.892 Test Loss: 0.953 Test Acc: 0.892
Validation loss decreased (-0.648632 --> -0.891882).  Saving model ...
Epoch: 4 cost time: 3.4316458702087402
Epoch: 4, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.891882 --> -0.899995).  Saving model ...
Epoch: 5 cost time: 2.8473258018493652
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
Validation loss decreased (-0.899995 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 2.2735536098480225
Epoch: 6, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.011502981185913
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
Validation loss decreased (-0.916213 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 2.917069435119629
Epoch: 8, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.937836 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 2.730466365814209
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0674026012420654
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6894936561584473
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.704586982727051
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.204 Vali Acc: 0.932 Test Loss: 0.204 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5324151515960693
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.889425277709961
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3306210041046143
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 2.651154041290283
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.679518222808838
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.441603660583496
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0293219089508057
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8491218090057373
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.808157444000244
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4232892990112305
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3745784759521484
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5462646484375
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6182398796081543
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5562360286712646
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2718789
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.087462663650513
Epoch: 1, Steps: 17 | Train Loss: 2.266 Vali Loss: 2.121 Vali Acc: 0.222 Test Loss: 2.121 Test Acc: 0.222
Validation loss decreased (inf --> -0.221600).  Saving model ...
Epoch: 2 cost time: 2.7276601791381836
Epoch: 2, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.926 Vali Acc: 0.438 Test Loss: 1.926 Test Acc: 0.438
Validation loss decreased (-0.221600 --> -0.437819).  Saving model ...
Epoch: 3 cost time: 2.7930233478546143
Epoch: 3, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.103 Vali Acc: 0.816 Test Loss: 1.103 Test Acc: 0.816
Validation loss decreased (-0.437819 --> -0.816205).  Saving model ...
Epoch: 4 cost time: 2.6231226921081543
Epoch: 4, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1330184936523438
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.304 Vali Acc: 0.916 Test Loss: 0.304 Test Acc: 0.916
Validation loss decreased (-0.816205 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 2.5917115211486816
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.743849754333496
Epoch: 7, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.221 Vali Acc: 0.924 Test Loss: 0.221 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924322).  Saving model ...
Epoch: 8 cost time: 2.688101053237915
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.924322 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.2280633449554443
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9583942890167236
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 2.8743183612823486
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7515370845794678
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 2.75274920463562
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.984325408935547
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9781057834625244
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8952386379241943
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8755931854248047
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.516191005706787
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3687758445739746
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.824721336364746
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0352046489715576
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.722642183303833
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.935 Test Loss: 0.152 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2219934463500977
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2717893
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.101880311965942
Epoch: 1, Steps: 17 | Train Loss: 2.272 Vali Loss: 2.133 Vali Acc: 0.251 Test Loss: 2.133 Test Acc: 0.251
Validation loss decreased (inf --> -0.251330).  Saving model ...
Epoch: 2 cost time: 3.201690673828125
Epoch: 2, Steps: 17 | Train Loss: 2.105 Vali Loss: 1.790 Vali Acc: 0.508 Test Loss: 1.790 Test Acc: 0.508
Validation loss decreased (-0.251330 --> -0.508090).  Saving model ...
Epoch: 3 cost time: 2.8854684829711914
Epoch: 3, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.324 Vali Acc: 0.678 Test Loss: 1.324 Test Acc: 0.678
Validation loss decreased (-0.508090 --> -0.678365).  Saving model ...
Epoch: 4 cost time: 2.826352834701538
Epoch: 4, Steps: 17 | Train Loss: 1.089 Vali Loss: 0.924 Vali Acc: 0.822 Test Loss: 0.924 Test Acc: 0.822
Validation loss decreased (-0.678365 --> -0.821612).  Saving model ...
Epoch: 5 cost time: 3.5926785469055176
Epoch: 5, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.505 Vali Acc: 0.938 Test Loss: 0.505 Test Acc: 0.938
Validation loss decreased (-0.821612 --> -0.937833).  Saving model ...
Epoch: 6 cost time: 3.121349573135376
Epoch: 6, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.411 Vali Acc: 0.932 Test Loss: 0.411 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4465174674987793
Epoch: 7, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.550616502761841
Epoch: 8, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
Validation loss decreased (-0.937833 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.8159945011138916
Epoch: 9, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 3.305307626724243
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 3.3966987133026123
Epoch: 11, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7175166606903076
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 3.1048433780670166
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9641003608703613
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8624932765960693
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.068325996398926
Epoch: 16, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.203 Vali Acc: 0.932 Test Loss: 0.203 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.587783098220825
Epoch: 17, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.631899833679199
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1762120723724365
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8350021839141846
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8513386249542236
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.9866840839385986
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1811333
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.9523842334747314
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.080 Vali Acc: 0.338 Test Loss: 2.080 Test Acc: 0.338
Validation loss decreased (inf --> -0.337817).  Saving model ...
Epoch: 2 cost time: 3.0643117427825928
Epoch: 2, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.858 Vali Acc: 0.414 Test Loss: 1.858 Test Acc: 0.414
Validation loss decreased (-0.337817 --> -0.413495).  Saving model ...
Epoch: 3 cost time: 2.8837625980377197
Epoch: 3, Steps: 17 | Train Loss: 1.613 Vali Loss: 1.164 Vali Acc: 0.795 Test Loss: 1.164 Test Acc: 0.795
Validation loss decreased (-0.413495 --> -0.794583).  Saving model ...
Epoch: 4 cost time: 2.8619225025177
Epoch: 4, Steps: 17 | Train Loss: 0.997 Vali Loss: 0.713 Vali Acc: 0.905 Test Loss: 0.713 Test Acc: 0.905
Validation loss decreased (-0.794583 --> -0.905398).  Saving model ...
Epoch: 5 cost time: 3.564607858657837
Epoch: 5, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.544 Vali Acc: 0.876 Test Loss: 0.544 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.187162399291992
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.905398 --> -0.918915).  Saving model ...
Epoch: 7 cost time: 2.81638765335083
Epoch: 7, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3799808025360107
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
Validation loss decreased (-0.918915 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 2.272934675216675
Epoch: 9, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6423652172088623
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 3.251025915145874
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2477738857269287
Epoch: 12, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.267 Vali Acc: 0.924 Test Loss: 0.267 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.740717887878418
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7356672286987305
Epoch: 14, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0763707160949707
Epoch: 15, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8517746925354004
Epoch: 16, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2362470626831055
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1771130561828613
Epoch: 18, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7737715244293213
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.276007890701294
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 2.9877278804779053
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.203141212463379
Epoch: 22, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7740769386291504
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.691317319869995
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 3.3189895153045654
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.058359384536743
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7484335899353027
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0703985691070557
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.540677547454834
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7366485595703125
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 31 cost time: 3.322402000427246
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.807710886001587
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.975917100906372
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.824505567550659
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0136852264404297
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.7194154262542725
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 3.1288886070251465
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2300446033477783
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.7739064693450928
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.4602737426757812
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.398360013961792
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.5956497192382812
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.6041080951690674
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.064039707183838
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.0175845623016357
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.8675975799560547
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1810885
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.8005828857421875
Epoch: 1, Steps: 17 | Train Loss: 2.340 Vali Loss: 2.164 Vali Acc: 0.168 Test Loss: 2.164 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 2.6775567531585693
Epoch: 2, Steps: 17 | Train Loss: 2.128 Vali Loss: 1.944 Vali Acc: 0.389 Test Loss: 1.944 Test Acc: 0.389
Validation loss decreased (-0.167546 --> -0.389170).  Saving model ...
Epoch: 3 cost time: 2.874305009841919
Epoch: 3, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.433 Vali Acc: 0.676 Test Loss: 1.433 Test Acc: 0.676
Validation loss decreased (-0.389170 --> -0.675661).  Saving model ...
Epoch: 4 cost time: 3.0945637226104736
Epoch: 4, Steps: 17 | Train Loss: 1.206 Vali Loss: 0.911 Vali Acc: 0.811 Test Loss: 0.911 Test Acc: 0.811
Validation loss decreased (-0.675661 --> -0.810802).  Saving model ...
Epoch: 5 cost time: 2.8635358810424805
Epoch: 5, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.585 Vali Acc: 0.886 Test Loss: 0.585 Test Acc: 0.886
Validation loss decreased (-0.810802 --> -0.886481).  Saving model ...
Epoch: 6 cost time: 2.6055476665496826
Epoch: 6, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.433 Vali Acc: 0.905 Test Loss: 0.433 Test Acc: 0.905
Validation loss decreased (-0.886481 --> -0.905401).  Saving model ...
Epoch: 7 cost time: 3.2419750690460205
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.307 Vali Acc: 0.927 Test Loss: 0.307 Test Acc: 0.927
Validation loss decreased (-0.905401 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 2.8875865936279297
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.278 Vali Acc: 0.927 Test Loss: 0.278 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 9 cost time: 2.7444770336151123
Epoch: 9, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.927024 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 2.717766046524048
Epoch: 10, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8268556594848633
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.293 Vali Acc: 0.895 Test Loss: 0.293 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5768046379089355
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7156946659088135
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 2.4843084812164307
Epoch: 14, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.5597007274627686
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.56138277053833
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7259247303009033
Epoch: 17, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9932985305786133
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6159331798553467
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.930 Test Loss: 0.155 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.684732675552368
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5751702785491943
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3730571269989014
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.789677858352661
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6174235343933105
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1810437
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.196607351303101
Epoch: 1, Steps: 17 | Train Loss: 2.271 Vali Loss: 2.094 Vali Acc: 0.235 Test Loss: 2.094 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 3.796307325363159
Epoch: 2, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.037 Vali Acc: 0.457 Test Loss: 2.037 Test Acc: 0.457
Validation loss decreased (-0.235114 --> -0.456736).  Saving model ...
Epoch: 3 cost time: 2.7756218910217285
Epoch: 3, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.302 Vali Acc: 0.803 Test Loss: 1.302 Test Acc: 0.803
Validation loss decreased (-0.456736 --> -0.802690).  Saving model ...
Epoch: 4 cost time: 2.7435548305511475
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.795 Vali Acc: 0.873 Test Loss: 0.795 Test Acc: 0.873
Validation loss decreased (-0.802690 --> -0.872965).  Saving model ...
Epoch: 5 cost time: 2.6845366954803467
Epoch: 5, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.585 Vali Acc: 0.897 Test Loss: 0.585 Test Acc: 0.897
Validation loss decreased (-0.872965 --> -0.897291).  Saving model ...
Epoch: 6 cost time: 2.5600595474243164
Epoch: 6, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.353 Vali Acc: 0.935 Test Loss: 0.353 Test Acc: 0.935
Validation loss decreased (-0.897291 --> -0.935132).  Saving model ...
Epoch: 7 cost time: 2.779294490814209
Epoch: 7, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.265 Vali Acc: 0.951 Test Loss: 0.265 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 3.1073389053344727
Epoch: 8, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8324625492095947
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 2.5882508754730225
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.062838554382324
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0636260509490967
Epoch: 12, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7869749069213867
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 2.839669704437256
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.248 Vali Acc: 0.914 Test Loss: 0.248 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7458808422088623
Epoch: 15, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.959458 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.5552752017974854
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6683731079101562
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.843508005142212
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.158 Vali Acc: 0.938 Test Loss: 0.158 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8501853942871094
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1185295581817627
Epoch: 20, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8609228134155273
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1682498455047607
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.943 Test Loss: 0.124 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.834556818008423
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.838496446609497
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.403590679168701
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1809989
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.378769159317017
Epoch: 1, Steps: 17 | Train Loss: 2.334 Vali Loss: 2.174 Vali Acc: 0.132 Test Loss: 2.174 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 2.429837226867676
Epoch: 2, Steps: 17 | Train Loss: 2.144 Vali Loss: 1.995 Vali Acc: 0.270 Test Loss: 1.995 Test Acc: 0.270
Validation loss decreased (-0.132411 --> -0.270250).  Saving model ...
Epoch: 3 cost time: 3.2083184719085693
Epoch: 3, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.597 Vali Acc: 0.692 Test Loss: 1.597 Test Acc: 0.692
Validation loss decreased (-0.270250 --> -0.691876).  Saving model ...
Epoch: 4 cost time: 2.7647857666015625
Epoch: 4, Steps: 17 | Train Loss: 1.362 Vali Loss: 0.958 Vali Acc: 0.854 Test Loss: 0.958 Test Acc: 0.854
Validation loss decreased (-0.691876 --> -0.854044).  Saving model ...
Epoch: 5 cost time: 2.840533971786499
Epoch: 5, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.597 Vali Acc: 0.897 Test Loss: 0.597 Test Acc: 0.897
Validation loss decreased (-0.854044 --> -0.897291).  Saving model ...
Epoch: 6 cost time: 2.7349233627319336
Epoch: 6, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.400 Vali Acc: 0.919 Test Loss: 0.400 Test Acc: 0.919
Validation loss decreased (-0.897291 --> -0.918915).  Saving model ...
Epoch: 7 cost time: 3.0018157958984375
Epoch: 7, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.312 Vali Acc: 0.924 Test Loss: 0.312 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 8 cost time: 3.0213632583618164
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 2.841834545135498
Epoch: 9, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 2.8679964542388916
Epoch: 10, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.439526319503784
Epoch: 11, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5793886184692383
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.911794900894165
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943242).  Saving model ...
Epoch: 14 cost time: 2.8211846351623535
Epoch: 14, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 15 cost time: 2.443613052368164
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 2.6901025772094727
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4388601779937744
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.766800880432129
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 2.3942832946777344
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5499703884124756
Epoch: 20, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.240 Vali Acc: 0.924 Test Loss: 0.240 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.961911916732788
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.591801166534424
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9968655109405518
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.943 Test Loss: 0.135 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0208206176757812
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9397850036621094
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.638021230697632
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 2.8533108234405518
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7276718616485596
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8984549045562744
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 2.8609156608581543
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.536357879638672
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8375768661499023
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.4659714698791504
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.585383653640747
Epoch: 34, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.031759738922119
Epoch: 35, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.231501579284668
Epoch: 36, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 2.6892623901367188
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.9086785316467285
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.7901172637939453
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.5433287620544434
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.2730906009674072
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.908730983734131
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.9307377338409424
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.9711806774139404
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.9937076568603516
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.6096608638763428
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1216901
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.446401834487915
Epoch: 1, Steps: 17 | Train Loss: 2.329 Vali Loss: 2.175 Vali Acc: 0.141 Test Loss: 2.175 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 2.7868058681488037
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 1.958 Vali Acc: 0.346 Test Loss: 1.958 Test Acc: 0.346
Validation loss decreased (-0.140519 --> -0.345926).  Saving model ...
Epoch: 3 cost time: 2.4565255641937256
Epoch: 3, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.527 Vali Acc: 0.689 Test Loss: 1.527 Test Acc: 0.689
Validation loss decreased (-0.345926 --> -0.689174).  Saving model ...
Epoch: 4 cost time: 2.7528209686279297
Epoch: 4, Steps: 17 | Train Loss: 1.306 Vali Loss: 0.956 Vali Acc: 0.859 Test Loss: 0.956 Test Acc: 0.859
Validation loss decreased (-0.689174 --> -0.859450).  Saving model ...
Epoch: 5 cost time: 3.0083160400390625
Epoch: 5, Steps: 17 | Train Loss: 0.828 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
Validation loss decreased (-0.859450 --> -0.889183).  Saving model ...
Epoch: 6 cost time: 2.8835020065307617
Epoch: 6, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
Validation loss decreased (-0.889183 --> -0.921617).  Saving model ...
Epoch: 7 cost time: 2.6534321308135986
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.70699143409729
Epoch: 8, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.280 Vali Acc: 0.927 Test Loss: 0.280 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927024).  Saving model ...
Epoch: 9 cost time: 2.7636144161224365
Epoch: 9, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.927024 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 2.974924087524414
Epoch: 10, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.242 Vali Acc: 0.927 Test Loss: 0.242 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4692695140838623
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.689549446105957
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7751083374023438
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.564953088760376
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5851175785064697
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.851672887802124
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5569255352020264
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.232 Vali Acc: 0.916 Test Loss: 0.232 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.605853796005249
Epoch: 18, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.635342836380005
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.443449020385742
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 2.468815565109253
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4588029384613037
Epoch: 22, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 2.6141178607940674
Epoch: 23, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5282793045043945
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.369004726409912
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2647321224212646
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.987668514251709
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4478225708007812
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5785930156707764
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.3352627754211426
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.0194358825683594
Epoch: 31, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.93762469291687
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1216453
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.072665691375732
Epoch: 1, Steps: 17 | Train Loss: 2.274 Vali Loss: 2.129 Vali Acc: 0.186 Test Loss: 2.129 Test Acc: 0.186
Validation loss decreased (inf --> -0.186465).  Saving model ...
Epoch: 2 cost time: 2.7351303100585938
Epoch: 2, Steps: 17 | Train Loss: 2.142 Vali Loss: 1.887 Vali Acc: 0.586 Test Loss: 1.887 Test Acc: 0.586
Validation loss decreased (-0.186465 --> -0.586468).  Saving model ...
Epoch: 3 cost time: 2.97186541557312
Epoch: 3, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.533 Vali Acc: 0.600 Test Loss: 1.533 Test Acc: 0.600
Validation loss decreased (-0.586468 --> -0.599985).  Saving model ...
Epoch: 4 cost time: 2.771610975265503
Epoch: 4, Steps: 17 | Train Loss: 1.261 Vali Loss: 0.903 Vali Acc: 0.851 Test Loss: 0.903 Test Acc: 0.851
Validation loss decreased (-0.599985 --> -0.851342).  Saving model ...
Epoch: 5 cost time: 2.9069268703460693
Epoch: 5, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
Validation loss decreased (-0.851342 --> -0.878372).  Saving model ...
Epoch: 6 cost time: 2.651794672012329
Epoch: 6, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.429 Vali Acc: 0.914 Test Loss: 0.429 Test Acc: 0.914
Validation loss decreased (-0.878372 --> -0.913509).  Saving model ...
Epoch: 7 cost time: 2.8002233505249023
Epoch: 7, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.913509 --> -0.940538).  Saving model ...
Epoch: 8 cost time: 3.181330442428589
Epoch: 8, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.728956460952759
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.940538 --> -0.959457).  Saving model ...
Epoch: 10 cost time: 2.7034401893615723
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.966196298599243
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8561995029449463
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 2.615525484085083
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.802168846130371
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.166 Vali Acc: 0.938 Test Loss: 0.166 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0813374519348145
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7550313472747803
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.726241111755371
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5147244930267334
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9009642601013184
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.691946029663086
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8278799057006836
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7349741458892822
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1216005
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.402460813522339
Epoch: 1, Steps: 17 | Train Loss: 2.273 Vali Loss: 2.170 Vali Acc: 0.111 Test Loss: 2.170 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 2.5822200775146484
Epoch: 2, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.067 Vali Acc: 0.186 Test Loss: 2.067 Test Acc: 0.186
Validation loss decreased (-0.110789 --> -0.186466).  Saving model ...
Epoch: 3 cost time: 2.718276023864746
Epoch: 3, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.657 Vali Acc: 0.605 Test Loss: 1.657 Test Acc: 0.605
Validation loss decreased (-0.186466 --> -0.605389).  Saving model ...
Epoch: 4 cost time: 2.8174173831939697
Epoch: 4, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.056 Vali Acc: 0.827 Test Loss: 1.056 Test Acc: 0.827
Validation loss decreased (-0.605389 --> -0.827016).  Saving model ...
Epoch: 5 cost time: 2.635206699371338
Epoch: 5, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.627 Vali Acc: 0.903 Test Loss: 0.627 Test Acc: 0.903
Validation loss decreased (-0.827016 --> -0.902696).  Saving model ...
Epoch: 6 cost time: 2.7798731327056885
Epoch: 6, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.416 Vali Acc: 0.908 Test Loss: 0.416 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908104).  Saving model ...
Epoch: 7 cost time: 3.018012762069702
Epoch: 7, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.283 Vali Acc: 0.935 Test Loss: 0.283 Test Acc: 0.935
Validation loss decreased (-0.908104 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 2.595078229904175
Epoch: 8, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8195931911468506
Epoch: 9, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.935132 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 2.46077823638916
Epoch: 10, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6150944232940674
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.363621711730957
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5620040893554688
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 3.03139066696167
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.046849012374878
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 2.804600238800049
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 3.0570895671844482
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 2.9038612842559814
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7944869995117188
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.943 Test Loss: 0.121 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.624992609024048
Epoch: 20, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.150493860244751
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.1937029361724854
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4506170749664307
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.811049699783325
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6119844913482666
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8459811210632324
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9195353984832764
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1215557
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.442002773284912
Epoch: 1, Steps: 17 | Train Loss: 2.348 Vali Loss: 2.119 Vali Acc: 0.168 Test Loss: 2.119 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 3.9465723037719727
Epoch: 2, Steps: 17 | Train Loss: 2.148 Vali Loss: 1.948 Vali Acc: 0.451 Test Loss: 1.948 Test Acc: 0.451
Validation loss decreased (-0.167546 --> -0.451332).  Saving model ...
Epoch: 3 cost time: 2.8912014961242676
Epoch: 3, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.550 Vali Acc: 0.722 Test Loss: 1.550 Test Acc: 0.722
Validation loss decreased (-0.451332 --> -0.721606).  Saving model ...
Epoch: 4 cost time: 3.2781946659088135
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.074 Vali Acc: 0.781 Test Loss: 1.074 Test Acc: 0.781
Validation loss decreased (-0.721606 --> -0.781070).  Saving model ...
Epoch: 5 cost time: 2.8960254192352295
Epoch: 5, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.651 Vali Acc: 0.870 Test Loss: 0.651 Test Acc: 0.870
Validation loss decreased (-0.781070 --> -0.870264).  Saving model ...
Epoch: 6 cost time: 2.846409320831299
Epoch: 6, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.421 Vali Acc: 0.908 Test Loss: 0.421 Test Acc: 0.908
Validation loss decreased (-0.870264 --> -0.908104).  Saving model ...
Epoch: 7 cost time: 2.9175872802734375
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.296 Vali Acc: 0.938 Test Loss: 0.296 Test Acc: 0.938
Validation loss decreased (-0.908104 --> -0.937835).  Saving model ...
Epoch: 8 cost time: 3.543217658996582
Epoch: 8, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.254 Vali Acc: 0.938 Test Loss: 0.254 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 3.0971992015838623
Epoch: 9, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 2.8227100372314453
Epoch: 10, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8900394439697266
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
Validation loss decreased (-0.943241 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 2.9846301078796387
Epoch: 12, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6321678161621094
Epoch: 13, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.089944839477539
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.031987190246582
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8965468406677246
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.209 Vali Acc: 0.924 Test Loss: 0.209 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.232694625854492
Epoch: 17, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.6850361824035645
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3178117275238037
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.253873348236084
Epoch: 20, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.121 Vali Acc: 0.949 Test Loss: 0.121 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1272668838500977
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8034231662750244
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.27073335647583
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.943 Test Loss: 0.138 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.065460681915283
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 3.1738955974578857
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9215240478515625
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9235100746154785
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5393059253692627
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.7441048622131348
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6646692752838135
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.1403656005859375
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.7228353023529053
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.65927791595459
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.605372190475464
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 2.570211410522461
Epoch: 35, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.937237501144409
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.438239574432373
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.920606851577759
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.5062460899353027
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.790605306625366
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.747689962387085
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.9406487941741943
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.954 Test Loss: 0.104 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.110151529312134
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.3916945457458496
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 919685
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.1712751388549805
Epoch: 1, Steps: 17 | Train Loss: 2.299 Vali Loss: 2.167 Vali Acc: 0.173 Test Loss: 2.167 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 3.2160494327545166
Epoch: 2, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.030 Vali Acc: 0.278 Test Loss: 2.030 Test Acc: 0.278
Validation loss decreased (-0.172951 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 2.7266478538513184
Epoch: 3, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.777 Vali Acc: 0.486 Test Loss: 1.777 Test Acc: 0.486
Validation loss decreased (-0.278358 --> -0.486469).  Saving model ...
Epoch: 4 cost time: 3.754768133163452
Epoch: 4, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.134 Vali Acc: 0.800 Test Loss: 1.134 Test Acc: 0.800
Validation loss decreased (-0.486469 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 3.2046217918395996
Epoch: 5, Steps: 17 | Train Loss: 0.969 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
Validation loss decreased (-0.799989 --> -0.889182).  Saving model ...
Epoch: 6 cost time: 2.980430841445923
Epoch: 6, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.483 Vali Acc: 0.908 Test Loss: 0.483 Test Acc: 0.908
Validation loss decreased (-0.889182 --> -0.908103).  Saving model ...
Epoch: 7 cost time: 2.8340442180633545
Epoch: 7, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.338 Vali Acc: 0.922 Test Loss: 0.338 Test Acc: 0.922
Validation loss decreased (-0.908103 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 3.428723096847534
Epoch: 8, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
Validation loss decreased (-0.921618 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 3.2607791423797607
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 3.3528077602386475
Epoch: 10, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5633981227874756
Epoch: 11, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.256 Vali Acc: 0.916 Test Loss: 0.256 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7181317806243896
Epoch: 12, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.943241 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 2.7428932189941406
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.512887954711914
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.182 Vali Acc: 0.932 Test Loss: 0.182 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.215949296951294
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5449230670928955
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5506064891815186
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2954061031341553
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.284992218017578
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 3.5129902362823486
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.158121109008789
Epoch: 21, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3314969539642334
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2953455448150635
Epoch: 23, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.71160626411438
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.927 Test Loss: 0.163 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.5476768016815186
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 26 cost time: 2.8657100200653076
Epoch: 26, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.183544158935547
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2269527912139893
Epoch: 28, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.935 Test Loss: 0.160 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.159029722213745
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.927 Test Loss: 0.171 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9249212741851807
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.9743824005126953
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.89988112449646
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.2077383995056152
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.8704676628112793
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.941 Test Loss: 0.120 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.187838315963745
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 36 cost time: 3.219754934310913
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2058990001678467
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.946 Test Loss: 0.122 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.209944009780884
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3852548599243164
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.943 Test Loss: 0.117 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.7668886184692383
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.6833713054656982
Epoch: 41, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.951 Test Loss: 0.107 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.182802438735962
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.972914934158325
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.951 Test Loss: 0.103 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.169539451599121
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.0362308025360107
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 919237
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.003214597702026
Epoch: 1, Steps: 17 | Train Loss: 2.303 Vali Loss: 2.193 Vali Acc: 0.124 Test Loss: 2.193 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 3.0111379623413086
Epoch: 2, Steps: 17 | Train Loss: 2.152 Vali Loss: 2.015 Vali Acc: 0.359 Test Loss: 2.015 Test Acc: 0.359
Validation loss decreased (-0.124302 --> -0.359439).  Saving model ...
Epoch: 3 cost time: 2.8234939575195312
Epoch: 3, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.661 Vali Acc: 0.695 Test Loss: 1.661 Test Acc: 0.695
Validation loss decreased (-0.359439 --> -0.694578).  Saving model ...
Epoch: 4 cost time: 2.420870542526245
Epoch: 4, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.160 Vali Acc: 0.765 Test Loss: 1.160 Test Acc: 0.765
Validation loss decreased (-0.694578 --> -0.764853).  Saving model ...
Epoch: 5 cost time: 3.0825743675231934
Epoch: 5, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.689 Vali Acc: 0.897 Test Loss: 0.689 Test Acc: 0.897
Validation loss decreased (-0.764853 --> -0.897290).  Saving model ...
Epoch: 6 cost time: 2.3787055015563965
Epoch: 6, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.487 Vali Acc: 0.895 Test Loss: 0.487 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7384424209594727
Epoch: 7, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.316 Vali Acc: 0.916 Test Loss: 0.316 Test Acc: 0.916
Validation loss decreased (-0.897290 --> -0.916213).  Saving model ...
Epoch: 8 cost time: 2.6244711875915527
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 2.576840400695801
Epoch: 9, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.918916 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 2.7764699459075928
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.238 Vali Acc: 0.927 Test Loss: 0.238 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3461523056030273
Epoch: 11, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 2.804611921310425
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1456217765808105
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.184 Vali Acc: 0.927 Test Loss: 0.184 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7675747871398926
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 2.5911529064178467
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.251 Vali Acc: 0.914 Test Loss: 0.251 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.990480899810791
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1485745906829834
Epoch: 17, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 2.878253221511841
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3899056911468506
Epoch: 19, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.421290159225464
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.713064432144165
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.760673999786377
Epoch: 22, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.916 Test Loss: 0.190 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.607506036758423
Epoch: 23, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0386722087860107
Epoch: 24, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.223 Vali Acc: 0.924 Test Loss: 0.223 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3676319122314453
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 26 cost time: 2.9189186096191406
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4201083183288574
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 2.749876022338867
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.182474374771118
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8099539279937744
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.7264955043792725
Epoch: 31, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.6520743370056152
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.804879903793335
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.678286552429199
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.05469012260437
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.7000083923339844
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.5937154293060303
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 918789
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.1847083568573
Epoch: 1, Steps: 17 | Train Loss: 2.364 Vali Loss: 2.151 Vali Acc: 0.284 Test Loss: 2.151 Test Acc: 0.284
Validation loss decreased (inf --> -0.283762).  Saving model ...
Epoch: 2 cost time: 2.8107428550720215
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.041 Vali Acc: 0.373 Test Loss: 2.041 Test Acc: 0.373
Validation loss decreased (-0.283762 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 2.744354009628296
Epoch: 3, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.734 Vali Acc: 0.505 Test Loss: 1.734 Test Acc: 0.505
Validation loss decreased (-0.372953 --> -0.505388).  Saving model ...
Epoch: 4 cost time: 2.437101364135742
Epoch: 4, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.192 Vali Acc: 0.741 Test Loss: 1.192 Test Acc: 0.741
Validation loss decreased (-0.505388 --> -0.740529).  Saving model ...
Epoch: 5 cost time: 2.89670991897583
Epoch: 5, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.752 Vali Acc: 0.851 Test Loss: 0.752 Test Acc: 0.851
Validation loss decreased (-0.740529 --> -0.851344).  Saving model ...
Epoch: 6 cost time: 2.716435432434082
Epoch: 6, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
Validation loss decreased (-0.851344 --> -0.889184).  Saving model ...
Epoch: 7 cost time: 2.8235998153686523
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.322 Vali Acc: 0.932 Test Loss: 0.322 Test Acc: 0.932
Validation loss decreased (-0.889184 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 2.742086887359619
Epoch: 8, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.997317314147949
Epoch: 9, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 3.2360880374908447
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.860966682434082
Epoch: 11, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.357318878173828
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 2.8273236751556396
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 2.927912950515747
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5648465156555176
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 2.7254371643066406
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 2.681642770767212
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.931877374649048
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.894768238067627
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8049769401550293
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6456642150878906
Epoch: 21, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 2.884504556655884
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.047563314437866
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 2.6578078269958496
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7333290576934814
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0887343883514404
Epoch: 26, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9141128063201904
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3256258964538574
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9860308170318604
Epoch: 29, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.935 Test Loss: 0.151 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.67992901802063
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 2.702577829360962
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.5588040351867676
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.108051300048828
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3114066123962402
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.856532096862793
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.96492862701416
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.1519405841827393
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.8304355144500732
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 2.5836198329925537
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2654147148132324
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.7242462635040283
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.341661214828491
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.8452796936035156
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.002709150314331
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.054201364517212
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.9897453784942627
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.689222574234009
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.8476450443267822
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 918341
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.888775587081909
Epoch: 1, Steps: 17 | Train Loss: 2.386 Vali Loss: 2.149 Vali Acc: 0.130 Test Loss: 2.149 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 2.5191285610198975
Epoch: 2, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.021 Vali Acc: 0.384 Test Loss: 2.021 Test Acc: 0.384
Validation loss decreased (-0.129708 --> -0.383764).  Saving model ...
Epoch: 3 cost time: 2.632667064666748
Epoch: 3, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.694 Vali Acc: 0.668 Test Loss: 1.694 Test Acc: 0.668
Validation loss decreased (-0.383764 --> -0.667551).  Saving model ...
Epoch: 4 cost time: 2.432847499847412
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.116 Vali Acc: 0.792 Test Loss: 1.116 Test Acc: 0.792
Validation loss decreased (-0.667551 --> -0.791881).  Saving model ...
Epoch: 5 cost time: 2.9509990215301514
Epoch: 5, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.685 Vali Acc: 0.878 Test Loss: 0.685 Test Acc: 0.878
Validation loss decreased (-0.791881 --> -0.878372).  Saving model ...
Epoch: 6 cost time: 2.5821101665496826
Epoch: 6, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.438 Vali Acc: 0.916 Test Loss: 0.438 Test Acc: 0.916
Validation loss decreased (-0.878372 --> -0.916212).  Saving model ...
Epoch: 7 cost time: 2.7106122970581055
Epoch: 7, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918916).  Saving model ...
Epoch: 8 cost time: 2.8980908393859863
Epoch: 8, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.294 Vali Acc: 0.924 Test Loss: 0.294 Test Acc: 0.924
Validation loss decreased (-0.918916 --> -0.924321).  Saving model ...
Epoch: 9 cost time: 2.4129021167755127
Epoch: 9, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
Validation loss decreased (-0.924321 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 2.578435182571411
Epoch: 10, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.287 Vali Acc: 0.914 Test Loss: 0.287 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.305957555770874
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6147167682647705
Epoch: 12, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.767409086227417
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.531850814819336
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 2.859846353530884
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.785684585571289
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 2.693932294845581
Epoch: 17, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.7244532108306885
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.199 Vali Acc: 0.924 Test Loss: 0.199 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.550368070602417
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 2.418367862701416
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0643303394317627
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.964864 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 2.6588850021362305
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6680057048797607
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8428843021392822
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6959807872772217
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2714192867279053
Epoch: 26, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.954 Test Loss: 0.118 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2782931327819824
Epoch: 27, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.932 Test Loss: 0.164 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.8855953216552734
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.6450538635253906
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.273 Vali Acc: 0.897 Test Loss: 0.273 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.221343994140625
Epoch: 30, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.530428409576416
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 771077
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.097883701324463
Epoch: 1, Steps: 17 | Train Loss: 2.304 Vali Loss: 2.178 Vali Acc: 0.168 Test Loss: 2.178 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 2.637826442718506
Epoch: 2, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.063 Vali Acc: 0.189 Test Loss: 2.063 Test Acc: 0.189
Validation loss decreased (-0.167546 --> -0.189169).  Saving model ...
Epoch: 3 cost time: 3.0821940898895264
Epoch: 3, Steps: 17 | Train Loss: 2.046 Vali Loss: 1.877 Vali Acc: 0.457 Test Loss: 1.877 Test Acc: 0.457
Validation loss decreased (-0.189169 --> -0.456738).  Saving model ...
Epoch: 4 cost time: 3.0333189964294434
Epoch: 4, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.399 Vali Acc: 0.722 Test Loss: 1.399 Test Acc: 0.722
Validation loss decreased (-0.456738 --> -0.721608).  Saving model ...
Epoch: 5 cost time: 3.145505666732788
Epoch: 5, Steps: 17 | Train Loss: 1.180 Vali Loss: 0.906 Vali Acc: 0.838 Test Loss: 0.906 Test Acc: 0.838
Validation loss decreased (-0.721608 --> -0.837829).  Saving model ...
Epoch: 6 cost time: 2.808558225631714
Epoch: 6, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.594 Vali Acc: 0.873 Test Loss: 0.594 Test Acc: 0.873
Validation loss decreased (-0.837829 --> -0.872967).  Saving model ...
Epoch: 7 cost time: 3.525838851928711
Epoch: 7, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.427 Vali Acc: 0.908 Test Loss: 0.427 Test Acc: 0.908
Validation loss decreased (-0.872967 --> -0.908104).  Saving model ...
Epoch: 8 cost time: 3.609100103378296
Epoch: 8, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
Validation loss decreased (-0.908104 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 2.965038299560547
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
Validation loss decreased (-0.918916 --> -0.937835).  Saving model ...
Epoch: 10 cost time: 3.5008440017700195
Epoch: 10, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 3.239288806915283
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 3.066498279571533
Epoch: 12, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.255 Vali Acc: 0.905 Test Loss: 0.255 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9196927547454834
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 3.847339630126953
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.215 Vali Acc: 0.932 Test Loss: 0.215 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0977346897125244
Epoch: 15, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 2.939610004425049
Epoch: 16, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.5194344520568848
Epoch: 17, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 3.3732352256774902
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5884809494018555
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.529510736465454
Epoch: 20, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.022801399230957
Epoch: 21, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 2.5919911861419678
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.787097215652466
Epoch: 23, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.81554913520813
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8313848972320557
Epoch: 25, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2713048458099365
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0324320793151855
Epoch: 27, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9808402061462402
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.7390224933624268
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6902759075164795
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.902914047241211
Epoch: 31, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 770629
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.5869646072387695
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 2.161 Vali Acc: 0.197 Test Loss: 2.161 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 2.7799203395843506
Epoch: 2, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.057 Vali Acc: 0.397 Test Loss: 2.057 Test Acc: 0.397
Validation loss decreased (-0.197276 --> -0.397277).  Saving model ...
Epoch: 3 cost time: 2.942188024520874
Epoch: 3, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.769 Vali Acc: 0.730 Test Loss: 1.769 Test Acc: 0.730
Validation loss decreased (-0.397277 --> -0.729712).  Saving model ...
Epoch: 4 cost time: 3.039726972579956
Epoch: 4, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.233 Vali Acc: 0.781 Test Loss: 1.233 Test Acc: 0.781
Validation loss decreased (-0.729712 --> -0.781069).  Saving model ...
Epoch: 5 cost time: 2.7048215866088867
Epoch: 5, Steps: 17 | Train Loss: 1.013 Vali Loss: 0.761 Vali Acc: 0.873 Test Loss: 0.761 Test Acc: 0.873
Validation loss decreased (-0.781069 --> -0.872965).  Saving model ...
Epoch: 6 cost time: 2.704540729522705
Epoch: 6, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.524 Vali Acc: 0.903 Test Loss: 0.524 Test Acc: 0.903
Validation loss decreased (-0.872965 --> -0.902697).  Saving model ...
Epoch: 7 cost time: 3.0600669384002686
Epoch: 7, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.336 Vali Acc: 0.946 Test Loss: 0.336 Test Acc: 0.946
Validation loss decreased (-0.902697 --> -0.945943).  Saving model ...
Epoch: 8 cost time: 3.4078445434570312
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.807210922241211
Epoch: 9, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.248 Vali Acc: 0.938 Test Loss: 0.248 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.293337345123291
Epoch: 10, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8789494037628174
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 2.7548115253448486
Epoch: 12, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.987252950668335
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 3.1370201110839844
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.08992075920105
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5453410148620605
Epoch: 16, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 3.0281753540039062
Epoch: 17, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.111060619354248
Epoch: 18, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1727144718170166
Epoch: 19, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.938 Test Loss: 0.141 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.791581153869629
Epoch: 20, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.988982915878296
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9768829345703125
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 3.223040819168091
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.946 Test Loss: 0.117 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.808074474334717
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8957462310791016
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1015641689300537
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.949 Test Loss: 0.120 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3979265689849854
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 28 cost time: 2.5403547286987305
Epoch: 28, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.885659694671631
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.946 Test Loss: 0.118 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.195643424987793
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2740249633789062
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.932 Test Loss: 0.154 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.876905918121338
Epoch: 32, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.830739736557007
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.811591386795044
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.957 Test Loss: 0.096 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.7037510871887207
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.455878257751465
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.0989575386047363
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 770181
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.399776458740234
Epoch: 1, Steps: 17 | Train Loss: 2.310 Vali Loss: 2.197 Vali Acc: 0.211 Test Loss: 2.197 Test Acc: 0.211
Validation loss decreased (inf --> -0.210789).  Saving model ...
Epoch: 2 cost time: 2.473339080810547
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.048 Vali Acc: 0.319 Test Loss: 2.048 Test Acc: 0.319
Validation loss decreased (-0.210789 --> -0.318898).  Saving model ...
Epoch: 3 cost time: 2.4720840454101562
Epoch: 3, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.747 Vali Acc: 0.684 Test Loss: 1.747 Test Acc: 0.684
Validation loss decreased (-0.318898 --> -0.683766).  Saving model ...
Epoch: 4 cost time: 2.4255518913269043
Epoch: 4, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.205 Vali Acc: 0.857 Test Loss: 1.205 Test Acc: 0.857
Validation loss decreased (-0.683766 --> -0.856745).  Saving model ...
Epoch: 5 cost time: 2.5098557472229004
Epoch: 5, Steps: 17 | Train Loss: 1.021 Vali Loss: 0.767 Vali Acc: 0.886 Test Loss: 0.767 Test Acc: 0.886
Validation loss decreased (-0.856745 --> -0.886479).  Saving model ...
Epoch: 6 cost time: 2.255359172821045
Epoch: 6, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.475 Vali Acc: 0.911 Test Loss: 0.475 Test Acc: 0.911
Validation loss decreased (-0.886479 --> -0.910806).  Saving model ...
Epoch: 7 cost time: 2.575237274169922
Epoch: 7, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.332 Vali Acc: 0.943 Test Loss: 0.332 Test Acc: 0.943
Validation loss decreased (-0.910806 --> -0.943240).  Saving model ...
Epoch: 8 cost time: 2.574181079864502
Epoch: 8, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.295731544494629
Epoch: 9, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2650656700134277
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 2.4964075088500977
Epoch: 11, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1413726806640625
Epoch: 12, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4398155212402344
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4794769287109375
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4229743480682373
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.185 Vali Acc: 0.924 Test Loss: 0.185 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2191531658172607
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.643200159072876
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3482823371887207
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 2.3731772899627686
Epoch: 19, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.599069118499756
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.943 Test Loss: 0.141 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2802584171295166
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5517866611480713
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4717319011688232
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.200 Vali Acc: 0.924 Test Loss: 0.200 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8824336528778076
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967567).  Saving model ...
Epoch: 25 cost time: 2.827920436859131
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0236806869506836
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7386343479156494
Epoch: 27, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5525119304656982
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.28406023979187
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.3320746421813965
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.264176607131958
Epoch: 31, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.6135313510894775
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.542949676513672
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.48832106590271
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 769733
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.0787670612335205
Epoch: 1, Steps: 17 | Train Loss: 2.277 Vali Loss: 2.178 Vali Acc: 0.135 Test Loss: 2.178 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 2.7831060886383057
Epoch: 2, Steps: 17 | Train Loss: 2.142 Vali Loss: 2.003 Vali Acc: 0.316 Test Loss: 2.003 Test Acc: 0.316
Validation loss decreased (-0.135113 --> -0.316196).  Saving model ...
Epoch: 3 cost time: 2.4080190658569336
Epoch: 3, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.663 Vali Acc: 0.600 Test Loss: 1.663 Test Acc: 0.600
Validation loss decreased (-0.316196 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 2.5478129386901855
Epoch: 4, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.302 Vali Acc: 0.759 Test Loss: 1.302 Test Acc: 0.759
Validation loss decreased (-0.599983 --> -0.759446).  Saving model ...
Epoch: 5 cost time: 2.5423941612243652
Epoch: 5, Steps: 17 | Train Loss: 1.173 Vali Loss: 0.991 Vali Acc: 0.870 Test Loss: 0.991 Test Acc: 0.870
Validation loss decreased (-0.759446 --> -0.870260).  Saving model ...
Epoch: 6 cost time: 2.7353038787841797
Epoch: 6, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.798 Vali Acc: 0.878 Test Loss: 0.798 Test Acc: 0.878
Validation loss decreased (-0.870260 --> -0.878370).  Saving model ...
Epoch: 7 cost time: 2.685197591781616
Epoch: 7, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.595 Vali Acc: 0.916 Test Loss: 0.595 Test Acc: 0.916
Validation loss decreased (-0.878370 --> -0.916210).  Saving model ...
Epoch: 8 cost time: 2.873624324798584
Epoch: 8, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.916210 --> -0.921617).  Saving model ...
Epoch: 9 cost time: 2.6244795322418213
Epoch: 9, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.379 Vali Acc: 0.935 Test Loss: 0.379 Test Acc: 0.935
Validation loss decreased (-0.921617 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 2.9427032470703125
Epoch: 10, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.327 Vali Acc: 0.938 Test Loss: 0.327 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 11 cost time: 3.015385627746582
Epoch: 11, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 12 cost time: 2.4438579082489014
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.267 Vali Acc: 0.938 Test Loss: 0.267 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 2.540060520172119
Epoch: 13, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.262 Vali Acc: 0.924 Test Loss: 0.262 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.806647777557373
Epoch: 14, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 2.923786163330078
Epoch: 15, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.540853261947632
Epoch: 16, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.937836 --> -0.959457).  Saving model ...
Epoch: 17 cost time: 2.2437679767608643
Epoch: 17, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.7302520275115967
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.645101547241211
Epoch: 19, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3997931480407715
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 2.527858257293701
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5143299102783203
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5717742443084717
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5859742164611816
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.087815761566162
Epoch: 25, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.066141128540039
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.8750884532928467
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.8120276927948
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6865074634552
Epoch: 29, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.089017629623413
Epoch: 30, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 762853
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.690887212753296
Epoch: 1, Steps: 17 | Train Loss: 2.293 Vali Loss: 2.188 Vali Acc: 0.135 Test Loss: 2.188 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 2.4684736728668213
Epoch: 2, Steps: 17 | Train Loss: 2.146 Vali Loss: 1.993 Vali Acc: 0.400 Test Loss: 1.993 Test Acc: 0.400
Validation loss decreased (-0.135113 --> -0.399980).  Saving model ...
Epoch: 3 cost time: 3.0777714252471924
Epoch: 3, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.613 Vali Acc: 0.654 Test Loss: 1.613 Test Acc: 0.654
Validation loss decreased (-0.399980 --> -0.654038).  Saving model ...
Epoch: 4 cost time: 2.546696424484253
Epoch: 4, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.282 Vali Acc: 0.778 Test Loss: 1.282 Test Acc: 0.778
Validation loss decreased (-0.654038 --> -0.778366).  Saving model ...
Epoch: 5 cost time: 2.359835624694824
Epoch: 5, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.001 Vali Acc: 0.822 Test Loss: 1.001 Test Acc: 0.822
Validation loss decreased (-0.778366 --> -0.821612).  Saving model ...
Epoch: 6 cost time: 2.347182035446167
Epoch: 6, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.716 Vali Acc: 0.876 Test Loss: 0.716 Test Acc: 0.876
Validation loss decreased (-0.821612 --> -0.875669).  Saving model ...
Epoch: 7 cost time: 2.5310637950897217
Epoch: 7, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.612 Vali Acc: 0.895 Test Loss: 0.612 Test Acc: 0.895
Validation loss decreased (-0.875669 --> -0.894588).  Saving model ...
Epoch: 8 cost time: 2.446017026901245
Epoch: 8, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.894588 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 2.5896313190460205
Epoch: 9, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.391 Vali Acc: 0.935 Test Loss: 0.391 Test Acc: 0.935
Validation loss decreased (-0.899995 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 2.521064043045044
Epoch: 10, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.346 Vali Acc: 0.924 Test Loss: 0.346 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8151679039001465
Epoch: 11, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5158417224884033
Epoch: 12, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.290 Vali Acc: 0.924 Test Loss: 0.290 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0642659664154053
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7892487049102783
Epoch: 14, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.247 Vali Acc: 0.927 Test Loss: 0.247 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.746629238128662
Epoch: 15, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.935131 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 3.5438148975372314
Epoch: 16, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.247166395187378
Epoch: 17, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 2.9786264896392822
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.83029842376709
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.239978313446045
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9463562965393066
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4136929512023926
Epoch: 22, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8065357208251953
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.59671950340271
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8872365951538086
Epoch: 25, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.860522508621216
Epoch: 26, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.449540615081787
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 28 cost time: 2.6181204319000244
Epoch: 28, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7139768600463867
Epoch: 29, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.521263837814331
Epoch: 30, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.938 Test Loss: 0.157 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.9670097827911377
Epoch: 31, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.7432548999786377
Epoch: 32, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.7362585067749023
Epoch: 33, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.924 Test Loss: 0.202 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.663198709487915
Epoch: 34, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 2.8514630794525146
Epoch: 35, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.6569833755493164
Epoch: 36, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.938 Test Loss: 0.145 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4281234741210938
Epoch: 37, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.9375479221343994
Epoch: 38, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 39 cost time: 2.6684091091156006
Epoch: 39, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.717247724533081
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.503814935684204
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.953908920288086
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.6490204334259033
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.8118815422058105
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.894695281982422
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 46 cost time: 3.345228910446167
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.693769931793213
Epoch: 47, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.9038004875183105
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.0055971145629883
Epoch: 49, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.721907615661621
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.491364002227783
Epoch: 51, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.3258471488952637
Epoch: 52, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.430659055709839
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.8219759464263916
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.943 Test Loss: 0.137 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.98106050491333
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 2.8851895332336426
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.8305270671844482
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.572575330734253
Epoch: 58, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.5401439666748047
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.358550786972046
Epoch: 60, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.965329170227051
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.250370502471924
Epoch: 62, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.8877933025360107
Epoch: 63, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.1382548809051514
Epoch: 64, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.779784679412842
Epoch: 65, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 762629
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.6540257930755615
Epoch: 1, Steps: 17 | Train Loss: 2.305 Vali Loss: 2.183 Vali Acc: 0.122 Test Loss: 2.183 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 2.648729085922241
Epoch: 2, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.113 Vali Acc: 0.292 Test Loss: 2.113 Test Acc: 0.292
Validation loss decreased (-0.121600 --> -0.291871).  Saving model ...
Epoch: 3 cost time: 2.9895057678222656
Epoch: 3, Steps: 17 | Train Loss: 2.067 Vali Loss: 1.850 Vali Acc: 0.562 Test Loss: 1.850 Test Acc: 0.562
Validation loss decreased (-0.291871 --> -0.562144).  Saving model ...
Epoch: 4 cost time: 2.8259005546569824
Epoch: 4, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.527 Vali Acc: 0.608 Test Loss: 1.527 Test Acc: 0.608
Validation loss decreased (-0.562144 --> -0.608093).  Saving model ...
Epoch: 5 cost time: 2.731602668762207
Epoch: 5, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.126 Vali Acc: 0.784 Test Loss: 1.126 Test Acc: 0.784
Validation loss decreased (-0.608093 --> -0.783773).  Saving model ...
Epoch: 6 cost time: 2.925766944885254
Epoch: 6, Steps: 17 | Train Loss: 1.038 Vali Loss: 0.934 Vali Acc: 0.835 Test Loss: 0.934 Test Acc: 0.835
Validation loss decreased (-0.783773 --> -0.835126).  Saving model ...
Epoch: 7 cost time: 2.9228157997131348
Epoch: 7, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.668 Vali Acc: 0.892 Test Loss: 0.668 Test Acc: 0.892
Validation loss decreased (-0.835126 --> -0.891885).  Saving model ...
Epoch: 8 cost time: 2.6171653270721436
Epoch: 8, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.563 Vali Acc: 0.876 Test Loss: 0.563 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7627739906311035
Epoch: 9, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.430 Vali Acc: 0.916 Test Loss: 0.430 Test Acc: 0.916
Validation loss decreased (-0.891885 --> -0.916212).  Saving model ...
Epoch: 10 cost time: 2.5818824768066406
Epoch: 10, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.386 Vali Acc: 0.908 Test Loss: 0.386 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0504581928253174
Epoch: 11, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.348 Vali Acc: 0.908 Test Loss: 0.348 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.958226442337036
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.916212 --> -0.929727).  Saving model ...
Epoch: 13 cost time: 2.675244092941284
Epoch: 13, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 3.0147438049316406
Epoch: 14, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.244 Vali Acc: 0.924 Test Loss: 0.244 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.792113780975342
Epoch: 15, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.885485887527466
Epoch: 16, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 3.1145284175872803
Epoch: 17, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.681300401687622
Epoch: 18, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.825988292694092
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.866957187652588
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5859336853027344
Epoch: 21, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.209 Vali Acc: 0.924 Test Loss: 0.209 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4793124198913574
Epoch: 22, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 2.708369016647339
Epoch: 23, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.226 Vali Acc: 0.924 Test Loss: 0.226 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5902011394500732
Epoch: 24, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.296 Vali Acc: 0.881 Test Loss: 0.296 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.960686683654785
Epoch: 25, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 2.401292085647583
Epoch: 26, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0201356410980225
Epoch: 27, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 28 cost time: 2.835484504699707
Epoch: 28, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.583390951156616
Epoch: 29, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 30 cost time: 2.9434010982513428
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.481389045715332
Epoch: 31, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.924 Test Loss: 0.196 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.528184413909912
Epoch: 32, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.8824703693389893
Epoch: 33, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 2.882465124130249
Epoch: 34, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8828580379486084
Epoch: 35, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 2.836578607559204
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.965965986251831
Epoch: 37, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.4607505798339844
Epoch: 38, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.3980913162231445
Epoch: 39, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.6666650772094727
Epoch: 40, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.4180397987365723
Epoch: 41, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.6733014583587646
Epoch: 42, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.4519636631011963
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.6305289268493652
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.736436128616333
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 46 cost time: 2.4299628734588623
Epoch: 46, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.8905653953552246
Epoch: 47, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.4659717082977295
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.6391587257385254
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.4554033279418945
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.3432345390319824
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.4698235988616943
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.374274253845215
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.6856846809387207
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.503366708755493
Epoch: 55, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.946 Test Loss: 0.138 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 762405
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.447408199310303
Epoch: 1, Steps: 17 | Train Loss: 2.255 Vali Loss: 2.148 Vali Acc: 0.181 Test Loss: 2.148 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 2.58908748626709
Epoch: 2, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.020 Vali Acc: 0.346 Test Loss: 2.020 Test Acc: 0.346
Validation loss decreased (-0.181060 --> -0.345926).  Saving model ...
Epoch: 3 cost time: 2.8958959579467773
Epoch: 3, Steps: 17 | Train Loss: 1.956 Vali Loss: 1.700 Vali Acc: 0.668 Test Loss: 1.700 Test Acc: 0.668
Validation loss decreased (-0.345926 --> -0.667551).  Saving model ...
Epoch: 4 cost time: 2.4492087364196777
Epoch: 4, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.317 Vali Acc: 0.822 Test Loss: 1.317 Test Acc: 0.822
Validation loss decreased (-0.667551 --> -0.821608).  Saving model ...
Epoch: 5 cost time: 2.671881675720215
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.002 Vali Acc: 0.827 Test Loss: 1.002 Test Acc: 0.827
Validation loss decreased (-0.821608 --> -0.827017).  Saving model ...
Epoch: 6 cost time: 2.440452814102173
Epoch: 6, Steps: 17 | Train Loss: 0.912 Vali Loss: 0.704 Vali Acc: 0.897 Test Loss: 0.704 Test Acc: 0.897
Validation loss decreased (-0.827017 --> -0.897290).  Saving model ...
Epoch: 7 cost time: 2.5786595344543457
Epoch: 7, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.524 Vali Acc: 0.930 Test Loss: 0.524 Test Acc: 0.930
Validation loss decreased (-0.897290 --> -0.929724).  Saving model ...
Epoch: 8 cost time: 2.8959434032440186
Epoch: 8, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.438 Vali Acc: 0.927 Test Loss: 0.438 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4497504234313965
Epoch: 9, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.353 Vali Acc: 0.935 Test Loss: 0.353 Test Acc: 0.935
Validation loss decreased (-0.929724 --> -0.935132).  Saving model ...
Epoch: 10 cost time: 2.737076997756958
Epoch: 10, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0778839588165283
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2825231552124023
Epoch: 12, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0678157806396484
Epoch: 13, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 14 cost time: 2.9203593730926514
Epoch: 14, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 3.0289292335510254
Epoch: 15, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.470756769180298
Epoch: 16, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 2.99835467338562
Epoch: 17, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.210 Vali Acc: 0.932 Test Loss: 0.210 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9155325889587402
Epoch: 18, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 2.6739113330841064
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.02231502532959
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9869155883789062
Epoch: 21, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.576789379119873
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8707377910614014
Epoch: 23, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3309555053710938
Epoch: 24, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 3.2141740322113037
Epoch: 25, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7320666313171387
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.558948040008545
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 3.4387247562408447
Epoch: 28, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.955753803253174
Epoch: 29, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.062967538833618
Epoch: 30, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.168 Vali Acc: 0.932 Test Loss: 0.168 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.9689533710479736
Epoch: 31, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.127204656600952
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.035264492034912
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.3099873065948486
Epoch: 34, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.186206817626953
Epoch: 35, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.6475882530212402
Epoch: 36, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.8982810974121094
Epoch: 37, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 762181
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.411308765411377
Epoch: 1, Steps: 17 | Train Loss: 2.271 Vali Loss: 2.196 Vali Acc: 0.184 Test Loss: 2.196 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 2.9780282974243164
Epoch: 2, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.122 Vali Acc: 0.230 Test Loss: 2.122 Test Acc: 0.230
Validation loss decreased (-0.183762 --> -0.229709).  Saving model ...
Epoch: 3 cost time: 2.936845541000366
Epoch: 3, Steps: 17 | Train Loss: 2.100 Vali Loss: 1.972 Vali Acc: 0.451 Test Loss: 1.972 Test Acc: 0.451
Validation loss decreased (-0.229709 --> -0.451332).  Saving model ...
Epoch: 4 cost time: 3.3523452281951904
Epoch: 4, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.708 Vali Acc: 0.470 Test Loss: 1.708 Test Acc: 0.470
Validation loss decreased (-0.451332 --> -0.470253).  Saving model ...
Epoch: 5 cost time: 2.7406132221221924
Epoch: 5, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.312 Vali Acc: 0.754 Test Loss: 1.312 Test Acc: 0.754
Validation loss decreased (-0.470253 --> -0.754041).  Saving model ...
Epoch: 6 cost time: 3.3945555686950684
Epoch: 6, Steps: 17 | Train Loss: 1.128 Vali Loss: 0.931 Vali Acc: 0.881 Test Loss: 0.931 Test Acc: 0.881
Validation loss decreased (-0.754041 --> -0.881072).  Saving model ...
Epoch: 7 cost time: 3.0935161113739014
Epoch: 7, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.747 Vali Acc: 0.884 Test Loss: 0.747 Test Acc: 0.884
Validation loss decreased (-0.881072 --> -0.883776).  Saving model ...
Epoch: 8 cost time: 2.7681217193603516
Epoch: 8, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.534 Vali Acc: 0.914 Test Loss: 0.534 Test Acc: 0.914
Validation loss decreased (-0.883776 --> -0.913508).  Saving model ...
Epoch: 9 cost time: 3.2712161540985107
Epoch: 9, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.441 Vali Acc: 0.916 Test Loss: 0.441 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916212).  Saving model ...
Epoch: 10 cost time: 3.3299779891967773
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.356 Vali Acc: 0.932 Test Loss: 0.356 Test Acc: 0.932
Validation loss decreased (-0.916212 --> -0.932429).  Saving model ...
Epoch: 11 cost time: 3.0140836238861084
Epoch: 11, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.326 Vali Acc: 0.927 Test Loss: 0.326 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5683951377868652
Epoch: 12, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.270 Vali Acc: 0.938 Test Loss: 0.270 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 3.5515615940093994
Epoch: 13, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.08772873878479
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 3.1940009593963623
Epoch: 15, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.206815242767334
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.937836 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 3.0268959999084473
Epoch: 17, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.904247283935547
Epoch: 18, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0704541206359863
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 2.9426114559173584
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0372493267059326
Epoch: 21, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.259737968444824
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 23 cost time: 2.5993993282318115
Epoch: 23, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8470489978790283
Epoch: 24, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.877244234085083
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.989147424697876
Epoch: 26, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.175525426864624
Epoch: 27, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.839695453643799
Epoch: 28, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.869093894958496
Epoch: 29, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.8444173336029053
Epoch: 30, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.7381813526153564
Epoch: 31, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.196687936782837
Epoch: 32, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 463333
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.7302210330963135
Epoch: 1, Steps: 17 | Train Loss: 2.382 Vali Loss: 2.187 Vali Acc: 0.054 Test Loss: 2.187 Test Acc: 0.054
Validation loss decreased (inf --> -0.054032).  Saving model ...
Epoch: 2 cost time: 2.605088233947754
Epoch: 2, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.160 Vali Acc: 0.135 Test Loss: 2.160 Test Acc: 0.135
Validation loss decreased (-0.054032 --> -0.135114).  Saving model ...
Epoch: 3 cost time: 2.310145616531372
Epoch: 3, Steps: 17 | Train Loss: 2.134 Vali Loss: 1.995 Vali Acc: 0.397 Test Loss: 1.995 Test Acc: 0.397
Validation loss decreased (-0.135114 --> -0.397277).  Saving model ...
Epoch: 4 cost time: 2.4153451919555664
Epoch: 4, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.665 Vali Acc: 0.716 Test Loss: 1.665 Test Acc: 0.716
Validation loss decreased (-0.397277 --> -0.716200).  Saving model ...
Epoch: 5 cost time: 2.658555269241333
Epoch: 5, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.306 Vali Acc: 0.746 Test Loss: 1.306 Test Acc: 0.746
Validation loss decreased (-0.716200 --> -0.745933).  Saving model ...
Epoch: 6 cost time: 2.7608354091644287
Epoch: 6, Steps: 17 | Train Loss: 1.186 Vali Loss: 0.901 Vali Acc: 0.884 Test Loss: 0.901 Test Acc: 0.884
Validation loss decreased (-0.745933 --> -0.883775).  Saving model ...
Epoch: 7 cost time: 2.438659191131592
Epoch: 7, Steps: 17 | Train Loss: 0.869 Vali Loss: 0.697 Vali Acc: 0.878 Test Loss: 0.697 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4485671520233154
Epoch: 8, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.538 Vali Acc: 0.908 Test Loss: 0.538 Test Acc: 0.908
Validation loss decreased (-0.883775 --> -0.908103).  Saving model ...
Epoch: 9 cost time: 2.4968068599700928
Epoch: 9, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910806).  Saving model ...
Epoch: 10 cost time: 2.506509304046631
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.366 Vali Acc: 0.938 Test Loss: 0.366 Test Acc: 0.938
Validation loss decreased (-0.910806 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 2.4561586380004883
Epoch: 11, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 12 cost time: 2.805824041366577
Epoch: 12, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.255 Vali Acc: 0.949 Test Loss: 0.255 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 3.441990375518799
Epoch: 13, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.224 Vali Acc: 0.962 Test Loss: 0.224 Test Acc: 0.962
Validation loss decreased (-0.948646 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 3.490067958831787
Epoch: 14, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6987595558166504
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 3.629197359085083
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.170667886734009
Epoch: 17, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9559075832366943
Epoch: 18, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.807934045791626
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1699163913726807
Epoch: 20, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7610983848571777
Epoch: 21, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.89998197555542
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.576962947845459
Epoch: 23, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9051613807678223
Epoch: 24, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 2.578552722930908
Epoch: 25, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2379515171051025
Epoch: 26, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2389438152313232
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8646886348724365
Epoch: 28, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2781713008880615
Epoch: 29, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8941516876220703
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.7445430755615234
Epoch: 31, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.321017265319824
Epoch: 32, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4659171104431152
Epoch: 33, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.5647780895233154
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 463109
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.859585285186768
Epoch: 1, Steps: 17 | Train Loss: 2.298 Vali Loss: 2.194 Vali Acc: 0.041 Test Loss: 2.194 Test Acc: 0.041
Validation loss decreased (inf --> -0.040519).  Saving model ...
Epoch: 2 cost time: 2.2151541709899902
Epoch: 2, Steps: 17 | Train Loss: 2.233 Vali Loss: 2.131 Vali Acc: 0.295 Test Loss: 2.131 Test Acc: 0.295
Validation loss decreased (-0.040519 --> -0.294573).  Saving model ...
Epoch: 3 cost time: 2.6418473720550537
Epoch: 3, Steps: 17 | Train Loss: 2.140 Vali Loss: 2.027 Vali Acc: 0.438 Test Loss: 2.027 Test Acc: 0.438
Validation loss decreased (-0.294573 --> -0.437818).  Saving model ...
Epoch: 4 cost time: 2.740652322769165
Epoch: 4, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.701 Vali Acc: 0.614 Test Loss: 1.701 Test Acc: 0.614
Validation loss decreased (-0.437818 --> -0.613497).  Saving model ...
Epoch: 5 cost time: 2.2889862060546875
Epoch: 5, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.277 Vali Acc: 0.759 Test Loss: 1.277 Test Acc: 0.759
Validation loss decreased (-0.613497 --> -0.759447).  Saving model ...
Epoch: 6 cost time: 2.847271203994751
Epoch: 6, Steps: 17 | Train Loss: 1.193 Vali Loss: 0.951 Vali Acc: 0.873 Test Loss: 0.951 Test Acc: 0.873
Validation loss decreased (-0.759447 --> -0.872963).  Saving model ...
Epoch: 7 cost time: 2.442901611328125
Epoch: 7, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.783 Vali Acc: 0.832 Test Loss: 0.783 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.967028856277466
Epoch: 8, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.553 Vali Acc: 0.919 Test Loss: 0.553 Test Acc: 0.919
Validation loss decreased (-0.872963 --> -0.918913).  Saving model ...
Epoch: 9 cost time: 2.6882212162017822
Epoch: 9, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.435 Vali Acc: 0.924 Test Loss: 0.435 Test Acc: 0.924
Validation loss decreased (-0.918913 --> -0.924320).  Saving model ...
Epoch: 10 cost time: 2.8559393882751465
Epoch: 10, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.363 Vali Acc: 0.922 Test Loss: 0.363 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2165818214416504
Epoch: 11, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.319 Vali Acc: 0.935 Test Loss: 0.319 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 2.629936695098877
Epoch: 12, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.286 Vali Acc: 0.949 Test Loss: 0.286 Test Acc: 0.949
Validation loss decreased (-0.935132 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 2.4323766231536865
Epoch: 13, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3146114349365234
Epoch: 14, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6917593479156494
Epoch: 15, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 16 cost time: 2.967818021774292
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6580350399017334
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 2.88002872467041
Epoch: 18, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8153891563415527
Epoch: 19, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 2.5931222438812256
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.210 Vali Acc: 0.932 Test Loss: 0.210 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.544607162475586
Epoch: 21, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.305727958679199
Epoch: 22, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 2.8336195945739746
Epoch: 23, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.204 Vali Acc: 0.932 Test Loss: 0.204 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7481255531311035
Epoch: 24, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 2.6420235633850098
Epoch: 25, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9861366748809814
Epoch: 26, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.937831163406372
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9177117347717285
Epoch: 28, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.550912857055664
Epoch: 29, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.938 Test Loss: 0.155 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.759697437286377
Epoch: 30, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.5381596088409424
Epoch: 31, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 32 cost time: 2.8985655307769775
Epoch: 32, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.941 Test Loss: 0.148 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.107738733291626
Epoch: 33, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4244821071624756
Epoch: 34, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.9981372356414795
Epoch: 35, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.903782606124878
Epoch: 36, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.6060004234313965
Epoch: 37, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.157 Vali Acc: 0.932 Test Loss: 0.157 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.562934637069702
Epoch: 38, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.656918525695801
Epoch: 39, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.8320257663726807
Epoch: 40, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.293860912322998
Epoch: 41, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 462885
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.364075183868408
Epoch: 1, Steps: 17 | Train Loss: 2.332 Vali Loss: 2.217 Vali Acc: 0.168 Test Loss: 2.217 Test Acc: 0.168
Validation loss decreased (inf --> -0.167545).  Saving model ...
Epoch: 2 cost time: 2.9190683364868164
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.120 Vali Acc: 0.222 Test Loss: 2.120 Test Acc: 0.222
Validation loss decreased (-0.167545 --> -0.221600).  Saving model ...
Epoch: 3 cost time: 2.8519561290740967
Epoch: 3, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.973 Vali Acc: 0.416 Test Loss: 1.973 Test Acc: 0.416
Validation loss decreased (-0.221600 --> -0.416196).  Saving model ...
Epoch: 4 cost time: 2.2886338233947754
Epoch: 4, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.715 Vali Acc: 0.546 Test Loss: 1.715 Test Acc: 0.546
Validation loss decreased (-0.416196 --> -0.545929).  Saving model ...
Epoch: 5 cost time: 2.7811996936798096
Epoch: 5, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.350 Vali Acc: 0.781 Test Loss: 1.350 Test Acc: 0.781
Validation loss decreased (-0.545929 --> -0.781068).  Saving model ...
Epoch: 6 cost time: 2.4818708896636963
Epoch: 6, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.030 Vali Acc: 0.843 Test Loss: 1.030 Test Acc: 0.843
Validation loss decreased (-0.781068 --> -0.843233).  Saving model ...
Epoch: 7 cost time: 2.5957834720611572
Epoch: 7, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.785 Vali Acc: 0.900 Test Loss: 0.785 Test Acc: 0.900
Validation loss decreased (-0.843233 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 2.518141031265259
Epoch: 8, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.635 Vali Acc: 0.884 Test Loss: 0.635 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.792917251586914
Epoch: 9, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.458 Vali Acc: 0.932 Test Loss: 0.458 Test Acc: 0.932
Validation loss decreased (-0.899992 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 2.6736185550689697
Epoch: 10, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.401 Vali Acc: 0.930 Test Loss: 0.401 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5522897243499756
Epoch: 11, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.328 Vali Acc: 0.943 Test Loss: 0.328 Test Acc: 0.943
Validation loss decreased (-0.932428 --> -0.943240).  Saving model ...
Epoch: 12 cost time: 2.5521414279937744
Epoch: 12, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.085970163345337
Epoch: 13, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.295 Vali Acc: 0.927 Test Loss: 0.295 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6541800498962402
Epoch: 14, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 2.3246378898620605
Epoch: 15, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0483739376068115
Epoch: 16, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.553156614303589
Epoch: 17, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.059521198272705
Epoch: 18, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9277284145355225
Epoch: 19, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5660712718963623
Epoch: 20, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.653479814529419
Epoch: 21, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 2.766519784927368
Epoch: 22, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.199864625930786
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8296117782592773
Epoch: 24, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 2.774850845336914
Epoch: 25, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 2.6101412773132324
Epoch: 26, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4590024948120117
Epoch: 27, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 2.600644826889038
Epoch: 28, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0078182220458984
Epoch: 29, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.872562885284424
Epoch: 30, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.941 Test Loss: 0.151 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4001290798187256
Epoch: 31, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.177 Vali Acc: 0.932 Test Loss: 0.177 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.9896373748779297
Epoch: 32, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.927 Test Loss: 0.172 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.876793622970581
Epoch: 33, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.674267292022705
Epoch: 34, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.2427732944488525
Epoch: 35, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.8386876583099365
Epoch: 36, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.26926326751709
Epoch: 37, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 462661
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.668577671051025
Epoch: 1, Steps: 17 | Train Loss: 2.317 Vali Loss: 2.182 Vali Acc: 0.189 Test Loss: 2.182 Test Acc: 0.189
Validation loss decreased (inf --> -0.189167).  Saving model ...
Epoch: 2 cost time: 2.692349672317505
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.151 Vali Acc: 0.157 Test Loss: 2.151 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.069401502609253
Epoch: 3, Steps: 17 | Train Loss: 2.126 Vali Loss: 1.978 Vali Acc: 0.414 Test Loss: 1.978 Test Acc: 0.414
Validation loss decreased (-0.189167 --> -0.413494).  Saving model ...
Epoch: 4 cost time: 2.728935718536377
Epoch: 4, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.790 Vali Acc: 0.595 Test Loss: 1.790 Test Acc: 0.595
Validation loss decreased (-0.413494 --> -0.594577).  Saving model ...
Epoch: 5 cost time: 2.583045482635498
Epoch: 5, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.474 Vali Acc: 0.759 Test Loss: 1.474 Test Acc: 0.759
Validation loss decreased (-0.594577 --> -0.759445).  Saving model ...
Epoch: 6 cost time: 3.0181350708007812
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.118 Vali Acc: 0.873 Test Loss: 1.118 Test Acc: 0.873
Validation loss decreased (-0.759445 --> -0.872962).  Saving model ...
Epoch: 7 cost time: 2.7331600189208984
Epoch: 7, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.836 Vali Acc: 0.900 Test Loss: 0.836 Test Acc: 0.900
Validation loss decreased (-0.872962 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 2.411517381668091
Epoch: 8, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.649 Vali Acc: 0.903 Test Loss: 0.649 Test Acc: 0.903
Validation loss decreased (-0.899992 --> -0.902696).  Saving model ...
Epoch: 9 cost time: 3.161761522293091
Epoch: 9, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.489 Vali Acc: 0.922 Test Loss: 0.489 Test Acc: 0.922
Validation loss decreased (-0.902696 --> -0.921617).  Saving model ...
Epoch: 10 cost time: 2.4740593433380127
Epoch: 10, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.398 Vali Acc: 0.927 Test Loss: 0.398 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 11 cost time: 2.477591037750244
Epoch: 11, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4420762062072754
Epoch: 12, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.927023 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 2.4810128211975098
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.807267904281616
Epoch: 14, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 2.424579381942749
Epoch: 15, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959457).  Saving model ...
Epoch: 16 cost time: 2.5771546363830566
Epoch: 16, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.835106611251831
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 18 cost time: 2.6606953144073486
Epoch: 18, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8338510990142822
Epoch: 19, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.481917142868042
Epoch: 20, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4942219257354736
Epoch: 21, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.7272789478302
Epoch: 22, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9345314502716064
Epoch: 23, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.76814341545105
Epoch: 24, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8501651287078857
Epoch: 25, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 2.8265724182128906
Epoch: 26, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6515300273895264
Epoch: 27, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.7915196418762207
Epoch: 28, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.957113742828369
Epoch: 29, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2509453296661377
Epoch: 30, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.581331491470337
Epoch: 31, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.2515153884887695
Epoch: 32, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.956713914871216
Epoch: 33, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.828819513320923
Epoch: 34, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.546466827392578
Epoch: 35, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 313573
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.883391380310059
Epoch: 1, Steps: 17 | Train Loss: 2.339 Vali Loss: 2.262 Vali Acc: 0.130 Test Loss: 2.262 Test Acc: 0.130
Validation loss decreased (inf --> -0.129707).  Saving model ...
Epoch: 2 cost time: 2.8440566062927246
Epoch: 2, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.141 Vali Acc: 0.211 Test Loss: 2.141 Test Acc: 0.211
Validation loss decreased (-0.129707 --> -0.210789).  Saving model ...
Epoch: 3 cost time: 2.696416139602661
Epoch: 3, Steps: 17 | Train Loss: 2.141 Vali Loss: 2.028 Vali Acc: 0.370 Test Loss: 2.028 Test Acc: 0.370
Validation loss decreased (-0.210789 --> -0.370250).  Saving model ...
Epoch: 4 cost time: 2.524749279022217
Epoch: 4, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.757 Vali Acc: 0.605 Test Loss: 1.757 Test Acc: 0.605
Validation loss decreased (-0.370250 --> -0.605388).  Saving model ...
Epoch: 5 cost time: 2.8107213973999023
Epoch: 5, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.368 Vali Acc: 0.754 Test Loss: 1.368 Test Acc: 0.754
Validation loss decreased (-0.605388 --> -0.754040).  Saving model ...
Epoch: 6 cost time: 2.8634696006774902
Epoch: 6, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.009 Vali Acc: 0.838 Test Loss: 1.009 Test Acc: 0.838
Validation loss decreased (-0.754040 --> -0.837828).  Saving model ...
Epoch: 7 cost time: 2.5594592094421387
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.767 Vali Acc: 0.884 Test Loss: 0.767 Test Acc: 0.884
Validation loss decreased (-0.837828 --> -0.883776).  Saving model ...
Epoch: 8 cost time: 2.5882949829101562
Epoch: 8, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.584 Vali Acc: 0.908 Test Loss: 0.584 Test Acc: 0.908
Validation loss decreased (-0.883776 --> -0.908102).  Saving model ...
Epoch: 9 cost time: 2.8988730907440186
Epoch: 9, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.465 Vali Acc: 0.914 Test Loss: 0.465 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913509).  Saving model ...
Epoch: 10 cost time: 2.5101120471954346
Epoch: 10, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 11 cost time: 2.523358106613159
Epoch: 11, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 2.841991424560547
Epoch: 12, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 13 cost time: 2.9327189922332764
Epoch: 13, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 14 cost time: 2.865403413772583
Epoch: 14, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 15 cost time: 2.6680870056152344
Epoch: 15, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 16 cost time: 2.9060535430908203
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 2.699779510498047
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 2.691649913787842
Epoch: 18, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5153839588165283
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.521942377090454
Epoch: 20, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 2.951911449432373
Epoch: 21, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.204 Vali Acc: 0.932 Test Loss: 0.204 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8157613277435303
Epoch: 22, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.39673113822937
Epoch: 23, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6334280967712402
Epoch: 24, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.838623285293579
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.170 Vali Acc: 0.932 Test Loss: 0.170 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.763171434402466
Epoch: 26, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5955469608306885
Epoch: 27, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6032114028930664
Epoch: 28, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6611218452453613
Epoch: 29, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.166 Vali Acc: 0.932 Test Loss: 0.166 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.723317861557007
Epoch: 30, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 31 cost time: 2.2764365673065186
Epoch: 31, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.156 Vali Acc: 0.938 Test Loss: 0.156 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.6824729442596436
Epoch: 32, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.164 Vali Acc: 0.938 Test Loss: 0.164 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.495213031768799
Epoch: 33, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 34 cost time: 2.710895538330078
Epoch: 34, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.956756 --> -0.964864).  Saving model ...
Epoch: 35 cost time: 2.4826552867889404
Epoch: 35, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.6101579666137695
Epoch: 36, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.901607036590576
Epoch: 37, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.941 Test Loss: 0.139 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.7063567638397217
Epoch: 38, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.3882577419281006
Epoch: 39, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.176 Vali Acc: 0.927 Test Loss: 0.176 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.5413901805877686
Epoch: 40, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.946 Test Loss: 0.122 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.6451427936553955
Epoch: 41, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.370654582977295
Epoch: 42, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.682844638824463
Epoch: 43, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.1319711208343506
Epoch: 44, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 313349
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.578415393829346
Epoch: 1, Steps: 17 | Train Loss: 2.281 Vali Loss: 2.191 Vali Acc: 0.151 Test Loss: 2.191 Test Acc: 0.151
Validation loss decreased (inf --> -0.151329).  Saving model ...
Epoch: 2 cost time: 3.043224334716797
Epoch: 2, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.126 Vali Acc: 0.189 Test Loss: 2.126 Test Acc: 0.189
Validation loss decreased (-0.151329 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 2.7838118076324463
Epoch: 3, Steps: 17 | Train Loss: 2.102 Vali Loss: 2.007 Vali Acc: 0.430 Test Loss: 2.007 Test Acc: 0.430
Validation loss decreased (-0.189168 --> -0.429710).  Saving model ...
Epoch: 4 cost time: 2.5872533321380615
Epoch: 4, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.813 Vali Acc: 0.622 Test Loss: 1.813 Test Acc: 0.622
Validation loss decreased (-0.429710 --> -0.621603).  Saving model ...
Epoch: 5 cost time: 2.6278958320617676
Epoch: 5, Steps: 17 | Train Loss: 1.772 Vali Loss: 1.448 Vali Acc: 0.765 Test Loss: 1.448 Test Acc: 0.765
Validation loss decreased (-0.621603 --> -0.764850).  Saving model ...
Epoch: 6 cost time: 2.706956386566162
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.087 Vali Acc: 0.827 Test Loss: 1.087 Test Acc: 0.827
Validation loss decreased (-0.764850 --> -0.827016).  Saving model ...
Epoch: 7 cost time: 3.0233516693115234
Epoch: 7, Steps: 17 | Train Loss: 0.992 Vali Loss: 0.796 Vali Acc: 0.878 Test Loss: 0.796 Test Acc: 0.878
Validation loss decreased (-0.827016 --> -0.878370).  Saving model ...
Epoch: 8 cost time: 3.011777877807617
Epoch: 8, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.878370 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 2.4921305179595947
Epoch: 9, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 2.4881086349487305
Epoch: 10, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.419 Vali Acc: 0.924 Test Loss: 0.419 Test Acc: 0.924
Validation loss decreased (-0.899995 --> -0.924320).  Saving model ...
Epoch: 11 cost time: 2.489323616027832
Epoch: 11, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8807461261749268
Epoch: 12, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5912599563598633
Epoch: 13, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9249351024627686
Epoch: 14, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935132).  Saving model ...
Epoch: 15 cost time: 3.4060282707214355
Epoch: 15, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 16 cost time: 2.4742650985717773
Epoch: 16, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.903810739517212
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937836).  Saving model ...
Epoch: 18 cost time: 2.5388410091400146
Epoch: 18, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.234 Vali Acc: 0.905 Test Loss: 0.234 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3419442176818848
Epoch: 19, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.655977487564087
Epoch: 20, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.721867799758911
Epoch: 21, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8563239574432373
Epoch: 22, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 23 cost time: 2.7784507274627686
Epoch: 23, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3157129287719727
Epoch: 24, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.832761764526367
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.221 Vali Acc: 0.927 Test Loss: 0.221 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0383713245391846
Epoch: 26, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.226 Vali Acc: 0.914 Test Loss: 0.226 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.575026035308838
Epoch: 27, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.252 Vali Acc: 0.897 Test Loss: 0.252 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.980259418487549
Epoch: 28, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.169 Vali Acc: 0.935 Test Loss: 0.169 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.096405506134033
Epoch: 29, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.927 Test Loss: 0.205 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.932246446609497
Epoch: 30, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.9761226177215576
Epoch: 31, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.0446245670318604
Epoch: 32, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 33 cost time: 3.167760133743286
Epoch: 33, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 34 cost time: 2.4752039909362793
Epoch: 34, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.924612283706665
Epoch: 35, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.927 Test Loss: 0.220 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.7081971168518066
Epoch: 36, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.492659330368042
Epoch: 37, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.938 Test Loss: 0.151 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.478825569152832
Epoch: 38, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.769211769104004
Epoch: 39, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.9920473098754883
Epoch: 40, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.177 Vali Acc: 0.932 Test Loss: 0.177 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.7745978832244873
Epoch: 41, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.5002918243408203
Epoch: 42, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.366136312484741
Epoch: 43, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 313125
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.163355350494385
Epoch: 1, Steps: 17 | Train Loss: 2.327 Vali Loss: 2.181 Vali Acc: 0.184 Test Loss: 2.181 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 2.580660581588745
Epoch: 2, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.075 Vali Acc: 0.289 Test Loss: 2.075 Test Acc: 0.289
Validation loss decreased (-0.183762 --> -0.289168).  Saving model ...
Epoch: 3 cost time: 2.4361956119537354
Epoch: 3, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.858 Vali Acc: 0.581 Test Loss: 1.858 Test Acc: 0.581
Validation loss decreased (-0.289168 --> -0.581062).  Saving model ...
Epoch: 4 cost time: 2.6418426036834717
Epoch: 4, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.579 Vali Acc: 0.681 Test Loss: 1.579 Test Acc: 0.681
Validation loss decreased (-0.581062 --> -0.681065).  Saving model ...
Epoch: 5 cost time: 2.2840919494628906
Epoch: 5, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.234 Vali Acc: 0.849 Test Loss: 1.234 Test Acc: 0.849
Validation loss decreased (-0.681065 --> -0.848636).  Saving model ...
Epoch: 6 cost time: 2.532592296600342
Epoch: 6, Steps: 17 | Train Loss: 1.208 Vali Loss: 0.938 Vali Acc: 0.881 Test Loss: 0.938 Test Acc: 0.881
Validation loss decreased (-0.848636 --> -0.881072).  Saving model ...
Epoch: 7 cost time: 2.6154956817626953
Epoch: 7, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.732 Vali Acc: 0.884 Test Loss: 0.732 Test Acc: 0.884
Validation loss decreased (-0.881072 --> -0.883776).  Saving model ...
Epoch: 8 cost time: 2.768350601196289
Epoch: 8, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.663 Vali Acc: 0.868 Test Loss: 0.663 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.583682060241699
Epoch: 9, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.448 Vali Acc: 0.930 Test Loss: 0.448 Test Acc: 0.930
Validation loss decreased (-0.883776 --> -0.929725).  Saving model ...
Epoch: 10 cost time: 2.6642017364501953
Epoch: 10, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.350 Vali Acc: 0.935 Test Loss: 0.350 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 3.2929399013519287
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.329 Vali Acc: 0.935 Test Loss: 0.329 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 2.551656723022461
Epoch: 12, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.275 Vali Acc: 0.946 Test Loss: 0.275 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 2.508655309677124
Epoch: 13, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.597332715988159
Epoch: 14, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.234 Vali Acc: 0.954 Test Loss: 0.234 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 2.8198394775390625
Epoch: 15, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6727914810180664
Epoch: 16, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.184 Vali Acc: 0.965 Test Loss: 0.184 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 3.4550979137420654
Epoch: 17, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6265289783477783
Epoch: 18, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.704090118408203
Epoch: 19, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7410497665405273
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 3.051283359527588
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7216956615448
Epoch: 22, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7626194953918457
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 2.5254368782043457
Epoch: 24, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5499632358551025
Epoch: 25, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.6400232315063477
Epoch: 26, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 2.515734910964966
Epoch: 27, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.824620485305786
Epoch: 28, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.170 Vali Acc: 0.932 Test Loss: 0.170 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.936131477355957
Epoch: 29, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.795640230178833
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7127702236175537
Epoch: 31, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 32 cost time: 2.7475624084472656
Epoch: 32, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.0322229862213135
Epoch: 33, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.715045690536499
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.4584879875183105
Epoch: 35, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.439720630645752
Epoch: 36, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.376059055328369
Epoch: 37, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.5854780673980713
Epoch: 38, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.6581127643585205
Epoch: 39, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.58404541015625
Epoch: 40, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.2631113529205322
Epoch: 41, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 312901
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8869054317474365
Epoch: 1, Steps: 17 | Train Loss: 2.324 Vali Loss: 2.151 Vali Acc: 0.141 Test Loss: 2.151 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 3.138864278793335
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.131 Vali Acc: 0.268 Test Loss: 2.131 Test Acc: 0.268
Validation loss decreased (-0.140519 --> -0.267546).  Saving model ...
Epoch: 3 cost time: 2.6738195419311523
Epoch: 3, Steps: 17 | Train Loss: 2.126 Vali Loss: 2.049 Vali Acc: 0.459 Test Loss: 2.049 Test Acc: 0.459
Validation loss decreased (-0.267546 --> -0.459439).  Saving model ...
Epoch: 4 cost time: 2.7689836025238037
Epoch: 4, Steps: 17 | Train Loss: 2.024 Vali Loss: 1.896 Vali Acc: 0.549 Test Loss: 1.896 Test Acc: 0.549
Validation loss decreased (-0.459439 --> -0.548630).  Saving model ...
Epoch: 5 cost time: 2.673044443130493
Epoch: 5, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.624 Vali Acc: 0.697 Test Loss: 1.624 Test Acc: 0.697
Validation loss decreased (-0.548630 --> -0.697281).  Saving model ...
Epoch: 6 cost time: 2.6807339191436768
Epoch: 6, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.261 Vali Acc: 0.803 Test Loss: 1.261 Test Acc: 0.803
Validation loss decreased (-0.697281 --> -0.802690).  Saving model ...
Epoch: 7 cost time: 2.9162094593048096
Epoch: 7, Steps: 17 | Train Loss: 1.067 Vali Loss: 0.909 Vali Acc: 0.865 Test Loss: 0.909 Test Acc: 0.865
Validation loss decreased (-0.802690 --> -0.864856).  Saving model ...
Epoch: 8 cost time: 2.7054455280303955
Epoch: 8, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.668 Vali Acc: 0.895 Test Loss: 0.668 Test Acc: 0.895
Validation loss decreased (-0.864856 --> -0.894588).  Saving model ...
Epoch: 9 cost time: 2.497143268585205
Epoch: 9, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.505 Vali Acc: 0.908 Test Loss: 0.505 Test Acc: 0.908
Validation loss decreased (-0.894588 --> -0.908103).  Saving model ...
Epoch: 10 cost time: 2.7644989490509033
Epoch: 10, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.420 Vali Acc: 0.908 Test Loss: 0.420 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908104).  Saving model ...
Epoch: 11 cost time: 2.649805784225464
Epoch: 11, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.908104 --> -0.929726).  Saving model ...
Epoch: 12 cost time: 2.7921388149261475
Epoch: 12, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 2.893404722213745
Epoch: 13, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 2.592118978500366
Epoch: 14, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6376819610595703
Epoch: 15, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.743914842605591
Epoch: 16, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.241 Vali Acc: 0.938 Test Loss: 0.241 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9080541133880615
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.930511713027954
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 2.6120150089263916
Epoch: 19, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.924104928970337
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4875714778900146
Epoch: 21, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.0020015239715576
Epoch: 22, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0362937450408936
Epoch: 23, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8778798580169678
Epoch: 24, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4261627197265625
Epoch: 25, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 2.6053249835968018
Epoch: 26, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 2.9363672733306885
Epoch: 27, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.765352487564087
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.930 Test Loss: 0.165 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.6005260944366455
Epoch: 29, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 2.8263635635375977
Epoch: 30, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.708026170730591
Epoch: 31, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.6284661293029785
Epoch: 32, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.7537896633148193
Epoch: 33, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.877788782119751
Epoch: 34, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.7705397605895996
Epoch: 35, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.367079496383667
Epoch: 36, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.938 Test Loss: 0.153 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.6390106678009033
Epoch: 37, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.938 Test Loss: 0.150 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.906008720397949
Epoch: 38, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.5148260593414307
Epoch: 39, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 238693
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.100599527359009
Epoch: 1, Steps: 17 | Train Loss: 2.245 Vali Loss: 2.152 Vali Acc: 0.214 Test Loss: 2.152 Test Acc: 0.214
Validation loss decreased (inf --> -0.213492).  Saving model ...
Epoch: 2 cost time: 2.7122843265533447
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.098 Vali Acc: 0.211 Test Loss: 2.098 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2636735439300537
Epoch: 3, Steps: 17 | Train Loss: 2.067 Vali Loss: 2.002 Vali Acc: 0.338 Test Loss: 2.002 Test Acc: 0.338
Validation loss decreased (-0.213492 --> -0.337818).  Saving model ...
Epoch: 4 cost time: 3.0002682209014893
Epoch: 4, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.747 Vali Acc: 0.603 Test Loss: 1.747 Test Acc: 0.603
Validation loss decreased (-0.337818 --> -0.602685).  Saving model ...
Epoch: 5 cost time: 3.027776002883911
Epoch: 5, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.401 Vali Acc: 0.786 Test Loss: 1.401 Test Acc: 0.786
Validation loss decreased (-0.602685 --> -0.786472).  Saving model ...
Epoch: 6 cost time: 3.1179301738739014
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.092 Vali Acc: 0.819 Test Loss: 1.092 Test Acc: 0.819
Validation loss decreased (-0.786472 --> -0.818908).  Saving model ...
Epoch: 7 cost time: 2.693033218383789
Epoch: 7, Steps: 17 | Train Loss: 1.017 Vali Loss: 0.858 Vali Acc: 0.876 Test Loss: 0.858 Test Acc: 0.876
Validation loss decreased (-0.818908 --> -0.875667).  Saving model ...
Epoch: 8 cost time: 2.7537500858306885
Epoch: 8, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.664 Vali Acc: 0.892 Test Loss: 0.664 Test Acc: 0.892
Validation loss decreased (-0.875667 --> -0.891885).  Saving model ...
Epoch: 9 cost time: 2.4113409519195557
Epoch: 9, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.529 Vali Acc: 0.914 Test Loss: 0.529 Test Acc: 0.914
Validation loss decreased (-0.891885 --> -0.913508).  Saving model ...
Epoch: 10 cost time: 2.9240293502807617
Epoch: 10, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.430 Vali Acc: 0.930 Test Loss: 0.430 Test Acc: 0.930
Validation loss decreased (-0.913508 --> -0.929725).  Saving model ...
Epoch: 11 cost time: 2.457902193069458
Epoch: 11, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5213510990142822
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932429).  Saving model ...
Epoch: 13 cost time: 2.697892904281616
Epoch: 13, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.291 Vali Acc: 0.932 Test Loss: 0.291 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 14 cost time: 2.795649766921997
Epoch: 14, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1701114177703857
Epoch: 15, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.262 Vali Acc: 0.924 Test Loss: 0.262 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.885993242263794
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 17 cost time: 2.5120227336883545
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.245 Vali Acc: 0.916 Test Loss: 0.245 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.677023410797119
Epoch: 18, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.889781951904297
Epoch: 19, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 2.296602487564087
Epoch: 20, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 2.6334826946258545
Epoch: 21, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 2.796311616897583
Epoch: 22, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4036386013031006
Epoch: 23, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 2.5233097076416016
Epoch: 24, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7466795444488525
Epoch: 25, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.042726755142212
Epoch: 26, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.863495111465454
Epoch: 27, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 28 cost time: 2.987663745880127
Epoch: 28, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.691476821899414
Epoch: 29, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9027926921844482
Epoch: 30, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.018129825592041
Epoch: 31, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 3.108370304107666
Epoch: 32, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 2.8870370388031006
Epoch: 33, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 2.5572152137756348
Epoch: 34, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8006696701049805
Epoch: 35, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.929746150970459
Epoch: 36, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.548859119415283
Epoch: 37, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.528203010559082
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.9835000038146973
Epoch: 39, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 40 cost time: 2.7614681720733643
Epoch: 40, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 41 cost time: 3.0134549140930176
Epoch: 41, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.056011199951172
Epoch: 42, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.1561896800994873
Epoch: 43, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.0517544746398926
Epoch: 44, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.932 Test Loss: 0.156 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.4058449268341064
Epoch: 45, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.5145959854125977
Epoch: 46, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.293731212615967
Epoch: 47, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.0425078868865967
Epoch: 48, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.413764476776123
Epoch: 49, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.4403653144836426
Epoch: 50, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 238469
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.682342767715454
Epoch: 1, Steps: 17 | Train Loss: 2.323 Vali Loss: 2.200 Vali Acc: 0.143 Test Loss: 2.200 Test Acc: 0.143
Validation loss decreased (inf --> -0.143221).  Saving model ...
Epoch: 2 cost time: 2.9777944087982178
Epoch: 2, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.148 Vali Acc: 0.173 Test Loss: 2.148 Test Acc: 0.173
Validation loss decreased (-0.143221 --> -0.172951).  Saving model ...
Epoch: 3 cost time: 2.6949360370635986
Epoch: 3, Steps: 17 | Train Loss: 2.110 Vali Loss: 2.004 Vali Acc: 0.522 Test Loss: 2.004 Test Acc: 0.522
Validation loss decreased (-0.172951 --> -0.521602).  Saving model ...
Epoch: 4 cost time: 2.319491147994995
Epoch: 4, Steps: 17 | Train Loss: 2.005 Vali Loss: 1.869 Vali Acc: 0.538 Test Loss: 1.869 Test Acc: 0.538
Validation loss decreased (-0.521602 --> -0.537819).  Saving model ...
Epoch: 5 cost time: 2.504319429397583
Epoch: 5, Steps: 17 | Train Loss: 1.761 Vali Loss: 1.524 Vali Acc: 0.776 Test Loss: 1.524 Test Acc: 0.776
Validation loss decreased (-0.537819 --> -0.775660).  Saving model ...
Epoch: 6 cost time: 2.443028211593628
Epoch: 6, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.195 Vali Acc: 0.830 Test Loss: 1.195 Test Acc: 0.830
Validation loss decreased (-0.775660 --> -0.829718).  Saving model ...
Epoch: 7 cost time: 2.2934203147888184
Epoch: 7, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.911 Vali Acc: 0.859 Test Loss: 0.911 Test Acc: 0.859
Validation loss decreased (-0.829718 --> -0.859450).  Saving model ...
Epoch: 8 cost time: 2.589975118637085
Epoch: 8, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.682 Vali Acc: 0.900 Test Loss: 0.682 Test Acc: 0.900
Validation loss decreased (-0.859450 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 3.0326528549194336
Epoch: 9, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.519 Vali Acc: 0.916 Test Loss: 0.519 Test Acc: 0.916
Validation loss decreased (-0.899993 --> -0.916211).  Saving model ...
Epoch: 10 cost time: 2.754962205886841
Epoch: 10, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.425 Vali Acc: 0.922 Test Loss: 0.425 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 11 cost time: 2.2610647678375244
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
Validation loss decreased (-0.921617 --> -0.929726).  Saving model ...
Epoch: 12 cost time: 2.5549371242523193
Epoch: 12, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 13 cost time: 2.648435354232788
Epoch: 13, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 14 cost time: 2.5918986797332764
Epoch: 14, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 15 cost time: 2.482590675354004
Epoch: 15, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 16 cost time: 3.0407044887542725
Epoch: 16, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 2.7025325298309326
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 2.710078477859497
Epoch: 18, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.030818223953247
Epoch: 19, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 2.491931676864624
Epoch: 20, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.906355857849121
Epoch: 21, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6855525970458984
Epoch: 22, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 2.336761951446533
Epoch: 23, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5300939083099365
Epoch: 24, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 2.93495774269104
Epoch: 25, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.574367046356201
Epoch: 26, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 2.795771598815918
Epoch: 27, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.961156129837036
Epoch: 28, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.782928943634033
Epoch: 29, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3239011764526367
Epoch: 30, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 2.5757699012756348
Epoch: 31, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.5364303588867188
Epoch: 32, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.7306125164031982
Epoch: 33, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.8134803771972656
Epoch: 34, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 35 cost time: 2.4803950786590576
Epoch: 35, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.778911590576172
Epoch: 36, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.6051175594329834
Epoch: 37, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.576878309249878
Epoch: 38, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.7571003437042236
Epoch: 39, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.9673960208892822
Epoch: 40, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.3368372917175293
Epoch: 41, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.7907650470733643
Epoch: 42, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.0744035243988037
Epoch: 43, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.7180771827697754
Epoch: 44, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 238245
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.692951917648315
Epoch: 1, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.116 Vali Acc: 0.222 Test Loss: 2.116 Test Acc: 0.222
Validation loss decreased (inf --> -0.221600).  Saving model ...
Epoch: 2 cost time: 2.5897934436798096
Epoch: 2, Steps: 17 | Train Loss: 2.143 Vali Loss: 2.044 Vali Acc: 0.268 Test Loss: 2.044 Test Acc: 0.268
Validation loss decreased (-0.221600 --> -0.267547).  Saving model ...
Epoch: 3 cost time: 2.8873512744903564
Epoch: 3, Steps: 17 | Train Loss: 1.988 Vali Loss: 1.882 Vali Acc: 0.511 Test Loss: 1.882 Test Acc: 0.511
Validation loss decreased (-0.267547 --> -0.510792).  Saving model ...
Epoch: 4 cost time: 2.8565101623535156
Epoch: 4, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.661 Vali Acc: 0.700 Test Loss: 1.661 Test Acc: 0.700
Validation loss decreased (-0.510792 --> -0.699983).  Saving model ...
Epoch: 5 cost time: 2.317547559738159
Epoch: 5, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.398 Vali Acc: 0.684 Test Loss: 1.398 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7308428287506104
Epoch: 6, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.155 Vali Acc: 0.797 Test Loss: 1.155 Test Acc: 0.797
Validation loss decreased (-0.699983 --> -0.797286).  Saving model ...
Epoch: 7 cost time: 2.783745527267456
Epoch: 7, Steps: 17 | Train Loss: 1.058 Vali Loss: 0.917 Vali Acc: 0.846 Test Loss: 0.917 Test Acc: 0.846
Validation loss decreased (-0.797286 --> -0.845937).  Saving model ...
Epoch: 8 cost time: 2.466965675354004
Epoch: 8, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.732 Vali Acc: 0.878 Test Loss: 0.732 Test Acc: 0.878
Validation loss decreased (-0.845937 --> -0.878371).  Saving model ...
Epoch: 9 cost time: 2.1320128440856934
Epoch: 9, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.601 Vali Acc: 0.911 Test Loss: 0.601 Test Acc: 0.911
Validation loss decreased (-0.878371 --> -0.910805).  Saving model ...
Epoch: 10 cost time: 2.111721992492676
Epoch: 10, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.464 Vali Acc: 0.930 Test Loss: 0.464 Test Acc: 0.930
Validation loss decreased (-0.910805 --> -0.929725).  Saving model ...
Epoch: 11 cost time: 2.5016486644744873
Epoch: 11, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.372 Vali Acc: 0.932 Test Loss: 0.372 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932429).  Saving model ...
Epoch: 12 cost time: 2.6301019191741943
Epoch: 12, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.320 Vali Acc: 0.946 Test Loss: 0.320 Test Acc: 0.946
Validation loss decreased (-0.932429 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 2.4074783325195312
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.278 Vali Acc: 0.946 Test Loss: 0.278 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 2.43255352973938
Epoch: 14, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.258 Vali Acc: 0.951 Test Loss: 0.258 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 2.4085464477539062
Epoch: 15, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6071388721466064
Epoch: 16, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 17 cost time: 2.3889119625091553
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3716681003570557
Epoch: 18, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.457808494567871
Epoch: 19, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6460721492767334
Epoch: 20, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.3874003887176514
Epoch: 21, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0742850303649902
Epoch: 22, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.536961317062378
Epoch: 23, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.617993116378784
Epoch: 24, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5904085636138916
Epoch: 25, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6964433193206787
Epoch: 26, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.244147777557373
Epoch: 27, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.8095970153808594
Epoch: 28, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8404669761657715
Epoch: 29, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.541165590286255
Epoch: 30, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 238021
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.271589040756226
Epoch: 1, Steps: 17 | Train Loss: 2.276 Vali Loss: 1.891 Vali Acc: 0.524 Test Loss: 1.891 Test Acc: 0.524
Validation loss decreased (inf --> -0.524305).  Saving model ...
Epoch: 2 cost time: 2.555901050567627
Epoch: 2, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.038 Vali Acc: 0.827 Test Loss: 1.038 Test Acc: 0.827
Validation loss decreased (-0.524305 --> -0.827017).  Saving model ...
Epoch: 3 cost time: 2.424285888671875
Epoch: 3, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.827017 --> -0.902699).  Saving model ...
Epoch: 4 cost time: 2.11122465133667
Epoch: 4, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.902699 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 2.4043498039245605
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2575221061706543
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.295172929763794
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 2.4887969493865967
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.1660666465759277
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4338619709014893
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8224244117736816
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.038723945617676
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.15580153465271
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 2.3111062049865723
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0435829162597656
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 2.079765558242798
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.5154802799224854
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.27750825881958
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0764665603637695
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3139548301696777
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.959 Test Loss: 0.099 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8008155822753906
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.085012912750244
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0610578060150146
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 2.1962761878967285
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2161269187927246
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.603550434112549
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.20495343208313
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 2.02947998046875
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0613348484039307
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.6465437412261963
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.959 Test Loss: 0.094 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.656392812728882
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.959 Test Loss: 0.095 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3515326976776123
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.594322443008423
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.962 Test Loss: 0.090 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.347444772720337
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.959 Test Loss: 0.094 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.6656646728515625
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2332615852355957
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.4577276706695557
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 11128377
model size : 47.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.682284355163574
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.016 Vali Acc: 0.308 Test Loss: 2.016 Test Acc: 0.308
Validation loss decreased (inf --> -0.308088).  Saving model ...
Epoch: 2 cost time: 2.0846590995788574
Epoch: 2, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.066 Vali Acc: 0.741 Test Loss: 1.066 Test Acc: 0.741
Validation loss decreased (-0.308088 --> -0.740530).  Saving model ...
Epoch: 3 cost time: 2.360201358795166
Epoch: 3, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
Validation loss decreased (-0.740530 --> -0.921618).  Saving model ...
Epoch: 4 cost time: 2.082707643508911
Epoch: 4, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.427 Vali Acc: 0.849 Test Loss: 0.427 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3711843490600586
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.252 Vali Acc: 0.914 Test Loss: 0.252 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.480430841445923
Epoch: 6, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.921618 --> -0.943242).  Saving model ...
Epoch: 7 cost time: 2.044463634490967
Epoch: 7, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.908 Test Loss: 0.258 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.129565954208374
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.276 Vali Acc: 0.908 Test Loss: 0.276 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.209401845932007
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4311676025390625
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.941 Test Loss: 0.145 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4399256706237793
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.935 Test Loss: 0.167 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7666962146759033
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.927 Test Loss: 0.162 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.461538791656494
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.932 Test Loss: 0.167 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7301812171936035
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
Validation loss decreased (-0.943242 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 2.414313554763794
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.919 Test Loss: 0.205 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.397263526916504
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.5061745643615723
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.676504135131836
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3082973957061768
Epoch: 19, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.447235584259033
Epoch: 20, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.329584836959839
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.503606081008911
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.6737353801727295
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1494104862213135
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2018635272979736
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.600487470626831
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.437652349472046
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1511175632476807
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.157482862472534
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.205152750015259
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9697818756103516
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.34306001663208
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 11126841
model size : 47.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.371304273605347
Epoch: 1, Steps: 17 | Train Loss: 2.379 Vali Loss: 1.999 Vali Acc: 0.181 Test Loss: 1.999 Test Acc: 0.181
Validation loss decreased (inf --> -0.181061).  Saving model ...
Epoch: 2 cost time: 2.0879101753234863
Epoch: 2, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.228 Vali Acc: 0.622 Test Loss: 1.228 Test Acc: 0.622
Validation loss decreased (-0.181061 --> -0.621609).  Saving model ...
Epoch: 3 cost time: 2.360419511795044
Epoch: 3, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.524 Vali Acc: 0.862 Test Loss: 0.524 Test Acc: 0.862
Validation loss decreased (-0.621609 --> -0.862157).  Saving model ...
Epoch: 4 cost time: 2.26784348487854
Epoch: 4, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
Validation loss decreased (-0.862157 --> -0.927025).  Saving model ...
Epoch: 5 cost time: 2.290900468826294
Epoch: 5, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0641114711761475
Epoch: 6, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (-0.927025 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.0527381896972656
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.139 Vali Acc: 0.941 Test Loss: 0.139 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3052525520324707
Epoch: 8, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956756).  Saving model ...
Epoch: 9 cost time: 2.324376344680786
Epoch: 9, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1300997734069824
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3208634853363037
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.294764280319214
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0996692180633545
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1662757396698
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 15 cost time: 2.4358603954315186
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.23943829536438
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.0382094383239746
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.930 Test Loss: 0.159 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.426121711730957
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3391823768615723
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.067411422729492
Epoch: 20, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1981239318847656
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5968801975250244
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.279 Vali Acc: 0.905 Test Loss: 0.279 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2397589683532715
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.525111198425293
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4608333110809326
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.916 Test Loss: 0.226 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.3658156394958496
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 11125305
model size : 47.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.224366903305054
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 2.033 Vali Acc: 0.430 Test Loss: 2.033 Test Acc: 0.430
Validation loss decreased (inf --> -0.429709).  Saving model ...
Epoch: 2 cost time: 2.221271276473999
Epoch: 2, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.289 Vali Acc: 0.605 Test Loss: 1.289 Test Acc: 0.605
Validation loss decreased (-0.429709 --> -0.605393).  Saving model ...
Epoch: 3 cost time: 2.1832876205444336
Epoch: 3, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.513 Vali Acc: 0.865 Test Loss: 0.513 Test Acc: 0.865
Validation loss decreased (-0.605393 --> -0.864860).  Saving model ...
Epoch: 4 cost time: 2.0254786014556885
Epoch: 4, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.366 Vali Acc: 0.881 Test Loss: 0.366 Test Acc: 0.881
Validation loss decreased (-0.864860 --> -0.881077).  Saving model ...
Epoch: 5 cost time: 2.0949745178222656
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.881077 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.9459772109985352
Epoch: 6, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.935133 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.1144766807556152
Epoch: 7, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.111232042312622
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9209420680999756
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9270720481872559
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.938 Test Loss: 0.170 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8487303256988525
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.170945882797241
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9476463794708252
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.1447696685791016
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.225813627243042
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.020665407180786
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.973820686340332
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2474524974823
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.416452407836914
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1074705123901367
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1124143600463867
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5902421474456787
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2484302520751953
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 11123769
model size : 47.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.928805351257324
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 1.929 Vali Acc: 0.241 Test Loss: 1.929 Test Acc: 0.241
Validation loss decreased (inf --> -0.240521).  Saving model ...
Epoch: 2 cost time: 2.239685297012329
Epoch: 2, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.062 Vali Acc: 0.803 Test Loss: 1.062 Test Acc: 0.803
Validation loss decreased (-0.240521 --> -0.802692).  Saving model ...
Epoch: 3 cost time: 2.1893303394317627
Epoch: 3, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.467 Vali Acc: 0.908 Test Loss: 0.467 Test Acc: 0.908
Validation loss decreased (-0.802692 --> -0.908103).  Saving model ...
Epoch: 4 cost time: 2.1711859703063965
Epoch: 4, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.333 Vali Acc: 0.895 Test Loss: 0.333 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.407831907272339
Epoch: 5, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.320 Vali Acc: 0.897 Test Loss: 0.320 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2610819339752197
Epoch: 6, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.908103 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 2.5474095344543457
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.256105661392212
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.419297218322754
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.525743246078491
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.247 Vali Acc: 0.916 Test Loss: 0.247 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1838040351867676
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 2.2528533935546875
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 2.6511642932891846
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.273225784301758
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.739441156387329
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4182791709899902
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 2.462416887283325
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3854575157165527
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.499955892562866
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1325409412384033
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.280 Vali Acc: 0.924 Test Loss: 0.280 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1492693424224854
Epoch: 21, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6850340366363525
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.862384796142578
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.914 Test Loss: 0.285 Test Acc: 0.914
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8476240634918213
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.295 Vali Acc: 0.916 Test Loss: 0.295 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.586759090423584
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4468367099761963
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 9289785
model size : 40.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.99402642250061
Epoch: 1, Steps: 17 | Train Loss: 2.255 Vali Loss: 2.131 Vali Acc: 0.246 Test Loss: 2.131 Test Acc: 0.246
Validation loss decreased (inf --> -0.245925).  Saving model ...
Epoch: 2 cost time: 2.2573187351226807
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.661 Vali Acc: 0.454 Test Loss: 1.661 Test Acc: 0.454
Validation loss decreased (-0.245925 --> -0.454037).  Saving model ...
Epoch: 3 cost time: 2.0950708389282227
Epoch: 3, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
Validation loss decreased (-0.454037 --> -0.870265).  Saving model ...
Epoch: 4 cost time: 2.6260697841644287
Epoch: 4, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.269 Vali Acc: 0.924 Test Loss: 0.269 Test Acc: 0.924
Validation loss decreased (-0.870265 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 2.4480202198028564
Epoch: 5, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.310783863067627
Epoch: 6, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.525489330291748
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.224 Vali Acc: 0.927 Test Loss: 0.224 Test Acc: 0.927
Validation loss decreased (-0.924322 --> -0.927025).  Saving model ...
Epoch: 8 cost time: 2.154171943664551
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.151 Vali Acc: 0.938 Test Loss: 0.151 Test Acc: 0.938
Validation loss decreased (-0.927025 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 2.2181527614593506
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.937836 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 2.3425354957580566
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 2.0864758491516113
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.99580717086792
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 2.2518064975738525
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3067266941070557
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.908 Test Loss: 0.290 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.263105630874634
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.927 Test Loss: 0.216 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0581178665161133
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.260 Vali Acc: 0.924 Test Loss: 0.260 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.340339422225952
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.270 Vali Acc: 0.924 Test Loss: 0.270 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.158693552017212
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5040555000305176
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.235783100128174
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2560575008392334
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.43074107170105
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 9288249
model size : 40.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.980201244354248
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 1.954 Vali Acc: 0.538 Test Loss: 1.954 Test Acc: 0.538
Validation loss decreased (inf --> -0.537818).  Saving model ...
Epoch: 2 cost time: 2.9238977432250977
Epoch: 2, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.181 Vali Acc: 0.684 Test Loss: 1.181 Test Acc: 0.684
Validation loss decreased (-0.537818 --> -0.683772).  Saving model ...
Epoch: 3 cost time: 2.634711980819702
Epoch: 3, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.548 Vali Acc: 0.784 Test Loss: 0.548 Test Acc: 0.784
Validation loss decreased (-0.683772 --> -0.783778).  Saving model ...
Epoch: 4 cost time: 2.358374834060669
Epoch: 4, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
Validation loss decreased (-0.783778 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 2.305233955383301
Epoch: 5, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.447531223297119
Epoch: 6, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 2.345829963684082
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 2.6788828372955322
Epoch: 8, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.278 Vali Acc: 0.905 Test Loss: 0.278 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2160704135894775
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2956011295318604
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 2.2692487239837646
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.222672939300537
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3936781883239746
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.571364641189575
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.472867727279663
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.400914192199707
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4691121578216553
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 2.257185697555542
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0044620037078857
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7165071964263916
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.300943374633789
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.341071128845215
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.625413656234741
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.752011299133301
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8395836353302
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6171672344207764
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5311238765716553
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 9286713
model size : 40.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1505632400512695
Epoch: 1, Steps: 17 | Train Loss: 2.234 Vali Loss: 2.024 Vali Acc: 0.546 Test Loss: 2.024 Test Acc: 0.546
Validation loss decreased (inf --> -0.545926).  Saving model ...
Epoch: 2 cost time: 2.0813305377960205
Epoch: 2, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.398 Vali Acc: 0.543 Test Loss: 1.398 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8444209098815918
Epoch: 3, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.449 Vali Acc: 0.903 Test Loss: 0.449 Test Acc: 0.903
Validation loss decreased (-0.545926 --> -0.902698).  Saving model ...
Epoch: 4 cost time: 2.2703263759613037
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.359 Vali Acc: 0.892 Test Loss: 0.359 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0941860675811768
Epoch: 5, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
Validation loss decreased (-0.902698 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 2.003941774368286
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7971010208129883
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 2.194183349609375
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 2.0716493129730225
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.182 Vali Acc: 0.932 Test Loss: 0.182 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3199164867401123
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9917755126953125
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.916 Test Loss: 0.203 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.52284836769104
Epoch: 12, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.954053 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 2.2447662353515625
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.436758279800415
Epoch: 14, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.033304214477539
Epoch: 15, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.370913505554199
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.916 Test Loss: 0.247 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.265406608581543
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6687469482421875
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.558274030685425
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.463679790496826
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.941 Test Loss: 0.132 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.391451120376587
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.56286883354187
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 9285177
model size : 40.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.562424898147583
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 1.945 Vali Acc: 0.565 Test Loss: 1.945 Test Acc: 0.565
Validation loss decreased (inf --> -0.564845).  Saving model ...
Epoch: 2 cost time: 2.445659637451172
Epoch: 2, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.460 Vali Acc: 0.573 Test Loss: 1.460 Test Acc: 0.573
Validation loss decreased (-0.564845 --> -0.572958).  Saving model ...
Epoch: 3 cost time: 2.075752019882202
Epoch: 3, Steps: 17 | Train Loss: 0.955 Vali Loss: 0.471 Vali Acc: 0.914 Test Loss: 0.471 Test Acc: 0.914
Validation loss decreased (-0.572958 --> -0.913509).  Saving model ...
Epoch: 4 cost time: 2.060635566711426
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.913509 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 2.503861427307129
Epoch: 5, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 2.2820990085601807
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.377 Vali Acc: 0.876 Test Loss: 0.377 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4115545749664307
Epoch: 7, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.943241 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 2.439439535140991
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2759807109832764
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.790883779525757
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.32505202293396
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.231701612472534
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7809081077575684
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.260934829711914
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2322707176208496
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5571646690368652
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.702270269393921
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4317946434020996
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.303 Vali Acc: 0.908 Test Loss: 0.303 Test Acc: 0.908
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.840848445892334
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6505002975463867
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.32023286819458
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.198709487915039
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.6141653060913086
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.233 Vali Acc: 0.924 Test Loss: 0.233 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 8370489
model size : 36.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.233618259429932
Epoch: 1, Steps: 17 | Train Loss: 2.234 Vali Loss: 2.115 Vali Acc: 0.335 Test Loss: 2.115 Test Acc: 0.335
Validation loss decreased (inf --> -0.335114).  Saving model ...
Epoch: 2 cost time: 2.0845422744750977
Epoch: 2, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.395 Vali Acc: 0.738 Test Loss: 1.395 Test Acc: 0.738
Validation loss decreased (-0.335114 --> -0.737824).  Saving model ...
Epoch: 3 cost time: 2.2498395442962646
Epoch: 3, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.555 Vali Acc: 0.868 Test Loss: 0.555 Test Acc: 0.868
Validation loss decreased (-0.737824 --> -0.867562).  Saving model ...
Epoch: 4 cost time: 1.874678611755371
Epoch: 4, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
Validation loss decreased (-0.867562 --> -0.918916).  Saving model ...
Epoch: 5 cost time: 2.213315963745117
Epoch: 5, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.185 Vali Acc: 0.938 Test Loss: 0.185 Test Acc: 0.938
Validation loss decreased (-0.918916 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 2.476410150527954
Epoch: 6, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.4871461391448975
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.409 Vali Acc: 0.892 Test Loss: 0.409 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9434354305267334
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 2.424351215362549
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9337122440338135
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5410141944885254
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.476968288421631
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8342387676239014
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.927 Test Loss: 0.188 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4670748710632324
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8088111877441406
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9859437942504883
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.7216413021087646
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7264530658721924
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.888216495513916
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.869717597961426
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6068923473358154
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.932 Test Loss: 0.270 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.295366048812866
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3854150772094727
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5363101959228516
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.745255708694458
Epoch: 25, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4469265937805176
Epoch: 26, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 8368953
model size : 36.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.735965728759766
Epoch: 1, Steps: 17 | Train Loss: 2.240 Vali Loss: 1.969 Vali Acc: 0.297 Test Loss: 1.969 Test Acc: 0.297
Validation loss decreased (inf --> -0.297278).  Saving model ...
Epoch: 2 cost time: 2.1094982624053955
Epoch: 2, Steps: 17 | Train Loss: 1.823 Vali Loss: 1.540 Vali Acc: 0.457 Test Loss: 1.540 Test Acc: 0.457
Validation loss decreased (-0.297278 --> -0.456741).  Saving model ...
Epoch: 3 cost time: 2.120230197906494
Epoch: 3, Steps: 17 | Train Loss: 0.977 Vali Loss: 0.624 Vali Acc: 0.835 Test Loss: 0.624 Test Acc: 0.835
Validation loss decreased (-0.456741 --> -0.835129).  Saving model ...
Epoch: 4 cost time: 2.02976131439209
Epoch: 4, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
Validation loss decreased (-0.835129 --> -0.870267).  Saving model ...
Epoch: 5 cost time: 2.217468500137329
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.870267 --> -0.954053).  Saving model ...
Epoch: 6 cost time: 2.7355799674987793
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 2.143127202987671
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4079554080963135
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.34037709236145
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.343 Vali Acc: 0.908 Test Loss: 0.343 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4896128177642822
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8180806636810303
Epoch: 11, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1654231548309326
Epoch: 12, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.261225700378418
Epoch: 13, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.478065013885498
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.400346517562866
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0251853466033936
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.714564085006714
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6413583755493164
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.964864 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.9546217918395996
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2336995601654053
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1085472106933594
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.476353883743286
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4539780616760254
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2321853637695312
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.288809299468994
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3500852584838867
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1498849391937256
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8260328769683838
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 8367417
model size : 36.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.051646947860718
Epoch: 1, Steps: 17 | Train Loss: 2.326 Vali Loss: 2.034 Vali Acc: 0.411 Test Loss: 2.034 Test Acc: 0.411
Validation loss decreased (inf --> -0.410790).  Saving model ...
Epoch: 2 cost time: 2.3705272674560547
Epoch: 2, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.453 Vali Acc: 0.738 Test Loss: 1.453 Test Acc: 0.738
Validation loss decreased (-0.410790 --> -0.737823).  Saving model ...
Epoch: 3 cost time: 2.282419443130493
Epoch: 3, Steps: 17 | Train Loss: 1.101 Vali Loss: 0.494 Vali Acc: 0.924 Test Loss: 0.494 Test Acc: 0.924
Validation loss decreased (-0.737823 --> -0.924319).  Saving model ...
Epoch: 4 cost time: 2.14389967918396
Epoch: 4, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.298 Vali Acc: 0.914 Test Loss: 0.298 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8870420455932617
Epoch: 5, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 2.396284580230713
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1593050956726074
Epoch: 7, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.924322 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.871415376663208
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2889564037323
Epoch: 9, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.448 Vali Acc: 0.854 Test Loss: 0.448 Test Acc: 0.854
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3432304859161377
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.221 Vali Acc: 0.927 Test Loss: 0.221 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3198695182800293
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.463010787963867
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 2.219905138015747
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3716204166412354
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.090 Vali Acc: 0.962 Test Loss: 0.090 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2880778312683105
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.43050479888916
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1540067195892334
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.932 Test Loss: 0.195 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.307995080947876
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4988510608673096
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.375845193862915
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3471574783325195
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.171652317047119
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.34686017036438
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.295647144317627
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1171398162841797
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 8365881
model size : 36.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.226701021194458
Epoch: 1, Steps: 17 | Train Loss: 2.265 Vali Loss: 2.230 Vali Acc: 0.281 Test Loss: 2.230 Test Acc: 0.281
Validation loss decreased (inf --> -0.281059).  Saving model ...
Epoch: 2 cost time: 2.17437744140625
Epoch: 2, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.446 Vali Acc: 0.516 Test Loss: 1.446 Test Acc: 0.516
Validation loss decreased (-0.281059 --> -0.516202).  Saving model ...
Epoch: 3 cost time: 2.1039047241210938
Epoch: 3, Steps: 17 | Train Loss: 1.031 Vali Loss: 0.543 Vali Acc: 0.911 Test Loss: 0.543 Test Acc: 0.911
Validation loss decreased (-0.516202 --> -0.910805).  Saving model ...
Epoch: 4 cost time: 2.4047601222991943
Epoch: 4, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
Validation loss decreased (-0.910805 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 2.305453300476074
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.239 Vali Acc: 0.938 Test Loss: 0.239 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 2.371103525161743
Epoch: 6, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.170 Vali Acc: 0.938 Test Loss: 0.170 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 1.9954426288604736
Epoch: 7, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.278346300125122
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2589962482452393
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.937836 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 2.3276724815368652
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.195 Vali Acc: 0.924 Test Loss: 0.195 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5418941974639893
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.166 Vali Acc: 0.932 Test Loss: 0.166 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6508986949920654
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.941 Test Loss: 0.138 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2529873847961426
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1529171466827393
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.954053 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.5929675102233887
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2468645572662354
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.935 Test Loss: 0.162 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.194732189178467
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.056309461593628
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8998639583587646
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.924 Test Loss: 0.242 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0503122806549072
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.214935302734375
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1951208114624023
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.485031843185425
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4313201904296875
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 7910841
model size : 35.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.842982530593872
Epoch: 1, Steps: 17 | Train Loss: 2.294 Vali Loss: 1.984 Vali Acc: 0.197 Test Loss: 1.984 Test Acc: 0.197
Validation loss decreased (inf --> -0.197277).  Saving model ...
Epoch: 2 cost time: 2.2921571731567383
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.431 Vali Acc: 0.657 Test Loss: 1.431 Test Acc: 0.657
Validation loss decreased (-0.197277 --> -0.656742).  Saving model ...
Epoch: 3 cost time: 2.322378158569336
Epoch: 3, Steps: 17 | Train Loss: 1.112 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
Validation loss decreased (-0.656742 --> -0.840534).  Saving model ...
Epoch: 4 cost time: 2.106456995010376
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
Validation loss decreased (-0.840534 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 2.4366612434387207
Epoch: 5, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.228 Vali Acc: 0.905 Test Loss: 0.228 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3830435276031494
Epoch: 6, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943242).  Saving model ...
Epoch: 7 cost time: 2.3176002502441406
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 2.4144463539123535
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.175370931625366
Epoch: 9, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5525848865509033
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.177694797515869
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.941 Test Loss: 0.138 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.870577335357666
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9240236282348633
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 2.1832337379455566
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.067214250564575
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.8885014057159424
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.945523977279663
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.264 Vali Acc: 0.908 Test Loss: 0.264 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9716567993164062
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9419045448303223
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.009035110473633
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.179089069366455
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8958697319030762
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9116945266723633
Epoch: 23, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.375 Vali Acc: 0.868 Test Loss: 0.375 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0361645221710205
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.217 Vali Acc: 0.924 Test Loss: 0.217 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.057568311691284
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 7909305
model size : 35.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.116451740264893
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.050 Vali Acc: 0.095 Test Loss: 2.050 Test Acc: 0.095
Validation loss decreased (inf --> -0.094574).  Saving model ...
Epoch: 2 cost time: 2.038999557495117
Epoch: 2, Steps: 17 | Train Loss: 1.724 Vali Loss: 1.339 Vali Acc: 0.659 Test Loss: 1.339 Test Acc: 0.659
Validation loss decreased (-0.094574 --> -0.659446).  Saving model ...
Epoch: 3 cost time: 2.0855140686035156
Epoch: 3, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.463 Vali Acc: 0.922 Test Loss: 0.463 Test Acc: 0.922
Validation loss decreased (-0.659446 --> -0.921617).  Saving model ...
Epoch: 4 cost time: 2.059427261352539
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.514 Vali Acc: 0.846 Test Loss: 0.514 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4432742595672607
Epoch: 5, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.921617 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 2.0452258586883545
Epoch: 6, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0749435424804688
Epoch: 7, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.908 Test Loss: 0.289 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3337767124176025
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9723918437957764
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.169282913208008
Epoch: 10, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.000311851501465
Epoch: 11, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.293107509613037
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 13 cost time: 1.9588432312011719
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.943 Test Loss: 0.133 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.849710464477539
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.265 Vali Acc: 0.914 Test Loss: 0.265 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.123142719268799
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3537676334381104
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.009472608566284
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 2.0985727310180664
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0662922859191895
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.028773546218872
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.237295627593994
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2212626934051514
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.280128240585327
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1970221996307373
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9259326457977295
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0033071041107178
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1093297004699707
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 7907769
model size : 35.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.409297227859497
Epoch: 1, Steps: 17 | Train Loss: 2.248 Vali Loss: 2.069 Vali Acc: 0.200 Test Loss: 2.069 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 2.010087490081787
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.417 Vali Acc: 0.641 Test Loss: 1.417 Test Acc: 0.641
Validation loss decreased (-0.199979 --> -0.640526).  Saving model ...
Epoch: 3 cost time: 2.415811777114868
Epoch: 3, Steps: 17 | Train Loss: 1.042 Vali Loss: 0.669 Vali Acc: 0.808 Test Loss: 0.669 Test Acc: 0.808
Validation loss decreased (-0.640526 --> -0.808101).  Saving model ...
Epoch: 4 cost time: 2.9104697704315186
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
Validation loss decreased (-0.808101 --> -0.840536).  Saving model ...
Epoch: 5 cost time: 2.1896305084228516
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.840536 --> -0.910808).  Saving model ...
Epoch: 6 cost time: 2.3898632526397705
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.910808 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 2.6247758865356445
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.552995204925537
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 9 cost time: 2.271090030670166
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.956756 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.9180445671081543
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.951 Test Loss: 0.109 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6642661094665527
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.394077777862549
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.394 Vali Acc: 0.873 Test Loss: 0.394 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1439740657806396
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5054495334625244
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5191023349761963
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5375986099243164
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.962 Test Loss: 0.089 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1974964141845703
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.372650384902954
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5605499744415283
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 7906233
model size : 35.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.244686126708984
Epoch: 1, Steps: 17 | Train Loss: 2.289 Vali Loss: 2.059 Vali Acc: 0.278 Test Loss: 2.059 Test Acc: 0.278
Validation loss decreased (inf --> -0.278358).  Saving model ...
Epoch: 2 cost time: 2.4141907691955566
Epoch: 2, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.659 Vali Acc: 0.578 Test Loss: 1.659 Test Acc: 0.578
Validation loss decreased (-0.278358 --> -0.578362).  Saving model ...
Epoch: 3 cost time: 2.227586269378662
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 0.869 Vali Acc: 0.878 Test Loss: 0.869 Test Acc: 0.878
Validation loss decreased (-0.578362 --> -0.878370).  Saving model ...
Epoch: 4 cost time: 2.1925270557403564
Epoch: 4, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.416 Vali Acc: 0.916 Test Loss: 0.416 Test Acc: 0.916
Validation loss decreased (-0.878370 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 2.62494158744812
Epoch: 5, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4523000717163086
Epoch: 6, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.234 Vali Acc: 0.927 Test Loss: 0.234 Test Acc: 0.927
Validation loss decreased (-0.916212 --> -0.927025).  Saving model ...
Epoch: 7 cost time: 2.147231101989746
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
Validation loss decreased (-0.927025 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 2.8375842571258545
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 2.114572525024414
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4760210514068604
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.323638916015625
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 2.404290199279785
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5344972610473633
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.242421865463257
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2881267070770264
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2830922603607178
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.927 Test Loss: 0.191 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.197293281555176
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1198744773864746
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 2.3388147354125977
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.134077787399292
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0783329010009766
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.621964931488037
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3970158100128174
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.129889965057373
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.134861707687378
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.31276798248291
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.5943362712860107
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.602452039718628
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3732793
model size : 16.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.45638370513916
Epoch: 1, Steps: 17 | Train Loss: 2.277 Vali Loss: 2.065 Vali Acc: 0.324 Test Loss: 2.065 Test Acc: 0.324
Validation loss decreased (inf --> -0.324304).  Saving model ...
Epoch: 2 cost time: 2.3301117420196533
Epoch: 2, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.739 Vali Acc: 0.568 Test Loss: 1.739 Test Acc: 0.568
Validation loss decreased (-0.324304 --> -0.567550).  Saving model ...
Epoch: 3 cost time: 2.2469491958618164
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 0.955 Vali Acc: 0.827 Test Loss: 0.955 Test Acc: 0.827
Validation loss decreased (-0.567550 --> -0.827017).  Saving model ...
Epoch: 4 cost time: 2.525775671005249
Epoch: 4, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
Validation loss decreased (-0.827017 --> -0.910807).  Saving model ...
Epoch: 5 cost time: 2.4476711750030518
Epoch: 5, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.283 Vali Acc: 0.924 Test Loss: 0.283 Test Acc: 0.924
Validation loss decreased (-0.910807 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 2.2306056022644043
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.924321 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 1.911466360092163
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6898996829986572
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.557053804397583
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 2.41074800491333
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 2.14849853515625
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.5021519660949707
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.425997495651245
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.423081874847412
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.235719680786133
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5523769855499268
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6552884578704834
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2830469608306885
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0524232387542725
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.260357141494751
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.270453929901123
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 2.376736879348755
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.458606719970703
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1304047107696533
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 2.6755783557891846
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6220104694366455
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.414006233215332
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.965 Test Loss: 0.089 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.453012466430664
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9793899059295654
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 30 cost time: 2.554725170135498
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.059283971786499
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.5943777561187744
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.529404640197754
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.959 Test Loss: 0.099 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.366162061691284
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.1698243618011475
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.423279285430908
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.030407428741455
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.4913148880004883
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.2908239364624023
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 3732025
model size : 16.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.952213764190674
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.230 Vali Acc: 0.089 Test Loss: 2.230 Test Acc: 0.089
Validation loss decreased (inf --> -0.089167).  Saving model ...
Epoch: 2 cost time: 2.4553170204162598
Epoch: 2, Steps: 17 | Train Loss: 2.039 Vali Loss: 1.604 Vali Acc: 0.676 Test Loss: 1.604 Test Acc: 0.676
Validation loss decreased (-0.089167 --> -0.675660).  Saving model ...
Epoch: 3 cost time: 2.4916346073150635
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 0.835 Vali Acc: 0.846 Test Loss: 0.835 Test Acc: 0.846
Validation loss decreased (-0.675660 --> -0.845938).  Saving model ...
Epoch: 4 cost time: 2.4064605236053467
Epoch: 4, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.401 Vali Acc: 0.916 Test Loss: 0.401 Test Acc: 0.916
Validation loss decreased (-0.845938 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 2.805274248123169
Epoch: 5, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 2.1364407539367676
Epoch: 6, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.924321 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 2.1640048027038574
Epoch: 7, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 2.1306471824645996
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.318251609802246
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.8936688899993896
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3404624462127686
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5206522941589355
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3177521228790283
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0091400146484375
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.260 Vali Acc: 0.905 Test Loss: 0.260 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0088741779327393
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.290339708328247
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.227898359298706
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1890296936035156
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 2.0539565086364746
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 2.340893268585205
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.123405933380127
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 2.3386247158050537
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.282038927078247
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.445891857147217
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.02138614654541
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9440441131591797
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 2.475386142730713
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2279129028320312
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.378749370574951
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2187728881835938
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2980141639709473
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1582067012786865
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9994313716888428
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.6144371032714844
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 2.189976215362549
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.133740186691284
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.3069469928741455
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.6439764499664307
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.0319342613220215
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.7056939601898193
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.046910524368286
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 2.452096939086914
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.6710705757141113
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.3453891277313232
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.5853381156921387
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.363332986831665
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.7300167083740234
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.418492555618286
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.4994025230407715
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.624465227127075
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.0390734672546387
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3731257
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.302480459213257
Epoch: 1, Steps: 17 | Train Loss: 2.312 Vali Loss: 2.137 Vali Acc: 0.378 Test Loss: 2.137 Test Acc: 0.378
Validation loss decreased (inf --> -0.378357).  Saving model ...
Epoch: 2 cost time: 2.3765015602111816
Epoch: 2, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.709 Vali Acc: 0.451 Test Loss: 1.709 Test Acc: 0.451
Validation loss decreased (-0.378357 --> -0.451334).  Saving model ...
Epoch: 3 cost time: 2.640498638153076
Epoch: 3, Steps: 17 | Train Loss: 1.387 Vali Loss: 0.875 Vali Acc: 0.851 Test Loss: 0.875 Test Acc: 0.851
Validation loss decreased (-0.451334 --> -0.851343).  Saving model ...
Epoch: 4 cost time: 2.083530902862549
Epoch: 4, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.416 Vali Acc: 0.914 Test Loss: 0.416 Test Acc: 0.914
Validation loss decreased (-0.851343 --> -0.913509).  Saving model ...
Epoch: 5 cost time: 2.424712896347046
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.257 Vali Acc: 0.938 Test Loss: 0.257 Test Acc: 0.938
Validation loss decreased (-0.913509 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 2.068427801132202
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 2.377638339996338
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4333255290985107
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2205898761749268
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5059738159179688
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 2.0166738033294678
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 2.42928409576416
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.415302038192749
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.181 Vali Acc: 0.932 Test Loss: 0.181 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.953963041305542
Epoch: 14, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.169 Vali Acc: 0.938 Test Loss: 0.169 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2876760959625244
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.013232469558716
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2890663146972656
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3499207496643066
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 2.6263604164123535
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.957 Test Loss: 0.103 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1485249996185303
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.151728868484497
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 2.424269676208496
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1760852336883545
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.207662582397461
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4447779655456543
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.10239315032959
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.558077573776245
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.392824172973633
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4659829139709473
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2757396697998047
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.3277173042297363
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 3730489
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.799820899963379
Epoch: 1, Steps: 17 | Train Loss: 2.305 Vali Loss: 2.158 Vali Acc: 0.303 Test Loss: 2.158 Test Acc: 0.303
Validation loss decreased (inf --> -0.302681).  Saving model ...
Epoch: 2 cost time: 2.3206605911254883
Epoch: 2, Steps: 17 | Train Loss: 1.999 Vali Loss: 1.669 Vali Acc: 0.589 Test Loss: 1.669 Test Acc: 0.589
Validation loss decreased (-0.302681 --> -0.589172).  Saving model ...
Epoch: 3 cost time: 2.2053885459899902
Epoch: 3, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.211 Vali Acc: 0.724 Test Loss: 1.211 Test Acc: 0.724
Validation loss decreased (-0.589172 --> -0.724312).  Saving model ...
Epoch: 4 cost time: 2.1477224826812744
Epoch: 4, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.537 Vali Acc: 0.884 Test Loss: 0.537 Test Acc: 0.884
Validation loss decreased (-0.724312 --> -0.883778).  Saving model ...
Epoch: 5 cost time: 2.18003511428833
Epoch: 5, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.391 Vali Acc: 0.908 Test Loss: 0.391 Test Acc: 0.908
Validation loss decreased (-0.883778 --> -0.908104).  Saving model ...
Epoch: 6 cost time: 2.476463794708252
Epoch: 6, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.908104 --> -0.921619).  Saving model ...
Epoch: 7 cost time: 2.289708375930786
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.203 Vali Acc: 0.938 Test Loss: 0.203 Test Acc: 0.938
Validation loss decreased (-0.921619 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 1.9458179473876953
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.937836 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 2.73787522315979
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.351616859436035
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4399149417877197
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3540194034576416
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.199 Vali Acc: 0.927 Test Loss: 0.199 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.070106029510498
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0491373538970947
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1887624263763428
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4505093097686768
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 17 cost time: 2.3373379707336426
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.246459722518921
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.978377 --> -0.983783).  Saving model ...
Epoch: 19 cost time: 2.2151551246643066
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1770944595336914
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2045648097991943
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 22 cost time: 2.128767728805542
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.498492956161499
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.359691619873047
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.102285146713257
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.131174087524414
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4073071479797363
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.165877103805542
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9776396751403809
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.689338207244873
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.5461490154266357
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 2811705
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.02928614616394
Epoch: 1, Steps: 17 | Train Loss: 2.280 Vali Loss: 2.175 Vali Acc: 0.127 Test Loss: 2.175 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 2.447160005569458
Epoch: 2, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.791 Vali Acc: 0.449 Test Loss: 1.791 Test Acc: 0.449
Validation loss decreased (-0.127005 --> -0.448631).  Saving model ...
Epoch: 3 cost time: 2.160435914993286
Epoch: 3, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.154 Vali Acc: 0.692 Test Loss: 1.154 Test Acc: 0.692
Validation loss decreased (-0.448631 --> -0.691880).  Saving model ...
Epoch: 4 cost time: 2.3364312648773193
Epoch: 4, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.595 Vali Acc: 0.870 Test Loss: 0.595 Test Acc: 0.870
Validation loss decreased (-0.691880 --> -0.870264).  Saving model ...
Epoch: 5 cost time: 2.1427807807922363
Epoch: 5, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.351 Vali Acc: 0.932 Test Loss: 0.351 Test Acc: 0.932
Validation loss decreased (-0.870264 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 2.4841465950012207
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 2.3215901851654053
Epoch: 7, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.260 Vali Acc: 0.924 Test Loss: 0.260 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.783010244369507
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.932430 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 2.4477081298828125
Epoch: 9, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2790589332580566
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2705237865448
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3798975944519043
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.210 Vali Acc: 0.932 Test Loss: 0.210 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.408186674118042
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.247390031814575
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.932 Test Loss: 0.188 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2688417434692383
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.606811761856079
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.515803813934326
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3782200813293457
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 2810937
model size : 13.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6962132453918457
Epoch: 1, Steps: 17 | Train Loss: 2.299 Vali Loss: 2.141 Vali Acc: 0.343 Test Loss: 2.141 Test Acc: 0.343
Validation loss decreased (inf --> -0.343222).  Saving model ...
Epoch: 2 cost time: 2.0472264289855957
Epoch: 2, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.789 Vali Acc: 0.589 Test Loss: 1.789 Test Acc: 0.589
Validation loss decreased (-0.343222 --> -0.589171).  Saving model ...
Epoch: 3 cost time: 2.1728310585021973
Epoch: 3, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.179 Vali Acc: 0.697 Test Loss: 1.179 Test Acc: 0.697
Validation loss decreased (-0.589171 --> -0.697286).  Saving model ...
Epoch: 4 cost time: 2.053013563156128
Epoch: 4, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.565 Vali Acc: 0.881 Test Loss: 0.565 Test Acc: 0.881
Validation loss decreased (-0.697286 --> -0.881075).  Saving model ...
Epoch: 5 cost time: 2.0919244289398193
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.321 Vali Acc: 0.916 Test Loss: 0.321 Test Acc: 0.916
Validation loss decreased (-0.881075 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 1.9740793704986572
Epoch: 6, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.302 Vali Acc: 0.905 Test Loss: 0.302 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.214852809906006
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
Validation loss decreased (-0.916213 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.201918363571167
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.948647 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 1.968393087387085
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2222697734832764
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1686642169952393
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2069709300994873
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.226 Vali Acc: 0.927 Test Loss: 0.226 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.326901912689209
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1653800010681152
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 2.071634531021118
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 2.18845534324646
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4343817234039307
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 2.5675010681152344
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 1.8911921977996826
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3834550380706787
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1252548694610596
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0382533073425293
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2330546379089355
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.616640090942383
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7403669357299805
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.5264785289764404
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.265 Vali Acc: 0.932 Test Loss: 0.265 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.077624559402466
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3773436546325684
Epoch: 28, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2810169
model size : 13.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.045109748840332
Epoch: 1, Steps: 17 | Train Loss: 2.297 Vali Loss: 2.083 Vali Acc: 0.165 Test Loss: 2.083 Test Acc: 0.165
Validation loss decreased (inf --> -0.164844).  Saving model ...
Epoch: 2 cost time: 2.284811019897461
Epoch: 2, Steps: 17 | Train Loss: 2.021 Vali Loss: 1.734 Vali Acc: 0.586 Test Loss: 1.734 Test Acc: 0.586
Validation loss decreased (-0.164844 --> -0.586469).  Saving model ...
Epoch: 3 cost time: 2.1852455139160156
Epoch: 3, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.104 Vali Acc: 0.711 Test Loss: 1.104 Test Acc: 0.711
Validation loss decreased (-0.586469 --> -0.710800).  Saving model ...
Epoch: 4 cost time: 2.284630060195923
Epoch: 4, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.710800 --> -0.899995).  Saving model ...
Epoch: 5 cost time: 2.1458632946014404
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.921618).  Saving model ...
Epoch: 6 cost time: 2.3982884883880615
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.301 Vali Acc: 0.927 Test Loss: 0.301 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 7 cost time: 2.110478162765503
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 2.0409796237945557
Epoch: 8, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.057842493057251
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 2.4061455726623535
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9215188026428223
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 3.6047515869140625
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.584827423095703
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.78045392036438
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 2.46667218208313
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4292399883270264
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 2.9683456420898438
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.037734031677246
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2712056636810303
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.840993881225586
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.331557273864746
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0233867168426514
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.582653284072876
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6224162578582764
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 2.90163254737854
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8662526607513428
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4080970287323
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4120423793792725
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.578049421310425
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5061066150665283
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.5172553062438965
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.7156553268432617
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.5356173515319824
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.4470396041870117
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2809401
model size : 13.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.3784894943237305
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.069 Vali Acc: 0.230 Test Loss: 2.069 Test Acc: 0.230
Validation loss decreased (inf --> -0.229709).  Saving model ...
Epoch: 2 cost time: 2.2907004356384277
Epoch: 2, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.793 Vali Acc: 0.530 Test Loss: 1.793 Test Acc: 0.530
Validation loss decreased (-0.229709 --> -0.529712).  Saving model ...
Epoch: 3 cost time: 2.2432069778442383
Epoch: 3, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.002 Vali Acc: 0.886 Test Loss: 1.002 Test Acc: 0.886
Validation loss decreased (-0.529712 --> -0.886476).  Saving model ...
Epoch: 4 cost time: 2.9308507442474365
Epoch: 4, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.484 Vali Acc: 0.919 Test Loss: 0.484 Test Acc: 0.919
Validation loss decreased (-0.886476 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.4731380939483643
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.387 Vali Acc: 0.892 Test Loss: 0.387 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2226552963256836
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921619).  Saving model ...
Epoch: 7 cost time: 2.73803448677063
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929728).  Saving model ...
Epoch: 8 cost time: 2.944105625152588
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.929728 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 2.4135234355926514
Epoch: 9, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.297680616378784
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.271 Vali Acc: 0.916 Test Loss: 0.271 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.684821605682373
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 2.205796480178833
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3789358139038086
Epoch: 13, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.174717664718628
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2829577922821045
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.156 Vali Acc: 0.938 Test Loss: 0.156 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.166560173034668
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.954 Test Loss: 0.108 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.605882406234741
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1361095905303955
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 2.2108280658721924
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2454655170440674
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 2.597377300262451
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.954 Test Loss: 0.104 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3463056087493896
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1170976161956787
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 2.14380145072937
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.951 Test Loss: 0.114 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6382856369018555
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.5916588306427
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2740485668182373
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2256293296813965
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.957 Test Loss: 0.099 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.5386738777160645
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 2.632005453109741
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.452014446258545
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.0367069244384766
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.387108564376831
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2979891300201416
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.813343048095703
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.6268115043640137
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.965 Test Loss: 0.089 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.2821640968322754
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.258267641067505
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.4120266437530518
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 40 cost time: 2.18876576423645
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.5686209201812744
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4445784091949463
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.581275463104248
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.4923861026763916
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.557370185852051
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.572857618331909
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.959 Test Loss: 0.096 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.8606793880462646
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.9021637439727783
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.765596628189087
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2351161
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.038235425949097
Epoch: 1, Steps: 17 | Train Loss: 2.258 Vali Loss: 2.118 Vali Acc: 0.151 Test Loss: 2.118 Test Acc: 0.151
Validation loss decreased (inf --> -0.151330).  Saving model ...
Epoch: 2 cost time: 2.2759666442871094
Epoch: 2, Steps: 17 | Train Loss: 2.052 Vali Loss: 1.783 Vali Acc: 0.397 Test Loss: 1.783 Test Acc: 0.397
Validation loss decreased (-0.151330 --> -0.397279).  Saving model ...
Epoch: 3 cost time: 2.019453287124634
Epoch: 3, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.200 Vali Acc: 0.849 Test Loss: 1.200 Test Acc: 0.849
Validation loss decreased (-0.397279 --> -0.848637).  Saving model ...
Epoch: 4 cost time: 2.1806182861328125
Epoch: 4, Steps: 17 | Train Loss: 0.869 Vali Loss: 0.575 Vali Acc: 0.884 Test Loss: 0.575 Test Acc: 0.884
Validation loss decreased (-0.848637 --> -0.883778).  Saving model ...
Epoch: 5 cost time: 1.9572930335998535
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
Validation loss decreased (-0.883778 --> -0.943240).  Saving model ...
Epoch: 6 cost time: 2.062952995300293
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.12502384185791
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5564775466918945
Epoch: 8, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 2.179598093032837
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.97987961769104
Epoch: 10, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.181781768798828
Epoch: 11, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8592522144317627
Epoch: 12, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 2.30540132522583
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 2.0902390480041504
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.0766143798828125
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.166024684906006
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0632779598236084
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.94252610206604
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1974315643310547
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1590075492858887
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.395932912826538
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.094130516052246
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9501731395721436
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9546735286712646
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.0818355083465576
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2949819564819336
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2592880725860596
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.356283664703369
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.187542676925659
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.463864326477051
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2219111919403076
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2030234336853027
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.082942247390747
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.294818162918091
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2350393
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.289527177810669
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.123 Vali Acc: 0.168 Test Loss: 2.123 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 1.9524121284484863
Epoch: 2, Steps: 17 | Train Loss: 2.011 Vali Loss: 1.735 Vali Acc: 0.484 Test Loss: 1.735 Test Acc: 0.484
Validation loss decreased (-0.167546 --> -0.483766).  Saving model ...
Epoch: 3 cost time: 2.0991134643554688
Epoch: 3, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.142 Vali Acc: 0.770 Test Loss: 1.142 Test Acc: 0.770
Validation loss decreased (-0.483766 --> -0.770259).  Saving model ...
Epoch: 4 cost time: 1.8945178985595703
Epoch: 4, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.514 Vali Acc: 0.919 Test Loss: 0.514 Test Acc: 0.919
Validation loss decreased (-0.770259 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.081908702850342
Epoch: 5, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.247042417526245
Epoch: 6, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.218 Vali Acc: 0.924 Test Loss: 0.218 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924322).  Saving model ...
Epoch: 7 cost time: 2.517502784729004
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 2.0989813804626465
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.245 Vali Acc: 0.916 Test Loss: 0.245 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1261725425720215
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 2.29293155670166
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 2.2884395122528076
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0275259017944336
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.237567901611328
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0744681358337402
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.87386155128479
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9894695281982422
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.641765594482422
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.234513998031616
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5310394763946533
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.200172185897827
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.943 Test Loss: 0.127 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.197385787963867
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.938 Test Loss: 0.138 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9883205890655518
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3987417221069336
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.15616512298584
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.024453639984131
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.321549654006958
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8613932132720947
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2349625
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.033034324645996
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.095 Vali Acc: 0.181 Test Loss: 2.095 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 2.0108025074005127
Epoch: 2, Steps: 17 | Train Loss: 2.018 Vali Loss: 1.692 Vali Acc: 0.608 Test Loss: 1.692 Test Acc: 0.608
Validation loss decreased (-0.181060 --> -0.608091).  Saving model ...
Epoch: 3 cost time: 2.1111576557159424
Epoch: 3, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.387 Vali Acc: 0.519 Test Loss: 1.387 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3534512519836426
Epoch: 4, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.575 Vali Acc: 0.895 Test Loss: 0.575 Test Acc: 0.895
Validation loss decreased (-0.608091 --> -0.894589).  Saving model ...
Epoch: 5 cost time: 2.2428667545318604
Epoch: 5, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.894589 --> -0.902699).  Saving model ...
Epoch: 6 cost time: 2.481044292449951
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
Validation loss decreased (-0.902699 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 2.7682790756225586
Epoch: 7, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.689615488052368
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 2.3380978107452393
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.755255699157715
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.492158889770508
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5464794635772705
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.669975519180298
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.397840976715088
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.306 Vali Acc: 0.892 Test Loss: 0.306 Test Acc: 0.892
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4851715564727783
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4012372493743896
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.74688982963562
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.271411418914795
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 2348857
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.237011432647705
Epoch: 1, Steps: 17 | Train Loss: 2.289 Vali Loss: 2.239 Vali Acc: 0.208 Test Loss: 2.239 Test Acc: 0.208
Validation loss decreased (inf --> -0.208086).  Saving model ...
Epoch: 2 cost time: 2.823742628097534
Epoch: 2, Steps: 17 | Train Loss: 2.140 Vali Loss: 1.939 Vali Acc: 0.424 Test Loss: 1.939 Test Acc: 0.424
Validation loss decreased (-0.208086 --> -0.424305).  Saving model ...
Epoch: 3 cost time: 2.5532078742980957
Epoch: 3, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.585 Vali Acc: 0.641 Test Loss: 1.585 Test Acc: 0.641
Validation loss decreased (-0.424305 --> -0.640525).  Saving model ...
Epoch: 4 cost time: 2.126105785369873
Epoch: 4, Steps: 17 | Train Loss: 1.177 Vali Loss: 0.767 Vali Acc: 0.895 Test Loss: 0.767 Test Acc: 0.895
Validation loss decreased (-0.640525 --> -0.894587).  Saving model ...
Epoch: 5 cost time: 2.1409285068511963
Epoch: 5, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.385 Vali Acc: 0.938 Test Loss: 0.385 Test Acc: 0.938
Validation loss decreased (-0.894587 --> -0.937834).  Saving model ...
Epoch: 6 cost time: 2.2261862754821777
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 2.42805814743042
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.267195463180542
Epoch: 8, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.937835 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 2.0312387943267822
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.172 Vali Acc: 0.932 Test Loss: 0.172 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.148033380508423
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2228715419769287
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 2.1729626655578613
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 2.3237266540527344
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2772459983825684
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 2.313217878341675
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1150128841400146
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.1073076725006104
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5009384155273438
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1395392417907715
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 20 cost time: 1.9156270027160645
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1385905742645264
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.19987416267395
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.230952739715576
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 24 cost time: 2.074841260910034
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9433889389038086
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.226713180541992
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1853315830230713
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1882805824279785
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1200311183929443
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.959 Test Loss: 0.086 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.214097738265991
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 31 cost time: 2.248547315597534
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.100595712661743
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.114156484603882
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.013007164001465
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.2897934913635254
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.1466567516326904
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.205338716506958
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.973278284072876
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9368762969970703
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.1400763988494873
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2120889
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9388427734375
Epoch: 1, Steps: 17 | Train Loss: 2.299 Vali Loss: 2.156 Vali Acc: 0.138 Test Loss: 2.156 Test Acc: 0.138
Validation loss decreased (inf --> -0.137816).  Saving model ...
Epoch: 2 cost time: 2.5929739475250244
Epoch: 2, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.880 Vali Acc: 0.489 Test Loss: 1.880 Test Acc: 0.489
Validation loss decreased (-0.137816 --> -0.489170).  Saving model ...
Epoch: 3 cost time: 2.3563666343688965
Epoch: 3, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.479 Vali Acc: 0.673 Test Loss: 1.479 Test Acc: 0.673
Validation loss decreased (-0.489170 --> -0.672958).  Saving model ...
Epoch: 4 cost time: 2.2535359859466553
Epoch: 4, Steps: 17 | Train Loss: 0.978 Vali Loss: 0.619 Vali Acc: 0.892 Test Loss: 0.619 Test Acc: 0.892
Validation loss decreased (-0.672958 --> -0.891886).  Saving model ...
Epoch: 5 cost time: 2.047839403152466
Epoch: 5, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.831409215927124
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
Validation loss decreased (-0.891886 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 2.2902626991271973
Epoch: 7, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
Validation loss decreased (-0.937835 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 2.308406114578247
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9428951740264893
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0633294582366943
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1694045066833496
Epoch: 11, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.503377914428711
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.081509828567505
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6806554794311523
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.956755 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.723825454711914
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6228420734405518
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3651163578033447
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.618298053741455
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7987465858459473
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.325671911239624
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2013018131256104
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1583874225616455
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6212687492370605
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.855931520462036
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.246107816696167
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.364778757095337
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.528409004211426
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2120121
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.864709854125977
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.118 Vali Acc: 0.214 Test Loss: 2.118 Test Acc: 0.214
Validation loss decreased (inf --> -0.213492).  Saving model ...
Epoch: 2 cost time: 2.2931838035583496
Epoch: 2, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.848 Vali Acc: 0.473 Test Loss: 1.848 Test Acc: 0.473
Validation loss decreased (-0.213492 --> -0.472954).  Saving model ...
Epoch: 3 cost time: 2.0792551040649414
Epoch: 3, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.359 Vali Acc: 0.622 Test Loss: 1.359 Test Acc: 0.622
Validation loss decreased (-0.472954 --> -0.621608).  Saving model ...
Epoch: 4 cost time: 2.707473039627075
Epoch: 4, Steps: 17 | Train Loss: 1.039 Vali Loss: 0.750 Vali Acc: 0.857 Test Loss: 0.750 Test Acc: 0.857
Validation loss decreased (-0.621608 --> -0.856749).  Saving model ...
Epoch: 5 cost time: 2.7369649410247803
Epoch: 5, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.532 Vali Acc: 0.824 Test Loss: 0.532 Test Acc: 0.824
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2805287837982178
Epoch: 6, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.280 Vali Acc: 0.914 Test Loss: 0.280 Test Acc: 0.914
Validation loss decreased (-0.856749 --> -0.913511).  Saving model ...
Epoch: 7 cost time: 2.405507802963257
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.243 Vali Acc: 0.908 Test Loss: 0.243 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5441954135894775
Epoch: 8, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.913511 --> -0.943242).  Saving model ...
Epoch: 9 cost time: 2.0912489891052246
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3578782081604004
Epoch: 10, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.874284029006958
Epoch: 11, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 2.230628252029419
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2032344341278076
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.954053 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 2.0103516578674316
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0718116760253906
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2203903198242188
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.3074066638946533
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 2.134030342102051
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0145461559295654
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9915814399719238
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.957 Test Loss: 0.094 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.398068904876709
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 2.295483112335205
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.959 Test Loss: 0.099 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2637109756469727
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.997004508972168
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.954 Test Loss: 0.102 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.113266706466675
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.165090799331665
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.959 Test Loss: 0.094 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0053679943084717
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9871337413787842
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.116816520690918
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.951 Test Loss: 0.111 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.346158981323242
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 2.4236671924591064
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4834001064300537
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.238248109817505
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.959 Test Loss: 0.095 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.4360976219177246
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3713958263397217
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.2186269760131836
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.2118067741394043
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.407586097717285
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.3528223037719727
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.3179614543914795
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2119353
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.025941610336304
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.148 Vali Acc: 0.243 Test Loss: 2.148 Test Acc: 0.243
Validation loss decreased (inf --> -0.243222).  Saving model ...
Epoch: 2 cost time: 2.423600912094116
Epoch: 2, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.688 Vali Acc: 0.584 Test Loss: 1.688 Test Acc: 0.584
Validation loss decreased (-0.243222 --> -0.583767).  Saving model ...
Epoch: 3 cost time: 2.427772283554077
Epoch: 3, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.073 Vali Acc: 0.868 Test Loss: 1.073 Test Acc: 0.868
Validation loss decreased (-0.583767 --> -0.867557).  Saving model ...
Epoch: 4 cost time: 2.165018320083618
Epoch: 4, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.045398235321045
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
Validation loss decreased (-0.867557 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 2.2781386375427246
Epoch: 6, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
Validation loss decreased (-0.924321 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 2.0131607055664062
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.0546064376831055
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.2871451377868652
Epoch: 9, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.223395347595215
Epoch: 10, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.182 Vali Acc: 0.927 Test Loss: 0.182 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5685834884643555
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 2.280862808227539
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.593177556991577
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 2.1803958415985107
Epoch: 14, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.157696485519409
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.15912127494812
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6288678646087646
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.335902214050293
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2988576889038086
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.925590991973877
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2975146770477295
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 2.356701612472534
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.147857427597046
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2765731811523438
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2005813121795654
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1299431324005127
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.234767198562622
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1776161193847656
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3352110385894775
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.3326358795166016
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0803089141845703
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2118585
model size : 10.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7553598880767822
Epoch: 1, Steps: 17 | Train Loss: 2.237 Vali Loss: 2.179 Vali Acc: 0.159 Test Loss: 2.179 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 2.012028455734253
Epoch: 2, Steps: 17 | Train Loss: 2.103 Vali Loss: 2.012 Vali Acc: 0.305 Test Loss: 2.012 Test Acc: 0.305
Validation loss decreased (-0.159438 --> -0.305385).  Saving model ...
Epoch: 3 cost time: 2.055805206298828
Epoch: 3, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.478 Vali Acc: 0.786 Test Loss: 1.478 Test Acc: 0.786
Validation loss decreased (-0.305385 --> -0.786472).  Saving model ...
Epoch: 4 cost time: 2.2290375232696533
Epoch: 4, Steps: 17 | Train Loss: 1.244 Vali Loss: 0.922 Vali Acc: 0.868 Test Loss: 0.922 Test Acc: 0.868
Validation loss decreased (-0.786472 --> -0.867558).  Saving model ...
Epoch: 5 cost time: 1.968214988708496
Epoch: 5, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.577 Vali Acc: 0.876 Test Loss: 0.577 Test Acc: 0.876
Validation loss decreased (-0.867558 --> -0.875670).  Saving model ...
Epoch: 6 cost time: 2.078838348388672
Epoch: 6, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.875670 --> -0.910807).  Saving model ...
Epoch: 7 cost time: 1.8760628700256348
Epoch: 7, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.277 Vali Acc: 0.943 Test Loss: 0.277 Test Acc: 0.943
Validation loss decreased (-0.910807 --> -0.943240).  Saving model ...
Epoch: 8 cost time: 2.1946208477020264
Epoch: 8, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.322 Vali Acc: 0.916 Test Loss: 0.322 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.391561269760132
Epoch: 9, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0638060569763184
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.204 Vali Acc: 0.916 Test Loss: 0.204 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.173572301864624
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 2.208786725997925
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.284590721130371
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4394242763519287
Epoch: 14, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 2.1297600269317627
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.160250425338745
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2233641147613525
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.130375623703003
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.207097291946411
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1957592964172363
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.202162027359009
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7611470222473145
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4804811477661133
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4247689247131348
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.155243396759033
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.517134666442871
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.951 Test Loss: 0.114 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1656668186187744
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4507975578308105
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3835654258728027
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.943 Test Loss: 0.125 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.414593458175659
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1411257
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.283923387527466
Epoch: 1, Steps: 17 | Train Loss: 2.241 Vali Loss: 2.105 Vali Acc: 0.149 Test Loss: 2.105 Test Acc: 0.149
Validation loss decreased (inf --> -0.148628).  Saving model ...
Epoch: 2 cost time: 2.1237056255340576
Epoch: 2, Steps: 17 | Train Loss: 2.030 Vali Loss: 1.839 Vali Acc: 0.505 Test Loss: 1.839 Test Acc: 0.505
Validation loss decreased (-0.148628 --> -0.505387).  Saving model ...
Epoch: 3 cost time: 2.4932494163513184
Epoch: 3, Steps: 17 | Train Loss: 1.687 Vali Loss: 1.389 Vali Acc: 0.681 Test Loss: 1.389 Test Acc: 0.681
Validation loss decreased (-0.505387 --> -0.681067).  Saving model ...
Epoch: 4 cost time: 2.229692220687866
Epoch: 4, Steps: 17 | Train Loss: 1.113 Vali Loss: 0.810 Vali Acc: 0.876 Test Loss: 0.810 Test Acc: 0.876
Validation loss decreased (-0.681067 --> -0.875668).  Saving model ...
Epoch: 5 cost time: 2.37882137298584
Epoch: 5, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.552 Vali Acc: 0.908 Test Loss: 0.552 Test Acc: 0.908
Validation loss decreased (-0.875668 --> -0.908103).  Saving model ...
Epoch: 6 cost time: 2.172034740447998
Epoch: 6, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.429 Vali Acc: 0.905 Test Loss: 0.429 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.404381513595581
Epoch: 7, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
Validation loss decreased (-0.908103 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 2.160876989364624
Epoch: 8, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 2.439342737197876
Epoch: 9, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 2.1838228702545166
Epoch: 10, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 11 cost time: 2.0842761993408203
Epoch: 11, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.359381914138794
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1218619346618652
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3691911697387695
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3142740726470947
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3464818000793457
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.219 Vali Acc: 0.914 Test Loss: 0.219 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.347283363342285
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.352774143218994
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3821663856506348
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5541117191314697
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 1410873
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.417735576629639
Epoch: 1, Steps: 17 | Train Loss: 2.271 Vali Loss: 2.148 Vali Acc: 0.149 Test Loss: 2.148 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 2.363715410232544
Epoch: 2, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.000 Vali Acc: 0.357 Test Loss: 2.000 Test Acc: 0.357
Validation loss decreased (-0.148627 --> -0.356737).  Saving model ...
Epoch: 3 cost time: 2.24381685256958
Epoch: 3, Steps: 17 | Train Loss: 1.910 Vali Loss: 1.609 Vali Acc: 0.595 Test Loss: 1.609 Test Acc: 0.595
Validation loss decreased (-0.356737 --> -0.594579).  Saving model ...
Epoch: 4 cost time: 2.7609574794769287
Epoch: 4, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.129 Vali Acc: 0.781 Test Loss: 1.129 Test Acc: 0.781
Validation loss decreased (-0.594579 --> -0.781070).  Saving model ...
Epoch: 5 cost time: 2.809300661087036
Epoch: 5, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.722 Vali Acc: 0.865 Test Loss: 0.722 Test Acc: 0.865
Validation loss decreased (-0.781070 --> -0.864858).  Saving model ...
Epoch: 6 cost time: 2.4801032543182373
Epoch: 6, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.439 Vali Acc: 0.911 Test Loss: 0.439 Test Acc: 0.911
Validation loss decreased (-0.864858 --> -0.910806).  Saving model ...
Epoch: 7 cost time: 2.9031383991241455
Epoch: 7, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.320 Vali Acc: 0.932 Test Loss: 0.320 Test Acc: 0.932
Validation loss decreased (-0.910806 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 2.333021402359009
Epoch: 8, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.297 Vali Acc: 0.935 Test Loss: 0.297 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 9 cost time: 2.5728752613067627
Epoch: 9, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 2.8780667781829834
Epoch: 10, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 3.0363783836364746
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 2.6621365547180176
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 2.3990323543548584
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 2.760148763656616
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5949206352233887
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3428525924682617
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0304577350616455
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1294736862182617
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 3.248995542526245
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.226541519165039
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6147677898406982
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.288486957550049
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.274777412414551
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 2.602513313293457
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4093692302703857
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.785511016845703
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.4218053817749023
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 2.8392248153686523
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2455894947052
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.935 Test Loss: 0.166 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4967496395111084
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.506660223007202
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 2.3604209423065186
Epoch: 32, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.7397007942199707
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.6674532890319824
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2627274990081787
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.145796775817871
Epoch: 36, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.3511571884155273
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.984724760055542
Epoch: 38, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.4023666381835938
Epoch: 39, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.719268321990967
Epoch: 40, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.425562620162964
Epoch: 41, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1410489
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.60950779914856
Epoch: 1, Steps: 17 | Train Loss: 2.266 Vali Loss: 2.200 Vali Acc: 0.141 Test Loss: 2.200 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 2.284971237182617
Epoch: 2, Steps: 17 | Train Loss: 2.102 Vali Loss: 1.895 Vali Acc: 0.478 Test Loss: 1.895 Test Acc: 0.478
Validation loss decreased (-0.140519 --> -0.478359).  Saving model ...
Epoch: 3 cost time: 2.2730154991149902
Epoch: 3, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.437 Vali Acc: 0.738 Test Loss: 1.437 Test Acc: 0.738
Validation loss decreased (-0.478359 --> -0.737823).  Saving model ...
Epoch: 4 cost time: 2.0623528957366943
Epoch: 4, Steps: 17 | Train Loss: 1.135 Vali Loss: 0.866 Vali Acc: 0.865 Test Loss: 0.866 Test Acc: 0.865
Validation loss decreased (-0.737823 --> -0.864856).  Saving model ...
Epoch: 5 cost time: 2.047621011734009
Epoch: 5, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.499 Vali Acc: 0.903 Test Loss: 0.499 Test Acc: 0.903
Validation loss decreased (-0.864856 --> -0.902698).  Saving model ...
Epoch: 6 cost time: 2.3280558586120605
Epoch: 6, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
Validation loss decreased (-0.902698 --> -0.921618).  Saving model ...
Epoch: 7 cost time: 2.6893389225006104
Epoch: 7, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.310 Vali Acc: 0.914 Test Loss: 0.310 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9964699745178223
Epoch: 8, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.286 Vali Acc: 0.924 Test Loss: 0.286 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 9 cost time: 2.379966974258423
Epoch: 9, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.924321 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.9376394748687744
Epoch: 10, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.731919527053833
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.663921356201172
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 2.5759942531585693
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1832315921783447
Epoch: 14, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 2.193714141845703
Epoch: 15, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4489142894744873
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2081828117370605
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.521804094314575
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.622661590576172
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8133769035339355
Epoch: 20, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.338787794113159
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.222 Vali Acc: 0.924 Test Loss: 0.222 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.342664957046509
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9670283794403076
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 2.2743613719940186
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 2.3893649578094482
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.417593002319336
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4828569889068604
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.601339101791382
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.580681324005127
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 2.1929900646209717
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2637834548950195
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4336702823638916
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.4146971702575684
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2602438926696777
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.437702178955078
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 36 cost time: 2.078136444091797
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.454516887664795
Epoch: 37, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.308184862136841
Epoch: 38, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.1426172256469727
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.5866169929504395
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.253735303878784
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.3905317783355713
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.3868508338928223
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.4675023555755615
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.1795053482055664
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1410105
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.71472430229187
Epoch: 1, Steps: 17 | Train Loss: 2.251 Vali Loss: 2.055 Vali Acc: 0.270 Test Loss: 2.055 Test Acc: 0.270
Validation loss decreased (inf --> -0.270250).  Saving model ...
Epoch: 2 cost time: 2.420423984527588
Epoch: 2, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.923 Vali Acc: 0.427 Test Loss: 1.923 Test Acc: 0.427
Validation loss decreased (-0.270250 --> -0.427008).  Saving model ...
Epoch: 3 cost time: 2.317559242248535
Epoch: 3, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.424 Vali Acc: 0.797 Test Loss: 1.424 Test Acc: 0.797
Validation loss decreased (-0.427008 --> -0.797283).  Saving model ...
Epoch: 4 cost time: 2.560256242752075
Epoch: 4, Steps: 17 | Train Loss: 1.210 Vali Loss: 0.877 Vali Acc: 0.886 Test Loss: 0.877 Test Acc: 0.886
Validation loss decreased (-0.797283 --> -0.886478).  Saving model ...
Epoch: 5 cost time: 2.285855531692505
Epoch: 5, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
Validation loss decreased (-0.886478 --> -0.899994).  Saving model ...
Epoch: 6 cost time: 2.4485130310058594
Epoch: 6, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.397 Vali Acc: 0.935 Test Loss: 0.397 Test Acc: 0.935
Validation loss decreased (-0.899994 --> -0.935131).  Saving model ...
Epoch: 7 cost time: 2.5930964946746826
Epoch: 7, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.333 Vali Acc: 0.935 Test Loss: 0.333 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 2.235630750656128
Epoch: 8, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.270 Vali Acc: 0.927 Test Loss: 0.270 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4509687423706055
Epoch: 9, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
Validation loss decreased (-0.935132 --> -0.948646).  Saving model ...
Epoch: 10 cost time: 2.272368907928467
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2287826538085938
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.392920732498169
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 2.748802661895752
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9103639125823975
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 2.5233500003814697
Epoch: 15, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6155688762664795
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8506834506988525
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0802512168884277
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2394003868103027
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 2.231003522872925
Epoch: 20, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7376153469085693
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 2.5168018341064453
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1844685077667236
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 2.239332914352417
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6081554889678955
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3078973293304443
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.2430436611175537
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.139 Vali Acc: 0.943 Test Loss: 0.139 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0135016441345215
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.314629554748535
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.4635117053985596
Epoch: 30, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.8615775108337402
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.3117401599884033
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.292642593383789
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 2.433600902557373
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.735352039337158
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.566833257675171
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.5612494945526123
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.6468780040740967
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.6182456016540527
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.592761516571045
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.159982442855835
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.2166337966918945
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.406773567199707
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 948921
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.715082168579102
Epoch: 1, Steps: 17 | Train Loss: 2.255 Vali Loss: 2.193 Vali Acc: 0.192 Test Loss: 2.193 Test Acc: 0.192
Validation loss decreased (inf --> -0.191870).  Saving model ...
Epoch: 2 cost time: 2.100003957748413
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 1.966 Vali Acc: 0.419 Test Loss: 1.966 Test Acc: 0.419
Validation loss decreased (-0.191870 --> -0.418899).  Saving model ...
Epoch: 3 cost time: 2.1734793186187744
Epoch: 3, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.732 Vali Acc: 0.557 Test Loss: 1.732 Test Acc: 0.557
Validation loss decreased (-0.418899 --> -0.556739).  Saving model ...
Epoch: 4 cost time: 2.439882278442383
Epoch: 4, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.056 Vali Acc: 0.849 Test Loss: 1.056 Test Acc: 0.849
Validation loss decreased (-0.556739 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 2.500452995300293
Epoch: 5, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.674 Vali Acc: 0.881 Test Loss: 0.674 Test Acc: 0.881
Validation loss decreased (-0.848638 --> -0.881074).  Saving model ...
Epoch: 6 cost time: 2.1855862140655518
Epoch: 6, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.881074 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 2.348747730255127
Epoch: 7, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 2.3839893341064453
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 2.305729627609253
Epoch: 9, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.342437505722046
Epoch: 10, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.274 Vali Acc: 0.924 Test Loss: 0.274 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1801655292510986
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 2.1306421756744385
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1997361183166504
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 2.1788411140441895
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 2.057943344116211
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 2.4129250049591064
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.252431869506836
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 2.0279793739318848
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.469604969024658
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4432873725891113
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.174 Vali Acc: 0.932 Test Loss: 0.174 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.238802671432495
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9429152011871338
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6340529918670654
Epoch: 23, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 2.1734025478363037
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4936203956604004
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2866861820220947
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 2.2125139236450195
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.456679582595825
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.4219274520874023
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5347957611083984
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 2.441154718399048
Epoch: 31, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.180959463119507
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.959 Test Loss: 0.095 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.4814813137054443
Epoch: 33, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 34 cost time: 2.6154818534851074
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 2.709064483642578
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2272591590881348
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4002630710601807
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.427387237548828
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.2443766593933105
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.0159482955932617
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.068087100982666
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.243861675262451
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.1545209884643555
Epoch: 43, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.950871467590332
Epoch: 44, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 948537
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.138792991638184
Epoch: 1, Steps: 17 | Train Loss: 2.287 Vali Loss: 2.182 Vali Acc: 0.127 Test Loss: 2.182 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 2.3188445568084717
Epoch: 2, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.017 Vali Acc: 0.373 Test Loss: 2.017 Test Acc: 0.373
Validation loss decreased (-0.127005 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 2.12310791015625
Epoch: 3, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.673 Vali Acc: 0.727 Test Loss: 1.673 Test Acc: 0.727
Validation loss decreased (-0.372953 --> -0.727010).  Saving model ...
Epoch: 4 cost time: 2.0368707180023193
Epoch: 4, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.208 Vali Acc: 0.778 Test Loss: 1.208 Test Acc: 0.778
Validation loss decreased (-0.727010 --> -0.778366).  Saving model ...
Epoch: 5 cost time: 2.3321897983551025
Epoch: 5, Steps: 17 | Train Loss: 0.951 Vali Loss: 0.706 Vali Acc: 0.900 Test Loss: 0.706 Test Acc: 0.900
Validation loss decreased (-0.778366 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 1.8406829833984375
Epoch: 6, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.497 Vali Acc: 0.895 Test Loss: 0.497 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.103004217147827
Epoch: 7, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.348 Vali Acc: 0.938 Test Loss: 0.348 Test Acc: 0.938
Validation loss decreased (-0.899993 --> -0.937834).  Saving model ...
Epoch: 8 cost time: 1.9658749103546143
Epoch: 8, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.243 Vali Acc: 0.951 Test Loss: 0.243 Test Acc: 0.951
Validation loss decreased (-0.937834 --> -0.951349).  Saving model ...
Epoch: 9 cost time: 1.761516809463501
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.183425188064575
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 2.080676794052124
Epoch: 11, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0789451599121094
Epoch: 12, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 2.149735927581787
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.181135654449463
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 1.9670469760894775
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 2.1510796546936035
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 2.321640968322754
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.169781446456909
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1070022583007812
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3133046627044678
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 2.5436758995056152
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9002315998077393
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.292015552520752
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.402419328689575
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.426304340362549
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.06887149810791
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.39215350151062
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.623699188232422
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6273562908172607
Epoch: 29, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.250920295715332
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 948153
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9562063217163086
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.114 Vali Acc: 0.392 Test Loss: 2.114 Test Acc: 0.392
Validation loss decreased (inf --> -0.391871).  Saving model ...
Epoch: 2 cost time: 2.0217506885528564
Epoch: 2, Steps: 17 | Train Loss: 2.137 Vali Loss: 1.992 Vali Acc: 0.368 Test Loss: 1.992 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.082273006439209
Epoch: 3, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.652 Vali Acc: 0.795 Test Loss: 1.652 Test Acc: 0.795
Validation loss decreased (-0.391871 --> -0.794578).  Saving model ...
Epoch: 4 cost time: 2.01635479927063
Epoch: 4, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.194 Vali Acc: 0.738 Test Loss: 1.194 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1805264949798584
Epoch: 5, Steps: 17 | Train Loss: 0.969 Vali Loss: 0.702 Vali Acc: 0.849 Test Loss: 0.702 Test Acc: 0.849
Validation loss decreased (-0.794578 --> -0.848642).  Saving model ...
Epoch: 6 cost time: 2.009021043777466
Epoch: 6, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.468 Vali Acc: 0.919 Test Loss: 0.468 Test Acc: 0.919
Validation loss decreased (-0.848642 --> -0.918914).  Saving model ...
Epoch: 7 cost time: 2.457119941711426
Epoch: 7, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.342 Vali Acc: 0.924 Test Loss: 0.342 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924321).  Saving model ...
Epoch: 8 cost time: 2.2832398414611816
Epoch: 8, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.924321 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 2.0510051250457764
Epoch: 9, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 2.1521284580230713
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.9417643547058105
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.190661907196045
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.269819974899292
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.156648874282837
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 2.0228803157806396
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.174307107925415
Epoch: 16, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.238 Vali Acc: 0.924 Test Loss: 0.238 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1764976978302
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 1.9799144268035889
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.9383049011230469
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.141507625579834
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.243886709213257
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.297840118408203
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.193755865097046
Epoch: 23, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.094139814376831
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.121757984161377
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4499571323394775
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.1445181369781494
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4931774139404297
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.949 Test Loss: 0.118 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1736202239990234
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.032268762588501
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.408329963684082
Epoch: 31, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.371016502380371
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.2616145610809326
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.951 Test Loss: 0.113 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.149717092514038
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1832680702209473
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.1443779468536377
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.957 Test Loss: 0.107 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 947769
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.6616597175598145
Epoch: 1, Steps: 17 | Train Loss: 2.241 Vali Loss: 2.119 Vali Acc: 0.403 Test Loss: 2.119 Test Acc: 0.403
Validation loss decreased (inf --> -0.402682).  Saving model ...
Epoch: 2 cost time: 2.2773959636688232
Epoch: 2, Steps: 17 | Train Loss: 2.106 Vali Loss: 1.962 Vali Acc: 0.505 Test Loss: 1.962 Test Acc: 0.505
Validation loss decreased (-0.402682 --> -0.505386).  Saving model ...
Epoch: 3 cost time: 2.3995790481567383
Epoch: 3, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.713 Vali Acc: 0.776 Test Loss: 1.713 Test Acc: 0.776
Validation loss decreased (-0.505386 --> -0.775659).  Saving model ...
Epoch: 4 cost time: 2.1834888458251953
Epoch: 4, Steps: 17 | Train Loss: 1.594 Vali Loss: 1.284 Vali Acc: 0.870 Test Loss: 1.284 Test Acc: 0.870
Validation loss decreased (-0.775659 --> -0.870257).  Saving model ...
Epoch: 5 cost time: 2.106055498123169
Epoch: 5, Steps: 17 | Train Loss: 1.087 Vali Loss: 0.827 Vali Acc: 0.884 Test Loss: 0.827 Test Acc: 0.884
Validation loss decreased (-0.870257 --> -0.883776).  Saving model ...
Epoch: 6 cost time: 2.377800226211548
Epoch: 6, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.524 Vali Acc: 0.911 Test Loss: 0.524 Test Acc: 0.911
Validation loss decreased (-0.883776 --> -0.910806).  Saving model ...
Epoch: 7 cost time: 2.2306113243103027
Epoch: 7, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.312 Vali Acc: 0.938 Test Loss: 0.312 Test Acc: 0.938
Validation loss decreased (-0.910806 --> -0.937835).  Saving model ...
Epoch: 8 cost time: 1.9401495456695557
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.276 Vali Acc: 0.924 Test Loss: 0.276 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.087994337081909
Epoch: 9, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 2.089124917984009
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3449454307556152
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.4226198196411133
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.211674451828003
Epoch: 13, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.478668212890625
Epoch: 14, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 2.258375883102417
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2773942947387695
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.088230848312378
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2242431640625
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 2.4143714904785156
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 2.0734570026397705
Epoch: 20, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3810501098632812
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1237030029296875
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.146721363067627
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.232062816619873
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.462606430053711
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 2.270587205886841
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.158637523651123
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.255521059036255
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9076199531555176
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4266977310180664
Epoch: 30, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.50597882270813
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.6919894218444824
Epoch: 32, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.244663953781128
Epoch: 33, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.3571600914001465
Epoch: 34, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.347489595413208
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 717753
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8399674892425537
Epoch: 1, Steps: 17 | Train Loss: 2.275 Vali Loss: 2.188 Vali Acc: 0.146 Test Loss: 2.188 Test Acc: 0.146
Validation loss decreased (inf --> -0.145924).  Saving model ...
Epoch: 2 cost time: 2.4177334308624268
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.023 Vali Acc: 0.462 Test Loss: 2.023 Test Acc: 0.462
Validation loss decreased (-0.145924 --> -0.462142).  Saving model ...
Epoch: 3 cost time: 1.9577481746673584
Epoch: 3, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.801 Vali Acc: 0.711 Test Loss: 1.801 Test Acc: 0.711
Validation loss decreased (-0.462142 --> -0.710793).  Saving model ...
Epoch: 4 cost time: 1.9165141582489014
Epoch: 4, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.336 Vali Acc: 0.789 Test Loss: 1.336 Test Acc: 0.789
Validation loss decreased (-0.710793 --> -0.789176).  Saving model ...
Epoch: 5 cost time: 2.2658541202545166
Epoch: 5, Steps: 17 | Train Loss: 1.190 Vali Loss: 0.827 Vali Acc: 0.881 Test Loss: 0.827 Test Acc: 0.881
Validation loss decreased (-0.789176 --> -0.881073).  Saving model ...
Epoch: 6 cost time: 2.3747360706329346
Epoch: 6, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.519 Vali Acc: 0.903 Test Loss: 0.519 Test Acc: 0.903
Validation loss decreased (-0.881073 --> -0.902698).  Saving model ...
Epoch: 7 cost time: 1.9716801643371582
Epoch: 7, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.366 Vali Acc: 0.916 Test Loss: 0.366 Test Acc: 0.916
Validation loss decreased (-0.902698 --> -0.916213).  Saving model ...
Epoch: 8 cost time: 2.166808605194092
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 2.200878620147705
Epoch: 9, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.246 Vali Acc: 0.932 Test Loss: 0.246 Test Acc: 0.932
Validation loss decreased (-0.918916 --> -0.932430).  Saving model ...
Epoch: 10 cost time: 2.3608763217926025
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.212 Vali Acc: 0.946 Test Loss: 0.212 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 2.2708797454833984
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 2.1927390098571777
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2191684246063232
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 2.203070640563965
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4845666885375977
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.162 Vali Acc: 0.935 Test Loss: 0.162 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3915903568267822
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 2.476409912109375
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.7354297637939453
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.216413974761963
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8281755447387695
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3846561908721924
Epoch: 21, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1884765625
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.266422748565674
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3105249404907227
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.932 Test Loss: 0.197 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.302215814590454
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.160 Vali Acc: 0.935 Test Loss: 0.160 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.4321329593658447
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2009451389312744
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 2.2453560829162598
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.949 Test Loss: 0.123 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.374598264694214
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 30 cost time: 2.2150373458862305
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.941 Test Loss: 0.126 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.431886672973633
Epoch: 31, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 32 cost time: 2.2519612312316895
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1918396949768066
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.943 Test Loss: 0.128 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2893593311309814
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.967567 --> -0.978377).  Saving model ...
Epoch: 35 cost time: 2.4334042072296143
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.954 Test Loss: 0.103 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2594733238220215
Epoch: 36, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.0533649921417236
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.954 Test Loss: 0.107 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.001394748687744
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.3971168994903564
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.959 Test Loss: 0.095 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.205188274383545
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.019101619720459
Epoch: 41, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.941 Test Loss: 0.151 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.040865421295166
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.183105945587158
Epoch: 43, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.1408627033233643
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 717369
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.802380561828613
Epoch: 1, Steps: 17 | Train Loss: 2.262 Vali Loss: 2.124 Vali Acc: 0.254 Test Loss: 2.124 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 2.1364328861236572
Epoch: 2, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.041 Vali Acc: 0.354 Test Loss: 2.041 Test Acc: 0.354
Validation loss decreased (-0.254033 --> -0.354034).  Saving model ...
Epoch: 3 cost time: 2.1782054901123047
Epoch: 3, Steps: 17 | Train Loss: 1.909 Vali Loss: 1.711 Vali Acc: 0.684 Test Loss: 1.711 Test Acc: 0.684
Validation loss decreased (-0.354034 --> -0.683767).  Saving model ...
Epoch: 4 cost time: 2.4610559940338135
Epoch: 4, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.282 Vali Acc: 0.846 Test Loss: 1.282 Test Acc: 0.846
Validation loss decreased (-0.683767 --> -0.845933).  Saving model ...
Epoch: 5 cost time: 2.494051933288574
Epoch: 5, Steps: 17 | Train Loss: 1.088 Vali Loss: 0.809 Vali Acc: 0.876 Test Loss: 0.809 Test Acc: 0.876
Validation loss decreased (-0.845933 --> -0.875668).  Saving model ...
Epoch: 6 cost time: 2.2419984340667725
Epoch: 6, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.456 Vali Acc: 0.924 Test Loss: 0.456 Test Acc: 0.924
Validation loss decreased (-0.875668 --> -0.924320).  Saving model ...
Epoch: 7 cost time: 2.485067367553711
Epoch: 7, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.350 Vali Acc: 0.927 Test Loss: 0.350 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 2.2173328399658203
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.250 Vali Acc: 0.943 Test Loss: 0.250 Test Acc: 0.943
Validation loss decreased (-0.927024 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 2.3611230850219727
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.040560245513916
Epoch: 10, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 2.4523916244506836
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.553131341934204
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.765488386154175
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 2.9087655544281006
Epoch: 14, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9454755783081055
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 2.5262033939361572
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.4888269901275635
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.805004358291626
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 2.9379537105560303
Epoch: 19, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6613078117370605
Epoch: 20, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3305768966674805
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.410944700241089
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 2.5578622817993164
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 2.615530490875244
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7427523136138916
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 26 cost time: 2.7358341217041016
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 27 cost time: 2.7487268447875977
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.438739776611328
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.471068859100342
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.485656976699829
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.873978853225708
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 2.460568904876709
Epoch: 32, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.6382715702056885
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.3241584300994873
Epoch: 34, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.31034517288208
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.8977301120758057
Epoch: 36, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.723792314529419
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.6700687408447266
Epoch: 38, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.3752760887145996
Epoch: 39, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.2306406497955322
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 2.4386682510375977
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 2.6010639667510986
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.726008892059326
Epoch: 43, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.6541523933410645
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.486814022064209
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.642958164215088
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.4306321144104004
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.574124813079834
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.6461312770843506
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.366741180419922
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.13952898979187
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 716985
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.323377370834351
Epoch: 1, Steps: 17 | Train Loss: 2.362 Vali Loss: 2.195 Vali Acc: 0.114 Test Loss: 2.195 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 2.1216750144958496
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.065 Vali Acc: 0.243 Test Loss: 2.065 Test Acc: 0.243
Validation loss decreased (-0.113492 --> -0.243223).  Saving model ...
Epoch: 3 cost time: 1.9762537479400635
Epoch: 3, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.839 Vali Acc: 0.673 Test Loss: 1.839 Test Acc: 0.673
Validation loss decreased (-0.243223 --> -0.672955).  Saving model ...
Epoch: 4 cost time: 2.1231770515441895
Epoch: 4, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.366 Vali Acc: 0.830 Test Loss: 1.366 Test Acc: 0.830
Validation loss decreased (-0.672955 --> -0.829716).  Saving model ...
Epoch: 5 cost time: 2.149015188217163
Epoch: 5, Steps: 17 | Train Loss: 1.201 Vali Loss: 0.882 Vali Acc: 0.884 Test Loss: 0.882 Test Acc: 0.884
Validation loss decreased (-0.829716 --> -0.883775).  Saving model ...
Epoch: 6 cost time: 2.068190813064575
Epoch: 6, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.488 Vali Acc: 0.916 Test Loss: 0.488 Test Acc: 0.916
Validation loss decreased (-0.883775 --> -0.916211).  Saving model ...
Epoch: 7 cost time: 1.8710651397705078
Epoch: 7, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.405 Vali Acc: 0.916 Test Loss: 0.405 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 8 cost time: 1.8046669960021973
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.286 Vali Acc: 0.914 Test Loss: 0.286 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2434818744659424
Epoch: 9, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.272 Vali Acc: 0.924 Test Loss: 0.272 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924322).  Saving model ...
Epoch: 10 cost time: 2.5811007022857666
Epoch: 10, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 2.111250638961792
Epoch: 11, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.375459671020508
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.246011734008789
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.796807050704956
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 15 cost time: 2.0154318809509277
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954053).  Saving model ...
Epoch: 16 cost time: 2.287006378173828
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.246 Vali Acc: 0.924 Test Loss: 0.246 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.284442901611328
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.42547345161438
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.151 Vali Acc: 0.941 Test Loss: 0.151 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.131535768508911
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 20 cost time: 2.0317656993865967
Epoch: 20, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2010135650634766
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1217212677001953
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.361227512359619
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0041632652282715
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1071693897247314
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.12750244140625
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 2.002293109893799
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 1.98734450340271
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.09047532081604
Epoch: 29, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 2.043320417404175
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.207824945449829
Epoch: 31, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.375769853591919
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.1995882987976074
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.932 Test Loss: 0.183 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.114561080932617
Epoch: 34, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.203205108642578
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.338846445083618
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3020036220550537
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.127077579498291
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.172211170196533
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 716601
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.009827613830566
Epoch: 1, Steps: 17 | Train Loss: 2.301 Vali Loss: 2.179 Vali Acc: 0.092 Test Loss: 2.179 Test Acc: 0.092
Validation loss decreased (inf --> -0.091870).  Saving model ...
Epoch: 2 cost time: 2.1486008167266846
Epoch: 2, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.062 Vali Acc: 0.343 Test Loss: 2.062 Test Acc: 0.343
Validation loss decreased (-0.091870 --> -0.343223).  Saving model ...
Epoch: 3 cost time: 1.8940281867980957
Epoch: 3, Steps: 17 | Train Loss: 2.017 Vali Loss: 1.858 Vali Acc: 0.527 Test Loss: 1.858 Test Acc: 0.527
Validation loss decreased (-0.343223 --> -0.527008).  Saving model ...
Epoch: 4 cost time: 2.095529794692993
Epoch: 4, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.436 Vali Acc: 0.762 Test Loss: 1.436 Test Acc: 0.762
Validation loss decreased (-0.527008 --> -0.762148).  Saving model ...
Epoch: 5 cost time: 2.2008755207061768
Epoch: 5, Steps: 17 | Train Loss: 1.192 Vali Loss: 0.866 Vali Acc: 0.889 Test Loss: 0.866 Test Acc: 0.889
Validation loss decreased (-0.762148 --> -0.889181).  Saving model ...
Epoch: 6 cost time: 2.032548427581787
Epoch: 6, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.523 Vali Acc: 0.919 Test Loss: 0.523 Test Acc: 0.919
Validation loss decreased (-0.889181 --> -0.918914).  Saving model ...
Epoch: 7 cost time: 2.3608222007751465
Epoch: 7, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.344 Vali Acc: 0.932 Test Loss: 0.344 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 1.9911835193634033
Epoch: 8, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.305 Vali Acc: 0.916 Test Loss: 0.305 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9610042572021484
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 2.0367257595062256
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.209984302520752
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.935133 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.373581886291504
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2912354469299316
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.091463804244995
Epoch: 14, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5881237983703613
Epoch: 15, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2269301414489746
Epoch: 16, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 2.1706535816192627
Epoch: 17, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.974306344985962
Epoch: 18, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.258943796157837
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2350969314575195
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.9689629077911377
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3179028034210205
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.487419366836548
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1840107440948486
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1913795471191406
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.432302713394165
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 2.2195749282836914
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5366780757904053
Epoch: 28, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3945021629333496
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2317492961883545
Epoch: 30, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7703697681427
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.569082021713257
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7979669570922852
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.682987928390503
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.957953929901123
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.0215272903442383
Epoch: 36, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.959 Test Loss: 0.092 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 602169
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.271597385406494
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.133 Vali Acc: 0.154 Test Loss: 2.133 Test Acc: 0.154
Validation loss decreased (inf --> -0.154033).  Saving model ...
Epoch: 2 cost time: 2.2069945335388184
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.010 Vali Acc: 0.419 Test Loss: 2.010 Test Acc: 0.419
Validation loss decreased (-0.154033 --> -0.418899).  Saving model ...
Epoch: 3 cost time: 2.4359896183013916
Epoch: 3, Steps: 17 | Train Loss: 1.966 Vali Loss: 1.858 Vali Acc: 0.535 Test Loss: 1.858 Test Acc: 0.535
Validation loss decreased (-0.418899 --> -0.535117).  Saving model ...
Epoch: 4 cost time: 2.3808343410491943
Epoch: 4, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.427 Vali Acc: 0.795 Test Loss: 1.427 Test Acc: 0.795
Validation loss decreased (-0.535117 --> -0.794580).  Saving model ...
Epoch: 5 cost time: 1.9364676475524902
Epoch: 5, Steps: 17 | Train Loss: 1.240 Vali Loss: 0.953 Vali Acc: 0.846 Test Loss: 0.953 Test Acc: 0.846
Validation loss decreased (-0.794580 --> -0.845936).  Saving model ...
Epoch: 6 cost time: 1.9717319011688232
Epoch: 6, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.603 Vali Acc: 0.881 Test Loss: 0.603 Test Acc: 0.881
Validation loss decreased (-0.845936 --> -0.881075).  Saving model ...
Epoch: 7 cost time: 1.939415693283081
Epoch: 7, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.432 Vali Acc: 0.895 Test Loss: 0.432 Test Acc: 0.895
Validation loss decreased (-0.881075 --> -0.894590).  Saving model ...
Epoch: 8 cost time: 2.2563722133636475
Epoch: 8, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
Validation loss decreased (-0.894590 --> -0.910808).  Saving model ...
Epoch: 9 cost time: 2.013962984085083
Epoch: 9, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
Validation loss decreased (-0.910808 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 2.3144025802612305
Epoch: 10, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.264 Vali Acc: 0.908 Test Loss: 0.264 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9393749237060547
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 2.190859079360962
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.366 Vali Acc: 0.881 Test Loss: 0.366 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.086273670196533
Epoch: 13, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.226 Vali Acc: 0.916 Test Loss: 0.226 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.177377462387085
Epoch: 14, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 2.0742530822753906
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 2.4206035137176514
Epoch: 16, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 2.118873119354248
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.020371198654175
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.968935489654541
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3347508907318115
Epoch: 20, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9798500537872314
Epoch: 21, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1770026683807373
Epoch: 22, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9503142833709717
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 2.2097854614257812
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.955798864364624
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1775176525115967
Epoch: 26, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.118960380554199
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9984886646270752
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.935 Test Loss: 0.151 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.042952060699463
Epoch: 29, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 30 cost time: 1.9273252487182617
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3435962200164795
Epoch: 31, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.941 Test Loss: 0.131 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4562971591949463
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9756109714508057
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.315648078918457
Epoch: 34, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.3691720962524414
Epoch: 35, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 2.228011131286621
Epoch: 36, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.854140281677246
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1529901027679443
Epoch: 38, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 2.2256884574890137
Epoch: 39, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.149634599685669
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.0163350105285645
Epoch: 41, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.399164915084839
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.1513257026672363
Epoch: 43, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.0343055725097656
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.1356070041656494
Epoch: 45, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.137822151184082
Epoch: 46, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.0718915462493896
Epoch: 47, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.954 Test Loss: 0.108 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.3707802295684814
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 601785
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.475573301315308
Epoch: 1, Steps: 17 | Train Loss: 2.362 Vali Loss: 2.154 Vali Acc: 0.178 Test Loss: 2.154 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 2.559584140777588
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.066 Vali Acc: 0.262 Test Loss: 2.066 Test Acc: 0.262
Validation loss decreased (-0.178357 --> -0.262141).  Saving model ...
Epoch: 3 cost time: 2.36226749420166
Epoch: 3, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.900 Vali Acc: 0.397 Test Loss: 1.900 Test Acc: 0.397
Validation loss decreased (-0.262141 --> -0.397278).  Saving model ...
Epoch: 4 cost time: 2.832976818084717
Epoch: 4, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.479 Vali Acc: 0.749 Test Loss: 1.479 Test Acc: 0.749
Validation loss decreased (-0.397278 --> -0.748634).  Saving model ...
Epoch: 5 cost time: 2.8392765522003174
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 0.966 Vali Acc: 0.838 Test Loss: 0.966 Test Acc: 0.838
Validation loss decreased (-0.748634 --> -0.837828).  Saving model ...
Epoch: 6 cost time: 2.660604953765869
Epoch: 6, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.591 Vali Acc: 0.892 Test Loss: 0.591 Test Acc: 0.892
Validation loss decreased (-0.837828 --> -0.891886).  Saving model ...
Epoch: 7 cost time: 2.274854898452759
Epoch: 7, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.390 Vali Acc: 0.916 Test Loss: 0.390 Test Acc: 0.916
Validation loss decreased (-0.891886 --> -0.916212).  Saving model ...
Epoch: 8 cost time: 2.117234706878662
Epoch: 8, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 2.4551990032196045
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929727).  Saving model ...
Epoch: 10 cost time: 2.988049030303955
Epoch: 10, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1452627182006836
Epoch: 11, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.611959457397461
Epoch: 12, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 13 cost time: 2.6028482913970947
Epoch: 13, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 2.3833649158477783
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.180476427078247
Epoch: 15, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.46209716796875
Epoch: 16, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.263648271560669
Epoch: 17, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4197306632995605
Epoch: 18, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.556662082672119
Epoch: 19, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 2.4838905334472656
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 2.3335938453674316
Epoch: 21, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5497124195098877
Epoch: 22, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.71329665184021
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2625105381011963
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5839335918426514
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5191457271575928
Epoch: 26, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9685990810394287
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.277981996536255
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2838878631591797
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.36842679977417
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 601401
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.34269118309021
Epoch: 1, Steps: 17 | Train Loss: 2.298 Vali Loss: 2.155 Vali Acc: 0.170 Test Loss: 2.155 Test Acc: 0.170
Validation loss decreased (inf --> -0.170249).  Saving model ...
Epoch: 2 cost time: 1.9671592712402344
Epoch: 2, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.032 Vali Acc: 0.441 Test Loss: 2.032 Test Acc: 0.441
Validation loss decreased (-0.170249 --> -0.440520).  Saving model ...
Epoch: 3 cost time: 2.1378326416015625
Epoch: 3, Steps: 17 | Train Loss: 1.963 Vali Loss: 1.830 Vali Acc: 0.692 Test Loss: 1.830 Test Acc: 0.692
Validation loss decreased (-0.440520 --> -0.691874).  Saving model ...
Epoch: 4 cost time: 2.164665937423706
Epoch: 4, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.438 Vali Acc: 0.749 Test Loss: 1.438 Test Acc: 0.749
Validation loss decreased (-0.691874 --> -0.748634).  Saving model ...
Epoch: 5 cost time: 2.140833854675293
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 0.974 Vali Acc: 0.881 Test Loss: 0.974 Test Acc: 0.881
Validation loss decreased (-0.748634 --> -0.881071).  Saving model ...
Epoch: 6 cost time: 2.3406789302825928
Epoch: 6, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.605 Vali Acc: 0.932 Test Loss: 0.605 Test Acc: 0.932
Validation loss decreased (-0.881071 --> -0.932426).  Saving model ...
Epoch: 7 cost time: 2.8332056999206543
Epoch: 7, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.22326922416687
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.315 Vali Acc: 0.932 Test Loss: 0.315 Test Acc: 0.932
Validation loss decreased (-0.932426 --> -0.932429).  Saving model ...
Epoch: 9 cost time: 2.02506947517395
Epoch: 9, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 2.4196763038635254
Epoch: 10, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5276293754577637
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 2.5001063346862793
Epoch: 12, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 2.3252055644989014
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 2.1943554878234863
Epoch: 14, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.210 Vali Acc: 0.932 Test Loss: 0.210 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0913712978363037
Epoch: 15, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.228 Vali Acc: 0.916 Test Loss: 0.228 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.336519718170166
Epoch: 16, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 2.1262052059173584
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 2.052990198135376
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 2.4886794090270996
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 2.344510078430176
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 2.048787832260132
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 2.1821515560150146
Epoch: 22, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.494718551635742
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5748329162597656
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.924 Test Loss: 0.212 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9798142910003662
Epoch: 25, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.169576406478882
Epoch: 26, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.302990436553955
Epoch: 27, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.161978244781494
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0225348472595215
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9458818435668945
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.098463296890259
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 601017
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.084162950515747
Epoch: 1, Steps: 17 | Train Loss: 2.279 Vali Loss: 2.169 Vali Acc: 0.157 Test Loss: 2.169 Test Acc: 0.157
Validation loss decreased (inf --> -0.156735).  Saving model ...
Epoch: 2 cost time: 2.4679369926452637
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.097 Vali Acc: 0.292 Test Loss: 2.097 Test Acc: 0.292
Validation loss decreased (-0.156735 --> -0.291871).  Saving model ...
Epoch: 3 cost time: 2.290651798248291
Epoch: 3, Steps: 17 | Train Loss: 2.009 Vali Loss: 1.843 Vali Acc: 0.530 Test Loss: 1.843 Test Acc: 0.530
Validation loss decreased (-0.291871 --> -0.529711).  Saving model ...
Epoch: 4 cost time: 2.4399592876434326
Epoch: 4, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.525 Vali Acc: 0.668 Test Loss: 1.525 Test Acc: 0.668
Validation loss decreased (-0.529711 --> -0.667552).  Saving model ...
Epoch: 5 cost time: 2.503882646560669
Epoch: 5, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.149 Vali Acc: 0.762 Test Loss: 1.149 Test Acc: 0.762
Validation loss decreased (-0.667552 --> -0.762151).  Saving model ...
Epoch: 6 cost time: 2.455404758453369
Epoch: 6, Steps: 17 | Train Loss: 0.960 Vali Loss: 0.817 Vali Acc: 0.881 Test Loss: 0.817 Test Acc: 0.881
Validation loss decreased (-0.762151 --> -0.881073).  Saving model ...
Epoch: 7 cost time: 2.345055103302002
Epoch: 7, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.689 Vali Acc: 0.868 Test Loss: 0.689 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2302074432373047
Epoch: 8, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.489 Vali Acc: 0.914 Test Loss: 0.489 Test Acc: 0.914
Validation loss decreased (-0.881073 --> -0.913509).  Saving model ...
Epoch: 9 cost time: 2.825702428817749
Epoch: 9, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.419 Vali Acc: 0.914 Test Loss: 0.419 Test Acc: 0.914
Validation loss decreased (-0.913509 --> -0.913509).  Saving model ...
Epoch: 10 cost time: 2.8175270557403564
Epoch: 10, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
Validation loss decreased (-0.913509 --> -0.921618).  Saving model ...
Epoch: 11 cost time: 2.6026177406311035
Epoch: 11, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 2.7345237731933594
Epoch: 12, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.270 Vali Acc: 0.927 Test Loss: 0.270 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.589503765106201
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2039108276367188
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.768245220184326
Epoch: 15, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5606164932250977
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 2.8643393516540527
Epoch: 17, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2291369438171387
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 2.2607879638671875
Epoch: 19, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.757417678833008
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.354323148727417
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.220 Vali Acc: 0.927 Test Loss: 0.220 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3281075954437256
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4160330295562744
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5755841732025146
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2325761318206787
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3620526790618896
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 2.402322769165039
Epoch: 27, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4333324432373047
Epoch: 28, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.468363046646118
Epoch: 29, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5232579708099365
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.203 Vali Acc: 0.919 Test Loss: 0.203 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2683944702148438
Epoch: 31, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.657984733581543
Epoch: 32, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.771712303161621
Epoch: 33, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.2760939598083496
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.6182453632354736
Epoch: 35, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.493292808532715
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 37 cost time: 2.4090216159820557
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.789807081222534
Epoch: 38, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.0404772758483887
Epoch: 39, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.720029354095459
Epoch: 40, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.5681421756744385
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.556386947631836
Epoch: 42, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.783036470413208
Epoch: 43, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.35554838180542
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.375910520553589
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.549410104751587
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 594553
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.887371063232422
Epoch: 1, Steps: 17 | Train Loss: 2.312 Vali Loss: 2.179 Vali Acc: 0.114 Test Loss: 2.179 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 2.0233724117279053
Epoch: 2, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.073 Vali Acc: 0.254 Test Loss: 2.073 Test Acc: 0.254
Validation loss decreased (-0.113492 --> -0.254033).  Saving model ...
Epoch: 3 cost time: 2.25607967376709
Epoch: 3, Steps: 17 | Train Loss: 2.059 Vali Loss: 1.893 Vali Acc: 0.570 Test Loss: 1.893 Test Acc: 0.570
Validation loss decreased (-0.254033 --> -0.570251).  Saving model ...
Epoch: 4 cost time: 2.1607542037963867
Epoch: 4, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.508 Vali Acc: 0.751 Test Loss: 1.508 Test Acc: 0.751
Validation loss decreased (-0.570251 --> -0.751336).  Saving model ...
Epoch: 5 cost time: 1.9961175918579102
Epoch: 5, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.102 Vali Acc: 0.876 Test Loss: 1.102 Test Acc: 0.876
Validation loss decreased (-0.751336 --> -0.875665).  Saving model ...
Epoch: 6 cost time: 2.118837833404541
Epoch: 6, Steps: 17 | Train Loss: 1.007 Vali Loss: 0.790 Vali Acc: 0.905 Test Loss: 0.790 Test Acc: 0.905
Validation loss decreased (-0.875665 --> -0.905398).  Saving model ...
Epoch: 7 cost time: 2.1494462490081787
Epoch: 7, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.575 Vali Acc: 0.911 Test Loss: 0.575 Test Acc: 0.911
Validation loss decreased (-0.905398 --> -0.910805).  Saving model ...
Epoch: 8 cost time: 2.2729907035827637
Epoch: 8, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.458 Vali Acc: 0.932 Test Loss: 0.458 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932428).  Saving model ...
Epoch: 9 cost time: 2.180509328842163
Epoch: 9, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.374 Vali Acc: 0.932 Test Loss: 0.374 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 10 cost time: 2.1319661140441895
Epoch: 10, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.346 Vali Acc: 0.927 Test Loss: 0.346 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.246859550476074
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.275 Vali Acc: 0.943 Test Loss: 0.275 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943240).  Saving model ...
Epoch: 12 cost time: 2.2136240005493164
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.236 Vali Acc: 0.959 Test Loss: 0.236 Test Acc: 0.959
Validation loss decreased (-0.943240 --> -0.959457).  Saving model ...
Epoch: 13 cost time: 1.9031429290771484
Epoch: 13, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.430844306945801
Epoch: 14, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.369039297103882
Epoch: 15, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9590120315551758
Epoch: 16, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 2.1611807346343994
Epoch: 17, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.196807384490967
Epoch: 18, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 2.3126161098480225
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.456221103668213
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 2.2861955165863037
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2490901947021484
Epoch: 22, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.212 Vali Acc: 0.927 Test Loss: 0.212 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2170610427856445
Epoch: 23, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2764463424682617
Epoch: 24, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0193750858306885
Epoch: 25, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.057555675506592
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0238094329833984
Epoch: 27, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 2.010465383529663
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0841946601867676
Epoch: 29, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.10064959526062
Epoch: 30, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1412723064422607
Epoch: 31, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.0227584838867188
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9362680912017822
Epoch: 33, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 34 cost time: 1.940777063369751
Epoch: 34, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1585240364074707
Epoch: 35, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.125831365585327
Epoch: 36, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.904655933380127
Epoch: 37, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.0644054412841797
Epoch: 38, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.0474753379821777
Epoch: 39, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.1004412174224854
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 41 cost time: 2.286001443862915
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.1039066314697266
Epoch: 42, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.024648427963257
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.1678860187530518
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 45 cost time: 2.0825352668762207
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9410593509674072
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.252331018447876
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.1646761894226074
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.336047649383545
Epoch: 49, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.1075658798217773
Epoch: 50, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.0661630630493164
Epoch: 51, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.1099793910980225
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.402533531188965
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.0754313468933105
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 594361
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.561281681060791
Epoch: 1, Steps: 17 | Train Loss: 2.304 Vali Loss: 2.171 Vali Acc: 0.259 Test Loss: 2.171 Test Acc: 0.259
Validation loss decreased (inf --> -0.259438).  Saving model ...
Epoch: 2 cost time: 2.1657674312591553
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.072 Vali Acc: 0.273 Test Loss: 2.072 Test Acc: 0.273
Validation loss decreased (-0.259438 --> -0.272952).  Saving model ...
Epoch: 3 cost time: 2.157574415206909
Epoch: 3, Steps: 17 | Train Loss: 2.038 Vali Loss: 1.836 Vali Acc: 0.559 Test Loss: 1.836 Test Acc: 0.559
Validation loss decreased (-0.272952 --> -0.559441).  Saving model ...
Epoch: 4 cost time: 1.9017457962036133
Epoch: 4, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.468 Vali Acc: 0.703 Test Loss: 1.468 Test Acc: 0.703
Validation loss decreased (-0.559441 --> -0.702688).  Saving model ...
Epoch: 5 cost time: 1.836606502532959
Epoch: 5, Steps: 17 | Train Loss: 1.270 Vali Loss: 0.994 Vali Acc: 0.865 Test Loss: 0.994 Test Acc: 0.865
Validation loss decreased (-0.702688 --> -0.864855).  Saving model ...
Epoch: 6 cost time: 2.027272939682007
Epoch: 6, Steps: 17 | Train Loss: 0.930 Vali Loss: 0.759 Vali Acc: 0.870 Test Loss: 0.759 Test Acc: 0.870
Validation loss decreased (-0.864855 --> -0.870263).  Saving model ...
Epoch: 7 cost time: 2.263531446456909
Epoch: 7, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.581 Vali Acc: 0.911 Test Loss: 0.581 Test Acc: 0.911
Validation loss decreased (-0.870263 --> -0.910805).  Saving model ...
Epoch: 8 cost time: 2.317431926727295
Epoch: 8, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 9 cost time: 2.192110061645508
Epoch: 9, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.384 Vali Acc: 0.935 Test Loss: 0.384 Test Acc: 0.935
Validation loss decreased (-0.910806 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 2.118197202682495
Epoch: 10, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.375 Vali Acc: 0.924 Test Loss: 0.375 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.461467742919922
Epoch: 11, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945943).  Saving model ...
Epoch: 12 cost time: 1.8928239345550537
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.9775848388671875
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.575662136077881
Epoch: 14, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.269944429397583
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 2.126142978668213
Epoch: 16, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.242 Vali Acc: 0.927 Test Loss: 0.242 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1736111640930176
Epoch: 17, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1077535152435303
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1973702907562256
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 2.2464661598205566
Epoch: 20, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.243 Vali Acc: 0.919 Test Loss: 0.243 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0585529804229736
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 2.106639862060547
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 2.3463892936706543
Epoch: 23, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 2.2743539810180664
Epoch: 24, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1509292125701904
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.43048095703125
Epoch: 26, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3872876167297363
Epoch: 27, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.549137830734253
Epoch: 28, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.237043857574463
Epoch: 29, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.305203914642334
Epoch: 30, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.448184013366699
Epoch: 31, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.4360358715057373
Epoch: 32, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1326169967651367
Epoch: 33, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 594169
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.254029273986816
Epoch: 1, Steps: 17 | Train Loss: 2.311 Vali Loss: 2.159 Vali Acc: 0.186 Test Loss: 2.159 Test Acc: 0.186
Validation loss decreased (inf --> -0.186465).  Saving model ...
Epoch: 2 cost time: 2.107600212097168
Epoch: 2, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.098 Vali Acc: 0.338 Test Loss: 2.098 Test Acc: 0.338
Validation loss decreased (-0.186465 --> -0.337817).  Saving model ...
Epoch: 3 cost time: 1.9808552265167236
Epoch: 3, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.883 Vali Acc: 0.411 Test Loss: 1.883 Test Acc: 0.411
Validation loss decreased (-0.337817 --> -0.410792).  Saving model ...
Epoch: 4 cost time: 1.9936840534210205
Epoch: 4, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.588 Vali Acc: 0.503 Test Loss: 1.588 Test Acc: 0.503
Validation loss decreased (-0.410792 --> -0.502687).  Saving model ...
Epoch: 5 cost time: 2.23872971534729
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.157 Vali Acc: 0.781 Test Loss: 1.157 Test Acc: 0.781
Validation loss decreased (-0.502687 --> -0.781070).  Saving model ...
Epoch: 6 cost time: 1.9104504585266113
Epoch: 6, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.878 Vali Acc: 0.873 Test Loss: 0.878 Test Acc: 0.873
Validation loss decreased (-0.781070 --> -0.872964).  Saving model ...
Epoch: 7 cost time: 1.926239252090454
Epoch: 7, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.668 Vali Acc: 0.900 Test Loss: 0.668 Test Acc: 0.900
Validation loss decreased (-0.872964 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 2.0358312129974365
Epoch: 8, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.532 Vali Acc: 0.905 Test Loss: 0.532 Test Acc: 0.905
Validation loss decreased (-0.899993 --> -0.905400).  Saving model ...
Epoch: 9 cost time: 2.1493680477142334
Epoch: 9, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.431 Vali Acc: 0.919 Test Loss: 0.431 Test Acc: 0.919
Validation loss decreased (-0.905400 --> -0.918915).  Saving model ...
Epoch: 10 cost time: 2.215003490447998
Epoch: 10, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.360 Vali Acc: 0.924 Test Loss: 0.360 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 11 cost time: 2.0354273319244385
Epoch: 11, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.333 Vali Acc: 0.924 Test Loss: 0.333 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 12 cost time: 1.7225797176361084
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.334568500518799
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
Validation loss decreased (-0.924321 --> -0.937835).  Saving model ...
Epoch: 14 cost time: 2.2655434608459473
Epoch: 14, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.299 Vali Acc: 0.905 Test Loss: 0.299 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0264205932617188
Epoch: 15, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 2.3238277435302734
Epoch: 16, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 2.348283052444458
Epoch: 17, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.341627359390259
Epoch: 18, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.143033504486084
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7554380893707275
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.236 Vali Acc: 0.914 Test Loss: 0.236 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8800361156463623
Epoch: 21, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.267 Vali Acc: 0.905 Test Loss: 0.267 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.244636058807373
Epoch: 22, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0600647926330566
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.954460620880127
Epoch: 24, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.036048412322998
Epoch: 25, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0980517864227295
Epoch: 26, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.183 Vali Acc: 0.932 Test Loss: 0.183 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 593977
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.063435077667236
Epoch: 1, Steps: 17 | Train Loss: 2.310 Vali Loss: 2.145 Vali Acc: 0.165 Test Loss: 2.145 Test Acc: 0.165
Validation loss decreased (inf --> -0.164843).  Saving model ...
Epoch: 2 cost time: 1.8963699340820312
Epoch: 2, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.149 Vali Acc: 0.192 Test Loss: 2.149 Test Acc: 0.192
Validation loss decreased (-0.164843 --> -0.191870).  Saving model ...
Epoch: 3 cost time: 2.1723825931549072
Epoch: 3, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.004 Vali Acc: 0.365 Test Loss: 2.004 Test Acc: 0.365
Validation loss decreased (-0.191870 --> -0.364845).  Saving model ...
Epoch: 4 cost time: 2.732907772064209
Epoch: 4, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.802 Vali Acc: 0.689 Test Loss: 1.802 Test Acc: 0.689
Validation loss decreased (-0.364845 --> -0.689171).  Saving model ...
Epoch: 5 cost time: 2.655073642730713
Epoch: 5, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.474 Vali Acc: 0.735 Test Loss: 1.474 Test Acc: 0.735
Validation loss decreased (-0.689171 --> -0.735120).  Saving model ...
Epoch: 6 cost time: 2.323753833770752
Epoch: 6, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.164 Vali Acc: 0.838 Test Loss: 1.164 Test Acc: 0.838
Validation loss decreased (-0.735120 --> -0.837826).  Saving model ...
Epoch: 7 cost time: 2.203092336654663
Epoch: 7, Steps: 17 | Train Loss: 1.007 Vali Loss: 0.869 Vali Acc: 0.889 Test Loss: 0.869 Test Acc: 0.889
Validation loss decreased (-0.837826 --> -0.889181).  Saving model ...
Epoch: 8 cost time: 2.400104522705078
Epoch: 8, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
Validation loss decreased (-0.889181 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 2.1001172065734863
Epoch: 9, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.494 Vali Acc: 0.927 Test Loss: 0.494 Test Acc: 0.927
Validation loss decreased (-0.899994 --> -0.927022).  Saving model ...
Epoch: 10 cost time: 2.283327341079712
Epoch: 10, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.443 Vali Acc: 0.908 Test Loss: 0.443 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.549816131591797
Epoch: 11, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3794031143188477
Epoch: 12, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.304 Vali Acc: 0.924 Test Loss: 0.304 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.431137800216675
Epoch: 13, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.284 Vali Acc: 0.943 Test Loss: 0.284 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943240).  Saving model ...
Epoch: 14 cost time: 2.084728717803955
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9223222732543945
Epoch: 15, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 16 cost time: 2.864048957824707
Epoch: 16, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.822711229324341
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.236 Vali Acc: 0.938 Test Loss: 0.236 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.696479320526123
Epoch: 18, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.301093101501465
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.241 Vali Acc: 0.927 Test Loss: 0.241 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.417931318283081
Epoch: 20, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9878766536712646
Epoch: 21, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.581392288208008
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 23 cost time: 2.47895884513855
Epoch: 23, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 24 cost time: 2.2571802139282227
Epoch: 24, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.144909620285034
Epoch: 25, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.138272285461426
Epoch: 26, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.169 Vali Acc: 0.932 Test Loss: 0.169 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.430607557296753
Epoch: 27, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 2.0167150497436523
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4075708389282227
Epoch: 29, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.443608522415161
Epoch: 30, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.761566162109375
Epoch: 31, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.6331257820129395
Epoch: 32, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.200 Vali Acc: 0.924 Test Loss: 0.200 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.4951064586639404
Epoch: 33, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.347966432571411
Epoch: 34, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.3901007175445557
Epoch: 35, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.949 Test Loss: 0.123 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.288800001144409
Epoch: 36, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 2.6098744869232178
Epoch: 37, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.333728551864624
Epoch: 38, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.2455251216888428
Epoch: 39, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.43210506439209
Epoch: 40, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.949 Test Loss: 0.121 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.8868494033813477
Epoch: 41, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.0370688438415527
Epoch: 42, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.951 Test Loss: 0.120 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.620043992996216
Epoch: 43, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.946 Test Loss: 0.123 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.855740547180176
Epoch: 44, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.946 Test Loss: 0.122 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.4626412391662598
Epoch: 45, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.270136833190918
Epoch: 46, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 361593
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.156672477722168
Epoch: 1, Steps: 17 | Train Loss: 2.270 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (inf --> -0.078356).  Saving model ...
Epoch: 2 cost time: 2.3772976398468018
Epoch: 2, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.124 Vali Acc: 0.241 Test Loss: 2.124 Test Acc: 0.241
Validation loss decreased (-0.078356 --> -0.240519).  Saving model ...
Epoch: 3 cost time: 2.1894588470458984
Epoch: 3, Steps: 17 | Train Loss: 2.130 Vali Loss: 2.023 Vali Acc: 0.424 Test Loss: 2.023 Test Acc: 0.424
Validation loss decreased (-0.240519 --> -0.424304).  Saving model ...
Epoch: 4 cost time: 2.101383686065674
Epoch: 4, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.792 Vali Acc: 0.657 Test Loss: 1.792 Test Acc: 0.657
Validation loss decreased (-0.424304 --> -0.656739).  Saving model ...
Epoch: 5 cost time: 2.3421552181243896
Epoch: 5, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.484 Vali Acc: 0.738 Test Loss: 1.484 Test Acc: 0.738
Validation loss decreased (-0.656739 --> -0.737823).  Saving model ...
Epoch: 6 cost time: 2.32769775390625
Epoch: 6, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.137 Vali Acc: 0.846 Test Loss: 1.137 Test Acc: 0.846
Validation loss decreased (-0.737823 --> -0.845935).  Saving model ...
Epoch: 7 cost time: 2.3854987621307373
Epoch: 7, Steps: 17 | Train Loss: 1.042 Vali Loss: 0.877 Vali Acc: 0.870 Test Loss: 0.877 Test Acc: 0.870
Validation loss decreased (-0.845935 --> -0.870262).  Saving model ...
Epoch: 8 cost time: 2.5751893520355225
Epoch: 8, Steps: 17 | Train Loss: 0.765 Vali Loss: 0.617 Vali Acc: 0.903 Test Loss: 0.617 Test Acc: 0.903
Validation loss decreased (-0.870262 --> -0.902697).  Saving model ...
Epoch: 9 cost time: 2.2937047481536865
Epoch: 9, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.482 Vali Acc: 0.916 Test Loss: 0.482 Test Acc: 0.916
Validation loss decreased (-0.902697 --> -0.916211).  Saving model ...
Epoch: 10 cost time: 2.267629623413086
Epoch: 10, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.414 Vali Acc: 0.922 Test Loss: 0.414 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 11 cost time: 2.1288180351257324
Epoch: 11, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.348 Vali Acc: 0.927 Test Loss: 0.348 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 2.7263612747192383
Epoch: 12, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.291 Vali Acc: 0.932 Test Loss: 0.291 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 13 cost time: 2.327906847000122
Epoch: 13, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.267 Vali Acc: 0.946 Test Loss: 0.267 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 2.255563497543335
Epoch: 14, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2754507064819336
Epoch: 15, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.363089084625244
Epoch: 16, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7366127967834473
Epoch: 17, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 2.134871482849121
Epoch: 18, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.243546962738037
Epoch: 19, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.760160207748413
Epoch: 20, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1164968013763428
Epoch: 21, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.189 Vali Acc: 0.932 Test Loss: 0.189 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.479806423187256
Epoch: 22, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 2.055161714553833
Epoch: 23, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5757431983947754
Epoch: 24, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.134579658508301
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 26 cost time: 2.142902374267578
Epoch: 26, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.069175958633423
Epoch: 27, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 2.347334623336792
Epoch: 28, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8759055137634277
Epoch: 29, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1299502849578857
Epoch: 30, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.080421209335327
Epoch: 31, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9988977909088135
Epoch: 32, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.264726161956787
Epoch: 33, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.351830244064331
Epoch: 34, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.943 Test Loss: 0.131 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.10052227973938
Epoch: 35, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.0279488563537598
Epoch: 36, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.041731834411621
Epoch: 37, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 361401
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.15534782409668
Epoch: 1, Steps: 17 | Train Loss: 2.215 Vali Loss: 2.160 Vali Acc: 0.151 Test Loss: 2.160 Test Acc: 0.151
Validation loss decreased (inf --> -0.151330).  Saving model ...
Epoch: 2 cost time: 2.360473871231079
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.060 Vali Acc: 0.332 Test Loss: 2.060 Test Acc: 0.332
Validation loss decreased (-0.151330 --> -0.332412).  Saving model ...
Epoch: 3 cost time: 2.20361065864563
Epoch: 3, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.959 Vali Acc: 0.403 Test Loss: 1.959 Test Acc: 0.403
Validation loss decreased (-0.332412 --> -0.402683).  Saving model ...
Epoch: 4 cost time: 2.334531784057617
Epoch: 4, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.621 Vali Acc: 0.695 Test Loss: 1.621 Test Acc: 0.695
Validation loss decreased (-0.402683 --> -0.694578).  Saving model ...
Epoch: 5 cost time: 2.29328989982605
Epoch: 5, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.253 Vali Acc: 0.811 Test Loss: 1.253 Test Acc: 0.811
Validation loss decreased (-0.694578 --> -0.810798).  Saving model ...
Epoch: 6 cost time: 2.2281224727630615
Epoch: 6, Steps: 17 | Train Loss: 1.190 Vali Loss: 0.960 Vali Acc: 0.849 Test Loss: 0.960 Test Acc: 0.849
Validation loss decreased (-0.810798 --> -0.848639).  Saving model ...
Epoch: 7 cost time: 2.745420455932617
Epoch: 7, Steps: 17 | Train Loss: 0.857 Vali Loss: 0.714 Vali Acc: 0.889 Test Loss: 0.714 Test Acc: 0.889
Validation loss decreased (-0.848639 --> -0.889182).  Saving model ...
Epoch: 8 cost time: 2.511723279953003
Epoch: 8, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.570 Vali Acc: 0.889 Test Loss: 0.570 Test Acc: 0.889
Validation loss decreased (-0.889182 --> -0.889183).  Saving model ...
Epoch: 9 cost time: 2.5641376972198486
Epoch: 9, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.462 Vali Acc: 0.914 Test Loss: 0.462 Test Acc: 0.914
Validation loss decreased (-0.889183 --> -0.913509).  Saving model ...
Epoch: 10 cost time: 2.7019882202148438
Epoch: 10, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.378 Vali Acc: 0.927 Test Loss: 0.378 Test Acc: 0.927
Validation loss decreased (-0.913509 --> -0.927023).  Saving model ...
Epoch: 11 cost time: 2.8600077629089355
Epoch: 11, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.338 Vali Acc: 0.927 Test Loss: 0.338 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 1.9824903011322021
Epoch: 12, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.340 Vali Acc: 0.908 Test Loss: 0.340 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.439457416534424
Epoch: 13, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 14 cost time: 2.507711172103882
Epoch: 14, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.265 Vali Acc: 0.927 Test Loss: 0.265 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.524216413497925
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3487155437469482
Epoch: 16, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4563560485839844
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3136818408966064
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3909530639648438
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 2.1547858715057373
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3853039741516113
Epoch: 21, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.363321304321289
Epoch: 22, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 3.0837624073028564
Epoch: 23, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 2.559741973876953
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6855838298797607
Epoch: 25, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.390345335006714
Epoch: 26, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4960482120513916
Epoch: 27, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.145 Vali Acc: 0.941 Test Loss: 0.145 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4277453422546387
Epoch: 28, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.3848395347595215
Epoch: 29, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.269498109817505
Epoch: 30, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9479374885559082
Epoch: 31, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.226 Vali Acc: 0.916 Test Loss: 0.226 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.75502872467041
Epoch: 32, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.132089138031006
Epoch: 33, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 34 cost time: 2.4388434886932373
Epoch: 34, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.323237657546997
Epoch: 35, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956756).  Saving model ...
Epoch: 36 cost time: 2.451946258544922
Epoch: 36, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.358034610748291
Epoch: 37, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1227521896362305
Epoch: 38, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7948808670043945
Epoch: 39, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.195549249649048
Epoch: 40, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.511171579360962
Epoch: 41, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.425034999847412
Epoch: 42, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 43 cost time: 2.1283066272735596
Epoch: 43, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0779213905334473
Epoch: 44, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9498913288116455
Epoch: 45, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 46 cost time: 1.9967477321624756
Epoch: 46, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.3038079738616943
Epoch: 47, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.5135786533355713
Epoch: 48, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.209529399871826
Epoch: 49, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.819551706314087
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.098815441131592
Epoch: 51, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.4193191528320312
Epoch: 52, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.1260550022125244
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.439953327178955
Epoch: 54, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.946 Test Loss: 0.131 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.367086410522461
Epoch: 55, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 56 cost time: 2.425675868988037
Epoch: 56, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.599393129348755
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.161935806274414
Epoch: 58, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.3927435874938965
Epoch: 59, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.3082923889160156
Epoch: 60, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.9273159503936768
Epoch: 61, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.202291488647461
Epoch: 62, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.2291293144226074
Epoch: 63, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.992405891418457
Epoch: 64, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.1235313415527344
Epoch: 65, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 361209
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.0914411544799805
Epoch: 1, Steps: 17 | Train Loss: 2.315 Vali Loss: 2.190 Vali Acc: 0.097 Test Loss: 2.190 Test Acc: 0.097
Validation loss decreased (inf --> -0.097275).  Saving model ...
Epoch: 2 cost time: 1.9909427165985107
Epoch: 2, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.145 Vali Acc: 0.130 Test Loss: 2.145 Test Acc: 0.130
Validation loss decreased (-0.097275 --> -0.129708).  Saving model ...
Epoch: 3 cost time: 1.8458678722381592
Epoch: 3, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.003 Vali Acc: 0.449 Test Loss: 2.003 Test Acc: 0.449
Validation loss decreased (-0.129708 --> -0.448629).  Saving model ...
Epoch: 4 cost time: 1.9361460208892822
Epoch: 4, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.774 Vali Acc: 0.722 Test Loss: 1.774 Test Acc: 0.722
Validation loss decreased (-0.448629 --> -0.721604).  Saving model ...
Epoch: 5 cost time: 1.9898333549499512
Epoch: 5, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.391 Vali Acc: 0.816 Test Loss: 1.391 Test Acc: 0.816
Validation loss decreased (-0.721604 --> -0.816202).  Saving model ...
Epoch: 6 cost time: 1.9476468563079834
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.084 Vali Acc: 0.830 Test Loss: 1.084 Test Acc: 0.830
Validation loss decreased (-0.816202 --> -0.829719).  Saving model ...
Epoch: 7 cost time: 1.9092998504638672
Epoch: 7, Steps: 17 | Train Loss: 0.992 Vali Loss: 0.807 Vali Acc: 0.881 Test Loss: 0.807 Test Acc: 0.881
Validation loss decreased (-0.829719 --> -0.881073).  Saving model ...
Epoch: 8 cost time: 2.136589527130127
Epoch: 8, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.646 Vali Acc: 0.897 Test Loss: 0.646 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897291).  Saving model ...
Epoch: 9 cost time: 2.1704750061035156
Epoch: 9, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.474 Vali Acc: 0.927 Test Loss: 0.474 Test Acc: 0.927
Validation loss decreased (-0.897291 --> -0.927022).  Saving model ...
Epoch: 10 cost time: 2.158601999282837
Epoch: 10, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.402 Vali Acc: 0.919 Test Loss: 0.402 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9634146690368652
Epoch: 11, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.344 Vali Acc: 0.927 Test Loss: 0.344 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 2.3896002769470215
Epoch: 12, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.292 Vali Acc: 0.946 Test Loss: 0.292 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 2.0463082790374756
Epoch: 13, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.282 Vali Acc: 0.935 Test Loss: 0.282 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4178965091705322
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.277726411819458
Epoch: 15, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.303 Vali Acc: 0.916 Test Loss: 0.303 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.15612530708313
Epoch: 16, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.111396312713623
Epoch: 17, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.010246753692627
Epoch: 18, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2428383827209473
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9585072994232178
Epoch: 20, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 1.839369773864746
Epoch: 21, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 2.156355381011963
Epoch: 22, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 1.9599199295043945
Epoch: 23, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1717934608459473
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5036709308624268
Epoch: 25, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.944347381591797
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.2684245109558105
Epoch: 27, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.304206609725952
Epoch: 28, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 2.2054197788238525
Epoch: 29, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.731579065322876
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.2414627075195312
Epoch: 31, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 32 cost time: 2.276296615600586
Epoch: 32, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.4803125858306885
Epoch: 33, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.3265767097473145
Epoch: 34, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2983245849609375
Epoch: 35, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2940261363983154
Epoch: 36, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0711328983306885
Epoch: 37, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.549854040145874
Epoch: 38, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.4041152000427246
Epoch: 39, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.4900858402252197
Epoch: 40, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.469714403152466
Epoch: 41, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 361017
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.141862154006958
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 2.192 Vali Acc: 0.130 Test Loss: 2.192 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 2.735342264175415
Epoch: 2, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.128 Vali Acc: 0.219 Test Loss: 2.128 Test Acc: 0.219
Validation loss decreased (-0.129708 --> -0.218898).  Saving model ...
Epoch: 3 cost time: 2.5242059230804443
Epoch: 3, Steps: 17 | Train Loss: 2.143 Vali Loss: 2.018 Vali Acc: 0.370 Test Loss: 2.018 Test Acc: 0.370
Validation loss decreased (-0.218898 --> -0.370250).  Saving model ...
Epoch: 4 cost time: 2.6209537982940674
Epoch: 4, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.851 Vali Acc: 0.638 Test Loss: 1.851 Test Acc: 0.638
Validation loss decreased (-0.370250 --> -0.637819).  Saving model ...
Epoch: 5 cost time: 2.12559175491333
Epoch: 5, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.575 Vali Acc: 0.797 Test Loss: 1.575 Test Acc: 0.797
Validation loss decreased (-0.637819 --> -0.797282).  Saving model ...
Epoch: 6 cost time: 2.058368682861328
Epoch: 6, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.208 Vali Acc: 0.851 Test Loss: 1.208 Test Acc: 0.851
Validation loss decreased (-0.797282 --> -0.851339).  Saving model ...
Epoch: 7 cost time: 2.613898277282715
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 0.910 Vali Acc: 0.889 Test Loss: 0.910 Test Acc: 0.889
Validation loss decreased (-0.851339 --> -0.889180).  Saving model ...
Epoch: 8 cost time: 2.368960380554199
Epoch: 8, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.660 Vali Acc: 0.911 Test Loss: 0.660 Test Acc: 0.911
Validation loss decreased (-0.889180 --> -0.910804).  Saving model ...
Epoch: 9 cost time: 2.2194693088531494
Epoch: 9, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.504 Vali Acc: 0.927 Test Loss: 0.504 Test Acc: 0.927
Validation loss decreased (-0.910804 --> -0.927022).  Saving model ...
Epoch: 10 cost time: 2.1227190494537354
Epoch: 10, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.424 Vali Acc: 0.924 Test Loss: 0.424 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4870688915252686
Epoch: 11, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.330 Vali Acc: 0.935 Test Loss: 0.330 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 2.062687635421753
Epoch: 12, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940537).  Saving model ...
Epoch: 13 cost time: 2.4080095291137695
Epoch: 13, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 2.054565668106079
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.243 Vali Acc: 0.949 Test Loss: 0.243 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 2.299394369125366
Epoch: 15, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9576237201690674
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4331345558166504
Epoch: 17, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 18 cost time: 2.1527292728424072
Epoch: 18, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0889461040496826
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7293612957000732
Epoch: 20, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 2.360752820968628
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4924614429473877
Epoch: 22, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1154868602752686
Epoch: 23, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9726641178131104
Epoch: 24, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 2.1046788692474365
Epoch: 25, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.573697090148926
Epoch: 26, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7070937156677246
Epoch: 27, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.308870553970337
Epoch: 28, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 2.313514232635498
Epoch: 29, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.144237756729126
Epoch: 30, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.73101544380188
Epoch: 31, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.3534433841705322
Epoch: 32, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.4983365535736084
Epoch: 33, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.2012827396392822
Epoch: 34, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.319232702255249
Epoch: 35, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.523054838180542
Epoch: 36, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.170954942703247
Epoch: 37, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8835108280181885
Epoch: 38, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 245113
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.879199504852295
Epoch: 1, Steps: 17 | Train Loss: 2.262 Vali Loss: 2.179 Vali Acc: 0.168 Test Loss: 2.179 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 1.8339884281158447
Epoch: 2, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.136 Vali Acc: 0.157 Test Loss: 2.136 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.207090377807617
Epoch: 3, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.063 Vali Acc: 0.332 Test Loss: 2.063 Test Acc: 0.332
Validation loss decreased (-0.167546 --> -0.332412).  Saving model ...
Epoch: 4 cost time: 2.042750835418701
Epoch: 4, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.890 Vali Acc: 0.527 Test Loss: 1.890 Test Acc: 0.527
Validation loss decreased (-0.332412 --> -0.527008).  Saving model ...
Epoch: 5 cost time: 1.9772553443908691
Epoch: 5, Steps: 17 | Train Loss: 1.758 Vali Loss: 1.587 Vali Acc: 0.703 Test Loss: 1.587 Test Acc: 0.703
Validation loss decreased (-0.527008 --> -0.702687).  Saving model ...
Epoch: 6 cost time: 2.294358968734741
Epoch: 6, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.267 Vali Acc: 0.759 Test Loss: 1.267 Test Acc: 0.759
Validation loss decreased (-0.702687 --> -0.759447).  Saving model ...
Epoch: 7 cost time: 2.2045810222625732
Epoch: 7, Steps: 17 | Train Loss: 1.138 Vali Loss: 0.970 Vali Acc: 0.816 Test Loss: 0.970 Test Acc: 0.816
Validation loss decreased (-0.759447 --> -0.816207).  Saving model ...
Epoch: 8 cost time: 1.8824148178100586
Epoch: 8, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.706 Vali Acc: 0.870 Test Loss: 0.706 Test Acc: 0.870
Validation loss decreased (-0.816207 --> -0.870263).  Saving model ...
Epoch: 9 cost time: 2.0670297145843506
Epoch: 9, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
Validation loss decreased (-0.870263 --> -0.889183).  Saving model ...
Epoch: 10 cost time: 2.1273648738861084
Epoch: 10, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.465 Vali Acc: 0.914 Test Loss: 0.465 Test Acc: 0.914
Validation loss decreased (-0.889183 --> -0.913509).  Saving model ...
Epoch: 11 cost time: 2.255880355834961
Epoch: 11, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.394 Vali Acc: 0.911 Test Loss: 0.394 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9910004138946533
Epoch: 12, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.344 Vali Acc: 0.924 Test Loss: 0.344 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924321).  Saving model ...
Epoch: 13 cost time: 2.123910665512085
Epoch: 13, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929727).  Saving model ...
Epoch: 14 cost time: 1.7548749446868896
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.269 Vali Acc: 0.932 Test Loss: 0.269 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 15 cost time: 2.1261112689971924
Epoch: 15, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 16 cost time: 2.2601215839385986
Epoch: 16, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937835).  Saving model ...
Epoch: 17 cost time: 2.2918758392333984
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1675221920013428
Epoch: 18, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 2.4384779930114746
Epoch: 19, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1980478763580322
Epoch: 20, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.021700382232666
Epoch: 21, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 2.123353958129883
Epoch: 22, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.025010824203491
Epoch: 23, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3294925689697266
Epoch: 24, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1989760398864746
Epoch: 25, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 2.2184500694274902
Epoch: 26, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.166 Vali Acc: 0.935 Test Loss: 0.166 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.239276170730591
Epoch: 27, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2826240062713623
Epoch: 28, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9270191192626953
Epoch: 29, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1678695678710938
Epoch: 30, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8748819828033447
Epoch: 31, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0516748428344727
Epoch: 32, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 2.2891485691070557
Epoch: 33, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0203473567962646
Epoch: 34, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 35 cost time: 2.552964210510254
Epoch: 35, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.4359328746795654
Epoch: 36, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8367443084716797
Epoch: 37, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.941 Test Loss: 0.130 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.2437758445739746
Epoch: 38, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.191885232925415
Epoch: 39, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.3681046962738037
Epoch: 40, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.268888235092163
Epoch: 41, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.03718638420105
Epoch: 42, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.133333683013916
Epoch: 43, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.051010847091675
Epoch: 44, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 244921
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.528451204299927
Epoch: 1, Steps: 17 | Train Loss: 2.300 Vali Loss: 2.244 Vali Acc: 0.130 Test Loss: 2.244 Test Acc: 0.130
Validation loss decreased (inf --> -0.129707).  Saving model ...
Epoch: 2 cost time: 2.264354705810547
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.095 Vali Acc: 0.246 Test Loss: 2.095 Test Acc: 0.246
Validation loss decreased (-0.129707 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 1.8804895877838135
Epoch: 3, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.002 Vali Acc: 0.503 Test Loss: 2.002 Test Acc: 0.503
Validation loss decreased (-0.245925 --> -0.502683).  Saving model ...
Epoch: 4 cost time: 2.0152041912078857
Epoch: 4, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.841 Vali Acc: 0.549 Test Loss: 1.841 Test Acc: 0.549
Validation loss decreased (-0.502683 --> -0.548630).  Saving model ...
Epoch: 5 cost time: 2.3907296657562256
Epoch: 5, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.559 Vali Acc: 0.749 Test Loss: 1.559 Test Acc: 0.749
Validation loss decreased (-0.548630 --> -0.748633).  Saving model ...
Epoch: 6 cost time: 2.2699267864227295
Epoch: 6, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.169 Vali Acc: 0.841 Test Loss: 1.169 Test Acc: 0.841
Validation loss decreased (-0.748633 --> -0.840529).  Saving model ...
Epoch: 7 cost time: 1.8915934562683105
Epoch: 7, Steps: 17 | Train Loss: 1.068 Vali Loss: 0.914 Vali Acc: 0.870 Test Loss: 0.914 Test Acc: 0.870
Validation loss decreased (-0.840529 --> -0.870261).  Saving model ...
Epoch: 8 cost time: 1.893502950668335
Epoch: 8, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.666 Vali Acc: 0.895 Test Loss: 0.666 Test Acc: 0.895
Validation loss decreased (-0.870261 --> -0.894588).  Saving model ...
Epoch: 9 cost time: 2.3859755992889404
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.530 Vali Acc: 0.905 Test Loss: 0.530 Test Acc: 0.905
Validation loss decreased (-0.894588 --> -0.905400).  Saving model ...
Epoch: 10 cost time: 2.63157057762146
Epoch: 10, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.443 Vali Acc: 0.916 Test Loss: 0.443 Test Acc: 0.916
Validation loss decreased (-0.905400 --> -0.916212).  Saving model ...
Epoch: 11 cost time: 2.236283540725708
Epoch: 11, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.364 Vali Acc: 0.924 Test Loss: 0.364 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924321).  Saving model ...
Epoch: 12 cost time: 2.055837631225586
Epoch: 12, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
Validation loss decreased (-0.924321 --> -0.932429).  Saving model ...
Epoch: 13 cost time: 2.4217422008514404
Epoch: 13, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2958927154541016
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.275 Vali Acc: 0.924 Test Loss: 0.275 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0733819007873535
Epoch: 15, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 2.007354259490967
Epoch: 16, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.215 Vali Acc: 0.954 Test Loss: 0.215 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 2.510063409805298
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.242 Vali Acc: 0.927 Test Loss: 0.242 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9196462631225586
Epoch: 18, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.561610698699951
Epoch: 19, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.269749641418457
Epoch: 20, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 2.2310986518859863
Epoch: 21, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.400444269180298
Epoch: 22, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 2.2123661041259766
Epoch: 23, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.172780990600586
Epoch: 24, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.9165730476379395
Epoch: 25, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.316493034362793
Epoch: 26, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1594462394714355
Epoch: 27, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4817757606506348
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 2.842160701751709
Epoch: 29, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0581283569335938
Epoch: 30, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.0434467792510986
Epoch: 31, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.31390118598938
Epoch: 32, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.3856124877929688
Epoch: 33, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.033449411392212
Epoch: 34, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.2970848083496094
Epoch: 35, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.3467142581939697
Epoch: 36, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.670957565307617
Epoch: 37, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.113131284713745
Epoch: 38, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 244729
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.389389991760254
Epoch: 1, Steps: 17 | Train Loss: 2.300 Vali Loss: 2.237 Vali Acc: 0.151 Test Loss: 2.237 Test Acc: 0.151
Validation loss decreased (inf --> -0.151329).  Saving model ...
Epoch: 2 cost time: 1.9376707077026367
Epoch: 2, Steps: 17 | Train Loss: 2.182 Vali Loss: 2.113 Vali Acc: 0.319 Test Loss: 2.113 Test Acc: 0.319
Validation loss decreased (-0.151329 --> -0.318898).  Saving model ...
Epoch: 3 cost time: 2.1934077739715576
Epoch: 3, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.025 Vali Acc: 0.395 Test Loss: 2.025 Test Acc: 0.395
Validation loss decreased (-0.318898 --> -0.394574).  Saving model ...
Epoch: 4 cost time: 2.426300525665283
Epoch: 4, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.883 Vali Acc: 0.581 Test Loss: 1.883 Test Acc: 0.581
Validation loss decreased (-0.394574 --> -0.581062).  Saving model ...
Epoch: 5 cost time: 2.0486080646514893
Epoch: 5, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.602 Vali Acc: 0.759 Test Loss: 1.602 Test Acc: 0.759
Validation loss decreased (-0.581062 --> -0.759443).  Saving model ...
Epoch: 6 cost time: 1.9798038005828857
Epoch: 6, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.261 Vali Acc: 0.816 Test Loss: 1.261 Test Acc: 0.816
Validation loss decreased (-0.759443 --> -0.816204).  Saving model ...
Epoch: 7 cost time: 2.0922892093658447
Epoch: 7, Steps: 17 | Train Loss: 1.158 Vali Loss: 0.926 Vali Acc: 0.881 Test Loss: 0.926 Test Acc: 0.881
Validation loss decreased (-0.816204 --> -0.881072).  Saving model ...
Epoch: 8 cost time: 1.9082534313201904
Epoch: 8, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.693 Vali Acc: 0.892 Test Loss: 0.693 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891885).  Saving model ...
Epoch: 9 cost time: 2.107558488845825
Epoch: 9, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.518 Vali Acc: 0.908 Test Loss: 0.518 Test Acc: 0.908
Validation loss decreased (-0.891885 --> -0.908103).  Saving model ...
Epoch: 10 cost time: 2.314652442932129
Epoch: 10, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910807).  Saving model ...
Epoch: 11 cost time: 1.8925161361694336
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.335 Vali Acc: 0.927 Test Loss: 0.335 Test Acc: 0.927
Validation loss decreased (-0.910807 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 2.036923885345459
Epoch: 12, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.302 Vali Acc: 0.932 Test Loss: 0.302 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932429).  Saving model ...
Epoch: 13 cost time: 1.9408624172210693
Epoch: 13, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.394556999206543
Epoch: 14, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.239 Vali Acc: 0.932 Test Loss: 0.239 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 15 cost time: 2.3298704624176025
Epoch: 15, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 16 cost time: 2.240572690963745
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 2.406501293182373
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 2.1986050605773926
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2172582149505615
Epoch: 19, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2740120887756348
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 2.3577802181243896
Epoch: 21, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 2.0571329593658447
Epoch: 22, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.163846969604492
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9681150913238525
Epoch: 24, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.088202953338623
Epoch: 25, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 1.9006717205047607
Epoch: 26, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.185485601425171
Epoch: 27, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9013173580169678
Epoch: 28, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1100354194641113
Epoch: 29, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 30 cost time: 2.0897977352142334
Epoch: 30, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4945034980773926
Epoch: 31, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.946 Test Loss: 0.131 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3192741870880127
Epoch: 32, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.130 Vali Acc: 0.943 Test Loss: 0.130 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.32552170753479
Epoch: 33, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.402597665786743
Epoch: 34, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2725539207458496
Epoch: 35, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 36 cost time: 1.9143805503845215
Epoch: 36, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.941 Test Loss: 0.132 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.107027530670166
Epoch: 37, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.932 Test Loss: 0.152 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.360400915145874
Epoch: 38, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.167325735092163
Epoch: 39, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.949 Test Loss: 0.124 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9127578735351562
Epoch: 40, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.9306113719940186
Epoch: 41, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.4117987155914307
Epoch: 42, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.860351324081421
Epoch: 43, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.957 Test Loss: 0.107 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 44 cost time: 2.5996041297912598
Epoch: 44, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.55729079246521
Epoch: 45, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9904248714447021
Epoch: 46, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.1837592124938965
Epoch: 47, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.956756 --> -0.967566).  Saving model ...
Epoch: 48 cost time: 2.001716136932373
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.140681505203247
Epoch: 49, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.0731360912323
Epoch: 50, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.949 Test Loss: 0.113 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.0204076766967773
Epoch: 51, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.119995594024658
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.943 Test Loss: 0.134 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.147988796234131
Epoch: 53, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.8706188201904297
Epoch: 54, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.957 Test Loss: 0.107 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.9357342720031738
Epoch: 55, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.1337859630584717
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.06113338470459
Epoch: 57, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.954 Test Loss: 0.116 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 244537
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.742435693740845
Epoch: 1, Steps: 17 | Train Loss: 2.369 Vali Loss: 2.171 Vali Acc: 0.203 Test Loss: 2.171 Test Acc: 0.203
Validation loss decreased (inf --> -0.202681).  Saving model ...
Epoch: 2 cost time: 2.382889986038208
Epoch: 2, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.139 Vali Acc: 0.197 Test Loss: 2.139 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.678009033203125
Epoch: 3, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.093 Vali Acc: 0.395 Test Loss: 2.093 Test Acc: 0.395
Validation loss decreased (-0.202681 --> -0.394574).  Saving model ...
Epoch: 4 cost time: 2.5007874965667725
Epoch: 4, Steps: 17 | Train Loss: 2.067 Vali Loss: 1.973 Vali Acc: 0.562 Test Loss: 1.973 Test Acc: 0.562
Validation loss decreased (-0.394574 --> -0.562142).  Saving model ...
Epoch: 5 cost time: 2.750371217727661
Epoch: 5, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.807 Vali Acc: 0.562 Test Loss: 1.807 Test Acc: 0.562
Validation loss decreased (-0.562142 --> -0.562144).  Saving model ...
Epoch: 6 cost time: 2.3888020515441895
Epoch: 6, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.511 Vali Acc: 0.778 Test Loss: 1.511 Test Acc: 0.778
Validation loss decreased (-0.562144 --> -0.778363).  Saving model ...
Epoch: 7 cost time: 2.3132741451263428
Epoch: 7, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.170 Vali Acc: 0.827 Test Loss: 1.170 Test Acc: 0.827
Validation loss decreased (-0.778363 --> -0.827015).  Saving model ...
Epoch: 8 cost time: 2.620765447616577
Epoch: 8, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.870 Vali Acc: 0.854 Test Loss: 0.870 Test Acc: 0.854
Validation loss decreased (-0.827015 --> -0.854045).  Saving model ...
Epoch: 9 cost time: 2.6041336059570312
Epoch: 9, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.606 Vali Acc: 0.873 Test Loss: 0.606 Test Acc: 0.873
Validation loss decreased (-0.854045 --> -0.872967).  Saving model ...
Epoch: 10 cost time: 2.1907124519348145
Epoch: 10, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.475 Vali Acc: 0.897 Test Loss: 0.475 Test Acc: 0.897
Validation loss decreased (-0.872967 --> -0.897293).  Saving model ...
Epoch: 11 cost time: 2.2332823276519775
Epoch: 11, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.406 Vali Acc: 0.895 Test Loss: 0.406 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2808685302734375
Epoch: 12, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.330 Vali Acc: 0.905 Test Loss: 0.330 Test Acc: 0.905
Validation loss decreased (-0.897293 --> -0.905402).  Saving model ...
Epoch: 13 cost time: 2.276949167251587
Epoch: 13, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.291 Vali Acc: 0.914 Test Loss: 0.291 Test Acc: 0.914
Validation loss decreased (-0.905402 --> -0.913511).  Saving model ...
Epoch: 14 cost time: 2.2684412002563477
Epoch: 14, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
Validation loss decreased (-0.913511 --> -0.932430).  Saving model ...
Epoch: 15 cost time: 2.2746777534484863
Epoch: 15, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.254 Vali Acc: 0.924 Test Loss: 0.254 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.326150417327881
Epoch: 16, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 17 cost time: 2.2750279903411865
Epoch: 17, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.096052408218384
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 2.3705852031707764
Epoch: 19, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3476924896240234
Epoch: 20, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.579760789871216
Epoch: 21, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5720629692077637
Epoch: 22, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 23 cost time: 2.134566068649292
Epoch: 23, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.127122640609741
Epoch: 24, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 25 cost time: 2.1860032081604004
Epoch: 25, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6008598804473877
Epoch: 26, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.26588773727417
Epoch: 27, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 28 cost time: 2.289767265319824
Epoch: 28, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.440314769744873
Epoch: 29, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 2.270106554031372
Epoch: 30, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1506168842315674
Epoch: 31, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 2.2202861309051514
Epoch: 32, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2011961936950684
Epoch: 33, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.6113672256469727
Epoch: 34, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.528627395629883
Epoch: 35, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.296064615249634
Epoch: 36, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.935 Test Loss: 0.155 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.38987135887146
Epoch: 37, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.2319207191467285
Epoch: 38, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.3800570964813232
Epoch: 39, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.526973247528076
Epoch: 40, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.147 Vali Acc: 0.935 Test Loss: 0.147 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.4331536293029785
Epoch: 41, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 186873
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.834988594055176
Epoch: 1, Steps: 17 | Train Loss: 2.388 Vali Loss: 2.221 Vali Acc: 0.103 Test Loss: 2.221 Test Acc: 0.103
Validation loss decreased (inf --> -0.102680).  Saving model ...
Epoch: 2 cost time: 2.2406725883483887
Epoch: 2, Steps: 17 | Train Loss: 2.237 Vali Loss: 2.157 Vali Acc: 0.205 Test Loss: 2.157 Test Acc: 0.205
Validation loss decreased (-0.102680 --> -0.205384).  Saving model ...
Epoch: 3 cost time: 2.5475661754608154
Epoch: 3, Steps: 17 | Train Loss: 2.139 Vali Loss: 2.094 Vali Acc: 0.214 Test Loss: 2.094 Test Acc: 0.214
Validation loss decreased (-0.205384 --> -0.213493).  Saving model ...
Epoch: 4 cost time: 2.3841304779052734
Epoch: 4, Steps: 17 | Train Loss: 2.046 Vali Loss: 1.943 Vali Acc: 0.508 Test Loss: 1.943 Test Acc: 0.508
Validation loss decreased (-0.213493 --> -0.508089).  Saving model ...
Epoch: 5 cost time: 1.8967692852020264
Epoch: 5, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.792 Vali Acc: 0.500 Test Loss: 1.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.102686882019043
Epoch: 6, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.483 Vali Acc: 0.716 Test Loss: 1.483 Test Acc: 0.716
Validation loss decreased (-0.508089 --> -0.716201).  Saving model ...
Epoch: 7 cost time: 2.2676517963409424
Epoch: 7, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.198 Vali Acc: 0.784 Test Loss: 1.198 Test Acc: 0.784
Validation loss decreased (-0.716201 --> -0.783772).  Saving model ...
Epoch: 8 cost time: 2.116032838821411
Epoch: 8, Steps: 17 | Train Loss: 1.026 Vali Loss: 0.864 Vali Acc: 0.854 Test Loss: 0.864 Test Acc: 0.854
Validation loss decreased (-0.783772 --> -0.854045).  Saving model ...
Epoch: 9 cost time: 2.157393455505371
Epoch: 9, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.681 Vali Acc: 0.876 Test Loss: 0.681 Test Acc: 0.876
Validation loss decreased (-0.854045 --> -0.875669).  Saving model ...
Epoch: 10 cost time: 2.042184591293335
Epoch: 10, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.530 Vali Acc: 0.892 Test Loss: 0.530 Test Acc: 0.892
Validation loss decreased (-0.875669 --> -0.891887).  Saving model ...
Epoch: 11 cost time: 1.949570894241333
Epoch: 11, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.454 Vali Acc: 0.903 Test Loss: 0.454 Test Acc: 0.903
Validation loss decreased (-0.891887 --> -0.902698).  Saving model ...
Epoch: 12 cost time: 2.102790117263794
Epoch: 12, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.369 Vali Acc: 0.916 Test Loss: 0.369 Test Acc: 0.916
Validation loss decreased (-0.902698 --> -0.916213).  Saving model ...
Epoch: 13 cost time: 2.076078176498413
Epoch: 13, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.323 Vali Acc: 0.916 Test Loss: 0.323 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 14 cost time: 1.9988267421722412
Epoch: 14, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 15 cost time: 2.1702218055725098
Epoch: 15, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 16 cost time: 2.2216131687164307
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 17 cost time: 2.142531633377075
Epoch: 17, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937835).  Saving model ...
Epoch: 18 cost time: 2.3170387744903564
Epoch: 18, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.280 Vali Acc: 0.914 Test Loss: 0.280 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.098262310028076
Epoch: 19, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 20 cost time: 2.6491634845733643
Epoch: 20, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 21 cost time: 1.8962576389312744
Epoch: 21, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.940539 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 2.2026655673980713
Epoch: 22, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9431352615356445
Epoch: 23, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.005730390548706
Epoch: 24, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0974888801574707
Epoch: 25, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9818470478057861
Epoch: 26, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0838398933410645
Epoch: 27, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0682289600372314
Epoch: 28, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7320168018341064
Epoch: 29, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8788871765136719
Epoch: 30, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.038562059402466
Epoch: 31, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 186681
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.609929800033569
Epoch: 1, Steps: 17 | Train Loss: 2.300 Vali Loss: 2.173 Vali Acc: 0.176 Test Loss: 2.173 Test Acc: 0.176
Validation loss decreased (inf --> -0.175654).  Saving model ...
Epoch: 2 cost time: 2.41171932220459
Epoch: 2, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.141 Vali Acc: 0.224 Test Loss: 2.141 Test Acc: 0.224
Validation loss decreased (-0.175654 --> -0.224303).  Saving model ...
Epoch: 3 cost time: 2.1857047080993652
Epoch: 3, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.061 Vali Acc: 0.322 Test Loss: 2.061 Test Acc: 0.322
Validation loss decreased (-0.224303 --> -0.321601).  Saving model ...
Epoch: 4 cost time: 2.2350847721099854
Epoch: 4, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.888 Vali Acc: 0.595 Test Loss: 1.888 Test Acc: 0.595
Validation loss decreased (-0.321601 --> -0.594576).  Saving model ...
Epoch: 5 cost time: 2.1759612560272217
Epoch: 5, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.655 Vali Acc: 0.743 Test Loss: 1.655 Test Acc: 0.743
Validation loss decreased (-0.594576 --> -0.743227).  Saving model ...
Epoch: 6 cost time: 2.3438429832458496
Epoch: 6, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.302 Vali Acc: 0.789 Test Loss: 1.302 Test Acc: 0.789
Validation loss decreased (-0.743227 --> -0.789176).  Saving model ...
Epoch: 7 cost time: 2.4694900512695312
Epoch: 7, Steps: 17 | Train Loss: 1.159 Vali Loss: 0.974 Vali Acc: 0.884 Test Loss: 0.974 Test Acc: 0.884
Validation loss decreased (-0.789176 --> -0.883774).  Saving model ...
Epoch: 8 cost time: 2.831476926803589
Epoch: 8, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.716 Vali Acc: 0.900 Test Loss: 0.716 Test Acc: 0.900
Validation loss decreased (-0.883774 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 2.0917303562164307
Epoch: 9, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.570 Vali Acc: 0.919 Test Loss: 0.570 Test Acc: 0.919
Validation loss decreased (-0.899993 --> -0.918913).  Saving model ...
Epoch: 10 cost time: 2.0142862796783447
Epoch: 10, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.435 Vali Acc: 0.927 Test Loss: 0.435 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927023).  Saving model ...
Epoch: 11 cost time: 2.3020577430725098
Epoch: 11, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.381 Vali Acc: 0.935 Test Loss: 0.381 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 2.3137807846069336
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.366 Vali Acc: 0.930 Test Loss: 0.366 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.607671022415161
Epoch: 13, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.319 Vali Acc: 0.938 Test Loss: 0.319 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 14 cost time: 2.403373956680298
Epoch: 14, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 15 cost time: 2.2625410556793213
Epoch: 15, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.298520565032959
Epoch: 16, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 17 cost time: 2.0500500202178955
Epoch: 17, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0691418647766113
Epoch: 18, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3473894596099854
Epoch: 19, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 2.215226650238037
Epoch: 20, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.145832061767578
Epoch: 21, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 1.9254603385925293
Epoch: 22, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.002032518386841
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3162715435028076
Epoch: 24, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 2.3771839141845703
Epoch: 25, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 2.6201012134552
Epoch: 26, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4102494716644287
Epoch: 27, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9355695247650146
Epoch: 28, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3571274280548096
Epoch: 29, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.5842742919921875
Epoch: 30, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2941246032714844
Epoch: 31, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 2.358273983001709
Epoch: 32, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.8484628200531006
Epoch: 33, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2864670753479004
Epoch: 34, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.4656498432159424
Epoch: 35, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0444955825805664
Epoch: 36, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.8792777061462402
Epoch: 37, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.1962618827819824
Epoch: 38, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.0737292766571045
Epoch: 39, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.3916780948638916
Epoch: 40, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.370487928390503
Epoch: 41, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 186489
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.257709503173828
Epoch: 1, Steps: 17 | Train Loss: 2.279 Vali Loss: 2.148 Vali Acc: 0.276 Test Loss: 2.148 Test Acc: 0.276
Validation loss decreased (inf --> -0.275654).  Saving model ...
Epoch: 2 cost time: 2.233214855194092
Epoch: 2, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.106 Vali Acc: 0.300 Test Loss: 2.106 Test Acc: 0.300
Validation loss decreased (-0.275654 --> -0.299979).  Saving model ...
Epoch: 3 cost time: 2.0651354789733887
Epoch: 3, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.043 Vali Acc: 0.335 Test Loss: 2.043 Test Acc: 0.335
Validation loss decreased (-0.299979 --> -0.335115).  Saving model ...
Epoch: 4 cost time: 2.1073262691497803
Epoch: 4, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.903 Vali Acc: 0.538 Test Loss: 1.903 Test Acc: 0.538
Validation loss decreased (-0.335115 --> -0.537819).  Saving model ...
Epoch: 5 cost time: 2.229625701904297
Epoch: 5, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.693 Vali Acc: 0.668 Test Loss: 1.693 Test Acc: 0.668
Validation loss decreased (-0.537819 --> -0.667551).  Saving model ...
Epoch: 6 cost time: 2.2532005310058594
Epoch: 6, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.451 Vali Acc: 0.773 Test Loss: 1.451 Test Acc: 0.773
Validation loss decreased (-0.667551 --> -0.772958).  Saving model ...
Epoch: 7 cost time: 1.9699232578277588
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.126 Vali Acc: 0.841 Test Loss: 1.126 Test Acc: 0.841
Validation loss decreased (-0.772958 --> -0.840529).  Saving model ...
Epoch: 8 cost time: 2.5176267623901367
Epoch: 8, Steps: 17 | Train Loss: 0.989 Vali Loss: 0.829 Vali Acc: 0.868 Test Loss: 0.829 Test Acc: 0.868
Validation loss decreased (-0.840529 --> -0.867559).  Saving model ...
Epoch: 9 cost time: 2.278531789779663
Epoch: 9, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.652 Vali Acc: 0.876 Test Loss: 0.652 Test Acc: 0.876
Validation loss decreased (-0.867559 --> -0.875669).  Saving model ...
Epoch: 10 cost time: 2.2093634605407715
Epoch: 10, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.500 Vali Acc: 0.895 Test Loss: 0.500 Test Acc: 0.895
Validation loss decreased (-0.875669 --> -0.894590).  Saving model ...
Epoch: 11 cost time: 2.4343080520629883
Epoch: 11, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.894590 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 2.2652535438537598
Epoch: 12, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
Validation loss decreased (-0.899996 --> -0.918915).  Saving model ...
Epoch: 13 cost time: 2.071239948272705
Epoch: 13, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
Validation loss decreased (-0.918915 --> -0.929727).  Saving model ...
Epoch: 14 cost time: 2.1062231063842773
Epoch: 14, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.294 Vali Acc: 0.935 Test Loss: 0.294 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935132).  Saving model ...
Epoch: 15 cost time: 2.178138256072998
Epoch: 15, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.271 Vali Acc: 0.932 Test Loss: 0.271 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5663459300994873
Epoch: 16, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.152592658996582
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.209984302520752
Epoch: 18, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937836).  Saving model ...
Epoch: 19 cost time: 1.798271656036377
Epoch: 19, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 20 cost time: 2.303602457046509
Epoch: 20, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 21 cost time: 2.0414600372314453
Epoch: 21, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8449440002441406
Epoch: 22, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 2.032442569732666
Epoch: 23, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.995039463043213
Epoch: 24, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9058494567871094
Epoch: 25, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.012235403060913
Epoch: 26, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9561049938201904
Epoch: 27, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.173 Vali Acc: 0.927 Test Loss: 0.173 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0127718448638916
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 2.2417666912078857
Epoch: 29, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 2.030182361602783
Epoch: 30, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0462183952331543
Epoch: 31, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 32 cost time: 1.7838177680969238
Epoch: 32, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.224266767501831
Epoch: 33, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0261826515197754
Epoch: 34, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 35 cost time: 1.6922070980072021
Epoch: 35, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 2.0254766941070557
Epoch: 36, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8798823356628418
Epoch: 37, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.046773672103882
Epoch: 38, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9576311111450195
Epoch: 39, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.122657537460327
Epoch: 40, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.2706737518310547
Epoch: 41, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.295379161834717
Epoch: 42, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7717223167419434
Epoch: 43, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 44 cost time: 2.1613495349884033
Epoch: 44, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.157888412475586
Epoch: 45, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.1842856407165527
Epoch: 46, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.9979937076568604
Epoch: 47, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.0075902938842773
Epoch: 48, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 49 cost time: 1.746558666229248
Epoch: 49, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.0892019271850586
Epoch: 50, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.5213663578033447
Epoch: 51, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.341261148452759
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.946 Test Loss: 0.126 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.981031656265259
Epoch: 53, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.0566532611846924
Epoch: 54, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.111112356185913
Epoch: 55, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.1976118087768555
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.099788188934326
Epoch: 57, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.941 Test Loss: 0.141 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.918487787246704
Epoch: 58, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.914 Test Loss: 0.216 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 186297
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.492474317550659
Epoch: 1, Steps: 17 | Train Loss: 2.325 Vali Loss: 2.022 Vali Acc: 0.143 Test Loss: 2.022 Test Acc: 0.143
Validation loss decreased (inf --> -0.143223).  Saving model ...
Epoch: 2 cost time: 1.545104742050171
Epoch: 2, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.387 Vali Acc: 0.538 Test Loss: 1.387 Test Acc: 0.538
Validation loss decreased (-0.143223 --> -0.537824).  Saving model ...
Epoch: 3 cost time: 1.5476946830749512
Epoch: 3, Steps: 17 | Train Loss: 0.967 Vali Loss: 0.536 Vali Acc: 0.846 Test Loss: 0.536 Test Acc: 0.846
Validation loss decreased (-0.537824 --> -0.845941).  Saving model ...
Epoch: 4 cost time: 1.654911994934082
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
Validation loss decreased (-0.845941 --> -0.927025).  Saving model ...
Epoch: 5 cost time: 1.5673396587371826
Epoch: 5, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929728).  Saving model ...
Epoch: 6 cost time: 1.824707269668579
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.559936761856079
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5797486305236816
Epoch: 8, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.479 Vali Acc: 0.865 Test Loss: 0.479 Test Acc: 0.865
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6210901737213135
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
Validation loss decreased (-0.929728 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.6643035411834717
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7206230163574219
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.611767292022705
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 1.8252835273742676
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.6477174758911133
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6257002353668213
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8949944972991943
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.017087459564209
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.840172529220581
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 1.6529064178466797
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6459167003631592
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 1.9422826766967773
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.7936110496520996
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7520561218261719
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6572561264038086
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.5846247673034668
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 1.726672887802124
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.758373737335205
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.857551097869873
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8330745697021484
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 1.941622257232666
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 1.447540044784546
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.778531789779663
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7682771682739258
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.813185453414917
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 1.3691332340240479
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 1.7233891487121582
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.4985663890838623
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4783079624176025
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.690795660018921
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.763411521911621
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7635815143585205
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.7552094459533691
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.092128038406372
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.1799168586730957
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3851876258850098
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 46 cost time: 1.9606139659881592
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.6072852611541748
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.9232170581817627
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.906052589416504
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.9022102355957031
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.5371921062469482
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.5709528923034668
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.948481798171997
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.7373194694519043
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.8581624031066895
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 7989037
model size : 35.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4115893840789795
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 1.909 Vali Acc: 0.400 Test Loss: 1.909 Test Acc: 0.400
Validation loss decreased (inf --> -0.399981).  Saving model ...
Epoch: 2 cost time: 2.049358367919922
Epoch: 2, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.181 Vali Acc: 0.686 Test Loss: 1.181 Test Acc: 0.686
Validation loss decreased (-0.399981 --> -0.686475).  Saving model ...
Epoch: 3 cost time: 1.6053040027618408
Epoch: 3, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.420 Vali Acc: 0.908 Test Loss: 0.420 Test Acc: 0.908
Validation loss decreased (-0.686475 --> -0.908104).  Saving model ...
Epoch: 4 cost time: 1.7435297966003418
Epoch: 4, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
Validation loss decreased (-0.908104 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.4657840728759766
Epoch: 5, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.273 Vali Acc: 0.908 Test Loss: 0.273 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.772864818572998
Epoch: 6, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7175452709197998
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.351 Vali Acc: 0.886 Test Loss: 0.351 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.913055181503296
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5642824172973633
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.275 Vali Acc: 0.927 Test Loss: 0.275 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.90159273147583
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.309 Vali Acc: 0.908 Test Loss: 0.309 Test Acc: 0.908
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.779691219329834
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.354 Vali Acc: 0.905 Test Loss: 0.354 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8647608757019043
Epoch: 12, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 1.810239553451538
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6668026447296143
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.162 Vali Acc: 0.935 Test Loss: 0.162 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8612205982208252
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.927 Test Loss: 0.208 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5795643329620361
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 1.7018117904663086
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8533742427825928
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.6723690032958984
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6379108428955078
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.541595220565796
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.59088134765625
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6450531482696533
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7977755069732666
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.503842830657959
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6059355735778809
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.523533582687378
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.091730833053589
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 7987757
model size : 35.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7418181896209717
Epoch: 1, Steps: 17 | Train Loss: 2.323 Vali Loss: 1.924 Vali Acc: 0.230 Test Loss: 1.924 Test Acc: 0.230
Validation loss decreased (inf --> -0.229710).  Saving model ...
Epoch: 2 cost time: 2.1191513538360596
Epoch: 2, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.258 Vali Acc: 0.759 Test Loss: 1.258 Test Acc: 0.759
Validation loss decreased (-0.229710 --> -0.759447).  Saving model ...
Epoch: 3 cost time: 1.9121150970458984
Epoch: 3, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.479 Vali Acc: 0.886 Test Loss: 0.479 Test Acc: 0.886
Validation loss decreased (-0.759447 --> -0.886482).  Saving model ...
Epoch: 4 cost time: 1.538405179977417
Epoch: 4, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.244 Vali Acc: 0.914 Test Loss: 0.244 Test Acc: 0.914
Validation loss decreased (-0.886482 --> -0.913511).  Saving model ...
Epoch: 5 cost time: 1.6518239974975586
Epoch: 5, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
Validation loss decreased (-0.913511 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.7806825637817383
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.488976240158081
Epoch: 7, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7222816944122314
Epoch: 8, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4933159351348877
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5626368522644043
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.6265161037445068
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.584679126739502
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.7341711521148682
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.6123921871185303
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.932 Test Loss: 0.246 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0875773429870605
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9579095840454102
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.8217241764068604
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9382140636444092
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6864490509033203
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.800048828125
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7746529579162598
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9947755336761475
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0006215572357178
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6515216827392578
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6895346641540527
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8488893508911133
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 7986477
model size : 35.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.134033918380737
Epoch: 1, Steps: 17 | Train Loss: 2.304 Vali Loss: 1.975 Vali Acc: 0.149 Test Loss: 1.975 Test Acc: 0.149
Validation loss decreased (inf --> -0.148629).  Saving model ...
Epoch: 2 cost time: 1.888279914855957
Epoch: 2, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.233 Vali Acc: 0.746 Test Loss: 1.233 Test Acc: 0.746
Validation loss decreased (-0.148629 --> -0.745934).  Saving model ...
Epoch: 3 cost time: 1.8837542533874512
Epoch: 3, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
Validation loss decreased (-0.745934 --> -0.899996).  Saving model ...
Epoch: 4 cost time: 1.6349430084228516
Epoch: 4, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
Validation loss decreased (-0.899996 --> -0.937836).  Saving model ...
Epoch: 5 cost time: 1.6592135429382324
Epoch: 5, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 2.0589137077331543
Epoch: 6, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.349 Vali Acc: 0.886 Test Loss: 0.349 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8636984825134277
Epoch: 7, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.76829195022583
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9009313583374023
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 1.7249538898468018
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6293768882751465
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 2.0745370388031006
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 13 cost time: 1.8954756259918213
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7535679340362549
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3315765857696533
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9977593421936035
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9019577503204346
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.932 Test Loss: 0.173 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3605480194091797
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.328 Vali Acc: 0.914 Test Loss: 0.328 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0099711418151855
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8307569026947021
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.164851665496826
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.956756 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 2.025951862335205
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.231872081756592
Epoch: 23, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7112057209014893
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.924 Test Loss: 0.241 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8834006786346436
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.23553729057312
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.198953628540039
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.446293592453003
Epoch: 28, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1074154376983643
Epoch: 29, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.338 Vali Acc: 0.927 Test Loss: 0.338 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2146480083465576
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.088207721710205
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 7985197
model size : 35.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.12221884727478
Epoch: 1, Steps: 17 | Train Loss: 2.331 Vali Loss: 2.104 Vali Acc: 0.222 Test Loss: 2.104 Test Acc: 0.222
Validation loss decreased (inf --> -0.221601).  Saving model ...
Epoch: 2 cost time: 1.8056974411010742
Epoch: 2, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.673 Vali Acc: 0.400 Test Loss: 1.673 Test Acc: 0.400
Validation loss decreased (-0.221601 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 1.7968013286590576
Epoch: 3, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.786 Vali Acc: 0.773 Test Loss: 0.786 Test Acc: 0.773
Validation loss decreased (-0.399983 --> -0.772965).  Saving model ...
Epoch: 4 cost time: 1.6208739280700684
Epoch: 4, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
Validation loss decreased (-0.772965 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 1.8229899406433105
Epoch: 5, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.226 Vali Acc: 0.916 Test Loss: 0.226 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.839005470275879
Epoch: 6, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.288 Vali Acc: 0.897 Test Loss: 0.288 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0287930965423584
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.215 Vali Acc: 0.914 Test Loss: 0.215 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8746256828308105
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.227 Vali Acc: 0.905 Test Loss: 0.227 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.073939561843872
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 10 cost time: 1.9847323894500732
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.232 Vali Acc: 0.916 Test Loss: 0.232 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8605754375457764
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
Validation loss decreased (-0.932430 --> -0.956756).  Saving model ...
Epoch: 12 cost time: 1.7900645732879639
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.914 Test Loss: 0.215 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8665215969085693
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8420381546020508
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6615383625030518
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2768144607543945
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.956756 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 1.7473037242889404
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7100956439971924
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.965670108795166
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.908583164215088
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7922325134277344
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7212615013122559
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6169519424438477
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.717280387878418
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.752809762954712
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6552512645721436
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 6675757
model size : 30.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6326491832733154
Epoch: 1, Steps: 17 | Train Loss: 2.225 Vali Loss: 1.936 Vali Acc: 0.384 Test Loss: 1.936 Test Acc: 0.384
Validation loss decreased (inf --> -0.383764).  Saving model ...
Epoch: 2 cost time: 1.6506338119506836
Epoch: 2, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.248 Vali Acc: 0.716 Test Loss: 1.248 Test Acc: 0.716
Validation loss decreased (-0.383764 --> -0.716204).  Saving model ...
Epoch: 3 cost time: 1.62241792678833
Epoch: 3, Steps: 17 | Train Loss: 0.897 Vali Loss: 0.467 Vali Acc: 0.924 Test Loss: 0.467 Test Acc: 0.924
Validation loss decreased (-0.716204 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 1.8187940120697021
Epoch: 4, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.924320 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 1.8513975143432617
Epoch: 5, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.253 Vali Acc: 0.916 Test Loss: 0.253 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.866276741027832
Epoch: 6, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 1.9857580661773682
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7954692840576172
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.886286973953247
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.168328285217285
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8579261302947998
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.246 Vali Acc: 0.905 Test Loss: 0.246 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.164844036102295
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 2.060276985168457
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 2.154994010925293
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1563684940338135
Epoch: 15, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9919052124023438
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.938 Test Loss: 0.214 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9050474166870117
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8629941940307617
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.124638557434082
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.848827600479126
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.089567184448242
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9574954509735107
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1487300395965576
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 6674477
model size : 30.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5242936611175537
Epoch: 1, Steps: 17 | Train Loss: 2.324 Vali Loss: 2.040 Vali Acc: 0.232 Test Loss: 2.040 Test Acc: 0.232
Validation loss decreased (inf --> -0.232412).  Saving model ...
Epoch: 2 cost time: 1.4872987270355225
Epoch: 2, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.461 Vali Acc: 0.611 Test Loss: 1.461 Test Acc: 0.611
Validation loss decreased (-0.232412 --> -0.610796).  Saving model ...
Epoch: 3 cost time: 2.0235188007354736
Epoch: 3, Steps: 17 | Train Loss: 1.027 Vali Loss: 0.623 Vali Acc: 0.862 Test Loss: 0.623 Test Acc: 0.862
Validation loss decreased (-0.610796 --> -0.862156).  Saving model ...
Epoch: 4 cost time: 1.6330232620239258
Epoch: 4, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.262 Vali Acc: 0.935 Test Loss: 0.262 Test Acc: 0.935
Validation loss decreased (-0.862156 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.6023061275482178
Epoch: 5, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.935133 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 1.9056904315948486
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0861599445343018
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7769153118133545
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8314745426177979
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.172978401184082
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0321543216705322
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.98842453956604
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8937749862670898
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.9296982288360596
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9795196056365967
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.274686336517334
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0201189517974854
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.319080352783203
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.9742562770843506
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1166152954101562
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2197535037994385
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0395753383636475
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.310 Vali Acc: 0.916 Test Loss: 0.310 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3338611125946045
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4191226959228516
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.327831268310547
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1275453567504883
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3170759677886963
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.2835373878479004
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 6673197
model size : 30.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.051614284515381
Epoch: 1, Steps: 17 | Train Loss: 2.329 Vali Loss: 1.934 Vali Acc: 0.476 Test Loss: 1.934 Test Acc: 0.476
Validation loss decreased (inf --> -0.475656).  Saving model ...
Epoch: 2 cost time: 1.8219916820526123
Epoch: 2, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.364 Vali Acc: 0.708 Test Loss: 1.364 Test Acc: 0.708
Validation loss decreased (-0.475656 --> -0.708094).  Saving model ...
Epoch: 3 cost time: 1.8107678890228271
Epoch: 3, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.523 Vali Acc: 0.865 Test Loss: 0.523 Test Acc: 0.865
Validation loss decreased (-0.708094 --> -0.864860).  Saving model ...
Epoch: 4 cost time: 2.2797327041625977
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
Validation loss decreased (-0.864860 --> -0.927025).  Saving model ...
Epoch: 5 cost time: 2.0617380142211914
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.927025 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.9376311302185059
Epoch: 6, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.937836 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.7612497806549072
Epoch: 7, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.367 Vali Acc: 0.895 Test Loss: 0.367 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0061538219451904
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1291871070861816
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0859076976776123
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.373321771621704
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0594074726104736
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.125197172164917
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9420621395111084
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1077702045440674
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.377 Vali Acc: 0.908 Test Loss: 0.377 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8920469284057617
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 6671917
model size : 30.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.101256608963013
Epoch: 1, Steps: 17 | Train Loss: 2.287 Vali Loss: 2.017 Vali Acc: 0.346 Test Loss: 2.017 Test Acc: 0.346
Validation loss decreased (inf --> -0.345926).  Saving model ...
Epoch: 2 cost time: 2.092806816101074
Epoch: 2, Steps: 17 | Train Loss: 1.789 Vali Loss: 1.671 Vali Acc: 0.400 Test Loss: 1.671 Test Acc: 0.400
Validation loss decreased (-0.345926 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 2.2700603008270264
Epoch: 3, Steps: 17 | Train Loss: 1.157 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
Validation loss decreased (-0.399983 --> -0.818911).  Saving model ...
Epoch: 4 cost time: 2.1830735206604004
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.818911 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 1.8007843494415283
Epoch: 5, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.177 Vali Acc: 0.938 Test Loss: 0.177 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.8950614929199219
Epoch: 6, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9990835189819336
Epoch: 7, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.6997995376586914
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 1.6732454299926758
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.220 Vali Acc: 0.927 Test Loss: 0.220 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9653842449188232
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.11527943611145
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.348 Vali Acc: 0.886 Test Loss: 0.348 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.66526198387146
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.282 Vali Acc: 0.916 Test Loss: 0.282 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6284048557281494
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8361523151397705
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.304 Vali Acc: 0.914 Test Loss: 0.304 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9522483348846436
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.7198677062988281
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.761073350906372
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5964360237121582
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.815110206604004
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9253137111663818
Epoch: 20, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7642171382904053
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.178076982498169
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.290 Vali Acc: 0.924 Test Loss: 0.290 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.99322509765625
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.916 Test Loss: 0.263 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4142262935638428
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9240062236785889
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.927 Test Loss: 0.260 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9567058086395264
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 6019117
model size : 27.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6976990699768066
Epoch: 1, Steps: 17 | Train Loss: 2.299 Vali Loss: 2.116 Vali Acc: 0.138 Test Loss: 2.116 Test Acc: 0.138
Validation loss decreased (inf --> -0.137817).  Saving model ...
Epoch: 2 cost time: 1.839838981628418
Epoch: 2, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.816 Vali Acc: 0.405 Test Loss: 1.816 Test Acc: 0.405
Validation loss decreased (-0.137817 --> -0.405387).  Saving model ...
Epoch: 3 cost time: 1.7460246086120605
Epoch: 3, Steps: 17 | Train Loss: 1.176 Vali Loss: 0.635 Vali Acc: 0.932 Test Loss: 0.635 Test Acc: 0.932
Validation loss decreased (-0.405387 --> -0.932426).  Saving model ...
Epoch: 4 cost time: 1.7554917335510254
Epoch: 4, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
Validation loss decreased (-0.932426 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.6981325149536133
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.274407386779785
Epoch: 6, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.433 Vali Acc: 0.865 Test Loss: 0.433 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9209926128387451
Epoch: 7, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8361778259277344
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8652689456939697
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.8420603275299072
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.932 Test Loss: 0.181 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7992217540740967
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5619175434112549
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8091762065887451
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 2.149846076965332
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 1.9909029006958008
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.746500015258789
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.832277774810791
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.8252079486846924
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.020003080368042
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7388544082641602
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.760159969329834
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1000330448150635
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6942377090454102
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.057084798812866
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7105255126953125
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8867220878601074
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.924189567565918
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 6017837
model size : 27.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.108931064605713
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.080 Vali Acc: 0.281 Test Loss: 2.080 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 1.9544506072998047
Epoch: 2, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.491 Vali Acc: 0.692 Test Loss: 1.491 Test Acc: 0.692
Validation loss decreased (-0.281060 --> -0.691877).  Saving model ...
Epoch: 3 cost time: 2.0421388149261475
Epoch: 3, Steps: 17 | Train Loss: 1.102 Vali Loss: 0.625 Vali Acc: 0.924 Test Loss: 0.625 Test Acc: 0.924
Validation loss decreased (-0.691877 --> -0.924318).  Saving model ...
Epoch: 4 cost time: 2.050077199935913
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.924318 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.7639455795288086
Epoch: 5, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.935133 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.1756339073181152
Epoch: 6, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.396 Vali Acc: 0.854 Test Loss: 0.396 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.015242576599121
Epoch: 7, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8562202453613281
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.338541269302368
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.818589448928833
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8109245300292969
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 2.0010178089141846
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0533998012542725
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8289389610290527
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 1.9475657939910889
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.772597312927246
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.539079427719116
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 2.075326442718506
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 2.056351661682129
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.971137523651123
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.908 Test Loss: 0.345 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9974040985107422
Epoch: 21, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1200077533721924
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7282085418701172
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9632189273834229
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9294464588165283
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9480016231536865
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9899864196777344
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.2743120193481445
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 6016557
model size : 27.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.154893159866333
Epoch: 1, Steps: 17 | Train Loss: 2.254 Vali Loss: 2.012 Vali Acc: 0.205 Test Loss: 2.012 Test Acc: 0.205
Validation loss decreased (inf --> -0.205385).  Saving model ...
Epoch: 2 cost time: 2.2166264057159424
Epoch: 2, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.483 Vali Acc: 0.651 Test Loss: 1.483 Test Acc: 0.651
Validation loss decreased (-0.205385 --> -0.651337).  Saving model ...
Epoch: 3 cost time: 1.8592228889465332
Epoch: 3, Steps: 17 | Train Loss: 1.170 Vali Loss: 0.797 Vali Acc: 0.838 Test Loss: 0.797 Test Acc: 0.838
Validation loss decreased (-0.651337 --> -0.837830).  Saving model ...
Epoch: 4 cost time: 1.9226949214935303
Epoch: 4, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.326 Vali Acc: 0.916 Test Loss: 0.326 Test Acc: 0.916
Validation loss decreased (-0.837830 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 1.7640032768249512
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.244 Vali Acc: 0.924 Test Loss: 0.244 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 1.939857006072998
Epoch: 6, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.924322 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.6772520542144775
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.568692684173584
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.358 Vali Acc: 0.873 Test Loss: 0.358 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.880110263824463
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7496414184570312
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5758252143859863
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 1.724010944366455
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.898937463760376
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.745924472808838
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.959834098815918
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.797621488571167
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1463663578033447
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.29065203666687
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.248166799545288
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3671040534973145
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 1.8386399745941162
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.6569647789001465
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8863153457641602
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 2.0817606449127197
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8953983783721924
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 1.9489710330963135
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3723690509796143
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0353634357452393
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.882415533065796
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.252903699874878
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8039021492004395
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.953887939453125
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.097432851791382
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7889595031738281
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.292140007019043
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 6015277
model size : 27.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7142581939697266
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.011 Vali Acc: 0.208 Test Loss: 2.011 Test Acc: 0.208
Validation loss decreased (inf --> -0.208088).  Saving model ...
Epoch: 2 cost time: 1.7667768001556396
Epoch: 2, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.410 Vali Acc: 0.565 Test Loss: 1.410 Test Acc: 0.565
Validation loss decreased (-0.208088 --> -0.564851).  Saving model ...
Epoch: 3 cost time: 1.7556445598602295
Epoch: 3, Steps: 17 | Train Loss: 1.146 Vali Loss: 0.665 Vali Acc: 0.868 Test Loss: 0.665 Test Acc: 0.868
Validation loss decreased (-0.564851 --> -0.867561).  Saving model ...
Epoch: 4 cost time: 1.9664711952209473
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
Validation loss decreased (-0.867561 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.796844720840454
Epoch: 5, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 2.2538094520568848
Epoch: 6, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0318119525909424
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 1.7923283576965332
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.366 Vali Acc: 0.892 Test Loss: 0.366 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8465352058410645
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0864174365997314
Epoch: 10, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9961421489715576
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 2.043907880783081
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.332 Vali Acc: 0.905 Test Loss: 0.332 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8255524635314941
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7724804878234863
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.938 Test Loss: 0.226 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0226263999938965
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.038408041000366
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.998504400253296
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0954430103302
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.048999786376953
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 1.9311339855194092
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.072582483291626
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.139832019805908
Epoch: 22, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9549801349639893
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 2.2099978923797607
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5608065128326416
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.093891143798828
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6852362155914307
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9250853061676025
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8112385272979736
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7083542346954346
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.789682388305664
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6209979057312012
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9579145908355713
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 5690797
model size : 26.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.305335760116577
Epoch: 1, Steps: 17 | Train Loss: 2.347 Vali Loss: 2.056 Vali Acc: 0.162 Test Loss: 2.056 Test Acc: 0.162
Validation loss decreased (inf --> -0.162142).  Saving model ...
Epoch: 2 cost time: 1.9290766716003418
Epoch: 2, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.516 Vali Acc: 0.622 Test Loss: 1.516 Test Acc: 0.622
Validation loss decreased (-0.162142 --> -0.621606).  Saving model ...
Epoch: 3 cost time: 1.9230387210845947
Epoch: 3, Steps: 17 | Train Loss: 1.168 Vali Loss: 0.761 Vali Acc: 0.838 Test Loss: 0.761 Test Acc: 0.838
Validation loss decreased (-0.621606 --> -0.837830).  Saving model ...
Epoch: 4 cost time: 1.776228666305542
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.301 Vali Acc: 0.908 Test Loss: 0.301 Test Acc: 0.908
Validation loss decreased (-0.837830 --> -0.908105).  Saving model ...
Epoch: 5 cost time: 1.4951362609863281
Epoch: 5, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.908105 --> -0.910808).  Saving model ...
Epoch: 6 cost time: 1.7222604751586914
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.371 Vali Acc: 0.873 Test Loss: 0.371 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.004646062850952
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.165 Vali Acc: 0.930 Test Loss: 0.165 Test Acc: 0.930
Validation loss decreased (-0.910808 --> -0.929728).  Saving model ...
Epoch: 8 cost time: 1.911909580230713
Epoch: 8, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
Validation loss decreased (-0.929728 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.886763095855713
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9084808826446533
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.8570525646209717
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7208836078643799
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5266270637512207
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7542788982391357
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.938 Test Loss: 0.176 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7506012916564941
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.924 Test Loss: 0.302 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6843304634094238
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.289 Vali Acc: 0.924 Test Loss: 0.289 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9356935024261475
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6849944591522217
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.027214765548706
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5775997638702393
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.6142888069152832
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.952763557434082
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9849879741668701
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7485897541046143
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5460255146026611
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7738182544708252
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9247071743011475
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.76412034034729
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.864931583404541
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9235646724700928
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 5689517
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5879902839660645
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 1.884 Vali Acc: 0.416 Test Loss: 1.884 Test Acc: 0.416
Validation loss decreased (inf --> -0.416197).  Saving model ...
Epoch: 2 cost time: 1.652909517288208
Epoch: 2, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.595 Vali Acc: 0.457 Test Loss: 1.595 Test Acc: 0.457
Validation loss decreased (-0.416197 --> -0.456741).  Saving model ...
Epoch: 3 cost time: 1.523526668548584
Epoch: 3, Steps: 17 | Train Loss: 1.135 Vali Loss: 0.694 Vali Acc: 0.870 Test Loss: 0.694 Test Acc: 0.870
Validation loss decreased (-0.456741 --> -0.870263).  Saving model ...
Epoch: 4 cost time: 1.633512020111084
Epoch: 4, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.366 Vali Acc: 0.884 Test Loss: 0.366 Test Acc: 0.884
Validation loss decreased (-0.870263 --> -0.883780).  Saving model ...
Epoch: 5 cost time: 1.8670616149902344
Epoch: 5, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
Validation loss decreased (-0.883780 --> -0.921620).  Saving model ...
Epoch: 6 cost time: 1.549452304840088
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
Validation loss decreased (-0.921620 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.6080470085144043
Epoch: 7, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8160138130187988
Epoch: 8, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.940539 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 1.8256754875183105
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7937583923339844
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.950643539428711
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.927 Test Loss: 0.191 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8628993034362793
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.999514102935791
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9857454299926758
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2016806602478027
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6718175411224365
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0535614490509033
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9431686401367188
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7987666130065918
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7802026271820068
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7298576831817627
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8871448040008545
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 5688237
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.651489019393921
Epoch: 1, Steps: 17 | Train Loss: 2.263 Vali Loss: 2.029 Vali Acc: 0.305 Test Loss: 2.029 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 1.5622749328613281
Epoch: 2, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.445 Vali Acc: 0.562 Test Loss: 1.445 Test Acc: 0.562
Validation loss decreased (-0.305385 --> -0.562148).  Saving model ...
Epoch: 3 cost time: 1.929919719696045
Epoch: 3, Steps: 17 | Train Loss: 1.056 Vali Loss: 0.529 Vali Acc: 0.930 Test Loss: 0.529 Test Acc: 0.930
Validation loss decreased (-0.562148 --> -0.929724).  Saving model ...
Epoch: 4 cost time: 1.743267297744751
Epoch: 4, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.929724 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.7213218212127686
Epoch: 5, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.240 Vali Acc: 0.927 Test Loss: 0.240 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8888850212097168
Epoch: 6, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8064992427825928
Epoch: 7, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.935133 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.7629616260528564
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0100831985473633
Epoch: 9, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.9690535068511963
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9463493824005127
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8733627796173096
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8420779705047607
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.869136095046997
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.82564115524292
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8263123035430908
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6864871978759766
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.437 Vali Acc: 0.886 Test Loss: 0.437 Test Acc: 0.886
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5685381889343262
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7230312824249268
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.361 Vali Acc: 0.914 Test Loss: 0.361 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 5686957
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.036030054092407
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.028 Vali Acc: 0.397 Test Loss: 2.028 Test Acc: 0.397
Validation loss decreased (inf --> -0.397277).  Saving model ...
Epoch: 2 cost time: 1.7865066528320312
Epoch: 2, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.823 Vali Acc: 0.549 Test Loss: 1.823 Test Acc: 0.549
Validation loss decreased (-0.397277 --> -0.548630).  Saving model ...
Epoch: 3 cost time: 1.7105250358581543
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.119 Vali Acc: 0.759 Test Loss: 1.119 Test Acc: 0.759
Validation loss decreased (-0.548630 --> -0.759448).  Saving model ...
Epoch: 4 cost time: 1.664029598236084
Epoch: 4, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.503 Vali Acc: 0.919 Test Loss: 0.503 Test Acc: 0.919
Validation loss decreased (-0.759448 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 1.7227678298950195
Epoch: 5, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.280 Vali Acc: 0.927 Test Loss: 0.280 Test Acc: 0.927
Validation loss decreased (-0.918914 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.9103567600250244
Epoch: 6, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.5442399978637695
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.193 Vali Acc: 0.927 Test Loss: 0.193 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.89316987991333
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6661996841430664
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.677619218826294
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.7623085975646973
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.943241 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 1.94400954246521
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6506881713867188
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.952091932296753
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.7266478538513184
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8960843086242676
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8419866561889648
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7591662406921387
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8630750179290771
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8420295715332031
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.946 Test Loss: 0.127 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7447988986968994
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7246050834655762
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8449187278747559
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.160060405731201
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2686381
model size : 12.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.336466312408447
Epoch: 1, Steps: 17 | Train Loss: 2.315 Vali Loss: 2.073 Vali Acc: 0.146 Test Loss: 2.073 Test Acc: 0.146
Validation loss decreased (inf --> -0.145925).  Saving model ...
Epoch: 2 cost time: 1.789945125579834
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.659 Vali Acc: 0.765 Test Loss: 1.659 Test Acc: 0.765
Validation loss decreased (-0.145925 --> -0.764848).  Saving model ...
Epoch: 3 cost time: 2.1753599643707275
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.060 Vali Acc: 0.862 Test Loss: 1.060 Test Acc: 0.862
Validation loss decreased (-0.764848 --> -0.862152).  Saving model ...
Epoch: 4 cost time: 1.83457350730896
Epoch: 4, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8227338790893555
Epoch: 5, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.862152 --> -0.889186).  Saving model ...
Epoch: 6 cost time: 1.845344066619873
Epoch: 6, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.889186 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 2.043170928955078
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.940539 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 2.080536127090454
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 1.9837279319763184
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8242878913879395
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8350543975830078
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.1153078079223633
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2417895793914795
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7742345333099365
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0094356536865234
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8841516971588135
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.762317180633545
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7113769054412842
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.938 Test Loss: 0.142 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7187700271606445
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.946 Test Loss: 0.103 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9189486503601074
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6892688274383545
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.959 Test Loss: 0.094 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2685741
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8484342098236084
Epoch: 1, Steps: 17 | Train Loss: 2.270 Vali Loss: 2.063 Vali Acc: 0.330 Test Loss: 2.063 Test Acc: 0.330
Validation loss decreased (inf --> -0.329709).  Saving model ...
Epoch: 2 cost time: 1.591435194015503
Epoch: 2, Steps: 17 | Train Loss: 2.005 Vali Loss: 1.853 Vali Acc: 0.614 Test Loss: 1.853 Test Acc: 0.614
Validation loss decreased (-0.329709 --> -0.613495).  Saving model ...
Epoch: 3 cost time: 1.8448834419250488
Epoch: 3, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.157 Vali Acc: 0.808 Test Loss: 1.157 Test Acc: 0.808
Validation loss decreased (-0.613495 --> -0.808097).  Saving model ...
Epoch: 4 cost time: 2.1939985752105713
Epoch: 4, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.730 Vali Acc: 0.805 Test Loss: 0.730 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.069732427597046
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.808097 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.7129526138305664
Epoch: 6, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.9615938663482666
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.189 Vali Acc: 0.927 Test Loss: 0.189 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8141076564788818
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.9116802215576172
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.6440849304199219
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7595131397247314
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8881397247314453
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.125410556793213
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.9178876876831055
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.770462989807129
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 1.933269739151001
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1653850078582764
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.06998610496521
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9196240901947021
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8374340534210205
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7775373458862305
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.668532133102417
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8073863983154297
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 1.6801443099975586
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 25 cost time: 1.7282426357269287
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.754390001296997
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0226058959960938
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9299046993255615
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7545568943023682
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.105043411254883
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2158257961273193
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9703726768493652
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8871712684631348
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8258757591247559
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 2685101
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.496774911880493
Epoch: 1, Steps: 17 | Train Loss: 2.263 Vali Loss: 2.073 Vali Acc: 0.173 Test Loss: 2.073 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 1.4320030212402344
Epoch: 2, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.533 Vali Acc: 0.668 Test Loss: 1.533 Test Acc: 0.668
Validation loss decreased (-0.172952 --> -0.667552).  Saving model ...
Epoch: 3 cost time: 1.7863388061523438
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 0.872 Vali Acc: 0.903 Test Loss: 0.872 Test Acc: 0.903
Validation loss decreased (-0.667552 --> -0.902694).  Saving model ...
Epoch: 4 cost time: 1.649268388748169
Epoch: 4, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.399 Vali Acc: 0.914 Test Loss: 0.399 Test Acc: 0.914
Validation loss decreased (-0.902694 --> -0.913510).  Saving model ...
Epoch: 5 cost time: 1.7712066173553467
Epoch: 5, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9000532627105713
Epoch: 6, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.913510 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.6806941032409668
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.654953956604004
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6882548332214355
Epoch: 9, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.7582371234893799
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7679414749145508
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.707324504852295
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8200163841247559
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 1.677846908569336
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6817104816436768
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 1.6838276386260986
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.588531255722046
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.8035249710083008
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.938 Test Loss: 0.185 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8638556003570557
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.756765365600586
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6689515113830566
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6579713821411133
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8105223178863525
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.778960943222046
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.908519983291626
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8446900844573975
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9450149536132812
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2684461
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.194065570831299
Epoch: 1, Steps: 17 | Train Loss: 2.266 Vali Loss: 2.169 Vali Acc: 0.068 Test Loss: 2.169 Test Acc: 0.068
Validation loss decreased (inf --> -0.067546).  Saving model ...
Epoch: 2 cost time: 1.7463626861572266
Epoch: 2, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.828 Vali Acc: 0.503 Test Loss: 1.828 Test Acc: 0.503
Validation loss decreased (-0.067546 --> -0.502684).  Saving model ...
Epoch: 3 cost time: 1.9926996231079102
Epoch: 3, Steps: 17 | Train Loss: 1.665 Vali Loss: 1.608 Vali Acc: 0.584 Test Loss: 1.608 Test Acc: 0.584
Validation loss decreased (-0.502684 --> -0.583768).  Saving model ...
Epoch: 4 cost time: 1.8500409126281738
Epoch: 4, Steps: 17 | Train Loss: 1.184 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.583768 --> -0.821614).  Saving model ...
Epoch: 5 cost time: 1.6895689964294434
Epoch: 5, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.308 Vali Acc: 0.946 Test Loss: 0.308 Test Acc: 0.946
Validation loss decreased (-0.821614 --> -0.945943).  Saving model ...
Epoch: 6 cost time: 1.6000587940216064
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.258 Vali Acc: 0.916 Test Loss: 0.258 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.045816421508789
Epoch: 7, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8472483158111572
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.8696763515472412
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6200201511383057
Epoch: 10, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.938 Test Loss: 0.141 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4772944450378418
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 1.556239128112793
Epoch: 12, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.943 Test Loss: 0.141 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7264502048492432
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6455669403076172
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5816090106964111
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6770174503326416
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5122148990631104
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5794382095336914
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8001227378845215
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.6515982151031494
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6964356899261475
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.828192949295044
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.078537940979004
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.658719539642334
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8334074020385742
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.822988748550415
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5950326919555664
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7745096683502197
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6734998226165771
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2028461
model size : 10.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8220603466033936
Epoch: 1, Steps: 17 | Train Loss: 2.248 Vali Loss: 2.173 Vali Acc: 0.173 Test Loss: 2.173 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 1.9431650638580322
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.798 Vali Acc: 0.322 Test Loss: 1.798 Test Acc: 0.322
Validation loss decreased (-0.172951 --> -0.321604).  Saving model ...
Epoch: 3 cost time: 2.1310818195343018
Epoch: 3, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.209 Vali Acc: 0.862 Test Loss: 1.209 Test Acc: 0.862
Validation loss decreased (-0.321604 --> -0.862150).  Saving model ...
Epoch: 4 cost time: 1.9941613674163818
Epoch: 4, Steps: 17 | Train Loss: 0.930 Vali Loss: 0.619 Vali Acc: 0.927 Test Loss: 0.619 Test Acc: 0.927
Validation loss decreased (-0.862150 --> -0.927021).  Saving model ...
Epoch: 5 cost time: 1.777909755706787
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
Validation loss decreased (-0.927021 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 1.702263355255127
Epoch: 6, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 2.34527587890625
Epoch: 7, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.9659807682037354
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.3179218769073486
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.7207379341125488
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.225731372833252
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 2.30312180519104
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8641343116760254
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.932 Test Loss: 0.176 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.852386236190796
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0664443969726562
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7852449417114258
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.086914300918579
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8218014240264893
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6987576484680176
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.863832950592041
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.8138072490692139
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9501614570617676
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8779850006103516
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9839959144592285
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7323155403137207
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8640410900115967
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0793404579162598
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.761568307876587
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.981200933456421
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7446985244750977
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2027821
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.173442363739014
Epoch: 1, Steps: 17 | Train Loss: 2.235 Vali Loss: 2.119 Vali Acc: 0.159 Test Loss: 2.119 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 2.007704973220825
Epoch: 2, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.757 Vali Acc: 0.270 Test Loss: 1.757 Test Acc: 0.270
Validation loss decreased (-0.159438 --> -0.270253).  Saving model ...
Epoch: 3 cost time: 1.6937994956970215
Epoch: 3, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.215 Vali Acc: 0.722 Test Loss: 1.215 Test Acc: 0.722
Validation loss decreased (-0.270253 --> -0.721609).  Saving model ...
Epoch: 4 cost time: 1.7756576538085938
Epoch: 4, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.721609 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 1.6795527935028076
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.306 Vali Acc: 0.938 Test Loss: 0.306 Test Acc: 0.938
Validation loss decreased (-0.899994 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 1.6480271816253662
Epoch: 6, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7084617614746094
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.6795008182525635
Epoch: 8, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.77647066116333
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4762341976165771
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.205 Vali Acc: 0.924 Test Loss: 0.205 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.699486494064331
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8012073040008545
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7581260204315186
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 1.680419683456421
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.635221004486084
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8541347980499268
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.941 Test Loss: 0.135 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6452288627624512
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7941770553588867
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8953959941864014
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.633415937423706
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.924 Test Loss: 0.225 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.81844162940979
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7632217407226562
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.805966854095459
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 1.6829400062561035
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9629888534545898
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7136504650115967
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.911691427230835
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9814505577087402
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8965513706207275
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.768228530883789
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8543119430541992
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.93599534034729
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.826005458831787
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 2027181
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.488920211791992
Epoch: 1, Steps: 17 | Train Loss: 2.240 Vali Loss: 2.115 Vali Acc: 0.116 Test Loss: 2.115 Test Acc: 0.116
Validation loss decreased (inf --> -0.116195).  Saving model ...
Epoch: 2 cost time: 2.419630765914917
Epoch: 2, Steps: 17 | Train Loss: 2.056 Vali Loss: 1.786 Vali Acc: 0.573 Test Loss: 1.786 Test Acc: 0.573
Validation loss decreased (-0.116195 --> -0.572955).  Saving model ...
Epoch: 3 cost time: 1.790116310119629
Epoch: 3, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.300 Vali Acc: 0.781 Test Loss: 1.300 Test Acc: 0.781
Validation loss decreased (-0.572955 --> -0.781068).  Saving model ...
Epoch: 4 cost time: 2.1579694747924805
Epoch: 4, Steps: 17 | Train Loss: 0.955 Vali Loss: 0.632 Vali Acc: 0.914 Test Loss: 0.632 Test Acc: 0.914
Validation loss decreased (-0.781068 --> -0.913507).  Saving model ...
Epoch: 5 cost time: 1.9598455429077148
Epoch: 5, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6039278507232666
Epoch: 6, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.913507 --> -0.929727).  Saving model ...
Epoch: 7 cost time: 1.5365095138549805
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
Validation loss decreased (-0.929727 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.600799798965454
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.866567850112915
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.5018608570098877
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6809613704681396
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6633565425872803
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7053899765014648
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.927 Test Loss: 0.219 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7502875328063965
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4928202629089355
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 2.3960812091827393
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.51029634475708
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8099541664123535
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8384981155395508
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7245583534240723
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 1.7794973850250244
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5940914154052734
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6040234565734863
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.681506633758545
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 1.6588122844696045
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6326704025268555
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.905998706817627
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 28 cost time: 1.739603042602539
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6713132858276367
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.826498031616211
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6809892654418945
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.85455322265625
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.7442212104797363
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6738169193267822
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8713314533233643
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.1690008640289307
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6126525402069092
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5988061428070068
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6432981491088867
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 1.6034653186798096
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7199862003326416
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5774176120758057
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.561006784439087
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 44 cost time: 1.754598617553711
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.554431438446045
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7308800220489502
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 47 cost time: 1.7044322490692139
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6655282974243164
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8157713413238525
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.7430531978607178
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.7471778392791748
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.6866562366485596
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.5874667167663574
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.7406713962554932
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.633166790008545
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.8632147312164307
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2026541
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.28151535987854
Epoch: 1, Steps: 17 | Train Loss: 2.280 Vali Loss: 2.060 Vali Acc: 0.254 Test Loss: 2.060 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 1.4968745708465576
Epoch: 2, Steps: 17 | Train Loss: 2.013 Vali Loss: 1.867 Vali Acc: 0.516 Test Loss: 1.867 Test Acc: 0.516
Validation loss decreased (-0.254033 --> -0.516198).  Saving model ...
Epoch: 3 cost time: 1.4927949905395508
Epoch: 3, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.290 Vali Acc: 0.789 Test Loss: 1.290 Test Acc: 0.789
Validation loss decreased (-0.516198 --> -0.789176).  Saving model ...
Epoch: 4 cost time: 1.737229347229004
Epoch: 4, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.596 Vali Acc: 0.903 Test Loss: 0.596 Test Acc: 0.903
Validation loss decreased (-0.789176 --> -0.902697).  Saving model ...
Epoch: 5 cost time: 2.0053317546844482
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.902697 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 1.8380076885223389
Epoch: 6, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.249 Vali Acc: 0.914 Test Loss: 0.249 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2318708896636963
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.940538 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.7536296844482422
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.8731162548065186
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7377753257751465
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7970547676086426
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8860843181610107
Epoch: 12, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8298475742340088
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7117464542388916
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 1.9307644367218018
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8424270153045654
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.949 Test Loss: 0.115 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.601736307144165
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.839423656463623
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6678204536437988
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 2.0919222831726074
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.954 Test Loss: 0.116 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0285720825195312
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5579042434692383
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7395973205566406
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8079063892364502
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9177100658416748
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9352951049804688
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7789816856384277
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7920587062835693
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.951 Test Loss: 0.121 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8948900699615479
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 1699501
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7604305744171143
Epoch: 1, Steps: 17 | Train Loss: 2.224 Vali Loss: 2.076 Vali Acc: 0.178 Test Loss: 2.076 Test Acc: 0.178
Validation loss decreased (inf --> -0.178358).  Saving model ...
Epoch: 2 cost time: 1.8912348747253418
Epoch: 2, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.853 Vali Acc: 0.570 Test Loss: 1.853 Test Acc: 0.570
Validation loss decreased (-0.178358 --> -0.570252).  Saving model ...
Epoch: 3 cost time: 1.7729065418243408
Epoch: 3, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.332 Vali Acc: 0.735 Test Loss: 1.332 Test Acc: 0.735
Validation loss decreased (-0.570252 --> -0.735122).  Saving model ...
Epoch: 4 cost time: 1.7805793285369873
Epoch: 4, Steps: 17 | Train Loss: 1.104 Vali Loss: 0.725 Vali Acc: 0.889 Test Loss: 0.725 Test Acc: 0.889
Validation loss decreased (-0.735122 --> -0.889182).  Saving model ...
Epoch: 5 cost time: 1.724973201751709
Epoch: 5, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.336 Vali Acc: 0.914 Test Loss: 0.336 Test Acc: 0.914
Validation loss decreased (-0.889182 --> -0.913510).  Saving model ...
Epoch: 6 cost time: 1.7548069953918457
Epoch: 6, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.682581901550293
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.913510 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 1.7266223430633545
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.935133 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.7466990947723389
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.156 Vali Acc: 0.938 Test Loss: 0.156 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7108752727508545
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.745617151260376
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.941 Test Loss: 0.133 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0271663665771484
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8164629936218262
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8775546550750732
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.747138261795044
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.9759955406188965
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6755225658416748
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.8616528511047363
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.883937120437622
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9594900608062744
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5466926097869873
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.962 Test Loss: 0.091 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.5664129257202148
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.954 Test Loss: 0.102 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6097629070281982
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5522940158843994
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6593081951141357
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.653296709060669
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7974233627319336
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6825571060180664
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8635990619659424
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 2.0430092811584473
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.558887243270874
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6175487041473389
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7137351036071777
Epoch: 33, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8707973957061768
Epoch: 34, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.416 Vali Acc: 0.881 Test Loss: 0.416 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8220479488372803
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7133772373199463
Epoch: 36, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.686962366104126
Epoch: 37, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.468554973602295
Epoch: 38, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.860687494277954
Epoch: 39, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1698861
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7047669887542725
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.120 Vali Acc: 0.184 Test Loss: 2.120 Test Acc: 0.184
Validation loss decreased (inf --> -0.183763).  Saving model ...
Epoch: 2 cost time: 1.757094144821167
Epoch: 2, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.872 Vali Acc: 0.270 Test Loss: 1.872 Test Acc: 0.270
Validation loss decreased (-0.183763 --> -0.270252).  Saving model ...
Epoch: 3 cost time: 2.0519859790802
Epoch: 3, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.468 Vali Acc: 0.549 Test Loss: 1.468 Test Acc: 0.549
Validation loss decreased (-0.270252 --> -0.548634).  Saving model ...
Epoch: 4 cost time: 1.7568306922912598
Epoch: 4, Steps: 17 | Train Loss: 1.018 Vali Loss: 0.792 Vali Acc: 0.816 Test Loss: 0.792 Test Acc: 0.816
Validation loss decreased (-0.548634 --> -0.816208).  Saving model ...
Epoch: 5 cost time: 2.1013965606689453
Epoch: 5, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
Validation loss decreased (-0.816208 --> -0.945943).  Saving model ...
Epoch: 6 cost time: 2.191175699234009
Epoch: 6, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.166456460952759
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.038428783416748
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 2.2242801189422607
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.948647 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 2.063058614730835
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.343862295150757
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.020711660385132
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.67185378074646
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.932 Test Loss: 0.190 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.825500249862671
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3355965614318848
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4130361080169678
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.949 Test Loss: 0.113 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9500758647918701
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0490922927856445
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1274755001068115
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8962838649749756
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.078420639038086
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1698221
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.245058298110962
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.226 Vali Acc: 0.259 Test Loss: 2.226 Test Acc: 0.259
Validation loss decreased (inf --> -0.259437).  Saving model ...
Epoch: 2 cost time: 1.5852313041687012
Epoch: 2, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.839 Vali Acc: 0.322 Test Loss: 1.839 Test Acc: 0.322
Validation loss decreased (-0.259437 --> -0.321603).  Saving model ...
Epoch: 3 cost time: 1.8195669651031494
Epoch: 3, Steps: 17 | Train Loss: 1.649 Vali Loss: 1.238 Vali Acc: 0.843 Test Loss: 1.238 Test Acc: 0.843
Validation loss decreased (-0.321603 --> -0.843231).  Saving model ...
Epoch: 4 cost time: 1.5152490139007568
Epoch: 4, Steps: 17 | Train Loss: 1.085 Vali Loss: 0.794 Vali Acc: 0.778 Test Loss: 0.794 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9777777194976807
Epoch: 5, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
Validation loss decreased (-0.843231 --> -0.945943).  Saving model ...
Epoch: 6 cost time: 1.6036739349365234
Epoch: 6, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.865476131439209
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 1.7656824588775635
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.221 Vali Acc: 0.914 Test Loss: 0.221 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9723057746887207
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5239107608795166
Epoch: 10, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.765960454940796
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.954053 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 1.7267298698425293
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.133 Vali Acc: 0.941 Test Loss: 0.133 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7466676235198975
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6751313209533691
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8092098236083984
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.924 Test Loss: 0.168 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9509162902832031
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 1.7037053108215332
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7690150737762451
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7943079471588135
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.8329079151153564
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5514028072357178
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.037203788757324
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7744920253753662
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.455603837966919
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9361941814422607
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 1.9599995613098145
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.612306833267212
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5801551342010498
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5435361862182617
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.628394603729248
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.739654541015625
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7222018241882324
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0386223793029785
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7111179828643799
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8645026683807373
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1697581
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2998626232147217
Epoch: 1, Steps: 17 | Train Loss: 2.252 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
Validation loss decreased (inf --> -0.243222).  Saving model ...
Epoch: 2 cost time: 1.825932264328003
Epoch: 2, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.866 Vali Acc: 0.462 Test Loss: 1.866 Test Acc: 0.462
Validation loss decreased (-0.243222 --> -0.462143).  Saving model ...
Epoch: 3 cost time: 1.6593787670135498
Epoch: 3, Steps: 17 | Train Loss: 1.723 Vali Loss: 1.512 Vali Acc: 0.705 Test Loss: 1.512 Test Acc: 0.705
Validation loss decreased (-0.462143 --> -0.705390).  Saving model ...
Epoch: 4 cost time: 1.769758701324463
Epoch: 4, Steps: 17 | Train Loss: 1.236 Vali Loss: 0.864 Vali Acc: 0.865 Test Loss: 0.864 Test Acc: 0.865
Validation loss decreased (-0.705390 --> -0.864856).  Saving model ...
Epoch: 5 cost time: 1.6996028423309326
Epoch: 5, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.439 Vali Acc: 0.911 Test Loss: 0.439 Test Acc: 0.911
Validation loss decreased (-0.864856 --> -0.910806).  Saving model ...
Epoch: 6 cost time: 1.930433988571167
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
Validation loss decreased (-0.910806 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 1.7304189205169678
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7764644622802734
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.7041964530944824
Epoch: 9, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.188 Vali Acc: 0.914 Test Loss: 0.188 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5798890590667725
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 1.6461548805236816
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.4547810554504395
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8595733642578125
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 1.5906195640563965
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7764906883239746
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5957911014556885
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7745249271392822
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9297473430633545
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0008177757263184
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7482562065124512
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7243056297302246
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7087702751159668
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7249250411987305
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1535021
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.47942852973938
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.072 Vali Acc: 0.362 Test Loss: 2.072 Test Acc: 0.362
Validation loss decreased (inf --> -0.362141).  Saving model ...
Epoch: 2 cost time: 1.7002553939819336
Epoch: 2, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.908 Vali Acc: 0.295 Test Loss: 1.908 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6124310493469238
Epoch: 3, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.326 Vali Acc: 0.841 Test Loss: 1.326 Test Acc: 0.841
Validation loss decreased (-0.362141 --> -0.840527).  Saving model ...
Epoch: 4 cost time: 1.7881739139556885
Epoch: 4, Steps: 17 | Train Loss: 1.043 Vali Loss: 0.768 Vali Acc: 0.881 Test Loss: 0.768 Test Acc: 0.881
Validation loss decreased (-0.840527 --> -0.881073).  Saving model ...
Epoch: 5 cost time: 1.7053260803222656
Epoch: 5, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.430 Vali Acc: 0.876 Test Loss: 0.430 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8696682453155518
Epoch: 6, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.366 Vali Acc: 0.873 Test Loss: 0.366 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.972752571105957
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.881073 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.9248409271240234
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 1.676565170288086
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7358405590057373
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8993115425109863
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 12 cost time: 1.8559091091156006
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.956756 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.735124111175537
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9383635520935059
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9367115497589111
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8910045623779297
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 1.9067821502685547
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.862915277481079
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.245302200317383
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8492200374603271
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7396430969238281
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9160583019256592
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.187121629714966
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8404438495635986
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9228367805480957
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0483901500701904
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1534381
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4763033390045166
Epoch: 1, Steps: 17 | Train Loss: 2.229 Vali Loss: 2.148 Vali Acc: 0.165 Test Loss: 2.148 Test Acc: 0.165
Validation loss decreased (inf --> -0.164843).  Saving model ...
Epoch: 2 cost time: 1.849071741104126
Epoch: 2, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.794 Vali Acc: 0.651 Test Loss: 1.794 Test Acc: 0.651
Validation loss decreased (-0.164843 --> -0.651333).  Saving model ...
Epoch: 3 cost time: 1.6379430294036865
Epoch: 3, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.449 Vali Acc: 0.673 Test Loss: 1.449 Test Acc: 0.673
Validation loss decreased (-0.651333 --> -0.672958).  Saving model ...
Epoch: 4 cost time: 1.6832141876220703
Epoch: 4, Steps: 17 | Train Loss: 1.209 Vali Loss: 0.868 Vali Acc: 0.865 Test Loss: 0.868 Test Acc: 0.865
Validation loss decreased (-0.672958 --> -0.864856).  Saving model ...
Epoch: 5 cost time: 1.6358132362365723
Epoch: 5, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.389 Vali Acc: 0.938 Test Loss: 0.389 Test Acc: 0.938
Validation loss decreased (-0.864856 --> -0.937834).  Saving model ...
Epoch: 6 cost time: 1.7363524436950684
Epoch: 6, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.252 Vali Acc: 0.927 Test Loss: 0.252 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7315232753753662
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 1.9783449172973633
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.5914034843444824
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.87327241897583
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 11 cost time: 1.6523032188415527
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6810941696166992
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 1.6009314060211182
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.7247083187103271
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7043962478637695
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.017132520675659
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7210428714752197
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.110713243484497
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.02846622467041
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8217713832855225
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9781975746154785
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.163032293319702
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2318434715270996
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1533741
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.175849914550781
Epoch: 1, Steps: 17 | Train Loss: 2.240 Vali Loss: 2.132 Vali Acc: 0.241 Test Loss: 2.132 Test Acc: 0.241
Validation loss decreased (inf --> -0.240519).  Saving model ...
Epoch: 2 cost time: 1.677232027053833
Epoch: 2, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.870 Vali Acc: 0.441 Test Loss: 1.870 Test Acc: 0.441
Validation loss decreased (-0.240519 --> -0.440522).  Saving model ...
Epoch: 3 cost time: 1.8395943641662598
Epoch: 3, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.417 Vali Acc: 0.792 Test Loss: 1.417 Test Acc: 0.792
Validation loss decreased (-0.440522 --> -0.791878).  Saving model ...
Epoch: 4 cost time: 1.7892649173736572
Epoch: 4, Steps: 17 | Train Loss: 1.078 Vali Loss: 0.758 Vali Acc: 0.911 Test Loss: 0.758 Test Acc: 0.911
Validation loss decreased (-0.791878 --> -0.910803).  Saving model ...
Epoch: 5 cost time: 1.8248493671417236
Epoch: 5, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.910803 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 1.8025343418121338
Epoch: 6, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 1.9901158809661865
Epoch: 7, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 2.161637306213379
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.5606706142425537
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.659017562866211
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8306102752685547
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7202517986297607
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8919520378112793
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9962091445922852
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.859384298324585
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7666938304901123
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5153412818908691
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.501521348953247
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.690814733505249
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1533101
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.770296573638916
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.071 Vali Acc: 0.281 Test Loss: 2.071 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 1.898500919342041
Epoch: 2, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.945 Vali Acc: 0.373 Test Loss: 1.945 Test Acc: 0.373
Validation loss decreased (-0.281060 --> -0.372954).  Saving model ...
Epoch: 3 cost time: 1.9921813011169434
Epoch: 3, Steps: 17 | Train Loss: 1.795 Vali Loss: 1.530 Vali Acc: 0.759 Test Loss: 1.530 Test Acc: 0.759
Validation loss decreased (-0.372954 --> -0.759444).  Saving model ...
Epoch: 4 cost time: 1.872448205947876
Epoch: 4, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.051 Vali Acc: 0.800 Test Loss: 1.051 Test Acc: 0.800
Validation loss decreased (-0.759444 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 2.1041107177734375
Epoch: 5, Steps: 17 | Train Loss: 0.883 Vali Loss: 0.667 Vali Acc: 0.905 Test Loss: 0.667 Test Acc: 0.905
Validation loss decreased (-0.799989 --> -0.905399).  Saving model ...
Epoch: 6 cost time: 1.753096580505371
Epoch: 6, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2933239936828613
Epoch: 7, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
Validation loss decreased (-0.905399 --> -0.921619).  Saving model ...
Epoch: 8 cost time: 1.7900469303131104
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9978277683258057
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.921619 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 1.896623134613037
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8280079364776611
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.323122978210449
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6695442199707031
Epoch: 13, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 1.7419521808624268
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.145 Vali Acc: 0.935 Test Loss: 0.145 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.018956422805786
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 2.4076080322265625
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9414122104644775
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.8745746612548828
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7532529830932617
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9624478816986084
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.699841022491455
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.8342869281768799
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.8158810138702393
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.941 Test Loss: 0.152 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.309382677078247
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 2.065286636352539
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7864642143249512
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 1.6706252098083496
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.107928991317749
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.851412296295166
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0645787715911865
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.857102394104004
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.734529972076416
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.483670473098755
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.5819203853607178
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9353394508361816
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.052978515625
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1018093
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.079015731811523
Epoch: 1, Steps: 17 | Train Loss: 2.273 Vali Loss: 2.239 Vali Acc: 0.073 Test Loss: 2.239 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 1.919898509979248
Epoch: 2, Steps: 17 | Train Loss: 2.191 Vali Loss: 1.989 Vali Acc: 0.389 Test Loss: 1.989 Test Acc: 0.389
Validation loss decreased (-0.072951 --> -0.389169).  Saving model ...
Epoch: 3 cost time: 1.9942080974578857
Epoch: 3, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.731 Vali Acc: 0.608 Test Loss: 1.731 Test Acc: 0.608
Validation loss decreased (-0.389169 --> -0.608091).  Saving model ...
Epoch: 4 cost time: 1.667471170425415
Epoch: 4, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.188 Vali Acc: 0.765 Test Loss: 1.188 Test Acc: 0.765
Validation loss decreased (-0.608091 --> -0.764853).  Saving model ...
Epoch: 5 cost time: 1.8984558582305908
Epoch: 5, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.749 Vali Acc: 0.889 Test Loss: 0.749 Test Acc: 0.889
Validation loss decreased (-0.764853 --> -0.889182).  Saving model ...
Epoch: 6 cost time: 1.833449363708496
Epoch: 6, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.409 Vali Acc: 0.916 Test Loss: 0.409 Test Acc: 0.916
Validation loss decreased (-0.889182 --> -0.916212).  Saving model ...
Epoch: 7 cost time: 1.429802656173706
Epoch: 7, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.333 Vali Acc: 0.892 Test Loss: 0.333 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9255988597869873
Epoch: 8, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.916212 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 2.091083288192749
Epoch: 9, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 2.0107131004333496
Epoch: 10, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 11 cost time: 2.994168996810913
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.165 Vali Acc: 0.930 Test Loss: 0.165 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0550730228424072
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.168 Vali Acc: 0.935 Test Loss: 0.168 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2697243690490723
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
Validation loss decreased (-0.940539 --> -0.956756).  Saving model ...
Epoch: 14 cost time: 2.548363447189331
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3098998069763184
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9635772705078125
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.110 Vali Acc: 0.951 Test Loss: 0.110 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.079047441482544
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.115 Vali Acc: 0.949 Test Loss: 0.115 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9767577648162842
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9421954154968262
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6731064319610596
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.937741994857788
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9265525341033936
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.951 Test Loss: 0.114 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2096827030181885
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.118313789367676
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.932 Test Loss: 0.174 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.149393081665039
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3217365741729736
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7720763683319092
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.949 Test Loss: 0.113 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.346912384033203
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 29 cost time: 2.181792974472046
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.317946434020996
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.951 Test Loss: 0.115 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8338055610656738
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0718486309051514
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.951 Test Loss: 0.106 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8873443603515625
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.951 Test Loss: 0.109 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9379048347473145
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.821899175643921
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 36 cost time: 1.7244560718536377
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.943 Test Loss: 0.140 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.093079090118408
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.0146567821502686
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.959 Test Loss: 0.098 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5628769397735596
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1002304553985596
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.242572546005249
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.303521156311035
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.946 Test Loss: 0.131 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.8450450897216797
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.222172498703003
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.9982759952545166
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.951 Test Loss: 0.120 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1017773
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.308876276016235
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.137 Vali Acc: 0.205 Test Loss: 2.137 Test Acc: 0.205
Validation loss decreased (inf --> -0.205384).  Saving model ...
Epoch: 2 cost time: 1.9030766487121582
Epoch: 2, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.001 Vali Acc: 0.465 Test Loss: 2.001 Test Acc: 0.465
Validation loss decreased (-0.205384 --> -0.464845).  Saving model ...
Epoch: 3 cost time: 1.920907974243164
Epoch: 3, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.699 Vali Acc: 0.624 Test Loss: 1.699 Test Acc: 0.624
Validation loss decreased (-0.464845 --> -0.624307).  Saving model ...
Epoch: 4 cost time: 2.03132700920105
Epoch: 4, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.183 Vali Acc: 0.789 Test Loss: 1.183 Test Acc: 0.789
Validation loss decreased (-0.624307 --> -0.789177).  Saving model ...
Epoch: 5 cost time: 2.08640193939209
Epoch: 5, Steps: 17 | Train Loss: 0.928 Vali Loss: 0.764 Vali Acc: 0.843 Test Loss: 0.764 Test Acc: 0.843
Validation loss decreased (-0.789177 --> -0.843236).  Saving model ...
Epoch: 6 cost time: 1.7997219562530518
Epoch: 6, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.400 Vali Acc: 0.922 Test Loss: 0.400 Test Acc: 0.922
Validation loss decreased (-0.843236 --> -0.921618).  Saving model ...
Epoch: 7 cost time: 1.945267677307129
Epoch: 7, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.311 Vali Acc: 0.932 Test Loss: 0.311 Test Acc: 0.932
Validation loss decreased (-0.921618 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 2.02644944190979
Epoch: 8, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.265 Vali Acc: 0.924 Test Loss: 0.265 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.112140417098999
Epoch: 9, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 2.1422488689422607
Epoch: 10, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 1.8680572509765625
Epoch: 11, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8539807796478271
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 1.7560031414031982
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9166619777679443
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.541266679763794
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.7582018375396729
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.127519130706787
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 2.061394214630127
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2158467769622803
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9739632606506348
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9961588382720947
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7967784404754639
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9129247665405273
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7842357158660889
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0365917682647705
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1843340396881104
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9497275352478027
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1017453
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1188809871673584
Epoch: 1, Steps: 17 | Train Loss: 2.252 Vali Loss: 2.131 Vali Acc: 0.276 Test Loss: 2.131 Test Acc: 0.276
Validation loss decreased (inf --> -0.275654).  Saving model ...
Epoch: 2 cost time: 1.744462251663208
Epoch: 2, Steps: 17 | Train Loss: 2.094 Vali Loss: 1.940 Vali Acc: 0.500 Test Loss: 1.940 Test Acc: 0.500
Validation loss decreased (-0.275654 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.829181432723999
Epoch: 3, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.634 Vali Acc: 0.684 Test Loss: 1.634 Test Acc: 0.684
Validation loss decreased (-0.499981 --> -0.683767).  Saving model ...
Epoch: 4 cost time: 1.8449320793151855
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.124 Vali Acc: 0.776 Test Loss: 1.124 Test Acc: 0.776
Validation loss decreased (-0.683767 --> -0.775664).  Saving model ...
Epoch: 5 cost time: 1.5639004707336426
Epoch: 5, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.716 Vali Acc: 0.868 Test Loss: 0.716 Test Acc: 0.868
Validation loss decreased (-0.775664 --> -0.867560).  Saving model ...
Epoch: 6 cost time: 1.5141606330871582
Epoch: 6, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.418 Vali Acc: 0.916 Test Loss: 0.418 Test Acc: 0.916
Validation loss decreased (-0.867560 --> -0.916212).  Saving model ...
Epoch: 7 cost time: 1.4998643398284912
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7685940265655518
Epoch: 8, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
Validation loss decreased (-0.916212 --> -0.927025).  Saving model ...
Epoch: 9 cost time: 1.5745210647583008
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.600691556930542
Epoch: 10, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.845994472503662
Epoch: 11, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.634007215499878
Epoch: 12, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.7991290092468262
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6558098793029785
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 1.5965304374694824
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.599111795425415
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8058662414550781
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7483599185943604
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7610037326812744
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 1.6665990352630615
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6747691631317139
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6123847961425781
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.938 Test Loss: 0.147 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.558683156967163
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.984081506729126
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.5597960948944092
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.943 Test Loss: 0.120 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6125831604003906
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 1.5751399993896484
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6172163486480713
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.946 Test Loss: 0.128 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.064279794692993
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 2.0514159202575684
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.951 Test Loss: 0.113 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6087515354156494
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.783104419708252
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7879631519317627
Epoch: 33, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5822117328643799
Epoch: 34, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7048823833465576
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5697429180145264
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7711856365203857
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9617419242858887
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.685553789138794
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1017133
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8882391452789307
Epoch: 1, Steps: 17 | Train Loss: 2.277 Vali Loss: 2.165 Vali Acc: 0.157 Test Loss: 2.165 Test Acc: 0.157
Validation loss decreased (inf --> -0.156735).  Saving model ...
Epoch: 2 cost time: 1.8964731693267822
Epoch: 2, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.018 Vali Acc: 0.392 Test Loss: 2.018 Test Acc: 0.392
Validation loss decreased (-0.156735 --> -0.391872).  Saving model ...
Epoch: 3 cost time: 2.476294994354248
Epoch: 3, Steps: 17 | Train Loss: 1.956 Vali Loss: 1.750 Vali Acc: 0.676 Test Loss: 1.750 Test Acc: 0.676
Validation loss decreased (-0.391872 --> -0.675658).  Saving model ...
Epoch: 4 cost time: 2.025418519973755
Epoch: 4, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.311 Vali Acc: 0.832 Test Loss: 1.311 Test Acc: 0.832
Validation loss decreased (-0.675658 --> -0.832419).  Saving model ...
Epoch: 5 cost time: 1.797370195388794
Epoch: 5, Steps: 17 | Train Loss: 1.076 Vali Loss: 0.805 Vali Acc: 0.889 Test Loss: 0.805 Test Acc: 0.889
Validation loss decreased (-0.832419 --> -0.889181).  Saving model ...
Epoch: 6 cost time: 2.136932611465454
Epoch: 6, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.513 Vali Acc: 0.892 Test Loss: 0.513 Test Acc: 0.892
Validation loss decreased (-0.889181 --> -0.891887).  Saving model ...
Epoch: 7 cost time: 1.9303669929504395
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.267 Vali Acc: 0.946 Test Loss: 0.267 Test Acc: 0.946
Validation loss decreased (-0.891887 --> -0.945943).  Saving model ...
Epoch: 8 cost time: 1.69327974319458
Epoch: 8, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.257 Vali Acc: 0.927 Test Loss: 0.257 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3382551670074463
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.7666244506835938
Epoch: 10, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1396801471710205
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9301748275756836
Epoch: 12, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.156834840774536
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.755805492401123
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8318684101104736
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 2.0056746006011963
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.0770537853240967
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.964052438735962
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0598089694976807
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.828582763671875
Epoch: 20, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8364965915679932
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0927541255950928
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.141646385192871
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9395952224731445
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 2.319683790206909
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.946903944015503
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3796536922454834
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.909010648727417
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8484716415405273
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1288201808929443
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.946 Test Loss: 0.135 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.020923614501953
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9445679187774658
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9384262561798096
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.849334955215454
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 687853
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5347721576690674
Epoch: 1, Steps: 17 | Train Loss: 2.261 Vali Loss: 2.143 Vali Acc: 0.184 Test Loss: 2.143 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 1.9391329288482666
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 1.967 Vali Acc: 0.581 Test Loss: 1.967 Test Acc: 0.581
Validation loss decreased (-0.183762 --> -0.581061).  Saving model ...
Epoch: 3 cost time: 1.8767876625061035
Epoch: 3, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.774 Vali Acc: 0.495 Test Loss: 1.774 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0937626361846924
Epoch: 4, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.427 Vali Acc: 0.689 Test Loss: 1.427 Test Acc: 0.689
Validation loss decreased (-0.581061 --> -0.689175).  Saving model ...
Epoch: 5 cost time: 1.8843932151794434
Epoch: 5, Steps: 17 | Train Loss: 1.199 Vali Loss: 0.854 Vali Acc: 0.849 Test Loss: 0.854 Test Acc: 0.849
Validation loss decreased (-0.689175 --> -0.848640).  Saving model ...
Epoch: 6 cost time: 1.718738317489624
Epoch: 6, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.499 Vali Acc: 0.932 Test Loss: 0.499 Test Acc: 0.932
Validation loss decreased (-0.848640 --> -0.932427).  Saving model ...
Epoch: 7 cost time: 1.9671659469604492
Epoch: 7, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.328 Vali Acc: 0.927 Test Loss: 0.328 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7222070693969727
Epoch: 8, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
Validation loss decreased (-0.932427 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 1.8582358360290527
Epoch: 9, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.5062286853790283
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.5503437519073486
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3863129615783691
Epoch: 12, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5483267307281494
Epoch: 13, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.6144578456878662
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6048433780670166
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.762960433959961
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5584533214569092
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 1.402322769165039
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5496883392333984
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5993170738220215
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4109740257263184
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6358578205108643
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6301829814910889
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.610227108001709
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 25 cost time: 1.8093369007110596
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.943 Test Loss: 0.137 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5262675285339355
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7450602054595947
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5622398853302002
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.954 Test Loss: 0.116 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9466283321380615
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7491872310638428
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5985405445098877
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9046661853790283
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.954 Test Loss: 0.118 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.736257791519165
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4590554237365723
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 687533
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.600331783294678
Epoch: 1, Steps: 17 | Train Loss: 2.317 Vali Loss: 2.113 Vali Acc: 0.289 Test Loss: 2.113 Test Acc: 0.289
Validation loss decreased (inf --> -0.289168).  Saving model ...
Epoch: 2 cost time: 1.5707969665527344
Epoch: 2, Steps: 17 | Train Loss: 2.109 Vali Loss: 1.931 Vali Acc: 0.503 Test Loss: 1.931 Test Acc: 0.503
Validation loss decreased (-0.289168 --> -0.502683).  Saving model ...
Epoch: 3 cost time: 1.9707679748535156
Epoch: 3, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.711 Vali Acc: 0.695 Test Loss: 1.711 Test Acc: 0.695
Validation loss decreased (-0.502683 --> -0.694577).  Saving model ...
Epoch: 4 cost time: 1.796541452407837
Epoch: 4, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.283 Vali Acc: 0.814 Test Loss: 1.283 Test Acc: 0.814
Validation loss decreased (-0.694577 --> -0.813501).  Saving model ...
Epoch: 5 cost time: 1.6608450412750244
Epoch: 5, Steps: 17 | Train Loss: 1.083 Vali Loss: 0.798 Vali Acc: 0.900 Test Loss: 0.798 Test Acc: 0.900
Validation loss decreased (-0.813501 --> -0.899992).  Saving model ...
Epoch: 6 cost time: 1.7636821269989014
Epoch: 6, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.458 Vali Acc: 0.932 Test Loss: 0.458 Test Acc: 0.932
Validation loss decreased (-0.899992 --> -0.932428).  Saving model ...
Epoch: 7 cost time: 1.7092621326446533
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7803399562835693
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 1.9819412231445312
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.8440492153167725
Epoch: 10, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7386915683746338
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.5783205032348633
Epoch: 12, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1363017559051514
Epoch: 13, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.6667425632476807
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.948647 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.5871107578277588
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8913443088531494
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6585564613342285
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5374469757080078
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.821887493133545
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.935 Test Loss: 0.157 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7858736515045166
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.260 Vali Acc: 0.914 Test Loss: 0.260 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8794705867767334
Epoch: 21, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5882198810577393
Epoch: 22, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.200 Vali Acc: 0.927 Test Loss: 0.200 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8735542297363281
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.8006582260131836
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7093520164489746
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8109331130981445
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6952061653137207
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7349271774291992
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9390614032745361
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.061713218688965
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8834209442138672
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.949 Test Loss: 0.117 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.230133295059204
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9439997673034668
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 687213
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.618187665939331
Epoch: 1, Steps: 17 | Train Loss: 2.258 Vali Loss: 2.113 Vali Acc: 0.181 Test Loss: 2.113 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 1.8345768451690674
Epoch: 2, Steps: 17 | Train Loss: 2.093 Vali Loss: 1.948 Vali Acc: 0.662 Test Loss: 1.948 Test Acc: 0.662
Validation loss decreased (-0.181060 --> -0.662143).  Saving model ...
Epoch: 3 cost time: 1.6450920104980469
Epoch: 3, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.665 Vali Acc: 0.814 Test Loss: 1.665 Test Acc: 0.814
Validation loss decreased (-0.662143 --> -0.813497).  Saving model ...
Epoch: 4 cost time: 1.8598723411560059
Epoch: 4, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.226 Vali Acc: 0.822 Test Loss: 1.226 Test Acc: 0.822
Validation loss decreased (-0.813497 --> -0.821609).  Saving model ...
Epoch: 5 cost time: 1.6803946495056152
Epoch: 5, Steps: 17 | Train Loss: 0.990 Vali Loss: 0.704 Vali Acc: 0.905 Test Loss: 0.704 Test Acc: 0.905
Validation loss decreased (-0.821609 --> -0.905398).  Saving model ...
Epoch: 6 cost time: 1.5400810241699219
Epoch: 6, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.480 Vali Acc: 0.905 Test Loss: 0.480 Test Acc: 0.905
Validation loss decreased (-0.905398 --> -0.905401).  Saving model ...
Epoch: 7 cost time: 1.7442946434020996
Epoch: 7, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.287 Vali Acc: 0.927 Test Loss: 0.287 Test Acc: 0.927
Validation loss decreased (-0.905401 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 1.6530570983886719
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.237 Vali Acc: 0.927 Test Loss: 0.237 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927025).  Saving model ...
Epoch: 9 cost time: 1.6639173030853271
Epoch: 9, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
Validation loss decreased (-0.927025 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 1.7302837371826172
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.937836 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.6336047649383545
Epoch: 11, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5299055576324463
Epoch: 12, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.7298994064331055
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9874460697174072
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5218486785888672
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 1.6609611511230469
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 1.7303717136383057
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.951 Test Loss: 0.113 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.719712257385254
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8416352272033691
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9159398078918457
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7583534717559814
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6426777839660645
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.631155014038086
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6146337985992432
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4428112506866455
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.6787679195404053
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9591445922851562
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5452978610992432
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 1.8517627716064453
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.804832935333252
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.954 Test Loss: 0.110 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5120213031768799
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.039745330810547
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6786034107208252
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.222585439682007
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9996318817138672
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.2214746475219727
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.1052234172821045
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.959 Test Loss: 0.094 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8840916156768799
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 686893
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.564110517501831
Epoch: 1, Steps: 17 | Train Loss: 2.265 Vali Loss: 2.149 Vali Acc: 0.192 Test Loss: 2.149 Test Acc: 0.192
Validation loss decreased (inf --> -0.191870).  Saving model ...
Epoch: 2 cost time: 1.579042911529541
Epoch: 2, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.034 Vali Acc: 0.454 Test Loss: 2.034 Test Acc: 0.454
Validation loss decreased (-0.191870 --> -0.454034).  Saving model ...
Epoch: 3 cost time: 1.6987431049346924
Epoch: 3, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.748 Vali Acc: 0.724 Test Loss: 1.748 Test Acc: 0.724
Validation loss decreased (-0.454034 --> -0.724307).  Saving model ...
Epoch: 4 cost time: 1.7736022472381592
Epoch: 4, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.386 Vali Acc: 0.827 Test Loss: 1.386 Test Acc: 0.827
Validation loss decreased (-0.724307 --> -0.827013).  Saving model ...
Epoch: 5 cost time: 1.556839942932129
Epoch: 5, Steps: 17 | Train Loss: 1.224 Vali Loss: 0.970 Vali Acc: 0.881 Test Loss: 0.970 Test Acc: 0.881
Validation loss decreased (-0.827013 --> -0.881071).  Saving model ...
Epoch: 6 cost time: 1.597050428390503
Epoch: 6, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.553 Vali Acc: 0.914 Test Loss: 0.553 Test Acc: 0.914
Validation loss decreased (-0.881071 --> -0.913508).  Saving model ...
Epoch: 7 cost time: 1.57889986038208
Epoch: 7, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.913508 --> -0.929726).  Saving model ...
Epoch: 8 cost time: 1.65446138381958
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.264 Vali Acc: 0.943 Test Loss: 0.264 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 1.6001720428466797
Epoch: 9, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.483548641204834
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9778103828430176
Epoch: 11, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.6951329708099365
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7122392654418945
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7828011512756348
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6982886791229248
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.908759593963623
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.706432580947876
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.681298017501831
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7064001560211182
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7668023109436035
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.750523567199707
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.6689822673797607
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4778642654418945
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7411949634552002
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7691237926483154
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.802800178527832
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.754486322402954
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.526911973953247
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.592073678970337
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7266716957092285
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5949881076812744
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 522733
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.11331844329834
Epoch: 1, Steps: 17 | Train Loss: 2.255 Vali Loss: 2.162 Vali Acc: 0.241 Test Loss: 2.162 Test Acc: 0.241
Validation loss decreased (inf --> -0.240519).  Saving model ...
Epoch: 2 cost time: 1.7802088260650635
Epoch: 2, Steps: 17 | Train Loss: 2.136 Vali Loss: 2.011 Vali Acc: 0.416 Test Loss: 2.011 Test Acc: 0.416
Validation loss decreased (-0.240519 --> -0.416196).  Saving model ...
Epoch: 3 cost time: 1.715318202972412
Epoch: 3, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.756 Vali Acc: 0.670 Test Loss: 1.756 Test Acc: 0.670
Validation loss decreased (-0.416196 --> -0.670253).  Saving model ...
Epoch: 4 cost time: 1.9158108234405518
Epoch: 4, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.348 Vali Acc: 0.846 Test Loss: 1.348 Test Acc: 0.846
Validation loss decreased (-0.670253 --> -0.845932).  Saving model ...
Epoch: 5 cost time: 1.9154727458953857
Epoch: 5, Steps: 17 | Train Loss: 1.153 Vali Loss: 0.842 Vali Acc: 0.892 Test Loss: 0.842 Test Acc: 0.892
Validation loss decreased (-0.845932 --> -0.891883).  Saving model ...
Epoch: 6 cost time: 1.5729200839996338
Epoch: 6, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.552 Vali Acc: 0.905 Test Loss: 0.552 Test Acc: 0.905
Validation loss decreased (-0.891883 --> -0.905400).  Saving model ...
Epoch: 7 cost time: 2.1427266597747803
Epoch: 7, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.325 Vali Acc: 0.927 Test Loss: 0.325 Test Acc: 0.927
Validation loss decreased (-0.905400 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 2.2543089389801025
Epoch: 8, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6945879459381104
Epoch: 9, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
Validation loss decreased (-0.927024 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 1.82676100730896
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.6007816791534424
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8088922500610352
Epoch: 12, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1665499210357666
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8619964122772217
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.246 Vali Acc: 0.908 Test Loss: 0.246 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.091197967529297
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 2.1751575469970703
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2227911949157715
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.864274024963379
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8455300331115723
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8567605018615723
Epoch: 20, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 2.030552625656128
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0864052772521973
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 2.107391595840454
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1276683807373047
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.946 Test Loss: 0.126 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8975343704223633
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.930 Test Loss: 0.155 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.045314311981201
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.653477668762207
Epoch: 27, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6683189868927002
Epoch: 28, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.897 Test Loss: 0.274 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.301572322845459
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.133671998977661
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7494912147521973
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9083759784698486
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.946 Test Loss: 0.126 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 522413
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.643944263458252
Epoch: 1, Steps: 17 | Train Loss: 2.315 Vali Loss: 2.215 Vali Acc: 0.108 Test Loss: 2.215 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 1.855339765548706
Epoch: 2, Steps: 17 | Train Loss: 2.167 Vali Loss: 2.048 Vali Acc: 0.354 Test Loss: 2.048 Test Acc: 0.354
Validation loss decreased (-0.108086 --> -0.354034).  Saving model ...
Epoch: 3 cost time: 1.6361205577850342
Epoch: 3, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.868 Vali Acc: 0.554 Test Loss: 1.868 Test Acc: 0.554
Validation loss decreased (-0.354034 --> -0.554035).  Saving model ...
Epoch: 4 cost time: 1.8986680507659912
Epoch: 4, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.509 Vali Acc: 0.830 Test Loss: 1.509 Test Acc: 0.830
Validation loss decreased (-0.554035 --> -0.829715).  Saving model ...
Epoch: 5 cost time: 1.7760725021362305
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.001 Vali Acc: 0.930 Test Loss: 1.001 Test Acc: 0.930
Validation loss decreased (-0.829715 --> -0.929720).  Saving model ...
Epoch: 6 cost time: 1.6032733917236328
Epoch: 6, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.634 Vali Acc: 0.886 Test Loss: 0.634 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7484261989593506
Epoch: 7, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
Validation loss decreased (-0.929720 --> -0.940537).  Saving model ...
Epoch: 8 cost time: 1.9450390338897705
Epoch: 8, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8117215633392334
Epoch: 9, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.7141802310943604
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.5868055820465088
Epoch: 11, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.7284784317016602
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.656966209411621
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.210 Vali Acc: 0.916 Test Loss: 0.210 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8354766368865967
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.751786470413208
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.780125617980957
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.919 Test Loss: 0.193 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7703063488006592
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7705144882202148
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.90584135055542
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 1.6976184844970703
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5653576850891113
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.946 Test Loss: 0.135 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.920140266418457
Epoch: 22, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5958757400512695
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4304471015930176
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.265 Vali Acc: 0.916 Test Loss: 0.265 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5146803855895996
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6912755966186523
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7074379920959473
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.924 Test Loss: 0.244 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5133657455444336
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.663794755935669
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 522093
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.023284435272217
Epoch: 1, Steps: 17 | Train Loss: 2.284 Vali Loss: 2.143 Vali Acc: 0.230 Test Loss: 2.143 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 2.142789363861084
Epoch: 2, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.013 Vali Acc: 0.368 Test Loss: 2.013 Test Acc: 0.368
Validation loss decreased (-0.229708 --> -0.367547).  Saving model ...
Epoch: 3 cost time: 1.6936774253845215
Epoch: 3, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.783 Vali Acc: 0.662 Test Loss: 1.783 Test Acc: 0.662
Validation loss decreased (-0.367547 --> -0.662144).  Saving model ...
Epoch: 4 cost time: 1.9675016403198242
Epoch: 4, Steps: 17 | Train Loss: 1.678 Vali Loss: 1.479 Vali Acc: 0.768 Test Loss: 1.479 Test Acc: 0.768
Validation loss decreased (-0.662144 --> -0.767553).  Saving model ...
Epoch: 5 cost time: 1.6131782531738281
Epoch: 5, Steps: 17 | Train Loss: 1.250 Vali Loss: 0.998 Vali Acc: 0.859 Test Loss: 0.998 Test Acc: 0.859
Validation loss decreased (-0.767553 --> -0.859449).  Saving model ...
Epoch: 6 cost time: 1.8841023445129395
Epoch: 6, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.622 Vali Acc: 0.911 Test Loss: 0.622 Test Acc: 0.911
Validation loss decreased (-0.859449 --> -0.910805).  Saving model ...
Epoch: 7 cost time: 1.7052562236785889
Epoch: 7, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.343 Vali Acc: 0.935 Test Loss: 0.343 Test Acc: 0.935
Validation loss decreased (-0.910805 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 1.7752578258514404
Epoch: 8, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 1.776169776916504
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9862983226776123
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 1.6791608333587646
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 1.7027971744537354
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 1.977074384689331
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6903419494628906
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.948647 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 1.6922552585601807
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8720765113830566
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2295451164245605
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7548863887786865
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.059731960296631
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0767667293548584
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6193461418151855
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6902961730957031
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9278221130371094
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9944424629211426
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 521773
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.561175584793091
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.196 Vali Acc: 0.149 Test Loss: 2.196 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.7097036838531494
Epoch: 2, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.045 Vali Acc: 0.297 Test Loss: 2.045 Test Acc: 0.297
Validation loss decreased (-0.148627 --> -0.297277).  Saving model ...
Epoch: 3 cost time: 1.642976999282837
Epoch: 3, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.851 Vali Acc: 0.546 Test Loss: 1.851 Test Acc: 0.546
Validation loss decreased (-0.297277 --> -0.545927).  Saving model ...
Epoch: 4 cost time: 1.8885688781738281
Epoch: 4, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.516 Vali Acc: 0.846 Test Loss: 1.516 Test Acc: 0.846
Validation loss decreased (-0.545927 --> -0.845931).  Saving model ...
Epoch: 5 cost time: 2.4575486183166504
Epoch: 5, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.017 Vali Acc: 0.878 Test Loss: 1.017 Test Acc: 0.878
Validation loss decreased (-0.845931 --> -0.878368).  Saving model ...
Epoch: 6 cost time: 2.196280002593994
Epoch: 6, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.630 Vali Acc: 0.892 Test Loss: 0.630 Test Acc: 0.892
Validation loss decreased (-0.878368 --> -0.891886).  Saving model ...
Epoch: 7 cost time: 1.8180994987487793
Epoch: 7, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.334 Vali Acc: 0.935 Test Loss: 0.334 Test Acc: 0.935
Validation loss decreased (-0.891886 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 1.9055445194244385
Epoch: 8, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
Validation loss decreased (-0.935132 --> -0.948646).  Saving model ...
Epoch: 9 cost time: 1.8772485256195068
Epoch: 9, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.864283561706543
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.099306106567383
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.087444305419922
Epoch: 12, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.153 Vali Acc: 0.941 Test Loss: 0.153 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9139161109924316
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9594535827636719
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9977774620056152
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3495473861694336
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.8641159534454346
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1507322788238525
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 1.832289695739746
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.630791187286377
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7625365257263184
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.789815902709961
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.8025846481323242
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.798994541168213
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8885583877563477
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.954 Test Loss: 0.110 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7134854793548584
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.876326560974121
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8246369361877441
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.959 Test Loss: 0.097 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8310577869415283
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7399547100067139
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6256165504455566
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.927 Test Loss: 0.221 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.836524486541748
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 440173
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.734241485595703
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.091 Vali Acc: 0.351 Test Loss: 2.091 Test Acc: 0.351
Validation loss decreased (inf --> -0.351330).  Saving model ...
Epoch: 2 cost time: 1.6139416694641113
Epoch: 2, Steps: 17 | Train Loss: 2.106 Vali Loss: 1.968 Vali Acc: 0.570 Test Loss: 1.968 Test Acc: 0.570
Validation loss decreased (-0.351330 --> -0.570251).  Saving model ...
Epoch: 3 cost time: 1.6259043216705322
Epoch: 3, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.736 Vali Acc: 0.816 Test Loss: 1.736 Test Acc: 0.816
Validation loss decreased (-0.570251 --> -0.816199).  Saving model ...
Epoch: 4 cost time: 1.711683750152588
Epoch: 4, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.413 Vali Acc: 0.759 Test Loss: 1.413 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4795217514038086
Epoch: 5, Steps: 17 | Train Loss: 1.193 Vali Loss: 0.952 Vali Acc: 0.876 Test Loss: 0.952 Test Acc: 0.876
Validation loss decreased (-0.816199 --> -0.875666).  Saving model ...
Epoch: 6 cost time: 1.917142629623413
Epoch: 6, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.539 Vali Acc: 0.927 Test Loss: 0.539 Test Acc: 0.927
Validation loss decreased (-0.875666 --> -0.927022).  Saving model ...
Epoch: 7 cost time: 1.5644161701202393
Epoch: 7, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.331 Vali Acc: 0.943 Test Loss: 0.331 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943240).  Saving model ...
Epoch: 8 cost time: 1.841632604598999
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.6012921333312988
Epoch: 9, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.942885160446167
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.849778175354004
Epoch: 11, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.7046940326690674
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 1.6692001819610596
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5476055145263672
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5719027519226074
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 16 cost time: 1.9052183628082275
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.643852949142456
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 1.564295768737793
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.100186586380005
Epoch: 19, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.732832431793213
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5553035736083984
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9046807289123535
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.691270351409912
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9118025302886963
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.798140287399292
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7118372917175293
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 27 cost time: 1.8469007015228271
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.772684097290039
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.814626693725586
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6430811882019043
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6626338958740234
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7384302616119385
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9395596981048584
Epoch: 33, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7844390869140625
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.2238528728485107
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 1.652409553527832
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7327582836151123
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.67840576171875
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.832427740097046
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.613511085510254
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8464317321777344
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.8257391452789307
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5978648662567139
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8191282749176025
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.77836012840271
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 439853
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.140728235244751
Epoch: 1, Steps: 17 | Train Loss: 2.264 Vali Loss: 2.146 Vali Acc: 0.181 Test Loss: 2.146 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 1.9111299514770508
Epoch: 2, Steps: 17 | Train Loss: 2.140 Vali Loss: 2.043 Vali Acc: 0.303 Test Loss: 2.043 Test Acc: 0.303
Validation loss decreased (-0.181060 --> -0.302682).  Saving model ...
Epoch: 3 cost time: 1.6827993392944336
Epoch: 3, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.841 Vali Acc: 0.665 Test Loss: 1.841 Test Acc: 0.665
Validation loss decreased (-0.302682 --> -0.664846).  Saving model ...
Epoch: 4 cost time: 1.473893642425537
Epoch: 4, Steps: 17 | Train Loss: 1.743 Vali Loss: 1.484 Vali Acc: 0.835 Test Loss: 1.484 Test Acc: 0.835
Validation loss decreased (-0.664846 --> -0.835120).  Saving model ...
Epoch: 5 cost time: 1.4026908874511719
Epoch: 5, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.103 Vali Acc: 0.862 Test Loss: 1.103 Test Acc: 0.862
Validation loss decreased (-0.835120 --> -0.862151).  Saving model ...
Epoch: 6 cost time: 1.9627876281738281
Epoch: 6, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.660 Vali Acc: 0.919 Test Loss: 0.660 Test Acc: 0.919
Validation loss decreased (-0.862151 --> -0.918912).  Saving model ...
Epoch: 7 cost time: 1.9907736778259277
Epoch: 7, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.918912 --> -0.918915).  Saving model ...
Epoch: 8 cost time: 1.9288570880889893
Epoch: 8, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.264 Vali Acc: 0.938 Test Loss: 0.264 Test Acc: 0.938
Validation loss decreased (-0.918915 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 1.7931439876556396
Epoch: 9, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.655228614807129
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6623830795288086
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.8715434074401855
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.188 Vali Acc: 0.932 Test Loss: 0.188 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8063154220581055
Epoch: 13, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 1.6322109699249268
Epoch: 14, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1200265884399414
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.928389310836792
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 1.587531566619873
Epoch: 17, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 18 cost time: 1.8191907405853271
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 19 cost time: 1.7265114784240723
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2015738487243652
Epoch: 20, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.7627849578857422
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.597670078277588
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.946 Test Loss: 0.135 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7842838764190674
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.81669020652771
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.914 Test Loss: 0.250 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2704644203186035
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9239718914031982
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 27 cost time: 1.7797346115112305
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.924 Test Loss: 0.198 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6170620918273926
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0381381511688232
Epoch: 29, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8308665752410889
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7664270401000977
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.931204080581665
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.8972866535186768
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8475370407104492
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8167917728424072
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.640709400177002
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 439533
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.585192918777466
Epoch: 1, Steps: 17 | Train Loss: 2.296 Vali Loss: 2.207 Vali Acc: 0.073 Test Loss: 2.207 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 1.6523590087890625
Epoch: 2, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.058 Vali Acc: 0.357 Test Loss: 2.058 Test Acc: 0.357
Validation loss decreased (-0.072951 --> -0.356736).  Saving model ...
Epoch: 3 cost time: 1.8009674549102783
Epoch: 3, Steps: 17 | Train Loss: 1.993 Vali Loss: 1.907 Vali Acc: 0.454 Test Loss: 1.907 Test Acc: 0.454
Validation loss decreased (-0.356736 --> -0.454035).  Saving model ...
Epoch: 4 cost time: 1.6323843002319336
Epoch: 4, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.503 Vali Acc: 0.786 Test Loss: 1.503 Test Acc: 0.786
Validation loss decreased (-0.454035 --> -0.786471).  Saving model ...
Epoch: 5 cost time: 1.8490726947784424
Epoch: 5, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.056 Vali Acc: 0.865 Test Loss: 1.056 Test Acc: 0.865
Validation loss decreased (-0.786471 --> -0.864854).  Saving model ...
Epoch: 6 cost time: 1.7724127769470215
Epoch: 6, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.581 Vali Acc: 0.905 Test Loss: 0.581 Test Acc: 0.905
Validation loss decreased (-0.864854 --> -0.905400).  Saving model ...
Epoch: 7 cost time: 1.5979464054107666
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
Validation loss decreased (-0.905400 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 1.6297907829284668
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.274 Vali Acc: 0.927 Test Loss: 0.274 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 9 cost time: 1.791463851928711
Epoch: 9, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.278 Vali Acc: 0.916 Test Loss: 0.278 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.179511070251465
Epoch: 10, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.6110913753509521
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.8258695602416992
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8548614978790283
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9469208717346191
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.7737879753112793
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8442025184631348
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.7583043575286865
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.4174613952636719
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8363666534423828
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7009119987487793
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6845264434814453
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.757483720779419
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.993617296218872
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.094254493713379
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9149129390716553
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7477142810821533
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4995787143707275
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 439213
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.371277093887329
Epoch: 1, Steps: 17 | Train Loss: 2.318 Vali Loss: 2.183 Vali Acc: 0.149 Test Loss: 2.183 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.7781896591186523
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.084 Vali Acc: 0.249 Test Loss: 2.084 Test Acc: 0.249
Validation loss decreased (-0.148627 --> -0.248628).  Saving model ...
Epoch: 3 cost time: 1.5511724948883057
Epoch: 3, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.874 Vali Acc: 0.695 Test Loss: 1.874 Test Acc: 0.695
Validation loss decreased (-0.248628 --> -0.694576).  Saving model ...
Epoch: 4 cost time: 1.3945505619049072
Epoch: 4, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.598 Vali Acc: 0.811 Test Loss: 1.598 Test Acc: 0.811
Validation loss decreased (-0.694576 --> -0.810795).  Saving model ...
Epoch: 5 cost time: 1.6686639785766602
Epoch: 5, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.185 Vali Acc: 0.859 Test Loss: 1.185 Test Acc: 0.859
Validation loss decreased (-0.810795 --> -0.859448).  Saving model ...
Epoch: 6 cost time: 1.74867582321167
Epoch: 6, Steps: 17 | Train Loss: 1.013 Vali Loss: 0.860 Vali Acc: 0.873 Test Loss: 0.860 Test Acc: 0.873
Validation loss decreased (-0.859448 --> -0.872964).  Saving model ...
Epoch: 7 cost time: 1.9016287326812744
Epoch: 7, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.557 Vali Acc: 0.922 Test Loss: 0.557 Test Acc: 0.922
Validation loss decreased (-0.872964 --> -0.921616).  Saving model ...
Epoch: 8 cost time: 1.5187225341796875
Epoch: 8, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6512467861175537
Epoch: 9, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
Validation loss decreased (-0.921616 --> -0.935132).  Saving model ...
Epoch: 10 cost time: 1.6063897609710693
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6063117980957031
Epoch: 11, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.271 Vali Acc: 0.905 Test Loss: 0.271 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5664520263671875
Epoch: 12, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 1.689828872680664
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.6852707862854004
Epoch: 14, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7576451301574707
Epoch: 15, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7663209438323975
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.755075216293335
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.716817855834961
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7212955951690674
Epoch: 19, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 1.736828327178955
Epoch: 20, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8172650337219238
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2090795040130615
Epoch: 22, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9541101455688477
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1401379108428955
Epoch: 24, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9287426471710205
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6108477115631104
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7907440662384033
Epoch: 27, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8588900566101074
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7177183628082275
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 429709
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7591323852539062
Epoch: 1, Steps: 17 | Train Loss: 2.270 Vali Loss: 2.137 Vali Acc: 0.189 Test Loss: 2.137 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 1.890273094177246
Epoch: 2, Steps: 17 | Train Loss: 2.124 Vali Loss: 2.058 Vali Acc: 0.259 Test Loss: 2.058 Test Acc: 0.259
Validation loss decreased (-0.189168 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 1.479968547821045
Epoch: 3, Steps: 17 | Train Loss: 2.004 Vali Loss: 1.826 Vali Acc: 0.562 Test Loss: 1.826 Test Acc: 0.562
Validation loss decreased (-0.259439 --> -0.562144).  Saving model ...
Epoch: 4 cost time: 1.7900042533874512
Epoch: 4, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.500 Vali Acc: 0.835 Test Loss: 1.500 Test Acc: 0.835
Validation loss decreased (-0.562144 --> -0.835120).  Saving model ...
Epoch: 5 cost time: 1.7069673538208008
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.130 Vali Acc: 0.797 Test Loss: 1.130 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1910250186920166
Epoch: 6, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.786 Vali Acc: 0.897 Test Loss: 0.786 Test Acc: 0.897
Validation loss decreased (-0.835120 --> -0.897289).  Saving model ...
Epoch: 7 cost time: 2.1621522903442383
Epoch: 7, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.513 Vali Acc: 0.924 Test Loss: 0.513 Test Acc: 0.924
Validation loss decreased (-0.897289 --> -0.924319).  Saving model ...
Epoch: 8 cost time: 1.9240024089813232
Epoch: 8, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.402 Vali Acc: 0.932 Test Loss: 0.402 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932428).  Saving model ...
Epoch: 9 cost time: 2.0968685150146484
Epoch: 9, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9727685451507568
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.271 Vali Acc: 0.938 Test Loss: 0.271 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937835).  Saving model ...
Epoch: 11 cost time: 1.9861130714416504
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9808392524719238
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 13 cost time: 2.011927843093872
Epoch: 13, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.9704232215881348
Epoch: 14, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 1.9559142589569092
Epoch: 15, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 2.341268301010132
Epoch: 16, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 1.814267635345459
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8893077373504639
Epoch: 18, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.7057445049285889
Epoch: 19, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9810478687286377
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0805420875549316
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9824426174163818
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1203911304473877
Epoch: 23, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 1.8491263389587402
Epoch: 24, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.62119722366333
Epoch: 25, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.927 Test Loss: 0.162 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.727372646331787
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 2.017925977706909
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0788187980651855
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.938 Test Loss: 0.144 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7590670585632324
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8284094333648682
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.051854372024536
Epoch: 31, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7143244743347168
Epoch: 32, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.946 Test Loss: 0.122 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.073742628097534
Epoch: 33, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.023314952850342
Epoch: 34, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.916 Test Loss: 0.243 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8886504173278809
Epoch: 35, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7988858222961426
Epoch: 36, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 429549
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.030439376831055
Epoch: 1, Steps: 17 | Train Loss: 2.246 Vali Loss: 2.118 Vali Acc: 0.289 Test Loss: 2.118 Test Acc: 0.289
Validation loss decreased (inf --> -0.289168).  Saving model ...
Epoch: 2 cost time: 1.6618237495422363
Epoch: 2, Steps: 17 | Train Loss: 2.112 Vali Loss: 1.997 Vali Acc: 0.373 Test Loss: 1.997 Test Acc: 0.373
Validation loss decreased (-0.289168 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 1.862574815750122
Epoch: 3, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.820 Vali Acc: 0.659 Test Loss: 1.820 Test Acc: 0.659
Validation loss decreased (-0.372953 --> -0.659441).  Saving model ...
Epoch: 4 cost time: 1.964496374130249
Epoch: 4, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.477 Vali Acc: 0.814 Test Loss: 1.477 Test Acc: 0.814
Validation loss decreased (-0.659441 --> -0.813499).  Saving model ...
Epoch: 5 cost time: 1.6711437702178955
Epoch: 5, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.010 Vali Acc: 0.889 Test Loss: 1.010 Test Acc: 0.889
Validation loss decreased (-0.813499 --> -0.889179).  Saving model ...
Epoch: 6 cost time: 1.6274592876434326
Epoch: 6, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3554918766021729
Epoch: 7, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.499 Vali Acc: 0.903 Test Loss: 0.499 Test Acc: 0.903
Validation loss decreased (-0.889179 --> -0.902698).  Saving model ...
Epoch: 8 cost time: 2.0629985332489014
Epoch: 8, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.902698 --> -0.921618).  Saving model ...
Epoch: 9 cost time: 1.7218167781829834
Epoch: 9, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
Validation loss decreased (-0.921618 --> -0.932430).  Saving model ...
Epoch: 10 cost time: 1.6816484928131104
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6347012519836426
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.5250616073608398
Epoch: 12, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5081653594970703
Epoch: 13, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 1.647615671157837
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 1.6558258533477783
Epoch: 15, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 1.4768857955932617
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7157988548278809
Epoch: 17, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7796649932861328
Epoch: 18, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7715213298797607
Epoch: 19, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.695552110671997
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.194 Vali Acc: 0.924 Test Loss: 0.194 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6375305652618408
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.188 Vali Acc: 0.932 Test Loss: 0.188 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9988093376159668
Epoch: 22, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7986912727355957
Epoch: 23, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.924 Test Loss: 0.237 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7565267086029053
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.670743703842163
Epoch: 25, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 429389
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6266379356384277
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.155 Vali Acc: 0.241 Test Loss: 2.155 Test Acc: 0.241
Validation loss decreased (inf --> -0.240519).  Saving model ...
Epoch: 2 cost time: 1.415085792541504
Epoch: 2, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.074 Vali Acc: 0.268 Test Loss: 2.074 Test Acc: 0.268
Validation loss decreased (-0.240519 --> -0.267547).  Saving model ...
Epoch: 3 cost time: 1.4486777782440186
Epoch: 3, Steps: 17 | Train Loss: 2.100 Vali Loss: 1.947 Vali Acc: 0.641 Test Loss: 1.947 Test Acc: 0.641
Validation loss decreased (-0.267547 --> -0.640521).  Saving model ...
Epoch: 4 cost time: 1.6698365211486816
Epoch: 4, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.735 Vali Acc: 0.719 Test Loss: 1.735 Test Acc: 0.719
Validation loss decreased (-0.640521 --> -0.718902).  Saving model ...
Epoch: 5 cost time: 1.6278736591339111
Epoch: 5, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.377 Vali Acc: 0.811 Test Loss: 1.377 Test Acc: 0.811
Validation loss decreased (-0.718902 --> -0.810797).  Saving model ...
Epoch: 6 cost time: 1.4937374591827393
Epoch: 6, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.044 Vali Acc: 0.881 Test Loss: 1.044 Test Acc: 0.881
Validation loss decreased (-0.810797 --> -0.881071).  Saving model ...
Epoch: 7 cost time: 2.0562238693237305
Epoch: 7, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.713 Vali Acc: 0.903 Test Loss: 0.713 Test Acc: 0.903
Validation loss decreased (-0.881071 --> -0.902696).  Saving model ...
Epoch: 8 cost time: 1.7146167755126953
Epoch: 8, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.498 Vali Acc: 0.924 Test Loss: 0.498 Test Acc: 0.924
Validation loss decreased (-0.902696 --> -0.924319).  Saving model ...
Epoch: 9 cost time: 1.5513787269592285
Epoch: 9, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.359 Vali Acc: 0.932 Test Loss: 0.359 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932429).  Saving model ...
Epoch: 10 cost time: 1.5612235069274902
Epoch: 10, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.303 Vali Acc: 0.935 Test Loss: 0.303 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 1.6192936897277832
Epoch: 11, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.229 Vali Acc: 0.954 Test Loss: 0.229 Test Acc: 0.954
Validation loss decreased (-0.935132 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.6963481903076172
Epoch: 12, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.482586145401001
Epoch: 13, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6932244300842285
Epoch: 14, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 1.5143628120422363
Epoch: 15, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 1.6384556293487549
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5704638957977295
Epoch: 17, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5252423286437988
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4457693099975586
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 1.927457571029663
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.939650058746338
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.748643398284912
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8016514778137207
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4012553691864014
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5491666793823242
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4733915328979492
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 1.766800880432129
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8858513832092285
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.707477331161499
Epoch: 29, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.081348419189453
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.610854148864746
Epoch: 31, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.954 Test Loss: 0.105 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7669291496276855
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6620831489562988
Epoch: 33, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.705909252166748
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9121501445770264
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6677279472351074
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 429229
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.0998547077178955
Epoch: 1, Steps: 17 | Train Loss: 2.281 Vali Loss: 2.242 Vali Acc: 0.127 Test Loss: 2.242 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 1.9997341632843018
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.080 Vali Acc: 0.378 Test Loss: 2.080 Test Acc: 0.378
Validation loss decreased (-0.127005 --> -0.378358).  Saving model ...
Epoch: 3 cost time: 1.7856178283691406
Epoch: 3, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.951 Vali Acc: 0.511 Test Loss: 1.951 Test Acc: 0.511
Validation loss decreased (-0.378358 --> -0.510791).  Saving model ...
Epoch: 4 cost time: 1.634096622467041
Epoch: 4, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.789 Vali Acc: 0.649 Test Loss: 1.789 Test Acc: 0.649
Validation loss decreased (-0.510791 --> -0.648631).  Saving model ...
Epoch: 5 cost time: 1.4579260349273682
Epoch: 5, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.458 Vali Acc: 0.795 Test Loss: 1.458 Test Acc: 0.795
Validation loss decreased (-0.648631 --> -0.794580).  Saving model ...
Epoch: 6 cost time: 1.581735610961914
Epoch: 6, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.094 Vali Acc: 0.870 Test Loss: 1.094 Test Acc: 0.870
Validation loss decreased (-0.794580 --> -0.870259).  Saving model ...
Epoch: 7 cost time: 1.5727415084838867
Epoch: 7, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.765 Vali Acc: 0.903 Test Loss: 0.765 Test Acc: 0.903
Validation loss decreased (-0.870259 --> -0.902695).  Saving model ...
Epoch: 8 cost time: 1.548013687133789
Epoch: 8, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.551 Vali Acc: 0.903 Test Loss: 0.551 Test Acc: 0.903
Validation loss decreased (-0.902695 --> -0.902697).  Saving model ...
Epoch: 9 cost time: 1.7047338485717773
Epoch: 9, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.391 Vali Acc: 0.930 Test Loss: 0.391 Test Acc: 0.930
Validation loss decreased (-0.902697 --> -0.929726).  Saving model ...
Epoch: 10 cost time: 1.698315143585205
Epoch: 10, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 1.48972749710083
Epoch: 11, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.272 Vali Acc: 0.932 Test Loss: 0.272 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4555556774139404
Epoch: 12, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.6701648235321045
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6959280967712402
Epoch: 14, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7592127323150635
Epoch: 15, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5194616317749023
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5936698913574219
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.454756498336792
Epoch: 18, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4490966796875
Epoch: 19, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5275969505310059
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 1.850330114364624
Epoch: 21, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.9198429584503174
Epoch: 22, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5929346084594727
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0414655208587646
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.764310359954834
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7274196147918701
Epoch: 26, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.747338056564331
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 1.455232858657837
Epoch: 28, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7480580806732178
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6966052055358887
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.949 Test Loss: 0.124 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6940529346466064
Epoch: 31, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.83772873878479
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 33 cost time: 1.496138095855713
Epoch: 33, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6739673614501953
Epoch: 34, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.466127634048462
Epoch: 35, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6391301155090332
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4977858066558838
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8478045463562012
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 39 cost time: 1.6940150260925293
Epoch: 39, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.586179494857788
Epoch: 40, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5946555137634277
Epoch: 41, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5779955387115479
Epoch: 42, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6864054203033447
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6973435878753662
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.921593427658081
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.6073355674743652
Epoch: 46, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.596299171447754
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8192665576934814
Epoch: 48, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 263309
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1813600063323975
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.155 Vali Acc: 0.214 Test Loss: 2.155 Test Acc: 0.214
Validation loss decreased (inf --> -0.213492).  Saving model ...
Epoch: 2 cost time: 1.7601609230041504
Epoch: 2, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.069 Vali Acc: 0.262 Test Loss: 2.069 Test Acc: 0.262
Validation loss decreased (-0.213492 --> -0.262141).  Saving model ...
Epoch: 3 cost time: 2.4018564224243164
Epoch: 3, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.949 Vali Acc: 0.443 Test Loss: 1.949 Test Acc: 0.443
Validation loss decreased (-0.262141 --> -0.443224).  Saving model ...
Epoch: 4 cost time: 2.303619146347046
Epoch: 4, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.725 Vali Acc: 0.743 Test Loss: 1.725 Test Acc: 0.743
Validation loss decreased (-0.443224 --> -0.743226).  Saving model ...
Epoch: 5 cost time: 2.053379535675049
Epoch: 5, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.421 Vali Acc: 0.803 Test Loss: 1.421 Test Acc: 0.803
Validation loss decreased (-0.743226 --> -0.802688).  Saving model ...
Epoch: 6 cost time: 1.9087765216827393
Epoch: 6, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.062 Vali Acc: 0.876 Test Loss: 1.062 Test Acc: 0.876
Validation loss decreased (-0.802688 --> -0.875665).  Saving model ...
Epoch: 7 cost time: 2.0693304538726807
Epoch: 7, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.754 Vali Acc: 0.903 Test Loss: 0.754 Test Acc: 0.903
Validation loss decreased (-0.875665 --> -0.902695).  Saving model ...
Epoch: 8 cost time: 1.8979220390319824
Epoch: 8, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.534 Vali Acc: 0.911 Test Loss: 0.534 Test Acc: 0.911
Validation loss decreased (-0.902695 --> -0.910805).  Saving model ...
Epoch: 9 cost time: 1.7173044681549072
Epoch: 9, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.382 Vali Acc: 0.924 Test Loss: 0.382 Test Acc: 0.924
Validation loss decreased (-0.910805 --> -0.924321).  Saving model ...
Epoch: 10 cost time: 1.8765950202941895
Epoch: 10, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.319 Vali Acc: 0.924 Test Loss: 0.319 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 11 cost time: 1.6851351261138916
Epoch: 11, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.255 Vali Acc: 0.935 Test Loss: 0.255 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 1.974656343460083
Epoch: 12, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.245 Vali Acc: 0.932 Test Loss: 0.245 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7902510166168213
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 1.9774065017700195
Epoch: 14, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 2.237048387527466
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.613309383392334
Epoch: 16, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.813520908355713
Epoch: 17, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9090068340301514
Epoch: 18, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7579612731933594
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4355213642120361
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 1.501420497894287
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6700608730316162
Epoch: 22, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7250730991363525
Epoch: 23, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 24 cost time: 1.7069411277770996
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.941 Test Loss: 0.151 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.571258306503296
Epoch: 25, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7039031982421875
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 27 cost time: 1.8216638565063477
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.951 Test Loss: 0.121 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6976149082183838
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8253443241119385
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.946 Test Loss: 0.128 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7307236194610596
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.951 Test Loss: 0.115 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7793376445770264
Epoch: 31, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.949 Test Loss: 0.119 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8490381240844727
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4593226909637451
Epoch: 33, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7903013229370117
Epoch: 34, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.932 Test Loss: 0.166 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.649334192276001
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.6383142471313477
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.487567663192749
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.938 Test Loss: 0.155 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5754776000976562
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7621486186981201
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.6829898357391357
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.927 Test Loss: 0.200 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.7209224700927734
Epoch: 41, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.5116002559661865
Epoch: 42, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5579915046691895
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.7528626918792725
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3627865314483643
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.957 Test Loss: 0.103 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 263149
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3103885650634766
Epoch: 1, Steps: 17 | Train Loss: 2.316 Vali Loss: 2.176 Vali Acc: 0.103 Test Loss: 2.176 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 1.456583023071289
Epoch: 2, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.108 Vali Acc: 0.186 Test Loss: 2.108 Test Acc: 0.186
Validation loss decreased (-0.102681 --> -0.186465).  Saving model ...
Epoch: 3 cost time: 1.466508388519287
Epoch: 3, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.034 Vali Acc: 0.395 Test Loss: 2.034 Test Acc: 0.395
Validation loss decreased (-0.186465 --> -0.394574).  Saving model ...
Epoch: 4 cost time: 1.665318489074707
Epoch: 4, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.821 Vali Acc: 0.686 Test Loss: 1.821 Test Acc: 0.686
Validation loss decreased (-0.394574 --> -0.686468).  Saving model ...
Epoch: 5 cost time: 1.6464767456054688
Epoch: 5, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.524 Vali Acc: 0.814 Test Loss: 1.524 Test Acc: 0.814
Validation loss decreased (-0.686468 --> -0.813498).  Saving model ...
Epoch: 6 cost time: 1.515383243560791
Epoch: 6, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.160 Vali Acc: 0.857 Test Loss: 1.160 Test Acc: 0.857
Validation loss decreased (-0.813498 --> -0.856745).  Saving model ...
Epoch: 7 cost time: 1.6307673454284668
Epoch: 7, Steps: 17 | Train Loss: 1.019 Vali Loss: 0.837 Vali Acc: 0.914 Test Loss: 0.837 Test Acc: 0.914
Validation loss decreased (-0.856745 --> -0.913505).  Saving model ...
Epoch: 8 cost time: 1.5075256824493408
Epoch: 8, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.604 Vali Acc: 0.895 Test Loss: 0.604 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.978586196899414
Epoch: 9, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.433 Vali Acc: 0.932 Test Loss: 0.433 Test Acc: 0.932
Validation loss decreased (-0.913505 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 1.7908830642700195
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.335 Vali Acc: 0.935 Test Loss: 0.335 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 1.651381492614746
Epoch: 11, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.268 Vali Acc: 0.935 Test Loss: 0.268 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 1.8006565570831299
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.259 Vali Acc: 0.927 Test Loss: 0.259 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.512436866760254
Epoch: 13, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 14 cost time: 2.288294792175293
Epoch: 14, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 1.743415355682373
Epoch: 15, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.204 Vali Acc: 0.938 Test Loss: 0.204 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7420661449432373
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6661479473114014
Epoch: 17, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 1.6421709060668945
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5723881721496582
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6864516735076904
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5237603187561035
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.7147753238677979
Epoch: 22, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6137325763702393
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.505035161972046
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 1.6965603828430176
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5863313674926758
Epoch: 26, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.725318431854248
Epoch: 27, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5096611976623535
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.50392746925354
Epoch: 29, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.211 Vali Acc: 0.916 Test Loss: 0.211 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4775056838989258
Epoch: 30, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7109341621398926
Epoch: 31, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6427788734436035
Epoch: 32, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6136932373046875
Epoch: 33, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5713450908660889
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5981643199920654
Epoch: 35, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5220062732696533
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.949 Test Loss: 0.123 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 262989
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.429492950439453
Epoch: 1, Steps: 17 | Train Loss: 2.324 Vali Loss: 2.207 Vali Acc: 0.103 Test Loss: 2.207 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 1.7369120121002197
Epoch: 2, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.147 Vali Acc: 0.211 Test Loss: 2.147 Test Acc: 0.211
Validation loss decreased (-0.102681 --> -0.210789).  Saving model ...
Epoch: 3 cost time: 1.8042781352996826
Epoch: 3, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.006 Vali Acc: 0.514 Test Loss: 2.006 Test Acc: 0.514
Validation loss decreased (-0.210789 --> -0.513493).  Saving model ...
Epoch: 4 cost time: 1.5941014289855957
Epoch: 4, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.831 Vali Acc: 0.600 Test Loss: 1.831 Test Acc: 0.600
Validation loss decreased (-0.513493 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 1.6706113815307617
Epoch: 5, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.573 Vali Acc: 0.743 Test Loss: 1.573 Test Acc: 0.743
Validation loss decreased (-0.599982 --> -0.743228).  Saving model ...
Epoch: 6 cost time: 1.629819393157959
Epoch: 6, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.196 Vali Acc: 0.827 Test Loss: 1.196 Test Acc: 0.827
Validation loss decreased (-0.743228 --> -0.827015).  Saving model ...
Epoch: 7 cost time: 1.683434009552002
Epoch: 7, Steps: 17 | Train Loss: 1.080 Vali Loss: 0.855 Vali Acc: 0.876 Test Loss: 0.855 Test Acc: 0.876
Validation loss decreased (-0.827015 --> -0.875667).  Saving model ...
Epoch: 8 cost time: 1.736436128616333
Epoch: 8, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.587 Vali Acc: 0.897 Test Loss: 0.587 Test Acc: 0.897
Validation loss decreased (-0.875667 --> -0.897291).  Saving model ...
Epoch: 9 cost time: 1.787175178527832
Epoch: 9, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.439 Vali Acc: 0.903 Test Loss: 0.439 Test Acc: 0.903
Validation loss decreased (-0.897291 --> -0.902698).  Saving model ...
Epoch: 10 cost time: 1.6512343883514404
Epoch: 10, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.902698 --> -0.918916).  Saving model ...
Epoch: 11 cost time: 1.5506036281585693
Epoch: 11, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.302 Vali Acc: 0.924 Test Loss: 0.302 Test Acc: 0.924
Validation loss decreased (-0.918916 --> -0.924321).  Saving model ...
Epoch: 12 cost time: 1.746109962463379
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.255 Vali Acc: 0.927 Test Loss: 0.255 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 13 cost time: 1.789278507232666
Epoch: 13, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
Validation loss decreased (-0.927024 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 1.467416763305664
Epoch: 14, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.557178258895874
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.550367832183838
Epoch: 16, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 1.625187873840332
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.578808069229126
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 1.747945785522461
Epoch: 19, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 1.4562184810638428
Epoch: 20, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.576561450958252
Epoch: 21, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4533443450927734
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.948647 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 1.523543119430542
Epoch: 23, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.665191888809204
Epoch: 24, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5124409198760986
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5949647426605225
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.943 Test Loss: 0.131 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5363764762878418
Epoch: 27, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7258787155151367
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5809473991394043
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6135890483856201
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.946 Test Loss: 0.125 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6141021251678467
Epoch: 31, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.521070957183838
Epoch: 32, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 262829
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3865339756011963
Epoch: 1, Steps: 17 | Train Loss: 2.288 Vali Loss: 2.211 Vali Acc: 0.173 Test Loss: 2.211 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 1.8655402660369873
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.068 Vali Acc: 0.424 Test Loss: 2.068 Test Acc: 0.424
Validation loss decreased (-0.172951 --> -0.424304).  Saving model ...
Epoch: 3 cost time: 1.701761245727539
Epoch: 3, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.002 Vali Acc: 0.451 Test Loss: 2.002 Test Acc: 0.451
Validation loss decreased (-0.424304 --> -0.451331).  Saving model ...
Epoch: 4 cost time: 1.9070143699645996
Epoch: 4, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.846 Vali Acc: 0.681 Test Loss: 1.846 Test Acc: 0.681
Validation loss decreased (-0.451331 --> -0.681063).  Saving model ...
Epoch: 5 cost time: 1.5865793228149414
Epoch: 5, Steps: 17 | Train Loss: 1.796 Vali Loss: 1.635 Vali Acc: 0.805 Test Loss: 1.635 Test Acc: 0.805
Validation loss decreased (-0.681063 --> -0.805389).  Saving model ...
Epoch: 6 cost time: 1.6985838413238525
Epoch: 6, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.377 Vali Acc: 0.862 Test Loss: 1.377 Test Acc: 0.862
Validation loss decreased (-0.805389 --> -0.862148).  Saving model ...
Epoch: 7 cost time: 1.6064236164093018
Epoch: 7, Steps: 17 | Train Loss: 1.213 Vali Loss: 0.998 Vali Acc: 0.900 Test Loss: 0.998 Test Acc: 0.900
Validation loss decreased (-0.862148 --> -0.899990).  Saving model ...
Epoch: 8 cost time: 1.5794470310211182
Epoch: 8, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.699 Vali Acc: 0.935 Test Loss: 0.699 Test Acc: 0.935
Validation loss decreased (-0.899990 --> -0.935128).  Saving model ...
Epoch: 9 cost time: 1.910404920578003
Epoch: 9, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.467 Vali Acc: 0.938 Test Loss: 0.467 Test Acc: 0.938
Validation loss decreased (-0.935128 --> -0.937833).  Saving model ...
Epoch: 10 cost time: 1.7862837314605713
Epoch: 10, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
Validation loss decreased (-0.937833 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 1.5737159252166748
Epoch: 11, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.295 Vali Acc: 0.938 Test Loss: 0.295 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 12 cost time: 1.5347185134887695
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 1.5901014804840088
Epoch: 13, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948646).  Saving model ...
Epoch: 14 cost time: 1.4820072650909424
Epoch: 14, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 1.632739543914795
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.6241111755371094
Epoch: 16, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.777418613433838
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 1.792797565460205
Epoch: 18, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 1.9800055027008057
Epoch: 19, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6513116359710693
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.5955960750579834
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.519092321395874
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7529702186584473
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0590007305145264
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8336644172668457
Epoch: 25, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 1.765479326248169
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 1.8862733840942383
Epoch: 27, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7785701751708984
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 29 cost time: 1.5245859622955322
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.769357681274414
Epoch: 30, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9583353996276855
Epoch: 31, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.938918113708496
Epoch: 32, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.693061113357544
Epoch: 33, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.8744380474090576
Epoch: 34, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.514141321182251
Epoch: 35, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.40533447265625
Epoch: 36, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.949 Test Loss: 0.120 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.828986644744873
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.714195728302002
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.943 Test Loss: 0.139 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 180109
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5969648361206055
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.199 Vali Acc: 0.105 Test Loss: 2.199 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 1.7354049682617188
Epoch: 2, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.122 Vali Acc: 0.300 Test Loss: 2.122 Test Acc: 0.300
Validation loss decreased (-0.105383 --> -0.299979).  Saving model ...
Epoch: 3 cost time: 1.9054903984069824
Epoch: 3, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.072 Vali Acc: 0.370 Test Loss: 2.072 Test Acc: 0.370
Validation loss decreased (-0.299979 --> -0.370250).  Saving model ...
Epoch: 4 cost time: 1.8575348854064941
Epoch: 4, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.914 Vali Acc: 0.630 Test Loss: 1.914 Test Acc: 0.630
Validation loss decreased (-0.370250 --> -0.629711).  Saving model ...
Epoch: 5 cost time: 1.9657602310180664
Epoch: 5, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.708 Vali Acc: 0.773 Test Loss: 1.708 Test Acc: 0.773
Validation loss decreased (-0.629711 --> -0.772956).  Saving model ...
Epoch: 6 cost time: 1.5551962852478027
Epoch: 6, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.403 Vali Acc: 0.816 Test Loss: 1.403 Test Acc: 0.816
Validation loss decreased (-0.772956 --> -0.816202).  Saving model ...
Epoch: 7 cost time: 1.7778942584991455
Epoch: 7, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.030 Vali Acc: 0.892 Test Loss: 1.030 Test Acc: 0.892
Validation loss decreased (-0.816202 --> -0.891882).  Saving model ...
Epoch: 8 cost time: 1.687723159790039
Epoch: 8, Steps: 17 | Train Loss: 0.878 Vali Loss: 0.707 Vali Acc: 0.919 Test Loss: 0.707 Test Acc: 0.919
Validation loss decreased (-0.891882 --> -0.918912).  Saving model ...
Epoch: 9 cost time: 1.6258699893951416
Epoch: 9, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.474 Vali Acc: 0.908 Test Loss: 0.474 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7544035911560059
Epoch: 10, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
Validation loss decreased (-0.918912 --> -0.921618).  Saving model ...
Epoch: 11 cost time: 1.7489502429962158
Epoch: 11, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.310 Vali Acc: 0.924 Test Loss: 0.310 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 12 cost time: 1.8208787441253662
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935133).  Saving model ...
Epoch: 13 cost time: 1.560788869857788
Epoch: 13, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.221 Vali Acc: 0.927 Test Loss: 0.221 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6730263233184814
Epoch: 14, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6016895771026611
Epoch: 15, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 1.67807936668396
Epoch: 16, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7816791534423828
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3718795776367188
Epoch: 18, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 19 cost time: 1.7819995880126953
Epoch: 19, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 2.134047746658325
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 1.8165087699890137
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8852319717407227
Epoch: 22, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 1.6393592357635498
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0332376956939697
Epoch: 24, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.80368971824646
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6748080253601074
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9323914051055908
Epoch: 27, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6085450649261475
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5895905494689941
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.607703685760498
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4326488971710205
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.938 Test Loss: 0.145 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7772984504699707
Epoch: 32, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 179949
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.770446300506592
Epoch: 1, Steps: 17 | Train Loss: 2.295 Vali Loss: 2.163 Vali Acc: 0.249 Test Loss: 2.163 Test Acc: 0.249
Validation loss decreased (inf --> -0.248627).  Saving model ...
Epoch: 2 cost time: 1.6513164043426514
Epoch: 2, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.114 Vali Acc: 0.162 Test Loss: 2.114 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.038084030151367
Epoch: 3, Steps: 17 | Train Loss: 2.137 Vali Loss: 2.000 Vali Acc: 0.503 Test Loss: 2.000 Test Acc: 0.503
Validation loss decreased (-0.248627 --> -0.502683).  Saving model ...
Epoch: 4 cost time: 1.889981985092163
Epoch: 4, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.864 Vali Acc: 0.705 Test Loss: 1.864 Test Acc: 0.705
Validation loss decreased (-0.502683 --> -0.705387).  Saving model ...
Epoch: 5 cost time: 1.8571619987487793
Epoch: 5, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.635 Vali Acc: 0.830 Test Loss: 1.635 Test Acc: 0.830
Validation loss decreased (-0.705387 --> -0.829713).  Saving model ...
Epoch: 6 cost time: 1.6679720878601074
Epoch: 6, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.311 Vali Acc: 0.881 Test Loss: 1.311 Test Acc: 0.881
Validation loss decreased (-0.829713 --> -0.881068).  Saving model ...
Epoch: 7 cost time: 1.7639203071594238
Epoch: 7, Steps: 17 | Train Loss: 1.202 Vali Loss: 0.970 Vali Acc: 0.914 Test Loss: 0.970 Test Acc: 0.914
Validation loss decreased (-0.881068 --> -0.913504).  Saving model ...
Epoch: 8 cost time: 1.543487787246704
Epoch: 8, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.704 Vali Acc: 0.930 Test Loss: 0.704 Test Acc: 0.930
Validation loss decreased (-0.913504 --> -0.929723).  Saving model ...
Epoch: 9 cost time: 1.7484467029571533
Epoch: 9, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.487 Vali Acc: 0.943 Test Loss: 0.487 Test Acc: 0.943
Validation loss decreased (-0.929723 --> -0.943238).  Saving model ...
Epoch: 10 cost time: 2.0283515453338623
Epoch: 10, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.340 Vali Acc: 0.949 Test Loss: 0.340 Test Acc: 0.949
Validation loss decreased (-0.943238 --> -0.948645).  Saving model ...
Epoch: 11 cost time: 1.6569888591766357
Epoch: 11, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.285 Vali Acc: 0.949 Test Loss: 0.285 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.6950929164886475
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 1.8774731159210205
Epoch: 13, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.015373945236206
Epoch: 14, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 1.8870604038238525
Epoch: 15, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 1.7615747451782227
Epoch: 16, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8604741096496582
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.1055479049682617
Epoch: 18, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8908443450927734
Epoch: 19, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 1.8306841850280762
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9399142265319824
Epoch: 21, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.50455641746521
Epoch: 22, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 1.640787124633789
Epoch: 23, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7605366706848145
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8606140613555908
Epoch: 25, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 1.7370007038116455
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5104048252105713
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.903597116470337
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.000436305999756
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6067419052124023
Epoch: 30, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8831474781036377
Epoch: 31, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0010557174682617
Epoch: 32, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.954 Test Loss: 0.103 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9650769233703613
Epoch: 33, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.87760591506958
Epoch: 34, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.951 Test Loss: 0.114 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7098875045776367
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 179789
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6597812175750732
Epoch: 1, Steps: 17 | Train Loss: 2.287 Vali Loss: 2.223 Vali Acc: 0.024 Test Loss: 2.223 Test Acc: 0.024
Validation loss decreased (inf --> -0.024302).  Saving model ...
Epoch: 2 cost time: 1.5641729831695557
Epoch: 2, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.174 Vali Acc: 0.197 Test Loss: 2.174 Test Acc: 0.197
Validation loss decreased (-0.024302 --> -0.197276).  Saving model ...
Epoch: 3 cost time: 1.581533432006836
Epoch: 3, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.085 Vali Acc: 0.351 Test Loss: 2.085 Test Acc: 0.351
Validation loss decreased (-0.197276 --> -0.351331).  Saving model ...
Epoch: 4 cost time: 1.321523904800415
Epoch: 4, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.965 Vali Acc: 0.468 Test Loss: 1.965 Test Acc: 0.468
Validation loss decreased (-0.351331 --> -0.467548).  Saving model ...
Epoch: 5 cost time: 1.5794060230255127
Epoch: 5, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.826 Vali Acc: 0.514 Test Loss: 1.826 Test Acc: 0.514
Validation loss decreased (-0.467548 --> -0.513495).  Saving model ...
Epoch: 6 cost time: 1.8603174686431885
Epoch: 6, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.552 Vali Acc: 0.759 Test Loss: 1.552 Test Acc: 0.759
Validation loss decreased (-0.513495 --> -0.759444).  Saving model ...
Epoch: 7 cost time: 1.3383471965789795
Epoch: 7, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.230 Vali Acc: 0.792 Test Loss: 1.230 Test Acc: 0.792
Validation loss decreased (-0.759444 --> -0.791880).  Saving model ...
Epoch: 8 cost time: 1.6015830039978027
Epoch: 8, Steps: 17 | Train Loss: 1.056 Vali Loss: 0.861 Vali Acc: 0.897 Test Loss: 0.861 Test Acc: 0.897
Validation loss decreased (-0.791880 --> -0.897289).  Saving model ...
Epoch: 9 cost time: 1.5984735488891602
Epoch: 9, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.623 Vali Acc: 0.911 Test Loss: 0.623 Test Acc: 0.911
Validation loss decreased (-0.897289 --> -0.910805).  Saving model ...
Epoch: 10 cost time: 1.5184812545776367
Epoch: 10, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.910805 --> -0.924320).  Saving model ...
Epoch: 11 cost time: 1.5563068389892578
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.924320 --> -0.940537).  Saving model ...
Epoch: 12 cost time: 1.7696161270141602
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.258 Vali Acc: 0.946 Test Loss: 0.258 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.3830571174621582
Epoch: 13, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4299023151397705
Epoch: 14, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6182379722595215
Epoch: 15, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3776462078094482
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8860671520233154
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.5985522270202637
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.524665355682373
Epoch: 19, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6392853260040283
Epoch: 20, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 1.6127526760101318
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5156426429748535
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6014184951782227
Epoch: 23, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 1.73305344581604
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.506683111190796
Epoch: 25, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6743035316467285
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5352067947387695
Epoch: 27, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 1.5349688529968262
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5396947860717773
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5835273265838623
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 1.7965922355651855
Epoch: 31, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.736553430557251
Epoch: 32, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4111213684082031
Epoch: 33, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5381944179534912
Epoch: 34, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4026727676391602
Epoch: 35, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6704399585723877
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.588303804397583
Epoch: 37, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4516398906707764
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3416461944580078
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.438676118850708
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 179629
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.169950485229492
Epoch: 1, Steps: 17 | Train Loss: 2.257 Vali Loss: 2.198 Vali Acc: 0.127 Test Loss: 2.198 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 1.7837116718292236
Epoch: 2, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.037 Vali Acc: 0.468 Test Loss: 2.037 Test Acc: 0.468
Validation loss decreased (-0.127005 --> -0.467547).  Saving model ...
Epoch: 3 cost time: 1.4558517932891846
Epoch: 3, Steps: 17 | Train Loss: 2.039 Vali Loss: 1.961 Vali Acc: 0.570 Test Loss: 1.961 Test Acc: 0.570
Validation loss decreased (-0.467547 --> -0.570251).  Saving model ...
Epoch: 4 cost time: 1.7689309120178223
Epoch: 4, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.802 Vali Acc: 0.630 Test Loss: 1.802 Test Acc: 0.630
Validation loss decreased (-0.570251 --> -0.629712).  Saving model ...
Epoch: 5 cost time: 1.6765828132629395
Epoch: 5, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.550 Vali Acc: 0.784 Test Loss: 1.550 Test Acc: 0.784
Validation loss decreased (-0.629712 --> -0.783768).  Saving model ...
Epoch: 6 cost time: 1.6074178218841553
Epoch: 6, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.259 Vali Acc: 0.805 Test Loss: 1.259 Test Acc: 0.805
Validation loss decreased (-0.783768 --> -0.805393).  Saving model ...
Epoch: 7 cost time: 1.6879289150238037
Epoch: 7, Steps: 17 | Train Loss: 1.104 Vali Loss: 0.932 Vali Acc: 0.878 Test Loss: 0.932 Test Acc: 0.878
Validation loss decreased (-0.805393 --> -0.878369).  Saving model ...
Epoch: 8 cost time: 1.5809030532836914
Epoch: 8, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.878369 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.6752283573150635
Epoch: 9, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.463 Vali Acc: 0.935 Test Loss: 0.463 Test Acc: 0.935
Validation loss decreased (-0.899994 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 1.5609393119812012
Epoch: 10, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.352 Vali Acc: 0.927 Test Loss: 0.352 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4830536842346191
Epoch: 11, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 12 cost time: 1.4183363914489746
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.5558116436004639
Epoch: 13, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.813291072845459
Epoch: 14, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 1.4398362636566162
Epoch: 15, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5220959186553955
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.8065345287322998
Epoch: 17, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7503530979156494
Epoch: 18, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 1.7532360553741455
Epoch: 19, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.7752189636230469
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.856126308441162
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6355512142181396
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8941199779510498
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5266203880310059
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6255111694335938
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6279230117797852
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8615193367004395
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8898305892944336
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7296547889709473
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 138509
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.451275110244751
Epoch: 1, Steps: 17 | Train Loss: 2.309 Vali Loss: 2.231 Vali Acc: 0.108 Test Loss: 2.231 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 1.4620225429534912
Epoch: 2, Steps: 17 | Train Loss: 2.224 Vali Loss: 2.156 Vali Acc: 0.135 Test Loss: 2.156 Test Acc: 0.135
Validation loss decreased (-0.108086 --> -0.135114).  Saving model ...
Epoch: 3 cost time: 1.6658368110656738
Epoch: 3, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.053 Vali Acc: 0.362 Test Loss: 2.053 Test Acc: 0.362
Validation loss decreased (-0.135114 --> -0.362142).  Saving model ...
Epoch: 4 cost time: 1.7805263996124268
Epoch: 4, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.953 Vali Acc: 0.541 Test Loss: 1.953 Test Acc: 0.541
Validation loss decreased (-0.362142 --> -0.540521).  Saving model ...
Epoch: 5 cost time: 1.6137971878051758
Epoch: 5, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.793 Vali Acc: 0.622 Test Loss: 1.793 Test Acc: 0.622
Validation loss decreased (-0.540521 --> -0.621604).  Saving model ...
Epoch: 6 cost time: 1.6304490566253662
Epoch: 6, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.527 Vali Acc: 0.759 Test Loss: 1.527 Test Acc: 0.759
Validation loss decreased (-0.621604 --> -0.759444).  Saving model ...
Epoch: 7 cost time: 1.9611473083496094
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.201 Vali Acc: 0.908 Test Loss: 1.201 Test Acc: 0.908
Validation loss decreased (-0.759444 --> -0.908096).  Saving model ...
Epoch: 8 cost time: 1.604093074798584
Epoch: 8, Steps: 17 | Train Loss: 1.036 Vali Loss: 0.869 Vali Acc: 0.908 Test Loss: 0.869 Test Acc: 0.908
Validation loss decreased (-0.908096 --> -0.908099).  Saving model ...
Epoch: 9 cost time: 1.9774410724639893
Epoch: 9, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.609 Vali Acc: 0.935 Test Loss: 0.609 Test Acc: 0.935
Validation loss decreased (-0.908099 --> -0.935129).  Saving model ...
Epoch: 10 cost time: 1.707700252532959
Epoch: 10, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.441 Vali Acc: 0.927 Test Loss: 0.441 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6451802253723145
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.341 Vali Acc: 0.935 Test Loss: 0.341 Test Acc: 0.935
Validation loss decreased (-0.935129 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 1.5683646202087402
Epoch: 12, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.296 Vali Acc: 0.935 Test Loss: 0.296 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 13 cost time: 1.5816786289215088
Epoch: 13, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 1.732590913772583
Epoch: 14, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.245 Vali Acc: 0.932 Test Loss: 0.245 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.636857509613037
Epoch: 15, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.707542896270752
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0351414680480957
Epoch: 17, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9379181861877441
Epoch: 18, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 1.7581806182861328
Epoch: 19, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.730330467224121
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9879393577575684
Epoch: 21, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7661826610565186
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 1.819875955581665
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5941846370697021
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.7120013236999512
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8091325759887695
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9312903881072998
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8271663188934326
Epoch: 28, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 1.738703727722168
Epoch: 29, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 1.508653163909912
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 31 cost time: 1.479130506515503
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6909868717193604
Epoch: 32, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.974231481552124
Epoch: 33, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8175253868103027
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9178516864776611
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8702423572540283
Epoch: 36, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8725194931030273
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7026612758636475
Epoch: 38, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.204155921936035
Epoch: 39, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.085864782333374
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 138349
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.56038761138916
Epoch: 1, Steps: 17 | Train Loss: 2.292 Vali Loss: 2.157 Vali Acc: 0.162 Test Loss: 2.157 Test Acc: 0.162
Validation loss decreased (inf --> -0.162141).  Saving model ...
Epoch: 2 cost time: 1.4382131099700928
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.108 Vali Acc: 0.216 Test Loss: 2.108 Test Acc: 0.216
Validation loss decreased (-0.162141 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 1.602520227432251
Epoch: 3, Steps: 17 | Train Loss: 2.109 Vali Loss: 2.007 Vali Acc: 0.468 Test Loss: 2.007 Test Acc: 0.468
Validation loss decreased (-0.216195 --> -0.467547).  Saving model ...
Epoch: 4 cost time: 1.4287095069885254
Epoch: 4, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.859 Vali Acc: 0.678 Test Loss: 1.859 Test Acc: 0.678
Validation loss decreased (-0.467547 --> -0.678360).  Saving model ...
Epoch: 5 cost time: 1.425180435180664
Epoch: 5, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.645 Vali Acc: 0.843 Test Loss: 1.645 Test Acc: 0.843
Validation loss decreased (-0.678360 --> -0.843227).  Saving model ...
Epoch: 6 cost time: 1.4714512825012207
Epoch: 6, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.353 Vali Acc: 0.878 Test Loss: 1.353 Test Acc: 0.878
Validation loss decreased (-0.843227 --> -0.878365).  Saving model ...
Epoch: 7 cost time: 1.5345146656036377
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.009 Vali Acc: 0.905 Test Loss: 1.009 Test Acc: 0.905
Validation loss decreased (-0.878365 --> -0.905395).  Saving model ...
Epoch: 8 cost time: 1.6065633296966553
Epoch: 8, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.704 Vali Acc: 0.922 Test Loss: 0.704 Test Acc: 0.922
Validation loss decreased (-0.905395 --> -0.921615).  Saving model ...
Epoch: 9 cost time: 1.78590989112854
Epoch: 9, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.484 Vali Acc: 0.922 Test Loss: 0.484 Test Acc: 0.922
Validation loss decreased (-0.921615 --> -0.921617).  Saving model ...
Epoch: 10 cost time: 1.5661473274230957
Epoch: 10, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.353 Vali Acc: 0.935 Test Loss: 0.353 Test Acc: 0.935
Validation loss decreased (-0.921617 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 1.5454418659210205
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5120856761932373
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 1.4404008388519287
Epoch: 13, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.232 Vali Acc: 0.938 Test Loss: 0.232 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4379653930664062
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6146430969238281
Epoch: 15, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 1.6265294551849365
Epoch: 16, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 1.5731401443481445
Epoch: 17, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 1.6352488994598389
Epoch: 18, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 1.5797288417816162
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8378965854644775
Epoch: 20, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 1.6365327835083008
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3945229053497314
Epoch: 22, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5463294982910156
Epoch: 23, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6250381469726562
Epoch: 24, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 1.5330848693847656
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 1.3368031978607178
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.349959135055542
Epoch: 27, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 1.3816993236541748
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.932 Test Loss: 0.182 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4540832042694092
Epoch: 29, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6394712924957275
Epoch: 30, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 1.59051513671875
Epoch: 31, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6844737529754639
Epoch: 32, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.719336986541748
Epoch: 33, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6263904571533203
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6457641124725342
Epoch: 35, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6502225399017334
Epoch: 36, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.623307466506958
Epoch: 37, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5982697010040283
Epoch: 38, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.927 Test Loss: 0.219 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8893795013427734
Epoch: 39, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5993916988372803
Epoch: 40, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 138189
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.406590461730957
Epoch: 1, Steps: 17 | Train Loss: 2.382 Vali Loss: 2.273 Vali Acc: 0.135 Test Loss: 2.273 Test Acc: 0.135
Validation loss decreased (inf --> -0.135112).  Saving model ...
Epoch: 2 cost time: 1.7668917179107666
Epoch: 2, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.163 Vali Acc: 0.100 Test Loss: 2.163 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5337250232696533
Epoch: 3, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.105 Vali Acc: 0.297 Test Loss: 2.105 Test Acc: 0.297
Validation loss decreased (-0.135112 --> -0.297276).  Saving model ...
Epoch: 4 cost time: 1.59100341796875
Epoch: 4, Steps: 17 | Train Loss: 2.021 Vali Loss: 1.951 Vali Acc: 0.573 Test Loss: 1.951 Test Acc: 0.573
Validation loss decreased (-0.297276 --> -0.572953).  Saving model ...
Epoch: 5 cost time: 1.896864414215088
Epoch: 5, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.787 Vali Acc: 0.681 Test Loss: 1.787 Test Acc: 0.681
Validation loss decreased (-0.572953 --> -0.681063).  Saving model ...
Epoch: 6 cost time: 1.5524113178253174
Epoch: 6, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.519 Vali Acc: 0.781 Test Loss: 1.519 Test Acc: 0.781
Validation loss decreased (-0.681063 --> -0.781066).  Saving model ...
Epoch: 7 cost time: 1.7694144248962402
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.170 Vali Acc: 0.851 Test Loss: 1.170 Test Acc: 0.851
Validation loss decreased (-0.781066 --> -0.851340).  Saving model ...
Epoch: 8 cost time: 1.6430234909057617
Epoch: 8, Steps: 17 | Train Loss: 0.986 Vali Loss: 0.789 Vali Acc: 0.930 Test Loss: 0.789 Test Acc: 0.930
Validation loss decreased (-0.851340 --> -0.929722).  Saving model ...
Epoch: 9 cost time: 2.0199646949768066
Epoch: 9, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.557 Vali Acc: 0.924 Test Loss: 0.557 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1511335372924805
Epoch: 10, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.405 Vali Acc: 0.927 Test Loss: 0.405 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8698837757110596
Epoch: 11, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.317 Vali Acc: 0.935 Test Loss: 0.317 Test Acc: 0.935
Validation loss decreased (-0.929722 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 1.509192943572998
Epoch: 12, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0203945636749268
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.250 Vali Acc: 0.927 Test Loss: 0.250 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3358349800109863
Epoch: 14, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.225 Vali Acc: 0.932 Test Loss: 0.225 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3397161960601807
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 1.775331735610962
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4123804569244385
Epoch: 17, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 1.8052682876586914
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.756828784942627
Epoch: 19, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 20 cost time: 1.8267977237701416
Epoch: 20, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 1.5279881954193115
Epoch: 21, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 1.9835765361785889
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 23 cost time: 1.7539489269256592
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1006460189819336
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7297275066375732
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 1.8070242404937744
Epoch: 26, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6620187759399414
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8719637393951416
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6638283729553223
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 1.598557949066162
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6596615314483643
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6424174308776855
Epoch: 32, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.620471477508545
Epoch: 33, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8786695003509521
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7941310405731201
Epoch: 35, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.932 Test Loss: 0.180 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0605876445770264
Epoch: 36, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.458312749862671
Epoch: 37, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.546957015991211
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 39 cost time: 1.658634901046753
Epoch: 39, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.594062328338623
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6884551048278809
Epoch: 41, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9221129417419434
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5737195014953613
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6824703216552734
Epoch: 44, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 45 cost time: 1.4746923446655273
Epoch: 45, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.0701076984405518
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.9193406105041504
Epoch: 47, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.6246626377105713
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.6979029178619385
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8015801906585693
Epoch: 50, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.630497694015503
Epoch: 51, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.951 Test Loss: 0.111 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.7588152885437012
Epoch: 52, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.5482828617095947
Epoch: 53, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.6494393348693848
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 138029
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7326462268829346
Epoch: 1, Steps: 17 | Train Loss: 2.258 Vali Loss: 1.978 Vali Acc: 0.257 Test Loss: 1.978 Test Acc: 0.257
Validation loss decreased (inf --> -0.256737).  Saving model ...
Epoch: 2 cost time: 1.406672477722168
Epoch: 2, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.367 Vali Acc: 0.689 Test Loss: 1.367 Test Acc: 0.689
Validation loss decreased (-0.256737 --> -0.689176).  Saving model ...
Epoch: 3 cost time: 1.3205394744873047
Epoch: 3, Steps: 17 | Train Loss: 1.031 Vali Loss: 0.876 Vali Acc: 0.811 Test Loss: 0.876 Test Acc: 0.811
Validation loss decreased (-0.689176 --> -0.810802).  Saving model ...
Epoch: 4 cost time: 1.330662488937378
Epoch: 4, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.257 Vali Acc: 0.943 Test Loss: 0.257 Test Acc: 0.943
Validation loss decreased (-0.810802 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 1.3675503730773926
Epoch: 5, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.264 Vali Acc: 0.916 Test Loss: 0.264 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1977391242980957
Epoch: 6, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.202040433883667
Epoch: 7, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2731173038482666
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.26814603805542
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.3348064422607422
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.938 Test Loss: 0.169 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5002541542053223
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.310103178024292
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0716464519500732
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 1.382800817489624
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1949653625488281
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 1.1122448444366455
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3469202518463135
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.456352710723877
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2715036869049072
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2596592903137207
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5124592781066895
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3585007190704346
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6297824382781982
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2810940742492676
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1982662677764893
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4848673
model size : 23.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9608447551727295
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 1.906 Vali Acc: 0.403 Test Loss: 1.906 Test Acc: 0.403
Validation loss decreased (inf --> -0.402684).  Saving model ...
Epoch: 2 cost time: 1.2015042304992676
Epoch: 2, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.437 Vali Acc: 0.443 Test Loss: 1.437 Test Acc: 0.443
Validation loss decreased (-0.402684 --> -0.443229).  Saving model ...
Epoch: 3 cost time: 1.2900934219360352
Epoch: 3, Steps: 17 | Train Loss: 1.000 Vali Loss: 0.696 Vali Acc: 0.811 Test Loss: 0.696 Test Acc: 0.811
Validation loss decreased (-0.443229 --> -0.810804).  Saving model ...
Epoch: 4 cost time: 1.2303030490875244
Epoch: 4, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
Validation loss decreased (-0.810804 --> -0.902699).  Saving model ...
Epoch: 5 cost time: 1.3634653091430664
Epoch: 5, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.902699 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.1196465492248535
Epoch: 6, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.138 Vali Acc: 0.943 Test Loss: 0.138 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.148362159729004
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945945).  Saving model ...
Epoch: 8 cost time: 1.102562427520752
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.949 Test Loss: 0.116 Test Acc: 0.949
Validation loss decreased (-0.945945 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.0550165176391602
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.018186092376709
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 0.9884417057037354
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1912837028503418
Epoch: 12, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 1.1016559600830078
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6072394847869873
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1902570724487305
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9956173896789551
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1579885482788086
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3216240406036377
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2890088558197021
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2366917133331299
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1205811500549316
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1048901081085205
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4847905
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4796102046966553
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.059 Vali Acc: 0.165 Test Loss: 2.059 Test Acc: 0.165
Validation loss decreased (inf --> -0.164844).  Saving model ...
Epoch: 2 cost time: 1.369429349899292
Epoch: 2, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.549 Vali Acc: 0.559 Test Loss: 1.549 Test Acc: 0.559
Validation loss decreased (-0.164844 --> -0.559444).  Saving model ...
Epoch: 3 cost time: 1.2704253196716309
Epoch: 3, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
Validation loss decreased (-0.559444 --> -0.859452).  Saving model ...
Epoch: 4 cost time: 1.51572847366333
Epoch: 4, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.475 Vali Acc: 0.835 Test Loss: 0.475 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1452772617340088
Epoch: 5, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.859452 --> -0.910808).  Saving model ...
Epoch: 6 cost time: 1.0703136920928955
Epoch: 6, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.910808 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.180757761001587
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4776527881622314
Epoch: 8, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.241593837738037
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.276792287826538
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3099572658538818
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3656957149505615
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.967566 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.1230578422546387
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0342588424682617
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.211867094039917
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.065675973892212
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1946823596954346
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0051522254943848
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3255832195281982
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0491876602172852
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3903172016143799
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1851115226745605
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 4847137
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1276907920837402
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 1.999 Vali Acc: 0.305 Test Loss: 1.999 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 1.1704332828521729
Epoch: 2, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.308 Vali Acc: 0.786 Test Loss: 1.308 Test Acc: 0.786
Validation loss decreased (-0.305385 --> -0.786473).  Saving model ...
Epoch: 3 cost time: 1.3037192821502686
Epoch: 3, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.640 Vali Acc: 0.870 Test Loss: 0.640 Test Acc: 0.870
Validation loss decreased (-0.786473 --> -0.870264).  Saving model ...
Epoch: 4 cost time: 1.2581253051757812
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
Validation loss decreased (-0.870264 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.260500192642212
Epoch: 5, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.236 Vali Acc: 0.916 Test Loss: 0.236 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.17515230178833
Epoch: 6, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.199763536453247
Epoch: 7, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.182 Vali Acc: 0.927 Test Loss: 0.182 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.127873420715332
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1967308521270752
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.343 Vali Acc: 0.897 Test Loss: 0.343 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1827101707458496
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.194 Vali Acc: 0.932 Test Loss: 0.194 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1124684810638428
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0781221389770508
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.937835 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 1.1178200244903564
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.125697135925293
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2998716831207275
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.306 Vali Acc: 0.916 Test Loss: 0.306 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1831998825073242
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1209239959716797
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.388 Vali Acc: 0.914 Test Loss: 0.388 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.094811201095581
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.268991231918335
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0408389568328857
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.248 Vali Acc: 0.949 Test Loss: 0.248 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2255380153656006
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2228319644927979
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 4846369
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1755878925323486
Epoch: 1, Steps: 17 | Train Loss: 2.301 Vali Loss: 1.988 Vali Acc: 0.184 Test Loss: 1.988 Test Acc: 0.184
Validation loss decreased (inf --> -0.183764).  Saving model ...
Epoch: 2 cost time: 1.125675916671753
Epoch: 2, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.419 Vali Acc: 0.643 Test Loss: 1.419 Test Acc: 0.643
Validation loss decreased (-0.183764 --> -0.643229).  Saving model ...
Epoch: 3 cost time: 1.1542091369628906
Epoch: 3, Steps: 17 | Train Loss: 1.140 Vali Loss: 0.799 Vali Acc: 0.851 Test Loss: 0.799 Test Acc: 0.851
Validation loss decreased (-0.643229 --> -0.851343).  Saving model ...
Epoch: 4 cost time: 1.324735403060913
Epoch: 4, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.300 Vali Acc: 0.943 Test Loss: 0.300 Test Acc: 0.943
Validation loss decreased (-0.851343 --> -0.943240).  Saving model ...
Epoch: 5 cost time: 1.1817469596862793
Epoch: 5, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.095654010772705
Epoch: 6, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.234 Vali Acc: 0.916 Test Loss: 0.234 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5930848121643066
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.204 Vali Acc: 0.924 Test Loss: 0.204 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3297100067138672
Epoch: 8, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.2907519340515137
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.247135877609253
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.2304444313049316
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.959 Test Loss: 0.099 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2288024425506592
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.323216199874878
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.403282642364502
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4795761108398438
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3993709087371826
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.1557502746582031
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.3773396015167236
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2236590385437012
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4869771003723145
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5651249885559082
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4344713687896729
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3807473182678223
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2850730419158936
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4225475788116455
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4174668788909912
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4956438541412354
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 4060705
model size : 20.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.164619207382202
Epoch: 1, Steps: 17 | Train Loss: 2.295 Vali Loss: 1.885 Vali Acc: 0.495 Test Loss: 1.885 Test Acc: 0.495
Validation loss decreased (inf --> -0.494576).  Saving model ...
Epoch: 2 cost time: 1.2028522491455078
Epoch: 2, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.422 Vali Acc: 0.608 Test Loss: 1.422 Test Acc: 0.608
Validation loss decreased (-0.494576 --> -0.608094).  Saving model ...
Epoch: 3 cost time: 1.3024649620056152
Epoch: 3, Steps: 17 | Train Loss: 1.046 Vali Loss: 0.717 Vali Acc: 0.886 Test Loss: 0.717 Test Acc: 0.886
Validation loss decreased (-0.608094 --> -0.886479).  Saving model ...
Epoch: 4 cost time: 1.3467655181884766
Epoch: 4, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.282 Vali Acc: 0.943 Test Loss: 0.282 Test Acc: 0.943
Validation loss decreased (-0.886479 --> -0.943240).  Saving model ...
Epoch: 5 cost time: 1.1385455131530762
Epoch: 5, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.6102712154388428
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4142487049102783
Epoch: 7, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5740725994110107
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.127 Vali Acc: 0.941 Test Loss: 0.127 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.237788438796997
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956756).  Saving model ...
Epoch: 10 cost time: 1.3214988708496094
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.170 Vali Acc: 0.932 Test Loss: 0.170 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2734119892120361
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.286417007446289
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2005610466003418
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5301976203918457
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 1.2981188297271729
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 16 cost time: 1.5535247325897217
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1965959072113037
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6399214267730713
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5680642127990723
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.554593801498413
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.414086103439331
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.943 Test Loss: 0.275 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.302494764328003
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5026321411132812
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5927059650421143
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6904568672180176
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3330302238464355
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3306024074554443
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.313 Vali Acc: 0.916 Test Loss: 0.313 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2536990642547607
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2183754444122314
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4392144680023193
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.351 Vali Acc: 0.924 Test Loss: 0.351 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 4059937
model size : 20.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5953335762023926
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 1.972 Vali Acc: 0.238 Test Loss: 1.972 Test Acc: 0.238
Validation loss decreased (inf --> -0.237818).  Saving model ...
Epoch: 2 cost time: 1.257237195968628
Epoch: 2, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.359 Vali Acc: 0.692 Test Loss: 1.359 Test Acc: 0.692
Validation loss decreased (-0.237818 --> -0.691878).  Saving model ...
Epoch: 3 cost time: 1.2166790962219238
Epoch: 3, Steps: 17 | Train Loss: 1.077 Vali Loss: 0.978 Vali Acc: 0.711 Test Loss: 0.978 Test Acc: 0.711
Validation loss decreased (-0.691878 --> -0.710801).  Saving model ...
Epoch: 4 cost time: 1.2084143161773682
Epoch: 4, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.359 Vali Acc: 0.916 Test Loss: 0.359 Test Acc: 0.916
Validation loss decreased (-0.710801 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 1.3628640174865723
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.284 Vali Acc: 0.908 Test Loss: 0.284 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2340972423553467
Epoch: 6, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.916213 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.4775166511535645
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 1.6424541473388672
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.954 Test Loss: 0.109 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 1.32423734664917
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.246419906616211
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.25722074508667
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4140007495880127
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.244 Vali Acc: 0.924 Test Loss: 0.244 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2989017963409424
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6531703472137451
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.332634687423706
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3865330219268799
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2148306369781494
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2261133193969727
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.357 Vali Acc: 0.914 Test Loss: 0.357 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 4059169
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0799648761749268
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.087 Vali Acc: 0.170 Test Loss: 2.087 Test Acc: 0.170
Validation loss decreased (inf --> -0.170249).  Saving model ...
Epoch: 2 cost time: 1.0864794254302979
Epoch: 2, Steps: 17 | Train Loss: 1.672 Vali Loss: 1.307 Vali Acc: 0.759 Test Loss: 1.307 Test Acc: 0.759
Validation loss decreased (-0.170249 --> -0.759446).  Saving model ...
Epoch: 3 cost time: 1.1777582168579102
Epoch: 3, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.754 Vali Acc: 0.851 Test Loss: 0.754 Test Acc: 0.851
Validation loss decreased (-0.759446 --> -0.851344).  Saving model ...
Epoch: 4 cost time: 1.1693739891052246
Epoch: 4, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.331 Vali Acc: 0.932 Test Loss: 0.331 Test Acc: 0.932
Validation loss decreased (-0.851344 --> -0.932429).  Saving model ...
Epoch: 5 cost time: 1.0834698677062988
Epoch: 5, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 1.0431008338928223
Epoch: 6, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.935133 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.1048963069915771
Epoch: 7, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1945626735687256
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2668416500091553
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.295 Vali Acc: 0.897 Test Loss: 0.295 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0979242324829102
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.954 Test Loss: 0.107 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1950626373291016
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 0.9847633838653564
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1420824527740479
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.927 Test Loss: 0.276 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.146862268447876
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2177200317382812
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0663933753967285
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.319 Vali Acc: 0.924 Test Loss: 0.319 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2244043350219727
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.1848175525665283
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1531622409820557
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1068365573883057
Epoch: 20, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1024253368377686
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2108361721038818
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1143193244934082
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.0912079811096191
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.943 Test Loss: 0.257 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0516486167907715
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0074083805084229
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.001189947128296
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1460204124450684
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2378144264221191
Epoch: 29, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2370600700378418
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1363511085510254
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.949 Test Loss: 0.289 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0568726062774658
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.946 Test Loss: 0.318 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1738853454589844
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 4058401
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2283427715301514
Epoch: 1, Steps: 17 | Train Loss: 2.240 Vali Loss: 1.902 Vali Acc: 0.473 Test Loss: 1.902 Test Acc: 0.473
Validation loss decreased (inf --> -0.472954).  Saving model ...
Epoch: 2 cost time: 1.225980520248413
Epoch: 2, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.521 Vali Acc: 0.441 Test Loss: 1.521 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2307236194610596
Epoch: 3, Steps: 17 | Train Loss: 1.055 Vali Loss: 0.811 Vali Acc: 0.830 Test Loss: 0.811 Test Acc: 0.830
Validation loss decreased (-0.472954 --> -0.829722).  Saving model ...
Epoch: 4 cost time: 1.0677456855773926
Epoch: 4, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.583 Vali Acc: 0.762 Test Loss: 0.583 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.268630027770996
Epoch: 5, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
Validation loss decreased (-0.829722 --> -0.878375).  Saving model ...
Epoch: 6 cost time: 1.046992301940918
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.878375 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.0399696826934814
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2241346836090088
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 1.4277706146240234
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.297966480255127
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.182673692703247
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.1660702228546143
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3425109386444092
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1715962886810303
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2818779945373535
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1339428424835205
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4029877185821533
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.32053542137146
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.207265853881836
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2314045429229736
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2176899909973145
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 3666721
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.796516180038452
Epoch: 1, Steps: 17 | Train Loss: 2.266 Vali Loss: 2.026 Vali Acc: 0.314 Test Loss: 2.026 Test Acc: 0.314
Validation loss decreased (inf --> -0.313493).  Saving model ...
Epoch: 2 cost time: 1.155045986175537
Epoch: 2, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.464 Vali Acc: 0.705 Test Loss: 1.464 Test Acc: 0.705
Validation loss decreased (-0.313493 --> -0.705391).  Saving model ...
Epoch: 3 cost time: 1.1658480167388916
Epoch: 3, Steps: 17 | Train Loss: 1.063 Vali Loss: 0.756 Vali Acc: 0.900 Test Loss: 0.756 Test Acc: 0.900
Validation loss decreased (-0.705391 --> -0.899992).  Saving model ...
Epoch: 4 cost time: 1.1045596599578857
Epoch: 4, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.122649908065796
Epoch: 5, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.899992 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 1.1581764221191406
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.2120106220245361
Epoch: 7, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1927263736724854
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.190 Vali Acc: 0.932 Test Loss: 0.190 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5296962261199951
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.2515878677368164
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2465009689331055
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2760026454925537
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0756759643554688
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.962 Test Loss: 0.087 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 1.1765198707580566
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2794709205627441
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.30409836769104
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.916 Test Loss: 0.323 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1891334056854248
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2130365371704102
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3634624481201172
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.294 Vali Acc: 0.943 Test Loss: 0.294 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1130340099334717
Epoch: 20, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0813260078430176
Epoch: 21, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.340 Vali Acc: 0.932 Test Loss: 0.340 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2067065238952637
Epoch: 22, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.519 Vali Acc: 0.897 Test Loss: 0.519 Test Acc: 0.897
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2310130596160889
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3665953
model size : 18.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6313812732696533
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 1.940 Vali Acc: 0.476 Test Loss: 1.940 Test Acc: 0.476
Validation loss decreased (inf --> -0.475656).  Saving model ...
Epoch: 2 cost time: 1.3185856342315674
Epoch: 2, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.598 Vali Acc: 0.495 Test Loss: 1.598 Test Acc: 0.495
Validation loss decreased (-0.475656 --> -0.494579).  Saving model ...
Epoch: 3 cost time: 1.0740149021148682
Epoch: 3, Steps: 17 | Train Loss: 1.113 Vali Loss: 0.898 Vali Acc: 0.730 Test Loss: 0.898 Test Acc: 0.730
Validation loss decreased (-0.494579 --> -0.729721).  Saving model ...
Epoch: 4 cost time: 1.2588279247283936
Epoch: 4, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.416 Vali Acc: 0.903 Test Loss: 0.416 Test Acc: 0.903
Validation loss decreased (-0.729721 --> -0.902699).  Saving model ...
Epoch: 5 cost time: 1.1744024753570557
Epoch: 5, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.902699 --> -0.921619).  Saving model ...
Epoch: 6 cost time: 1.1823740005493164
Epoch: 6, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.921619 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.2021002769470215
Epoch: 7, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.175 Vali Acc: 0.924 Test Loss: 0.175 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1035687923431396
Epoch: 8, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.927 Test Loss: 0.157 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0514461994171143
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3318026065826416
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.1101555824279785
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2798974514007568
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0463557243347168
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.932 Test Loss: 0.194 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.151071310043335
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1539161205291748
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0730748176574707
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0806212425231934
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.156897783279419
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1680209636688232
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2125635147094727
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3665185
model size : 18.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.917469024658203
Epoch: 1, Steps: 17 | Train Loss: 2.273 Vali Loss: 1.907 Vali Acc: 0.473 Test Loss: 1.907 Test Acc: 0.473
Validation loss decreased (inf --> -0.472954).  Saving model ...
Epoch: 2 cost time: 1.190422534942627
Epoch: 2, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.431 Vali Acc: 0.570 Test Loss: 1.431 Test Acc: 0.570
Validation loss decreased (-0.472954 --> -0.570256).  Saving model ...
Epoch: 3 cost time: 1.4045021533966064
Epoch: 3, Steps: 17 | Train Loss: 1.093 Vali Loss: 0.699 Vali Acc: 0.911 Test Loss: 0.699 Test Acc: 0.911
Validation loss decreased (-0.570256 --> -0.910804).  Saving model ...
Epoch: 4 cost time: 1.2932236194610596
Epoch: 4, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.910804 --> -0.929726).  Saving model ...
Epoch: 5 cost time: 1.2601356506347656
Epoch: 5, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.235 Vali Acc: 0.924 Test Loss: 0.235 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1421098709106445
Epoch: 6, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
Validation loss decreased (-0.929726 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.5819237232208252
Epoch: 7, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.075005054473877
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.143 Vali Acc: 0.941 Test Loss: 0.143 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2323849201202393
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.2986433506011963
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3037500381469727
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2105650901794434
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4480586051940918
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3738689422607422
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2112913131713867
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.916 Test Loss: 0.307 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4028515815734863
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2813129425048828
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6813881397247314
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2104835510253906
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3664417
model size : 18.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9143776893615723
Epoch: 1, Steps: 17 | Train Loss: 2.192 Vali Loss: 1.954 Vali Acc: 0.257 Test Loss: 1.954 Test Acc: 0.257
Validation loss decreased (inf --> -0.256737).  Saving model ...
Epoch: 2 cost time: 1.0808911323547363
Epoch: 2, Steps: 17 | Train Loss: 1.678 Vali Loss: 1.338 Vali Acc: 0.708 Test Loss: 1.338 Test Acc: 0.708
Validation loss decreased (-0.256737 --> -0.708095).  Saving model ...
Epoch: 3 cost time: 1.151099681854248
Epoch: 3, Steps: 17 | Train Loss: 1.088 Vali Loss: 0.892 Vali Acc: 0.754 Test Loss: 0.892 Test Acc: 0.754
Validation loss decreased (-0.708095 --> -0.754045).  Saving model ...
Epoch: 4 cost time: 1.2541511058807373
Epoch: 4, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.452 Vali Acc: 0.892 Test Loss: 0.452 Test Acc: 0.892
Validation loss decreased (-0.754045 --> -0.891887).  Saving model ...
Epoch: 5 cost time: 1.0671522617340088
Epoch: 5, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
Validation loss decreased (-0.891887 --> -0.921619).  Saving model ...
Epoch: 6 cost time: 1.0694913864135742
Epoch: 6, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.258 Vali Acc: 0.914 Test Loss: 0.258 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0622308254241943
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.921619 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 1.1371819972991943
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1904749870300293
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.241 Vali Acc: 0.943 Test Loss: 0.241 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3554425239562988
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2410006523132324
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1112415790557861
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.2509169578552246
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1738755702972412
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3315577507019043
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2913317680358887
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.278249979019165
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3695571422576904
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3708558082580566
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3141183853149414
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.075561761856079
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2472200393676758
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 3469729
model size : 18.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0476760864257812
Epoch: 1, Steps: 17 | Train Loss: 2.206 Vali Loss: 1.975 Vali Acc: 0.424 Test Loss: 1.975 Test Acc: 0.424
Validation loss decreased (inf --> -0.424305).  Saving model ...
Epoch: 2 cost time: 1.1052219867706299
Epoch: 2, Steps: 17 | Train Loss: 1.754 Vali Loss: 1.470 Vali Acc: 0.438 Test Loss: 1.470 Test Acc: 0.438
Validation loss decreased (-0.424305 --> -0.437823).  Saving model ...
Epoch: 3 cost time: 1.177722692489624
Epoch: 3, Steps: 17 | Train Loss: 1.150 Vali Loss: 0.935 Vali Acc: 0.716 Test Loss: 0.935 Test Acc: 0.716
Validation loss decreased (-0.437823 --> -0.716207).  Saving model ...
Epoch: 4 cost time: 1.071310043334961
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.348 Vali Acc: 0.935 Test Loss: 0.348 Test Acc: 0.935
Validation loss decreased (-0.716207 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.246025562286377
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.254241704940796
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.219 Vali Acc: 0.927 Test Loss: 0.219 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1374342441558838
Epoch: 7, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2062768936157227
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1888952255249023
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.945944 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 0.9970271587371826
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.927 Test Loss: 0.226 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0470349788665771
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.1210711002349854
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2298994064331055
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.281977891921997
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3477940559387207
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 1.2579014301300049
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2379093170166016
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.329301118850708
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 1.1511890888214111
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2788732051849365
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3289082050323486
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3178343772888184
Epoch: 22, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1468684673309326
Epoch: 23, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2712008953094482
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3676824569702148
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.118656873703003
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1301977634429932
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.951 Test Loss: 0.238 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1453945636749268
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.919 Test Loss: 0.507 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 3468961
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.732384204864502
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.191 Vali Acc: 0.065 Test Loss: 2.191 Test Acc: 0.065
Validation loss decreased (inf --> -0.064843).  Saving model ...
Epoch: 2 cost time: 0.951279878616333
Epoch: 2, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.289 Vali Acc: 0.854 Test Loss: 1.289 Test Acc: 0.854
Validation loss decreased (-0.064843 --> -0.854041).  Saving model ...
Epoch: 3 cost time: 1.3836617469787598
Epoch: 3, Steps: 17 | Train Loss: 1.091 Vali Loss: 0.803 Vali Acc: 0.786 Test Loss: 0.803 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.131338357925415
Epoch: 4, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
Validation loss decreased (-0.854041 --> -0.910807).  Saving model ...
Epoch: 5 cost time: 1.1402182579040527
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
Validation loss decreased (-0.910807 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.1167070865631104
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.3661894798278809
Epoch: 7, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.945944 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 1.3338403701782227
Epoch: 8, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9629268646240234
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1792681217193604
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2449619770050049
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0837278366088867
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1963634490966797
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.045830249786377
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0868005752563477
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0792107582092285
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.119246244430542
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 3468193
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6076924800872803
Epoch: 1, Steps: 17 | Train Loss: 2.137 Vali Loss: 1.873 Vali Acc: 0.357 Test Loss: 1.873 Test Acc: 0.357
Validation loss decreased (inf --> -0.356738).  Saving model ...
Epoch: 2 cost time: 1.1419315338134766
Epoch: 2, Steps: 17 | Train Loss: 1.687 Vali Loss: 1.296 Vali Acc: 0.741 Test Loss: 1.296 Test Acc: 0.741
Validation loss decreased (-0.356738 --> -0.740528).  Saving model ...
Epoch: 3 cost time: 1.1425390243530273
Epoch: 3, Steps: 17 | Train Loss: 1.069 Vali Loss: 0.968 Vali Acc: 0.816 Test Loss: 0.968 Test Acc: 0.816
Validation loss decreased (-0.740528 --> -0.816207).  Saving model ...
Epoch: 4 cost time: 1.3254356384277344
Epoch: 4, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.478 Vali Acc: 0.849 Test Loss: 0.478 Test Acc: 0.849
Validation loss decreased (-0.816207 --> -0.848644).  Saving model ...
Epoch: 5 cost time: 1.057616949081421
Epoch: 5, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.848644 --> -0.929728).  Saving model ...
Epoch: 6 cost time: 1.168177843093872
Epoch: 6, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
Validation loss decreased (-0.929728 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.524294137954712
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.259826421737671
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.167 Vali Acc: 0.932 Test Loss: 0.167 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2742815017700195
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.916 Test Loss: 0.232 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.08872652053833
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1597645282745361
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.170513391494751
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.171116590499878
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 1.3482344150543213
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1583611965179443
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.231 Vali Acc: 0.927 Test Loss: 0.231 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2447903156280518
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2700421810150146
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1160871982574463
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.109513521194458
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0916941165924072
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1731681823730469
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.211756706237793
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3911211490631104
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 3467425
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6762239933013916
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.060 Vali Acc: 0.305 Test Loss: 2.060 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 1.041400671005249
Epoch: 2, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.669 Vali Acc: 0.565 Test Loss: 1.669 Test Acc: 0.565
Validation loss decreased (-0.305385 --> -0.564848).  Saving model ...
Epoch: 3 cost time: 1.4301843643188477
Epoch: 3, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.273 Vali Acc: 0.686 Test Loss: 1.273 Test Acc: 0.686
Validation loss decreased (-0.564848 --> -0.686474).  Saving model ...
Epoch: 4 cost time: 1.2095472812652588
Epoch: 4, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.650 Vali Acc: 0.832 Test Loss: 0.650 Test Acc: 0.832
Validation loss decreased (-0.686474 --> -0.832426).  Saving model ...
Epoch: 5 cost time: 1.0960493087768555
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.305 Vali Acc: 0.951 Test Loss: 0.305 Test Acc: 0.951
Validation loss decreased (-0.832426 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 0.9877045154571533
Epoch: 6, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.951348 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.2412137985229492
Epoch: 7, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.156 Vali Acc: 0.927 Test Loss: 0.156 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2709918022155762
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.1771290302276611
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1750338077545166
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.2197010517120361
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.376133918762207
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3565998077392578
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2826168537139893
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2693893909454346
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3903191089630127
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4664528369903564
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1208577156066895
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2197916507720947
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1626062393188477
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2149479389190674
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1639457
model size : 8.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.969616174697876
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.103 Vali Acc: 0.146 Test Loss: 2.103 Test Acc: 0.146
Validation loss decreased (inf --> -0.145925).  Saving model ...
Epoch: 2 cost time: 1.2936105728149414
Epoch: 2, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.791 Vali Acc: 0.403 Test Loss: 1.791 Test Acc: 0.403
Validation loss decreased (-0.145925 --> -0.402685).  Saving model ...
Epoch: 3 cost time: 1.2081589698791504
Epoch: 3, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.275 Vali Acc: 0.797 Test Loss: 1.275 Test Acc: 0.797
Validation loss decreased (-0.402685 --> -0.797285).  Saving model ...
Epoch: 4 cost time: 1.4500675201416016
Epoch: 4, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.692 Vali Acc: 0.905 Test Loss: 0.692 Test Acc: 0.905
Validation loss decreased (-0.797285 --> -0.905398).  Saving model ...
Epoch: 5 cost time: 1.323063611984253
Epoch: 5, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.361 Vali Acc: 0.935 Test Loss: 0.361 Test Acc: 0.935
Validation loss decreased (-0.905398 --> -0.935132).  Saving model ...
Epoch: 6 cost time: 1.1448485851287842
Epoch: 6, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2284643650054932
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.1593151092529297
Epoch: 8, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2958695888519287
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 1.2862207889556885
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.241208791732788
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1040773391723633
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3954057693481445
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 1.1449499130249023
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.140578031539917
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.959 Test Loss: 0.098 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.268219232559204
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 1.134892463684082
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.221043348312378
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2488136291503906
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0851004123687744
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1641428470611572
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3290729522705078
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.959 Test Loss: 0.097 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2010674476623535
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0634987354278564
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9747262001037598
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2854821681976318
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1639073
model size : 8.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.826441526412964
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.174 Vali Acc: 0.073 Test Loss: 2.174 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 1.2984201908111572
Epoch: 2, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.706 Vali Acc: 0.465 Test Loss: 1.706 Test Acc: 0.465
Validation loss decreased (-0.072951 --> -0.464848).  Saving model ...
Epoch: 3 cost time: 1.4803595542907715
Epoch: 3, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.162 Vali Acc: 0.857 Test Loss: 1.162 Test Acc: 0.857
Validation loss decreased (-0.464848 --> -0.856745).  Saving model ...
Epoch: 4 cost time: 1.6282269954681396
Epoch: 4, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.688 Vali Acc: 0.881 Test Loss: 0.688 Test Acc: 0.881
Validation loss decreased (-0.856745 --> -0.881074).  Saving model ...
Epoch: 5 cost time: 1.2315762042999268
Epoch: 5, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.343 Vali Acc: 0.932 Test Loss: 0.343 Test Acc: 0.932
Validation loss decreased (-0.881074 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 1.3148682117462158
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 7 cost time: 1.1820068359375
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.177 Vali Acc: 0.938 Test Loss: 0.177 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 1.3196361064910889
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 9 cost time: 1.36356520652771
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.248 Vali Acc: 0.924 Test Loss: 0.248 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3232390880584717
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.940539 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.24660325050354
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.3166983127593994
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3349533081054688
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 1.2499051094055176
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.2812399864196777
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1750767230987549
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1859815120697021
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.187133550643921
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1686818599700928
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2319626808166504
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.314600944519043
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4055132865905762
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2643015384674072
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.216141939163208
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1638689
model size : 8.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.030930519104004
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.062 Vali Acc: 0.105 Test Loss: 2.062 Test Acc: 0.105
Validation loss decreased (inf --> -0.105385).  Saving model ...
Epoch: 2 cost time: 1.1423563957214355
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.597 Vali Acc: 0.786 Test Loss: 1.597 Test Acc: 0.786
Validation loss decreased (-0.105385 --> -0.786471).  Saving model ...
Epoch: 3 cost time: 1.1590275764465332
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.156 Vali Acc: 0.830 Test Loss: 1.156 Test Acc: 0.830
Validation loss decreased (-0.786471 --> -0.829718).  Saving model ...
Epoch: 4 cost time: 1.112044334411621
Epoch: 4, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.668 Vali Acc: 0.832 Test Loss: 0.668 Test Acc: 0.832
Validation loss decreased (-0.829718 --> -0.832426).  Saving model ...
Epoch: 5 cost time: 1.3050739765167236
Epoch: 5, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.379 Vali Acc: 0.895 Test Loss: 0.379 Test Acc: 0.895
Validation loss decreased (-0.832426 --> -0.894591).  Saving model ...
Epoch: 6 cost time: 1.1908891201019287
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.260 Vali Acc: 0.908 Test Loss: 0.260 Test Acc: 0.908
Validation loss decreased (-0.894591 --> -0.908106).  Saving model ...
Epoch: 7 cost time: 1.267540693283081
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
Validation loss decreased (-0.908106 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 1.4320259094238281
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.943242 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.1305961608886719
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.266693115234375
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.08040452003479
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 1.156212329864502
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1167819499969482
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2178394794464111
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 1.3867785930633545
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3241267204284668
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2936127185821533
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3371877670288086
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.091210126876831
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.1076302528381348
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1529924869537354
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0961730480194092
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.120948314666748
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2603414058685303
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3177781105041504
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2139151096343994
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.288985252380371
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.394923210144043
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1216490268707275
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1638305
model size : 8.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8836610317230225
Epoch: 1, Steps: 17 | Train Loss: 2.268 Vali Loss: 2.035 Vali Acc: 0.432 Test Loss: 2.035 Test Acc: 0.432
Validation loss decreased (inf --> -0.432412).  Saving model ...
Epoch: 2 cost time: 1.298476219177246
Epoch: 2, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.817 Vali Acc: 0.465 Test Loss: 1.817 Test Acc: 0.465
Validation loss decreased (-0.432412 --> -0.464847).  Saving model ...
Epoch: 3 cost time: 1.1624176502227783
Epoch: 3, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.261 Vali Acc: 0.800 Test Loss: 1.261 Test Acc: 0.800
Validation loss decreased (-0.464847 --> -0.799987).  Saving model ...
Epoch: 4 cost time: 1.2022840976715088
Epoch: 4, Steps: 17 | Train Loss: 1.018 Vali Loss: 0.843 Vali Acc: 0.851 Test Loss: 0.843 Test Acc: 0.851
Validation loss decreased (-0.799987 --> -0.851343).  Saving model ...
Epoch: 5 cost time: 1.8193342685699463
Epoch: 5, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.425 Vali Acc: 0.895 Test Loss: 0.425 Test Acc: 0.895
Validation loss decreased (-0.851343 --> -0.894590).  Saving model ...
Epoch: 6 cost time: 1.3370261192321777
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.220 Vali Acc: 0.954 Test Loss: 0.220 Test Acc: 0.954
Validation loss decreased (-0.894590 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 1.191114902496338
Epoch: 7, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.214 Vali Acc: 0.927 Test Loss: 0.214 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1408934593200684
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 1.1039888858795166
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.3128957748413086
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.173168659210205
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.949 Test Loss: 0.123 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2157924175262451
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1332988739013672
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2498409748077393
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.954 Test Loss: 0.116 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1198084354400635
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2474138736724854
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2613065242767334
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1022207736968994
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2208259105682373
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1244705
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6776652336120605
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.058 Vali Acc: 0.343 Test Loss: 2.058 Test Acc: 0.343
Validation loss decreased (inf --> -0.343223).  Saving model ...
Epoch: 2 cost time: 1.1531546115875244
Epoch: 2, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.795 Vali Acc: 0.600 Test Loss: 1.795 Test Acc: 0.600
Validation loss decreased (-0.343223 --> -0.599982).  Saving model ...
Epoch: 3 cost time: 1.1765022277832031
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.192 Vali Acc: 0.786 Test Loss: 1.192 Test Acc: 0.786
Validation loss decreased (-0.599982 --> -0.786475).  Saving model ...
Epoch: 4 cost time: 1.60308837890625
Epoch: 4, Steps: 17 | Train Loss: 1.011 Vali Loss: 0.833 Vali Acc: 0.870 Test Loss: 0.833 Test Acc: 0.870
Validation loss decreased (-0.786475 --> -0.870262).  Saving model ...
Epoch: 5 cost time: 1.1105396747589111
Epoch: 5, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
Validation loss decreased (-0.870262 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 0.863297700881958
Epoch: 6, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 1.1114816665649414
Epoch: 7, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.0319087505340576
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.1471021175384521
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1873064041137695
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0624561309814453
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9823756217956543
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 1.0613749027252197
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2382228374481201
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 1.1382420063018799
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7406055927276611
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1883738040924072
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1806092262268066
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2077796459197998
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.423473596572876
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1072092056274414
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2565884590148926
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0608396530151367
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.157625675201416
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1244321
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.555245876312256
Epoch: 1, Steps: 17 | Train Loss: 2.252 Vali Loss: 2.069 Vali Acc: 0.168 Test Loss: 2.069 Test Acc: 0.168
Validation loss decreased (inf --> -0.167547).  Saving model ...
Epoch: 2 cost time: 1.2110786437988281
Epoch: 2, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.778 Vali Acc: 0.508 Test Loss: 1.778 Test Acc: 0.508
Validation loss decreased (-0.167547 --> -0.508090).  Saving model ...
Epoch: 3 cost time: 1.0533044338226318
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.253 Vali Acc: 0.816 Test Loss: 1.253 Test Acc: 0.816
Validation loss decreased (-0.508090 --> -0.816204).  Saving model ...
Epoch: 4 cost time: 1.0875585079193115
Epoch: 4, Steps: 17 | Train Loss: 1.047 Vali Loss: 0.820 Vali Acc: 0.816 Test Loss: 0.820 Test Acc: 0.816
Validation loss decreased (-0.816204 --> -0.816208).  Saving model ...
Epoch: 5 cost time: 1.3989660739898682
Epoch: 5, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.465 Vali Acc: 0.908 Test Loss: 0.465 Test Acc: 0.908
Validation loss decreased (-0.816208 --> -0.908103).  Saving model ...
Epoch: 6 cost time: 1.3499042987823486
Epoch: 6, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
Validation loss decreased (-0.908103 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.1190485954284668
Epoch: 7, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 1.066802978515625
Epoch: 8, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.072509527206421
Epoch: 9, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 1.2437551021575928
Epoch: 10, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.185089349746704
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 1.1953437328338623
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3236045837402344
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 1.2878594398498535
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3851337432861328
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2701835632324219
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.1696548461914062
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1727731227874756
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1874041557312012
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3220000267028809
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2986063957214355
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3247621059417725
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0600614547729492
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.156087875366211
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3464455604553223
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2173306941986084
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1243937
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0308187007904053
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 2.055 Vali Acc: 0.238 Test Loss: 2.055 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 1.1483979225158691
Epoch: 2, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.729 Vali Acc: 0.370 Test Loss: 1.729 Test Acc: 0.370
Validation loss decreased (-0.237817 --> -0.370253).  Saving model ...
Epoch: 3 cost time: 1.2210290431976318
Epoch: 3, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.248 Vali Acc: 0.843 Test Loss: 1.248 Test Acc: 0.843
Validation loss decreased (-0.370253 --> -0.843231).  Saving model ...
Epoch: 4 cost time: 1.2903525829315186
Epoch: 4, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.819 Vali Acc: 0.857 Test Loss: 0.819 Test Acc: 0.857
Validation loss decreased (-0.843231 --> -0.856749).  Saving model ...
Epoch: 5 cost time: 0.9573919773101807
Epoch: 5, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.856749 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 1.0924491882324219
Epoch: 6, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.246 Vali Acc: 0.949 Test Loss: 0.246 Test Acc: 0.949
Validation loss decreased (-0.899995 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 1.2896249294281006
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.948646 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.3353805541992188
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.103327989578247
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9534308910369873
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.173299789428711
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0735023021697998
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.930 Test Loss: 0.132 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.127269983291626
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2256815433502197
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.622046709060669
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.190767765045166
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3878545761108398
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1811621189117432
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2601945400238037
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.954 Test Loss: 0.118 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4471323490142822
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1243553
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.244591474533081
Epoch: 1, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.053 Vali Acc: 0.305 Test Loss: 2.053 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 1.0722789764404297
Epoch: 2, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.605 Vali Acc: 0.703 Test Loss: 1.605 Test Acc: 0.703
Validation loss decreased (-0.305385 --> -0.702687).  Saving model ...
Epoch: 3 cost time: 1.1838924884796143
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.173 Vali Acc: 0.876 Test Loss: 1.173 Test Acc: 0.876
Validation loss decreased (-0.702687 --> -0.875664).  Saving model ...
Epoch: 4 cost time: 1.1604349613189697
Epoch: 4, Steps: 17 | Train Loss: 0.919 Vali Loss: 0.806 Vali Acc: 0.886 Test Loss: 0.806 Test Acc: 0.886
Validation loss decreased (-0.875664 --> -0.886478).  Saving model ...
Epoch: 5 cost time: 1.395803451538086
Epoch: 5, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.365 Vali Acc: 0.951 Test Loss: 0.365 Test Acc: 0.951
Validation loss decreased (-0.886478 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 1.2791669368743896
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.048983097076416
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.951348 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.121622085571289
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.1727676391601562
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2895362377166748
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3876745700836182
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5142016410827637
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 13 cost time: 1.40549898147583
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1720268726348877
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.16202974319458
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6319787502288818
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2713232040405273
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2090485095977783
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.130734920501709
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.023571491241455
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.349975824356079
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1555356979370117
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1047329
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0306406021118164
Epoch: 1, Steps: 17 | Train Loss: 2.229 Vali Loss: 2.095 Vali Acc: 0.249 Test Loss: 2.095 Test Acc: 0.249
Validation loss decreased (inf --> -0.248628).  Saving model ...
Epoch: 2 cost time: 1.418269157409668
Epoch: 2, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.790 Vali Acc: 0.495 Test Loss: 1.790 Test Acc: 0.495
Validation loss decreased (-0.248628 --> -0.494577).  Saving model ...
Epoch: 3 cost time: 1.0937089920043945
Epoch: 3, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.327 Vali Acc: 0.827 Test Loss: 1.327 Test Acc: 0.827
Validation loss decreased (-0.494577 --> -0.827014).  Saving model ...
Epoch: 4 cost time: 1.136110782623291
Epoch: 4, Steps: 17 | Train Loss: 1.063 Vali Loss: 0.830 Vali Acc: 0.895 Test Loss: 0.830 Test Acc: 0.895
Validation loss decreased (-0.827014 --> -0.894586).  Saving model ...
Epoch: 5 cost time: 1.2566285133361816
Epoch: 5, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2627310752868652
Epoch: 6, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.287 Vali Acc: 0.916 Test Loss: 0.287 Test Acc: 0.916
Validation loss decreased (-0.894586 --> -0.916213).  Saving model ...
Epoch: 7 cost time: 1.1149177551269531
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.916213 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 1.2446768283843994
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2632882595062256
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.1199681758880615
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.2591338157653809
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.211 Vali Acc: 0.927 Test Loss: 0.211 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.309887170791626
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2319025993347168
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.0281169414520264
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2190616130828857
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.297917366027832
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4063782691955566
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4709970951080322
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1109910011291504
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0556178092956543
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2378911972045898
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1760921478271484
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1411573886871338
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1046945
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9080028533935547
Epoch: 1, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.098 Vali Acc: 0.159 Test Loss: 2.098 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 1.2642745971679688
Epoch: 2, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.755 Vali Acc: 0.441 Test Loss: 1.755 Test Acc: 0.441
Validation loss decreased (-0.159438 --> -0.440523).  Saving model ...
Epoch: 3 cost time: 1.2345056533813477
Epoch: 3, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.330 Vali Acc: 0.811 Test Loss: 1.330 Test Acc: 0.811
Validation loss decreased (-0.440523 --> -0.810798).  Saving model ...
Epoch: 4 cost time: 1.1821999549865723
Epoch: 4, Steps: 17 | Train Loss: 1.136 Vali Loss: 0.816 Vali Acc: 0.927 Test Loss: 0.816 Test Acc: 0.927
Validation loss decreased (-0.810798 --> -0.927019).  Saving model ...
Epoch: 5 cost time: 1.2552382946014404
Epoch: 5, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.497 Vali Acc: 0.905 Test Loss: 0.497 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1958098411560059
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.327 Vali Acc: 0.908 Test Loss: 0.327 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3393075466156006
Epoch: 7, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.927019 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 1.372065544128418
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.18495774269104
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1123957633972168
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.948647 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.3379418849945068
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.2062029838562012
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2918565273284912
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1372480392456055
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1260173320770264
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1740901470184326
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2481346130371094
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0957708358764648
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2008943557739258
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1751329898834229
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.221503496170044
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1046561
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.700740098953247
Epoch: 1, Steps: 17 | Train Loss: 2.257 Vali Loss: 2.020 Vali Acc: 0.243 Test Loss: 2.020 Test Acc: 0.243
Validation loss decreased (inf --> -0.243223).  Saving model ...
Epoch: 2 cost time: 1.2141525745391846
Epoch: 2, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.845 Vali Acc: 0.470 Test Loss: 1.845 Test Acc: 0.470
Validation loss decreased (-0.243223 --> -0.470252).  Saving model ...
Epoch: 3 cost time: 1.147648811340332
Epoch: 3, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.402 Vali Acc: 0.746 Test Loss: 1.402 Test Acc: 0.746
Validation loss decreased (-0.470252 --> -0.745932).  Saving model ...
Epoch: 4 cost time: 1.1007483005523682
Epoch: 4, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.988 Vali Acc: 0.805 Test Loss: 0.988 Test Acc: 0.805
Validation loss decreased (-0.745932 --> -0.805396).  Saving model ...
Epoch: 5 cost time: 1.0654563903808594
Epoch: 5, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.557 Vali Acc: 0.859 Test Loss: 0.557 Test Acc: 0.859
Validation loss decreased (-0.805396 --> -0.859454).  Saving model ...
Epoch: 6 cost time: 1.158496379852295
Epoch: 6, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.299 Vali Acc: 0.935 Test Loss: 0.299 Test Acc: 0.935
Validation loss decreased (-0.859454 --> -0.935132).  Saving model ...
Epoch: 7 cost time: 1.079925775527954
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 1.2025482654571533
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 1.027864694595337
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0336971282958984
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 0.9818210601806641
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0506863594055176
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 0.9826653003692627
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 1.2378697395324707
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1052322387695312
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.196359634399414
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.938 Test Loss: 0.163 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1262407302856445
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9809353351593018
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0262227058410645
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9905538558959961
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1318457126617432
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2500543594360352
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 23 cost time: 1.212740182876587
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.315155267715454
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4114320278167725
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1705543994903564
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.085796594619751
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0012049674987793
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0988960266113281
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3639447689056396
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3228447437286377
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.129058837890625
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1046177
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.67433500289917
Epoch: 1, Steps: 17 | Train Loss: 2.235 Vali Loss: 2.134 Vali Acc: 0.224 Test Loss: 2.134 Test Acc: 0.224
Validation loss decreased (inf --> -0.224303).  Saving model ...
Epoch: 2 cost time: 1.3025474548339844
Epoch: 2, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.768 Vali Acc: 0.557 Test Loss: 1.768 Test Acc: 0.557
Validation loss decreased (-0.224303 --> -0.556739).  Saving model ...
Epoch: 3 cost time: 1.1262133121490479
Epoch: 3, Steps: 17 | Train Loss: 1.645 Vali Loss: 1.393 Vali Acc: 0.711 Test Loss: 1.393 Test Acc: 0.711
Validation loss decreased (-0.556739 --> -0.710797).  Saving model ...
Epoch: 4 cost time: 1.1688787937164307
Epoch: 4, Steps: 17 | Train Loss: 1.181 Vali Loss: 0.921 Vali Acc: 0.876 Test Loss: 0.921 Test Acc: 0.876
Validation loss decreased (-0.710797 --> -0.875666).  Saving model ...
Epoch: 5 cost time: 1.308866024017334
Epoch: 5, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.627 Vali Acc: 0.849 Test Loss: 0.627 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0060951709747314
Epoch: 6, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.875666 --> -0.929727).  Saving model ...
Epoch: 7 cost time: 0.9972395896911621
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 1.102616310119629
Epoch: 8, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1871604919433594
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 10 cost time: 1.1405322551727295
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.940539 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 1.141289234161377
Epoch: 11, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1914501190185547
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2223596572875977
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.178727388381958
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2560954093933105
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1049087047576904
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1698906421661377
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2531979084014893
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.160489559173584
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4963674545288086
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 948641
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.877487897872925
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.015 Vali Acc: 0.362 Test Loss: 2.015 Test Acc: 0.362
Validation loss decreased (inf --> -0.362142).  Saving model ...
Epoch: 2 cost time: 1.037069320678711
Epoch: 2, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.872 Vali Acc: 0.319 Test Loss: 1.872 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3444297313690186
Epoch: 3, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.374 Vali Acc: 0.681 Test Loss: 1.374 Test Acc: 0.681
Validation loss decreased (-0.362142 --> -0.681067).  Saving model ...
Epoch: 4 cost time: 1.2310690879821777
Epoch: 4, Steps: 17 | Train Loss: 1.118 Vali Loss: 0.883 Vali Acc: 0.846 Test Loss: 0.883 Test Acc: 0.846
Validation loss decreased (-0.681067 --> -0.845937).  Saving model ...
Epoch: 5 cost time: 1.1132729053497314
Epoch: 5, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.443 Vali Acc: 0.941 Test Loss: 0.443 Test Acc: 0.941
Validation loss decreased (-0.845937 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 1.2268996238708496
Epoch: 6, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.281975269317627
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.940536 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.3182857036590576
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 1.1004996299743652
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.258 Vali Acc: 0.914 Test Loss: 0.258 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.087897777557373
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0032958984375
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1126768589019775
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.0226037502288818
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1884346008300781
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0893604755401611
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4955732822418213
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2730512619018555
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2291808128356934
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2075786590576172
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1915853023529053
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2637619972229004
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0987622737884521
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 948257
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9418509006500244
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.019 Vali Acc: 0.368 Test Loss: 2.019 Test Acc: 0.368
Validation loss decreased (inf --> -0.367547).  Saving model ...
Epoch: 2 cost time: 1.13063383102417
Epoch: 2, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.757 Vali Acc: 0.570 Test Loss: 1.757 Test Acc: 0.570
Validation loss decreased (-0.367547 --> -0.570253).  Saving model ...
Epoch: 3 cost time: 1.2175819873809814
Epoch: 3, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.259 Vali Acc: 0.741 Test Loss: 1.259 Test Acc: 0.741
Validation loss decreased (-0.570253 --> -0.740528).  Saving model ...
Epoch: 4 cost time: 1.2708098888397217
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.912 Vali Acc: 0.816 Test Loss: 0.912 Test Acc: 0.816
Validation loss decreased (-0.740528 --> -0.816207).  Saving model ...
Epoch: 5 cost time: 1.077951431274414
Epoch: 5, Steps: 17 | Train Loss: 0.690 Vali Loss: 0.655 Vali Acc: 0.868 Test Loss: 0.655 Test Acc: 0.868
Validation loss decreased (-0.816207 --> -0.867561).  Saving model ...
Epoch: 6 cost time: 1.2784690856933594
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.305 Vali Acc: 0.908 Test Loss: 0.305 Test Acc: 0.908
Validation loss decreased (-0.867561 --> -0.908105).  Saving model ...
Epoch: 7 cost time: 1.1627824306488037
Epoch: 7, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
Validation loss decreased (-0.908105 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 1.5286729335784912
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 1.3077030181884766
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
Validation loss decreased (-0.935133 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.3809947967529297
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.1635403633117676
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.194 Vali Acc: 0.932 Test Loss: 0.194 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1971075534820557
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 1.1323091983795166
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2738230228424072
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3237757682800293
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 1.066687822341919
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.148108959197998
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0512604713439941
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0698134899139404
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0964486598968506
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9959468841552734
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0176317691802979
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1151325702667236
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1994531154632568
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2435169219970703
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2506797313690186
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 947873
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.033189535140991
Epoch: 1, Steps: 17 | Train Loss: 2.303 Vali Loss: 2.065 Vali Acc: 0.186 Test Loss: 2.065 Test Acc: 0.186
Validation loss decreased (inf --> -0.186466).  Saving model ...
Epoch: 2 cost time: 1.0612249374389648
Epoch: 2, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.913 Vali Acc: 0.368 Test Loss: 1.913 Test Acc: 0.368
Validation loss decreased (-0.186466 --> -0.367548).  Saving model ...
Epoch: 3 cost time: 1.1473798751831055
Epoch: 3, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.432 Vali Acc: 0.641 Test Loss: 1.432 Test Acc: 0.641
Validation loss decreased (-0.367548 --> -0.640526).  Saving model ...
Epoch: 4 cost time: 1.1441731452941895
Epoch: 4, Steps: 17 | Train Loss: 1.159 Vali Loss: 0.986 Vali Acc: 0.719 Test Loss: 0.986 Test Acc: 0.719
Validation loss decreased (-0.640526 --> -0.718909).  Saving model ...
Epoch: 5 cost time: 1.124030590057373
Epoch: 5, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.584 Vali Acc: 0.905 Test Loss: 0.584 Test Acc: 0.905
Validation loss decreased (-0.718909 --> -0.905400).  Saving model ...
Epoch: 6 cost time: 1.272320032119751
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.415 Vali Acc: 0.908 Test Loss: 0.415 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908104).  Saving model ...
Epoch: 7 cost time: 1.1894714832305908
Epoch: 7, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910808).  Saving model ...
Epoch: 8 cost time: 1.0901751518249512
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.910808 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.0513856410980225
Epoch: 9, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.124786376953125
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.261225938796997
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 12 cost time: 1.0171236991882324
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0924577713012695
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.956756 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.2268412113189697
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.998185396194458
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.126215934753418
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.172630786895752
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1828951835632324
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.061838150024414
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0886924266815186
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1970641613006592
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0191409587860107
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1765689849853516
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 947489
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5396363735198975
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.123 Vali Acc: 0.192 Test Loss: 2.123 Test Acc: 0.192
Validation loss decreased (inf --> -0.191871).  Saving model ...
Epoch: 2 cost time: 1.0782673358917236
Epoch: 2, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.904 Vali Acc: 0.565 Test Loss: 1.904 Test Acc: 0.565
Validation loss decreased (-0.191871 --> -0.564846).  Saving model ...
Epoch: 3 cost time: 1.1249542236328125
Epoch: 3, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.539 Vali Acc: 0.824 Test Loss: 1.539 Test Acc: 0.824
Validation loss decreased (-0.564846 --> -0.824309).  Saving model ...
Epoch: 4 cost time: 0.9666831493377686
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.271 Vali Acc: 0.762 Test Loss: 1.271 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1011011600494385
Epoch: 5, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.765 Vali Acc: 0.884 Test Loss: 0.765 Test Acc: 0.884
Validation loss decreased (-0.824309 --> -0.883776).  Saving model ...
Epoch: 6 cost time: 1.1976194381713867
Epoch: 6, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.467 Vali Acc: 0.914 Test Loss: 0.467 Test Acc: 0.914
Validation loss decreased (-0.883776 --> -0.913509).  Saving model ...
Epoch: 7 cost time: 1.166430950164795
Epoch: 7, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.281 Vali Acc: 0.946 Test Loss: 0.281 Test Acc: 0.946
Validation loss decreased (-0.913509 --> -0.945943).  Saving model ...
Epoch: 8 cost time: 1.0837829113006592
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 9 cost time: 1.1899454593658447
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1821599006652832
Epoch: 10, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0707683563232422
Epoch: 11, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 1.094698190689087
Epoch: 12, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.297471523284912
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.298398733139038
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.090404748916626
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 1.1412410736083984
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.109377145767212
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.0825104713439941
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1067049503326416
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2842779159545898
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1332128047943115
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1682922840118408
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 23 cost time: 1.053666591644287
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2610914707183838
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2274560928344727
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0983171463012695
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.130248785018921
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1801917552947998
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2023942470550537
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.957 Test Loss: 0.107 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1940059661865234
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.210522174835205
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2170302867889404
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 624673
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.740054130554199
Epoch: 1, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.153 Vali Acc: 0.189 Test Loss: 2.153 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 1.0672492980957031
Epoch: 2, Steps: 17 | Train Loss: 2.062 Vali Loss: 1.914 Vali Acc: 0.570 Test Loss: 1.914 Test Acc: 0.570
Validation loss decreased (-0.189168 --> -0.570251).  Saving model ...
Epoch: 3 cost time: 1.1159617900848389
Epoch: 3, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.672 Vali Acc: 0.605 Test Loss: 1.672 Test Acc: 0.605
Validation loss decreased (-0.570251 --> -0.605389).  Saving model ...
Epoch: 4 cost time: 1.120060920715332
Epoch: 4, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.254 Vali Acc: 0.792 Test Loss: 1.254 Test Acc: 0.792
Validation loss decreased (-0.605389 --> -0.791879).  Saving model ...
Epoch: 5 cost time: 1.259308099746704
Epoch: 5, Steps: 17 | Train Loss: 1.038 Vali Loss: 0.818 Vali Acc: 0.924 Test Loss: 0.818 Test Acc: 0.924
Validation loss decreased (-0.791879 --> -0.924316).  Saving model ...
Epoch: 6 cost time: 1.1347830295562744
Epoch: 6, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.499 Vali Acc: 0.924 Test Loss: 0.499 Test Acc: 0.924
Validation loss decreased (-0.924316 --> -0.924319).  Saving model ...
Epoch: 7 cost time: 1.2142934799194336
Epoch: 7, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.306 Vali Acc: 0.938 Test Loss: 0.306 Test Acc: 0.938
Validation loss decreased (-0.924319 --> -0.937835).  Saving model ...
Epoch: 8 cost time: 1.4911093711853027
Epoch: 8, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3425278663635254
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.150120496749878
Epoch: 10, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.0737643241882324
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.0783441066741943
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1059143543243408
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0394701957702637
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.038323163986206
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 0.9523239135742188
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.125084638595581
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1578550338745117
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9960291385650635
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0581536293029785
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.020228624343872
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.46736741065979
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9695672988891602
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1704273223876953
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1353986263275146
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.209348440170288
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 624481
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7498867511749268
Epoch: 1, Steps: 17 | Train Loss: 2.328 Vali Loss: 2.165 Vali Acc: 0.159 Test Loss: 2.165 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 1.2048323154449463
Epoch: 2, Steps: 17 | Train Loss: 2.141 Vali Loss: 1.945 Vali Acc: 0.562 Test Loss: 1.945 Test Acc: 0.562
Validation loss decreased (-0.159438 --> -0.562143).  Saving model ...
Epoch: 3 cost time: 1.237339735031128
Epoch: 3, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.690 Vali Acc: 0.670 Test Loss: 1.690 Test Acc: 0.670
Validation loss decreased (-0.562143 --> -0.670253).  Saving model ...
Epoch: 4 cost time: 1.0425782203674316
Epoch: 4, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.368 Vali Acc: 0.705 Test Loss: 1.368 Test Acc: 0.705
Validation loss decreased (-0.670253 --> -0.705392).  Saving model ...
Epoch: 5 cost time: 1.0730085372924805
Epoch: 5, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.848 Vali Acc: 0.876 Test Loss: 0.848 Test Acc: 0.876
Validation loss decreased (-0.705392 --> -0.875667).  Saving model ...
Epoch: 6 cost time: 1.1961185932159424
Epoch: 6, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
Validation loss decreased (-0.875667 --> -0.889183).  Saving model ...
Epoch: 7 cost time: 1.0666306018829346
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.316 Vali Acc: 0.932 Test Loss: 0.316 Test Acc: 0.932
Validation loss decreased (-0.889183 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 1.133105754852295
Epoch: 8, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 0.9965875148773193
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1394367218017578
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.943241 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.0249502658843994
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1361043453216553
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.062946081161499
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1028554439544678
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 1.0079126358032227
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.129166841506958
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.938 Test Loss: 0.139 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.178835153579712
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1756484508514404
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9670155048370361
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3770153522491455
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 21 cost time: 1.1593754291534424
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2102627754211426
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1728489398956299
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.089693307876587
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.196467399597168
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.959 Test Loss: 0.096 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9001255035400391
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0269289016723633
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.949 Test Loss: 0.108 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2496516704559326
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1423778533935547
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0933845043182373
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 624289
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5922670364379883
Epoch: 1, Steps: 17 | Train Loss: 2.225 Vali Loss: 2.066 Vali Acc: 0.319 Test Loss: 2.066 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 1.120697021484375
Epoch: 2, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.862 Vali Acc: 0.592 Test Loss: 1.862 Test Acc: 0.592
Validation loss decreased (-0.318898 --> -0.591873).  Saving model ...
Epoch: 3 cost time: 1.0289356708526611
Epoch: 3, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.580 Vali Acc: 0.730 Test Loss: 1.580 Test Acc: 0.730
Validation loss decreased (-0.591873 --> -0.729714).  Saving model ...
Epoch: 4 cost time: 1.1902012825012207
Epoch: 4, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.143 Vali Acc: 0.841 Test Loss: 1.143 Test Acc: 0.841
Validation loss decreased (-0.729714 --> -0.840529).  Saving model ...
Epoch: 5 cost time: 1.0048918724060059
Epoch: 5, Steps: 17 | Train Loss: 0.953 Vali Loss: 0.728 Vali Acc: 0.924 Test Loss: 0.728 Test Acc: 0.924
Validation loss decreased (-0.840529 --> -0.924317).  Saving model ...
Epoch: 6 cost time: 0.9782040119171143
Epoch: 6, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.449 Vali Acc: 0.930 Test Loss: 0.449 Test Acc: 0.930
Validation loss decreased (-0.924317 --> -0.929725).  Saving model ...
Epoch: 7 cost time: 0.9499852657318115
Epoch: 7, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.929725 --> -0.940538).  Saving model ...
Epoch: 8 cost time: 0.9988079071044922
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 1.1589288711547852
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.243173599243164
Epoch: 10, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1274440288543701
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3736214637756348
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.948647 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 1.0099482536315918
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.062195062637329
Epoch: 14, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1080718040466309
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0667383670806885
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.949 Test Loss: 0.116 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1893577575683594
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2870395183563232
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1881053447723389
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.943 Test Loss: 0.132 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1404643058776855
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.959 Test Loss: 0.100 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1115622520446777
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.224484920501709
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 624097
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2869057655334473
Epoch: 1, Steps: 17 | Train Loss: 2.264 Vali Loss: 2.105 Vali Acc: 0.308 Test Loss: 2.105 Test Acc: 0.308
Validation loss decreased (inf --> -0.308087).  Saving model ...
Epoch: 2 cost time: 1.3754034042358398
Epoch: 2, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.933 Vali Acc: 0.538 Test Loss: 1.933 Test Acc: 0.538
Validation loss decreased (-0.308087 --> -0.537819).  Saving model ...
Epoch: 3 cost time: 1.2126667499542236
Epoch: 3, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.611 Vali Acc: 0.843 Test Loss: 1.611 Test Acc: 0.843
Validation loss decreased (-0.537819 --> -0.843227).  Saving model ...
Epoch: 4 cost time: 1.1753549575805664
Epoch: 4, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.270 Vali Acc: 0.868 Test Loss: 1.270 Test Acc: 0.868
Validation loss decreased (-0.843227 --> -0.867555).  Saving model ...
Epoch: 5 cost time: 1.1301562786102295
Epoch: 5, Steps: 17 | Train Loss: 1.107 Vali Loss: 0.931 Vali Acc: 0.827 Test Loss: 0.931 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.284611463546753
Epoch: 6, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.566 Vali Acc: 0.903 Test Loss: 0.566 Test Acc: 0.903
Validation loss decreased (-0.867555 --> -0.902697).  Saving model ...
Epoch: 7 cost time: 1.1175549030303955
Epoch: 7, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.333 Vali Acc: 0.938 Test Loss: 0.333 Test Acc: 0.938
Validation loss decreased (-0.902697 --> -0.937835).  Saving model ...
Epoch: 8 cost time: 1.1782217025756836
Epoch: 8, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1978750228881836
Epoch: 9, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 1.108652114868164
Epoch: 10, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1089303493499756
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.1471397876739502
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 1.0791370868682861
Epoch: 13, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.329054594039917
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 0.9768376350402832
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0270018577575684
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1211438179016113
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.176213026046753
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9867451190948486
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.1372356414794922
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0912342071533203
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.4255166053771973
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2091517448425293
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.239048957824707
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3062760829925537
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1105237007141113
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 1.2384357452392578
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3301186561584473
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.000265121459961
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.171421766281128
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1222574710845947
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0548896789550781
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2271199226379395
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.097569227218628
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2059619426727295
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1619129180908203
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3976809978485107
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2529778480529785
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.202190637588501
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 426529
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8377857208251953
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.090 Vali Acc: 0.189 Test Loss: 2.090 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 1.3578550815582275
Epoch: 2, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.935 Vali Acc: 0.508 Test Loss: 1.935 Test Acc: 0.508
Validation loss decreased (-0.189168 --> -0.508089).  Saving model ...
Epoch: 3 cost time: 1.0142769813537598
Epoch: 3, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.659 Vali Acc: 0.565 Test Loss: 1.659 Test Acc: 0.565
Validation loss decreased (-0.508089 --> -0.564848).  Saving model ...
Epoch: 4 cost time: 1.1125423908233643
Epoch: 4, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.284 Vali Acc: 0.857 Test Loss: 1.284 Test Acc: 0.857
Validation loss decreased (-0.564848 --> -0.856744).  Saving model ...
Epoch: 5 cost time: 1.2548961639404297
Epoch: 5, Steps: 17 | Train Loss: 1.085 Vali Loss: 0.871 Vali Acc: 0.914 Test Loss: 0.871 Test Acc: 0.914
Validation loss decreased (-0.856744 --> -0.913505).  Saving model ...
Epoch: 6 cost time: 1.1311733722686768
Epoch: 6, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.578 Vali Acc: 0.914 Test Loss: 0.578 Test Acc: 0.914
Validation loss decreased (-0.913505 --> -0.913508).  Saving model ...
Epoch: 7 cost time: 1.2011456489562988
Epoch: 7, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.329 Vali Acc: 0.943 Test Loss: 0.329 Test Acc: 0.943
Validation loss decreased (-0.913508 --> -0.943240).  Saving model ...
Epoch: 8 cost time: 1.2922728061676025
Epoch: 8, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1693916320800781
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 1.2942774295806885
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.2772414684295654
Epoch: 11, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.239159345626831
Epoch: 12, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.2230477333068848
Epoch: 13, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0370960235595703
Epoch: 14, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1238923072814941
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2929646968841553
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1040840148925781
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4827415943145752
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.222938060760498
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1051506996154785
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.119882345199585
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2989139556884766
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 426337
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.702019214630127
Epoch: 1, Steps: 17 | Train Loss: 2.306 Vali Loss: 2.141 Vali Acc: 0.192 Test Loss: 2.141 Test Acc: 0.192
Validation loss decreased (inf --> -0.191870).  Saving model ...
Epoch: 2 cost time: 1.227048635482788
Epoch: 2, Steps: 17 | Train Loss: 2.159 Vali Loss: 1.984 Vali Acc: 0.503 Test Loss: 1.984 Test Acc: 0.503
Validation loss decreased (-0.191870 --> -0.502683).  Saving model ...
Epoch: 3 cost time: 1.1761362552642822
Epoch: 3, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.763 Vali Acc: 0.614 Test Loss: 1.763 Test Acc: 0.614
Validation loss decreased (-0.502683 --> -0.613496).  Saving model ...
Epoch: 4 cost time: 1.2060894966125488
Epoch: 4, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.336 Vali Acc: 0.832 Test Loss: 1.336 Test Acc: 0.832
Validation loss decreased (-0.613496 --> -0.832419).  Saving model ...
Epoch: 5 cost time: 1.1446292400360107
Epoch: 5, Steps: 17 | Train Loss: 1.169 Vali Loss: 0.981 Vali Acc: 0.892 Test Loss: 0.981 Test Acc: 0.892
Validation loss decreased (-0.832419 --> -0.891882).  Saving model ...
Epoch: 6 cost time: 1.0345945358276367
Epoch: 6, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.613 Vali Acc: 0.911 Test Loss: 0.613 Test Acc: 0.911
Validation loss decreased (-0.891882 --> -0.910805).  Saving model ...
Epoch: 7 cost time: 1.1254658699035645
Epoch: 7, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.414 Vali Acc: 0.927 Test Loss: 0.414 Test Acc: 0.927
Validation loss decreased (-0.910805 --> -0.927023).  Saving model ...
Epoch: 8 cost time: 1.0354337692260742
Epoch: 8, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 1.1232471466064453
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.937835 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.0580766201019287
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.21140456199646
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0247089862823486
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0239849090576172
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2387471199035645
Epoch: 14, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.3440186977386475
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.511176347732544
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3376715183258057
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.216839075088501
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.120459794998169
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3512587547302246
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.1664090156555176
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4652047157287598
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5687503814697266
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.2534229755401611
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.369943618774414
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3477001190185547
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0793912410736084
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2162935733795166
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1698191165924072
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0456318855285645
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.249180793762207
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0937747955322266
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1555449962615967
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0291974544525146
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2304818630218506
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1811683177947998
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.081566572189331
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1744871139526367
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1240246295928955
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.342928409576416
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.18648362159729
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.566087007522583
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9896483421325684
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.232433557510376
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.352177381515503
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5120537281036377
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1638574600219727
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.328861951828003
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.219273328781128
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 426145
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.144578218460083
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 2.098 Vali Acc: 0.330 Test Loss: 2.098 Test Acc: 0.330
Validation loss decreased (inf --> -0.329709).  Saving model ...
Epoch: 2 cost time: 1.0850491523742676
Epoch: 2, Steps: 17 | Train Loss: 2.071 Vali Loss: 1.935 Vali Acc: 0.516 Test Loss: 1.935 Test Acc: 0.516
Validation loss decreased (-0.329709 --> -0.516197).  Saving model ...
Epoch: 3 cost time: 1.3309648036956787
Epoch: 3, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.662 Vali Acc: 0.686 Test Loss: 1.662 Test Acc: 0.686
Validation loss decreased (-0.516197 --> -0.686470).  Saving model ...
Epoch: 4 cost time: 1.20448637008667
Epoch: 4, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.297 Vali Acc: 0.835 Test Loss: 1.297 Test Acc: 0.835
Validation loss decreased (-0.686470 --> -0.835122).  Saving model ...
Epoch: 5 cost time: 1.3556768894195557
Epoch: 5, Steps: 17 | Train Loss: 1.056 Vali Loss: 0.859 Vali Acc: 0.903 Test Loss: 0.859 Test Acc: 0.903
Validation loss decreased (-0.835122 --> -0.902694).  Saving model ...
Epoch: 6 cost time: 1.2415516376495361
Epoch: 6, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.561 Vali Acc: 0.911 Test Loss: 0.561 Test Acc: 0.911
Validation loss decreased (-0.902694 --> -0.910805).  Saving model ...
Epoch: 7 cost time: 1.0388686656951904
Epoch: 7, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.342 Vali Acc: 0.932 Test Loss: 0.342 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932429).  Saving model ...
Epoch: 8 cost time: 1.2533953189849854
Epoch: 8, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 1.0229780673980713
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
Validation loss decreased (-0.937835 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.0847947597503662
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2034764289855957
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.188816785812378
Epoch: 12, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.2036845684051514
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9621193408966064
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 1.0954339504241943
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0540213584899902
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 1.140962839126587
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.095188856124878
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1464595794677734
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4887137413024902
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1596131324768066
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.093191146850586
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3315107822418213
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2626614570617676
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5078375339508057
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.479217767715454
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.071284532546997
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2496294975280762
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2518889904022217
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.329021692276001
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0895593166351318
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 425953
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7559902667999268
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.063 Vali Acc: 0.311 Test Loss: 2.063 Test Acc: 0.311
Validation loss decreased (inf --> -0.310790).  Saving model ...
Epoch: 2 cost time: 1.2588109970092773
Epoch: 2, Steps: 17 | Train Loss: 2.037 Vali Loss: 1.904 Vali Acc: 0.611 Test Loss: 1.904 Test Acc: 0.611
Validation loss decreased (-0.310790 --> -0.610792).  Saving model ...
Epoch: 3 cost time: 1.0609140396118164
Epoch: 3, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.654 Vali Acc: 0.741 Test Loss: 1.654 Test Acc: 0.741
Validation loss decreased (-0.610792 --> -0.740524).  Saving model ...
Epoch: 4 cost time: 1.0888080596923828
Epoch: 4, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.337 Vali Acc: 0.795 Test Loss: 1.337 Test Acc: 0.795
Validation loss decreased (-0.740524 --> -0.794581).  Saving model ...
Epoch: 5 cost time: 1.2179205417633057
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 0.970 Vali Acc: 0.889 Test Loss: 0.970 Test Acc: 0.889
Validation loss decreased (-0.794581 --> -0.889179).  Saving model ...
Epoch: 6 cost time: 0.9201092720031738
Epoch: 6, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.695 Vali Acc: 0.905 Test Loss: 0.695 Test Acc: 0.905
Validation loss decreased (-0.889179 --> -0.905398).  Saving model ...
Epoch: 7 cost time: 1.1557810306549072
Epoch: 7, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.424 Vali Acc: 0.949 Test Loss: 0.424 Test Acc: 0.949
Validation loss decreased (-0.905398 --> -0.948644).  Saving model ...
Epoch: 8 cost time: 1.2545323371887207
Epoch: 8, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.140453577041626
Epoch: 9, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.948644 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 1.3136835098266602
Epoch: 10, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0888152122497559
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.1080760955810547
Epoch: 12, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 1.170750617980957
Epoch: 13, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 1.0670099258422852
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.1097581386566162
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2154717445373535
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.122838020324707
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2007715702056885
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1585822105407715
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.118321418762207
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.36055326461792
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.33591628074646
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0323102474212646
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.045809268951416
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 327457
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.955845355987549
Epoch: 1, Steps: 17 | Train Loss: 2.240 Vali Loss: 2.162 Vali Acc: 0.192 Test Loss: 2.162 Test Acc: 0.192
Validation loss decreased (inf --> -0.191870).  Saving model ...
Epoch: 2 cost time: 1.1335768699645996
Epoch: 2, Steps: 17 | Train Loss: 2.070 Vali Loss: 1.957 Vali Acc: 0.446 Test Loss: 1.957 Test Acc: 0.446
Validation loss decreased (-0.191870 --> -0.445926).  Saving model ...
Epoch: 3 cost time: 1.2529540061950684
Epoch: 3, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.742 Vali Acc: 0.611 Test Loss: 1.742 Test Acc: 0.611
Validation loss decreased (-0.445926 --> -0.610793).  Saving model ...
Epoch: 4 cost time: 1.100067138671875
Epoch: 4, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.419 Vali Acc: 0.800 Test Loss: 1.419 Test Acc: 0.800
Validation loss decreased (-0.610793 --> -0.799986).  Saving model ...
Epoch: 5 cost time: 1.198876142501831
Epoch: 5, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.059 Vali Acc: 0.886 Test Loss: 1.059 Test Acc: 0.886
Validation loss decreased (-0.799986 --> -0.886476).  Saving model ...
Epoch: 6 cost time: 0.9156036376953125
Epoch: 6, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.701 Vali Acc: 0.905 Test Loss: 0.701 Test Acc: 0.905
Validation loss decreased (-0.886476 --> -0.905398).  Saving model ...
Epoch: 7 cost time: 0.9815309047698975
Epoch: 7, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.449 Vali Acc: 0.914 Test Loss: 0.449 Test Acc: 0.914
Validation loss decreased (-0.905398 --> -0.913509).  Saving model ...
Epoch: 8 cost time: 1.1836605072021484
Epoch: 8, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.286 Vali Acc: 0.943 Test Loss: 0.286 Test Acc: 0.943
Validation loss decreased (-0.913509 --> -0.943240).  Saving model ...
Epoch: 9 cost time: 1.0820908546447754
Epoch: 9, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 1.284599781036377
Epoch: 10, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2980306148529053
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.204512357711792
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1807522773742676
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 1.282167911529541
Epoch: 14, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.1298530101776123
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.2366867065429688
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0052530765533447
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0914785861968994
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2209947109222412
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.0904035568237305
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0152721405029297
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1814959049224854
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1299777030944824
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.4198341369628906
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3050658702850342
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.1744568347930908
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1710741519927979
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 1.3667542934417725
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.123340368270874
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1079213619232178
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.108288288116455
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2788119316101074
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2006170749664307
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0809965133666992
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1618223190307617
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2082953453063965
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1217856407165527
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 327265
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7655391693115234
Epoch: 1, Steps: 17 | Train Loss: 2.319 Vali Loss: 2.202 Vali Acc: 0.178 Test Loss: 2.202 Test Acc: 0.178
Validation loss decreased (inf --> -0.178356).  Saving model ...
Epoch: 2 cost time: 1.06803297996521
Epoch: 2, Steps: 17 | Train Loss: 2.091 Vali Loss: 1.960 Vali Acc: 0.454 Test Loss: 1.960 Test Acc: 0.454
Validation loss decreased (-0.178356 --> -0.454034).  Saving model ...
Epoch: 3 cost time: 1.1119327545166016
Epoch: 3, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.670 Vali Acc: 0.849 Test Loss: 1.670 Test Acc: 0.849
Validation loss decreased (-0.454034 --> -0.848632).  Saving model ...
Epoch: 4 cost time: 1.2272107601165771
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.432 Vali Acc: 0.773 Test Loss: 1.432 Test Acc: 0.773
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1364529132843018
Epoch: 5, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.041 Vali Acc: 0.862 Test Loss: 1.041 Test Acc: 0.862
Validation loss decreased (-0.848632 --> -0.862152).  Saving model ...
Epoch: 6 cost time: 1.1379907131195068
Epoch: 6, Steps: 17 | Train Loss: 0.855 Vali Loss: 0.676 Vali Acc: 0.916 Test Loss: 0.676 Test Acc: 0.916
Validation loss decreased (-0.862152 --> -0.916209).  Saving model ...
Epoch: 7 cost time: 1.074183702468872
Epoch: 7, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.443 Vali Acc: 0.914 Test Loss: 0.443 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0133824348449707
Epoch: 8, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.916209 --> -0.951349).  Saving model ...
Epoch: 9 cost time: 1.1303250789642334
Epoch: 9, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1336095333099365
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0892822742462158
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 0.9474637508392334
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 1.1957430839538574
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1195168495178223
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.094459056854248
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2952802181243896
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 1.5275828838348389
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1878867149353027
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1207919120788574
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1782362461090088
Epoch: 20, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1964597702026367
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2091197967529297
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.118945837020874
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1617786884307861
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.2471766471862793
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1554970741271973
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 1.1124258041381836
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.024437427520752
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.09904146194458
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2216155529022217
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1810827255249023
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2370789051055908
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3185234069824219
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1037065982818604
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2058894634246826
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1601552963256836
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 327073
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.595322370529175
Epoch: 1, Steps: 17 | Train Loss: 2.168 Vali Loss: 2.016 Vali Acc: 0.451 Test Loss: 2.016 Test Acc: 0.451
Validation loss decreased (inf --> -0.451331).  Saving model ...
Epoch: 2 cost time: 0.9264011383056641
Epoch: 2, Steps: 17 | Train Loss: 2.017 Vali Loss: 1.861 Vali Acc: 0.684 Test Loss: 1.861 Test Acc: 0.684
Validation loss decreased (-0.451331 --> -0.683765).  Saving model ...
Epoch: 3 cost time: 0.9964249134063721
Epoch: 3, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.605 Vali Acc: 0.814 Test Loss: 1.605 Test Acc: 0.814
Validation loss decreased (-0.683765 --> -0.813497).  Saving model ...
Epoch: 4 cost time: 0.9950664043426514
Epoch: 4, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.289 Vali Acc: 0.854 Test Loss: 1.289 Test Acc: 0.854
Validation loss decreased (-0.813497 --> -0.854041).  Saving model ...
Epoch: 5 cost time: 1.2128429412841797
Epoch: 5, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.962 Vali Acc: 0.900 Test Loss: 0.962 Test Acc: 0.900
Validation loss decreased (-0.854041 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 1.1569998264312744
Epoch: 6, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.650 Vali Acc: 0.903 Test Loss: 0.650 Test Acc: 0.903
Validation loss decreased (-0.899990 --> -0.902696).  Saving model ...
Epoch: 7 cost time: 1.0325968265533447
Epoch: 7, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.388 Vali Acc: 0.922 Test Loss: 0.388 Test Acc: 0.922
Validation loss decreased (-0.902696 --> -0.921618).  Saving model ...
Epoch: 8 cost time: 1.0234706401824951
Epoch: 8, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
Validation loss decreased (-0.921618 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 1.133040189743042
Epoch: 9, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 1.1547820568084717
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0709507465362549
Epoch: 11, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.948647 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 1.0382821559906006
Epoch: 12, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0581579208374023
Epoch: 13, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.220655918121338
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 1.0818731784820557
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0755810737609863
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.980412483215332
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.086759328842163
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.027097463607788
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0571873188018799
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9952023029327393
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.05299711227417
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2256460189819336
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.104569673538208
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 326881
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.637502908706665
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.105 Vali Acc: 0.319 Test Loss: 2.105 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 1.4807312488555908
Epoch: 2, Steps: 17 | Train Loss: 2.072 Vali Loss: 1.947 Vali Acc: 0.554 Test Loss: 1.947 Test Acc: 0.554
Validation loss decreased (-0.318898 --> -0.554035).  Saving model ...
Epoch: 3 cost time: 1.1678063869476318
Epoch: 3, Steps: 17 | Train Loss: 1.883 Vali Loss: 1.726 Vali Acc: 0.627 Test Loss: 1.726 Test Acc: 0.627
Validation loss decreased (-0.554035 --> -0.627010).  Saving model ...
Epoch: 4 cost time: 1.0698723793029785
Epoch: 4, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.462 Vali Acc: 0.841 Test Loss: 1.462 Test Acc: 0.841
Validation loss decreased (-0.627010 --> -0.840526).  Saving model ...
Epoch: 5 cost time: 1.088562250137329
Epoch: 5, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.136 Vali Acc: 0.808 Test Loss: 1.136 Test Acc: 0.808
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.333911418914795
Epoch: 6, Steps: 17 | Train Loss: 0.996 Vali Loss: 0.804 Vali Acc: 0.916 Test Loss: 0.804 Test Acc: 0.916
Validation loss decreased (-0.840526 --> -0.916208).  Saving model ...
Epoch: 7 cost time: 1.2308006286621094
Epoch: 7, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.518 Vali Acc: 0.924 Test Loss: 0.518 Test Acc: 0.924
Validation loss decreased (-0.916208 --> -0.924319).  Saving model ...
Epoch: 8 cost time: 1.0635042190551758
Epoch: 8, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.365 Vali Acc: 0.924 Test Loss: 0.365 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924321).  Saving model ...
Epoch: 9 cost time: 1.0361676216125488
Epoch: 9, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
Validation loss decreased (-0.924321 --> -0.937835).  Saving model ...
Epoch: 10 cost time: 1.0188653469085693
Epoch: 10, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.0418131351470947
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.166 Vali Acc: 0.938 Test Loss: 0.166 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.143559217453003
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 0.9837839603424072
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1400201320648193
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9083232879638672
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.0877125263214111
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1802921295166016
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3058209419250488
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1013007164001465
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2509944438934326
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5108191967010498
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2939088344573975
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1208624839782715
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2766859531402588
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1697585582733154
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 277921
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9301023483276367
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.139 Vali Acc: 0.232 Test Loss: 2.139 Test Acc: 0.232
Validation loss decreased (inf --> -0.232411).  Saving model ...
Epoch: 2 cost time: 1.0675280094146729
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.902 Vali Acc: 0.630 Test Loss: 1.902 Test Acc: 0.630
Validation loss decreased (-0.232411 --> -0.629711).  Saving model ...
Epoch: 3 cost time: 1.1264219284057617
Epoch: 3, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.664 Vali Acc: 0.751 Test Loss: 1.664 Test Acc: 0.751
Validation loss decreased (-0.629711 --> -0.751335).  Saving model ...
Epoch: 4 cost time: 1.4205782413482666
Epoch: 4, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.369 Vali Acc: 0.857 Test Loss: 1.369 Test Acc: 0.857
Validation loss decreased (-0.751335 --> -0.856743).  Saving model ...
Epoch: 5 cost time: 1.2009086608886719
Epoch: 5, Steps: 17 | Train Loss: 1.218 Vali Loss: 0.978 Vali Acc: 0.884 Test Loss: 0.978 Test Acc: 0.884
Validation loss decreased (-0.856743 --> -0.883774).  Saving model ...
Epoch: 6 cost time: 1.1161205768585205
Epoch: 6, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.715 Vali Acc: 0.905 Test Loss: 0.715 Test Acc: 0.905
Validation loss decreased (-0.883774 --> -0.905398).  Saving model ...
Epoch: 7 cost time: 1.1392357349395752
Epoch: 7, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.450 Vali Acc: 0.935 Test Loss: 0.450 Test Acc: 0.935
Validation loss decreased (-0.905398 --> -0.935131).  Saving model ...
Epoch: 8 cost time: 1.0539088249206543
Epoch: 8, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 1.044726848602295
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 1.1630780696868896
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.1118834018707275
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3812484741210938
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 1.1015233993530273
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2383089065551758
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 1.2085654735565186
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 0.8998730182647705
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3754150867462158
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.154606819152832
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 0.9751322269439697
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0950467586517334
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0785837173461914
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.1405019760131836
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1233210563659668
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1151573657989502
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0537683963775635
Epoch: 25, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1952056884765625
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1404013633728027
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1937732696533203
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.042970895767212
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1154329776763916
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2083590030670166
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 277729
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9559667110443115
Epoch: 1, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.132 Vali Acc: 0.235 Test Loss: 2.132 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 1.5621116161346436
Epoch: 2, Steps: 17 | Train Loss: 2.114 Vali Loss: 1.962 Vali Acc: 0.514 Test Loss: 1.962 Test Acc: 0.514
Validation loss decreased (-0.235114 --> -0.513494).  Saving model ...
Epoch: 3 cost time: 1.3277859687805176
Epoch: 3, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.737 Vali Acc: 0.700 Test Loss: 1.737 Test Acc: 0.700
Validation loss decreased (-0.513494 --> -0.699983).  Saving model ...
Epoch: 4 cost time: 1.3081748485565186
Epoch: 4, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.476 Vali Acc: 0.816 Test Loss: 1.476 Test Acc: 0.816
Validation loss decreased (-0.699983 --> -0.816201).  Saving model ...
Epoch: 5 cost time: 1.0844082832336426
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.192 Vali Acc: 0.816 Test Loss: 1.192 Test Acc: 0.816
Validation loss decreased (-0.816201 --> -0.816204).  Saving model ...
Epoch: 6 cost time: 1.184037685394287
Epoch: 6, Steps: 17 | Train Loss: 0.955 Vali Loss: 0.769 Vali Acc: 0.905 Test Loss: 0.769 Test Acc: 0.905
Validation loss decreased (-0.816204 --> -0.905398).  Saving model ...
Epoch: 7 cost time: 1.1323277950286865
Epoch: 7, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.518 Vali Acc: 0.916 Test Loss: 0.518 Test Acc: 0.916
Validation loss decreased (-0.905398 --> -0.916211).  Saving model ...
Epoch: 8 cost time: 1.202167272567749
Epoch: 8, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.323 Vali Acc: 0.943 Test Loss: 0.323 Test Acc: 0.943
Validation loss decreased (-0.916211 --> -0.943240).  Saving model ...
Epoch: 9 cost time: 1.3641877174377441
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1764590740203857
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.0097198486328125
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.1558640003204346
Epoch: 12, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.106255054473877
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4749579429626465
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 1.36946439743042
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4890110492706299
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 1.4832484722137451
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3734934329986572
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3883259296417236
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.051236867904663
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1357872486114502
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7215526103973389
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2567367553710938
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.292893886566162
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.126810073852539
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1375465393066406
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 277537
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9993999004364014
Epoch: 1, Steps: 17 | Train Loss: 2.303 Vali Loss: 2.157 Vali Acc: 0.111 Test Loss: 2.157 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 1.1470539569854736
Epoch: 2, Steps: 17 | Train Loss: 2.100 Vali Loss: 1.963 Vali Acc: 0.557 Test Loss: 1.963 Test Acc: 0.557
Validation loss decreased (-0.110789 --> -0.556737).  Saving model ...
Epoch: 3 cost time: 1.2282171249389648
Epoch: 3, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.711 Vali Acc: 0.727 Test Loss: 1.711 Test Acc: 0.727
Validation loss decreased (-0.556737 --> -0.727010).  Saving model ...
Epoch: 4 cost time: 1.2029147148132324
Epoch: 4, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.430 Vali Acc: 0.835 Test Loss: 1.430 Test Acc: 0.835
Validation loss decreased (-0.727010 --> -0.835121).  Saving model ...
Epoch: 5 cost time: 1.1733698844909668
Epoch: 5, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.133 Vali Acc: 0.857 Test Loss: 1.133 Test Acc: 0.857
Validation loss decreased (-0.835121 --> -0.856745).  Saving model ...
Epoch: 6 cost time: 1.1745424270629883
Epoch: 6, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.817 Vali Acc: 0.851 Test Loss: 0.817 Test Acc: 0.851
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2935645580291748
Epoch: 7, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.536 Vali Acc: 0.924 Test Loss: 0.536 Test Acc: 0.924
Validation loss decreased (-0.856745 --> -0.924319).  Saving model ...
Epoch: 8 cost time: 1.2318992614746094
Epoch: 8, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.357 Vali Acc: 0.930 Test Loss: 0.357 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929726).  Saving model ...
Epoch: 9 cost time: 1.0016117095947266
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.1914405822753906
Epoch: 10, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.0563020706176758
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.079127311706543
Epoch: 12, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9219717979431152
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.0744600296020508
Epoch: 14, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9811468124389648
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.318779706954956
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.118025541305542
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.0481579303741455
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0473201274871826
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.177042007446289
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 0.969606876373291
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0160174369812012
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9733552932739258
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9559550285339355
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1407451629638672
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0849018096923828
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.179955005645752
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0528950691223145
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3149652481079102
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9983527660369873
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 277345
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.800743818283081
Epoch: 1, Steps: 17 | Train Loss: 2.353 Vali Loss: 2.179 Vali Acc: 0.054 Test Loss: 2.179 Test Acc: 0.054
Validation loss decreased (inf --> -0.054032).  Saving model ...
Epoch: 2 cost time: 1.0694901943206787
Epoch: 2, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.070 Vali Acc: 0.332 Test Loss: 2.070 Test Acc: 0.332
Validation loss decreased (-0.054032 --> -0.332412).  Saving model ...
Epoch: 3 cost time: 1.1178665161132812
Epoch: 3, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.878 Vali Acc: 0.497 Test Loss: 1.878 Test Acc: 0.497
Validation loss decreased (-0.332412 --> -0.497279).  Saving model ...
Epoch: 4 cost time: 0.9827473163604736
Epoch: 4, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.625 Vali Acc: 0.784 Test Loss: 1.625 Test Acc: 0.784
Validation loss decreased (-0.497279 --> -0.783768).  Saving model ...
Epoch: 5 cost time: 1.097463846206665
Epoch: 5, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.333 Vali Acc: 0.841 Test Loss: 1.333 Test Acc: 0.841
Validation loss decreased (-0.783768 --> -0.840527).  Saving model ...
Epoch: 6 cost time: 1.0272927284240723
Epoch: 6, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.015 Vali Acc: 0.865 Test Loss: 1.015 Test Acc: 0.865
Validation loss decreased (-0.840527 --> -0.864855).  Saving model ...
Epoch: 7 cost time: 1.0301244258880615
Epoch: 7, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.676 Vali Acc: 0.914 Test Loss: 0.676 Test Acc: 0.914
Validation loss decreased (-0.864855 --> -0.913507).  Saving model ...
Epoch: 8 cost time: 1.1749348640441895
Epoch: 8, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.172891616821289
Epoch: 9, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.386 Vali Acc: 0.924 Test Loss: 0.386 Test Acc: 0.924
Validation loss decreased (-0.913507 --> -0.924320).  Saving model ...
Epoch: 10 cost time: 1.1148624420166016
Epoch: 10, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.296 Vali Acc: 0.938 Test Loss: 0.296 Test Acc: 0.938
Validation loss decreased (-0.924320 --> -0.937835).  Saving model ...
Epoch: 11 cost time: 1.0087342262268066
Epoch: 11, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.0533783435821533
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1255505084991455
Epoch: 13, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1771116256713867
Epoch: 14, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 1.1808476448059082
Epoch: 15, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.262831449508667
Epoch: 16, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0273425579071045
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.1911473274230957
Epoch: 18, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2278475761413574
Epoch: 19, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9862227439880371
Epoch: 20, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0459835529327393
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0849761962890625
Epoch: 22, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1163814067840576
Epoch: 23, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1676979064941406
Epoch: 24, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 1.0754928588867188
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4691710472106934
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0125439167022705
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.06260085105896
Epoch: 28, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1584553718566895
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3463232517242432
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2269060611724854
Epoch: 31, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1923937797546387
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3486828804016113
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1500284671783447
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 264737
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.664625406265259
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.129 Vali Acc: 0.268 Test Loss: 2.129 Test Acc: 0.268
Validation loss decreased (inf --> -0.267546).  Saving model ...
Epoch: 2 cost time: 1.0946133136749268
Epoch: 2, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.991 Vali Acc: 0.454 Test Loss: 1.991 Test Acc: 0.454
Validation loss decreased (-0.267546 --> -0.454034).  Saving model ...
Epoch: 3 cost time: 1.041797399520874
Epoch: 3, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.803 Vali Acc: 0.716 Test Loss: 1.803 Test Acc: 0.716
Validation loss decreased (-0.454034 --> -0.716198).  Saving model ...
Epoch: 4 cost time: 1.1983222961425781
Epoch: 4, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.532 Vali Acc: 0.841 Test Loss: 1.532 Test Acc: 0.841
Validation loss decreased (-0.716198 --> -0.840525).  Saving model ...
Epoch: 5 cost time: 1.175027847290039
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.215 Vali Acc: 0.870 Test Loss: 1.215 Test Acc: 0.870
Validation loss decreased (-0.840525 --> -0.870258).  Saving model ...
Epoch: 6 cost time: 1.1694486141204834
Epoch: 6, Steps: 17 | Train Loss: 1.074 Vali Loss: 0.873 Vali Acc: 0.889 Test Loss: 0.873 Test Acc: 0.889
Validation loss decreased (-0.870258 --> -0.889180).  Saving model ...
Epoch: 7 cost time: 1.2661769390106201
Epoch: 7, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.631 Vali Acc: 0.914 Test Loss: 0.631 Test Acc: 0.914
Validation loss decreased (-0.889180 --> -0.913507).  Saving model ...
Epoch: 8 cost time: 1.3068666458129883
Epoch: 8, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.457 Vali Acc: 0.943 Test Loss: 0.457 Test Acc: 0.943
Validation loss decreased (-0.913507 --> -0.943239).  Saving model ...
Epoch: 9 cost time: 1.2653326988220215
Epoch: 9, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.354 Vali Acc: 0.932 Test Loss: 0.354 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3360669612884521
Epoch: 10, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.277 Vali Acc: 0.949 Test Loss: 0.277 Test Acc: 0.949
Validation loss decreased (-0.943239 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.323171615600586
Epoch: 11, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.251 Vali Acc: 0.943 Test Loss: 0.251 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2121293544769287
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 1.0909385681152344
Epoch: 13, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 1.0293521881103516
Epoch: 14, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.290980577468872
Epoch: 15, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1619393825531006
Epoch: 16, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1434447765350342
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 1.0454647541046143
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.244126796722412
Epoch: 19, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 1.2501919269561768
Epoch: 20, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 1.126314640045166
Epoch: 21, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0782794952392578
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 1.0240044593811035
Epoch: 23, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4841527938842773
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1172451972961426
Epoch: 25, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1338505744934082
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2098474502563477
Epoch: 27, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.289147138595581
Epoch: 28, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.306107997894287
Epoch: 29, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.234055995941162
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1452481746673584
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.205937147140503
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 264641
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9390671253204346
Epoch: 1, Steps: 17 | Train Loss: 2.290 Vali Loss: 2.157 Vali Acc: 0.222 Test Loss: 2.157 Test Acc: 0.222
Validation loss decreased (inf --> -0.221600).  Saving model ...
Epoch: 2 cost time: 1.2808959484100342
Epoch: 2, Steps: 17 | Train Loss: 2.124 Vali Loss: 2.095 Vali Acc: 0.251 Test Loss: 2.095 Test Acc: 0.251
Validation loss decreased (-0.221600 --> -0.251330).  Saving model ...
Epoch: 3 cost time: 1.0626139640808105
Epoch: 3, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.884 Vali Acc: 0.686 Test Loss: 1.884 Test Acc: 0.686
Validation loss decreased (-0.251330 --> -0.686468).  Saving model ...
Epoch: 4 cost time: 1.0297834873199463
Epoch: 4, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.674 Vali Acc: 0.722 Test Loss: 1.674 Test Acc: 0.722
Validation loss decreased (-0.686468 --> -0.721605).  Saving model ...
Epoch: 5 cost time: 1.3169183731079102
Epoch: 5, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.312 Vali Acc: 0.851 Test Loss: 1.312 Test Acc: 0.851
Validation loss decreased (-0.721605 --> -0.851338).  Saving model ...
Epoch: 6 cost time: 1.0228493213653564
Epoch: 6, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.947 Vali Acc: 0.911 Test Loss: 0.947 Test Acc: 0.911
Validation loss decreased (-0.851338 --> -0.910801).  Saving model ...
Epoch: 7 cost time: 1.0495069026947021
Epoch: 7, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.670 Vali Acc: 0.935 Test Loss: 0.670 Test Acc: 0.935
Validation loss decreased (-0.910801 --> -0.935128).  Saving model ...
Epoch: 8 cost time: 1.1895232200622559
Epoch: 8, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.470 Vali Acc: 0.927 Test Loss: 0.470 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2183122634887695
Epoch: 9, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9686062335968018
Epoch: 10, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.290 Vali Acc: 0.943 Test Loss: 0.290 Test Acc: 0.943
Validation loss decreased (-0.935128 --> -0.943240).  Saving model ...
Epoch: 11 cost time: 1.1108155250549316
Epoch: 11, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.1749186515808105
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.0157098770141602
Epoch: 13, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2097959518432617
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0123908519744873
Epoch: 15, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.1345539093017578
Epoch: 16, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2509474754333496
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 1.1104905605316162
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.0853428840637207
Epoch: 19, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1035363674163818
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1841905117034912
Epoch: 21, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.147090196609497
Epoch: 22, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9948127269744873
Epoch: 23, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1179134845733643
Epoch: 24, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1866066455841064
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 1.3411273956298828
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.154172658920288
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0585193634033203
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 1.250643014907837
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0703308582305908
Epoch: 30, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0038790702819824
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3227663040161133
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.232330560684204
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.19773530960083
Epoch: 34, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0611414909362793
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.292971134185791
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1247587203979492
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1934771537780762
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 264545
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.607449769973755
Epoch: 1, Steps: 17 | Train Loss: 2.341 Vali Loss: 2.201 Vali Acc: 0.105 Test Loss: 2.201 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 1.038991928100586
Epoch: 2, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.116 Vali Acc: 0.211 Test Loss: 2.116 Test Acc: 0.211
Validation loss decreased (-0.105383 --> -0.210790).  Saving model ...
Epoch: 3 cost time: 1.0644965171813965
Epoch: 3, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.935 Vali Acc: 0.522 Test Loss: 1.935 Test Acc: 0.522
Validation loss decreased (-0.210790 --> -0.521602).  Saving model ...
Epoch: 4 cost time: 1.1810202598571777
Epoch: 4, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.709 Vali Acc: 0.689 Test Loss: 1.709 Test Acc: 0.689
Validation loss decreased (-0.521602 --> -0.689172).  Saving model ...
Epoch: 5 cost time: 1.0571348667144775
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.360 Vali Acc: 0.808 Test Loss: 1.360 Test Acc: 0.808
Validation loss decreased (-0.689172 --> -0.808095).  Saving model ...
Epoch: 6 cost time: 1.182208776473999
Epoch: 6, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.077 Vali Acc: 0.889 Test Loss: 1.077 Test Acc: 0.889
Validation loss decreased (-0.808095 --> -0.889178).  Saving model ...
Epoch: 7 cost time: 1.1908843517303467
Epoch: 7, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.720 Vali Acc: 0.914 Test Loss: 0.720 Test Acc: 0.914
Validation loss decreased (-0.889178 --> -0.913506).  Saving model ...
Epoch: 8 cost time: 1.0888519287109375
Epoch: 8, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.541 Vali Acc: 0.932 Test Loss: 0.541 Test Acc: 0.932
Validation loss decreased (-0.913506 --> -0.932427).  Saving model ...
Epoch: 9 cost time: 0.997227668762207
Epoch: 9, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.383 Vali Acc: 0.946 Test Loss: 0.383 Test Acc: 0.946
Validation loss decreased (-0.932427 --> -0.945942).  Saving model ...
Epoch: 10 cost time: 1.0840716361999512
Epoch: 10, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.313 Vali Acc: 0.938 Test Loss: 0.313 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5256757736206055
Epoch: 11, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.367215871810913
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4252700805664062
Epoch: 13, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 1.1579594612121582
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.273404836654663
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.2209103107452393
Epoch: 16, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0832757949829102
Epoch: 17, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2338323593139648
Epoch: 18, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3635287284851074
Epoch: 19, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2511684894561768
Epoch: 20, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 1.3798141479492188
Epoch: 21, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.176872730255127
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2824981212615967
Epoch: 23, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2836155891418457
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5632834434509277
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.220494031906128
Epoch: 26, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3849990367889404
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.39823579788208
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2993593215942383
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.954 Test Loss: 0.118 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.19087553024292
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 264449
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.158860683441162
Epoch: 1, Steps: 17 | Train Loss: 2.275 Vali Loss: 2.206 Vali Acc: 0.051 Test Loss: 2.206 Test Acc: 0.051
Validation loss decreased (inf --> -0.051329).  Saving model ...
Epoch: 2 cost time: 1.2783229351043701
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.091 Vali Acc: 0.235 Test Loss: 2.091 Test Acc: 0.235
Validation loss decreased (-0.051329 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 1.1601452827453613
Epoch: 3, Steps: 17 | Train Loss: 2.027 Vali Loss: 1.942 Vali Acc: 0.559 Test Loss: 1.942 Test Acc: 0.559
Validation loss decreased (-0.235114 --> -0.559440).  Saving model ...
Epoch: 4 cost time: 1.1975297927856445
Epoch: 4, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.736 Vali Acc: 0.749 Test Loss: 1.736 Test Acc: 0.749
Validation loss decreased (-0.559440 --> -0.748631).  Saving model ...
Epoch: 5 cost time: 1.2783615589141846
Epoch: 5, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.506 Vali Acc: 0.827 Test Loss: 1.506 Test Acc: 0.827
Validation loss decreased (-0.748631 --> -0.827012).  Saving model ...
Epoch: 6 cost time: 1.3154819011688232
Epoch: 6, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.210 Vali Acc: 0.846 Test Loss: 1.210 Test Acc: 0.846
Validation loss decreased (-0.827012 --> -0.845934).  Saving model ...
Epoch: 7 cost time: 1.2117149829864502
Epoch: 7, Steps: 17 | Train Loss: 1.020 Vali Loss: 0.871 Vali Acc: 0.924 Test Loss: 0.871 Test Acc: 0.924
Validation loss decreased (-0.845934 --> -0.924316).  Saving model ...
Epoch: 8 cost time: 1.3429362773895264
Epoch: 8, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.624 Vali Acc: 0.932 Test Loss: 0.624 Test Acc: 0.932
Validation loss decreased (-0.924316 --> -0.932426).  Saving model ...
Epoch: 9 cost time: 1.3841660022735596
Epoch: 9, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.440 Vali Acc: 0.935 Test Loss: 0.440 Test Acc: 0.935
Validation loss decreased (-0.932426 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 1.4104440212249756
Epoch: 10, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 11 cost time: 1.564391851425171
Epoch: 11, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.249 Vali Acc: 0.962 Test Loss: 0.249 Test Acc: 0.962
Validation loss decreased (-0.940537 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 1.2329318523406982
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5501792430877686
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.182800054550171
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4833154678344727
Epoch: 15, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3741655349731445
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4639866352081299
Epoch: 17, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2861239910125732
Epoch: 18, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2211740016937256
Epoch: 19, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0166332721710205
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 1.1180014610290527
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4587361812591553
Epoch: 22, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 1.1789257526397705
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1552116870880127
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 1.5091304779052734
Epoch: 25, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.0976765155792236
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.167372703552246
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3823027610778809
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.16353178024292
Epoch: 29, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.2789654731750488
Epoch: 30, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1756370067596436
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.052489995956421
Epoch: 32, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.171644687652588
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1097540855407715
Epoch: 34, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1450822353363037
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2657010555267334
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1833038330078125
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2725791931152344
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2116272449493408
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.168 Vali Acc: 0.935 Test Loss: 0.168 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 164897
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6778061389923096
Epoch: 1, Steps: 17 | Train Loss: 2.337 Vali Loss: 2.224 Vali Acc: 0.078 Test Loss: 2.224 Test Acc: 0.078
Validation loss decreased (inf --> -0.078356).  Saving model ...
Epoch: 2 cost time: 0.9672808647155762
Epoch: 2, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.090 Vali Acc: 0.273 Test Loss: 2.090 Test Acc: 0.273
Validation loss decreased (-0.078356 --> -0.272952).  Saving model ...
Epoch: 3 cost time: 1.1096467971801758
Epoch: 3, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.975 Vali Acc: 0.451 Test Loss: 1.975 Test Acc: 0.451
Validation loss decreased (-0.272952 --> -0.451332).  Saving model ...
Epoch: 4 cost time: 1.1305301189422607
Epoch: 4, Steps: 17 | Train Loss: 1.923 Vali Loss: 1.801 Vali Acc: 0.703 Test Loss: 1.801 Test Acc: 0.703
Validation loss decreased (-0.451332 --> -0.702685).  Saving model ...
Epoch: 5 cost time: 1.0058190822601318
Epoch: 5, Steps: 17 | Train Loss: 1.709 Vali Loss: 1.579 Vali Acc: 0.697 Test Loss: 1.579 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1732151508331299
Epoch: 6, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.291 Vali Acc: 0.857 Test Loss: 1.291 Test Acc: 0.857
Validation loss decreased (-0.702685 --> -0.856744).  Saving model ...
Epoch: 7 cost time: 1.0877792835235596
Epoch: 7, Steps: 17 | Train Loss: 1.115 Vali Loss: 0.981 Vali Acc: 0.862 Test Loss: 0.981 Test Acc: 0.862
Validation loss decreased (-0.856744 --> -0.862152).  Saving model ...
Epoch: 8 cost time: 1.0920045375823975
Epoch: 8, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.730 Vali Acc: 0.895 Test Loss: 0.730 Test Acc: 0.895
Validation loss decreased (-0.862152 --> -0.894587).  Saving model ...
Epoch: 9 cost time: 1.0186944007873535
Epoch: 9, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.535 Vali Acc: 0.911 Test Loss: 0.535 Test Acc: 0.911
Validation loss decreased (-0.894587 --> -0.910805).  Saving model ...
Epoch: 10 cost time: 0.9508795738220215
Epoch: 10, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921618).  Saving model ...
Epoch: 11 cost time: 0.9411964416503906
Epoch: 11, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 12 cost time: 1.1829979419708252
Epoch: 12, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
Validation loss decreased (-0.921618 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 1.3888404369354248
Epoch: 13, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 14 cost time: 1.1689486503601074
Epoch: 14, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1993541717529297
Epoch: 15, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.179837942123413
Epoch: 16, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 1.2248950004577637
Epoch: 17, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.100097894668579
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3308539390563965
Epoch: 19, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.211313247680664
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2155389785766602
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.2154393196105957
Epoch: 22, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.169969081878662
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 1.0156617164611816
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.1832294464111328
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1902458667755127
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 1.153419017791748
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.240046501159668
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.110046625137329
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2849030494689941
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2128751277923584
Epoch: 31, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1594247817993164
Epoch: 32, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2924878597259521
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 34 cost time: 1.0556538105010986
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.0978517532348633
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.092339277267456
Epoch: 36, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0352959632873535
Epoch: 37, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.029066801071167
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1748366355895996
Epoch: 39, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.320603370666504
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2715585231781006
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1258840560913086
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1079740524291992
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3709328174591064
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 164801
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6570992469787598
Epoch: 1, Steps: 17 | Train Loss: 2.273 Vali Loss: 2.252 Vali Acc: 0.157 Test Loss: 2.252 Test Acc: 0.157
Validation loss decreased (inf --> -0.156734).  Saving model ...
Epoch: 2 cost time: 1.1705827713012695
Epoch: 2, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.023 Vali Acc: 0.373 Test Loss: 2.023 Test Acc: 0.373
Validation loss decreased (-0.156734 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 1.0782315731048584
Epoch: 3, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.885 Vali Acc: 0.581 Test Loss: 1.885 Test Acc: 0.581
Validation loss decreased (-0.372953 --> -0.581062).  Saving model ...
Epoch: 4 cost time: 1.182929277420044
Epoch: 4, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.670 Vali Acc: 0.754 Test Loss: 1.670 Test Acc: 0.754
Validation loss decreased (-0.581062 --> -0.754037).  Saving model ...
Epoch: 5 cost time: 1.190962791442871
Epoch: 5, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.383 Vali Acc: 0.805 Test Loss: 1.383 Test Acc: 0.805
Validation loss decreased (-0.754037 --> -0.805392).  Saving model ...
Epoch: 6 cost time: 1.3088202476501465
Epoch: 6, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.099 Vali Acc: 0.859 Test Loss: 1.099 Test Acc: 0.859
Validation loss decreased (-0.805392 --> -0.859448).  Saving model ...
Epoch: 7 cost time: 1.3839001655578613
Epoch: 7, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.767 Vali Acc: 0.911 Test Loss: 0.767 Test Acc: 0.911
Validation loss decreased (-0.859448 --> -0.910803).  Saving model ...
Epoch: 8 cost time: 1.2615365982055664
Epoch: 8, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.561 Vali Acc: 0.930 Test Loss: 0.561 Test Acc: 0.930
Validation loss decreased (-0.910803 --> -0.929724).  Saving model ...
Epoch: 9 cost time: 1.1518371105194092
Epoch: 9, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.396 Vali Acc: 0.949 Test Loss: 0.396 Test Acc: 0.949
Validation loss decreased (-0.929724 --> -0.948645).  Saving model ...
Epoch: 10 cost time: 1.1984782218933105
Epoch: 10, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.314 Vali Acc: 0.949 Test Loss: 0.314 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.348573923110962
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.270 Vali Acc: 0.951 Test Loss: 0.270 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.4898407459259033
Epoch: 12, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.245 Vali Acc: 0.951 Test Loss: 0.245 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 1.2204127311706543
Epoch: 13, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.2509536743164062
Epoch: 14, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2451133728027344
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.2155203819274902
Epoch: 16, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.0618650913238525
Epoch: 17, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.2906484603881836
Epoch: 18, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2183094024658203
Epoch: 19, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0959055423736572
Epoch: 20, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1790881156921387
Epoch: 21, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.1979539394378662
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0367083549499512
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0541110038757324
Epoch: 24, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2638888359069824
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 1.2000744342803955
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2995572090148926
Epoch: 27, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3829026222229004
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.258540391921997
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.340003490447998
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 1.3547160625457764
Epoch: 31, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3993895053863525
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.941 Test Loss: 0.151 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1234993934631348
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1173079013824463
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 1.1115775108337402
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0145022869110107
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.0556628704071045
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.311147928237915
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1838762760162354
Epoch: 39, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.291599988937378
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9860813617706299
Epoch: 41, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3103299140930176
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1150717735290527
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0449683666229248
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.340416669845581
Epoch: 45, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3804030418395996
Epoch: 46, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 164705
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.217092514038086
Epoch: 1, Steps: 17 | Train Loss: 2.268 Vali Loss: 2.230 Vali Acc: 0.122 Test Loss: 2.230 Test Acc: 0.122
Validation loss decreased (inf --> -0.121599).  Saving model ...
Epoch: 2 cost time: 1.0379886627197266
Epoch: 2, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.049 Vali Acc: 0.351 Test Loss: 2.049 Test Acc: 0.351
Validation loss decreased (-0.121599 --> -0.351331).  Saving model ...
Epoch: 3 cost time: 1.0872488021850586
Epoch: 3, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.909 Vali Acc: 0.570 Test Loss: 1.909 Test Acc: 0.570
Validation loss decreased (-0.351331 --> -0.570251).  Saving model ...
Epoch: 4 cost time: 1.173285722732544
Epoch: 4, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.733 Vali Acc: 0.768 Test Loss: 1.733 Test Acc: 0.768
Validation loss decreased (-0.570251 --> -0.767550).  Saving model ...
Epoch: 5 cost time: 1.0337293148040771
Epoch: 5, Steps: 17 | Train Loss: 1.600 Vali Loss: 1.422 Vali Acc: 0.886 Test Loss: 1.422 Test Acc: 0.886
Validation loss decreased (-0.767550 --> -0.886472).  Saving model ...
Epoch: 6 cost time: 1.2972135543823242
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.164 Vali Acc: 0.889 Test Loss: 1.164 Test Acc: 0.889
Validation loss decreased (-0.886472 --> -0.889178).  Saving model ...
Epoch: 7 cost time: 1.2865331172943115
Epoch: 7, Steps: 17 | Train Loss: 0.979 Vali Loss: 0.812 Vali Acc: 0.889 Test Loss: 0.812 Test Acc: 0.889
Validation loss decreased (-0.889178 --> -0.889181).  Saving model ...
Epoch: 8 cost time: 1.3079726696014404
Epoch: 8, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.590 Vali Acc: 0.908 Test Loss: 0.590 Test Acc: 0.908
Validation loss decreased (-0.889181 --> -0.908102).  Saving model ...
Epoch: 9 cost time: 1.0065908432006836
Epoch: 9, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.429 Vali Acc: 0.932 Test Loss: 0.429 Test Acc: 0.932
Validation loss decreased (-0.908102 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 1.0632729530334473
Epoch: 10, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.330 Vali Acc: 0.938 Test Loss: 0.330 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937835).  Saving model ...
Epoch: 11 cost time: 1.0614569187164307
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.263 Vali Acc: 0.951 Test Loss: 0.263 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.0620903968811035
Epoch: 12, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.237 Vali Acc: 0.949 Test Loss: 0.237 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9814345836639404
Epoch: 13, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.2451930046081543
Epoch: 14, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3143651485443115
Epoch: 15, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.192518949508667
Epoch: 16, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1699364185333252
Epoch: 17, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.089909315109253
Epoch: 18, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.1465144157409668
Epoch: 19, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.104909896850586
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2360806465148926
Epoch: 21, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0900511741638184
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 0.9882626533508301
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1129086017608643
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2312812805175781
Epoch: 25, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0829272270202637
Epoch: 26, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1775753498077393
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2094264030456543
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0482685565948486
Epoch: 29, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4313092231750488
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0730681419372559
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.976050615310669
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 164609
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0430171489715576
Epoch: 1, Steps: 17 | Train Loss: 2.363 Vali Loss: 2.193 Vali Acc: 0.127 Test Loss: 2.193 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 1.3904850482940674
Epoch: 2, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.074 Vali Acc: 0.265 Test Loss: 2.074 Test Acc: 0.265
Validation loss decreased (-0.127005 --> -0.264844).  Saving model ...
Epoch: 3 cost time: 1.2989826202392578
Epoch: 3, Steps: 17 | Train Loss: 2.062 Vali Loss: 1.915 Vali Acc: 0.624 Test Loss: 1.915 Test Acc: 0.624
Validation loss decreased (-0.264844 --> -0.624305).  Saving model ...
Epoch: 4 cost time: 1.612379550933838
Epoch: 4, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.824 Vali Acc: 0.554 Test Loss: 1.824 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4873812198638916
Epoch: 5, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.528 Vali Acc: 0.819 Test Loss: 1.528 Test Acc: 0.819
Validation loss decreased (-0.624305 --> -0.818904).  Saving model ...
Epoch: 6 cost time: 1.4895522594451904
Epoch: 6, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.327 Vali Acc: 0.859 Test Loss: 1.327 Test Acc: 0.859
Validation loss decreased (-0.818904 --> -0.859446).  Saving model ...
Epoch: 7 cost time: 1.207021713256836
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 0.999 Vali Acc: 0.911 Test Loss: 0.999 Test Acc: 0.911
Validation loss decreased (-0.859446 --> -0.910801).  Saving model ...
Epoch: 8 cost time: 1.38161039352417
Epoch: 8, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.741 Vali Acc: 0.935 Test Loss: 0.741 Test Acc: 0.935
Validation loss decreased (-0.910801 --> -0.935128).  Saving model ...
Epoch: 9 cost time: 1.0943520069122314
Epoch: 9, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.525 Vali Acc: 0.924 Test Loss: 0.525 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0625841617584229
Epoch: 10, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.381 Vali Acc: 0.932 Test Loss: 0.381 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3289318084716797
Epoch: 11, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.288 Vali Acc: 0.943 Test Loss: 0.288 Test Acc: 0.943
Validation loss decreased (-0.935128 --> -0.943240).  Saving model ...
Epoch: 12 cost time: 1.3913187980651855
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.1471927165985107
Epoch: 13, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1923627853393555
Epoch: 14, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
Validation loss decreased (-0.945944 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 1.2337369918823242
Epoch: 15, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3663439750671387
Epoch: 16, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3476719856262207
Epoch: 17, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2480406761169434
Epoch: 18, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6739447116851807
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.225158929824829
Epoch: 20, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2294437885284424
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4155492782592773
Epoch: 22, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2981717586517334
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2308299541473389
Epoch: 24, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 114977
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7856316566467285
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.113 Vali Acc: 0.219 Test Loss: 2.113 Test Acc: 0.219
Validation loss decreased (inf --> -0.218898).  Saving model ...
Epoch: 2 cost time: 1.2098567485809326
Epoch: 2, Steps: 17 | Train Loss: 2.085 Vali Loss: 2.043 Vali Acc: 0.314 Test Loss: 2.043 Test Acc: 0.314
Validation loss decreased (-0.218898 --> -0.313493).  Saving model ...
Epoch: 3 cost time: 1.1303436756134033
Epoch: 3, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.867 Vali Acc: 0.608 Test Loss: 1.867 Test Acc: 0.608
Validation loss decreased (-0.313493 --> -0.608089).  Saving model ...
Epoch: 4 cost time: 1.2211694717407227
Epoch: 4, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.706 Vali Acc: 0.770 Test Loss: 1.706 Test Acc: 0.770
Validation loss decreased (-0.608089 --> -0.770253).  Saving model ...
Epoch: 5 cost time: 1.0561671257019043
Epoch: 5, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.465 Vali Acc: 0.827 Test Loss: 1.465 Test Acc: 0.827
Validation loss decreased (-0.770253 --> -0.827012).  Saving model ...
Epoch: 6 cost time: 1.0498087406158447
Epoch: 6, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.206 Vali Acc: 0.865 Test Loss: 1.206 Test Acc: 0.865
Validation loss decreased (-0.827012 --> -0.864853).  Saving model ...
Epoch: 7 cost time: 1.3279972076416016
Epoch: 7, Steps: 17 | Train Loss: 1.035 Vali Loss: 0.931 Vali Acc: 0.895 Test Loss: 0.931 Test Acc: 0.895
Validation loss decreased (-0.864853 --> -0.894585).  Saving model ...
Epoch: 8 cost time: 1.044593095779419
Epoch: 8, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.646 Vali Acc: 0.935 Test Loss: 0.646 Test Acc: 0.935
Validation loss decreased (-0.894585 --> -0.935129).  Saving model ...
Epoch: 9 cost time: 1.13108491897583
Epoch: 9, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.476 Vali Acc: 0.927 Test Loss: 0.476 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.220320224761963
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.364 Vali Acc: 0.938 Test Loss: 0.364 Test Acc: 0.938
Validation loss decreased (-0.935129 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 1.1313610076904297
Epoch: 11, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0635507106781006
Epoch: 12, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 1.0958280563354492
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.0968163013458252
Epoch: 14, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1286799907684326
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.0287151336669922
Epoch: 16, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0671231746673584
Epoch: 17, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.101977825164795
Epoch: 18, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1236088275909424
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.1707420349121094
Epoch: 20, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1007497310638428
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 1.0623033046722412
Epoch: 22, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.184760570526123
Epoch: 23, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0532007217407227
Epoch: 24, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0932390689849854
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.1127688884735107
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.161611795425415
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3134164810180664
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2449469566345215
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0097603797912598
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.133901596069336
Epoch: 31, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2086005210876465
Epoch: 32, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.327462911605835
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1816856861114502
Epoch: 34, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2160608768463135
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 114881
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.948117733001709
Epoch: 1, Steps: 17 | Train Loss: 2.445 Vali Loss: 2.232 Vali Acc: 0.241 Test Loss: 2.232 Test Acc: 0.241
Validation loss decreased (inf --> -0.240518).  Saving model ...
Epoch: 2 cost time: 1.2090747356414795
Epoch: 2, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.117 Vali Acc: 0.211 Test Loss: 2.117 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2724955081939697
Epoch: 3, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.968 Vali Acc: 0.514 Test Loss: 1.968 Test Acc: 0.514
Validation loss decreased (-0.240518 --> -0.513494).  Saving model ...
Epoch: 4 cost time: 1.1509816646575928
Epoch: 4, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.816 Vali Acc: 0.700 Test Loss: 1.816 Test Acc: 0.700
Validation loss decreased (-0.513494 --> -0.699982).  Saving model ...
Epoch: 5 cost time: 1.0624134540557861
Epoch: 5, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.608 Vali Acc: 0.762 Test Loss: 1.608 Test Acc: 0.762
Validation loss decreased (-0.699982 --> -0.762146).  Saving model ...
Epoch: 6 cost time: 1.0474519729614258
Epoch: 6, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.332 Vali Acc: 0.878 Test Loss: 1.332 Test Acc: 0.878
Validation loss decreased (-0.762146 --> -0.878365).  Saving model ...
Epoch: 7 cost time: 0.9872848987579346
Epoch: 7, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.058 Vali Acc: 0.881 Test Loss: 1.058 Test Acc: 0.881
Validation loss decreased (-0.878365 --> -0.881071).  Saving model ...
Epoch: 8 cost time: 1.017465591430664
Epoch: 8, Steps: 17 | Train Loss: 0.910 Vali Loss: 0.771 Vali Acc: 0.911 Test Loss: 0.771 Test Acc: 0.911
Validation loss decreased (-0.881071 --> -0.910803).  Saving model ...
Epoch: 9 cost time: 1.0386602878570557
Epoch: 9, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.546 Vali Acc: 0.922 Test Loss: 0.546 Test Acc: 0.922
Validation loss decreased (-0.910803 --> -0.921616).  Saving model ...
Epoch: 10 cost time: 1.1699633598327637
Epoch: 10, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.391 Vali Acc: 0.938 Test Loss: 0.391 Test Acc: 0.938
Validation loss decreased (-0.921616 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 1.149869441986084
Epoch: 11, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.311 Vali Acc: 0.932 Test Loss: 0.311 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1668670177459717
Epoch: 12, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.1053495407104492
Epoch: 13, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 1.2452270984649658
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1317224502563477
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 1.0039465427398682
Epoch: 16, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2770514488220215
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.1398637294769287
Epoch: 18, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0839223861694336
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.0285463333129883
Epoch: 20, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.085637092590332
Epoch: 21, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1694951057434082
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1190764904022217
Epoch: 23, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.173 Vali Acc: 0.932 Test Loss: 0.173 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1150994300842285
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 25 cost time: 1.014054298400879
Epoch: 25, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0138053894042969
Epoch: 26, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 27 cost time: 1.0785136222839355
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.95859694480896
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.954 Test Loss: 0.110 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2014615535736084
Epoch: 29, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 1.0623133182525635
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.943 Test Loss: 0.139 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2978324890136719
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0776515007019043
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 1.0442233085632324
Epoch: 33, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1789500713348389
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 35 cost time: 1.0103874206542969
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0677154064178467
Epoch: 36, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8802053928375244
Epoch: 37, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.155587911605835
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1468498706817627
Epoch: 39, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1266028881072998
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3575658798217773
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0448410511016846
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.066929817199707
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.951 Test Loss: 0.106 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1458992958068848
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 114785
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7169320583343506
Epoch: 1, Steps: 17 | Train Loss: 2.262 Vali Loss: 2.131 Vali Acc: 0.205 Test Loss: 2.131 Test Acc: 0.205
Validation loss decreased (inf --> -0.205384).  Saving model ...
Epoch: 2 cost time: 1.0041863918304443
Epoch: 2, Steps: 17 | Train Loss: 2.109 Vali Loss: 2.072 Vali Acc: 0.332 Test Loss: 2.072 Test Acc: 0.332
Validation loss decreased (-0.205384 --> -0.332412).  Saving model ...
Epoch: 3 cost time: 1.072387933731079
Epoch: 3, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.917 Vali Acc: 0.568 Test Loss: 1.917 Test Acc: 0.568
Validation loss decreased (-0.332412 --> -0.567548).  Saving model ...
Epoch: 4 cost time: 1.0430035591125488
Epoch: 4, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.747 Vali Acc: 0.743 Test Loss: 1.747 Test Acc: 0.743
Validation loss decreased (-0.567548 --> -0.743226).  Saving model ...
Epoch: 5 cost time: 1.0832855701446533
Epoch: 5, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.537 Vali Acc: 0.797 Test Loss: 1.537 Test Acc: 0.797
Validation loss decreased (-0.743226 --> -0.797282).  Saving model ...
Epoch: 6 cost time: 1.348090410232544
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.252 Vali Acc: 0.876 Test Loss: 1.252 Test Acc: 0.876
Validation loss decreased (-0.797282 --> -0.875663).  Saving model ...
Epoch: 7 cost time: 1.0672450065612793
Epoch: 7, Steps: 17 | Train Loss: 1.084 Vali Loss: 0.937 Vali Acc: 0.916 Test Loss: 0.937 Test Acc: 0.916
Validation loss decreased (-0.875663 --> -0.916207).  Saving model ...
Epoch: 8 cost time: 1.2167210578918457
Epoch: 8, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.682 Vali Acc: 0.914 Test Loss: 0.682 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.130220890045166
Epoch: 9, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.490 Vali Acc: 0.932 Test Loss: 0.490 Test Acc: 0.932
Validation loss decreased (-0.916207 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 1.2835581302642822
Epoch: 10, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.343 Vali Acc: 0.949 Test Loss: 0.343 Test Acc: 0.949
Validation loss decreased (-0.932428 --> -0.948645).  Saving model ...
Epoch: 11 cost time: 1.0381641387939453
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.275 Vali Acc: 0.943 Test Loss: 0.275 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1727592945098877
Epoch: 12, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 1.3979568481445312
Epoch: 13, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0499672889709473
Epoch: 14, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.069025993347168
Epoch: 15, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 1.2811777591705322
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.1780121326446533
Epoch: 17, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2408301830291748
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 0.9773273468017578
Epoch: 19, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0818746089935303
Epoch: 20, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.3808188438415527
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.045905590057373
Epoch: 22, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.288666009902954
Epoch: 23, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0276577472686768
Epoch: 24, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2443733215332031
Epoch: 25, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.302685022354126
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 1.039703369140625
Epoch: 27, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4390499591827393
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1819918155670166
Epoch: 29, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2494237422943115
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2557170391082764
Epoch: 31, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 32 cost time: 1.0209529399871826
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2565672397613525
Epoch: 33, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0750632286071777
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0151889324188232
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3037004470825195
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1487340927124023
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2399890422821045
Epoch: 38, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.02561616897583
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1852786540985107
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1836228370666504
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.949 Test Loss: 0.124 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 114689
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1320133209228516
Epoch: 1, Steps: 17 | Train Loss: 2.243 Vali Loss: 2.095 Vali Acc: 0.297 Test Loss: 2.095 Test Acc: 0.297
Validation loss decreased (inf --> -0.297276).  Saving model ...
Epoch: 2 cost time: 1.2692580223083496
Epoch: 2, Steps: 17 | Train Loss: 2.097 Vali Loss: 2.046 Vali Acc: 0.354 Test Loss: 2.046 Test Acc: 0.354
Validation loss decreased (-0.297276 --> -0.354034).  Saving model ...
Epoch: 3 cost time: 1.240173101425171
Epoch: 3, Steps: 17 | Train Loss: 1.977 Vali Loss: 1.904 Vali Acc: 0.624 Test Loss: 1.904 Test Acc: 0.624
Validation loss decreased (-0.354034 --> -0.624305).  Saving model ...
Epoch: 4 cost time: 1.2872662544250488
Epoch: 4, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.743 Vali Acc: 0.781 Test Loss: 1.743 Test Acc: 0.781
Validation loss decreased (-0.624305 --> -0.781064).  Saving model ...
Epoch: 5 cost time: 1.3110227584838867
Epoch: 5, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.553 Vali Acc: 0.830 Test Loss: 1.553 Test Acc: 0.830
Validation loss decreased (-0.781064 --> -0.829714).  Saving model ...
Epoch: 6 cost time: 1.315075159072876
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.273 Vali Acc: 0.892 Test Loss: 1.273 Test Acc: 0.892
Validation loss decreased (-0.829714 --> -0.891879).  Saving model ...
Epoch: 7 cost time: 1.245967149734497
Epoch: 7, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.007 Vali Acc: 0.897 Test Loss: 1.007 Test Acc: 0.897
Validation loss decreased (-0.891879 --> -0.897287).  Saving model ...
Epoch: 8 cost time: 1.3050193786621094
Epoch: 8, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.760 Vali Acc: 0.911 Test Loss: 0.760 Test Acc: 0.911
Validation loss decreased (-0.897287 --> -0.910803).  Saving model ...
Epoch: 9 cost time: 1.3810479640960693
Epoch: 9, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.553 Vali Acc: 0.938 Test Loss: 0.553 Test Acc: 0.938
Validation loss decreased (-0.910803 --> -0.937832).  Saving model ...
Epoch: 10 cost time: 1.2763893604278564
Epoch: 10, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.399 Vali Acc: 0.949 Test Loss: 0.399 Test Acc: 0.949
Validation loss decreased (-0.937832 --> -0.948645).  Saving model ...
Epoch: 11 cost time: 1.2772700786590576
Epoch: 11, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.313 Vali Acc: 0.946 Test Loss: 0.313 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2805595397949219
Epoch: 12, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.266 Vali Acc: 0.946 Test Loss: 0.266 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2809884548187256
Epoch: 13, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.236 Vali Acc: 0.954 Test Loss: 0.236 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.1049540042877197
Epoch: 14, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 15 cost time: 1.4444544315338135
Epoch: 15, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.2450175285339355
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.409003496170044
Epoch: 17, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.2076177597045898
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.2326087951660156
Epoch: 19, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1439149379730225
Epoch: 20, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2872340679168701
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 1.2451448440551758
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1278860569000244
Epoch: 23, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.290341854095459
Epoch: 24, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.4392483234405518
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5969693660736084
Epoch: 26, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2880399227142334
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2805192470550537
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.4656972885131836
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2161235809326172
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.210721731185913
Epoch: 31, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.329503059387207
Epoch: 32, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5625460147857666
Epoch: 33, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3512053489685059
Epoch: 34, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4002516269683838
Epoch: 35, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2236173152923584
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2812919616699219
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.4150526523590088
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.946 Test Loss: 0.132 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 90017
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.535475492477417
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.174 Vali Acc: 0.100 Test Loss: 2.174 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 0.9788885116577148
Epoch: 2, Steps: 17 | Train Loss: 2.152 Vali Loss: 2.029 Vali Acc: 0.411 Test Loss: 2.029 Test Acc: 0.411
Validation loss decreased (-0.099978 --> -0.410791).  Saving model ...
Epoch: 3 cost time: 1.1613678932189941
Epoch: 3, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.918 Vali Acc: 0.557 Test Loss: 1.918 Test Acc: 0.557
Validation loss decreased (-0.410791 --> -0.556738).  Saving model ...
Epoch: 4 cost time: 1.1348638534545898
Epoch: 4, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.735 Vali Acc: 0.719 Test Loss: 1.735 Test Acc: 0.719
Validation loss decreased (-0.556738 --> -0.718902).  Saving model ...
Epoch: 5 cost time: 1.0865395069122314
Epoch: 5, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.520 Vali Acc: 0.827 Test Loss: 1.520 Test Acc: 0.827
Validation loss decreased (-0.718902 --> -0.827012).  Saving model ...
Epoch: 6 cost time: 1.037858486175537
Epoch: 6, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.275 Vali Acc: 0.884 Test Loss: 1.275 Test Acc: 0.884
Validation loss decreased (-0.827012 --> -0.883771).  Saving model ...
Epoch: 7 cost time: 1.3814432621002197
Epoch: 7, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.010 Vali Acc: 0.824 Test Loss: 1.010 Test Acc: 0.824
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2190508842468262
Epoch: 8, Steps: 17 | Train Loss: 0.853 Vali Loss: 0.726 Vali Acc: 0.911 Test Loss: 0.726 Test Acc: 0.911
Validation loss decreased (-0.883771 --> -0.910804).  Saving model ...
Epoch: 9 cost time: 1.1927752494812012
Epoch: 9, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.519 Vali Acc: 0.946 Test Loss: 0.519 Test Acc: 0.946
Validation loss decreased (-0.910804 --> -0.945941).  Saving model ...
Epoch: 10 cost time: 1.0500409603118896
Epoch: 10, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.399 Vali Acc: 0.943 Test Loss: 0.399 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2260181903839111
Epoch: 11, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.297 Vali Acc: 0.943 Test Loss: 0.297 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.409834623336792
Epoch: 12, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
Validation loss decreased (-0.945941 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.0066773891448975
Epoch: 13, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.0884861946105957
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.210623025894165
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.1367602348327637
Epoch: 16, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3688769340515137
Epoch: 17, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2833521366119385
Epoch: 18, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.260237216949463
Epoch: 19, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4705023765563965
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 1.2609906196594238
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2210009098052979
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0696635246276855
Epoch: 23, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.239833116531372
Epoch: 24, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4562525749206543
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3402302265167236
Epoch: 26, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.477113962173462
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2967262268066406
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 29 cost time: 1.3724844455718994
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3203680515289307
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 31 cost time: 1.3501660823822021
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.249347448348999
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 33 cost time: 1.2074084281921387
Epoch: 33, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1827712059020996
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0268805027008057
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1490142345428467
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0776386260986328
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1689512729644775
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1102831363677979
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.143144130706787
Epoch: 40, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0572502613067627
Epoch: 41, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.138206958770752
Epoch: 42, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 89921
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.804729461669922
Epoch: 1, Steps: 17 | Train Loss: 2.313 Vali Loss: 2.226 Vali Acc: 0.127 Test Loss: 2.226 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 1.3842101097106934
Epoch: 2, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.073 Vali Acc: 0.319 Test Loss: 2.073 Test Acc: 0.319
Validation loss decreased (-0.127005 --> -0.318898).  Saving model ...
Epoch: 3 cost time: 1.1772301197052002
Epoch: 3, Steps: 17 | Train Loss: 2.042 Vali Loss: 1.968 Vali Acc: 0.568 Test Loss: 1.968 Test Acc: 0.568
Validation loss decreased (-0.318898 --> -0.567548).  Saving model ...
Epoch: 4 cost time: 1.1482954025268555
Epoch: 4, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.813 Vali Acc: 0.684 Test Loss: 1.813 Test Acc: 0.684
Validation loss decreased (-0.567548 --> -0.683766).  Saving model ...
Epoch: 5 cost time: 1.2117698192596436
Epoch: 5, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.573 Vali Acc: 0.816 Test Loss: 1.573 Test Acc: 0.816
Validation loss decreased (-0.683766 --> -0.816200).  Saving model ...
Epoch: 6 cost time: 1.164945125579834
Epoch: 6, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.388 Vali Acc: 0.830 Test Loss: 1.388 Test Acc: 0.830
Validation loss decreased (-0.816200 --> -0.829716).  Saving model ...
Epoch: 7 cost time: 1.240837812423706
Epoch: 7, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.078 Vali Acc: 0.900 Test Loss: 1.078 Test Acc: 0.900
Validation loss decreased (-0.829716 --> -0.899989).  Saving model ...
Epoch: 8 cost time: 1.225019931793213
Epoch: 8, Steps: 17 | Train Loss: 0.948 Vali Loss: 0.858 Vali Acc: 0.897 Test Loss: 0.858 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1459567546844482
Epoch: 9, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.582 Vali Acc: 0.932 Test Loss: 0.582 Test Acc: 0.932
Validation loss decreased (-0.899989 --> -0.932427).  Saving model ...
Epoch: 10 cost time: 1.1577277183532715
Epoch: 10, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.428 Vali Acc: 0.935 Test Loss: 0.428 Test Acc: 0.935
Validation loss decreased (-0.932427 --> -0.935131).  Saving model ...
Epoch: 11 cost time: 1.275744915008545
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.347 Vali Acc: 0.946 Test Loss: 0.347 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945942).  Saving model ...
Epoch: 12 cost time: 1.1930112838745117
Epoch: 12, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.285 Vali Acc: 0.943 Test Loss: 0.285 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2400121688842773
Epoch: 13, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3056056499481201
Epoch: 14, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 1.2327594757080078
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.198 Vali Acc: 0.954 Test Loss: 0.198 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 1.248500108718872
Epoch: 16, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.190324306488037
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 1.4775667190551758
Epoch: 18, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.2448017597198486
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0849056243896484
Epoch: 20, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.4667534828186035
Epoch: 21, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2405123710632324
Epoch: 22, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2072608470916748
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3449184894561768
Epoch: 24, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1811318397521973
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4023323059082031
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.2706358432769775
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1316399574279785
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1062922477722168
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5216288566589355
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4569692611694336
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2510390281677246
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2434358596801758
Epoch: 33, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1026570796966553
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2067174911499023
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.117872714996338
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 89825
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2897067070007324
Epoch: 1, Steps: 17 | Train Loss: 2.286 Vali Loss: 2.179 Vali Acc: 0.132 Test Loss: 2.179 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 1.1710577011108398
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.107 Vali Acc: 0.241 Test Loss: 2.107 Test Acc: 0.241
Validation loss decreased (-0.132411 --> -0.240519).  Saving model ...
Epoch: 3 cost time: 1.1358904838562012
Epoch: 3, Steps: 17 | Train Loss: 2.039 Vali Loss: 1.982 Vali Acc: 0.489 Test Loss: 1.982 Test Acc: 0.489
Validation loss decreased (-0.240519 --> -0.489169).  Saving model ...
Epoch: 4 cost time: 1.1641206741333008
Epoch: 4, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.815 Vali Acc: 0.773 Test Loss: 1.815 Test Acc: 0.773
Validation loss decreased (-0.489169 --> -0.772955).  Saving model ...
Epoch: 5 cost time: 1.1907391548156738
Epoch: 5, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.630 Vali Acc: 0.776 Test Loss: 1.630 Test Acc: 0.776
Validation loss decreased (-0.772955 --> -0.775659).  Saving model ...
Epoch: 6 cost time: 1.1621463298797607
Epoch: 6, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.364 Vali Acc: 0.876 Test Loss: 1.364 Test Acc: 0.876
Validation loss decreased (-0.775659 --> -0.875662).  Saving model ...
Epoch: 7 cost time: 1.129760503768921
Epoch: 7, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.094 Vali Acc: 0.892 Test Loss: 1.094 Test Acc: 0.892
Validation loss decreased (-0.875662 --> -0.891881).  Saving model ...
Epoch: 8 cost time: 0.9396445751190186
Epoch: 8, Steps: 17 | Train Loss: 0.958 Vali Loss: 0.850 Vali Acc: 0.905 Test Loss: 0.850 Test Acc: 0.905
Validation loss decreased (-0.891881 --> -0.905397).  Saving model ...
Epoch: 9 cost time: 1.179419994354248
Epoch: 9, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.593 Vali Acc: 0.927 Test Loss: 0.593 Test Acc: 0.927
Validation loss decreased (-0.905397 --> -0.927021).  Saving model ...
Epoch: 10 cost time: 1.1795096397399902
Epoch: 10, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.454 Vali Acc: 0.935 Test Loss: 0.454 Test Acc: 0.935
Validation loss decreased (-0.927021 --> -0.935131).  Saving model ...
Epoch: 11 cost time: 1.257033109664917
Epoch: 11, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.14268159866333
Epoch: 12, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 1.0769538879394531
Epoch: 13, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.239 Vali Acc: 0.946 Test Loss: 0.239 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.0353498458862305
Epoch: 14, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 0.9877090454101562
Epoch: 15, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.0029311180114746
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962160).  Saving model ...
Epoch: 17 cost time: 0.9529438018798828
Epoch: 17, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1139883995056152
Epoch: 18, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2140958309173584
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 1.227560043334961
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3692383766174316
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.038604736328125
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1336572170257568
Epoch: 23, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 1.2205810546875
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1843559741973877
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1976916790008545
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3076848983764648
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 1.1877009868621826
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.997542142868042
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0831992626190186
Epoch: 30, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.253387212753296
Epoch: 31, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0679242610931396
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2072796821594238
Epoch: 33, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1429076194763184
Epoch: 34, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1606764793395996
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2010829448699951
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0938351154327393
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_Crossformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 89729
model size : 1.02MB
