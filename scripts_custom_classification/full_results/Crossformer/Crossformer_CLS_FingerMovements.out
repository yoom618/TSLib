Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.808436632156372
Epoch: 1, Steps: 20 | Train Loss: 0.853 Vali Loss: 1.019 Vali Acc: 0.490 Test Loss: 1.019 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 3.5600743293762207
Epoch: 2, Steps: 20 | Train Loss: 0.934 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
Validation loss decreased (-0.489990 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 3.789715051651001
Epoch: 3, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.109099388122559
Epoch: 4, Steps: 20 | Train Loss: 0.864 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.134230613708496
Epoch: 5, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.960084915161133
Epoch: 6, Steps: 20 | Train Loss: 0.868 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
Validation loss decreased (-0.519991 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 4.477902412414551
Epoch: 7, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.114236831665039
Epoch: 8, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.707 Vali Acc: 0.590 Test Loss: 0.707 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589993).  Saving model ...
Epoch: 9 cost time: 4.20654034614563
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 1.037 Vali Acc: 0.490 Test Loss: 1.037 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.303220272064209
Epoch: 10, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.192092180252075
Epoch: 11, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.570091485977173
Epoch: 12, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.959 Vali Acc: 0.520 Test Loss: 0.959 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.352421045303345
Epoch: 13, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.83638858795166
Epoch: 14, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.739 Vali Acc: 0.450 Test Loss: 0.739 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9986274242401123
Epoch: 15, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9668450355529785
Epoch: 16, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.0001957416534424
Epoch: 17, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.9576094150543213
Epoch: 18, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.012 Vali Acc: 0.490 Test Loss: 1.012 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14312766
model size : 59.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.999360084533691
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.892 Vali Acc: 0.450 Test Loss: 0.892 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 3.1016860008239746
Epoch: 2, Steps: 20 | Train Loss: 0.782 Vali Loss: 1.108 Vali Acc: 0.490 Test Loss: 1.108 Test Acc: 0.490
Validation loss decreased (-0.449991 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 3.1713578701019287
Epoch: 3, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
Validation loss decreased (-0.489989 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 3.46220064163208
Epoch: 4, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 3.829651117324829
Epoch: 5, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 3.7810325622558594
Epoch: 6, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.76249098777771
Epoch: 7, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.871 Vali Acc: 0.490 Test Loss: 0.871 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.896446704864502
Epoch: 8, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.986 Vali Acc: 0.480 Test Loss: 0.986 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.024420738220215
Epoch: 9, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.0186848640441895
Epoch: 10, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.973 Vali Acc: 0.460 Test Loss: 0.973 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5940988063812256
Epoch: 11, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.696 Vali Acc: 0.580 Test Loss: 0.696 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 3.990367889404297
Epoch: 12, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.160961627960205
Epoch: 13, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9099881649017334
Epoch: 14, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8212223052978516
Epoch: 15, Steps: 20 | Train Loss: 0.786 Vali Loss: 1.212 Vali Acc: 0.450 Test Loss: 1.212 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.884333372116089
Epoch: 16, Steps: 20 | Train Loss: 0.962 Vali Loss: 0.883 Vali Acc: 0.480 Test Loss: 0.883 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9541661739349365
Epoch: 17, Steps: 20 | Train Loss: 0.886 Vali Loss: 1.097 Vali Acc: 0.440 Test Loss: 1.097 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.491819381713867
Epoch: 18, Steps: 20 | Train Loss: 0.922 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.8017890453338623
Epoch: 19, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.120413780212402
Epoch: 20, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.2670352458953857
Epoch: 21, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14309950
model size : 59.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.099926471710205
Epoch: 1, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.9004154205322266
Epoch: 2, Steps: 20 | Train Loss: 0.893 Vali Loss: 1.122 Vali Acc: 0.490 Test Loss: 1.122 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.676879644393921
Epoch: 3, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.608942747116089
Epoch: 4, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.921 Vali Acc: 0.490 Test Loss: 0.921 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.331172227859497
Epoch: 5, Steps: 20 | Train Loss: 0.853 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7289884090423584
Epoch: 6, Steps: 20 | Train Loss: 0.881 Vali Loss: 1.395 Vali Acc: 0.490 Test Loss: 1.395 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8952863216400146
Epoch: 7, Steps: 20 | Train Loss: 1.011 Vali Loss: 1.162 Vali Acc: 0.490 Test Loss: 1.162 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.826855182647705
Epoch: 8, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 3.257718324661255
Epoch: 9, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 3.8462636470794678
Epoch: 10, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.214889764785767
Epoch: 11, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.900 Vali Acc: 0.430 Test Loss: 0.900 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.871549129486084
Epoch: 12, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.095739364624023
Epoch: 13, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8234763145446777
Epoch: 14, Steps: 20 | Train Loss: 0.795 Vali Loss: 1.091 Vali Acc: 0.510 Test Loss: 1.091 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.0718488693237305
Epoch: 15, Steps: 20 | Train Loss: 0.873 Vali Loss: 1.055 Vali Acc: 0.490 Test Loss: 1.055 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.148167848587036
Epoch: 16, Steps: 20 | Train Loss: 1.062 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9260385036468506
Epoch: 17, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.9199347496032715
Epoch: 18, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.791 Vali Acc: 0.590 Test Loss: 0.791 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589992).  Saving model ...
Epoch: 19 cost time: 3.534376382827759
Epoch: 19, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5486502647399902
Epoch: 20, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.166723012924194
Epoch: 21, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.697 Vali Acc: 0.430 Test Loss: 0.697 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.151794195175171
Epoch: 22, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.931 Vali Acc: 0.490 Test Loss: 0.931 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9850728511810303
Epoch: 23, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.8303449153900146
Epoch: 24, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.840 Vali Acc: 0.510 Test Loss: 0.840 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.5832788944244385
Epoch: 25, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8770952224731445
Epoch: 26, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.4445526599884033
Epoch: 27, Steps: 20 | Train Loss: 0.856 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.8131115436553955
Epoch: 28, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14307134
model size : 59.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.518491268157959
Epoch: 1, Steps: 20 | Train Loss: 0.844 Vali Loss: 0.960 Vali Acc: 0.480 Test Loss: 0.960 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 2.658350944519043
Epoch: 2, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.707 Vali Acc: 0.610 Test Loss: 0.707 Test Acc: 0.610
Validation loss decreased (-0.479990 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 3.265158176422119
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2230989933013916
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.798 Vali Acc: 0.480 Test Loss: 0.798 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6671547889709473
Epoch: 5, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6336920261383057
Epoch: 6, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9363560676574707
Epoch: 7, Steps: 20 | Train Loss: 0.855 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.890942335128784
Epoch: 8, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.009618282318115
Epoch: 9, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9053378105163574
Epoch: 10, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.898 Vali Acc: 0.510 Test Loss: 0.898 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.039211273193359
Epoch: 11, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1926441192626953
Epoch: 12, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14304318
model size : 59.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.48024845123291
Epoch: 1, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.999 Vali Acc: 0.490 Test Loss: 0.999 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 3.9334874153137207
Epoch: 2, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.489990 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 3.2493908405303955
Epoch: 3, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6451895236968994
Epoch: 4, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8147025108337402
Epoch: 5, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.464041233062744
Epoch: 6, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.157871961593628
Epoch: 7, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.909 Vali Acc: 0.480 Test Loss: 0.909 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.145659685134888
Epoch: 8, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.301753044128418
Epoch: 9, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.920 Vali Acc: 0.520 Test Loss: 0.920 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9789717197418213
Epoch: 10, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.138972043991089
Epoch: 11, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.491728782653809
Epoch: 12, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.075 Vali Acc: 0.490 Test Loss: 1.075 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 11948862
model size : 50.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.639658689498901
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.776 Vali Acc: 0.420 Test Loss: 0.776 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 4.030805587768555
Epoch: 2, Steps: 20 | Train Loss: 0.905 Vali Loss: 1.109 Vali Acc: 0.470 Test Loss: 1.109 Test Acc: 0.470
Validation loss decreased (-0.419992 --> -0.469989).  Saving model ...
Epoch: 3 cost time: 4.039997339248657
Epoch: 3, Steps: 20 | Train Loss: 0.762 Vali Loss: 1.092 Vali Acc: 0.490 Test Loss: 1.092 Test Acc: 0.490
Validation loss decreased (-0.469989 --> -0.489989).  Saving model ...
Epoch: 4 cost time: 3.223989486694336
Epoch: 4, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (-0.489989 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 4.029030799865723
Epoch: 5, Steps: 20 | Train Loss: 0.860 Vali Loss: 1.299 Vali Acc: 0.510 Test Loss: 1.299 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.70699143409729
Epoch: 6, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5468735694885254
Epoch: 7, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.734 Vali Acc: 0.580 Test Loss: 0.734 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 4.112346410751343
Epoch: 8, Steps: 20 | Train Loss: 1.024 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9859206676483154
Epoch: 9, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.030019521713257
Epoch: 10, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.009713888168335
Epoch: 11, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.935 Vali Acc: 0.420 Test Loss: 0.935 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.92818546295166
Epoch: 12, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.5538504123687744
Epoch: 13, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.818 Vali Acc: 0.490 Test Loss: 0.818 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.558868408203125
Epoch: 14, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9343202114105225
Epoch: 15, Steps: 20 | Train Loss: 0.881 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.401977777481079
Epoch: 16, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.256875276565552
Epoch: 17, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.888 Vali Acc: 0.490 Test Loss: 0.888 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 11946046
model size : 50.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.909966707229614
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.315 Vali Acc: 0.510 Test Loss: 1.315 Test Acc: 0.510
Validation loss decreased (inf --> -0.509987).  Saving model ...
Epoch: 2 cost time: 2.8361167907714844
Epoch: 2, Steps: 20 | Train Loss: 0.927 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.41337251663208
Epoch: 3, Steps: 20 | Train Loss: 0.867 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.638442277908325
Epoch: 4, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.684969663619995
Epoch: 5, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
Validation loss decreased (-0.509987 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 3.941222667694092
Epoch: 6, Steps: 20 | Train Loss: 0.883 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9133944511413574
Epoch: 7, Steps: 20 | Train Loss: 0.797 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9325649738311768
Epoch: 8, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 3.437809467315674
Epoch: 9, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 3.91441011428833
Epoch: 10, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.024377107620239
Epoch: 11, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3644442558288574
Epoch: 12, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.060030698776245
Epoch: 13, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.818866491317749
Epoch: 14, Steps: 20 | Train Loss: 0.811 Vali Loss: 1.533 Vali Acc: 0.480 Test Loss: 1.533 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.241997480392456
Epoch: 15, Steps: 20 | Train Loss: 0.909 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 16 cost time: 3.930987596511841
Epoch: 16, Steps: 20 | Train Loss: 0.762 Vali Loss: 1.044 Vali Acc: 0.510 Test Loss: 1.044 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9213833808898926
Epoch: 17, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7048497200012207
Epoch: 18, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5606186389923096
Epoch: 19, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.614309787750244
Epoch: 20, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.9996721744537354
Epoch: 21, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.872 Vali Acc: 0.460 Test Loss: 0.872 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.008781433105469
Epoch: 22, Steps: 20 | Train Loss: 0.827 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.706278085708618
Epoch: 23, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.784012794494629
Epoch: 24, Steps: 20 | Train Loss: 0.795 Vali Loss: 1.069 Vali Acc: 0.530 Test Loss: 1.069 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.888589382171631
Epoch: 25, Steps: 20 | Train Loss: 0.958 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 11943230
model size : 50.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.520990610122681
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 1.059 Vali Acc: 0.420 Test Loss: 1.059 Test Acc: 0.420
Validation loss decreased (inf --> -0.419989).  Saving model ...
Epoch: 2 cost time: 3.8327178955078125
Epoch: 2, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
Validation loss decreased (-0.419989 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.6813783645629883
Epoch: 3, Steps: 20 | Train Loss: 0.871 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.907094717025757
Epoch: 4, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.630105495452881
Epoch: 5, Steps: 20 | Train Loss: 0.792 Vali Loss: 1.672 Vali Acc: 0.510 Test Loss: 1.672 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.381197929382324
Epoch: 6, Steps: 20 | Train Loss: 1.034 Vali Loss: 1.026 Vali Acc: 0.490 Test Loss: 1.026 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.045098543167114
Epoch: 7, Steps: 20 | Train Loss: 0.794 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 3.867419481277466
Epoch: 8, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7868919372558594
Epoch: 9, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 10 cost time: 3.8044562339782715
Epoch: 10, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.689 Vali Acc: 0.530 Test Loss: 0.689 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8143868446350098
Epoch: 11, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.791 Vali Acc: 0.480 Test Loss: 0.791 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8686587810516357
Epoch: 12, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.667 Vali Acc: 0.580 Test Loss: 0.667 Test Acc: 0.580
Validation loss decreased (-0.579993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 3.27224063873291
Epoch: 13, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.955980062484741
Epoch: 14, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8600730895996094
Epoch: 15, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.352947473526001
Epoch: 16, Steps: 20 | Train Loss: 0.759 Vali Loss: 1.317 Vali Acc: 0.490 Test Loss: 1.317 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6347479820251465
Epoch: 17, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.882218837738037
Epoch: 18, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.677 Vali Acc: 0.540 Test Loss: 0.677 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.014698266983032
Epoch: 19, Steps: 20 | Train Loss: 0.743 Vali Loss: 1.178 Vali Acc: 0.450 Test Loss: 1.178 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8199782371520996
Epoch: 20, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2812411785125732
Epoch: 21, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6207406520843506
Epoch: 22, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 11940414
model size : 50.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.462690591812134
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.884 Vali Acc: 0.490 Test Loss: 0.884 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.9378552436828613
Epoch: 2, Steps: 20 | Train Loss: 0.826 Vali Loss: 1.139 Vali Acc: 0.490 Test Loss: 1.139 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7121691703796387
Epoch: 3, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.693 Vali Acc: 0.580 Test Loss: 0.693 Test Acc: 0.580
Validation loss decreased (-0.489991 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 3.813154935836792
Epoch: 4, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3289954662323
Epoch: 5, Steps: 20 | Train Loss: 0.858 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.050034046173096
Epoch: 6, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6172423362731934
Epoch: 7, Steps: 20 | Train Loss: 0.851 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.95314884185791
Epoch: 8, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.912 Vali Acc: 0.480 Test Loss: 0.912 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.878795623779297
Epoch: 9, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.8826744556427
Epoch: 10, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.953732967376709
Epoch: 11, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1154775619506836
Epoch: 12, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.756 Vali Acc: 0.460 Test Loss: 0.756 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9472646713256836
Epoch: 13, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.818 Vali Acc: 0.450 Test Loss: 0.818 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 10766910
model size : 46.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.371779918670654
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.6698355674743652
Epoch: 2, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 3.92150616645813
Epoch: 3, Steps: 20 | Train Loss: 0.858 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 3.2079808712005615
Epoch: 4, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.882 Vali Acc: 0.470 Test Loss: 0.882 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0905354022979736
Epoch: 5, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.379831552505493
Epoch: 6, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 3.8575692176818848
Epoch: 7, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.675 Vali Acc: 0.590 Test Loss: 0.675 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 3.691091775894165
Epoch: 8, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9690232276916504
Epoch: 9, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.885399103164673
Epoch: 10, Steps: 20 | Train Loss: 0.868 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6522042751312256
Epoch: 11, Steps: 20 | Train Loss: 0.861 Vali Loss: 1.007 Vali Acc: 0.540 Test Loss: 1.007 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.227128267288208
Epoch: 12, Steps: 20 | Train Loss: 0.797 Vali Loss: 0.865 Vali Acc: 0.440 Test Loss: 0.865 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.5382907390594482
Epoch: 13, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.685 Vali Acc: 0.600 Test Loss: 0.685 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 3.9363954067230225
Epoch: 14, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5448243618011475
Epoch: 15, Steps: 20 | Train Loss: 0.918 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.466128349304199
Epoch: 16, Steps: 20 | Train Loss: 0.852 Vali Loss: 1.075 Vali Acc: 0.470 Test Loss: 1.075 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6903767585754395
Epoch: 17, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.900 Vali Acc: 0.530 Test Loss: 0.900 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.479956865310669
Epoch: 18, Steps: 20 | Train Loss: 0.729 Vali Loss: 1.172 Vali Acc: 0.430 Test Loss: 1.172 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5992791652679443
Epoch: 19, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.821 Vali Acc: 0.480 Test Loss: 0.821 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.467068910598755
Epoch: 20, Steps: 20 | Train Loss: 0.746 Vali Loss: 1.141 Vali Acc: 0.440 Test Loss: 1.141 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.524766445159912
Epoch: 21, Steps: 20 | Train Loss: 0.862 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2779481410980225
Epoch: 22, Steps: 20 | Train Loss: 0.831 Vali Loss: 1.022 Vali Acc: 0.440 Test Loss: 1.022 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.4706015586853027
Epoch: 23, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.838 Vali Acc: 0.540 Test Loss: 0.838 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10764094
model size : 46.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.626050233840942
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.254782676696777
Epoch: 2, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.298407316207886
Epoch: 3, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.814 Vali Acc: 0.570 Test Loss: 0.814 Test Acc: 0.570
Validation loss decreased (-0.489992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 4.153608322143555
Epoch: 4, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.188279867172241
Epoch: 5, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.873 Vali Acc: 0.490 Test Loss: 0.873 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6586766242980957
Epoch: 6, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5465567111968994
Epoch: 7, Steps: 20 | Train Loss: 0.756 Vali Loss: 1.003 Vali Acc: 0.510 Test Loss: 1.003 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5323808193206787
Epoch: 8, Steps: 20 | Train Loss: 0.819 Vali Loss: 0.712 Vali Acc: 0.430 Test Loss: 0.712 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.858914375305176
Epoch: 9, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.853900194168091
Epoch: 10, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.839 Vali Acc: 0.460 Test Loss: 0.839 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8984639644622803
Epoch: 11, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.938131809234619
Epoch: 12, Steps: 20 | Train Loss: 0.822 Vali Loss: 1.099 Vali Acc: 0.490 Test Loss: 1.099 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.003774404525757
Epoch: 13, Steps: 20 | Train Loss: 0.912 Vali Loss: 0.984 Vali Acc: 0.500 Test Loss: 0.984 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 10761278
model size : 46.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.332114934921265
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 1.439 Vali Acc: 0.440 Test Loss: 1.439 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 3.6652934551239014
Epoch: 2, Steps: 20 | Train Loss: 1.111 Vali Loss: 0.888 Vali Acc: 0.510 Test Loss: 0.888 Test Acc: 0.510
Validation loss decreased (-0.439986 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 3.8405420780181885
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.868 Vali Acc: 0.490 Test Loss: 0.868 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8580191135406494
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.44974422454834
Epoch: 5, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.920 Vali Acc: 0.500 Test Loss: 0.920 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3417093753814697
Epoch: 6, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.259892463684082
Epoch: 7, Steps: 20 | Train Loss: 0.897 Vali Loss: 1.971 Vali Acc: 0.490 Test Loss: 1.971 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7756507396698
Epoch: 8, Steps: 20 | Train Loss: 0.897 Vali Loss: 0.970 Vali Acc: 0.470 Test Loss: 0.970 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.9436371326446533
Epoch: 9, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 3.845559597015381
Epoch: 10, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9322052001953125
Epoch: 11, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.883535146713257
Epoch: 12, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7262465953826904
Epoch: 13, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0891265869140625
Epoch: 14, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.687 Vali Acc: 0.560 Test Loss: 0.687 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 3.5361671447753906
Epoch: 15, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8193368911743164
Epoch: 16, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.723 Vali Acc: 0.450 Test Loss: 0.723 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.980849504470825
Epoch: 17, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.0558483600616455
Epoch: 18, Steps: 20 | Train Loss: 0.903 Vali Loss: 0.865 Vali Acc: 0.470 Test Loss: 0.865 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8034329414367676
Epoch: 19, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6938583850860596
Epoch: 20, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.851 Vali Acc: 0.510 Test Loss: 0.851 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3776731491088867
Epoch: 21, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.813772678375244
Epoch: 22, Steps: 20 | Train Loss: 0.787 Vali Loss: 1.105 Vali Acc: 0.510 Test Loss: 1.105 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.041943788528442
Epoch: 23, Steps: 20 | Train Loss: 0.911 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1666934490203857
Epoch: 24, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.861 Vali Acc: 0.460 Test Loss: 0.861 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 10758462
model size : 46.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.142977952957153
Epoch: 1, Steps: 20 | Train Loss: 0.872 Vali Loss: 0.903 Vali Acc: 0.470 Test Loss: 0.903 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 3.619671583175659
Epoch: 2, Steps: 20 | Train Loss: 0.819 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
Validation loss decreased (-0.469991 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 3.29144287109375
Epoch: 3, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.724052906036377
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.869 Vali Acc: 0.480 Test Loss: 0.869 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.771400213241577
Epoch: 5, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 3.611436605453491
Epoch: 6, Steps: 20 | Train Loss: 0.732 Vali Loss: 1.016 Vali Acc: 0.490 Test Loss: 1.016 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5895609855651855
Epoch: 7, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.776 Vali Acc: 0.470 Test Loss: 0.776 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.462434768676758
Epoch: 8, Steps: 20 | Train Loss: 0.885 Vali Loss: 1.465 Vali Acc: 0.490 Test Loss: 1.465 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.566314697265625
Epoch: 9, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.828 Vali Acc: 0.470 Test Loss: 0.828 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2087130546569824
Epoch: 10, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.622133731842041
Epoch: 11, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5218563079833984
Epoch: 12, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.997 Vali Acc: 0.490 Test Loss: 0.997 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8519976139068604
Epoch: 13, Steps: 20 | Train Loss: 0.925 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.928907871246338
Epoch: 14, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.745 Vali Acc: 0.570 Test Loss: 0.745 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 15 cost time: 3.737344980239868
Epoch: 15, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.937 Vali Acc: 0.470 Test Loss: 0.937 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6260368824005127
Epoch: 16, Steps: 20 | Train Loss: 0.849 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8721415996551514
Epoch: 17, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.826143264770508
Epoch: 18, Steps: 20 | Train Loss: 0.872 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5897274017333984
Epoch: 19, Steps: 20 | Train Loss: 0.780 Vali Loss: 1.669 Vali Acc: 0.520 Test Loss: 1.669 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4190187454223633
Epoch: 20, Steps: 20 | Train Loss: 0.851 Vali Loss: 1.007 Vali Acc: 0.490 Test Loss: 1.007 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.7911994457244873
Epoch: 21, Steps: 20 | Train Loss: 0.929 Vali Loss: 1.168 Vali Acc: 0.510 Test Loss: 1.168 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3115830421447754
Epoch: 22, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.5562119483947754
Epoch: 23, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.915 Vali Acc: 0.490 Test Loss: 0.915 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.601778268814087
Epoch: 24, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.770 Vali Acc: 0.470 Test Loss: 0.770 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 10175934
model size : 43.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.793996810913086
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.640113592147827
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.791 Vali Acc: 0.600 Test Loss: 0.791 Test Acc: 0.600
Validation loss decreased (-0.489991 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 3.5943186283111572
Epoch: 3, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.815 Vali Acc: 0.480 Test Loss: 0.815 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4779815673828125
Epoch: 4, Steps: 20 | Train Loss: 0.825 Vali Loss: 0.804 Vali Acc: 0.500 Test Loss: 0.804 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.407560348510742
Epoch: 5, Steps: 20 | Train Loss: 0.956 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.589247941970825
Epoch: 6, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5785014629364014
Epoch: 7, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.938 Vali Acc: 0.490 Test Loss: 0.938 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.478978157043457
Epoch: 8, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.683298349380493
Epoch: 9, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.2954909801483154
Epoch: 10, Steps: 20 | Train Loss: 1.072 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3853530883789062
Epoch: 11, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.831 Vali Acc: 0.490 Test Loss: 0.831 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8712244033813477
Epoch: 12, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.922 Vali Acc: 0.520 Test Loss: 0.922 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10173118
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.450461387634277
Epoch: 1, Steps: 20 | Train Loss: 0.809 Vali Loss: 0.915 Vali Acc: 0.490 Test Loss: 0.915 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.4777050018310547
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.827 Vali Acc: 0.470 Test Loss: 0.827 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7022204399108887
Epoch: 3, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.012 Vali Acc: 0.450 Test Loss: 1.012 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3198657035827637
Epoch: 4, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 3.6750926971435547
Epoch: 5, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 3.84322452545166
Epoch: 6, Steps: 20 | Train Loss: 0.887 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.850674629211426
Epoch: 7, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.679 Vali Acc: 0.570 Test Loss: 0.679 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 3.9030892848968506
Epoch: 8, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.99674654006958
Epoch: 9, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6961326599121094
Epoch: 10, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7914834022521973
Epoch: 11, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.117 Vali Acc: 0.520 Test Loss: 1.117 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.661677837371826
Epoch: 12, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.936 Vali Acc: 0.510 Test Loss: 0.936 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4773292541503906
Epoch: 13, Steps: 20 | Train Loss: 0.723 Vali Loss: 1.013 Vali Acc: 0.470 Test Loss: 1.013 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.006498575210571
Epoch: 14, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.8655202388763428
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 1.362 Vali Acc: 0.510 Test Loss: 1.362 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8329970836639404
Epoch: 16, Steps: 20 | Train Loss: 0.862 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9873764514923096
Epoch: 17, Steps: 20 | Train Loss: 0.831 Vali Loss: 0.904 Vali Acc: 0.580 Test Loss: 0.904 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 18 cost time: 3.614342451095581
Epoch: 18, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.739670753479004
Epoch: 19, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.910 Vali Acc: 0.460 Test Loss: 0.910 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8926169872283936
Epoch: 20, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.770683526992798
Epoch: 21, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.863 Vali Acc: 0.500 Test Loss: 0.863 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.81677508354187
Epoch: 22, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.7233407497406006
Epoch: 23, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.961 Vali Acc: 0.470 Test Loss: 0.961 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.9995412826538086
Epoch: 24, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.983919620513916
Epoch: 25, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.6410727500915527
Epoch: 26, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.6491270065307617
Epoch: 27, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.988 Vali Acc: 0.470 Test Loss: 0.988 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 10170302
model size : 43.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.001933574676514
Epoch: 1, Steps: 20 | Train Loss: 0.915 Vali Loss: 1.010 Vali Acc: 0.500 Test Loss: 1.010 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 3.64426851272583
Epoch: 2, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.644265651702881
Epoch: 3, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 3.6765613555908203
Epoch: 4, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.875807523727417
Epoch: 5, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.933 Vali Acc: 0.490 Test Loss: 0.933 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1364028453826904
Epoch: 6, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 3.183878183364868
Epoch: 7, Steps: 20 | Train Loss: 0.876 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8559014797210693
Epoch: 8, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4184153079986572
Epoch: 9, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 3.7525436878204346
Epoch: 10, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.827277898788452
Epoch: 11, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.967 Vali Acc: 0.520 Test Loss: 0.967 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.896660566329956
Epoch: 12, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6631908416748047
Epoch: 13, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.249 Vali Acc: 0.480 Test Loss: 1.249 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.599425792694092
Epoch: 14, Steps: 20 | Train Loss: 0.893 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4532549381256104
Epoch: 15, Steps: 20 | Train Loss: 0.755 Vali Loss: 1.622 Vali Acc: 0.470 Test Loss: 1.622 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8480565547943115
Epoch: 16, Steps: 20 | Train Loss: 0.904 Vali Loss: 1.228 Vali Acc: 0.490 Test Loss: 1.228 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5855681896209717
Epoch: 17, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.6907246112823486
Epoch: 18, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.863 Vali Acc: 0.480 Test Loss: 0.863 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.654921293258667
Epoch: 19, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 10167486
model size : 43.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.783020257949829
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.7387607097625732
Epoch: 2, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8722214698791504
Epoch: 3, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.941685438156128
Epoch: 4, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 3.771303653717041
Epoch: 5, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.731933355331421
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4630298614501953
Epoch: 7, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 8 cost time: 3.6281797885894775
Epoch: 8, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 3.808371067047119
Epoch: 9, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8683829307556152
Epoch: 10, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.688 Vali Acc: 0.600 Test Loss: 0.688 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 3.8684349060058594
Epoch: 11, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.874267101287842
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6441357135772705
Epoch: 13, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.733 Vali Acc: 0.590 Test Loss: 0.733 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.931191921234131
Epoch: 14, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5220446586608887
Epoch: 15, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2175872325897217
Epoch: 16, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.724 Vali Acc: 0.590 Test Loss: 0.724 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.9352352619171143
Epoch: 17, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.837 Vali Acc: 0.450 Test Loss: 0.837 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9111568927764893
Epoch: 18, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.838 Vali Acc: 0.440 Test Loss: 0.838 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.9628498554229736
Epoch: 19, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.8089563846588135
Epoch: 20, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4801726
model size : 20.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.096967458724976
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.177494525909424
Epoch: 2, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.816 Vali Acc: 0.510 Test Loss: 0.816 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 4.054041624069214
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 1.139 Vali Acc: 0.490 Test Loss: 1.139 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8920562267303467
Epoch: 4, Steps: 20 | Train Loss: 0.846 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6321253776550293
Epoch: 5, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.820786714553833
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9950833320617676
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 3.322293758392334
Epoch: 8, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.837928056716919
Epoch: 9, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.849 Vali Acc: 0.450 Test Loss: 0.849 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.179707765579224
Epoch: 10, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.001 Vali Acc: 0.480 Test Loss: 1.001 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7399110794067383
Epoch: 11, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.884 Vali Acc: 0.490 Test Loss: 0.884 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7400920391082764
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.649 Vali Acc: 0.620 Test Loss: 0.649 Test Acc: 0.620
Validation loss decreased (-0.509993 --> -0.619994).  Saving model ...
Epoch: 13 cost time: 3.6323564052581787
Epoch: 13, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.810 Vali Acc: 0.460 Test Loss: 0.810 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.892554759979248
Epoch: 14, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.866 Vali Acc: 0.490 Test Loss: 0.866 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.772141218185425
Epoch: 15, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7162208557128906
Epoch: 16, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.014 Vali Acc: 0.490 Test Loss: 1.014 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.798572301864624
Epoch: 17, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.976 Vali Acc: 0.410 Test Loss: 0.976 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.986409902572632
Epoch: 18, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8192453384399414
Epoch: 19, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8400044441223145
Epoch: 20, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.886 Vali Acc: 0.490 Test Loss: 0.886 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.16153883934021
Epoch: 21, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.911 Vali Acc: 0.480 Test Loss: 0.911 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.243123292922974
Epoch: 22, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4800318
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.791384220123291
Epoch: 1, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 4.2025463581085205
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2337095737457275
Epoch: 3, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.862985134124756
Epoch: 4, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.844 Vali Acc: 0.470 Test Loss: 0.844 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.1333677768707275
Epoch: 5, Steps: 20 | Train Loss: 0.795 Vali Loss: 1.022 Vali Acc: 0.510 Test Loss: 1.022 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2472119331359863
Epoch: 6, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.713 Vali Acc: 0.440 Test Loss: 0.713 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.612483263015747
Epoch: 7, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.068143129348755
Epoch: 8, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 3.724020004272461
Epoch: 9, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 3.857546091079712
Epoch: 10, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0794689655303955
Epoch: 11, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.713364601135254
Epoch: 12, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.874488592147827
Epoch: 13, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.00510311126709
Epoch: 14, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8927361965179443
Epoch: 15, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8064963817596436
Epoch: 16, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.812 Vali Acc: 0.440 Test Loss: 0.812 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9772233963012695
Epoch: 17, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.091372489929199
Epoch: 18, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 19 cost time: 4.018273830413818
Epoch: 19, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9036636352539062
Epoch: 20, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.896 Vali Acc: 0.450 Test Loss: 0.896 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.337707281112671
Epoch: 21, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.927 Vali Acc: 0.500 Test Loss: 0.927 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.205363988876343
Epoch: 22, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.082598447799683
Epoch: 23, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.258021831512451
Epoch: 24, Steps: 20 | Train Loss: 0.640 Vali Loss: 1.056 Vali Acc: 0.480 Test Loss: 1.056 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.9565696716308594
Epoch: 25, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8050968647003174
Epoch: 26, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.919 Vali Acc: 0.430 Test Loss: 0.919 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.9732279777526855
Epoch: 27, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.107203960418701
Epoch: 28, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4798910
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.393162727355957
Epoch: 1, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.158268690109253
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.702 Vali Acc: 0.570 Test Loss: 0.702 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 3.864715337753296
Epoch: 3, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.923860788345337
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7459545135498047
Epoch: 5, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6969850063323975
Epoch: 6, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7201850414276123
Epoch: 7, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.644402503967285
Epoch: 8, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.108649969100952
Epoch: 9, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8607211112976074
Epoch: 10, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.9071478843688965
Epoch: 11, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.863 Vali Acc: 0.490 Test Loss: 0.863 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7398314476013184
Epoch: 12, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4797502
model size : 20.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.89747166633606
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.926 Vali Acc: 0.480 Test Loss: 0.926 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 3.8268280029296875
Epoch: 2, Steps: 20 | Train Loss: 0.875 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
Validation loss decreased (-0.479991 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.721323013305664
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.800 Vali Acc: 0.450 Test Loss: 0.800 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9786219596862793
Epoch: 4, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.567805528640747
Epoch: 5, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5436933040618896
Epoch: 6, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.554135322570801
Epoch: 7, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5842502117156982
Epoch: 8, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6487624645233154
Epoch: 9, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.986 Vali Acc: 0.500 Test Loss: 0.986 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4026987552642822
Epoch: 10, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.697 Vali Acc: 0.570 Test Loss: 0.697 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 2.484816074371338
Epoch: 11, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3945302963256836
Epoch: 12, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.584646463394165
Epoch: 13, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.869117498397827
Epoch: 14, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.977 Vali Acc: 0.490 Test Loss: 0.977 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.89463472366333
Epoch: 15, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.791 Vali Acc: 0.460 Test Loss: 0.791 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5829343795776367
Epoch: 16, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2609670162200928
Epoch: 17, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.265366792678833
Epoch: 18, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.9538376331329346
Epoch: 19, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.8689417839050293
Epoch: 20, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3617470
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.724595546722412
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.643281936645508
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.230438709259033
Epoch: 3, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.651841402053833
Epoch: 4, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.880434274673462
Epoch: 5, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.76694917678833
Epoch: 6, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.850 Vali Acc: 0.490 Test Loss: 0.850 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0464422702789307
Epoch: 7, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5125460624694824
Epoch: 8, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 3.9143800735473633
Epoch: 9, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.850827932357788
Epoch: 10, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.665351152420044
Epoch: 11, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 3.6185030937194824
Epoch: 12, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.875 Vali Acc: 0.490 Test Loss: 0.875 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6445260047912598
Epoch: 13, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7983715534210205
Epoch: 14, Steps: 20 | Train Loss: 0.820 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.359961986541748
Epoch: 15, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.022744655609131
Epoch: 16, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7889902591705322
Epoch: 17, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.846 Vali Acc: 0.530 Test Loss: 0.846 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.951852798461914
Epoch: 18, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.892 Vali Acc: 0.530 Test Loss: 0.892 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.849721670150757
Epoch: 19, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.886 Vali Acc: 0.500 Test Loss: 0.886 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.4642512798309326
Epoch: 20, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.779 Vali Acc: 0.470 Test Loss: 0.779 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.899388074874878
Epoch: 21, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.832 Vali Acc: 0.520 Test Loss: 0.832 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3616062
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.500877380371094
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.361908197402954
Epoch: 2, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 3.5179226398468018
Epoch: 3, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.584251880645752
Epoch: 4, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2777013778686523
Epoch: 5, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.941 Vali Acc: 0.490 Test Loss: 0.941 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7699849605560303
Epoch: 6, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.697 Vali Acc: 0.540 Test Loss: 0.697 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.991384267807007
Epoch: 7, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2632415294647217
Epoch: 8, Steps: 20 | Train Loss: 0.986 Vali Loss: 0.804 Vali Acc: 0.530 Test Loss: 0.804 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4954817295074463
Epoch: 9, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.145714521408081
Epoch: 10, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.082145929336548
Epoch: 11, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.801166296005249
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.804 Vali Acc: 0.440 Test Loss: 0.804 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3614654
model size : 16.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.491972208023071
Epoch: 1, Steps: 20 | Train Loss: 0.962 Vali Loss: 1.189 Vali Acc: 0.510 Test Loss: 1.189 Test Acc: 0.510
Validation loss decreased (inf --> -0.509988).  Saving model ...
Epoch: 2 cost time: 3.9722626209259033
Epoch: 2, Steps: 20 | Train Loss: 0.869 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.76882004737854
Epoch: 3, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.739 Vali Acc: 0.450 Test Loss: 0.739 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8746297359466553
Epoch: 4, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5515248775482178
Epoch: 5, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
Validation loss decreased (-0.509988 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 3.0167124271392822
Epoch: 6, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.726 Vali Acc: 0.560 Test Loss: 0.726 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 3.0428178310394287
Epoch: 7, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.275040626525879
Epoch: 8, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.733520030975342
Epoch: 9, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.861921787261963
Epoch: 10, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.272517919540405
Epoch: 11, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.712 Vali Acc: 0.590 Test Loss: 0.712 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 12 cost time: 3.7583675384521484
Epoch: 12, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.745513439178467
Epoch: 13, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.66402530670166
Epoch: 14, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.936 Vali Acc: 0.490 Test Loss: 0.936 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8493151664733887
Epoch: 15, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.905 Vali Acc: 0.460 Test Loss: 0.905 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1084516048431396
Epoch: 16, Steps: 20 | Train Loss: 0.712 Vali Loss: 1.151 Vali Acc: 0.470 Test Loss: 1.151 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9941158294677734
Epoch: 17, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.923 Vali Acc: 0.480 Test Loss: 0.923 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.9021899700164795
Epoch: 18, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.662688970565796
Epoch: 19, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.156712055206299
Epoch: 20, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.015 Vali Acc: 0.410 Test Loss: 1.015 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.275529146194458
Epoch: 21, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3613246
model size : 16.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.170624732971191
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.136289358139038
Epoch: 2, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9407217502593994
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.786 Vali Acc: 0.470 Test Loss: 0.786 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7303783893585205
Epoch: 4, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 3.9574968814849854
Epoch: 5, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.905736207962036
Epoch: 6, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9123799800872803
Epoch: 7, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 3.560241222381592
Epoch: 8, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 3.583019733428955
Epoch: 9, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9493517875671387
Epoch: 10, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8278040885925293
Epoch: 11, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.784 Vali Acc: 0.470 Test Loss: 0.784 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.053403615951538
Epoch: 12, Steps: 20 | Train Loss: 0.761 Vali Loss: 1.039 Vali Acc: 0.510 Test Loss: 1.039 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9861526489257812
Epoch: 13, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 3.7707395553588867
Epoch: 14, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5361247062683105
Epoch: 15, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 3.569798231124878
Epoch: 16, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8650400638580322
Epoch: 17, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.899 Vali Acc: 0.570 Test Loss: 0.899 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569991).  Saving model ...
Epoch: 18 cost time: 3.9706811904907227
Epoch: 18, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579992).  Saving model ...
Epoch: 19 cost time: 3.799203872680664
Epoch: 19, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.931 Vali Acc: 0.450 Test Loss: 0.931 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6963887214660645
Epoch: 20, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.920 Vali Acc: 0.430 Test Loss: 0.920 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6076202392578125
Epoch: 21, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.933 Vali Acc: 0.520 Test Loss: 0.933 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.8248634338378906
Epoch: 22, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.858 Vali Acc: 0.480 Test Loss: 0.858 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.04201078414917
Epoch: 23, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.4027156829833984
Epoch: 24, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.945 Vali Acc: 0.490 Test Loss: 0.945 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.078807353973389
Epoch: 25, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.896 Vali Acc: 0.450 Test Loss: 0.896 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.4998037815093994
Epoch: 26, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.980 Vali Acc: 0.490 Test Loss: 0.980 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.634298086166382
Epoch: 27, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.830336332321167
Epoch: 28, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3025342
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.156841993331909
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.927 Vali Acc: 0.490 Test Loss: 0.927 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.668389320373535
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7506701946258545
Epoch: 3, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.815 Vali Acc: 0.460 Test Loss: 0.815 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7342166900634766
Epoch: 4, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.302 Vali Acc: 0.490 Test Loss: 1.302 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.910120964050293
Epoch: 5, Steps: 20 | Train Loss: 0.896 Vali Loss: 0.872 Vali Acc: 0.480 Test Loss: 0.872 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6445164680480957
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 3.776228666305542
Epoch: 7, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.925 Vali Acc: 0.480 Test Loss: 0.925 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.480219841003418
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 3.8767271041870117
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 3.6652932167053223
Epoch: 10, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3496146202087402
Epoch: 11, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3508658409118652
Epoch: 12, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8163490295410156
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.731057643890381
Epoch: 14, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 15 cost time: 3.459853172302246
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 1.117 Vali Acc: 0.490 Test Loss: 1.117 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7681055068969727
Epoch: 16, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.963 Vali Acc: 0.460 Test Loss: 0.963 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.787806749343872
Epoch: 17, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.888 Vali Acc: 0.460 Test Loss: 0.888 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.39251708984375
Epoch: 18, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.908 Vali Acc: 0.490 Test Loss: 0.908 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2292327880859375
Epoch: 19, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.928 Vali Acc: 0.440 Test Loss: 0.928 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.68589186668396
Epoch: 20, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.001 Vali Acc: 0.460 Test Loss: 1.001 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.527581214904785
Epoch: 21, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.028 Vali Acc: 0.500 Test Loss: 1.028 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.642956256866455
Epoch: 22, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.926 Vali Acc: 0.490 Test Loss: 0.926 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.564312696456909
Epoch: 23, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.981 Vali Acc: 0.440 Test Loss: 0.981 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6917896270751953
Epoch: 24, Steps: 20 | Train Loss: 0.535 Vali Loss: 1.018 Vali Acc: 0.480 Test Loss: 1.018 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3023934
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.712301254272461
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.858 Vali Acc: 0.490 Test Loss: 0.858 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 4.149237155914307
Epoch: 2, Steps: 20 | Train Loss: 0.809 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.047198295593262
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.805 Vali Acc: 0.470 Test Loss: 0.805 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9439165592193604
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (-0.489991 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 3.936469554901123
Epoch: 5, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.790 Vali Acc: 0.470 Test Loss: 0.790 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7580068111419678
Epoch: 6, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2833967208862305
Epoch: 7, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.104313135147095
Epoch: 8, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.1083149909973145
Epoch: 9, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.912 Vali Acc: 0.480 Test Loss: 0.912 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6372058391571045
Epoch: 10, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.418613910675049
Epoch: 11, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.382540225982666
Epoch: 12, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.707 Vali Acc: 0.600 Test Loss: 0.707 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 13 cost time: 3.736954927444458
Epoch: 13, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.766 Vali Acc: 0.560 Test Loss: 0.766 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9164247512817383
Epoch: 14, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.849 Vali Acc: 0.470 Test Loss: 0.849 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.135883808135986
Epoch: 15, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.2894532680511475
Epoch: 16, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.169172525405884
Epoch: 17, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.464552879333496
Epoch: 18, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3137898445129395
Epoch: 19, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.900 Vali Acc: 0.520 Test Loss: 0.900 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.807982921600342
Epoch: 20, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.283818244934082
Epoch: 21, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.843 Vali Acc: 0.600 Test Loss: 0.843 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.209194898605347
Epoch: 22, Steps: 20 | Train Loss: 0.610 Vali Loss: 1.397 Vali Acc: 0.460 Test Loss: 1.397 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3022526
model size : 14.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.601732969284058
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.324204206466675
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
Validation loss decreased (-0.439993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 3.8955469131469727
Epoch: 3, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.427002191543579
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.925 Vali Acc: 0.450 Test Loss: 0.925 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2732150554656982
Epoch: 5, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.39493727684021
Epoch: 6, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 2.4951889514923096
Epoch: 7, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4547526836395264
Epoch: 8, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.822 Vali Acc: 0.550 Test Loss: 0.822 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 3.582895040512085
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7468245029449463
Epoch: 10, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.893 Vali Acc: 0.530 Test Loss: 0.893 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.706611156463623
Epoch: 11, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6057939529418945
Epoch: 12, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1769192218780518
Epoch: 13, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1581027507781982
Epoch: 14, Steps: 20 | Train Loss: 0.728 Vali Loss: 1.061 Vali Acc: 0.460 Test Loss: 1.061 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.5146713256835938
Epoch: 15, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.7611546516418457
Epoch: 16, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 17 cost time: 3.6273117065429688
Epoch: 17, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.910 Vali Acc: 0.470 Test Loss: 0.910 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.510774850845337
Epoch: 18, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6739344596862793
Epoch: 19, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3413352966308594
Epoch: 20, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.705251455307007
Epoch: 21, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 22 cost time: 3.7142996788024902
Epoch: 22, Steps: 20 | Train Loss: 0.616 Vali Loss: 1.023 Vali Acc: 0.510 Test Loss: 1.023 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6153242588043213
Epoch: 23, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.804 Vali Acc: 0.600 Test Loss: 0.804 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599992).  Saving model ...
Epoch: 24 cost time: 3.7712008953094482
Epoch: 24, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.892 Vali Acc: 0.430 Test Loss: 0.892 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.73452091217041
Epoch: 25, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.931 Vali Acc: 0.470 Test Loss: 0.931 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3153631687164307
Epoch: 26, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.094 Vali Acc: 0.510 Test Loss: 1.094 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.062995433807373
Epoch: 27, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.938 Vali Acc: 0.460 Test Loss: 0.938 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.055983304977417
Epoch: 28, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.983 Vali Acc: 0.580 Test Loss: 0.983 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.765961170196533
Epoch: 29, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.710 Vali Acc: 0.630 Test Loss: 0.710 Test Acc: 0.630
Validation loss decreased (-0.599992 --> -0.629993).  Saving model ...
Epoch: 30 cost time: 3.7126946449279785
Epoch: 30, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.898106336593628
Epoch: 31, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.929 Vali Acc: 0.530 Test Loss: 0.929 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.8832523822784424
Epoch: 32, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.009 Vali Acc: 0.530 Test Loss: 1.009 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.947922468185425
Epoch: 33, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.167083740234375
Epoch: 34, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.474491596221924
Epoch: 35, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.777587413787842
Epoch: 36, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.034 Vali Acc: 0.510 Test Loss: 1.034 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.6759259700775146
Epoch: 37, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.016 Vali Acc: 0.530 Test Loss: 1.016 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.8503434658050537
Epoch: 38, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.155 Vali Acc: 0.560 Test Loss: 1.155 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.614595651626587
Epoch: 39, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3021118
model size : 14.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.9063568115234375
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.5739519596099854
Epoch: 2, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.089881181716919
Epoch: 3, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.198634624481201
Epoch: 4, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.883 Vali Acc: 0.490 Test Loss: 0.883 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.470494031906128
Epoch: 5, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.646021604537964
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.696186065673828
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5220327377319336
Epoch: 8, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.72153639793396
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.938 Vali Acc: 0.500 Test Loss: 0.938 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5798606872558594
Epoch: 10, Steps: 20 | Train Loss: 0.910 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.806980609893799
Epoch: 11, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2729278
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.774065732955933
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.822 Vali Acc: 0.470 Test Loss: 0.822 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.2468347549438477
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1289453506469727
Epoch: 3, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 3.283501625061035
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 3.4279870986938477
Epoch: 5, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.892 Vali Acc: 0.480 Test Loss: 0.892 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.67380428314209
Epoch: 6, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.899 Vali Acc: 0.480 Test Loss: 0.899 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.670464515686035
Epoch: 7, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5016908645629883
Epoch: 8, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.917 Vali Acc: 0.490 Test Loss: 0.917 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.187222480773926
Epoch: 9, Steps: 20 | Train Loss: 0.850 Vali Loss: 1.271 Vali Acc: 0.480 Test Loss: 1.271 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4290387630462646
Epoch: 10, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.832 Vali Acc: 0.560 Test Loss: 0.832 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.4054837226867676
Epoch: 11, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.690758466720581
Epoch: 12, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.646099328994751
Epoch: 13, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.658334970474243
Epoch: 14, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.789 Vali Acc: 0.590 Test Loss: 0.789 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 3.5738964080810547
Epoch: 15, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.862 Vali Acc: 0.460 Test Loss: 0.862 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8211138248443604
Epoch: 16, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.835 Vali Acc: 0.620 Test Loss: 0.835 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619992).  Saving model ...
Epoch: 17 cost time: 3.6736552715301514
Epoch: 17, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9711852073669434
Epoch: 18, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6096551418304443
Epoch: 19, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.857 Vali Acc: 0.450 Test Loss: 0.857 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.2098000049591064
Epoch: 20, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.771 Vali Acc: 0.610 Test Loss: 0.771 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.737183094024658
Epoch: 21, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.948827028274536
Epoch: 22, Steps: 20 | Train Loss: 0.642 Vali Loss: 1.102 Vali Acc: 0.580 Test Loss: 1.102 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.781867504119873
Epoch: 23, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.959 Vali Acc: 0.570 Test Loss: 0.959 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.510969638824463
Epoch: 24, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.8587517738342285
Epoch: 25, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.829 Vali Acc: 0.600 Test Loss: 0.829 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.208301067352295
Epoch: 26, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.865 Vali Acc: 0.570 Test Loss: 0.865 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2727870
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.244617223739624
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.6282613277435303
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.3753511905670166
Epoch: 3, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.769 Vali Acc: 0.450 Test Loss: 0.769 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6354153156280518
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 3.3525702953338623
Epoch: 5, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.72493314743042
Epoch: 6, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8418097496032715
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8425285816192627
Epoch: 8, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 3.260544538497925
Epoch: 9, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4280433654785156
Epoch: 10, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6473519802093506
Epoch: 11, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.654852867126465
Epoch: 12, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.714872360229492
Epoch: 13, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.87499737739563
Epoch: 14, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2423431873321533
Epoch: 15, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 16 cost time: 3.492884397506714
Epoch: 16, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.797 Vali Acc: 0.440 Test Loss: 0.797 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6357343196868896
Epoch: 17, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.648197889328003
Epoch: 18, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.998 Vali Acc: 0.490 Test Loss: 0.998 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4297430515289307
Epoch: 19, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.958 Vali Acc: 0.450 Test Loss: 0.958 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4952831268310547
Epoch: 20, Steps: 20 | Train Loss: 0.681 Vali Loss: 1.053 Vali Acc: 0.480 Test Loss: 1.053 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8279712200164795
Epoch: 21, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.796 Vali Acc: 0.600 Test Loss: 0.796 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599992).  Saving model ...
Epoch: 22 cost time: 2.803351640701294
Epoch: 22, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.966 Vali Acc: 0.520 Test Loss: 0.966 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.666550636291504
Epoch: 23, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.396019220352173
Epoch: 24, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5064399242401123
Epoch: 25, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.533719778060913
Epoch: 26, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.916 Vali Acc: 0.560 Test Loss: 0.916 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.115133762359619
Epoch: 27, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.000 Vali Acc: 0.540 Test Loss: 1.000 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.7016167640686035
Epoch: 28, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.976 Vali Acc: 0.560 Test Loss: 0.976 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.325312376022339
Epoch: 29, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.933 Vali Acc: 0.510 Test Loss: 0.933 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.507841110229492
Epoch: 30, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.088 Vali Acc: 0.450 Test Loss: 1.088 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.7068052291870117
Epoch: 31, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.036 Vali Acc: 0.510 Test Loss: 1.036 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2726462
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.761261463165283
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 3.5542643070220947
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 1.038 Vali Acc: 0.490 Test Loss: 1.038 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4218950271606445
Epoch: 3, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.730 Vali Acc: 0.440 Test Loss: 0.730 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.58031964302063
Epoch: 4, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.732536792755127
Epoch: 5, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.801 Vali Acc: 0.520 Test Loss: 0.801 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.623028516769409
Epoch: 6, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.879 Vali Acc: 0.470 Test Loss: 0.879 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9086742401123047
Epoch: 7, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.806 Vali Acc: 0.510 Test Loss: 0.806 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8840837478637695
Epoch: 8, Steps: 20 | Train Loss: 0.747 Vali Loss: 1.060 Vali Acc: 0.490 Test Loss: 1.060 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.2612016201019287
Epoch: 9, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.816 Vali Acc: 0.510 Test Loss: 0.816 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5319437980651855
Epoch: 10, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.431837558746338
Epoch: 11, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.796 Vali Acc: 0.460 Test Loss: 0.796 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 2725054
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.164411544799805
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.4654533863067627
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.762833833694458
Epoch: 3, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0672004222869873
Epoch: 4, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.941 Vali Acc: 0.490 Test Loss: 0.941 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9982192516326904
Epoch: 5, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.033360242843628
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 2.8582751750946045
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.888 Vali Acc: 0.490 Test Loss: 0.888 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.952357292175293
Epoch: 8, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5386388301849365
Epoch: 9, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.938270092010498
Epoch: 10, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6438825130462646
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.826 Vali Acc: 0.470 Test Loss: 0.826 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1006968021392822
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.1752192974090576
Epoch: 13, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.578339099884033
Epoch: 14, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.50711989402771
Epoch: 15, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.859 Vali Acc: 0.520 Test Loss: 0.859 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4901926517486572
Epoch: 16, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1815678
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.959484815597534
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.8428003787994385
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.918313503265381
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4367034435272217
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 2.955885648727417
Epoch: 5, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.775535821914673
Epoch: 6, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.755 Vali Acc: 0.470 Test Loss: 0.755 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8621466159820557
Epoch: 7, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8884196281433105
Epoch: 8, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.684 Vali Acc: 0.570 Test Loss: 0.684 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 2.933637857437134
Epoch: 9, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.813606023788452
Epoch: 10, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6400094032287598
Epoch: 11, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7817397117614746
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7592384815216064
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.907371759414673
Epoch: 14, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7792296409606934
Epoch: 15, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.863 Vali Acc: 0.420 Test Loss: 0.863 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1349406242370605
Epoch: 16, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.897 Vali Acc: 0.430 Test Loss: 0.897 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.907416343688965
Epoch: 17, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.970 Vali Acc: 0.520 Test Loss: 0.970 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6974637508392334
Epoch: 18, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.824 Vali Acc: 0.480 Test Loss: 0.824 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1814974
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.245639085769653
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.0525898933410645
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.042196273803711
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9722061157226562
Epoch: 4, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0253734588623047
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.147892713546753
Epoch: 6, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 3.1027493476867676
Epoch: 7, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.274608850479126
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0333144664764404
Epoch: 9, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.03483247756958
Epoch: 10, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1968343257904053
Epoch: 11, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0451812744140625
Epoch: 12, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.975 Vali Acc: 0.520 Test Loss: 0.975 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8852078914642334
Epoch: 13, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.678 Vali Acc: 0.570 Test Loss: 0.678 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 3.4180338382720947
Epoch: 14, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4069857597351074
Epoch: 15, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.100832462310791
Epoch: 16, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.012850284576416
Epoch: 17, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.15875506401062
Epoch: 18, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0525054931640625
Epoch: 19, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1007308959960938
Epoch: 20, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.771 Vali Acc: 0.560 Test Loss: 0.771 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.869379997253418
Epoch: 21, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.433962821960449
Epoch: 22, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.270963191986084
Epoch: 23, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.676 Vali Acc: 0.600 Test Loss: 0.676 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 24 cost time: 3.0501773357391357
Epoch: 24, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.923 Vali Acc: 0.550 Test Loss: 0.923 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.063436269760132
Epoch: 25, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.867 Vali Acc: 0.560 Test Loss: 0.867 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.984905481338501
Epoch: 26, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.891 Vali Acc: 0.550 Test Loss: 0.891 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.086686134338379
Epoch: 27, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.911 Vali Acc: 0.580 Test Loss: 0.911 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.124260663986206
Epoch: 28, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.870 Vali Acc: 0.490 Test Loss: 0.870 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9547417163848877
Epoch: 29, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.053 Vali Acc: 0.530 Test Loss: 1.053 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.355264186859131
Epoch: 30, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.874 Vali Acc: 0.610 Test Loss: 0.874 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609991).  Saving model ...
Epoch: 31 cost time: 3.0767552852630615
Epoch: 31, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.924 Vali Acc: 0.550 Test Loss: 0.924 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.060398578643799
Epoch: 32, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.945 Vali Acc: 0.520 Test Loss: 0.945 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.2080423831939697
Epoch: 33, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.962 Vali Acc: 0.540 Test Loss: 0.962 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.8890652656555176
Epoch: 34, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.014 Vali Acc: 0.590 Test Loss: 1.014 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.6863646507263184
Epoch: 35, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.162 Vali Acc: 0.480 Test Loss: 1.162 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.784318208694458
Epoch: 36, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.965 Vali Acc: 0.540 Test Loss: 0.965 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.8957560062408447
Epoch: 37, Steps: 20 | Train Loss: 0.356 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.477830410003662
Epoch: 38, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.868 Vali Acc: 0.580 Test Loss: 0.868 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.6326816082000732
Epoch: 39, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.193 Vali Acc: 0.470 Test Loss: 1.193 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.1946496963500977
Epoch: 40, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1814270
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.72658109664917
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.8207197189331055
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.873345375061035
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8291642665863037
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8253297805786133
Epoch: 5, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7964963912963867
Epoch: 6, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8380465507507324
Epoch: 7, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8237969875335693
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.682 Vali Acc: 0.490 Test Loss: 0.682 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.86910080909729
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 2.596212863922119
Epoch: 10, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.849630355834961
Epoch: 11, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.777 Vali Acc: 0.470 Test Loss: 0.777 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.895232677459717
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.933096408843994
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.911836624145508
Epoch: 14, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 15 cost time: 2.412367343902588
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.946 Vali Acc: 0.520 Test Loss: 0.946 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8356118202209473
Epoch: 16, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.933 Vali Acc: 0.520 Test Loss: 0.933 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9587087631225586
Epoch: 17, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8368372917175293
Epoch: 18, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.892 Vali Acc: 0.460 Test Loss: 0.892 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7981553077697754
Epoch: 19, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.729 Vali Acc: 0.570 Test Loss: 0.729 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 20 cost time: 3.055055618286133
Epoch: 20, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.861 Vali Acc: 0.450 Test Loss: 0.861 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.019822359085083
Epoch: 21, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.956 Vali Acc: 0.480 Test Loss: 0.956 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.767958641052246
Epoch: 22, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.766 Vali Acc: 0.490 Test Loss: 0.766 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.569011926651001
Epoch: 23, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7897353172302246
Epoch: 24, Steps: 20 | Train Loss: 0.544 Vali Loss: 1.017 Vali Acc: 0.480 Test Loss: 1.017 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8462605476379395
Epoch: 25, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.959561824798584
Epoch: 26, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.872 Vali Acc: 0.570 Test Loss: 0.872 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.903562307357788
Epoch: 27, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.830 Vali Acc: 0.570 Test Loss: 0.830 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.8604724407196045
Epoch: 28, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.77197527885437
Epoch: 29, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.912 Vali Acc: 0.580 Test Loss: 0.912 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 30 cost time: 2.946596384048462
Epoch: 30, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.648616313934326
Epoch: 31, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.986 Vali Acc: 0.510 Test Loss: 0.986 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8548121452331543
Epoch: 32, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.875 Vali Acc: 0.590 Test Loss: 0.875 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589991).  Saving model ...
Epoch: 33 cost time: 2.9621453285217285
Epoch: 33, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.793458938598633
Epoch: 34, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.162 Vali Acc: 0.520 Test Loss: 1.162 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.8368191719055176
Epoch: 35, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.982 Vali Acc: 0.560 Test Loss: 0.982 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.7316694259643555
Epoch: 36, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.946 Vali Acc: 0.490 Test Loss: 0.946 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.008392810821533
Epoch: 37, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.064 Vali Acc: 0.530 Test Loss: 1.064 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.890174150466919
Epoch: 38, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.210 Vali Acc: 0.540 Test Loss: 1.210 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.8401663303375244
Epoch: 39, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.989 Vali Acc: 0.550 Test Loss: 0.989 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.817409038543701
Epoch: 40, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.008 Vali Acc: 0.540 Test Loss: 1.008 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.9140512943267822
Epoch: 41, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.905 Vali Acc: 0.560 Test Loss: 0.905 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.020895481109619
Epoch: 42, Steps: 20 | Train Loss: 0.368 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1813566
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.978376865386963
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.106722116470337
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.716580390930176
Epoch: 3, Steps: 20 | Train Loss: 0.767 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509990).  Saving model ...
Epoch: 4 cost time: 2.7036898136138916
Epoch: 4, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.94858455657959
Epoch: 5, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5668704509735107
Epoch: 6, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.828 Vali Acc: 0.490 Test Loss: 0.828 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8218696117401123
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.036109209060669
Epoch: 8, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3262040615081787
Epoch: 9, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9874768257141113
Epoch: 10, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 2.8695929050445557
Epoch: 11, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.646989107131958
Epoch: 12, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7875893115997314
Epoch: 13, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.692 Vali Acc: 0.510 Test Loss: 0.692 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7726922035217285
Epoch: 14, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.910 Vali Acc: 0.540 Test Loss: 0.910 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539991).  Saving model ...
Epoch: 15 cost time: 2.701120138168335
Epoch: 15, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6328611373901367
Epoch: 16, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9439284801483154
Epoch: 17, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7341933250427246
Epoch: 18, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
Validation loss decreased (-0.539991 --> -0.539992).  Saving model ...
Epoch: 19 cost time: 2.757472276687622
Epoch: 19, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8254847526550293
Epoch: 20, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 21 cost time: 2.9378039836883545
Epoch: 21, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.912 Vali Acc: 0.530 Test Loss: 0.912 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8304641246795654
Epoch: 22, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.032454013824463
Epoch: 23, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.921 Vali Acc: 0.530 Test Loss: 0.921 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8713324069976807
Epoch: 24, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.9735822677612305
Epoch: 25, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6718132495880127
Epoch: 26, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.821 Vali Acc: 0.570 Test Loss: 0.821 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 27 cost time: 2.6522059440612793
Epoch: 27, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.919 Vali Acc: 0.490 Test Loss: 0.919 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8353872299194336
Epoch: 28, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.087 Vali Acc: 0.440 Test Loss: 1.087 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.984996795654297
Epoch: 29, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.934 Vali Acc: 0.550 Test Loss: 0.934 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.919752836227417
Epoch: 30, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.934 Vali Acc: 0.550 Test Loss: 0.934 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1231586933135986
Epoch: 31, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.787544012069702
Epoch: 32, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.977 Vali Acc: 0.550 Test Loss: 0.977 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.0185186862945557
Epoch: 33, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.905 Vali Acc: 0.550 Test Loss: 0.905 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.048832416534424
Epoch: 34, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.013 Vali Acc: 0.520 Test Loss: 1.013 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.565566301345825
Epoch: 35, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.009 Vali Acc: 0.470 Test Loss: 1.009 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.8638734817504883
Epoch: 36, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1221246
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.658573389053345
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.06296443939209
Epoch: 2, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.632126569747925
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.9089150428771973
Epoch: 4, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.145883798599243
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0173802375793457
Epoch: 6, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9401895999908447
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.858955144882202
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.995668888092041
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.895 Vali Acc: 0.480 Test Loss: 0.895 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.42761492729187
Epoch: 10, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.850 Vali Acc: 0.510 Test Loss: 0.850 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.849217176437378
Epoch: 11, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.919 Vali Acc: 0.470 Test Loss: 0.919 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.949781656265259
Epoch: 12, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 3.056220531463623
Epoch: 13, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.696 Vali Acc: 0.600 Test Loss: 0.696 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 2.87699818611145
Epoch: 14, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.736 Vali Acc: 0.590 Test Loss: 0.736 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8299615383148193
Epoch: 15, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6525275707244873
Epoch: 16, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.807 Vali Acc: 0.440 Test Loss: 0.807 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5508015155792236
Epoch: 17, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.879 Vali Acc: 0.440 Test Loss: 0.879 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8255553245544434
Epoch: 18, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.707888126373291
Epoch: 19, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9811251163482666
Epoch: 20, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.813802480697632
Epoch: 21, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.901 Vali Acc: 0.540 Test Loss: 0.901 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.982748031616211
Epoch: 22, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.692981243133545
Epoch: 23, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.958 Vali Acc: 0.490 Test Loss: 0.958 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1220542
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.307372093200684
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.788839340209961
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8733620643615723
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.856196165084839
Epoch: 4, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7502074241638184
Epoch: 5, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.860 Vali Acc: 0.430 Test Loss: 0.860 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.802839994430542
Epoch: 6, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.794 Vali Acc: 0.460 Test Loss: 0.794 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6971278190612793
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.600 Test Loss: 0.726 Test Acc: 0.600
Validation loss decreased (-0.479993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 2.790512800216675
Epoch: 8, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.857 Vali Acc: 0.490 Test Loss: 0.857 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9174692630767822
Epoch: 9, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.808598279953003
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.863 Vali Acc: 0.480 Test Loss: 0.863 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7865004539489746
Epoch: 11, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.777867078781128
Epoch: 12, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8383467197418213
Epoch: 13, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.416181802749634
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.793 Vali Acc: 0.440 Test Loss: 0.793 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.602656602859497
Epoch: 15, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8464925289154053
Epoch: 16, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.436854362487793
Epoch: 17, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1219838
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.097275018692017
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.399313449859619
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.754711627960205
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7495875358581543
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 2.6690938472747803
Epoch: 5, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.812 Vali Acc: 0.460 Test Loss: 0.812 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.689845561981201
Epoch: 6, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7468478679656982
Epoch: 7, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.765 Vali Acc: 0.470 Test Loss: 0.765 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.682527542114258
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.687 Vali Acc: 0.550 Test Loss: 0.687 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 2.606928825378418
Epoch: 9, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.727 Vali Acc: 0.580 Test Loss: 0.727 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 10 cost time: 2.6671359539031982
Epoch: 10, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.747934341430664
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.541280508041382
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5705597400665283
Epoch: 13, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.719850540161133
Epoch: 14, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.637763023376465
Epoch: 15, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.902 Vali Acc: 0.530 Test Loss: 0.902 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6707990169525146
Epoch: 16, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.810 Vali Acc: 0.430 Test Loss: 0.810 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.902003288269043
Epoch: 17, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6464009284973145
Epoch: 18, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6616714000701904
Epoch: 19, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.867 Vali Acc: 0.450 Test Loss: 0.867 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1219134
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.219383001327515
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.87795352935791
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.8911938667297363
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.404409170150757
Epoch: 4, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.756830930709839
Epoch: 5, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8088462352752686
Epoch: 6, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.718635082244873
Epoch: 7, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.683 Vali Acc: 0.560 Test Loss: 0.683 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 2.6467783451080322
Epoch: 8, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.772552728652954
Epoch: 9, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.713188409805298
Epoch: 10, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7573039531707764
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.602285146713257
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.766 Vali Acc: 0.490 Test Loss: 0.766 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4345507621765137
Epoch: 13, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7501258850097656
Epoch: 14, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7217586040496826
Epoch: 15, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.788 Vali Acc: 0.450 Test Loss: 0.788 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.838928699493408
Epoch: 16, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.991 Vali Acc: 0.520 Test Loss: 0.991 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7589211463928223
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.834 Vali Acc: 0.560 Test Loss: 0.834 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 924030
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.19074010848999
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.7900538444519043
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.890958070755005
Epoch: 3, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.871941566467285
Epoch: 4, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.857 Vali Acc: 0.490 Test Loss: 0.857 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6003241539001465
Epoch: 5, Steps: 20 | Train Loss: 0.797 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.742950439453125
Epoch: 6, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.758 Vali Acc: 0.460 Test Loss: 0.758 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4691414833068848
Epoch: 7, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.477008581161499
Epoch: 8, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 3.114063024520874
Epoch: 9, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9974913597106934
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.857 Vali Acc: 0.500 Test Loss: 0.857 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.105339765548706
Epoch: 11, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.934013605117798
Epoch: 12, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9314627647399902
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.839 Vali Acc: 0.490 Test Loss: 0.839 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9861438274383545
Epoch: 14, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589993).  Saving model ...
Epoch: 15 cost time: 2.5694682598114014
Epoch: 15, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.906 Vali Acc: 0.510 Test Loss: 0.906 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.182631492614746
Epoch: 16, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.103510856628418
Epoch: 17, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.793 Vali Acc: 0.480 Test Loss: 0.793 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0271403789520264
Epoch: 18, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.787 Vali Acc: 0.430 Test Loss: 0.787 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9296844005584717
Epoch: 19, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9196817874908447
Epoch: 20, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.805917978286743
Epoch: 21, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.564664840698242
Epoch: 22, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9303550720214844
Epoch: 23, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.828 Vali Acc: 0.590 Test Loss: 0.828 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1380045413970947
Epoch: 24, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 923326
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.545393943786621
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.589948892593384
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.8590924739837646
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.064284563064575
Epoch: 4, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.938 Vali Acc: 0.520 Test Loss: 0.938 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.798579692840576
Epoch: 5, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.934846878051758
Epoch: 6, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.984882354736328
Epoch: 7, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.956458568572998
Epoch: 8, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1109378337860107
Epoch: 9, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.84259033203125
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.094125270843506
Epoch: 11, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.607254981994629
Epoch: 12, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 922622
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.333426475524902
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.721 Vali Acc: 0.440 Test Loss: 0.721 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.724730968475342
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.855 Vali Acc: 0.490 Test Loss: 0.855 Test Acc: 0.490
Validation loss decreased (-0.439993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 2.702810525894165
Epoch: 3, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
Validation loss decreased (-0.489991 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 2.8788106441497803
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 2.7257561683654785
Epoch: 5, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 2.8013200759887695
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.934744119644165
Epoch: 7, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6773767471313477
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 2.8492376804351807
Epoch: 9, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.793 Vali Acc: 0.480 Test Loss: 0.793 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8439598083496094
Epoch: 10, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8404502868652344
Epoch: 11, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.55069899559021
Epoch: 12, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.882833480834961
Epoch: 13, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.760429620742798
Epoch: 14, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7969210147857666
Epoch: 15, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 2.6593849658966064
Epoch: 16, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.793 Vali Acc: 0.480 Test Loss: 0.793 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9171624183654785
Epoch: 17, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.805 Vali Acc: 0.550 Test Loss: 0.805 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.603924512863159
Epoch: 18, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.976 Vali Acc: 0.450 Test Loss: 0.976 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4634387493133545
Epoch: 19, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.797783851623535
Epoch: 20, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.811 Vali Acc: 0.590 Test Loss: 0.811 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 21 cost time: 2.7604568004608154
Epoch: 21, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.880 Vali Acc: 0.460 Test Loss: 0.880 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0611186027526855
Epoch: 22, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.94246768951416
Epoch: 23, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.874 Vali Acc: 0.560 Test Loss: 0.874 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5301222801208496
Epoch: 24, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.919 Vali Acc: 0.470 Test Loss: 0.919 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.790055990219116
Epoch: 25, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7131471633911133
Epoch: 26, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.6756205558776855
Epoch: 27, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.803 Vali Acc: 0.430 Test Loss: 0.803 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4996566772460938
Epoch: 28, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.5186705589294434
Epoch: 29, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.943 Vali Acc: 0.480 Test Loss: 0.943 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.598801851272583
Epoch: 30, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.138 Vali Acc: 0.460 Test Loss: 1.138 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 921918
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.245860815048218
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.779498338699341
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8517823219299316
Epoch: 3, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8379838466644287
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8838250637054443
Epoch: 5, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.831 Vali Acc: 0.490 Test Loss: 0.831 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.711681842803955
Epoch: 6, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.606649398803711
Epoch: 7, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.817 Vali Acc: 0.480 Test Loss: 0.817 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8983757495880127
Epoch: 8, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.300262928009033
Epoch: 9, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 2.2921481132507324
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.947 Vali Acc: 0.450 Test Loss: 0.947 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.164235830307007
Epoch: 11, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 2.3385486602783203
Epoch: 12, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1691625118255615
Epoch: 13, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.660416841506958
Epoch: 14, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.689 Vali Acc: 0.560 Test Loss: 0.689 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 3.0930559635162354
Epoch: 15, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.710 Vali Acc: 0.570 Test Loss: 0.710 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 2.8367738723754883
Epoch: 16, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.769 Vali Acc: 0.590 Test Loss: 0.769 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 17 cost time: 2.9619929790496826
Epoch: 17, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.982872486114502
Epoch: 18, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.682424306869507
Epoch: 19, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9801454544067383
Epoch: 20, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.782719373703003
Epoch: 21, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.315990447998047
Epoch: 22, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.895602226257324
Epoch: 23, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8090195655822754
Epoch: 24, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.870086431503296
Epoch: 25, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.906 Vali Acc: 0.520 Test Loss: 0.906 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7823963165283203
Epoch: 26, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.942 Vali Acc: 0.550 Test Loss: 0.942 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 775422
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.593838691711426
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.9232330322265625
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.7593882083892822
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.938039541244507
Epoch: 4, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8505914211273193
Epoch: 5, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.899 Vali Acc: 0.490 Test Loss: 0.899 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.514587640762329
Epoch: 6, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5811963081359863
Epoch: 7, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.688 Vali Acc: 0.500 Test Loss: 0.688 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.747706413269043
Epoch: 8, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.086926221847534
Epoch: 9, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.027597665786743
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.807 Vali Acc: 0.440 Test Loss: 0.807 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.026007652282715
Epoch: 11, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 2.9275734424591064
Epoch: 12, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 2.644517660140991
Epoch: 13, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9753530025482178
Epoch: 14, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9319469928741455
Epoch: 15, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.792 Vali Acc: 0.480 Test Loss: 0.792 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.645885944366455
Epoch: 16, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.902 Vali Acc: 0.470 Test Loss: 0.902 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.8738226890563965
Epoch: 17, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.046238660812378
Epoch: 18, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.166102170944214
Epoch: 19, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.139772891998291
Epoch: 20, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9014463424682617
Epoch: 21, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4085264205932617
Epoch: 22, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 774718
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.261296987533569
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.8670899868011475
Epoch: 2, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9895122051239014
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.678 Vali Acc: 0.570 Test Loss: 0.678 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.7328426837921143
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.747745990753174
Epoch: 5, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.907 Vali Acc: 0.520 Test Loss: 0.907 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.957641839981079
Epoch: 6, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0581860542297363
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0172719955444336
Epoch: 8, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7818572521209717
Epoch: 9, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.910 Vali Acc: 0.490 Test Loss: 0.910 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.90779709815979
Epoch: 10, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9245944023132324
Epoch: 11, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8152003288269043
Epoch: 12, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.680 Vali Acc: 0.560 Test Loss: 0.680 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1269819736480713
Epoch: 13, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 774014
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.37264609336853
Epoch: 1, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.425163507461548
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.707 Vali Acc: 0.490 Test Loss: 0.707 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 2.815591812133789
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.929093837738037
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3976540565490723
Epoch: 5, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 2.77923846244812
Epoch: 6, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.853353977203369
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9042155742645264
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.854 Vali Acc: 0.490 Test Loss: 0.854 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.672459602355957
Epoch: 9, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6189627647399902
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1256282329559326
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 3.123657464981079
Epoch: 12, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.771 Vali Acc: 0.460 Test Loss: 0.771 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7417733669281006
Epoch: 13, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.911 Vali Acc: 0.440 Test Loss: 0.911 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8174431324005127
Epoch: 14, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 15 cost time: 2.9877312183380127
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 16 cost time: 2.679001569747925
Epoch: 16, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.819 Vali Acc: 0.470 Test Loss: 0.819 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6679601669311523
Epoch: 17, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.840 Vali Acc: 0.510 Test Loss: 0.840 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.84329891204834
Epoch: 18, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.971035957336426
Epoch: 19, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5057618618011475
Epoch: 20, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 21 cost time: 2.785876989364624
Epoch: 21, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.977458953857422
Epoch: 22, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.744561195373535
Epoch: 23, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 24 cost time: 2.7312772274017334
Epoch: 24, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.832 Vali Acc: 0.590 Test Loss: 0.832 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 25 cost time: 2.836441993713379
Epoch: 25, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.822 Vali Acc: 0.570 Test Loss: 0.822 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.765671730041504
Epoch: 26, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.764 Vali Acc: 0.580 Test Loss: 0.764 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.607025384902954
Epoch: 27, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9147560596466064
Epoch: 28, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.838 Vali Acc: 0.610 Test Loss: 0.838 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609992).  Saving model ...
Epoch: 29 cost time: 2.8525075912475586
Epoch: 29, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7940986156463623
Epoch: 30, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.924 Vali Acc: 0.600 Test Loss: 0.924 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.725498914718628
Epoch: 31, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.889 Vali Acc: 0.490 Test Loss: 0.889 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.855015754699707
Epoch: 32, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.894713878631592
Epoch: 33, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.5927231311798096
Epoch: 34, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.565594434738159
Epoch: 35, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.036 Vali Acc: 0.480 Test Loss: 1.036 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.1123809814453125
Epoch: 36, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.152 Vali Acc: 0.550 Test Loss: 1.152 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.7038140296936035
Epoch: 37, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.703801393508911
Epoch: 38, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.869 Vali Acc: 0.610 Test Loss: 0.869 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 773310
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.420985460281372
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.722 Vali Acc: 0.450 Test Loss: 0.722 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.1918578147888184
Epoch: 2, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (-0.449993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.3113224506378174
Epoch: 3, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.738 Vali Acc: 0.430 Test Loss: 0.738 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.166522741317749
Epoch: 4, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.19636607170105
Epoch: 5, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.222114324569702
Epoch: 6, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.223562717437744
Epoch: 7, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.236107110977173
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.782 Vali Acc: 0.410 Test Loss: 0.782 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2599520683288574
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 2.1719422340393066
Epoch: 10, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2449865341186523
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 2.2454473972320557
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.196560859680176
Epoch: 13, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1124789714813232
Epoch: 14, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.276315212249756
Epoch: 15, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.51550030708313
Epoch: 16, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3194167613983154
Epoch: 17, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6286652088165283
Epoch: 18, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.826 Vali Acc: 0.480 Test Loss: 0.826 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.819859266281128
Epoch: 19, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.760913133621216
Epoch: 20, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.822 Vali Acc: 0.460 Test Loss: 0.822 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9168314933776855
Epoch: 21, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 765022
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.573419570922852
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.904320478439331
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.684 Vali Acc: 0.590 Test Loss: 0.684 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.648467540740967
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.68060040473938
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.698 Vali Acc: 0.480 Test Loss: 0.698 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.67974853515625
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4146721363067627
Epoch: 6, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.232228994369507
Epoch: 7, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3879506587982178
Epoch: 8, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.737 Vali Acc: 0.450 Test Loss: 0.737 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3150930404663086
Epoch: 9, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.164085865020752
Epoch: 10, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.748 Vali Acc: 0.460 Test Loss: 0.748 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3115029335021973
Epoch: 11, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.399446487426758
Epoch: 12, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 764670
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.474035263061523
Epoch: 1, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.723259210586548
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.702 Vali Acc: 0.460 Test Loss: 0.702 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5430028438568115
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.407809019088745
Epoch: 4, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4489834308624268
Epoch: 5, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.583695888519287
Epoch: 6, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3461036682128906
Epoch: 7, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.565814256668091
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.498441696166992
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.709038496017456
Epoch: 10, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.694166898727417
Epoch: 11, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9043660163879395
Epoch: 12, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9841980934143066
Epoch: 13, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 14 cost time: 2.4453518390655518
Epoch: 14, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5297532081604004
Epoch: 15, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.574265718460083
Epoch: 16, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3521511554718018
Epoch: 17, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4616475105285645
Epoch: 18, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.575437068939209
Epoch: 19, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0440049171447754
Epoch: 20, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.719322919845581
Epoch: 21, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.803 Vali Acc: 0.530 Test Loss: 0.803 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4188735485076904
Epoch: 22, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.870 Vali Acc: 0.430 Test Loss: 0.870 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.496350049972534
Epoch: 23, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.855 Vali Acc: 0.460 Test Loss: 0.855 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 764318
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.468995809555054
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.670 Vali Acc: 0.560 Test Loss: 0.670 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.973125457763672
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7408411502838135
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4789979457855225
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2616310119628906
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6685144901275635
Epoch: 6, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6660985946655273
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5959136486053467
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 2.987653970718384
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.473409652709961
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.746337890625
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.662428617477417
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5757346153259277
Epoch: 13, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4342198371887207
Epoch: 14, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7679059505462646
Epoch: 15, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.43129825592041
Epoch: 16, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.859 Vali Acc: 0.490 Test Loss: 0.859 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.297879219055176
Epoch: 17, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.435694932937622
Epoch: 18, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 763966
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.67798924446106
Epoch: 1, Steps: 20 | Train Loss: 0.869 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.584064245223999
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.723 Vali Acc: 0.420 Test Loss: 0.723 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1114864349365234
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.447871446609497
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.749 Vali Acc: 0.440 Test Loss: 0.749 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.355093240737915
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.775 Vali Acc: 0.470 Test Loss: 0.775 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.39622163772583
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.890 Vali Acc: 0.490 Test Loss: 0.890 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5701591968536377
Epoch: 7, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6802878379821777
Epoch: 8, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 2.320713996887207
Epoch: 9, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 2.461693286895752
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8450539112091064
Epoch: 11, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.292853832244873
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.202765464782715
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2888760566711426
Epoch: 14, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.432849168777466
Epoch: 15, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.838 Vali Acc: 0.470 Test Loss: 0.838 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5460898876190186
Epoch: 16, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3817927837371826
Epoch: 17, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3240373134613037
Epoch: 18, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.447232484817505
Epoch: 19, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.915 Vali Acc: 0.510 Test Loss: 0.915 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 465502
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5139517784118652
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.742 Vali Acc: 0.460 Test Loss: 0.742 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.323693037033081
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.2800920009613037
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.321481704711914
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6043214797973633
Epoch: 5, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.3801331520080566
Epoch: 6, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.5551400184631348
Epoch: 7, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4778969287872314
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9433114528656006
Epoch: 9, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.812288284301758
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.790 Vali Acc: 0.440 Test Loss: 0.790 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5575151443481445
Epoch: 11, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.703887939453125
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.807 Vali Acc: 0.440 Test Loss: 0.807 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7643778324127197
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.884 Vali Acc: 0.430 Test Loss: 0.884 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1215286254882812
Epoch: 14, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.852 Vali Acc: 0.460 Test Loss: 0.852 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4274141788482666
Epoch: 15, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.612168788909912
Epoch: 16, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 465150
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.158962726593018
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.781190872192383
Epoch: 2, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.015758514404297
Epoch: 3, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6063461303710938
Epoch: 4, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.305638551712036
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.45854115486145
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.836879253387451
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.809208631515503
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8388826847076416
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.516850709915161
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6335387229919434
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4507944583892822
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.712 Vali Acc: 0.540 Test Loss: 0.712 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.462642192840576
Epoch: 13, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 2.5423197746276855
Epoch: 14, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8672945499420166
Epoch: 15, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.773949384689331
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.135460376739502
Epoch: 17, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 18 cost time: 2.7482595443725586
Epoch: 18, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.820 Vali Acc: 0.460 Test Loss: 0.820 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7390966415405273
Epoch: 19, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.634314775466919
Epoch: 20, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.347968339920044
Epoch: 21, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.846 Vali Acc: 0.450 Test Loss: 0.846 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5229125022888184
Epoch: 22, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8980660438537598
Epoch: 23, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.399170398712158
Epoch: 24, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.815 Vali Acc: 0.490 Test Loss: 0.815 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8776118755340576
Epoch: 25, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9326863288879395
Epoch: 26, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8392651081085205
Epoch: 27, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 464798
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.255517482757568
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.687 Vali Acc: 0.540 Test Loss: 0.687 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.848700761795044
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6120996475219727
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.691 Vali Acc: 0.490 Test Loss: 0.691 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5252692699432373
Epoch: 4, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7611441612243652
Epoch: 5, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6839652061462402
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.680206060409546
Epoch: 7, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5712645053863525
Epoch: 8, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8563578128814697
Epoch: 9, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.09639310836792
Epoch: 10, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.734 Vali Acc: 0.460 Test Loss: 0.734 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.915937662124634
Epoch: 11, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 464446
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.27292275428772
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.611086130142212
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.491184711456299
Epoch: 3, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5153040885925293
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.771721124649048
Epoch: 5, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.735607624053955
Epoch: 6, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0105574131011963
Epoch: 7, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8406195640563965
Epoch: 8, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.72737455368042
Epoch: 9, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.699566602706909
Epoch: 10, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.83943510055542
Epoch: 11, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5724658966064453
Epoch: 12, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.532454252243042
Epoch: 13, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4751579761505127
Epoch: 14, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 2.514153480529785
Epoch: 15, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.562485456466675
Epoch: 16, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3393800258636475
Epoch: 17, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5245766639709473
Epoch: 18, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 19 cost time: 2.5943431854248047
Epoch: 19, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6477460861206055
Epoch: 20, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5890653133392334
Epoch: 21, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.647799015045166
Epoch: 22, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4223787784576416
Epoch: 23, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4815635681152344
Epoch: 24, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.535273551940918
Epoch: 25, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8214871883392334
Epoch: 26, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0310885906219482
Epoch: 27, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.6715266704559326
Epoch: 28, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 315742
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.780177593231201
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.233645439147949
Epoch: 2, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.706 Vali Acc: 0.440 Test Loss: 0.706 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4240031242370605
Epoch: 3, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.289233684539795
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 2.383577585220337
Epoch: 5, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.717 Vali Acc: 0.420 Test Loss: 0.717 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3714897632598877
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6459107398986816
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.724 Vali Acc: 0.440 Test Loss: 0.724 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.269778251647949
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4470396041870117
Epoch: 9, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6460745334625244
Epoch: 10, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.725 Vali Acc: 0.410 Test Loss: 0.725 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6679229736328125
Epoch: 11, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 12 cost time: 2.65970778465271
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.731 Vali Acc: 0.450 Test Loss: 0.731 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.752950429916382
Epoch: 13, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3531970977783203
Epoch: 14, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.430087089538574
Epoch: 15, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.817 Vali Acc: 0.470 Test Loss: 0.817 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5821826457977295
Epoch: 16, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.759 Vali Acc: 0.460 Test Loss: 0.759 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.582949638366699
Epoch: 17, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3667445182800293
Epoch: 18, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5782318115234375
Epoch: 19, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.813 Vali Acc: 0.460 Test Loss: 0.813 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.7178890705108643
Epoch: 20, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.827 Vali Acc: 0.450 Test Loss: 0.827 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6881864070892334
Epoch: 21, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.779 Vali Acc: 0.470 Test Loss: 0.779 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 315390
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.321669578552246
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.4602158069610596
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.39566969871521
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.420637845993042
Epoch: 4, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.703 Vali Acc: 0.460 Test Loss: 0.703 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.52839732170105
Epoch: 5, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.271918296813965
Epoch: 6, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.499138832092285
Epoch: 7, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3890130519866943
Epoch: 8, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.291875123977661
Epoch: 9, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.24857234954834
Epoch: 10, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.647585868835449
Epoch: 11, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 315038
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9977095127105713
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.697 Vali Acc: 0.590 Test Loss: 0.697 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 2.3631222248077393
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.693 Vali Acc: 0.480 Test Loss: 0.693 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.50726056098938
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7939953804016113
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6863484382629395
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3423380851745605
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.696 Vali Acc: 0.450 Test Loss: 0.696 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5526952743530273
Epoch: 7, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3953604698181152
Epoch: 8, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.505354642868042
Epoch: 9, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.359787702560425
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2317047119140625
Epoch: 11, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 314686
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.190448045730591
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.1686952114105225
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.133159875869751
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3751490116119385
Epoch: 4, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.1852738857269287
Epoch: 5, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.218238353729248
Epoch: 6, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2421154975891113
Epoch: 7, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 2.341696262359619
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.189331293106079
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9373445510864258
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1354026794433594
Epoch: 11, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.784 Vali Acc: 0.460 Test Loss: 0.784 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2063610553741455
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4415013790130615
Epoch: 13, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2070841789245605
Epoch: 14, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.31459903717041
Epoch: 15, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.713 Vali Acc: 0.580 Test Loss: 0.713 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 16 cost time: 1.976578950881958
Epoch: 16, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.222715139389038
Epoch: 17, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4750494956970215
Epoch: 18, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2126660346984863
Epoch: 19, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1572818756103516
Epoch: 20, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.808 Vali Acc: 0.480 Test Loss: 0.808 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3139538764953613
Epoch: 21, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.422355890274048
Epoch: 22, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3758509159088135
Epoch: 23, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2835161685943604
Epoch: 24, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.383408784866333
Epoch: 25, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 240862
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.010071039199829
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.689 Vali Acc: 0.610 Test Loss: 0.689 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 2.310110092163086
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.702 Vali Acc: 0.470 Test Loss: 0.702 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2845687866210938
Epoch: 3, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3899800777435303
Epoch: 4, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.699 Vali Acc: 0.540 Test Loss: 0.699 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3380236625671387
Epoch: 5, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3720602989196777
Epoch: 6, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.446547269821167
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3746347427368164
Epoch: 8, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.911677837371826
Epoch: 9, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4108810424804688
Epoch: 10, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4502198696136475
Epoch: 11, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 240510
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.916130304336548
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.4910759925842285
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.4484574794769287
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4398014545440674
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.687 Vali Acc: 0.570 Test Loss: 0.687 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 2.1520159244537354
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3298659324645996
Epoch: 6, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.427858591079712
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3726251125335693
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.478022813796997
Epoch: 9, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.694948434829712
Epoch: 10, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6071949005126953
Epoch: 11, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8973565101623535
Epoch: 12, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1034533977508545
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.982238292694092
Epoch: 14, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 240158
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.122612476348877
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.696 Vali Acc: 0.470 Test Loss: 0.696 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.7393810749053955
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.5044262409210205
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6689183712005615
Epoch: 4, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6494944095611572
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0641605854034424
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.950258255004883
Epoch: 7, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.706 Vali Acc: 0.440 Test Loss: 0.706 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8147835731506348
Epoch: 8, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8555290699005127
Epoch: 9, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8764004707336426
Epoch: 10, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 2.688100576400757
Epoch: 11, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 3.3987133502960205
Epoch: 12, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.062246322631836
Epoch: 13, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5181233882904053
Epoch: 14, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.963360548019409
Epoch: 15, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.688 Vali Acc: 0.570 Test Loss: 0.688 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 2.724520683288574
Epoch: 16, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.586501121520996
Epoch: 17, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5597951412200928
Epoch: 18, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.373328685760498
Epoch: 19, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.844 Vali Acc: 0.440 Test Loss: 0.844 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.315612554550171
Epoch: 20, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.414278507232666
Epoch: 21, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7807188034057617
Epoch: 22, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6689651012420654
Epoch: 23, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.0254459381103516
Epoch: 24, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0176124572753906
Epoch: 25, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.902 Vali Acc: 0.460 Test Loss: 0.902 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 239806
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.397611379623413
Epoch: 1, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.861 Vali Acc: 0.450 Test Loss: 0.861 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 3.5507729053497314
Epoch: 2, Steps: 20 | Train Loss: 0.821 Vali Loss: 1.103 Vali Acc: 0.490 Test Loss: 1.103 Test Acc: 0.490
Validation loss decreased (-0.449991 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 3.136763334274292
Epoch: 3, Steps: 20 | Train Loss: 0.891 Vali Loss: 0.909 Vali Acc: 0.490 Test Loss: 0.909 Test Acc: 0.490
Validation loss decreased (-0.489989 --> -0.489991).  Saving model ...
Epoch: 4 cost time: 2.9874753952026367
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.806 Vali Acc: 0.440 Test Loss: 0.806 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3753838539123535
Epoch: 5, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
Validation loss decreased (-0.489991 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.9845669269561768
Epoch: 6, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.839550733566284
Epoch: 7, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.681891918182373
Epoch: 8, Steps: 20 | Train Loss: 0.847 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0664210319519043
Epoch: 9, Steps: 20 | Train Loss: 0.821 Vali Loss: 1.112 Vali Acc: 0.490 Test Loss: 1.112 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0274081230163574
Epoch: 10, Steps: 20 | Train Loss: 0.876 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.783984661102295
Epoch: 11, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.804697275161743
Epoch: 12, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 13 cost time: 3.183112144470215
Epoch: 13, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.484 Vali Acc: 0.510 Test Loss: 1.484 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.56542706489563
Epoch: 14, Steps: 20 | Train Loss: 1.065 Vali Loss: 1.180 Vali Acc: 0.490 Test Loss: 1.180 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.879950523376465
Epoch: 15, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.869 Vali Acc: 0.510 Test Loss: 0.869 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.879364252090454
Epoch: 16, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 3.917465925216675
Epoch: 17, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.009918212890625
Epoch: 18, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8612639904022217
Epoch: 19, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.753 Vali Acc: 0.450 Test Loss: 0.753 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.488029956817627
Epoch: 20, Steps: 20 | Train Loss: 1.088 Vali Loss: 1.063 Vali Acc: 0.520 Test Loss: 1.063 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.9377453327178955
Epoch: 21, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.9079091548919678
Epoch: 22, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6453115940093994
Epoch: 23, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.7345573902130127
Epoch: 24, Steps: 20 | Train Loss: 0.660 Vali Loss: 1.523 Vali Acc: 0.490 Test Loss: 1.523 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.4631764888763428
Epoch: 25, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.186879873275757
Epoch: 26, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.914 Vali Acc: 0.560 Test Loss: 0.914 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 11160114
model size : 47.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.67678165435791
Epoch: 1, Steps: 20 | Train Loss: 0.840 Vali Loss: 0.725 Vali Acc: 0.580 Test Loss: 0.725 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 3.783353090286255
Epoch: 2, Steps: 20 | Train Loss: 0.865 Vali Loss: 1.146 Vali Acc: 0.490 Test Loss: 1.146 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7697439193725586
Epoch: 3, Steps: 20 | Train Loss: 0.900 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.755708932876587
Epoch: 4, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.385931968688965
Epoch: 5, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.964 Vali Acc: 0.490 Test Loss: 0.964 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5916101932525635
Epoch: 6, Steps: 20 | Train Loss: 0.865 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8925232887268066
Epoch: 7, Steps: 20 | Train Loss: 0.846 Vali Loss: 0.940 Vali Acc: 0.490 Test Loss: 0.940 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.022488594055176
Epoch: 8, Steps: 20 | Train Loss: 0.849 Vali Loss: 0.874 Vali Acc: 0.470 Test Loss: 0.874 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.028849124908447
Epoch: 9, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.6898531913757324
Epoch: 10, Steps: 20 | Train Loss: 1.054 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.7551310062408447
Epoch: 11, Steps: 20 | Train Loss: 0.755 Vali Loss: 1.316 Vali Acc: 0.490 Test Loss: 1.316 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 11157554
model size : 47.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.495993375778198
Epoch: 1, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.764341115951538
Epoch: 2, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.931109666824341
Epoch: 3, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.844 Vali Acc: 0.480 Test Loss: 0.844 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8071327209472656
Epoch: 4, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 5 cost time: 3.3033573627471924
Epoch: 5, Steps: 20 | Train Loss: 0.836 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 3.3744966983795166
Epoch: 6, Steps: 20 | Train Loss: 0.785 Vali Loss: 1.104 Vali Acc: 0.490 Test Loss: 1.104 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.873448610305786
Epoch: 7, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9308857917785645
Epoch: 8, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.786449909210205
Epoch: 9, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 3.307417631149292
Epoch: 10, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.969 Vali Acc: 0.490 Test Loss: 0.969 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9837701320648193
Epoch: 11, Steps: 20 | Train Loss: 0.968 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.098267555236816
Epoch: 12, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.654480218887329
Epoch: 13, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.864 Vali Acc: 0.480 Test Loss: 0.864 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9898130893707275
Epoch: 14, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.405 Vali Acc: 0.490 Test Loss: 1.405 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6958131790161133
Epoch: 15, Steps: 20 | Train Loss: 1.014 Vali Loss: 1.538 Vali Acc: 0.520 Test Loss: 1.538 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4294323921203613
Epoch: 16, Steps: 20 | Train Loss: 0.831 Vali Loss: 0.954 Vali Acc: 0.550 Test Loss: 0.954 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549990).  Saving model ...
Epoch: 17 cost time: 3.722414493560791
Epoch: 17, Steps: 20 | Train Loss: 1.058 Vali Loss: 1.104 Vali Acc: 0.490 Test Loss: 1.104 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.008172035217285
Epoch: 18, Steps: 20 | Train Loss: 0.798 Vali Loss: 1.010 Vali Acc: 0.490 Test Loss: 1.010 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9125638008117676
Epoch: 19, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.901 Vali Acc: 0.450 Test Loss: 0.901 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7424538135528564
Epoch: 20, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.807 Vali Acc: 0.470 Test Loss: 0.807 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.2214508056640625
Epoch: 21, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.186528444290161
Epoch: 22, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549993).  Saving model ...
Epoch: 23 cost time: 3.997274398803711
Epoch: 23, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.950 Vali Acc: 0.440 Test Loss: 0.950 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9055707454681396
Epoch: 24, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.991 Vali Acc: 0.510 Test Loss: 0.991 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.198568105697632
Epoch: 25, Steps: 20 | Train Loss: 1.082 Vali Loss: 1.320 Vali Acc: 0.490 Test Loss: 1.320 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.842864990234375
Epoch: 26, Steps: 20 | Train Loss: 0.978 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.131742000579834
Epoch: 27, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.6478681564331055
Epoch: 28, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.4599766731262207
Epoch: 29, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.865 Vali Acc: 0.540 Test Loss: 0.865 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.2227067947387695
Epoch: 30, Steps: 20 | Train Loss: 1.011 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.70930814743042
Epoch: 31, Steps: 20 | Train Loss: 0.654 Vali Loss: 1.085 Vali Acc: 0.430 Test Loss: 1.085 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.705146551132202
Epoch: 32, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.683 Vali Acc: 0.570 Test Loss: 0.683 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 33 cost time: 4.453541040420532
Epoch: 33, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.904 Vali Acc: 0.490 Test Loss: 0.904 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.6634957790374756
Epoch: 34, Steps: 20 | Train Loss: 0.903 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.028242826461792
Epoch: 35, Steps: 20 | Train Loss: 0.860 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.0749335289001465
Epoch: 36, Steps: 20 | Train Loss: 0.760 Vali Loss: 1.179 Vali Acc: 0.490 Test Loss: 1.179 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.933574676513672
Epoch: 37, Steps: 20 | Train Loss: 1.009 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.7039096355438232
Epoch: 38, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.050250768661499
Epoch: 39, Steps: 20 | Train Loss: 0.860 Vali Loss: 0.695 Vali Acc: 0.450 Test Loss: 0.695 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.9076480865478516
Epoch: 40, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.129178762435913
Epoch: 41, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.7629246711730957
Epoch: 42, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 11154994
model size : 47.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.57905650138855
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 3.264129400253296
Epoch: 2, Steps: 20 | Train Loss: 0.973 Vali Loss: 0.943 Vali Acc: 0.490 Test Loss: 0.943 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6265313625335693
Epoch: 3, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 2.8534128665924072
Epoch: 4, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.910 Vali Acc: 0.470 Test Loss: 0.910 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.276764392852783
Epoch: 5, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4950265884399414
Epoch: 6, Steps: 20 | Train Loss: 0.886 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 3.363778591156006
Epoch: 7, Steps: 20 | Train Loss: 0.919 Vali Loss: 1.180 Vali Acc: 0.510 Test Loss: 1.180 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.978191375732422
Epoch: 8, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 3.599475145339966
Epoch: 9, Steps: 20 | Train Loss: 0.835 Vali Loss: 0.906 Vali Acc: 0.570 Test Loss: 0.906 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569991).  Saving model ...
Epoch: 10 cost time: 3.409569025039673
Epoch: 10, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.302 Vali Acc: 0.510 Test Loss: 1.302 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2619762420654297
Epoch: 11, Steps: 20 | Train Loss: 1.333 Vali Loss: 1.443 Vali Acc: 0.490 Test Loss: 1.443 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7990498542785645
Epoch: 12, Steps: 20 | Train Loss: 0.856 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.164616823196411
Epoch: 13, Steps: 20 | Train Loss: 0.761 Vali Loss: 1.316 Vali Acc: 0.490 Test Loss: 1.316 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.235183000564575
Epoch: 14, Steps: 20 | Train Loss: 0.903 Vali Loss: 0.772 Vali Acc: 0.440 Test Loss: 0.772 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7375075817108154
Epoch: 15, Steps: 20 | Train Loss: 0.875 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.083224058151245
Epoch: 16, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.918 Vali Acc: 0.480 Test Loss: 0.918 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.881472587585449
Epoch: 17, Steps: 20 | Train Loss: 0.815 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.5430197715759277
Epoch: 18, Steps: 20 | Train Loss: 0.962 Vali Loss: 1.218 Vali Acc: 0.510 Test Loss: 1.218 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.9307186603546143
Epoch: 19, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.933 Vali Acc: 0.530 Test Loss: 0.933 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 11152434
model size : 47.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.112541913986206
Epoch: 1, Steps: 20 | Train Loss: 0.891 Vali Loss: 1.228 Vali Acc: 0.490 Test Loss: 1.228 Test Acc: 0.490
Validation loss decreased (inf --> -0.489988).  Saving model ...
Epoch: 2 cost time: 2.834836959838867
Epoch: 2, Steps: 20 | Train Loss: 1.102 Vali Loss: 1.003 Vali Acc: 0.510 Test Loss: 1.003 Test Acc: 0.510
Validation loss decreased (-0.489988 --> -0.509990).  Saving model ...
Epoch: 3 cost time: 3.893423080444336
Epoch: 3, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
Validation loss decreased (-0.509990 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.9545981884002686
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6850240230560303
Epoch: 5, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.954 Vali Acc: 0.480 Test Loss: 0.954 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.071654558181763
Epoch: 6, Steps: 20 | Train Loss: 0.841 Vali Loss: 1.007 Vali Acc: 0.510 Test Loss: 1.007 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5307531356811523
Epoch: 7, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.930 Vali Acc: 0.490 Test Loss: 0.930 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.170765399932861
Epoch: 8, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.244205713272095
Epoch: 9, Steps: 20 | Train Loss: 0.981 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2771155834198
Epoch: 10, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.725437641143799
Epoch: 11, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.987 Vali Acc: 0.540 Test Loss: 0.987 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9666638374328613
Epoch: 12, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.476325035095215
Epoch: 13, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9321522
model size : 40.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.69998025894165
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.025 Vali Acc: 0.480 Test Loss: 1.025 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 3.3127036094665527
Epoch: 2, Steps: 20 | Train Loss: 0.889 Vali Loss: 1.603 Vali Acc: 0.490 Test Loss: 1.603 Test Acc: 0.490
Validation loss decreased (-0.479990 --> -0.489984).  Saving model ...
Epoch: 3 cost time: 3.04526686668396
Epoch: 3, Steps: 20 | Train Loss: 1.085 Vali Loss: 1.126 Vali Acc: 0.490 Test Loss: 1.126 Test Acc: 0.490
Validation loss decreased (-0.489984 --> -0.489989).  Saving model ...
Epoch: 4 cost time: 2.870875835418701
Epoch: 4, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.688 Vali Acc: 0.570 Test Loss: 0.688 Test Acc: 0.570
Validation loss decreased (-0.489989 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 3.224313974380493
Epoch: 5, Steps: 20 | Train Loss: 0.950 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.795314788818359
Epoch: 6, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.376388072967529
Epoch: 7, Steps: 20 | Train Loss: 0.886 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9450957775115967
Epoch: 8, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.002529621124268
Epoch: 9, Steps: 20 | Train Loss: 0.991 Vali Loss: 1.148 Vali Acc: 0.510 Test Loss: 1.148 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.534823656082153
Epoch: 10, Steps: 20 | Train Loss: 0.908 Vali Loss: 1.261 Vali Acc: 0.510 Test Loss: 1.261 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8560633659362793
Epoch: 11, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.825 Vali Acc: 0.430 Test Loss: 0.825 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.044208765029907
Epoch: 12, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.990 Vali Acc: 0.490 Test Loss: 0.990 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.924896717071533
Epoch: 13, Steps: 20 | Train Loss: 1.074 Vali Loss: 0.831 Vali Acc: 0.530 Test Loss: 0.831 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9648969173431396
Epoch: 14, Steps: 20 | Train Loss: 0.838 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9318962
model size : 40.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.26111912727356
Epoch: 1, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.1773171424865723
Epoch: 2, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.826 Vali Acc: 0.460 Test Loss: 0.826 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.591235876083374
Epoch: 3, Steps: 20 | Train Loss: 0.953 Vali Loss: 0.679 Vali Acc: 0.530 Test Loss: 0.679 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 3.5544705390930176
Epoch: 4, Steps: 20 | Train Loss: 0.972 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.809087038040161
Epoch: 5, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.527860403060913
Epoch: 6, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.960 Vali Acc: 0.490 Test Loss: 0.960 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2333595752716064
Epoch: 7, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.172163963317871
Epoch: 8, Steps: 20 | Train Loss: 0.832 Vali Loss: 1.027 Vali Acc: 0.490 Test Loss: 1.027 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9726760387420654
Epoch: 9, Steps: 20 | Train Loss: 1.218 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5785326957702637
Epoch: 10, Steps: 20 | Train Loss: 0.912 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8020501136779785
Epoch: 11, Steps: 20 | Train Loss: 0.970 Vali Loss: 0.980 Vali Acc: 0.510 Test Loss: 0.980 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8809492588043213
Epoch: 12, Steps: 20 | Train Loss: 0.952 Vali Loss: 1.116 Vali Acc: 0.510 Test Loss: 1.116 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9929399490356445
Epoch: 13, Steps: 20 | Train Loss: 0.951 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 9316402
model size : 40.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.93294882774353
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.1748714447021484
Epoch: 2, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.037949800491333
Epoch: 3, Steps: 20 | Train Loss: 0.853 Vali Loss: 0.929 Vali Acc: 0.490 Test Loss: 0.929 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.898738384246826
Epoch: 4, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2032828330993652
Epoch: 5, Steps: 20 | Train Loss: 0.866 Vali Loss: 1.310 Vali Acc: 0.510 Test Loss: 1.310 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.160386562347412
Epoch: 6, Steps: 20 | Train Loss: 0.952 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.89858078956604
Epoch: 7, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.871 Vali Acc: 0.480 Test Loss: 0.871 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.657064914703369
Epoch: 8, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 2.5337517261505127
Epoch: 9, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 2.5269179344177246
Epoch: 10, Steps: 20 | Train Loss: 1.038 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0123708248138428
Epoch: 11, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 2.7760305404663086
Epoch: 12, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.881 Vali Acc: 0.520 Test Loss: 0.881 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.525704860687256
Epoch: 13, Steps: 20 | Train Loss: 0.781 Vali Loss: 1.251 Vali Acc: 0.580 Test Loss: 1.251 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579987).  Saving model ...
Epoch: 14 cost time: 2.526512622833252
Epoch: 14, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.831 Vali Acc: 0.530 Test Loss: 0.831 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5480518341064453
Epoch: 15, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.824 Vali Acc: 0.600 Test Loss: 0.824 Test Acc: 0.600
Validation loss decreased (-0.579987 --> -0.599992).  Saving model ...
Epoch: 16 cost time: 3.518195867538452
Epoch: 16, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.714 Vali Acc: 0.550 Test Loss: 0.714 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0943503379821777
Epoch: 17, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.77909779548645
Epoch: 18, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.187929391860962
Epoch: 19, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.987 Vali Acc: 0.470 Test Loss: 0.987 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1086983680725098
Epoch: 20, Steps: 20 | Train Loss: 0.888 Vali Loss: 1.097 Vali Acc: 0.480 Test Loss: 1.097 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1823878288269043
Epoch: 21, Steps: 20 | Train Loss: 0.787 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.824057102203369
Epoch: 22, Steps: 20 | Train Loss: 0.902 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.0070366859436035
Epoch: 23, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.051459550857544
Epoch: 24, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.657566547393799
Epoch: 25, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9313842
model size : 40.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.36431622505188
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.3448569774627686
Epoch: 2, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.619051933288574
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 1.008 Vali Acc: 0.520 Test Loss: 1.008 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519990).  Saving model ...
Epoch: 4 cost time: 3.5679051876068115
Epoch: 4, Steps: 20 | Train Loss: 0.803 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 4.169487237930298
Epoch: 5, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.91716742515564
Epoch: 6, Steps: 20 | Train Loss: 0.737 Vali Loss: 1.305 Vali Acc: 0.490 Test Loss: 1.305 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.2870354652404785
Epoch: 7, Steps: 20 | Train Loss: 0.909 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9260456562042236
Epoch: 8, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.769 Vali Acc: 0.630 Test Loss: 0.769 Test Acc: 0.630
Validation loss decreased (-0.529992 --> -0.629992).  Saving model ...
Epoch: 9 cost time: 4.033848524093628
Epoch: 9, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.828 Vali Acc: 0.510 Test Loss: 0.828 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9070589542388916
Epoch: 10, Steps: 20 | Train Loss: 0.843 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9230406284332275
Epoch: 11, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.906 Vali Acc: 0.540 Test Loss: 0.906 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.40308141708374
Epoch: 12, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.747770071029663
Epoch: 13, Steps: 20 | Train Loss: 1.006 Vali Loss: 1.488 Vali Acc: 0.490 Test Loss: 1.488 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.107336521148682
Epoch: 14, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.989 Vali Acc: 0.470 Test Loss: 0.989 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8298234939575195
Epoch: 15, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.887 Vali Acc: 0.480 Test Loss: 0.887 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.712387800216675
Epoch: 16, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.735186815261841
Epoch: 17, Steps: 20 | Train Loss: 0.921 Vali Loss: 0.908 Vali Acc: 0.490 Test Loss: 0.908 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.400346994400024
Epoch: 18, Steps: 20 | Train Loss: 0.953 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 8402226
model size : 37.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.465456008911133
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.235593795776367
Epoch: 2, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.4888041019439697
Epoch: 3, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 2.6279444694519043
Epoch: 4, Steps: 20 | Train Loss: 0.794 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 5 cost time: 3.3654890060424805
Epoch: 5, Steps: 20 | Train Loss: 0.911 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 3.979180097579956
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 3.4367246627807617
Epoch: 7, Steps: 20 | Train Loss: 0.902 Vali Loss: 1.078 Vali Acc: 0.580 Test Loss: 1.078 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579989).  Saving model ...
Epoch: 8 cost time: 3.120532512664795
Epoch: 8, Steps: 20 | Train Loss: 0.972 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.528393507003784
Epoch: 9, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5081300735473633
Epoch: 10, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.964 Vali Acc: 0.520 Test Loss: 0.964 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.746758460998535
Epoch: 11, Steps: 20 | Train Loss: 0.861 Vali Loss: 1.346 Vali Acc: 0.460 Test Loss: 1.346 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4398226737976074
Epoch: 12, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.010 Vali Acc: 0.530 Test Loss: 1.010 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1703455448150635
Epoch: 13, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.713 Vali Acc: 0.570 Test Loss: 0.713 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4328713417053223
Epoch: 14, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.543860673904419
Epoch: 15, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7772066593170166
Epoch: 16, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.810 Vali Acc: 0.510 Test Loss: 0.810 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.5430991649627686
Epoch: 17, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.856 Vali Acc: 0.490 Test Loss: 0.856 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8399666
model size : 37.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.1241981983184814
Epoch: 1, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.26088547706604
Epoch: 2, Steps: 20 | Train Loss: 0.860 Vali Loss: 0.879 Vali Acc: 0.480 Test Loss: 0.879 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3520655632019043
Epoch: 3, Steps: 20 | Train Loss: 0.895 Vali Loss: 1.123 Vali Acc: 0.490 Test Loss: 1.123 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5698578357696533
Epoch: 4, Steps: 20 | Train Loss: 0.885 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 3.5199804306030273
Epoch: 5, Steps: 20 | Train Loss: 0.863 Vali Loss: 1.076 Vali Acc: 0.490 Test Loss: 1.076 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5373950004577637
Epoch: 6, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.473924160003662
Epoch: 7, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.274918794631958
Epoch: 8, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.721465826034546
Epoch: 9, Steps: 20 | Train Loss: 0.762 Vali Loss: 1.033 Vali Acc: 0.500 Test Loss: 1.033 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.554945468902588
Epoch: 10, Steps: 20 | Train Loss: 0.833 Vali Loss: 0.952 Vali Acc: 0.480 Test Loss: 0.952 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5201258659362793
Epoch: 11, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.974 Vali Acc: 0.490 Test Loss: 0.974 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.643237829208374
Epoch: 12, Steps: 20 | Train Loss: 0.807 Vali Loss: 1.470 Vali Acc: 0.460 Test Loss: 1.470 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.5050790309906006
Epoch: 13, Steps: 20 | Train Loss: 0.740 Vali Loss: 1.006 Vali Acc: 0.510 Test Loss: 1.006 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9812827110290527
Epoch: 14, Steps: 20 | Train Loss: 0.729 Vali Loss: 1.262 Vali Acc: 0.470 Test Loss: 1.262 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 8397106
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.693705797195435
Epoch: 1, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.6212236881256104
Epoch: 2, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 3.715364456176758
Epoch: 3, Steps: 20 | Train Loss: 0.826 Vali Loss: 1.128 Vali Acc: 0.510 Test Loss: 1.128 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509989).  Saving model ...
Epoch: 4 cost time: 4.067378759384155
Epoch: 4, Steps: 20 | Train Loss: 0.767 Vali Loss: 1.019 Vali Acc: 0.480 Test Loss: 1.019 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.261667251586914
Epoch: 5, Steps: 20 | Train Loss: 0.856 Vali Loss: 2.043 Vali Acc: 0.510 Test Loss: 2.043 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.334258794784546
Epoch: 6, Steps: 20 | Train Loss: 1.040 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6878855228424072
Epoch: 7, Steps: 20 | Train Loss: 0.788 Vali Loss: 1.747 Vali Acc: 0.490 Test Loss: 1.747 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.796771764755249
Epoch: 8, Steps: 20 | Train Loss: 1.002 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (-0.509989 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 3.819814443588257
Epoch: 9, Steps: 20 | Train Loss: 0.903 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5235395431518555
Epoch: 10, Steps: 20 | Train Loss: 0.820 Vali Loss: 0.923 Vali Acc: 0.490 Test Loss: 0.923 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4367730617523193
Epoch: 11, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 4.383342027664185
Epoch: 12, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.758 Vali Acc: 0.490 Test Loss: 0.758 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.13637638092041
Epoch: 13, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.299978971481323
Epoch: 14, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.937 Vali Acc: 0.460 Test Loss: 0.937 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.0077064037323
Epoch: 15, Steps: 20 | Train Loss: 0.722 Vali Loss: 1.441 Vali Acc: 0.490 Test Loss: 1.441 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.785949230194092
Epoch: 16, Steps: 20 | Train Loss: 1.479 Vali Loss: 1.240 Vali Acc: 0.510 Test Loss: 1.240 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.04160475730896
Epoch: 17, Steps: 20 | Train Loss: 0.952 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.0223565101623535
Epoch: 18, Steps: 20 | Train Loss: 0.911 Vali Loss: 1.242 Vali Acc: 0.490 Test Loss: 1.242 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3696506023406982
Epoch: 19, Steps: 20 | Train Loss: 0.999 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2629125118255615
Epoch: 20, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.797 Vali Acc: 0.470 Test Loss: 0.797 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6672632694244385
Epoch: 21, Steps: 20 | Train Loss: 0.961 Vali Loss: 0.910 Vali Acc: 0.470 Test Loss: 0.910 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 8394546
model size : 37.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.009454965591431
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.5896434783935547
Epoch: 2, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.531280755996704
Epoch: 3, Steps: 20 | Train Loss: 0.857 Vali Loss: 1.791 Vali Acc: 0.490 Test Loss: 1.791 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.547860622406006
Epoch: 4, Steps: 20 | Train Loss: 0.967 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.278416872024536
Epoch: 5, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.227 Vali Acc: 0.430 Test Loss: 1.227 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.288348436355591
Epoch: 6, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3840534687042236
Epoch: 7, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 3.4897241592407227
Epoch: 8, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.958 Vali Acc: 0.460 Test Loss: 0.958 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.604292631149292
Epoch: 9, Steps: 20 | Train Loss: 0.831 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.557429075241089
Epoch: 10, Steps: 20 | Train Loss: 0.854 Vali Loss: 1.200 Vali Acc: 0.470 Test Loss: 1.200 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.208404779434204
Epoch: 11, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.827 Vali Acc: 0.530 Test Loss: 0.827 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6935245990753174
Epoch: 12, Steps: 20 | Train Loss: 0.840 Vali Loss: 0.857 Vali Acc: 0.570 Test Loss: 0.857 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 13 cost time: 2.5940122604370117
Epoch: 13, Steps: 20 | Train Loss: 0.856 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.263855457305908
Epoch: 14, Steps: 20 | Train Loss: 0.817 Vali Loss: 1.078 Vali Acc: 0.510 Test Loss: 1.078 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.662609577178955
Epoch: 15, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.506448984146118
Epoch: 16, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.538823366165161
Epoch: 17, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.949 Vali Acc: 0.470 Test Loss: 0.949 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5031633377075195
Epoch: 18, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7969677448272705
Epoch: 19, Steps: 20 | Train Loss: 0.988 Vali Loss: 1.079 Vali Acc: 0.560 Test Loss: 1.079 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5166285037994385
Epoch: 20, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.308886766433716
Epoch: 21, Steps: 20 | Train Loss: 0.980 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8446810245513916
Epoch: 22, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.923 Vali Acc: 0.580 Test Loss: 0.923 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 23 cost time: 3.4480035305023193
Epoch: 23, Steps: 20 | Train Loss: 0.896 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8653438091278076
Epoch: 24, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3124101161956787
Epoch: 25, Steps: 20 | Train Loss: 0.806 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1142914295196533
Epoch: 26, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3457701206207275
Epoch: 27, Steps: 20 | Train Loss: 0.594 Vali Loss: 2.117 Vali Acc: 0.480 Test Loss: 2.117 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.8405535221099854
Epoch: 28, Steps: 20 | Train Loss: 0.853 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.3147990703582764
Epoch: 29, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.956 Vali Acc: 0.480 Test Loss: 0.956 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.6879937648773193
Epoch: 30, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.996 Vali Acc: 0.540 Test Loss: 0.996 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.5803604125976562
Epoch: 31, Steps: 20 | Train Loss: 0.685 Vali Loss: 1.182 Vali Acc: 0.490 Test Loss: 1.182 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.8115336894989014
Epoch: 32, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.789 Vali Acc: 0.500 Test Loss: 1.789 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 7942578
model size : 35.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.786722183227539
Epoch: 1, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 3.4165287017822266
Epoch: 2, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.961 Vali Acc: 0.460 Test Loss: 0.961 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6551952362060547
Epoch: 3, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 3.366406202316284
Epoch: 4, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7637767791748047
Epoch: 5, Steps: 20 | Train Loss: 0.709 Vali Loss: 1.886 Vali Acc: 0.490 Test Loss: 1.886 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7207889556884766
Epoch: 6, Steps: 20 | Train Loss: 1.230 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6866750717163086
Epoch: 7, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 3.4342494010925293
Epoch: 8, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9531447887420654
Epoch: 9, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1295249462127686
Epoch: 10, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 11 cost time: 2.9223690032958984
Epoch: 11, Steps: 20 | Train Loss: 0.913 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.891333818435669
Epoch: 12, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.895 Vali Acc: 0.550 Test Loss: 0.895 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549991).  Saving model ...
Epoch: 13 cost time: 3.786515474319458
Epoch: 13, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.946 Vali Acc: 0.470 Test Loss: 0.946 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.762981414794922
Epoch: 14, Steps: 20 | Train Loss: 0.868 Vali Loss: 0.784 Vali Acc: 0.580 Test Loss: 0.784 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 2.8039491176605225
Epoch: 15, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.892 Vali Acc: 0.520 Test Loss: 0.892 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2890727519989014
Epoch: 16, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.766 Vali Acc: 0.630 Test Loss: 0.766 Test Acc: 0.630
Validation loss decreased (-0.579992 --> -0.629992).  Saving model ...
Epoch: 17 cost time: 3.8654377460479736
Epoch: 17, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.945 Vali Acc: 0.440 Test Loss: 0.945 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.968686103820801
Epoch: 18, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.745 Vali Acc: 0.450 Test Loss: 0.745 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4603731632232666
Epoch: 19, Steps: 20 | Train Loss: 0.804 Vali Loss: 1.063 Vali Acc: 0.510 Test Loss: 1.063 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.018136501312256
Epoch: 20, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7800710201263428
Epoch: 21, Steps: 20 | Train Loss: 0.725 Vali Loss: 1.201 Vali Acc: 0.440 Test Loss: 1.201 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3845667839050293
Epoch: 22, Steps: 20 | Train Loss: 0.727 Vali Loss: 1.513 Vali Acc: 0.480 Test Loss: 1.513 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6258342266082764
Epoch: 23, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.918 Vali Acc: 0.490 Test Loss: 0.918 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.5801262855529785
Epoch: 24, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.972 Vali Acc: 0.470 Test Loss: 0.972 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0538809299468994
Epoch: 25, Steps: 20 | Train Loss: 0.887 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.850961685180664
Epoch: 26, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.853 Vali Acc: 0.480 Test Loss: 0.853 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 7940018
model size : 35.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.739121198654175
Epoch: 1, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.696347236633301
Epoch: 2, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.482104301452637
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.776118040084839
Epoch: 4, Steps: 20 | Train Loss: 0.882 Vali Loss: 1.001 Vali Acc: 0.510 Test Loss: 1.001 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9944615364074707
Epoch: 5, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.747223377227783
Epoch: 6, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.682708978652954
Epoch: 7, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 8 cost time: 3.171980381011963
Epoch: 8, Steps: 20 | Train Loss: 0.933 Vali Loss: 1.113 Vali Acc: 0.490 Test Loss: 1.113 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3179147243499756
Epoch: 9, Steps: 20 | Train Loss: 0.922 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.071916103363037
Epoch: 10, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529992).  Saving model ...
Epoch: 11 cost time: 3.7980284690856934
Epoch: 11, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 4.067229509353638
Epoch: 12, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.012 Vali Acc: 0.530 Test Loss: 1.012 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5651886463165283
Epoch: 13, Steps: 20 | Train Loss: 0.885 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9320778846740723
Epoch: 14, Steps: 20 | Train Loss: 0.888 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2393088340759277
Epoch: 15, Steps: 20 | Train Loss: 0.722 Vali Loss: 1.029 Vali Acc: 0.510 Test Loss: 1.029 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7192585468292236
Epoch: 16, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.035300016403198
Epoch: 17, Steps: 20 | Train Loss: 0.877 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.057125091552734
Epoch: 18, Steps: 20 | Train Loss: 1.003 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.044514417648315
Epoch: 19, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.66760516166687
Epoch: 20, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.150259971618652
Epoch: 21, Steps: 20 | Train Loss: 0.777 Vali Loss: 1.042 Vali Acc: 0.470 Test Loss: 1.042 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 7937458
model size : 35.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.051046133041382
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 3.795358896255493
Epoch: 2, Steps: 20 | Train Loss: 0.796 Vali Loss: 1.090 Vali Acc: 0.460 Test Loss: 1.090 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9016716480255127
Epoch: 3, Steps: 20 | Train Loss: 0.909 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.579766273498535
Epoch: 4, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7447128295898438
Epoch: 5, Steps: 20 | Train Loss: 0.730 Vali Loss: 1.115 Vali Acc: 0.490 Test Loss: 1.115 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3907947540283203
Epoch: 6, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 3.6017003059387207
Epoch: 7, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3394463062286377
Epoch: 8, Steps: 20 | Train Loss: 0.906 Vali Loss: 0.812 Vali Acc: 0.460 Test Loss: 0.812 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1731956005096436
Epoch: 9, Steps: 20 | Train Loss: 0.840 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.124654769897461
Epoch: 10, Steps: 20 | Train Loss: 0.835 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 2.4965178966522217
Epoch: 11, Steps: 20 | Train Loss: 0.700 Vali Loss: 1.015 Vali Acc: 0.490 Test Loss: 1.015 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.844266891479492
Epoch: 12, Steps: 20 | Train Loss: 0.856 Vali Loss: 0.941 Vali Acc: 0.470 Test Loss: 0.941 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.541534662246704
Epoch: 13, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1753294467926025
Epoch: 14, Steps: 20 | Train Loss: 0.831 Vali Loss: 0.984 Vali Acc: 0.510 Test Loss: 0.984 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0298750400543213
Epoch: 15, Steps: 20 | Train Loss: 0.876 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9815573692321777
Epoch: 16, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2675509452819824
Epoch: 17, Steps: 20 | Train Loss: 0.931 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1540489196777344
Epoch: 18, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.970 Vali Acc: 0.490 Test Loss: 0.970 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2128329277038574
Epoch: 19, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.909 Vali Acc: 0.480 Test Loss: 0.909 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3447446823120117
Epoch: 20, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 7934898
model size : 35.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.896161079406738
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.0213570594787598
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.245366334915161
Epoch: 3, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 3.1555609703063965
Epoch: 4, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.415870189666748
Epoch: 5, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.879884719848633
Epoch: 6, Steps: 20 | Train Loss: 0.736 Vali Loss: 1.258 Vali Acc: 0.490 Test Loss: 1.258 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2419583797454834
Epoch: 7, Steps: 20 | Train Loss: 0.864 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2662816047668457
Epoch: 8, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1576287746429443
Epoch: 9, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.8602235317230225
Epoch: 10, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.612889051437378
Epoch: 11, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7759077548980713
Epoch: 12, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.933316946029663
Epoch: 13, Steps: 20 | Train Loss: 0.808 Vali Loss: 1.359 Vali Acc: 0.490 Test Loss: 1.359 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3748658
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8314967155456543
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.0796661376953125
Epoch: 2, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.965 Vali Acc: 0.500 Test Loss: 0.965 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.951652765274048
Epoch: 3, Steps: 20 | Train Loss: 0.841 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 2.8048853874206543
Epoch: 4, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.1704115867614746
Epoch: 5, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.2796146869659424
Epoch: 6, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.442873239517212
Epoch: 7, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.137 Vali Acc: 0.460 Test Loss: 1.137 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.575021505355835
Epoch: 8, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7140238285064697
Epoch: 9, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579993).  Saving model ...
Epoch: 10 cost time: 3.6491942405700684
Epoch: 10, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6796505451202393
Epoch: 11, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9850292205810547
Epoch: 12, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9897847175598145
Epoch: 13, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.843 Vali Acc: 0.480 Test Loss: 0.843 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4893743991851807
Epoch: 14, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.890 Vali Acc: 0.570 Test Loss: 0.890 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.267164707183838
Epoch: 15, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.290 Vali Acc: 0.490 Test Loss: 1.290 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.375925064086914
Epoch: 16, Steps: 20 | Train Loss: 1.164 Vali Loss: 1.293 Vali Acc: 0.510 Test Loss: 1.293 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.599097728729248
Epoch: 17, Steps: 20 | Train Loss: 0.887 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.237473726272583
Epoch: 18, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.640672445297241
Epoch: 19, Steps: 20 | Train Loss: 0.923 Vali Loss: 1.141 Vali Acc: 0.510 Test Loss: 1.141 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3747378
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.468120336532593
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.682516574859619
Epoch: 2, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.5043044090270996
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 1.083 Vali Acc: 0.480 Test Loss: 1.083 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.276146173477173
Epoch: 4, Steps: 20 | Train Loss: 0.867 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3548929691314697
Epoch: 5, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 3.6798553466796875
Epoch: 6, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.722 Vali Acc: 0.580 Test Loss: 0.722 Test Acc: 0.580
Validation loss decreased (-0.529991 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 3.6670517921447754
Epoch: 7, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.816 Vali Acc: 0.460 Test Loss: 0.816 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.693187713623047
Epoch: 8, Steps: 20 | Train Loss: 0.881 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.847944974899292
Epoch: 9, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.847 Vali Acc: 0.470 Test Loss: 0.847 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8281922340393066
Epoch: 10, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.026193141937256
Epoch: 11, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.7577669620513916
Epoch: 12, Steps: 20 | Train Loss: 0.773 Vali Loss: 1.101 Vali Acc: 0.480 Test Loss: 1.101 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9294631481170654
Epoch: 13, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6704022884368896
Epoch: 14, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6305572986602783
Epoch: 15, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.806795120239258
Epoch: 16, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3746098
model size : 16.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.9513258934021
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.5871541500091553
Epoch: 2, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.466473340988159
Epoch: 3, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2338144779205322
Epoch: 4, Steps: 20 | Train Loss: 0.774 Vali Loss: 1.152 Vali Acc: 0.490 Test Loss: 1.152 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489988).  Saving model ...
Epoch: 5 cost time: 3.0509653091430664
Epoch: 5, Steps: 20 | Train Loss: 0.997 Vali Loss: 0.892 Vali Acc: 0.530 Test Loss: 0.892 Test Acc: 0.530
Validation loss decreased (-0.489988 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 3.205939292907715
Epoch: 6, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.678 Vali Acc: 0.560 Test Loss: 0.678 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 3.956291913986206
Epoch: 7, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.876 Vali Acc: 0.480 Test Loss: 0.876 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8841755390167236
Epoch: 8, Steps: 20 | Train Loss: 0.689 Vali Loss: 1.051 Vali Acc: 0.490 Test Loss: 1.051 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9672694206237793
Epoch: 9, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.776 Vali Acc: 0.460 Test Loss: 0.776 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3461010456085205
Epoch: 10, Steps: 20 | Train Loss: 0.789 Vali Loss: 1.408 Vali Acc: 0.510 Test Loss: 1.408 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0815489292144775
Epoch: 11, Steps: 20 | Train Loss: 0.920 Vali Loss: 1.330 Vali Acc: 0.480 Test Loss: 1.330 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4981281757354736
Epoch: 12, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.468231439590454
Epoch: 13, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.559812307357788
Epoch: 14, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7922520637512207
Epoch: 15, Steps: 20 | Train Loss: 0.718 Vali Loss: 1.012 Vali Acc: 0.520 Test Loss: 1.012 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.881107807159424
Epoch: 16, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.101 Vali Acc: 0.510 Test Loss: 1.101 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3744818
model size : 16.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.4645094871521
Epoch: 1, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.5770585536956787
Epoch: 2, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 2.801985740661621
Epoch: 3, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 2.5446245670318604
Epoch: 4, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.797 Vali Acc: 0.470 Test Loss: 0.797 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.565516948699951
Epoch: 5, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 3.673611879348755
Epoch: 6, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2979445457458496
Epoch: 7, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.605480670928955
Epoch: 8, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.785 Vali Acc: 0.440 Test Loss: 0.785 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.30629301071167
Epoch: 9, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.516267776489258
Epoch: 10, Steps: 20 | Train Loss: 0.736 Vali Loss: 1.100 Vali Acc: 0.490 Test Loss: 1.100 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.667168617248535
Epoch: 11, Steps: 20 | Train Loss: 0.851 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 3.4943687915802
Epoch: 12, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.934 Vali Acc: 0.510 Test Loss: 0.934 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4438891410827637
Epoch: 13, Steps: 20 | Train Loss: 0.724 Vali Loss: 1.005 Vali Acc: 0.470 Test Loss: 1.005 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3403854370117188
Epoch: 14, Steps: 20 | Train Loss: 0.710 Vali Loss: 1.088 Vali Acc: 0.440 Test Loss: 1.088 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.342750072479248
Epoch: 15, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.395514965057373
Epoch: 16, Steps: 20 | Train Loss: 0.753 Vali Loss: 1.478 Vali Acc: 0.490 Test Loss: 1.478 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.5507638454437256
Epoch: 17, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.831 Vali Acc: 0.480 Test Loss: 0.831 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.58092999458313
Epoch: 18, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.801 Vali Acc: 0.560 Test Loss: 0.801 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 19 cost time: 2.7865781784057617
Epoch: 19, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.794 Vali Acc: 0.530 Test Loss: 0.794 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.059490203857422
Epoch: 20, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.994 Vali Acc: 0.530 Test Loss: 0.994 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.265899419784546
Epoch: 21, Steps: 20 | Train Loss: 0.699 Vali Loss: 1.074 Vali Acc: 0.520 Test Loss: 1.074 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5519299507141113
Epoch: 22, Steps: 20 | Train Loss: 0.779 Vali Loss: 1.184 Vali Acc: 0.550 Test Loss: 1.184 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4202194213867188
Epoch: 23, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.930 Vali Acc: 0.490 Test Loss: 0.930 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.445368528366089
Epoch: 24, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.030 Vali Acc: 0.510 Test Loss: 1.030 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.996553897857666
Epoch: 25, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.93115496635437
Epoch: 26, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.947 Vali Acc: 0.540 Test Loss: 0.947 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3211467266082764
Epoch: 27, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.976 Vali Acc: 0.460 Test Loss: 0.976 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.7873804569244385
Epoch: 28, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2827570
model size : 13.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.437711954116821
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.4545412063598633
Epoch: 2, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 3.8075168132781982
Epoch: 3, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.455655813217163
Epoch: 4, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.028587818145752
Epoch: 5, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.495 Vali Acc: 0.490 Test Loss: 1.495 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.143657922744751
Epoch: 6, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.400533676147461
Epoch: 7, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.615328788757324
Epoch: 8, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.396 Vali Acc: 0.490 Test Loss: 1.396 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4120755195617676
Epoch: 9, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.903 Vali Acc: 0.510 Test Loss: 0.903 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.343905210494995
Epoch: 10, Steps: 20 | Train Loss: 0.944 Vali Loss: 0.838 Vali Acc: 0.440 Test Loss: 0.838 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.633735179901123
Epoch: 11, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 3.1039011478424072
Epoch: 12, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 3.184887647628784
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.924 Vali Acc: 0.510 Test Loss: 0.924 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7717747688293457
Epoch: 14, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.826 Vali Acc: 0.470 Test Loss: 0.826 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6330294609069824
Epoch: 15, Steps: 20 | Train Loss: 0.658 Vali Loss: 1.006 Vali Acc: 0.520 Test Loss: 1.006 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.325892925262451
Epoch: 16, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.881 Vali Acc: 0.540 Test Loss: 0.881 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.190439462661743
Epoch: 17, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.885 Vali Acc: 0.600 Test Loss: 0.885 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 18 cost time: 3.781682252883911
Epoch: 18, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7228920459747314
Epoch: 19, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.927 Vali Acc: 0.520 Test Loss: 0.927 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8941900730133057
Epoch: 20, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.989 Vali Acc: 0.470 Test Loss: 0.989 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.726489543914795
Epoch: 21, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.958 Vali Acc: 0.530 Test Loss: 0.958 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.3468213081359863
Epoch: 22, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.940 Vali Acc: 0.460 Test Loss: 0.940 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.213465690612793
Epoch: 23, Steps: 20 | Train Loss: 0.594 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3976118564605713
Epoch: 24, Steps: 20 | Train Loss: 0.742 Vali Loss: 1.038 Vali Acc: 0.460 Test Loss: 1.038 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.716459274291992
Epoch: 25, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.947 Vali Acc: 0.460 Test Loss: 0.947 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.158132076263428
Epoch: 26, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.241 Vali Acc: 0.440 Test Loss: 1.241 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.093561172485352
Epoch: 27, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2826290
model size : 13.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.660153388977051
Epoch: 1, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.824 Vali Acc: 0.440 Test Loss: 0.824 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.705918312072754
Epoch: 2, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.849 Vali Acc: 0.470 Test Loss: 0.849 Test Acc: 0.470
Validation loss decreased (-0.439992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 2.5565860271453857
Epoch: 3, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.4695777893066406
Epoch: 4, Steps: 20 | Train Loss: 0.935 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.990546703338623
Epoch: 5, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 4.090015172958374
Epoch: 6, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.874 Vali Acc: 0.470 Test Loss: 0.874 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7978134155273438
Epoch: 7, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7887229919433594
Epoch: 8, Steps: 20 | Train Loss: 0.926 Vali Loss: 1.416 Vali Acc: 0.490 Test Loss: 1.416 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4458417892456055
Epoch: 9, Steps: 20 | Train Loss: 0.951 Vali Loss: 0.868 Vali Acc: 0.490 Test Loss: 0.868 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6665337085723877
Epoch: 10, Steps: 20 | Train Loss: 0.894 Vali Loss: 0.681 Vali Acc: 0.580 Test Loss: 0.681 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 3.611666679382324
Epoch: 11, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3169374465942383
Epoch: 12, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.891 Vali Acc: 0.510 Test Loss: 0.891 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5251519680023193
Epoch: 13, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.973 Vali Acc: 0.480 Test Loss: 0.973 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8500494956970215
Epoch: 14, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.978 Vali Acc: 0.430 Test Loss: 0.978 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4859018325805664
Epoch: 15, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.941 Vali Acc: 0.470 Test Loss: 0.941 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4416749477386475
Epoch: 16, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.065 Vali Acc: 0.440 Test Loss: 1.065 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6768081188201904
Epoch: 17, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.903 Vali Acc: 0.460 Test Loss: 0.903 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2124757766723633
Epoch: 18, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.919 Vali Acc: 0.430 Test Loss: 0.919 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8642969131469727
Epoch: 19, Steps: 20 | Train Loss: 0.609 Vali Loss: 1.277 Vali Acc: 0.490 Test Loss: 1.277 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.401742935180664
Epoch: 20, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.942 Vali Acc: 0.500 Test Loss: 0.942 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2825010
model size : 13.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7501168251037598
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.350226402282715
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.693 Vali Acc: 0.600 Test Loss: 0.693 Test Acc: 0.600
Validation loss decreased (-0.479993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 2.2889912128448486
Epoch: 3, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6457319259643555
Epoch: 4, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7278659343719482
Epoch: 5, Steps: 20 | Train Loss: 0.723 Vali Loss: 1.093 Vali Acc: 0.490 Test Loss: 1.093 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6788837909698486
Epoch: 6, Steps: 20 | Train Loss: 0.835 Vali Loss: 0.817 Vali Acc: 0.480 Test Loss: 0.817 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6136891841888428
Epoch: 7, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6670310497283936
Epoch: 8, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.919 Vali Acc: 0.480 Test Loss: 0.919 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.572974920272827
Epoch: 9, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.156541109085083
Epoch: 10, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.954 Vali Acc: 0.460 Test Loss: 0.954 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.231123685836792
Epoch: 11, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.729846954345703
Epoch: 12, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.789 Vali Acc: 0.490 Test Loss: 0.789 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2823730
model size : 13.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.485093832015991
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 3.682053804397583
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7413992881774902
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.694373369216919
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.538069009780884
Epoch: 5, Steps: 20 | Train Loss: 0.831 Vali Loss: 1.246 Vali Acc: 0.480 Test Loss: 1.246 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6956000328063965
Epoch: 6, Steps: 20 | Train Loss: 0.853 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.2637927532196045
Epoch: 7, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5129406452178955
Epoch: 8, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.835381269454956
Epoch: 9, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.704427719116211
Epoch: 10, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.746187210083008
Epoch: 11, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2367026
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.043058395385742
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 3.529829978942871
Epoch: 2, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.593707799911499
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.891 Vali Acc: 0.480 Test Loss: 0.891 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.581796407699585
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.803 Vali Acc: 0.480 Test Loss: 0.803 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4490466117858887
Epoch: 5, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.883 Vali Acc: 0.470 Test Loss: 0.883 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.483480453491211
Epoch: 6, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.6060333251953125
Epoch: 7, Steps: 20 | Train Loss: 0.852 Vali Loss: 1.283 Vali Acc: 0.490 Test Loss: 1.283 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5812015533447266
Epoch: 8, Steps: 20 | Train Loss: 0.911 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5950419902801514
Epoch: 9, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.799 Vali Acc: 0.470 Test Loss: 0.799 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2441251277923584
Epoch: 10, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5100066661834717
Epoch: 11, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.871 Vali Acc: 0.470 Test Loss: 0.871 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2365746
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.11164665222168
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.738 Vali Acc: 0.430 Test Loss: 0.738 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 3.2591629028320312
Epoch: 2, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.782 Vali Acc: 0.450 Test Loss: 0.782 Test Acc: 0.450
Validation loss decreased (-0.429993 --> -0.449992).  Saving model ...
Epoch: 3 cost time: 2.9735658168792725
Epoch: 3, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
Validation loss decreased (-0.449992 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 2.4581351280212402
Epoch: 4, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.807 Vali Acc: 0.470 Test Loss: 0.807 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7972629070281982
Epoch: 5, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.913 Vali Acc: 0.490 Test Loss: 0.913 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9126052856445312
Epoch: 6, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2000410556793213
Epoch: 7, Steps: 20 | Train Loss: 0.748 Vali Loss: 1.449 Vali Acc: 0.510 Test Loss: 1.449 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509986).  Saving model ...
Epoch: 8 cost time: 3.6400539875030518
Epoch: 8, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
Validation loss decreased (-0.509986 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 3.705671548843384
Epoch: 9, Steps: 20 | Train Loss: 0.831 Vali Loss: 1.108 Vali Acc: 0.490 Test Loss: 1.108 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9971072673797607
Epoch: 10, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.159201145172119
Epoch: 11, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 3.232691526412964
Epoch: 12, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.376136064529419
Epoch: 13, Steps: 20 | Train Loss: 0.831 Vali Loss: 1.012 Vali Acc: 0.490 Test Loss: 1.012 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5812318325042725
Epoch: 14, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.847405433654785
Epoch: 15, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.789 Vali Acc: 0.560 Test Loss: 0.789 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8596038818359375
Epoch: 16, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.832956552505493
Epoch: 17, Steps: 20 | Train Loss: 0.721 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3888347148895264
Epoch: 18, Steps: 20 | Train Loss: 1.038 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9513168334960938
Epoch: 19, Steps: 20 | Train Loss: 0.855 Vali Loss: 1.330 Vali Acc: 0.480 Test Loss: 1.330 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.374936819076538
Epoch: 20, Steps: 20 | Train Loss: 0.955 Vali Loss: 1.227 Vali Acc: 0.490 Test Loss: 1.227 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.570128917694092
Epoch: 21, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.792 Vali Acc: 0.590 Test Loss: 0.792 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 22 cost time: 3.5763211250305176
Epoch: 22, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.922 Vali Acc: 0.470 Test Loss: 0.922 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8202173709869385
Epoch: 23, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8048079013824463
Epoch: 24, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.060 Vali Acc: 0.480 Test Loss: 1.060 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.9381673336029053
Epoch: 25, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.916 Vali Acc: 0.490 Test Loss: 0.916 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.839496612548828
Epoch: 26, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.705265522003174
Epoch: 27, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.892 Vali Acc: 0.470 Test Loss: 0.892 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.530989170074463
Epoch: 28, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.967 Vali Acc: 0.490 Test Loss: 0.967 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.682237386703491
Epoch: 29, Steps: 20 | Train Loss: 0.583 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.9990429878234863
Epoch: 30, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.892 Vali Acc: 0.480 Test Loss: 0.892 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.738079309463501
Epoch: 31, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.921 Vali Acc: 0.490 Test Loss: 0.921 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2364466
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.261415958404541
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.7900514602661133
Epoch: 2, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.938 Vali Acc: 0.490 Test Loss: 0.938 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.001589298248291
Epoch: 3, Steps: 20 | Train Loss: 0.903 Vali Loss: 1.178 Vali Acc: 0.510 Test Loss: 1.178 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.10062575340271
Epoch: 4, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.825739860534668
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 1.118 Vali Acc: 0.480 Test Loss: 1.118 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.935635805130005
Epoch: 6, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 3.499101400375366
Epoch: 7, Steps: 20 | Train Loss: 0.718 Vali Loss: 1.071 Vali Acc: 0.470 Test Loss: 1.071 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4382801055908203
Epoch: 8, Steps: 20 | Train Loss: 0.854 Vali Loss: 0.640 Vali Acc: 0.590 Test Loss: 0.640 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589994).  Saving model ...
Epoch: 9 cost time: 3.164095163345337
Epoch: 9, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.954 Vali Acc: 0.460 Test Loss: 0.954 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5394601821899414
Epoch: 10, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1565611362457275
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.88854718208313
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 1.114 Vali Acc: 0.490 Test Loss: 1.114 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.178555965423584
Epoch: 13, Steps: 20 | Train Loss: 0.754 Vali Loss: 1.051 Vali Acc: 0.460 Test Loss: 1.051 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.466970682144165
Epoch: 14, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.900 Vali Acc: 0.530 Test Loss: 0.900 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.557255268096924
Epoch: 15, Steps: 20 | Train Loss: 0.801 Vali Loss: 1.193 Vali Acc: 0.460 Test Loss: 1.193 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.651301383972168
Epoch: 16, Steps: 20 | Train Loss: 0.762 Vali Loss: 1.021 Vali Acc: 0.510 Test Loss: 1.021 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2086446285247803
Epoch: 17, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.895 Vali Acc: 0.600 Test Loss: 0.895 Test Acc: 0.600
Validation loss decreased (-0.589994 --> -0.599991).  Saving model ...
Epoch: 18 cost time: 3.0864193439483643
Epoch: 18, Steps: 20 | Train Loss: 0.636 Vali Loss: 1.249 Vali Acc: 0.450 Test Loss: 1.249 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.389943838119507
Epoch: 19, Steps: 20 | Train Loss: 0.647 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.152405023574829
Epoch: 20, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.982 Vali Acc: 0.490 Test Loss: 0.982 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.438591480255127
Epoch: 21, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.514115571975708
Epoch: 22, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.341 Vali Acc: 0.430 Test Loss: 1.341 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3879058361053467
Epoch: 23, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.508 Vali Acc: 0.510 Test Loss: 1.508 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.699444532394409
Epoch: 24, Steps: 20 | Train Loss: 0.579 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.7122926712036133
Epoch: 25, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.091 Vali Acc: 0.510 Test Loss: 1.091 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.6221704483032227
Epoch: 26, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.4722588062286377
Epoch: 27, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.297 Vali Acc: 0.440 Test Loss: 1.297 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2363186
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.909292221069336
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.5963923931121826
Epoch: 2, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4965896606445312
Epoch: 3, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4570765495300293
Epoch: 4, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4297449588775635
Epoch: 5, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.81025767326355
Epoch: 6, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0133256912231445
Epoch: 7, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.274414539337158
Epoch: 8, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 3.348607063293457
Epoch: 9, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.703 Vali Acc: 0.590 Test Loss: 0.703 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 3.095820188522339
Epoch: 10, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3726866245269775
Epoch: 11, Steps: 20 | Train Loss: 0.691 Vali Loss: 1.189 Vali Acc: 0.490 Test Loss: 1.189 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8628010749816895
Epoch: 12, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.703 Vali Acc: 0.630 Test Loss: 0.703 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629993).  Saving model ...
Epoch: 13 cost time: 2.9358510971069336
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.445969820022583
Epoch: 14, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4400243759155273
Epoch: 15, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.861 Vali Acc: 0.430 Test Loss: 0.861 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.137915849685669
Epoch: 16, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.861 Vali Acc: 0.580 Test Loss: 0.861 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3465237617492676
Epoch: 17, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.777 Vali Acc: 0.470 Test Loss: 0.777 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.3421759605407715
Epoch: 18, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.419741153717041
Epoch: 19, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.2834959030151367
Epoch: 20, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.175 Vali Acc: 0.510 Test Loss: 1.175 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4705581665039062
Epoch: 21, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.535358428955078
Epoch: 22, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.975 Vali Acc: 0.470 Test Loss: 0.975 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2136754
model size : 10.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.064583778381348
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 3.542490243911743
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.349210023880005
Epoch: 3, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
Validation loss decreased (-0.509991 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 3.0628185272216797
Epoch: 4, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.696 Vali Acc: 0.510 Test Loss: 0.696 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 3.5190513134002686
Epoch: 5, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3327784538269043
Epoch: 6, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3798348903656006
Epoch: 7, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.36314058303833
Epoch: 8, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2155025005340576
Epoch: 9, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.825 Vali Acc: 0.490 Test Loss: 0.825 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.403731107711792
Epoch: 10, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.4546000957489014
Epoch: 11, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.873 Vali Acc: 0.560 Test Loss: 0.873 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 3.379340887069702
Epoch: 12, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.838 Vali Acc: 0.540 Test Loss: 0.838 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.38330078125
Epoch: 13, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.790 Vali Acc: 0.570 Test Loss: 0.790 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 2.987699508666992
Epoch: 14, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4498584270477295
Epoch: 15, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8565845489501953
Epoch: 16, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.417083501815796
Epoch: 17, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4668445587158203
Epoch: 18, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.044 Vali Acc: 0.480 Test Loss: 1.044 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3468406200408936
Epoch: 19, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.710 Vali Acc: 0.580 Test Loss: 0.710 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579993).  Saving model ...
Epoch: 20 cost time: 3.4134104251861572
Epoch: 20, Steps: 20 | Train Loss: 0.691 Vali Loss: 1.146 Vali Acc: 0.510 Test Loss: 1.146 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5125484466552734
Epoch: 21, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3014886379241943
Epoch: 22, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.087 Vali Acc: 0.510 Test Loss: 1.087 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.549865484237671
Epoch: 23, Steps: 20 | Train Loss: 0.730 Vali Loss: 1.064 Vali Acc: 0.470 Test Loss: 1.064 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7412469387054443
Epoch: 24, Steps: 20 | Train Loss: 0.554 Vali Loss: 1.222 Vali Acc: 0.510 Test Loss: 1.222 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6049606800079346
Epoch: 25, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.61246657371521
Epoch: 26, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.050 Vali Acc: 0.520 Test Loss: 1.050 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.451951503753662
Epoch: 27, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.3730950355529785
Epoch: 28, Steps: 20 | Train Loss: 0.614 Vali Loss: 1.088 Vali Acc: 0.450 Test Loss: 1.088 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.7709262371063232
Epoch: 29, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.126 Vali Acc: 0.550 Test Loss: 1.126 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2135474
model size : 10.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.447542428970337
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.5420589447021484
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 3.537092685699463
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.724 Vali Acc: 0.430 Test Loss: 0.724 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4966886043548584
Epoch: 4, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.841 Vali Acc: 0.470 Test Loss: 0.841 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4674413204193115
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.843 Vali Acc: 0.480 Test Loss: 0.843 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.55998158454895
Epoch: 6, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5703816413879395
Epoch: 7, Steps: 20 | Train Loss: 0.882 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5468978881835938
Epoch: 8, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.830 Vali Acc: 0.480 Test Loss: 0.830 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.716642379760742
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 1.116 Vali Acc: 0.450 Test Loss: 1.116 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.5457983016967773
Epoch: 10, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.8902719020843506
Epoch: 11, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.890 Vali Acc: 0.550 Test Loss: 0.890 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.654439687728882
Epoch: 12, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2134194
model size : 10.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.752818822860718
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.705 Vali Acc: 0.420 Test Loss: 0.705 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 2.378227472305298
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (-0.419993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.4703292846679688
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.316528558731079
Epoch: 4, Steps: 20 | Train Loss: 0.790 Vali Loss: 1.042 Vali Acc: 0.490 Test Loss: 1.042 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.373086929321289
Epoch: 5, Steps: 20 | Train Loss: 0.823 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4483773708343506
Epoch: 6, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.446052312850952
Epoch: 7, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1391353607177734
Epoch: 8, Steps: 20 | Train Loss: 0.737 Vali Loss: 1.133 Vali Acc: 0.490 Test Loss: 1.133 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.452561140060425
Epoch: 9, Steps: 20 | Train Loss: 0.874 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.382603406906128
Epoch: 10, Steps: 20 | Train Loss: 0.895 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8880457878112793
Epoch: 11, Steps: 20 | Train Loss: 0.890 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9288558959960938
Epoch: 12, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.984 Vali Acc: 0.550 Test Loss: 0.984 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2132914
model size : 10.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.210876226425171
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.7234504222869873
Epoch: 2, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.891132354736328
Epoch: 3, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 2.3561716079711914
Epoch: 4, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.3904287815093994
Epoch: 5, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4252207279205322
Epoch: 6, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 2.4289424419403076
Epoch: 7, Steps: 20 | Train Loss: 0.836 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6145384311676025
Epoch: 8, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.771610975265503
Epoch: 9, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4281301498413086
Epoch: 10, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.458436965942383
Epoch: 11, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7108936309814453
Epoch: 12, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.773 Vali Acc: 0.440 Test Loss: 0.773 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7038378715515137
Epoch: 13, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.79195237159729
Epoch: 14, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6543102264404297
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.789 Vali Acc: 0.480 Test Loss: 0.789 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.66886043548584
Epoch: 16, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1419186
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.355108976364136
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.614600658416748
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.655999183654785
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.376161575317383
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.554962635040283
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.6638729572296143
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.743 Vali Acc: 0.550 Test Loss: 0.743 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 2.7550787925720215
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.465210437774658
Epoch: 8, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.724 Vali Acc: 0.570 Test Loss: 0.724 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 2.5175623893737793
Epoch: 9, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.810 Vali Acc: 0.470 Test Loss: 0.810 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7175467014312744
Epoch: 10, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.674394369125366
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7760825157165527
Epoch: 12, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.590 Test Loss: 0.726 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 2.820460319519043
Epoch: 13, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.968 Vali Acc: 0.400 Test Loss: 0.968 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6704041957855225
Epoch: 14, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.847 Vali Acc: 0.420 Test Loss: 0.847 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6781153678894043
Epoch: 15, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.589794397354126
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7122161388397217
Epoch: 17, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.320296287536621
Epoch: 18, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.875 Vali Acc: 0.460 Test Loss: 0.875 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.625601053237915
Epoch: 19, Steps: 20 | Train Loss: 0.601 Vali Loss: 1.056 Vali Acc: 0.450 Test Loss: 1.056 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.554845094680786
Epoch: 20, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.983 Vali Acc: 0.510 Test Loss: 0.983 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.673396110534668
Epoch: 21, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.070 Vali Acc: 0.410 Test Loss: 1.070 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7771482467651367
Epoch: 22, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.066 Vali Acc: 0.450 Test Loss: 1.066 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1418546
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.167397499084473
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.6047725677490234
Epoch: 2, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.588820695877075
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509991).  Saving model ...
Epoch: 4 cost time: 2.6621131896972656
Epoch: 4, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6502134799957275
Epoch: 5, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.464944839477539
Epoch: 6, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.602595806121826
Epoch: 7, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 2.652611494064331
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.729508399963379
Epoch: 9, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.468980073928833
Epoch: 10, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 2.8072519302368164
Epoch: 11, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.863 Vali Acc: 0.470 Test Loss: 0.863 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.88311767578125
Epoch: 12, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.945 Vali Acc: 0.450 Test Loss: 0.945 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.653068780899048
Epoch: 13, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.945 Vali Acc: 0.530 Test Loss: 0.945 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8360180854797363
Epoch: 14, Steps: 20 | Train Loss: 0.839 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8185391426086426
Epoch: 15, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8487765789031982
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.787 Vali Acc: 0.450 Test Loss: 0.787 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6069209575653076
Epoch: 17, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7229158878326416
Epoch: 18, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.695622444152832
Epoch: 19, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.935 Vali Acc: 0.510 Test Loss: 0.935 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8992793560028076
Epoch: 20, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.982 Vali Acc: 0.410 Test Loss: 0.982 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1417906
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8760578632354736
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.628303050994873
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.887 Vali Acc: 0.490 Test Loss: 0.887 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.79598069190979
Epoch: 3, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.79233980178833
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8355391025543213
Epoch: 5, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8572440147399902
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.742774248123169
Epoch: 7, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8124687671661377
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 2.2178690433502197
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2434322834014893
Epoch: 10, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9114270210266113
Epoch: 11, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 2.6238322257995605
Epoch: 12, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.737 Vali Acc: 0.580 Test Loss: 0.737 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 2.785388469696045
Epoch: 13, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.946 Vali Acc: 0.440 Test Loss: 0.946 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5397987365722656
Epoch: 14, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0867271423339844
Epoch: 15, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.711320400238037
Epoch: 16, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7225656509399414
Epoch: 17, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.958 Vali Acc: 0.500 Test Loss: 0.958 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.352133274078369
Epoch: 18, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.716 Vali Acc: 0.610 Test Loss: 0.716 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 19 cost time: 2.6035940647125244
Epoch: 19, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.831 Vali Acc: 0.540 Test Loss: 0.831 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4149954319000244
Epoch: 20, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.799 Vali Acc: 0.460 Test Loss: 0.799 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1237189769744873
Epoch: 21, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.851 Vali Acc: 0.440 Test Loss: 0.851 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.304697275161743
Epoch: 22, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.945 Vali Acc: 0.430 Test Loss: 0.945 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.320972204208374
Epoch: 23, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.115726947784424
Epoch: 24, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5563137531280518
Epoch: 25, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.920 Vali Acc: 0.530 Test Loss: 0.920 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6321167945861816
Epoch: 26, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.977 Vali Acc: 0.530 Test Loss: 0.977 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.5955588817596436
Epoch: 27, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.908 Vali Acc: 0.490 Test Loss: 0.908 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.333294630050659
Epoch: 28, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.177 Vali Acc: 0.530 Test Loss: 1.177 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1417266
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.211032390594482
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.692 Vali Acc: 0.480 Test Loss: 0.692 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.571855068206787
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.757 Vali Acc: 0.430 Test Loss: 0.757 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5919265747070312
Epoch: 3, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.720 Vali Acc: 0.410 Test Loss: 0.720 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.179987907409668
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.874 Vali Acc: 0.490 Test Loss: 0.874 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489991).  Saving model ...
Epoch: 5 cost time: 2.2399742603302
Epoch: 5, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6250734329223633
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 2.499077796936035
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.611743927001953
Epoch: 8, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.784287929534912
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 2.6278347969055176
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3527846336364746
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 2.3517346382141113
Epoch: 12, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.779 Vali Acc: 0.570 Test Loss: 0.779 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 13 cost time: 2.675474166870117
Epoch: 13, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.679164171218872
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5295357704162598
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.664058208465576
Epoch: 16, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.559361219406128
Epoch: 17, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.827 Vali Acc: 0.550 Test Loss: 0.827 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2300963401794434
Epoch: 18, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.953 Vali Acc: 0.520 Test Loss: 0.953 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6234285831451416
Epoch: 19, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.912 Vali Acc: 0.470 Test Loss: 0.912 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7098770141601562
Epoch: 20, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.830 Vali Acc: 0.480 Test Loss: 0.830 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7524242401123047
Epoch: 21, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6636242866516113
Epoch: 22, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.009 Vali Acc: 0.510 Test Loss: 1.009 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 956850
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8193535804748535
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.553049325942993
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.462986707687378
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6106300354003906
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6310431957244873
Epoch: 5, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.627748966217041
Epoch: 6, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.589047431945801
Epoch: 7, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.783 Vali Acc: 0.460 Test Loss: 0.783 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.733661413192749
Epoch: 8, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.960 Vali Acc: 0.500 Test Loss: 0.960 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.664275884628296
Epoch: 9, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6675281524658203
Epoch: 10, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5427136421203613
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4817845821380615
Epoch: 12, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.791 Vali Acc: 0.530 Test Loss: 0.791 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 956210
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9431262016296387
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.705125570297241
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (-0.469993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.6360907554626465
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6991631984710693
Epoch: 4, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7231037616729736
Epoch: 5, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.794 Vali Acc: 0.470 Test Loss: 0.794 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5390138626098633
Epoch: 6, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.665771961212158
Epoch: 7, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 2.841473340988159
Epoch: 8, Steps: 20 | Train Loss: 0.886 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.580005407333374
Epoch: 9, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.862 Vali Acc: 0.510 Test Loss: 0.862 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7553040981292725
Epoch: 10, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8902690410614014
Epoch: 11, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.671 Vali Acc: 0.530 Test Loss: 0.671 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9290924072265625
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8607003688812256
Epoch: 13, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 2.705083131790161
Epoch: 14, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8435559272766113
Epoch: 15, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3628649711608887
Epoch: 16, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.949 Vali Acc: 0.500 Test Loss: 0.949 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4654128551483154
Epoch: 17, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.662907123565674
Epoch: 18, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.758 Vali Acc: 0.580 Test Loss: 0.758 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 19 cost time: 2.654298782348633
Epoch: 19, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.801 Vali Acc: 0.560 Test Loss: 0.801 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.838501214981079
Epoch: 20, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6775684356689453
Epoch: 21, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7725067138671875
Epoch: 22, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8561391830444336
Epoch: 23, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.909 Vali Acc: 0.540 Test Loss: 0.909 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7013871669769287
Epoch: 24, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.607074737548828
Epoch: 25, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.933 Vali Acc: 0.510 Test Loss: 0.933 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7751784324645996
Epoch: 26, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.823909282684326
Epoch: 27, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.870 Vali Acc: 0.560 Test Loss: 0.870 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9181888103485107
Epoch: 28, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.996 Vali Acc: 0.520 Test Loss: 0.996 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 955570
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.4848291873931885
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.829576253890991
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8126320838928223
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 2.7930710315704346
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2927989959716797
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.690 Vali Acc: 0.490 Test Loss: 0.690 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.809659957885742
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.856 Vali Acc: 0.490 Test Loss: 0.856 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8491950035095215
Epoch: 7, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.816 Vali Acc: 0.470 Test Loss: 0.816 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7203128337860107
Epoch: 8, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.940964937210083
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.865 Vali Acc: 0.540 Test Loss: 0.865 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539991).  Saving model ...
Epoch: 10 cost time: 2.9474728107452393
Epoch: 10, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.868 Vali Acc: 0.560 Test Loss: 0.868 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 2.8958446979522705
Epoch: 11, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.446621894836426
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.400951862335205
Epoch: 13, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7555150985717773
Epoch: 14, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7732229232788086
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.845 Vali Acc: 0.540 Test Loss: 0.845 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.768913507461548
Epoch: 16, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.751573324203491
Epoch: 17, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.960 Vali Acc: 0.550 Test Loss: 0.960 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7397091388702393
Epoch: 18, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4427804946899414
Epoch: 19, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7794888019561768
Epoch: 20, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 954930
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8777823448181152
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.570314645767212
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.230849027633667
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.815 Vali Acc: 0.470 Test Loss: 0.815 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6834850311279297
Epoch: 4, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.512539863586426
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.803 Vali Acc: 0.480 Test Loss: 0.803 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7102675437927246
Epoch: 6, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8098819255828857
Epoch: 7, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.684 Vali Acc: 0.560 Test Loss: 0.684 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 2.690098524093628
Epoch: 8, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5653982162475586
Epoch: 9, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.551149368286133
Epoch: 10, Steps: 20 | Train Loss: 0.796 Vali Loss: 1.169 Vali Acc: 0.480 Test Loss: 1.169 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4981191158294678
Epoch: 11, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.082042932510376
Epoch: 12, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.762 Vali Acc: 0.580 Test Loss: 0.762 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 2.7048592567443848
Epoch: 13, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5950496196746826
Epoch: 14, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7485382556915283
Epoch: 15, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6452488899230957
Epoch: 16, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6954290866851807
Epoch: 17, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7661590576171875
Epoch: 18, Steps: 20 | Train Loss: 0.618 Vali Loss: 1.106 Vali Acc: 0.460 Test Loss: 1.106 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9725914001464844
Epoch: 19, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.953 Vali Acc: 0.480 Test Loss: 0.953 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.466702461242676
Epoch: 20, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.566830635070801
Epoch: 21, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.051 Vali Acc: 0.470 Test Loss: 1.051 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5897347927093506
Epoch: 22, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 725682
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.969940662384033
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.704 Vali Acc: 0.440 Test Loss: 0.704 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.4733943939208984
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.439993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.2792136669158936
Epoch: 3, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6273162364959717
Epoch: 4, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.791 Vali Acc: 0.480 Test Loss: 0.791 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3840808868408203
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.808 Vali Acc: 0.490 Test Loss: 0.808 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.438900947570801
Epoch: 6, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6738665103912354
Epoch: 7, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.281491279602051
Epoch: 8, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.973 Vali Acc: 0.480 Test Loss: 0.973 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.300199031829834
Epoch: 9, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 2.5719783306121826
Epoch: 10, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.882 Vali Acc: 0.450 Test Loss: 0.882 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5370640754699707
Epoch: 11, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 2.719000816345215
Epoch: 12, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7785370349884033
Epoch: 13, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.812 Vali Acc: 0.550 Test Loss: 0.812 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 14 cost time: 2.6385395526885986
Epoch: 14, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 2.5360288619995117
Epoch: 15, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3209381103515625
Epoch: 16, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.861 Vali Acc: 0.460 Test Loss: 0.861 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6267871856689453
Epoch: 17, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 18 cost time: 2.4862849712371826
Epoch: 18, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5467939376831055
Epoch: 19, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6118221282958984
Epoch: 20, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.875 Vali Acc: 0.450 Test Loss: 0.875 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.543389320373535
Epoch: 21, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.041 Vali Acc: 0.480 Test Loss: 1.041 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6291162967681885
Epoch: 22, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3128650188446045
Epoch: 23, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.746652364730835
Epoch: 24, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.958 Vali Acc: 0.470 Test Loss: 0.958 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5090534687042236
Epoch: 25, Steps: 20 | Train Loss: 0.608 Vali Loss: 1.300 Vali Acc: 0.490 Test Loss: 1.300 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.625054121017456
Epoch: 26, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.554058790206909
Epoch: 27, Steps: 20 | Train Loss: 0.621 Vali Loss: 1.050 Vali Acc: 0.480 Test Loss: 1.050 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 725042
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.082983493804932
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.514005661010742
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.5606045722961426
Epoch: 3, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4532103538513184
Epoch: 4, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1387088298797607
Epoch: 5, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6189510822296143
Epoch: 6, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.768336534500122
Epoch: 7, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.648644208908081
Epoch: 8, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.48764705657959
Epoch: 9, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.918 Vali Acc: 0.430 Test Loss: 0.918 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3157615661621094
Epoch: 10, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.817 Vali Acc: 0.490 Test Loss: 0.817 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3443093299865723
Epoch: 11, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.541344404220581
Epoch: 12, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 724402
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.0400896072387695
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.3976612091064453
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5945796966552734
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.152458429336548
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5060925483703613
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 2.421598196029663
Epoch: 6, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.847 Vali Acc: 0.480 Test Loss: 0.847 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.473158121109009
Epoch: 7, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 2.341062307357788
Epoch: 8, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.065300464630127
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3796310424804688
Epoch: 10, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.590898275375366
Epoch: 11, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.59391188621521
Epoch: 12, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.361022472381592
Epoch: 13, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.789 Vali Acc: 0.440 Test Loss: 0.789 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.333289384841919
Epoch: 14, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.832 Vali Acc: 0.530 Test Loss: 0.832 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.621014356613159
Epoch: 15, Steps: 20 | Train Loss: 0.641 Vali Loss: 1.017 Vali Acc: 0.550 Test Loss: 1.017 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 16 cost time: 2.25732684135437
Epoch: 16, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.978 Vali Acc: 0.550 Test Loss: 0.978 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 17 cost time: 2.482412099838257
Epoch: 17, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.879 Vali Acc: 0.480 Test Loss: 0.879 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.637678384780884
Epoch: 18, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.826 Vali Acc: 0.460 Test Loss: 0.826 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0167553424835205
Epoch: 19, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.819 Vali Acc: 0.460 Test Loss: 0.819 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.770326852798462
Epoch: 20, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.930 Vali Acc: 0.550 Test Loss: 0.930 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549991).  Saving model ...
Epoch: 21 cost time: 2.104321002960205
Epoch: 21, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549991).  Saving model ...
Epoch: 22 cost time: 1.954425573348999
Epoch: 22, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8680734634399414
Epoch: 23, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9427952766418457
Epoch: 24, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.048 Vali Acc: 0.480 Test Loss: 1.048 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.023218870162964
Epoch: 25, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.940 Vali Acc: 0.500 Test Loss: 0.940 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.029588222503662
Epoch: 26, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.003 Vali Acc: 0.460 Test Loss: 1.003 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9263486862182617
Epoch: 27, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.092 Vali Acc: 0.450 Test Loss: 1.092 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.459646224975586
Epoch: 28, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.981 Vali Acc: 0.550 Test Loss: 0.981 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.8329129219055176
Epoch: 29, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.916 Vali Acc: 0.580 Test Loss: 0.916 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579991).  Saving model ...
Epoch: 30 cost time: 2.7366878986358643
Epoch: 30, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 2.588728666305542
Epoch: 31, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.6408700942993164
Epoch: 32, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.190 Vali Acc: 0.420 Test Loss: 1.190 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.5143144130706787
Epoch: 33, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.333 Vali Acc: 0.550 Test Loss: 1.333 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.572664737701416
Epoch: 34, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.114 Vali Acc: 0.520 Test Loss: 1.114 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.155179023742676
Epoch: 35, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.100 Vali Acc: 0.490 Test Loss: 1.100 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.8327126502990723
Epoch: 36, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.8377137184143066
Epoch: 37, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.161 Vali Acc: 0.520 Test Loss: 1.161 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.68691086769104
Epoch: 38, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.226 Vali Acc: 0.460 Test Loss: 1.226 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.4697377681732178
Epoch: 39, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.471 Vali Acc: 0.480 Test Loss: 1.471 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.5993010997772217
Epoch: 40, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 723762
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.211676359176636
Epoch: 1, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.6117939949035645
Epoch: 2, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.108332633972168
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7919487953186035
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2667529582977295
Epoch: 5, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 2.8935487270355225
Epoch: 6, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.87404203414917
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4082562923431396
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.854 Vali Acc: 0.500 Test Loss: 0.854 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.728607177734375
Epoch: 9, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.983992099761963
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.698 Vali Acc: 0.570 Test Loss: 0.698 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 2.8106160163879395
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7359695434570312
Epoch: 12, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 2.3953845500946045
Epoch: 13, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.868 Vali Acc: 0.470 Test Loss: 0.868 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.825551748275757
Epoch: 14, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.767457962036133
Epoch: 15, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7928450107574463
Epoch: 16, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.8967716693878174
Epoch: 17, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4471960067749023
Epoch: 18, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.952 Vali Acc: 0.490 Test Loss: 0.952 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1012728214263916
Epoch: 19, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0504767894744873
Epoch: 20, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.541653633117676
Epoch: 21, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.420820474624634
Epoch: 22, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 610098
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.661264657974243
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.4594380855560303
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.715 Vali Acc: 0.430 Test Loss: 0.715 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4537339210510254
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.775 Vali Acc: 0.450 Test Loss: 0.775 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.488365888595581
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.504685401916504
Epoch: 5, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3969221115112305
Epoch: 6, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 2.3642425537109375
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.730 Vali Acc: 0.570 Test Loss: 0.730 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 2.290371894836426
Epoch: 8, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2635343074798584
Epoch: 9, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3578531742095947
Epoch: 10, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4311139583587646
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4733009338378906
Epoch: 12, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 2.363795280456543
Epoch: 13, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.962458848953247
Epoch: 14, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.725 Vali Acc: 0.570 Test Loss: 0.725 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.483797550201416
Epoch: 15, Steps: 20 | Train Loss: 0.649 Vali Loss: 1.053 Vali Acc: 0.510 Test Loss: 1.053 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6049463748931885
Epoch: 16, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.231377124786377
Epoch: 17, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.763 Vali Acc: 0.610 Test Loss: 0.763 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 18 cost time: 2.5448174476623535
Epoch: 18, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.841 Vali Acc: 0.580 Test Loss: 0.841 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.582278251647949
Epoch: 19, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.398758888244629
Epoch: 20, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.433285713195801
Epoch: 21, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.451650381088257
Epoch: 22, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.816 Vali Acc: 0.480 Test Loss: 0.816 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.291747570037842
Epoch: 23, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.958 Vali Acc: 0.570 Test Loss: 0.958 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.536755084991455
Epoch: 24, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.845 Vali Acc: 0.540 Test Loss: 0.845 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5529518127441406
Epoch: 25, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.487010955810547
Epoch: 26, Steps: 20 | Train Loss: 0.547 Vali Loss: 1.055 Vali Acc: 0.540 Test Loss: 1.055 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4858133792877197
Epoch: 27, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 609458
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.021929502487183
Epoch: 1, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.364171266555786
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.6049585342407227
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4581823348999023
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1063284873962402
Epoch: 5, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.242197036743164
Epoch: 6, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7464027404785156
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.706 Vali Acc: 0.550 Test Loss: 0.706 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 2.275634765625
Epoch: 8, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.761359214782715
Epoch: 9, Steps: 20 | Train Loss: 0.944 Vali Loss: 0.828 Vali Acc: 0.490 Test Loss: 0.828 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6351494789123535
Epoch: 10, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2827422618865967
Epoch: 11, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9744091033935547
Epoch: 12, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.328089714050293
Epoch: 13, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.18521785736084
Epoch: 14, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.873 Vali Acc: 0.480 Test Loss: 0.873 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.250864267349243
Epoch: 15, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4557700157165527
Epoch: 16, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.916 Vali Acc: 0.540 Test Loss: 0.916 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3064258098602295
Epoch: 17, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.975 Vali Acc: 0.500 Test Loss: 0.975 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 608818
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6905860900878906
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.4927666187286377
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4922738075256348
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.291752338409424
Epoch: 4, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6375555992126465
Epoch: 5, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5077767372131348
Epoch: 6, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 2.282860040664673
Epoch: 7, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.781 Vali Acc: 0.450 Test Loss: 0.781 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.325195789337158
Epoch: 8, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4658920764923096
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.330207347869873
Epoch: 10, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4560673236846924
Epoch: 11, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6372900009155273
Epoch: 12, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4357078075408936
Epoch: 13, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9176948070526123
Epoch: 14, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.400519847869873
Epoch: 15, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.336195230484009
Epoch: 16, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.858 Vali Acc: 0.410 Test Loss: 0.858 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 608178
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5099751949310303
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.676 Vali Acc: 0.620 Test Loss: 0.676 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 1.8908991813659668
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9958832263946533
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.717853307723999
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.005535125732422
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.929 Vali Acc: 0.490 Test Loss: 0.929 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.760481357574463
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7066967487335205
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6917994022369385
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.863384485244751
Epoch: 9, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.927 Vali Acc: 0.490 Test Loss: 0.927 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8576292991638184
Epoch: 10, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.883791208267212
Epoch: 11, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 598514
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7507894039154053
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.08499813079834
Epoch: 2, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.8723995685577393
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.8690693378448486
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.734 Vali Acc: 0.450 Test Loss: 0.734 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.917670488357544
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.770 Vali Acc: 0.460 Test Loss: 0.770 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8812260627746582
Epoch: 6, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.733 Vali Acc: 0.450 Test Loss: 0.733 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0437724590301514
Epoch: 7, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.961862564086914
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.694 Vali Acc: 0.560 Test Loss: 0.694 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 2.064659357070923
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1189146041870117
Epoch: 10, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9935684204101562
Epoch: 11, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.098233699798584
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.145904541015625
Epoch: 13, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.773 Vali Acc: 0.430 Test Loss: 0.773 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.974539041519165
Epoch: 14, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.117799997329712
Epoch: 15, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2964344024658203
Epoch: 16, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.798 Vali Acc: 0.450 Test Loss: 0.798 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.447324752807617
Epoch: 17, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6072800159454346
Epoch: 18, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 598194
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3887038230895996
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.778 Vali Acc: 0.490 Test Loss: 0.778 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.9882686138153076
Epoch: 2, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.023806095123291
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2751877307891846
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.897024154663086
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.757 Vali Acc: 0.440 Test Loss: 0.757 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8759737014770508
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1120858192443848
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.9799420833587646
Epoch: 8, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9833369255065918
Epoch: 9, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9547035694122314
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8221015930175781
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7878139019012451
Epoch: 12, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.820030927658081
Epoch: 13, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9959285259246826
Epoch: 14, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8649117946624756
Epoch: 15, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9504292011260986
Epoch: 16, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9029719829559326
Epoch: 17, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 18 cost time: 1.8106141090393066
Epoch: 18, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7933330535888672
Epoch: 19, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.819 Vali Acc: 0.480 Test Loss: 0.819 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.792381763458252
Epoch: 20, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.793 Vali Acc: 0.450 Test Loss: 0.793 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8042430877685547
Epoch: 21, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7106165885925293
Epoch: 22, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 23 cost time: 1.918830156326294
Epoch: 23, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.991 Vali Acc: 0.480 Test Loss: 0.991 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.430833339691162
Epoch: 24, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.927 Vali Acc: 0.530 Test Loss: 0.927 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8849449157714844
Epoch: 25, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.923 Vali Acc: 0.490 Test Loss: 0.923 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1011574268341064
Epoch: 26, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.137000322341919
Epoch: 27, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8416333198547363
Epoch: 28, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9170856475830078
Epoch: 29, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.052123546600342
Epoch: 30, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.898 Vali Acc: 0.480 Test Loss: 0.898 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9331190586090088
Epoch: 31, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.032 Vali Acc: 0.490 Test Loss: 1.032 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.896822452545166
Epoch: 32, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.079 Vali Acc: 0.440 Test Loss: 1.079 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 597874
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3884503841400146
Epoch: 1, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.876213550567627
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.862987756729126
Epoch: 3, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.866128921508789
Epoch: 4, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.8102126121520996
Epoch: 5, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7618157863616943
Epoch: 6, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7322545051574707
Epoch: 7, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.692439079284668
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.726846694946289
Epoch: 9, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7835242748260498
Epoch: 10, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6629691123962402
Epoch: 11, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.809 Vali Acc: 0.460 Test Loss: 0.809 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7074573040008545
Epoch: 12, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6789710521697998
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 14 cost time: 1.6308486461639404
Epoch: 14, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7516324520111084
Epoch: 15, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7550413608551025
Epoch: 16, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.728849172592163
Epoch: 17, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.743 Vali Acc: 0.550 Test Loss: 0.743 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 18 cost time: 1.7794315814971924
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.822 Vali Acc: 0.510 Test Loss: 0.822 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7410643100738525
Epoch: 19, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.910 Vali Acc: 0.430 Test Loss: 0.910 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.809095859527588
Epoch: 20, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8081138134002686
Epoch: 21, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7599053382873535
Epoch: 22, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7750205993652344
Epoch: 23, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9234538078308105
Epoch: 24, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9180731773376465
Epoch: 25, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.921 Vali Acc: 0.470 Test Loss: 0.921 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9141645431518555
Epoch: 26, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.912 Vali Acc: 0.460 Test Loss: 0.912 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8275156021118164
Epoch: 27, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.856 Vali Acc: 0.450 Test Loss: 0.856 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 597554
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6814706325531006
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8717124462127686
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9528834819793701
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.016167163848877
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8846518993377686
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.815 Vali Acc: 0.470 Test Loss: 0.815 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.018038272857666
Epoch: 6, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.892 Vali Acc: 0.480 Test Loss: 0.892 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8401873111724854
Epoch: 7, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.907604455947876
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8508248329162598
Epoch: 9, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.872056245803833
Epoch: 10, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8816556930541992
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9121475219726562
Epoch: 12, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 2.1037752628326416
Epoch: 13, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1240427494049072
Epoch: 14, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.939 Vali Acc: 0.470 Test Loss: 0.939 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4646835327148438
Epoch: 15, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.775 Vali Acc: 0.470 Test Loss: 0.775 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0424811840057373
Epoch: 16, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.934 Vali Acc: 0.510 Test Loss: 0.934 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.248960256576538
Epoch: 17, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.764 Vali Acc: 0.470 Test Loss: 0.764 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9010720252990723
Epoch: 18, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6448733806610107
Epoch: 19, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.947 Vali Acc: 0.490 Test Loss: 0.947 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5782179832458496
Epoch: 20, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 21 cost time: 1.7580008506774902
Epoch: 21, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.863 Vali Acc: 0.520 Test Loss: 0.863 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.701164960861206
Epoch: 22, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.815 Vali Acc: 0.490 Test Loss: 0.815 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8014235496520996
Epoch: 23, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.785 Vali Acc: 0.570 Test Loss: 0.785 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 24 cost time: 1.7940342426300049
Epoch: 24, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7609584331512451
Epoch: 25, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8199317455291748
Epoch: 26, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.799987554550171
Epoch: 27, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.814 Vali Acc: 0.600 Test Loss: 0.814 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 28 cost time: 1.6792795658111572
Epoch: 28, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6996190547943115
Epoch: 29, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.776 Vali Acc: 0.470 Test Loss: 0.776 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6197576522827148
Epoch: 30, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.862 Vali Acc: 0.460 Test Loss: 0.862 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.857356071472168
Epoch: 31, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8089172840118408
Epoch: 32, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8266422748565674
Epoch: 33, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.945 Vali Acc: 0.490 Test Loss: 0.945 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7733228206634521
Epoch: 34, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.062 Vali Acc: 0.480 Test Loss: 1.062 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.642259120941162
Epoch: 35, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7538702487945557
Epoch: 36, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.932 Vali Acc: 0.480 Test Loss: 0.932 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.08447003364563
Epoch: 37, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.946 Vali Acc: 0.450 Test Loss: 0.946 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 365554
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.063018560409546
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.7833468914031982
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9354395866394043
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0156712532043457
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0404603481292725
Epoch: 5, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8884246349334717
Epoch: 6, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8600654602050781
Epoch: 7, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7617790699005127
Epoch: 8, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8271205425262451
Epoch: 9, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8443026542663574
Epoch: 10, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.8227179050445557
Epoch: 11, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8733806610107422
Epoch: 12, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9099280834197998
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8558967113494873
Epoch: 14, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 15 cost time: 2.0121548175811768
Epoch: 15, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.10831356048584
Epoch: 16, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.029 Vali Acc: 0.480 Test Loss: 1.029 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.002094268798828
Epoch: 17, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.719 Vali Acc: 0.600 Test Loss: 0.719 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 18 cost time: 2.0589489936828613
Epoch: 18, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.844 Vali Acc: 0.450 Test Loss: 0.844 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.971705675125122
Epoch: 19, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.723 Vali Acc: 0.570 Test Loss: 0.723 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8658339977264404
Epoch: 20, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9314451217651367
Epoch: 21, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8147928714752197
Epoch: 22, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.851 Vali Acc: 0.480 Test Loss: 0.851 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8686795234680176
Epoch: 23, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8640515804290771
Epoch: 24, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.872 Vali Acc: 0.470 Test Loss: 0.872 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8987812995910645
Epoch: 25, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9077486991882324
Epoch: 26, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.917 Vali Acc: 0.470 Test Loss: 0.917 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9847042560577393
Epoch: 27, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 365234
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5724635124206543
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.919905662536621
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.717 Vali Acc: 0.420 Test Loss: 0.717 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1763851642608643
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.730 Vali Acc: 0.430 Test Loss: 0.730 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.011439800262451
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 2.28882098197937
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.217796564102173
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9802091121673584
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 2.187487840652466
Epoch: 8, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9804420471191406
Epoch: 9, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.117492914199829
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.9197161197662354
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9712543487548828
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9488134384155273
Epoch: 13, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8866004943847656
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8796560764312744
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9180853366851807
Epoch: 16, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.784 Vali Acc: 0.430 Test Loss: 0.784 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9963316917419434
Epoch: 17, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.792 Vali Acc: 0.430 Test Loss: 0.792 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0324630737304688
Epoch: 18, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.842 Vali Acc: 0.440 Test Loss: 0.842 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.964627742767334
Epoch: 19, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.866 Vali Acc: 0.450 Test Loss: 0.866 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.996443748474121
Epoch: 20, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 364914
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6190366744995117
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8689818382263184
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.702 Vali Acc: 0.430 Test Loss: 0.702 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7721214294433594
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.09000825881958
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.914947748184204
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6462960243225098
Epoch: 6, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8638792037963867
Epoch: 7, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8145577907562256
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7175042629241943
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7717764377593994
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 11 cost time: 1.950204849243164
Epoch: 11, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8583629131317139
Epoch: 12, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.843 Vali Acc: 0.460 Test Loss: 0.843 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.930180549621582
Epoch: 13, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9430530071258545
Epoch: 14, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8849327564239502
Epoch: 15, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8883042335510254
Epoch: 16, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9732747077941895
Epoch: 17, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.731710433959961
Epoch: 18, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 19 cost time: 1.7707808017730713
Epoch: 19, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.786 Vali Acc: 0.580 Test Loss: 0.786 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579992).  Saving model ...
Epoch: 20 cost time: 1.8229079246520996
Epoch: 20, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.844 Vali Acc: 0.450 Test Loss: 0.844 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0353407859802246
Epoch: 21, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.174377918243408
Epoch: 22, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.795 Vali Acc: 0.580 Test Loss: 0.795 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.055603504180908
Epoch: 23, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9607186317443848
Epoch: 24, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.937 Vali Acc: 0.460 Test Loss: 0.937 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9234414100646973
Epoch: 25, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.874 Vali Acc: 0.510 Test Loss: 0.874 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2579169273376465
Epoch: 26, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9464271068572998
Epoch: 27, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8689062595367432
Epoch: 28, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.868 Vali Acc: 0.430 Test Loss: 0.868 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8819105625152588
Epoch: 29, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.904 Vali Acc: 0.480 Test Loss: 0.904 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 364594
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.33476185798645
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8119497299194336
Epoch: 2, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.718303918838501
Epoch: 3, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7517828941345215
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0642199516296387
Epoch: 5, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7964065074920654
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8525495529174805
Epoch: 7, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8320224285125732
Epoch: 8, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.718 Vali Acc: 0.460 Test Loss: 0.718 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.852360725402832
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8829126358032227
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 11 cost time: 2.0635321140289307
Epoch: 11, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8614857196807861
Epoch: 12, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 1.8758924007415771
Epoch: 13, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 1.9871563911437988
Epoch: 14, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7987544536590576
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8474757671356201
Epoch: 16, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.767 Vali Acc: 0.600 Test Loss: 0.767 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 17 cost time: 1.9293487071990967
Epoch: 17, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.873 Vali Acc: 0.470 Test Loss: 0.873 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8294837474822998
Epoch: 18, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9125206470489502
Epoch: 19, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0379374027252197
Epoch: 20, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.150158405303955
Epoch: 21, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8293359279632568
Epoch: 22, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.793 Vali Acc: 0.400 Test Loss: 0.793 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6981256008148193
Epoch: 23, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.856 Vali Acc: 0.430 Test Loss: 0.856 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.761819839477539
Epoch: 24, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.812 Vali Acc: 0.460 Test Loss: 0.812 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7306652069091797
Epoch: 25, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7852723598480225
Epoch: 26, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 249074
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.613657236099243
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.0376100540161133
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8711440563201904
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9337661266326904
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8943843841552734
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8614332675933838
Epoch: 6, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8649513721466064
Epoch: 7, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.918611764907837
Epoch: 8, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8774442672729492
Epoch: 9, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.775547742843628
Epoch: 10, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7695751190185547
Epoch: 11, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 248754
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3075954914093018
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.8843083381652832
Epoch: 2, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.857 Vali Acc: 0.490 Test Loss: 0.857 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 1.7637908458709717
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.839172124862671
Epoch: 4, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7809302806854248
Epoch: 5, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.750 Vali Acc: 0.450 Test Loss: 0.750 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8413753509521484
Epoch: 6, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 1.921726942062378
Epoch: 7, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9220821857452393
Epoch: 8, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9182560443878174
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.111318826675415
Epoch: 10, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.806 Vali Acc: 0.470 Test Loss: 0.806 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.139545440673828
Epoch: 11, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.823 Vali Acc: 0.460 Test Loss: 0.823 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.959993600845337
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.783 Vali Acc: 0.470 Test Loss: 0.783 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8335473537445068
Epoch: 13, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 14 cost time: 2.0001134872436523
Epoch: 14, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8513689041137695
Epoch: 15, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.822 Vali Acc: 0.450 Test Loss: 0.822 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0124003887176514
Epoch: 16, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 17 cost time: 1.8670697212219238
Epoch: 17, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0294535160064697
Epoch: 18, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9041059017181396
Epoch: 19, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8516254425048828
Epoch: 20, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8947350978851318
Epoch: 21, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 22 cost time: 1.8459749221801758
Epoch: 22, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.875 Vali Acc: 0.460 Test Loss: 0.875 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.928725242614746
Epoch: 23, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7882091999053955
Epoch: 24, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.036501884460449
Epoch: 25, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.887 Vali Acc: 0.550 Test Loss: 0.887 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0335967540740967
Epoch: 26, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.839 Vali Acc: 0.430 Test Loss: 0.839 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.161482572555542
Epoch: 27, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.797 Vali Acc: 0.570 Test Loss: 0.797 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 28 cost time: 1.8174521923065186
Epoch: 28, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9282779693603516
Epoch: 29, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.846 Vali Acc: 0.460 Test Loss: 0.846 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9112772941589355
Epoch: 30, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.851 Vali Acc: 0.550 Test Loss: 0.851 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.896925687789917
Epoch: 31, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.923 Vali Acc: 0.510 Test Loss: 0.923 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8377854824066162
Epoch: 32, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.930 Vali Acc: 0.480 Test Loss: 0.930 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9442057609558105
Epoch: 33, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.923 Vali Acc: 0.550 Test Loss: 0.923 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.885448694229126
Epoch: 34, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.879 Vali Acc: 0.530 Test Loss: 0.879 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.031205892562866
Epoch: 35, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.939 Vali Acc: 0.500 Test Loss: 0.939 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9683125019073486
Epoch: 36, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.9529361724853516
Epoch: 37, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.994 Vali Acc: 0.530 Test Loss: 0.994 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 248434
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4078657627105713
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.009871006011963
Epoch: 2, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8028674125671387
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.919799566268921
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.721 Vali Acc: 0.440 Test Loss: 0.721 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8368613719940186
Epoch: 5, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 1.7781484127044678
Epoch: 6, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9889891147613525
Epoch: 7, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0798957347869873
Epoch: 8, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8500466346740723
Epoch: 9, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 1.7110097408294678
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.801 Vali Acc: 0.490 Test Loss: 0.801 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8971116542816162
Epoch: 11, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.956390380859375
Epoch: 12, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 2.0600104331970215
Epoch: 13, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8804004192352295
Epoch: 14, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.778735876083374
Epoch: 15, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.735 Vali Acc: 0.570 Test Loss: 0.735 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 1.8828239440917969
Epoch: 16, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.748 Vali Acc: 0.580 Test Loss: 0.748 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 17 cost time: 2.0076541900634766
Epoch: 17, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.799 Vali Acc: 0.460 Test Loss: 0.799 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8597891330718994
Epoch: 18, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9633185863494873
Epoch: 19, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1697614192962646
Epoch: 20, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.945 Vali Acc: 0.460 Test Loss: 0.945 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8835721015930176
Epoch: 21, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7459397315979004
Epoch: 22, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6865952014923096
Epoch: 23, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.856 Vali Acc: 0.470 Test Loss: 0.856 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.785470724105835
Epoch: 24, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8521993160247803
Epoch: 25, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8272693157196045
Epoch: 26, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 248114
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.058885335922241
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.7314817905426025
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.686 Vali Acc: 0.520 Test Loss: 0.686 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7717225551605225
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.866152048110962
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8541185855865479
Epoch: 5, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9005489349365234
Epoch: 6, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.690 Vali Acc: 0.510 Test Loss: 0.690 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8390944004058838
Epoch: 7, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8572413921356201
Epoch: 8, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.886 Vali Acc: 0.490 Test Loss: 0.886 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8393630981445312
Epoch: 9, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.725 Vali Acc: 0.590 Test Loss: 0.725 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 1.7530725002288818
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.735804557800293
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.732 Vali Acc: 0.580 Test Loss: 0.732 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.927032232284546
Epoch: 12, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8728268146514893
Epoch: 13, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.870 Vali Acc: 0.480 Test Loss: 0.870 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9044685363769531
Epoch: 14, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8080778121948242
Epoch: 15, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.807 Vali Acc: 0.450 Test Loss: 0.807 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8227002620697021
Epoch: 16, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8862884044647217
Epoch: 17, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.760 Vali Acc: 0.590 Test Loss: 0.760 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9412486553192139
Epoch: 18, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.779252052307129
Epoch: 19, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 190834
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2540507316589355
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.9046120643615723
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.7521402835845947
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.702 Vali Acc: 0.460 Test Loss: 0.702 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8977205753326416
Epoch: 4, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7583117485046387
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9071826934814453
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 1.8962275981903076
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.914459466934204
Epoch: 8, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.792 Vali Acc: 0.470 Test Loss: 0.792 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8074331283569336
Epoch: 9, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.762542963027954
Epoch: 10, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8077638149261475
Epoch: 11, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7759714126586914
Epoch: 12, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 13 cost time: 1.6659297943115234
Epoch: 13, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6905953884124756
Epoch: 14, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.785 Vali Acc: 0.460 Test Loss: 0.785 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8847219944000244
Epoch: 15, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.755 Vali Acc: 0.460 Test Loss: 0.755 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7689182758331299
Epoch: 16, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.831 Vali Acc: 0.450 Test Loss: 0.831 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7559351921081543
Epoch: 17, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.775 Vali Acc: 0.470 Test Loss: 0.775 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6504874229431152
Epoch: 18, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 19 cost time: 1.746009349822998
Epoch: 19, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 20 cost time: 1.8104212284088135
Epoch: 20, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9218664169311523
Epoch: 21, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9649920463562012
Epoch: 22, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7859101295471191
Epoch: 23, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.884 Vali Acc: 0.440 Test Loss: 0.884 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.886622428894043
Epoch: 24, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7979435920715332
Epoch: 25, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.87400484085083
Epoch: 26, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 27 cost time: 1.911665916442871
Epoch: 27, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.689621925354004
Epoch: 28, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.020 Vali Acc: 0.540 Test Loss: 1.020 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.802846908569336
Epoch: 29, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.889 Vali Acc: 0.590 Test Loss: 0.889 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589991).  Saving model ...
Epoch: 30 cost time: 1.7627439498901367
Epoch: 30, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.795 Vali Acc: 0.540 Test Loss: 0.795 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8513011932373047
Epoch: 31, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8584764003753662
Epoch: 32, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.903 Vali Acc: 0.490 Test Loss: 0.903 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9642245769500732
Epoch: 33, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.909 Vali Acc: 0.520 Test Loss: 0.909 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8778166770935059
Epoch: 34, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7922089099884033
Epoch: 35, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.938 Vali Acc: 0.450 Test Loss: 0.938 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.781578779220581
Epoch: 36, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.9333784580230713
Epoch: 37, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.952 Vali Acc: 0.500 Test Loss: 0.952 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.8145527839660645
Epoch: 38, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8421196937561035
Epoch: 39, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 190514
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.881622791290283
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.7143912315368652
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.693 Vali Acc: 0.470 Test Loss: 0.693 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.736250400543213
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9051077365875244
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.765331745147705
Epoch: 5, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.681684970855713
Epoch: 6, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.7272248268127441
Epoch: 7, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8069579601287842
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.695 Vali Acc: 0.480 Test Loss: 0.695 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8887197971343994
Epoch: 9, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9032096862792969
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9008915424346924
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.685 Vali Acc: 0.540 Test Loss: 0.685 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 1.7576451301574707
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.761096715927124
Epoch: 13, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9059224128723145
Epoch: 14, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9352269172668457
Epoch: 15, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9399731159210205
Epoch: 16, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 17 cost time: 1.7618613243103027
Epoch: 17, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9021155834197998
Epoch: 18, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.85079026222229
Epoch: 19, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0248606204986572
Epoch: 20, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7881877422332764
Epoch: 21, Steps: 20 | Train Loss: 0.633 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7695887088775635
Epoch: 22, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8100001811981201
Epoch: 23, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.123755693435669
Epoch: 24, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.034109115600586
Epoch: 25, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8806827068328857
Epoch: 26, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 190194
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.518040180206299
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.16961407661438
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0160305500030518
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.974992275238037
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1192538738250732
Epoch: 5, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.925 Vali Acc: 0.490 Test Loss: 0.925 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.877347469329834
Epoch: 6, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.953 Vali Acc: 0.490 Test Loss: 0.953 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.937568187713623
Epoch: 7, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.982541561126709
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0441665649414062
Epoch: 9, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1353237628936768
Epoch: 10, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.001893997192383
Epoch: 11, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 189874
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.886985540390015
Epoch: 1, Steps: 20 | Train Loss: 0.879 Vali Loss: 0.912 Vali Acc: 0.510 Test Loss: 0.912 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 3.285022258758545
Epoch: 2, Steps: 20 | Train Loss: 0.794 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.074913501739502
Epoch: 3, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.913 Vali Acc: 0.500 Test Loss: 0.913 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.155099391937256
Epoch: 4, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.412905693054199
Epoch: 5, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3915276527404785
Epoch: 6, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3287408351898193
Epoch: 7, Steps: 20 | Train Loss: 0.833 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.43609356880188
Epoch: 8, Steps: 20 | Train Loss: 1.058 Vali Loss: 1.438 Vali Acc: 0.490 Test Loss: 1.438 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.898432970046997
Epoch: 9, Steps: 20 | Train Loss: 0.878 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6530284881591797
Epoch: 10, Steps: 20 | Train Loss: 1.173 Vali Loss: 1.703 Vali Acc: 0.520 Test Loss: 1.703 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.167008638381958
Epoch: 11, Steps: 20 | Train Loss: 1.176 Vali Loss: 0.991 Vali Acc: 0.480 Test Loss: 0.991 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.218947172164917
Epoch: 12, Steps: 20 | Train Loss: 0.870 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 8006438
model size : 35.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.362217664718628
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.808 Vali Acc: 0.420 Test Loss: 0.808 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.725773572921753
Epoch: 2, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
Validation loss decreased (-0.419992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.019261121749878
Epoch: 3, Steps: 20 | Train Loss: 0.857 Vali Loss: 1.026 Vali Acc: 0.480 Test Loss: 1.026 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.245274782180786
Epoch: 4, Steps: 20 | Train Loss: 0.864 Vali Loss: 1.000 Vali Acc: 0.480 Test Loss: 1.000 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1914772987365723
Epoch: 5, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.753028392791748
Epoch: 6, Steps: 20 | Train Loss: 0.941 Vali Loss: 0.742 Vali Acc: 0.460 Test Loss: 0.742 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5804920196533203
Epoch: 7, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.908 Vali Acc: 0.490 Test Loss: 0.908 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.961669921875
Epoch: 8, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.239 Vali Acc: 0.470 Test Loss: 1.239 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3107235431671143
Epoch: 9, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.227 Vali Acc: 0.490 Test Loss: 1.227 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3479835987091064
Epoch: 10, Steps: 20 | Train Loss: 1.193 Vali Loss: 1.918 Vali Acc: 0.510 Test Loss: 1.918 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.435167074203491
Epoch: 11, Steps: 20 | Train Loss: 1.441 Vali Loss: 2.424 Vali Acc: 0.510 Test Loss: 2.424 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2687928676605225
Epoch: 12, Steps: 20 | Train Loss: 0.974 Vali Loss: 1.264 Vali Acc: 0.490 Test Loss: 1.264 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3284857273101807
Epoch: 13, Steps: 20 | Train Loss: 0.789 Vali Loss: 1.752 Vali Acc: 0.500 Test Loss: 1.752 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.126833915710449
Epoch: 14, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.874321222305298
Epoch: 15, Steps: 20 | Train Loss: 1.235 Vali Loss: 2.462 Vali Acc: 0.490 Test Loss: 2.462 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 8004390
model size : 35.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.245559930801392
Epoch: 1, Steps: 20 | Train Loss: 0.895 Vali Loss: 1.044 Vali Acc: 0.490 Test Loss: 1.044 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 2.727668285369873
Epoch: 2, Steps: 20 | Train Loss: 0.921 Vali Loss: 0.935 Vali Acc: 0.490 Test Loss: 0.935 Test Acc: 0.490
Validation loss decreased (-0.489990 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 3.2932441234588623
Epoch: 3, Steps: 20 | Train Loss: 0.914 Vali Loss: 0.915 Vali Acc: 0.500 Test Loss: 0.915 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 3.098062515258789
Epoch: 4, Steps: 20 | Train Loss: 1.016 Vali Loss: 1.351 Vali Acc: 0.490 Test Loss: 1.351 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.182518720626831
Epoch: 5, Steps: 20 | Train Loss: 1.110 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.342331886291504
Epoch: 6, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 3.4228427410125732
Epoch: 7, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.823099374771118
Epoch: 8, Steps: 20 | Train Loss: 0.788 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.13665509223938
Epoch: 9, Steps: 20 | Train Loss: 1.039 Vali Loss: 1.385 Vali Acc: 0.490 Test Loss: 1.385 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.18021821975708
Epoch: 10, Steps: 20 | Train Loss: 1.204 Vali Loss: 1.771 Vali Acc: 0.490 Test Loss: 1.771 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0241587162017822
Epoch: 11, Steps: 20 | Train Loss: 0.883 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.13883113861084
Epoch: 12, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.005 Vali Acc: 0.490 Test Loss: 1.005 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.065486192703247
Epoch: 13, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7343947887420654
Epoch: 14, Steps: 20 | Train Loss: 0.725 Vali Loss: 1.613 Vali Acc: 0.500 Test Loss: 1.613 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6393940448760986
Epoch: 15, Steps: 20 | Train Loss: 0.844 Vali Loss: 1.408 Vali Acc: 0.510 Test Loss: 1.408 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1277642250061035
Epoch: 16, Steps: 20 | Train Loss: 1.592 Vali Loss: 1.066 Vali Acc: 0.510 Test Loss: 1.066 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 8002342
model size : 35.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.56955361366272
Epoch: 1, Steps: 20 | Train Loss: 0.838 Vali Loss: 0.899 Vali Acc: 0.580 Test Loss: 0.899 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 2.9513211250305176
Epoch: 2, Steps: 20 | Train Loss: 0.845 Vali Loss: 1.013 Vali Acc: 0.490 Test Loss: 1.013 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.207500457763672
Epoch: 3, Steps: 20 | Train Loss: 0.876 Vali Loss: 1.001 Vali Acc: 0.470 Test Loss: 1.001 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9214186668395996
Epoch: 4, Steps: 20 | Train Loss: 1.121 Vali Loss: 1.118 Vali Acc: 0.490 Test Loss: 1.118 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9780771732330322
Epoch: 5, Steps: 20 | Train Loss: 0.943 Vali Loss: 0.834 Vali Acc: 0.470 Test Loss: 0.834 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0231175422668457
Epoch: 6, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9896297454833984
Epoch: 7, Steps: 20 | Train Loss: 0.752 Vali Loss: 1.197 Vali Acc: 0.510 Test Loss: 1.197 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.232931613922119
Epoch: 8, Steps: 20 | Train Loss: 0.923 Vali Loss: 1.069 Vali Acc: 0.490 Test Loss: 1.069 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.590778112411499
Epoch: 9, Steps: 20 | Train Loss: 1.029 Vali Loss: 1.117 Vali Acc: 0.480 Test Loss: 1.117 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1938893795013428
Epoch: 10, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0423285961151123
Epoch: 11, Steps: 20 | Train Loss: 0.933 Vali Loss: 2.440 Vali Acc: 0.490 Test Loss: 2.440 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8000294
model size : 35.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.718499183654785
Epoch: 1, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.788 Vali Acc: 0.430 Test Loss: 0.788 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 3.495096206665039
Epoch: 2, Steps: 20 | Train Loss: 0.812 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
Validation loss decreased (-0.429992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.9791698455810547
Epoch: 3, Steps: 20 | Train Loss: 0.805 Vali Loss: 1.270 Vali Acc: 0.490 Test Loss: 1.270 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9158124923706055
Epoch: 4, Steps: 20 | Train Loss: 1.075 Vali Loss: 1.258 Vali Acc: 0.470 Test Loss: 1.258 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9355249404907227
Epoch: 5, Steps: 20 | Train Loss: 0.824 Vali Loss: 0.866 Vali Acc: 0.490 Test Loss: 0.866 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0967726707458496
Epoch: 6, Steps: 20 | Train Loss: 1.054 Vali Loss: 0.748 Vali Acc: 0.440 Test Loss: 0.748 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3054654598236084
Epoch: 7, Steps: 20 | Train Loss: 0.820 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.251910448074341
Epoch: 8, Steps: 20 | Train Loss: 0.949 Vali Loss: 1.186 Vali Acc: 0.480 Test Loss: 1.186 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2189502716064453
Epoch: 9, Steps: 20 | Train Loss: 1.099 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 10 cost time: 3.001152992248535
Epoch: 10, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.872 Vali Acc: 0.510 Test Loss: 0.872 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509991).  Saving model ...
Epoch: 11 cost time: 3.002424478530884
Epoch: 11, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.986 Vali Acc: 0.470 Test Loss: 0.986 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7786307334899902
Epoch: 12, Steps: 20 | Train Loss: 0.877 Vali Loss: 1.631 Vali Acc: 0.510 Test Loss: 1.631 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.88671875
Epoch: 13, Steps: 20 | Train Loss: 0.812 Vali Loss: 1.706 Vali Acc: 0.470 Test Loss: 1.706 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.508145570755005
Epoch: 14, Steps: 20 | Train Loss: 1.362 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5165855884552
Epoch: 15, Steps: 20 | Train Loss: 0.938 Vali Loss: 1.452 Vali Acc: 0.510 Test Loss: 1.452 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5183680057525635
Epoch: 16, Steps: 20 | Train Loss: 1.030 Vali Loss: 1.011 Vali Acc: 0.490 Test Loss: 1.011 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1206891536712646
Epoch: 17, Steps: 20 | Train Loss: 0.737 Vali Loss: 1.049 Vali Acc: 0.470 Test Loss: 1.049 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.849022388458252
Epoch: 18, Steps: 20 | Train Loss: 1.192 Vali Loss: 1.397 Vali Acc: 0.520 Test Loss: 1.397 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519986).  Saving model ...
Epoch: 19 cost time: 2.8650667667388916
Epoch: 19, Steps: 20 | Train Loss: 0.843 Vali Loss: 1.049 Vali Acc: 0.510 Test Loss: 1.049 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8071272373199463
Epoch: 20, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.678575277328491
Epoch: 21, Steps: 20 | Train Loss: 0.824 Vali Loss: 0.780 Vali Acc: 0.580 Test Loss: 0.780 Test Acc: 0.580
Validation loss decreased (-0.519986 --> -0.579992).  Saving model ...
Epoch: 22 cost time: 3.609041929244995
Epoch: 22, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3329291343688965
Epoch: 23, Steps: 20 | Train Loss: 0.653 Vali Loss: 1.060 Vali Acc: 0.530 Test Loss: 1.060 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0917093753814697
Epoch: 24, Steps: 20 | Train Loss: 0.946 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.422173261642456
Epoch: 25, Steps: 20 | Train Loss: 1.232 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.4754936695098877
Epoch: 26, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.2986583709716797
Epoch: 27, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3863868713378906
Epoch: 28, Steps: 20 | Train Loss: 0.874 Vali Loss: 0.999 Vali Acc: 0.500 Test Loss: 0.999 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6175968647003174
Epoch: 29, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.5482425689697266
Epoch: 30, Steps: 20 | Train Loss: 0.688 Vali Loss: 1.027 Vali Acc: 0.480 Test Loss: 1.027 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.706389904022217
Epoch: 31, Steps: 20 | Train Loss: 0.812 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6693158
model size : 30.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.054754257202148
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 1.002 Vali Acc: 0.490 Test Loss: 1.002 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 3.7673020362854004
Epoch: 2, Steps: 20 | Train Loss: 0.790 Vali Loss: 1.070 Vali Acc: 0.480 Test Loss: 1.070 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3404366970062256
Epoch: 3, Steps: 20 | Train Loss: 0.984 Vali Loss: 1.229 Vali Acc: 0.490 Test Loss: 1.229 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.509854793548584
Epoch: 4, Steps: 20 | Train Loss: 0.870 Vali Loss: 1.007 Vali Acc: 0.530 Test Loss: 1.007 Test Acc: 0.530
Validation loss decreased (-0.489990 --> -0.529990).  Saving model ...
Epoch: 5 cost time: 2.8859236240386963
Epoch: 5, Steps: 20 | Train Loss: 0.953 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.27013897895813
Epoch: 6, Steps: 20 | Train Loss: 0.910 Vali Loss: 1.142 Vali Acc: 0.480 Test Loss: 1.142 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.567887544631958
Epoch: 7, Steps: 20 | Train Loss: 0.827 Vali Loss: 1.340 Vali Acc: 0.510 Test Loss: 1.340 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.484863519668579
Epoch: 8, Steps: 20 | Train Loss: 1.048 Vali Loss: 1.221 Vali Acc: 0.490 Test Loss: 1.221 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5994911193847656
Epoch: 9, Steps: 20 | Train Loss: 1.087 Vali Loss: 1.028 Vali Acc: 0.490 Test Loss: 1.028 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.519929885864258
Epoch: 10, Steps: 20 | Train Loss: 1.027 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3544936180114746
Epoch: 11, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.760821580886841
Epoch: 12, Steps: 20 | Train Loss: 0.989 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1066763401031494
Epoch: 13, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.960 Vali Acc: 0.490 Test Loss: 0.960 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2309298515319824
Epoch: 14, Steps: 20 | Train Loss: 0.936 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 6691110
model size : 30.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.044504642486572
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.843 Vali Acc: 0.490 Test Loss: 0.843 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.972646474838257
Epoch: 2, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 3.104987382888794
Epoch: 3, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.082 Vali Acc: 0.510 Test Loss: 1.082 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4150383472442627
Epoch: 4, Steps: 20 | Train Loss: 0.836 Vali Loss: 1.211 Vali Acc: 0.510 Test Loss: 1.211 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2264153957366943
Epoch: 5, Steps: 20 | Train Loss: 1.098 Vali Loss: 0.937 Vali Acc: 0.500 Test Loss: 0.937 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4997239112854004
Epoch: 6, Steps: 20 | Train Loss: 0.940 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
Validation loss decreased (-0.509991 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 3.271728754043579
Epoch: 7, Steps: 20 | Train Loss: 1.095 Vali Loss: 0.800 Vali Acc: 0.450 Test Loss: 0.800 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8684158325195312
Epoch: 8, Steps: 20 | Train Loss: 0.871 Vali Loss: 1.440 Vali Acc: 0.490 Test Loss: 1.440 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3542957305908203
Epoch: 9, Steps: 20 | Train Loss: 0.825 Vali Loss: 0.788 Vali Acc: 0.580 Test Loss: 0.788 Test Acc: 0.580
Validation loss decreased (-0.509992 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 3.545609474182129
Epoch: 10, Steps: 20 | Train Loss: 0.936 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.270763874053955
Epoch: 11, Steps: 20 | Train Loss: 1.680 Vali Loss: 0.929 Vali Acc: 0.590 Test Loss: 0.929 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 12 cost time: 2.547391653060913
Epoch: 12, Steps: 20 | Train Loss: 0.944 Vali Loss: 0.746 Vali Acc: 0.600 Test Loss: 0.746 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599993).  Saving model ...
Epoch: 13 cost time: 2.651420831680298
Epoch: 13, Steps: 20 | Train Loss: 0.989 Vali Loss: 1.022 Vali Acc: 0.510 Test Loss: 1.022 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.085620164871216
Epoch: 14, Steps: 20 | Train Loss: 0.825 Vali Loss: 0.964 Vali Acc: 0.480 Test Loss: 0.964 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.161775588989258
Epoch: 15, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1665384769439697
Epoch: 16, Steps: 20 | Train Loss: 0.867 Vali Loss: 1.504 Vali Acc: 0.510 Test Loss: 1.504 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.372009754180908
Epoch: 17, Steps: 20 | Train Loss: 1.228 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.3952934741973877
Epoch: 18, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4379661083221436
Epoch: 19, Steps: 20 | Train Loss: 0.681 Vali Loss: 2.376 Vali Acc: 0.500 Test Loss: 2.376 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.539907932281494
Epoch: 20, Steps: 20 | Train Loss: 1.036 Vali Loss: 0.818 Vali Acc: 0.570 Test Loss: 0.818 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0333468914031982
Epoch: 21, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8057587146759033
Epoch: 22, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.811 Vali Acc: 0.580 Test Loss: 0.811 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6689062
model size : 30.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.7084059715271
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.711 Vali Acc: 0.600 Test Loss: 0.711 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.435040235519409
Epoch: 2, Steps: 20 | Train Loss: 0.803 Vali Loss: 0.972 Vali Acc: 0.480 Test Loss: 0.972 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.083648204803467
Epoch: 3, Steps: 20 | Train Loss: 0.941 Vali Loss: 0.778 Vali Acc: 0.460 Test Loss: 0.778 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1392669677734375
Epoch: 4, Steps: 20 | Train Loss: 0.875 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1127097606658936
Epoch: 5, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.248964309692383
Epoch: 6, Steps: 20 | Train Loss: 0.796 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0498058795928955
Epoch: 7, Steps: 20 | Train Loss: 0.992 Vali Loss: 0.881 Vali Acc: 0.480 Test Loss: 0.881 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0777649879455566
Epoch: 8, Steps: 20 | Train Loss: 1.049 Vali Loss: 1.074 Vali Acc: 0.480 Test Loss: 1.074 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9935097694396973
Epoch: 9, Steps: 20 | Train Loss: 0.914 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8988161087036133
Epoch: 10, Steps: 20 | Train Loss: 0.830 Vali Loss: 1.684 Vali Acc: 0.490 Test Loss: 1.684 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.599520444869995
Epoch: 11, Steps: 20 | Train Loss: 0.941 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6687014
model size : 30.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.101202726364136
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.839 Vali Acc: 0.450 Test Loss: 0.839 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.528391122817993
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.893 Vali Acc: 0.490 Test Loss: 0.893 Test Acc: 0.490
Validation loss decreased (-0.449992 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 2.621260166168213
Epoch: 3, Steps: 20 | Train Loss: 0.788 Vali Loss: 1.121 Vali Acc: 0.490 Test Loss: 1.121 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.593367338180542
Epoch: 4, Steps: 20 | Train Loss: 1.265 Vali Loss: 1.053 Vali Acc: 0.450 Test Loss: 1.053 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.07102632522583
Epoch: 5, Steps: 20 | Train Loss: 1.074 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
Validation loss decreased (-0.489991 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.0885159969329834
Epoch: 6, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 2.249391794204712
Epoch: 7, Steps: 20 | Train Loss: 0.983 Vali Loss: 1.097 Vali Acc: 0.510 Test Loss: 1.097 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4923884868621826
Epoch: 8, Steps: 20 | Train Loss: 0.880 Vali Loss: 1.441 Vali Acc: 0.490 Test Loss: 1.441 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6370737552642822
Epoch: 9, Steps: 20 | Train Loss: 1.070 Vali Loss: 1.114 Vali Acc: 0.510 Test Loss: 1.114 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1319539546966553
Epoch: 10, Steps: 20 | Train Loss: 0.798 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6687309741973877
Epoch: 11, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0210390090942383
Epoch: 12, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.860 Vali Acc: 0.530 Test Loss: 0.860 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3184094429016113
Epoch: 13, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.244877338409424
Epoch: 14, Steps: 20 | Train Loss: 0.763 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0544497966766357
Epoch: 15, Steps: 20 | Train Loss: 0.718 Vali Loss: 1.044 Vali Acc: 0.540 Test Loss: 1.044 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.123936414718628
Epoch: 16, Steps: 20 | Train Loss: 0.791 Vali Loss: 1.044 Vali Acc: 0.510 Test Loss: 1.044 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6036518
model size : 28.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.453984260559082
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.560467481613159
Epoch: 2, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.200 Vali Acc: 0.430 Test Loss: 1.200 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2555196285247803
Epoch: 3, Steps: 20 | Train Loss: 1.050 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 3.1457622051239014
Epoch: 4, Steps: 20 | Train Loss: 0.817 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.5959603786468506
Epoch: 5, Steps: 20 | Train Loss: 0.916 Vali Loss: 1.991 Vali Acc: 0.510 Test Loss: 1.991 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9731144905090332
Epoch: 6, Steps: 20 | Train Loss: 1.066 Vali Loss: 2.327 Vali Acc: 0.510 Test Loss: 2.327 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.239271879196167
Epoch: 7, Steps: 20 | Train Loss: 1.122 Vali Loss: 0.803 Vali Acc: 0.570 Test Loss: 0.803 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 3.2699825763702393
Epoch: 8, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.201663017272949
Epoch: 9, Steps: 20 | Train Loss: 0.817 Vali Loss: 0.924 Vali Acc: 0.490 Test Loss: 0.924 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.985821008682251
Epoch: 10, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9968526363372803
Epoch: 11, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.502 Vali Acc: 0.470 Test Loss: 1.502 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9135565757751465
Epoch: 12, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.917 Vali Acc: 0.490 Test Loss: 0.917 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.608288049697876
Epoch: 13, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.610934019088745
Epoch: 14, Steps: 20 | Train Loss: 0.708 Vali Loss: 1.204 Vali Acc: 0.490 Test Loss: 1.204 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3805432319641113
Epoch: 15, Steps: 20 | Train Loss: 0.824 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4564547538757324
Epoch: 16, Steps: 20 | Train Loss: 0.782 Vali Loss: 1.067 Vali Acc: 0.590 Test Loss: 1.067 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589989).  Saving model ...
Epoch: 17 cost time: 3.4378409385681152
Epoch: 17, Steps: 20 | Train Loss: 0.649 Vali Loss: 1.140 Vali Acc: 0.530 Test Loss: 1.140 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.29822039604187
Epoch: 18, Steps: 20 | Train Loss: 1.023 Vali Loss: 1.457 Vali Acc: 0.490 Test Loss: 1.457 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.648664951324463
Epoch: 19, Steps: 20 | Train Loss: 1.070 Vali Loss: 2.413 Vali Acc: 0.500 Test Loss: 2.413 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1234772205352783
Epoch: 20, Steps: 20 | Train Loss: 0.875 Vali Loss: 1.055 Vali Acc: 0.540 Test Loss: 1.055 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.752150774002075
Epoch: 21, Steps: 20 | Train Loss: 0.919 Vali Loss: 0.691 Vali Acc: 0.620 Test Loss: 0.691 Test Acc: 0.620
Validation loss decreased (-0.589989 --> -0.619993).  Saving model ...
Epoch: 22 cost time: 3.398162841796875
Epoch: 22, Steps: 20 | Train Loss: 1.040 Vali Loss: 1.756 Vali Acc: 0.510 Test Loss: 1.756 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4584386348724365
Epoch: 23, Steps: 20 | Train Loss: 1.440 Vali Loss: 1.114 Vali Acc: 0.540 Test Loss: 1.114 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2857792377471924
Epoch: 24, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.906 Vali Acc: 0.520 Test Loss: 0.906 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.288614511489868
Epoch: 25, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.912 Vali Acc: 0.540 Test Loss: 0.912 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.365548610687256
Epoch: 26, Steps: 20 | Train Loss: 0.685 Vali Loss: 1.653 Vali Acc: 0.520 Test Loss: 1.653 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.747694730758667
Epoch: 27, Steps: 20 | Train Loss: 0.870 Vali Loss: 2.246 Vali Acc: 0.530 Test Loss: 2.246 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.422962188720703
Epoch: 28, Steps: 20 | Train Loss: 0.754 Vali Loss: 1.276 Vali Acc: 0.460 Test Loss: 1.276 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.3303205966949463
Epoch: 29, Steps: 20 | Train Loss: 0.937 Vali Loss: 1.649 Vali Acc: 0.530 Test Loss: 1.649 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.722562313079834
Epoch: 30, Steps: 20 | Train Loss: 0.865 Vali Loss: 0.899 Vali Acc: 0.510 Test Loss: 0.899 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.7889418601989746
Epoch: 31, Steps: 20 | Train Loss: 0.589 Vali Loss: 1.214 Vali Acc: 0.540 Test Loss: 1.214 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6034470
model size : 28.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.8753437995910645
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.865 Vali Acc: 0.450 Test Loss: 0.865 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 3.408259153366089
Epoch: 2, Steps: 20 | Train Loss: 0.862 Vali Loss: 0.985 Vali Acc: 0.440 Test Loss: 0.985 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7596371173858643
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 1.024 Vali Acc: 0.480 Test Loss: 1.024 Test Acc: 0.480
Validation loss decreased (-0.449991 --> -0.479990).  Saving model ...
Epoch: 4 cost time: 3.5286660194396973
Epoch: 4, Steps: 20 | Train Loss: 0.884 Vali Loss: 0.881 Vali Acc: 0.580 Test Loss: 0.881 Test Acc: 0.580
Validation loss decreased (-0.479990 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 2.619110584259033
Epoch: 5, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.799 Vali Acc: 0.460 Test Loss: 0.799 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.530043363571167
Epoch: 6, Steps: 20 | Train Loss: 1.152 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3862879276275635
Epoch: 7, Steps: 20 | Train Loss: 0.882 Vali Loss: 1.800 Vali Acc: 0.490 Test Loss: 1.800 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.095928430557251
Epoch: 8, Steps: 20 | Train Loss: 0.959 Vali Loss: 1.320 Vali Acc: 0.510 Test Loss: 1.320 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3996968269348145
Epoch: 9, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3159000873565674
Epoch: 10, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.734 Vali Acc: 0.570 Test Loss: 0.734 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.766955614089966
Epoch: 11, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.851 Vali Acc: 0.480 Test Loss: 0.851 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0755107402801514
Epoch: 12, Steps: 20 | Train Loss: 0.826 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.017481803894043
Epoch: 13, Steps: 20 | Train Loss: 0.732 Vali Loss: 1.888 Vali Acc: 0.490 Test Loss: 1.888 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0220038890838623
Epoch: 14, Steps: 20 | Train Loss: 0.984 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6032422
model size : 28.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.046559810638428
Epoch: 1, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.1782708168029785
Epoch: 2, Steps: 20 | Train Loss: 0.880 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.9652559757232666
Epoch: 3, Steps: 20 | Train Loss: 0.811 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.160137891769409
Epoch: 4, Steps: 20 | Train Loss: 0.715 Vali Loss: 1.057 Vali Acc: 0.500 Test Loss: 1.057 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2882633209228516
Epoch: 5, Steps: 20 | Train Loss: 0.937 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.498291492462158
Epoch: 6, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5317885875701904
Epoch: 7, Steps: 20 | Train Loss: 0.863 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8046140670776367
Epoch: 8, Steps: 20 | Train Loss: 1.019 Vali Loss: 0.984 Vali Acc: 0.550 Test Loss: 0.984 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.03802227973938
Epoch: 9, Steps: 20 | Train Loss: 1.011 Vali Loss: 0.833 Vali Acc: 0.570 Test Loss: 0.833 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0659658908843994
Epoch: 10, Steps: 20 | Train Loss: 1.114 Vali Loss: 1.223 Vali Acc: 0.520 Test Loss: 1.223 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1631534099578857
Epoch: 11, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7137577533721924
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.759 Vali Acc: 0.610 Test Loss: 0.759 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 13 cost time: 3.180961847305298
Epoch: 13, Steps: 20 | Train Loss: 0.820 Vali Loss: 0.864 Vali Acc: 0.520 Test Loss: 0.864 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3913655281066895
Epoch: 14, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3453304767608643
Epoch: 15, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1046030521392822
Epoch: 16, Steps: 20 | Train Loss: 0.912 Vali Loss: 1.249 Vali Acc: 0.580 Test Loss: 1.249 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2143828868865967
Epoch: 17, Steps: 20 | Train Loss: 0.863 Vali Loss: 1.650 Vali Acc: 0.520 Test Loss: 1.650 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.065380096435547
Epoch: 18, Steps: 20 | Train Loss: 0.713 Vali Loss: 2.118 Vali Acc: 0.490 Test Loss: 2.118 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.076568603515625
Epoch: 19, Steps: 20 | Train Loss: 1.154 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8603298664093018
Epoch: 20, Steps: 20 | Train Loss: 0.785 Vali Loss: 1.100 Vali Acc: 0.530 Test Loss: 1.100 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1903445720672607
Epoch: 21, Steps: 20 | Train Loss: 0.771 Vali Loss: 1.587 Vali Acc: 0.490 Test Loss: 1.587 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.281353712081909
Epoch: 22, Steps: 20 | Train Loss: 1.366 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6030374
model size : 28.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.06728982925415
Epoch: 1, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.926 Vali Acc: 0.460 Test Loss: 0.926 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 3.0918335914611816
Epoch: 2, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.896 Vali Acc: 0.490 Test Loss: 0.896 Test Acc: 0.490
Validation loss decreased (-0.459991 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 3.1124796867370605
Epoch: 3, Steps: 20 | Train Loss: 0.925 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
Validation loss decreased (-0.489991 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 3.0515239238739014
Epoch: 4, Steps: 20 | Train Loss: 0.947 Vali Loss: 1.452 Vali Acc: 0.470 Test Loss: 1.452 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.926281452178955
Epoch: 5, Steps: 20 | Train Loss: 1.021 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4778754711151123
Epoch: 6, Steps: 20 | Train Loss: 1.018 Vali Loss: 1.555 Vali Acc: 0.510 Test Loss: 1.555 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.310866117477417
Epoch: 7, Steps: 20 | Train Loss: 0.960 Vali Loss: 1.152 Vali Acc: 0.540 Test Loss: 1.152 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 2.57892107963562
Epoch: 8, Steps: 20 | Train Loss: 0.897 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 2.894261121749878
Epoch: 9, Steps: 20 | Train Loss: 0.827 Vali Loss: 1.002 Vali Acc: 0.510 Test Loss: 1.002 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.082815408706665
Epoch: 10, Steps: 20 | Train Loss: 0.806 Vali Loss: 1.258 Vali Acc: 0.490 Test Loss: 1.258 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3496482372283936
Epoch: 11, Steps: 20 | Train Loss: 1.146 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0517611503601074
Epoch: 12, Steps: 20 | Train Loss: 0.881 Vali Loss: 1.711 Vali Acc: 0.490 Test Loss: 1.711 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.259186267852783
Epoch: 13, Steps: 20 | Train Loss: 0.882 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7267720699310303
Epoch: 14, Steps: 20 | Train Loss: 0.848 Vali Loss: 0.767 Vali Acc: 0.580 Test Loss: 0.767 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 2.9537816047668457
Epoch: 15, Steps: 20 | Train Loss: 1.016 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0086371898651123
Epoch: 16, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.961 Vali Acc: 0.480 Test Loss: 1.961 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.217991590499878
Epoch: 17, Steps: 20 | Train Loss: 1.005 Vali Loss: 1.191 Vali Acc: 0.490 Test Loss: 1.191 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.038684129714966
Epoch: 18, Steps: 20 | Train Loss: 0.746 Vali Loss: 1.273 Vali Acc: 0.490 Test Loss: 1.273 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9647555351257324
Epoch: 19, Steps: 20 | Train Loss: 0.890 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.783277750015259
Epoch: 20, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.963 Vali Acc: 0.550 Test Loss: 0.963 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.81611704826355
Epoch: 21, Steps: 20 | Train Loss: 1.091 Vali Loss: 1.451 Vali Acc: 0.460 Test Loss: 1.451 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.682929277420044
Epoch: 22, Steps: 20 | Train Loss: 1.139 Vali Loss: 1.099 Vali Acc: 0.530 Test Loss: 1.099 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2480227947235107
Epoch: 23, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.084 Vali Acc: 0.490 Test Loss: 1.084 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8758668899536133
Epoch: 24, Steps: 20 | Train Loss: 0.851 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5708198
model size : 26.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4412858486175537
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.4688880443573
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 3.1049129962921143
Epoch: 3, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
Validation loss decreased (-0.519990 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 3.0226926803588867
Epoch: 4, Steps: 20 | Train Loss: 0.869 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 2.768988609313965
Epoch: 5, Steps: 20 | Train Loss: 0.879 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0311105251312256
Epoch: 6, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.179 Vali Acc: 0.510 Test Loss: 1.179 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.965169668197632
Epoch: 7, Steps: 20 | Train Loss: 0.852 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4522111415863037
Epoch: 8, Steps: 20 | Train Loss: 0.849 Vali Loss: 1.424 Vali Acc: 0.510 Test Loss: 1.424 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9881234169006348
Epoch: 9, Steps: 20 | Train Loss: 1.461 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9532535076141357
Epoch: 10, Steps: 20 | Train Loss: 0.789 Vali Loss: 1.237 Vali Acc: 0.470 Test Loss: 1.237 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9612858295440674
Epoch: 11, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 3.2086431980133057
Epoch: 12, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.206897020339966
Epoch: 13, Steps: 20 | Train Loss: 0.988 Vali Loss: 0.784 Vali Acc: 0.580 Test Loss: 0.784 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 2.880997896194458
Epoch: 14, Steps: 20 | Train Loss: 0.757 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4795823097229004
Epoch: 15, Steps: 20 | Train Loss: 0.825 Vali Loss: 0.793 Vali Acc: 0.570 Test Loss: 0.793 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8331427574157715
Epoch: 16, Steps: 20 | Train Loss: 0.819 Vali Loss: 2.801 Vali Acc: 0.490 Test Loss: 2.801 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.93442702293396
Epoch: 17, Steps: 20 | Train Loss: 1.114 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.844193458557129
Epoch: 18, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.849 Vali Acc: 0.540 Test Loss: 0.849 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9450790882110596
Epoch: 19, Steps: 20 | Train Loss: 0.793 Vali Loss: 2.877 Vali Acc: 0.450 Test Loss: 2.877 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1667943000793457
Epoch: 20, Steps: 20 | Train Loss: 1.057 Vali Loss: 1.038 Vali Acc: 0.530 Test Loss: 1.038 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0576565265655518
Epoch: 21, Steps: 20 | Train Loss: 0.897 Vali Loss: 0.980 Vali Acc: 0.510 Test Loss: 0.980 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9120101928710938
Epoch: 22, Steps: 20 | Train Loss: 0.733 Vali Loss: 2.863 Vali Acc: 0.490 Test Loss: 2.863 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.956688404083252
Epoch: 23, Steps: 20 | Train Loss: 1.301 Vali Loss: 1.864 Vali Acc: 0.510 Test Loss: 1.864 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5706150
model size : 26.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.512877464294434
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.215425491333008
Epoch: 2, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 3.034670829772949
Epoch: 3, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.890 Vali Acc: 0.490 Test Loss: 0.890 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.187030553817749
Epoch: 4, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.878 Vali Acc: 0.510 Test Loss: 0.878 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509991).  Saving model ...
Epoch: 5 cost time: 2.986454486846924
Epoch: 5, Steps: 20 | Train Loss: 0.853 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.167708396911621
Epoch: 6, Steps: 20 | Train Loss: 0.748 Vali Loss: 1.418 Vali Acc: 0.490 Test Loss: 1.418 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2173011302948
Epoch: 7, Steps: 20 | Train Loss: 1.563 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
Validation loss decreased (-0.509991 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 2.8504319190979004
Epoch: 8, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.893 Vali Acc: 0.540 Test Loss: 0.893 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.136582612991333
Epoch: 9, Steps: 20 | Train Loss: 0.884 Vali Loss: 1.415 Vali Acc: 0.450 Test Loss: 1.415 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3019590377807617
Epoch: 10, Steps: 20 | Train Loss: 0.958 Vali Loss: 0.900 Vali Acc: 0.550 Test Loss: 0.900 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3685343265533447
Epoch: 11, Steps: 20 | Train Loss: 0.915 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.374520778656006
Epoch: 12, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.964 Vali Acc: 0.530 Test Loss: 0.964 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.058650255203247
Epoch: 13, Steps: 20 | Train Loss: 1.081 Vali Loss: 1.041 Vali Acc: 0.440 Test Loss: 1.041 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.849602699279785
Epoch: 14, Steps: 20 | Train Loss: 1.159 Vali Loss: 0.907 Vali Acc: 0.450 Test Loss: 0.907 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2363007068634033
Epoch: 15, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.048 Vali Acc: 0.480 Test Loss: 1.048 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.74275541305542
Epoch: 16, Steps: 20 | Train Loss: 1.035 Vali Loss: 1.524 Vali Acc: 0.520 Test Loss: 1.524 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.2425971031188965
Epoch: 17, Steps: 20 | Train Loss: 1.178 Vali Loss: 0.904 Vali Acc: 0.460 Test Loss: 0.904 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5704102
model size : 26.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.834514856338501
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.808 Vali Acc: 0.450 Test Loss: 0.808 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 3.3755393028259277
Epoch: 2, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
Validation loss decreased (-0.449992 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 3.2762441635131836
Epoch: 3, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3871538639068604
Epoch: 4, Steps: 20 | Train Loss: 0.947 Vali Loss: 0.889 Vali Acc: 0.480 Test Loss: 0.889 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0894582271575928
Epoch: 5, Steps: 20 | Train Loss: 0.921 Vali Loss: 0.923 Vali Acc: 0.520 Test Loss: 0.923 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9739279747009277
Epoch: 6, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.760 Vali Acc: 0.580 Test Loss: 0.760 Test Acc: 0.580
Validation loss decreased (-0.519991 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 2.5975630283355713
Epoch: 7, Steps: 20 | Train Loss: 0.798 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2338476181030273
Epoch: 8, Steps: 20 | Train Loss: 0.903 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.72019362449646
Epoch: 9, Steps: 20 | Train Loss: 0.926 Vali Loss: 0.872 Vali Acc: 0.480 Test Loss: 0.872 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.965677261352539
Epoch: 10, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.144575357437134
Epoch: 11, Steps: 20 | Train Loss: 0.986 Vali Loss: 1.339 Vali Acc: 0.480 Test Loss: 1.339 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1316585540771484
Epoch: 12, Steps: 20 | Train Loss: 1.032 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8422629833221436
Epoch: 13, Steps: 20 | Train Loss: 0.935 Vali Loss: 1.339 Vali Acc: 0.490 Test Loss: 1.339 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.993691921234131
Epoch: 14, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.991 Vali Acc: 0.520 Test Loss: 0.991 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4117648601531982
Epoch: 15, Steps: 20 | Train Loss: 0.940 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.218486785888672
Epoch: 16, Steps: 20 | Train Loss: 0.925 Vali Loss: 0.777 Vali Acc: 0.580 Test Loss: 0.777 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5702054
model size : 26.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.481882333755493
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.937342643737793
Epoch: 2, Steps: 20 | Train Loss: 0.835 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.509991 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.693131923675537
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4932570457458496
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 1.055 Vali Acc: 0.430 Test Loss: 1.055 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.892068862915039
Epoch: 5, Steps: 20 | Train Loss: 0.877 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1107490062713623
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.865 Vali Acc: 0.480 Test Loss: 0.865 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.439542770385742
Epoch: 7, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.697 Vali Acc: 0.590 Test Loss: 0.697 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 3.127716064453125
Epoch: 8, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4116716384887695
Epoch: 9, Steps: 20 | Train Loss: 0.707 Vali Loss: 1.134 Vali Acc: 0.480 Test Loss: 1.134 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8062703609466553
Epoch: 10, Steps: 20 | Train Loss: 0.795 Vali Loss: 1.074 Vali Acc: 0.490 Test Loss: 1.074 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7252154350280762
Epoch: 11, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.949 Vali Acc: 0.500 Test Loss: 0.949 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.09523344039917
Epoch: 12, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9145662784576416
Epoch: 13, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.935 Vali Acc: 0.540 Test Loss: 0.935 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9921863079071045
Epoch: 14, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.828 Vali Acc: 0.570 Test Loss: 0.828 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.921684980392456
Epoch: 15, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9934964179992676
Epoch: 16, Steps: 20 | Train Loss: 0.806 Vali Loss: 1.102 Vali Acc: 0.440 Test Loss: 1.102 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9736595153808594
Epoch: 17, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.919 Vali Acc: 0.460 Test Loss: 0.919 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2695078
model size : 12.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.781876564025879
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.0737180709838867
Epoch: 2, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 3.043287992477417
Epoch: 3, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.926380157470703
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.804 Vali Acc: 0.470 Test Loss: 0.804 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0218136310577393
Epoch: 5, Steps: 20 | Train Loss: 0.754 Vali Loss: 1.491 Vali Acc: 0.490 Test Loss: 1.491 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.616884708404541
Epoch: 6, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0912458896636963
Epoch: 7, Steps: 20 | Train Loss: 0.968 Vali Loss: 1.512 Vali Acc: 0.490 Test Loss: 1.512 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0841550827026367
Epoch: 8, Steps: 20 | Train Loss: 0.851 Vali Loss: 0.863 Vali Acc: 0.540 Test Loss: 0.863 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 9 cost time: 3.1632325649261475
Epoch: 9, Steps: 20 | Train Loss: 0.837 Vali Loss: 1.384 Vali Acc: 0.490 Test Loss: 1.384 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.500213861465454
Epoch: 10, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
Validation loss decreased (-0.539991 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 2.9498536586761475
Epoch: 11, Steps: 20 | Train Loss: 0.753 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1676688194274902
Epoch: 12, Steps: 20 | Train Loss: 0.877 Vali Loss: 0.835 Vali Acc: 0.480 Test Loss: 0.835 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.141113519668579
Epoch: 13, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.868 Vali Acc: 0.500 Test Loss: 0.868 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0871894359588623
Epoch: 14, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.817 Vali Acc: 0.450 Test Loss: 0.817 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.807931661605835
Epoch: 15, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3264760971069336
Epoch: 16, Steps: 20 | Train Loss: 0.688 Vali Loss: 1.135 Vali Acc: 0.520 Test Loss: 1.135 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6275055408477783
Epoch: 17, Steps: 20 | Train Loss: 0.841 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 18 cost time: 2.0571465492248535
Epoch: 18, Steps: 20 | Train Loss: 0.783 Vali Loss: 1.053 Vali Acc: 0.520 Test Loss: 1.053 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.159273147583008
Epoch: 19, Steps: 20 | Train Loss: 0.763 Vali Loss: 1.211 Vali Acc: 0.440 Test Loss: 1.211 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.046510934829712
Epoch: 20, Steps: 20 | Train Loss: 0.886 Vali Loss: 1.152 Vali Acc: 0.440 Test Loss: 1.152 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7875325679779053
Epoch: 21, Steps: 20 | Train Loss: 0.980 Vali Loss: 0.990 Vali Acc: 0.450 Test Loss: 0.990 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8849074840545654
Epoch: 22, Steps: 20 | Train Loss: 0.636 Vali Loss: 1.058 Vali Acc: 0.540 Test Loss: 1.058 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.841992139816284
Epoch: 23, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.865 Vali Acc: 0.460 Test Loss: 0.865 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.243502140045166
Epoch: 24, Steps: 20 | Train Loss: 0.567 Vali Loss: 1.128 Vali Acc: 0.470 Test Loss: 1.128 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7323741912841797
Epoch: 25, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.989 Vali Acc: 0.520 Test Loss: 0.989 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3554913997650146
Epoch: 26, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559989).  Saving model ...
Epoch: 27 cost time: 2.9008352756500244
Epoch: 27, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8674399852752686
Epoch: 28, Steps: 20 | Train Loss: 0.586 Vali Loss: 1.051 Vali Acc: 0.510 Test Loss: 1.051 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9334802627563477
Epoch: 29, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1500766277313232
Epoch: 30, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.095 Vali Acc: 0.570 Test Loss: 1.095 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569989).  Saving model ...
Epoch: 31 cost time: 2.66789174079895
Epoch: 31, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.390 Vali Acc: 0.490 Test Loss: 1.390 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.837345600128174
Epoch: 32, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.445 Vali Acc: 0.450 Test Loss: 1.445 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.1225697994232178
Epoch: 33, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.569989 --> -0.599986).  Saving model ...
Epoch: 34 cost time: 2.9103763103485107
Epoch: 34, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.941 Vali Acc: 0.500 Test Loss: 1.941 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.879782199859619
Epoch: 35, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.347 Vali Acc: 0.510 Test Loss: 1.347 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.136869430541992
Epoch: 36, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599989).  Saving model ...
Epoch: 37 cost time: 3.1289446353912354
Epoch: 37, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.555 Vali Acc: 0.530 Test Loss: 1.555 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2691519260406494
Epoch: 38, Steps: 20 | Train Loss: 0.532 Vali Loss: 1.494 Vali Acc: 0.590 Test Loss: 1.494 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.0347797870635986
Epoch: 39, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.765 Vali Acc: 0.530 Test Loss: 1.765 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.105388879776001
Epoch: 40, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.598 Vali Acc: 0.520 Test Loss: 1.598 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.085686445236206
Epoch: 41, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.558 Vali Acc: 0.540 Test Loss: 1.558 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.9942007064819336
Epoch: 42, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.556 Vali Acc: 0.520 Test Loss: 1.556 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.47925066947937
Epoch: 43, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.649 Vali Acc: 0.510 Test Loss: 1.649 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.0994017124176025
Epoch: 44, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.837 Vali Acc: 0.550 Test Loss: 1.837 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.47269606590271
Epoch: 45, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.748 Vali Acc: 0.520 Test Loss: 1.748 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.583946943283081
Epoch: 46, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.611 Vali Acc: 0.560 Test Loss: 1.611 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2694054
model size : 12.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.609399318695068
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.683 Vali Acc: 0.600 Test Loss: 0.683 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.435192346572876
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.828 Vali Acc: 0.470 Test Loss: 0.828 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1973674297332764
Epoch: 3, Steps: 20 | Train Loss: 0.825 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4245288372039795
Epoch: 4, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0893735885620117
Epoch: 5, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.140899419784546
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1461281776428223
Epoch: 7, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.937 Vali Acc: 0.470 Test Loss: 0.937 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2405755519866943
Epoch: 8, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.791 Vali Acc: 0.570 Test Loss: 0.791 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5539052486419678
Epoch: 9, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.752 Vali Acc: 0.590 Test Loss: 0.752 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4930808544158936
Epoch: 10, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.819 Vali Acc: 0.480 Test Loss: 0.819 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.3784284591674805
Epoch: 11, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.850 Vali Acc: 0.480 Test Loss: 0.850 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2693030
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.751216411590576
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.348536252975464
Epoch: 2, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.835 Vali Acc: 0.440 Test Loss: 0.835 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.27482271194458
Epoch: 3, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.880354642868042
Epoch: 4, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.901 Vali Acc: 0.460 Test Loss: 0.901 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8839545249938965
Epoch: 5, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 2.708432912826538
Epoch: 6, Steps: 20 | Train Loss: 0.811 Vali Loss: 1.401 Vali Acc: 0.490 Test Loss: 1.401 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6726551055908203
Epoch: 7, Steps: 20 | Train Loss: 0.843 Vali Loss: 0.849 Vali Acc: 0.570 Test Loss: 0.849 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.217473268508911
Epoch: 8, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6071884632110596
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5590624809265137
Epoch: 10, Steps: 20 | Train Loss: 0.813 Vali Loss: 1.078 Vali Acc: 0.480 Test Loss: 1.078 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.159996747970581
Epoch: 11, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6393048763275146
Epoch: 12, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.724 Vali Acc: 0.580 Test Loss: 0.724 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 2.40139102935791
Epoch: 13, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.613524913787842
Epoch: 14, Steps: 20 | Train Loss: 0.737 Vali Loss: 1.235 Vali Acc: 0.490 Test Loss: 1.235 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.88688325881958
Epoch: 15, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.942 Vali Acc: 0.540 Test Loss: 0.942 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1334474086761475
Epoch: 16, Steps: 20 | Train Loss: 0.665 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0213427543640137
Epoch: 17, Steps: 20 | Train Loss: 0.730 Vali Loss: 1.207 Vali Acc: 0.510 Test Loss: 1.207 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9998276233673096
Epoch: 18, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.822087049484253
Epoch: 19, Steps: 20 | Train Loss: 0.722 Vali Loss: 1.233 Vali Acc: 0.490 Test Loss: 1.233 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1670033931732178
Epoch: 20, Steps: 20 | Train Loss: 1.129 Vali Loss: 1.443 Vali Acc: 0.520 Test Loss: 1.443 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6831533908843994
Epoch: 21, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.886 Vali Acc: 0.460 Test Loss: 0.886 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.735743522644043
Epoch: 22, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.929 Vali Acc: 0.570 Test Loss: 0.929 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2692006
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.697939872741699
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.9149928092956543
Epoch: 2, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.815 Vali Acc: 0.490 Test Loss: 0.815 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8750839233398438
Epoch: 3, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.962494134902954
Epoch: 4, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.7956836223602295
Epoch: 5, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.183615207672119
Epoch: 6, Steps: 20 | Train Loss: 0.899 Vali Loss: 0.928 Vali Acc: 0.470 Test Loss: 0.928 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9745519161224365
Epoch: 7, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 3.061967611312866
Epoch: 8, Steps: 20 | Train Loss: 0.702 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.024641752243042
Epoch: 9, Steps: 20 | Train Loss: 0.778 Vali Loss: 1.044 Vali Acc: 0.480 Test Loss: 1.044 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.064317464828491
Epoch: 10, Steps: 20 | Train Loss: 1.004 Vali Loss: 0.843 Vali Acc: 0.490 Test Loss: 0.843 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8831734657287598
Epoch: 11, Steps: 20 | Train Loss: 1.053 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 2.492121458053589
Epoch: 12, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.979 Vali Acc: 0.470 Test Loss: 0.979 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6207172870635986
Epoch: 13, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.869 Vali Acc: 0.470 Test Loss: 0.869 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8710293769836426
Epoch: 14, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.809 Vali Acc: 0.460 Test Loss: 0.809 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2318928241729736
Epoch: 15, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9934470653533936
Epoch: 16, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9484102725982666
Epoch: 17, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.928 Vali Acc: 0.510 Test Loss: 0.928 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.101271390914917
Epoch: 18, Steps: 20 | Train Loss: 0.917 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.355064630508423
Epoch: 19, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.659261703491211
Epoch: 20, Steps: 20 | Train Loss: 0.802 Vali Loss: 1.351 Vali Acc: 0.430 Test Loss: 1.351 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6546237468719482
Epoch: 21, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2037158
model size : 10.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.760148525238037
Epoch: 1, Steps: 20 | Train Loss: 0.688 Vali Loss: 1.064 Vali Acc: 0.510 Test Loss: 1.064 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 2.405284881591797
Epoch: 2, Steps: 20 | Train Loss: 0.944 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4013631343841553
Epoch: 3, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4335811138153076
Epoch: 4, Steps: 20 | Train Loss: 0.722 Vali Loss: 1.029 Vali Acc: 0.490 Test Loss: 1.029 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4662625789642334
Epoch: 5, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0573954582214355
Epoch: 6, Steps: 20 | Train Loss: 0.872 Vali Loss: 1.179 Vali Acc: 0.490 Test Loss: 1.179 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3515381813049316
Epoch: 7, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
Validation loss decreased (-0.509989 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 2.485527753829956
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4657087326049805
Epoch: 9, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4453909397125244
Epoch: 10, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5494251251220703
Epoch: 11, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.854 Vali Acc: 0.470 Test Loss: 0.854 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.454058885574341
Epoch: 12, Steps: 20 | Train Loss: 0.846 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4886138439178467
Epoch: 13, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.932 Vali Acc: 0.560 Test Loss: 0.932 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.534302234649658
Epoch: 14, Steps: 20 | Train Loss: 0.755 Vali Loss: 1.045 Vali Acc: 0.530 Test Loss: 1.045 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.529677629470825
Epoch: 15, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.935 Vali Acc: 0.510 Test Loss: 0.935 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4614455699920654
Epoch: 16, Steps: 20 | Train Loss: 0.915 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.474914789199829
Epoch: 17, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2036134
model size : 10.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.834789514541626
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.1559367179870605
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4403512477874756
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.791 Vali Acc: 0.460 Test Loss: 0.791 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.435274600982666
Epoch: 4, Steps: 20 | Train Loss: 0.790 Vali Loss: 1.044 Vali Acc: 0.480 Test Loss: 1.044 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.597486972808838
Epoch: 5, Steps: 20 | Train Loss: 0.928 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 3.1272244453430176
Epoch: 6, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0932095050811768
Epoch: 7, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8928394317626953
Epoch: 8, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9935669898986816
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9178662300109863
Epoch: 10, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9057278633117676
Epoch: 11, Steps: 20 | Train Loss: 0.848 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2000534534454346
Epoch: 12, Steps: 20 | Train Loss: 0.880 Vali Loss: 0.874 Vali Acc: 0.540 Test Loss: 0.874 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2527263164520264
Epoch: 13, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3411335945129395
Epoch: 14, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5601704120635986
Epoch: 15, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.864 Vali Acc: 0.530 Test Loss: 0.864 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2035110
model size : 10.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.883785247802734
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.2021689414978027
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.7616612911224365
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.830 Vali Acc: 0.450 Test Loss: 0.830 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0329301357269287
Epoch: 4, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3086912631988525
Epoch: 5, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.943 Vali Acc: 0.490 Test Loss: 0.943 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3261616230010986
Epoch: 6, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.297093152999878
Epoch: 7, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.388172149658203
Epoch: 8, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9644362926483154
Epoch: 9, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3880817890167236
Epoch: 10, Steps: 20 | Train Loss: 0.797 Vali Loss: 1.529 Vali Acc: 0.490 Test Loss: 1.529 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.4250307083129883
Epoch: 11, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 12 cost time: 3.0432164669036865
Epoch: 12, Steps: 20 | Train Loss: 0.763 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.975858211517334
Epoch: 13, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529992).  Saving model ...
Epoch: 14 cost time: 3.106109857559204
Epoch: 14, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6854825019836426
Epoch: 15, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.868 Vali Acc: 0.560 Test Loss: 0.868 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 16 cost time: 3.144014835357666
Epoch: 16, Steps: 20 | Train Loss: 0.687 Vali Loss: 1.206 Vali Acc: 0.470 Test Loss: 1.206 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3176565170288086
Epoch: 17, Steps: 20 | Train Loss: 0.833 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.98476505279541
Epoch: 18, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.155228853225708
Epoch: 19, Steps: 20 | Train Loss: 0.696 Vali Loss: 1.645 Vali Acc: 0.480 Test Loss: 1.645 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2319087982177734
Epoch: 20, Steps: 20 | Train Loss: 1.029 Vali Loss: 1.985 Vali Acc: 0.510 Test Loss: 1.985 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1880455017089844
Epoch: 21, Steps: 20 | Train Loss: 0.843 Vali Loss: 1.252 Vali Acc: 0.550 Test Loss: 1.252 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3718831539154053
Epoch: 22, Steps: 20 | Train Loss: 0.755 Vali Loss: 1.046 Vali Acc: 0.470 Test Loss: 1.046 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.626457691192627
Epoch: 23, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.965 Vali Acc: 0.540 Test Loss: 0.965 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.0647335052490234
Epoch: 24, Steps: 20 | Train Loss: 0.714 Vali Loss: 1.106 Vali Acc: 0.510 Test Loss: 1.106 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.984121084213257
Epoch: 25, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.983 Vali Acc: 0.540 Test Loss: 0.983 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2034086
model size : 10.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.451003074645996
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.5164666175842285
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.879 Vali Acc: 0.400 Test Loss: 0.879 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.963947057723999
Epoch: 3, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.856 Vali Acc: 0.480 Test Loss: 0.856 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1554219722747803
Epoch: 4, Steps: 20 | Train Loss: 0.857 Vali Loss: 1.187 Vali Acc: 0.490 Test Loss: 1.187 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.955095052719116
Epoch: 5, Steps: 20 | Train Loss: 0.809 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 2.2650928497314453
Epoch: 6, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.711517572402954
Epoch: 7, Steps: 20 | Train Loss: 0.893 Vali Loss: 1.128 Vali Acc: 0.480 Test Loss: 1.128 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0140769481658936
Epoch: 8, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 3.156527519226074
Epoch: 9, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1520252227783203
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.996269464492798
Epoch: 11, Steps: 20 | Train Loss: 0.788 Vali Loss: 1.165 Vali Acc: 0.490 Test Loss: 1.165 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1524696350097656
Epoch: 12, Steps: 20 | Train Loss: 0.709 Vali Loss: 1.063 Vali Acc: 0.510 Test Loss: 1.063 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.615783214569092
Epoch: 13, Steps: 20 | Train Loss: 0.926 Vali Loss: 1.031 Vali Acc: 0.510 Test Loss: 1.031 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9545695781707764
Epoch: 14, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7731375694274902
Epoch: 15, Steps: 20 | Train Loss: 0.892 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.014741897583008
Epoch: 16, Steps: 20 | Train Loss: 0.915 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.196089267730713
Epoch: 17, Steps: 20 | Train Loss: 0.899 Vali Loss: 1.102 Vali Acc: 0.540 Test Loss: 1.102 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.021738290786743
Epoch: 18, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1708198
model size : 9.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.687546968460083
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.0991485118865967
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.770298719406128
Epoch: 3, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.890 Vali Acc: 0.490 Test Loss: 0.890 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0797176361083984
Epoch: 4, Steps: 20 | Train Loss: 0.705 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6753029823303223
Epoch: 5, Steps: 20 | Train Loss: 0.863 Vali Loss: 0.962 Vali Acc: 0.490 Test Loss: 0.962 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4117166996002197
Epoch: 6, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6656382083892822
Epoch: 7, Steps: 20 | Train Loss: 0.854 Vali Loss: 0.786 Vali Acc: 0.450 Test Loss: 0.786 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8316047191619873
Epoch: 8, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.834341526031494
Epoch: 9, Steps: 20 | Train Loss: 0.722 Vali Loss: 1.090 Vali Acc: 0.480 Test Loss: 1.090 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3737521171569824
Epoch: 10, Steps: 20 | Train Loss: 0.860 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2833340167999268
Epoch: 11, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 12 cost time: 2.5969913005828857
Epoch: 12, Steps: 20 | Train Loss: 0.746 Vali Loss: 1.575 Vali Acc: 0.490 Test Loss: 1.575 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9296700954437256
Epoch: 13, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2678656578063965
Epoch: 14, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.440593719482422
Epoch: 15, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 16 cost time: 3.295365571975708
Epoch: 16, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.608 Vali Acc: 0.490 Test Loss: 1.608 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9204134941101074
Epoch: 17, Steps: 20 | Train Loss: 0.904 Vali Loss: 1.036 Vali Acc: 0.550 Test Loss: 1.036 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549990).  Saving model ...
Epoch: 18 cost time: 2.761014223098755
Epoch: 18, Steps: 20 | Train Loss: 0.898 Vali Loss: 0.828 Vali Acc: 0.530 Test Loss: 0.828 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6122398376464844
Epoch: 19, Steps: 20 | Train Loss: 0.578 Vali Loss: 1.076 Vali Acc: 0.530 Test Loss: 1.076 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.152282953262329
Epoch: 20, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1841397285461426
Epoch: 21, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559992).  Saving model ...
Epoch: 22 cost time: 3.135867118835449
Epoch: 22, Steps: 20 | Train Loss: 0.558 Vali Loss: 1.455 Vali Acc: 0.510 Test Loss: 1.455 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.170488119125366
Epoch: 23, Steps: 20 | Train Loss: 0.755 Vali Loss: 1.048 Vali Acc: 0.550 Test Loss: 1.048 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2660622596740723
Epoch: 24, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2781269550323486
Epoch: 25, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.099 Vali Acc: 0.520 Test Loss: 1.099 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.843632221221924
Epoch: 26, Steps: 20 | Train Loss: 0.630 Vali Loss: 1.128 Vali Acc: 0.520 Test Loss: 1.128 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.098341226577759
Epoch: 27, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.023 Vali Acc: 0.520 Test Loss: 1.023 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1891915798187256
Epoch: 28, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.067 Vali Acc: 0.470 Test Loss: 1.067 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.211740732192993
Epoch: 29, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.241 Vali Acc: 0.560 Test Loss: 1.241 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.9684407711029053
Epoch: 30, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.994 Vali Acc: 0.560 Test Loss: 0.994 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.2168452739715576
Epoch: 31, Steps: 20 | Train Loss: 0.569 Vali Loss: 1.149 Vali Acc: 0.540 Test Loss: 1.149 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1707174
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.356674671173096
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.0994136333465576
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.940073251724243
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.795799493789673
Epoch: 4, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.289541244506836
Epoch: 5, Steps: 20 | Train Loss: 0.824 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.288785934448242
Epoch: 6, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3541924953460693
Epoch: 7, Steps: 20 | Train Loss: 0.797 Vali Loss: 1.046 Vali Acc: 0.540 Test Loss: 1.046 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3705461025238037
Epoch: 8, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2172582149505615
Epoch: 9, Steps: 20 | Train Loss: 0.808 Vali Loss: 1.069 Vali Acc: 0.540 Test Loss: 1.069 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.506446599960327
Epoch: 10, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6162476539611816
Epoch: 11, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9723241329193115
Epoch: 12, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.067990779876709
Epoch: 13, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.000 Vali Acc: 0.520 Test Loss: 1.000 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1706150
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.269115686416626
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.4867322444915771
Epoch: 2, Steps: 20 | Train Loss: 0.775 Vali Loss: 1.298 Vali Acc: 0.510 Test Loss: 1.298 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509987).  Saving model ...
Epoch: 3 cost time: 1.9073495864868164
Epoch: 3, Steps: 20 | Train Loss: 1.037 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.959517240524292
Epoch: 4, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1493160724639893
Epoch: 5, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.509987 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.7560982704162598
Epoch: 6, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.885 Vali Acc: 0.480 Test Loss: 0.885 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2829790115356445
Epoch: 7, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.870 Vali Acc: 0.520 Test Loss: 0.870 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.258052349090576
Epoch: 8, Steps: 20 | Train Loss: 0.915 Vali Loss: 1.141 Vali Acc: 0.470 Test Loss: 1.141 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2998173236846924
Epoch: 9, Steps: 20 | Train Loss: 1.006 Vali Loss: 1.186 Vali Acc: 0.480 Test Loss: 1.186 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.111475706100464
Epoch: 10, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 3.2384955883026123
Epoch: 11, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0783514976501465
Epoch: 12, Steps: 20 | Train Loss: 1.079 Vali Loss: 1.183 Vali Acc: 0.510 Test Loss: 1.183 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3309531211853027
Epoch: 13, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5192110538482666
Epoch: 14, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.886 Vali Acc: 0.550 Test Loss: 0.886 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.616007089614868
Epoch: 15, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.283694267272949
Epoch: 16, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.299271821975708
Epoch: 17, Steps: 20 | Train Loss: 0.754 Vali Loss: 1.349 Vali Acc: 0.490 Test Loss: 1.349 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.5400161743164062
Epoch: 18, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.529510736465454
Epoch: 19, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.389188528060913
Epoch: 20, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.815 Vali Acc: 0.540 Test Loss: 0.815 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1705126
model size : 9.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.213613510131836
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.162062406539917
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 3.1830668449401855
Epoch: 3, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.725 Vali Acc: 0.570 Test Loss: 0.725 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.1669087409973145
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1240644454956055
Epoch: 5, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.731 Vali Acc: 0.570 Test Loss: 0.731 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1262409687042236
Epoch: 6, Steps: 20 | Train Loss: 0.742 Vali Loss: 1.207 Vali Acc: 0.490 Test Loss: 1.207 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3730788230895996
Epoch: 7, Steps: 20 | Train Loss: 0.794 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7885191440582275
Epoch: 8, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.762 Vali Acc: 0.610 Test Loss: 0.762 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 9 cost time: 3.046476125717163
Epoch: 9, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.922 Vali Acc: 0.520 Test Loss: 0.922 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1107523441314697
Epoch: 10, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.927722930908203
Epoch: 11, Steps: 20 | Train Loss: 0.734 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9631569385528564
Epoch: 12, Steps: 20 | Train Loss: 0.826 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1033716201782227
Epoch: 13, Steps: 20 | Train Loss: 0.854 Vali Loss: 1.225 Vali Acc: 0.510 Test Loss: 1.225 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.158721685409546
Epoch: 14, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.827 Vali Acc: 0.520 Test Loss: 0.827 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6519463062286377
Epoch: 15, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.072378396987915
Epoch: 16, Steps: 20 | Train Loss: 0.795 Vali Loss: 1.646 Vali Acc: 0.490 Test Loss: 1.646 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9144275188446045
Epoch: 17, Steps: 20 | Train Loss: 0.856 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8585798740386963
Epoch: 18, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.869 Vali Acc: 0.560 Test Loss: 0.869 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1543718
model size : 8.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.583890438079834
Epoch: 1, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.05423903465271
Epoch: 2, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.721 Vali Acc: 0.430 Test Loss: 0.721 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1783268451690674
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.848 Vali Acc: 0.470 Test Loss: 0.848 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9451982975006104
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.902 Vali Acc: 0.490 Test Loss: 0.902 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7578353881835938
Epoch: 5, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.252610683441162
Epoch: 6, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.982 Vali Acc: 0.510 Test Loss: 0.982 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.765559673309326
Epoch: 7, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0714402198791504
Epoch: 8, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.280 Vali Acc: 0.490 Test Loss: 1.280 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.111807107925415
Epoch: 9, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.937744140625
Epoch: 10, Steps: 20 | Train Loss: 0.949 Vali Loss: 1.434 Vali Acc: 0.510 Test Loss: 1.434 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.888218641281128
Epoch: 11, Steps: 20 | Train Loss: 0.890 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 3.070282220840454
Epoch: 12, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8985562324523926
Epoch: 13, Steps: 20 | Train Loss: 0.731 Vali Loss: 1.098 Vali Acc: 0.510 Test Loss: 1.098 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4683923721313477
Epoch: 14, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6260461807250977
Epoch: 15, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 2.916367769241333
Epoch: 16, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9883575439453125
Epoch: 17, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.568 Vali Acc: 0.510 Test Loss: 1.568 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.045712947845459
Epoch: 18, Steps: 20 | Train Loss: 1.095 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.046875238418579
Epoch: 19, Steps: 20 | Train Loss: 0.696 Vali Loss: 1.508 Vali Acc: 0.470 Test Loss: 1.508 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.180462598800659
Epoch: 20, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6173012256622314
Epoch: 21, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.807 Vali Acc: 0.570 Test Loss: 0.807 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.254230499267578
Epoch: 22, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7321906089782715
Epoch: 23, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.895 Vali Acc: 0.590 Test Loss: 0.895 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 24 cost time: 3.0569136142730713
Epoch: 24, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.882081985473633
Epoch: 25, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.269583225250244
Epoch: 26, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.912 Vali Acc: 0.560 Test Loss: 0.912 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.209054946899414
Epoch: 27, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.972 Vali Acc: 0.490 Test Loss: 0.972 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9400362968444824
Epoch: 28, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.197 Vali Acc: 0.510 Test Loss: 1.197 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.673755168914795
Epoch: 29, Steps: 20 | Train Loss: 1.252 Vali Loss: 1.584 Vali Acc: 0.540 Test Loss: 1.584 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.727964401245117
Epoch: 30, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.128 Vali Acc: 0.570 Test Loss: 1.128 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.8988847732543945
Epoch: 31, Steps: 20 | Train Loss: 0.650 Vali Loss: 1.899 Vali Acc: 0.520 Test Loss: 1.899 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.0054092407226562
Epoch: 32, Steps: 20 | Train Loss: 0.956 Vali Loss: 1.383 Vali Acc: 0.570 Test Loss: 1.383 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.4870049953460693
Epoch: 33, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.418 Vali Acc: 0.540 Test Loss: 1.418 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1542694
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.447967529296875
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.8299553394317627
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.685912609100342
Epoch: 3, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.883 Vali Acc: 0.490 Test Loss: 0.883 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8760087490081787
Epoch: 4, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.080576181411743
Epoch: 5, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.772 Vali Acc: 0.600 Test Loss: 0.772 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.6935505867004395
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.806 Vali Acc: 0.470 Test Loss: 0.806 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0023398399353027
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.046846389770508
Epoch: 8, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.753 Vali Acc: 0.450 Test Loss: 0.753 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9303040504455566
Epoch: 9, Steps: 20 | Train Loss: 0.896 Vali Loss: 1.237 Vali Acc: 0.490 Test Loss: 1.237 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2842249870300293
Epoch: 10, Steps: 20 | Train Loss: 0.871 Vali Loss: 1.485 Vali Acc: 0.510 Test Loss: 1.485 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5119733810424805
Epoch: 11, Steps: 20 | Train Loss: 1.133 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9285919666290283
Epoch: 12, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.855 Vali Acc: 0.480 Test Loss: 0.855 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.897189140319824
Epoch: 13, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.98337984085083
Epoch: 14, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.023185968399048
Epoch: 15, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.949 Vali Acc: 0.560 Test Loss: 0.949 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1541670
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.753648519515991
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 2.8874857425689697
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.763 Vali Acc: 0.460 Test Loss: 0.763 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9623498916625977
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.5654144287109375
Epoch: 4, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.255136489868164
Epoch: 5, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.863751173019409
Epoch: 6, Steps: 20 | Train Loss: 0.714 Vali Loss: 1.250 Vali Acc: 0.490 Test Loss: 1.250 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.916719913482666
Epoch: 7, Steps: 20 | Train Loss: 0.777 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1246612071990967
Epoch: 8, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.066 Vali Acc: 0.520 Test Loss: 1.066 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519989).  Saving model ...
Epoch: 9 cost time: 2.8761556148529053
Epoch: 9, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.950 Vali Acc: 0.480 Test Loss: 0.950 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.04837703704834
Epoch: 10, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.838 Vali Acc: 0.560 Test Loss: 0.838 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 2.9679834842681885
Epoch: 11, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.915539026260376
Epoch: 12, Steps: 20 | Train Loss: 0.856 Vali Loss: 1.062 Vali Acc: 0.500 Test Loss: 1.062 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.954636812210083
Epoch: 13, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 2.953118324279785
Epoch: 14, Steps: 20 | Train Loss: 0.773 Vali Loss: 1.056 Vali Acc: 0.430 Test Loss: 1.056 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9340944290161133
Epoch: 15, Steps: 20 | Train Loss: 0.713 Vali Loss: 1.333 Vali Acc: 0.490 Test Loss: 1.333 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.261192798614502
Epoch: 16, Steps: 20 | Train Loss: 0.938 Vali Loss: 1.158 Vali Acc: 0.510 Test Loss: 1.158 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7572648525238037
Epoch: 17, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.736 Vali Acc: 0.620 Test Loss: 0.736 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619993).  Saving model ...
Epoch: 18 cost time: 2.5188231468200684
Epoch: 18, Steps: 20 | Train Loss: 0.718 Vali Loss: 1.401 Vali Acc: 0.490 Test Loss: 1.401 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.967165231704712
Epoch: 19, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.906 Vali Acc: 0.570 Test Loss: 0.906 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.699057102203369
Epoch: 20, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.776 Vali Acc: 0.570 Test Loss: 0.776 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.730457067489624
Epoch: 21, Steps: 20 | Train Loss: 0.625 Vali Loss: 1.209 Vali Acc: 0.540 Test Loss: 1.209 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2267534732818604
Epoch: 22, Steps: 20 | Train Loss: 0.885 Vali Loss: 0.881 Vali Acc: 0.540 Test Loss: 0.881 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.011434555053711
Epoch: 23, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.878 Vali Acc: 0.570 Test Loss: 0.878 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.979750394821167
Epoch: 24, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.087 Vali Acc: 0.550 Test Loss: 1.087 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.3101649284362793
Epoch: 25, Steps: 20 | Train Loss: 0.791 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.988804578781128
Epoch: 26, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.115 Vali Acc: 0.550 Test Loss: 1.115 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.696767568588257
Epoch: 27, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.132 Vali Acc: 0.520 Test Loss: 1.132 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1540646
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.056349277496338
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8435771465301514
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.698 Vali Acc: 0.530 Test Loss: 0.698 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.485260248184204
Epoch: 3, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3867318630218506
Epoch: 4, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.695 Vali Acc: 0.560 Test Loss: 0.695 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.4842395782470703
Epoch: 5, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.474071979522705
Epoch: 6, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3536431789398193
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.869 Vali Acc: 0.490 Test Loss: 0.869 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4056594371795654
Epoch: 8, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9783213138580322
Epoch: 9, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3373007774353027
Epoch: 10, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.479708194732666
Epoch: 11, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.698 Vali Acc: 0.570 Test Loss: 0.698 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 2.2046055793762207
Epoch: 12, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.454119920730591
Epoch: 13, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.418853521347046
Epoch: 14, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.714 Vali Acc: 0.610 Test Loss: 0.714 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 15 cost time: 2.502969741821289
Epoch: 15, Steps: 20 | Train Loss: 0.712 Vali Loss: 1.160 Vali Acc: 0.480 Test Loss: 1.160 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9113330841064453
Epoch: 16, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.056 Vali Acc: 0.490 Test Loss: 1.056 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7509748935699463
Epoch: 17, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.703 Vali Acc: 0.610 Test Loss: 0.703 Test Acc: 0.610
Validation loss decreased (-0.609993 --> -0.609993).  Saving model ...
Epoch: 18 cost time: 2.6054341793060303
Epoch: 18, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.131967782974243
Epoch: 19, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.904 Vali Acc: 0.460 Test Loss: 0.904 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.306882858276367
Epoch: 20, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.368373394012451
Epoch: 21, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.870 Vali Acc: 0.550 Test Loss: 0.870 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2456092834472656
Epoch: 22, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.831 Vali Acc: 0.580 Test Loss: 0.831 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9985408782958984
Epoch: 23, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.912 Vali Acc: 0.520 Test Loss: 0.912 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.75299072265625
Epoch: 24, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.158672571182251
Epoch: 25, Steps: 20 | Train Loss: 0.594 Vali Loss: 1.067 Vali Acc: 0.510 Test Loss: 1.067 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.101912498474121
Epoch: 26, Steps: 20 | Train Loss: 0.640 Vali Loss: 1.057 Vali Acc: 0.510 Test Loss: 1.057 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.994096279144287
Epoch: 27, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.986 Vali Acc: 0.550 Test Loss: 0.986 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1022438
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6634576320648193
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.837 Vali Acc: 0.490 Test Loss: 0.837 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.9048728942871094
Epoch: 2, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9553179740905762
Epoch: 3, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9440369606018066
Epoch: 4, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.943296194076538
Epoch: 5, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.766 Vali Acc: 0.460 Test Loss: 0.766 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9700207710266113
Epoch: 6, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.821 Vali Acc: 0.480 Test Loss: 0.821 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.635406732559204
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0938313007354736
Epoch: 8, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 1.9968552589416504
Epoch: 9, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 2.0439186096191406
Epoch: 10, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.849 Vali Acc: 0.470 Test Loss: 0.849 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8095173835754395
Epoch: 11, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 2.0730748176574707
Epoch: 12, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.925480604171753
Epoch: 13, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.671276569366455
Epoch: 14, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.980236291885376
Epoch: 15, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.017568826675415
Epoch: 16, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.909 Vali Acc: 0.430 Test Loss: 0.909 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9825427532196045
Epoch: 17, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.878 Vali Acc: 0.450 Test Loss: 0.878 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.94386887550354
Epoch: 18, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.832 Vali Acc: 0.480 Test Loss: 0.832 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9962406158447266
Epoch: 19, Steps: 20 | Train Loss: 0.621 Vali Loss: 1.260 Vali Acc: 0.520 Test Loss: 1.260 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7643153667449951
Epoch: 20, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1066386699676514
Epoch: 21, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.008 Vali Acc: 0.520 Test Loss: 1.008 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1021926
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.141500234603882
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.0183839797973633
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.070887327194214
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.059208393096924
Epoch: 4, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.080658435821533
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.881 Vali Acc: 0.460 Test Loss: 0.881 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1508560180664062
Epoch: 6, Steps: 20 | Train Loss: 0.738 Vali Loss: 1.023 Vali Acc: 0.490 Test Loss: 1.023 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.160045862197876
Epoch: 7, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 2.221900701522827
Epoch: 8, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5513007640838623
Epoch: 9, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9358599185943604
Epoch: 10, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.413731575012207
Epoch: 11, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.825 Vali Acc: 0.490 Test Loss: 0.825 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.28936767578125
Epoch: 12, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 13 cost time: 2.070627212524414
Epoch: 13, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.782 Vali Acc: 0.550 Test Loss: 0.782 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 14 cost time: 2.2032735347747803
Epoch: 14, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 2.252803087234497
Epoch: 15, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.981 Vali Acc: 0.520 Test Loss: 0.981 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2685859203338623
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.108 Vali Acc: 0.510 Test Loss: 1.108 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3708274364471436
Epoch: 17, Steps: 20 | Train Loss: 0.665 Vali Loss: 1.086 Vali Acc: 0.530 Test Loss: 1.086 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.170114755630493
Epoch: 18, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8846726417541504
Epoch: 19, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 20 cost time: 2.252214193344116
Epoch: 20, Steps: 20 | Train Loss: 0.681 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.32900071144104
Epoch: 21, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 22 cost time: 2.358271837234497
Epoch: 22, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.923 Vali Acc: 0.560 Test Loss: 0.923 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.407205581665039
Epoch: 23, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.028 Vali Acc: 0.490 Test Loss: 1.028 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8882317543029785
Epoch: 24, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1176750659942627
Epoch: 25, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.083 Vali Acc: 0.530 Test Loss: 1.083 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.437458038330078
Epoch: 26, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.849 Vali Acc: 0.540 Test Loss: 0.849 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8994696140289307
Epoch: 27, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.927 Vali Acc: 0.540 Test Loss: 0.927 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.28808331489563
Epoch: 28, Steps: 20 | Train Loss: 0.601 Vali Loss: 1.019 Vali Acc: 0.570 Test Loss: 1.019 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569990).  Saving model ...
Epoch: 29 cost time: 2.2231948375701904
Epoch: 29, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.060 Vali Acc: 0.550 Test Loss: 1.060 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.258275270462036
Epoch: 30, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.145 Vali Acc: 0.540 Test Loss: 1.145 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1961395740509033
Epoch: 31, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.050 Vali Acc: 0.580 Test Loss: 1.050 Test Acc: 0.580
Validation loss decreased (-0.569990 --> -0.579989).  Saving model ...
Epoch: 32 cost time: 2.01133131980896
Epoch: 32, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.970 Vali Acc: 0.580 Test Loss: 0.970 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579990).  Saving model ...
Epoch: 33 cost time: 2.3792905807495117
Epoch: 33, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.163 Vali Acc: 0.560 Test Loss: 1.163 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.552675247192383
Epoch: 34, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.568 Vali Acc: 0.490 Test Loss: 1.568 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8080687522888184
Epoch: 35, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.404 Vali Acc: 0.550 Test Loss: 1.404 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6843361854553223
Epoch: 36, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.5527656078338623
Epoch: 37, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.571 Vali Acc: 0.550 Test Loss: 1.571 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8110337257385254
Epoch: 38, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.459 Vali Acc: 0.510 Test Loss: 1.459 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.58613920211792
Epoch: 39, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.686983346939087
Epoch: 40, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.644 Vali Acc: 0.490 Test Loss: 1.644 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6695396900177002
Epoch: 41, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.665 Vali Acc: 0.470 Test Loss: 1.665 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.7015814781188965
Epoch: 42, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.798 Vali Acc: 0.570 Test Loss: 1.798 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1021414
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9216785430908203
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.683396816253662
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.547891616821289
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.858 Vali Acc: 0.480 Test Loss: 0.858 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6562836170196533
Epoch: 4, Steps: 20 | Train Loss: 0.836 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.872452735900879
Epoch: 5, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.443270444869995
Epoch: 6, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 2.4998939037323
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.859 Vali Acc: 0.480 Test Loss: 0.859 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.448632001876831
Epoch: 8, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 2.402190685272217
Epoch: 9, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.956 Vali Acc: 0.510 Test Loss: 0.956 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.240934371948242
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.789 Vali Acc: 0.460 Test Loss: 0.789 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2555270195007324
Epoch: 11, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.178154945373535
Epoch: 12, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4487226009368896
Epoch: 13, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.236051082611084
Epoch: 14, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.391725778579712
Epoch: 15, Steps: 20 | Train Loss: 0.747 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.32623553276062
Epoch: 16, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3397836685180664
Epoch: 17, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4713332653045654
Epoch: 18, Steps: 20 | Train Loss: 0.653 Vali Loss: 1.021 Vali Acc: 0.510 Test Loss: 1.021 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1020902
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8677055835723877
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.734 Vali Acc: 0.420 Test Loss: 0.734 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 2.3139090538024902
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
Validation loss decreased (-0.419993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.3771657943725586
Epoch: 3, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
Validation loss decreased (-0.459993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.515002489089966
Epoch: 4, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.784257411956787
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4199466705322266
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4058005809783936
Epoch: 7, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4311139583587646
Epoch: 8, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5542056560516357
Epoch: 9, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.783 Vali Acc: 0.470 Test Loss: 0.783 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4561307430267334
Epoch: 10, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5396549701690674
Epoch: 11, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.971 Vali Acc: 0.520 Test Loss: 0.971 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.567765951156616
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.684 Vali Acc: 0.560 Test Loss: 0.684 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 2.363696813583374
Epoch: 13, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1744799613952637
Epoch: 14, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.817 Vali Acc: 0.530 Test Loss: 0.817 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.23119854927063
Epoch: 15, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3258049488067627
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2997336387634277
Epoch: 17, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.318629741668701
Epoch: 18, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0741255283355713
Epoch: 19, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.031 Vali Acc: 0.490 Test Loss: 1.031 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3548905849456787
Epoch: 20, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4254257678985596
Epoch: 21, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.913 Vali Acc: 0.510 Test Loss: 0.913 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7779583930969238
Epoch: 22, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 692198
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.542863607406616
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8635306358337402
Epoch: 2, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.734 Vali Acc: 0.440 Test Loss: 0.734 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6158292293548584
Epoch: 3, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 2.089235544204712
Epoch: 4, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2107913494110107
Epoch: 5, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.386791706085205
Epoch: 6, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3399767875671387
Epoch: 7, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.804 Vali Acc: 0.500 Test Loss: 0.804 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9752893447875977
Epoch: 8, Steps: 20 | Train Loss: 0.727 Vali Loss: 1.045 Vali Acc: 0.500 Test Loss: 1.045 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.345409631729126
Epoch: 9, Steps: 20 | Train Loss: 0.839 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4054715633392334
Epoch: 10, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0200366973876953
Epoch: 11, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 2.226621627807617
Epoch: 12, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2907886505126953
Epoch: 13, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 2.250887632369995
Epoch: 14, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.743 Vali Acc: 0.580 Test Loss: 0.743 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 15 cost time: 2.30774188041687
Epoch: 15, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.011080265045166
Epoch: 16, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3962883949279785
Epoch: 17, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2936792373657227
Epoch: 18, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.051736831665039
Epoch: 19, Steps: 20 | Train Loss: 0.833 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2884206771850586
Epoch: 20, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.23815655708313
Epoch: 21, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.237849473953247
Epoch: 22, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.868 Vali Acc: 0.490 Test Loss: 0.868 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2028470039367676
Epoch: 23, Steps: 20 | Train Loss: 0.554 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6427083015441895
Epoch: 24, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 691686
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8590972423553467
Epoch: 1, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.12410306930542
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8799595832824707
Epoch: 3, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1585311889648438
Epoch: 4, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.794 Vali Acc: 0.450 Test Loss: 0.794 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3255090713500977
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 2.2083284854888916
Epoch: 6, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1554157733917236
Epoch: 7, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.709 Vali Acc: 0.460 Test Loss: 0.709 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.320148229598999
Epoch: 8, Steps: 20 | Train Loss: 0.869 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 2.169721841812134
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.304725170135498
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2692792415618896
Epoch: 11, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 2.0322532653808594
Epoch: 12, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 13 cost time: 1.9783251285552979
Epoch: 13, Steps: 20 | Train Loss: 0.610 Vali Loss: 1.062 Vali Acc: 0.490 Test Loss: 1.062 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0883266925811768
Epoch: 14, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.798 Vali Acc: 0.460 Test Loss: 0.798 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.166200637817383
Epoch: 15, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.789 Vali Acc: 0.480 Test Loss: 0.789 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.088505983352661
Epoch: 16, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 17 cost time: 2.3549253940582275
Epoch: 17, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.893 Vali Acc: 0.530 Test Loss: 0.893 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.367583990097046
Epoch: 18, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4040329456329346
Epoch: 19, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7827672958374023
Epoch: 20, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3701162338256836
Epoch: 21, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.975 Vali Acc: 0.510 Test Loss: 0.975 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3338420391082764
Epoch: 22, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.903 Vali Acc: 0.590 Test Loss: 0.903 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.295239210128784
Epoch: 23, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2490251064300537
Epoch: 24, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.919 Vali Acc: 0.470 Test Loss: 0.919 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.208134651184082
Epoch: 25, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7434697151184082
Epoch: 26, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.873 Vali Acc: 0.530 Test Loss: 0.873 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 691174
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7886664867401123
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.198728322982788
Epoch: 2, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.9767532348632812
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.2832701206207275
Epoch: 4, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.864 Vali Acc: 0.470 Test Loss: 0.864 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2279818058013916
Epoch: 5, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.8018839359283447
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.3221898078918457
Epoch: 7, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.373195171356201
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.928 Vali Acc: 0.480 Test Loss: 0.928 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.268498659133911
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.952 Vali Acc: 0.500 Test Loss: 0.952 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3437721729278564
Epoch: 10, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.916 Vali Acc: 0.470 Test Loss: 0.916 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4151973724365234
Epoch: 11, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.847 Vali Acc: 0.440 Test Loss: 0.847 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2398805618286133
Epoch: 12, Steps: 20 | Train Loss: 0.824 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9566025733947754
Epoch: 13, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2740530967712402
Epoch: 14, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 2.2798709869384766
Epoch: 15, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.295610189437866
Epoch: 16, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.902 Vali Acc: 0.460 Test Loss: 0.902 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.143099784851074
Epoch: 17, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.104071617126465
Epoch: 18, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.869 Vali Acc: 0.430 Test Loss: 0.869 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.360266923904419
Epoch: 19, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4368374347686768
Epoch: 20, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.855 Vali Acc: 0.580 Test Loss: 0.855 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 21 cost time: 1.8273568153381348
Epoch: 21, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2589902877807617
Epoch: 22, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2688496112823486
Epoch: 23, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
Validation loss decreased (-0.579991 --> -0.579992).  Saving model ...
Epoch: 24 cost time: 2.3504440784454346
Epoch: 24, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.276132822036743
Epoch: 25, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.277104377746582
Epoch: 26, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.967 Vali Acc: 0.480 Test Loss: 0.967 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.189112663269043
Epoch: 27, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.940 Vali Acc: 0.560 Test Loss: 0.940 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.264629364013672
Epoch: 28, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.041 Vali Acc: 0.510 Test Loss: 1.041 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0403494834899902
Epoch: 29, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.348 Vali Acc: 0.530 Test Loss: 1.348 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.437199115753174
Epoch: 30, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.010685682296753
Epoch: 31, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.981 Vali Acc: 0.560 Test Loss: 0.981 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.438460350036621
Epoch: 32, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.015 Vali Acc: 0.530 Test Loss: 1.015 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.4949495792388916
Epoch: 33, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 690662
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7452034950256348
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.4837095737457275
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3302717208862305
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.4333252906799316
Epoch: 4, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0068163871765137
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.692 Vali Acc: 0.550 Test Loss: 0.692 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.1421713829040527
Epoch: 6, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.866 Vali Acc: 0.460 Test Loss: 0.866 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.265096664428711
Epoch: 7, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.340916872024536
Epoch: 8, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.366330623626709
Epoch: 9, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2824742794036865
Epoch: 10, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.686 Vali Acc: 0.570 Test Loss: 0.686 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 2.400730609893799
Epoch: 11, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5612897872924805
Epoch: 12, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.239295482635498
Epoch: 13, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0016379356384277
Epoch: 14, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.369410276412964
Epoch: 15, Steps: 20 | Train Loss: 0.674 Vali Loss: 1.091 Vali Acc: 0.490 Test Loss: 1.091 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4913992881774902
Epoch: 16, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.004 Vali Acc: 0.460 Test Loss: 1.004 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.463590383529663
Epoch: 17, Steps: 20 | Train Loss: 0.658 Vali Loss: 1.065 Vali Acc: 0.450 Test Loss: 1.065 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3676722049713135
Epoch: 18, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.343088388442993
Epoch: 19, Steps: 20 | Train Loss: 0.621 Vali Loss: 1.035 Vali Acc: 0.510 Test Loss: 1.035 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.522355079650879
Epoch: 20, Steps: 20 | Train Loss: 0.621 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 527078
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.1644837856292725
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.254058837890625
Epoch: 2, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 2.2343990802764893
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 2.8685503005981445
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.440004348754883
Epoch: 5, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.706 Vali Acc: 0.550 Test Loss: 0.706 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.471860885620117
Epoch: 6, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.773 Vali Acc: 0.450 Test Loss: 0.773 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.533557176589966
Epoch: 7, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.319692611694336
Epoch: 8, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2068843841552734
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4257614612579346
Epoch: 10, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.422093391418457
Epoch: 11, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7564969062805176
Epoch: 12, Steps: 20 | Train Loss: 0.838 Vali Loss: 1.462 Vali Acc: 0.490 Test Loss: 1.462 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2513911724090576
Epoch: 13, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.136397361755371
Epoch: 14, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3518993854522705
Epoch: 15, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.893 Vali Acc: 0.460 Test Loss: 0.893 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 526566
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5189871788024902
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.244318723678589
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.721 Vali Acc: 0.460 Test Loss: 0.721 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.161731243133545
Epoch: 3, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 2.099278211593628
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 2.007647752761841
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.2838857173919678
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.806 Vali Acc: 0.440 Test Loss: 0.806 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.005951404571533
Epoch: 7, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8021059036254883
Epoch: 8, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3422446250915527
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.353874444961548
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.889 Vali Acc: 0.480 Test Loss: 0.889 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.41361665725708
Epoch: 11, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.847 Vali Acc: 0.460 Test Loss: 0.847 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.373969554901123
Epoch: 12, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.014 Vali Acc: 0.510 Test Loss: 1.014 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.437126636505127
Epoch: 13, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3791134357452393
Epoch: 14, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 15 cost time: 1.8545904159545898
Epoch: 15, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2457048892974854
Epoch: 16, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1874802112579346
Epoch: 17, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.283932685852051
Epoch: 18, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 19 cost time: 2.241447925567627
Epoch: 19, Steps: 20 | Train Loss: 0.746 Vali Loss: 1.234 Vali Acc: 0.490 Test Loss: 1.234 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2969350814819336
Epoch: 20, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.932 Vali Acc: 0.530 Test Loss: 0.932 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8958261013031006
Epoch: 21, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.748 Vali Acc: 0.560 Test Loss: 0.748 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559993).  Saving model ...
Epoch: 22 cost time: 2.2971572875976562
Epoch: 22, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.901 Vali Acc: 0.540 Test Loss: 0.901 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3265790939331055
Epoch: 23, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.032 Vali Acc: 0.510 Test Loss: 1.032 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.092740535736084
Epoch: 24, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 25 cost time: 2.1223790645599365
Epoch: 25, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.806 Vali Acc: 0.610 Test Loss: 0.806 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 26 cost time: 2.24265456199646
Epoch: 26, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.827 Vali Acc: 0.570 Test Loss: 0.827 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1991641521453857
Epoch: 27, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.859 Vali Acc: 0.580 Test Loss: 0.859 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1719977855682373
Epoch: 28, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.948 Vali Acc: 0.530 Test Loss: 0.948 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8736891746520996
Epoch: 29, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.922 Vali Acc: 0.530 Test Loss: 0.922 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3922278881073
Epoch: 30, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.011 Vali Acc: 0.460 Test Loss: 1.011 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.3729896545410156
Epoch: 31, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.937 Vali Acc: 0.560 Test Loss: 0.937 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.390380859375
Epoch: 32, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.216 Vali Acc: 0.530 Test Loss: 1.216 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.3081605434417725
Epoch: 33, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.092 Vali Acc: 0.550 Test Loss: 1.092 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.102417469024658
Epoch: 34, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.954 Vali Acc: 0.540 Test Loss: 0.954 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9766032695770264
Epoch: 35, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.289 Vali Acc: 0.530 Test Loss: 1.289 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 526054
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.553518056869507
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.1455109119415283
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.244352102279663
Epoch: 3, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.232710599899292
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9027273654937744
Epoch: 5, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.429793119430542
Epoch: 6, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 2.3104074001312256
Epoch: 7, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1507906913757324
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.114849328994751
Epoch: 9, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 2.1298534870147705
Epoch: 10, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.287675142288208
Epoch: 11, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3234803676605225
Epoch: 12, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.810 Vali Acc: 0.510 Test Loss: 0.810 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4025161266326904
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6211001873016357
Epoch: 14, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.492666244506836
Epoch: 15, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.536111831665039
Epoch: 16, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2577216625213623
Epoch: 17, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7472145557403564
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.173 Vali Acc: 0.490 Test Loss: 1.173 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5967607498168945
Epoch: 19, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.987 Vali Acc: 0.500 Test Loss: 0.987 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 525542
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.033820629119873
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3518776893615723
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.697 Vali Acc: 0.460 Test Loss: 0.697 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1053194999694824
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2169129848480225
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0543899536132812
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 2.179349899291992
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 2.1291775703430176
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9615294933319092
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 2.1683924198150635
Epoch: 9, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.104682207107544
Epoch: 10, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7852191925048828
Epoch: 11, Steps: 20 | Train Loss: 0.752 Vali Loss: 1.086 Vali Acc: 0.490 Test Loss: 1.086 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1222288608551025
Epoch: 12, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 2.1290361881256104
Epoch: 13, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.023578643798828
Epoch: 14, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.142333984375
Epoch: 15, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 16 cost time: 2.1102077960968018
Epoch: 16, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2926528453826904
Epoch: 17, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.841672658920288
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.069 Vali Acc: 0.530 Test Loss: 1.069 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2065093517303467
Epoch: 19, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.839 Vali Acc: 0.560 Test Loss: 0.839 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0998752117156982
Epoch: 20, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.207601308822632
Epoch: 21, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.24018931388855
Epoch: 22, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 23 cost time: 2.2384555339813232
Epoch: 23, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.778 Vali Acc: 0.590 Test Loss: 0.778 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 24 cost time: 2.3259665966033936
Epoch: 24, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.875 Vali Acc: 0.560 Test Loss: 0.875 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9878184795379639
Epoch: 25, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3842129707336426
Epoch: 26, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.427700996398926
Epoch: 27, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.836688756942749
Epoch: 28, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.931 Vali Acc: 0.550 Test Loss: 0.931 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.284646987915039
Epoch: 29, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.1426961421966553
Epoch: 30, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.450812339782715
Epoch: 31, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.863 Vali Acc: 0.540 Test Loss: 0.863 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9507710933685303
Epoch: 32, Steps: 20 | Train Loss: 0.532 Vali Loss: 1.139 Vali Acc: 0.520 Test Loss: 1.139 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0632331371307373
Epoch: 33, Steps: 20 | Train Loss: 0.538 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 444518
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.551888942718506
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.9585227966308594
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.1351423263549805
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3212850093841553
Epoch: 4, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7093801498413086
Epoch: 5, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.831 Vali Acc: 0.480 Test Loss: 0.831 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.264097213745117
Epoch: 6, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9055447578430176
Epoch: 7, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 2.2427499294281006
Epoch: 8, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3717663288116455
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 2.3355650901794434
Epoch: 10, Steps: 20 | Train Loss: 0.846 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.431375503540039
Epoch: 11, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.345595121383667
Epoch: 12, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4660072326660156
Epoch: 13, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 2.2500574588775635
Epoch: 14, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.300821304321289
Epoch: 15, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 16 cost time: 1.978914499282837
Epoch: 16, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4740142822265625
Epoch: 17, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.359 Vali Acc: 0.470 Test Loss: 1.359 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.427297353744507
Epoch: 18, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.959615707397461
Epoch: 19, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.924147367477417
Epoch: 20, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4917809963226318
Epoch: 21, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.064699172973633
Epoch: 22, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.912 Vali Acc: 0.450 Test Loss: 0.912 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.725731372833252
Epoch: 23, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.681 Vali Acc: 0.600 Test Loss: 0.681 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 24 cost time: 1.8274567127227783
Epoch: 24, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8376009464263916
Epoch: 25, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8204078674316406
Epoch: 26, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.746 Vali Acc: 0.600 Test Loss: 0.746 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8356099128723145
Epoch: 27, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.959 Vali Acc: 0.490 Test Loss: 0.959 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7772741317749023
Epoch: 28, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.848 Vali Acc: 0.510 Test Loss: 0.848 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9315099716186523
Epoch: 29, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.295546293258667
Epoch: 30, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.981 Vali Acc: 0.570 Test Loss: 0.981 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9432451725006104
Epoch: 31, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.968 Vali Acc: 0.570 Test Loss: 0.968 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8849799633026123
Epoch: 32, Steps: 20 | Train Loss: 0.583 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8006861209869385
Epoch: 33, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 444006
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.080806016921997
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.04888916015625
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1407296657562256
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.768 Vali Acc: 0.450 Test Loss: 0.768 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.103926420211792
Epoch: 4, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0835297107696533
Epoch: 5, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.132880210876465
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.365267753601074
Epoch: 7, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.6887686252593994
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.889 Vali Acc: 0.480 Test Loss: 0.889 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1944141387939453
Epoch: 9, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.125795841217041
Epoch: 10, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1284754276275635
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2179465293884277
Epoch: 12, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1847708225250244
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3258612155914307
Epoch: 14, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.27270770072937
Epoch: 15, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8640177249908447
Epoch: 16, Steps: 20 | Train Loss: 0.796 Vali Loss: 1.115 Vali Acc: 0.510 Test Loss: 1.115 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4463083744049072
Epoch: 17, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.720 Vali Acc: 0.600 Test Loss: 0.720 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599993).  Saving model ...
Epoch: 18 cost time: 2.3215320110321045
Epoch: 18, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1427693367004395
Epoch: 19, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.353149175643921
Epoch: 20, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.888 Vali Acc: 0.550 Test Loss: 0.888 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1161277294158936
Epoch: 21, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.975 Vali Acc: 0.520 Test Loss: 0.975 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2839913368225098
Epoch: 22, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.957 Vali Acc: 0.550 Test Loss: 0.957 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4380030632019043
Epoch: 23, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8378136157989502
Epoch: 24, Steps: 20 | Train Loss: 0.854 Vali Loss: 1.140 Vali Acc: 0.480 Test Loss: 1.140 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.247920036315918
Epoch: 25, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.126997709274292
Epoch: 26, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.016 Vali Acc: 0.460 Test Loss: 1.016 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1199822425842285
Epoch: 27, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 443494
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.22904634475708
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.202371597290039
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.090440273284912
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.774 Vali Acc: 0.450 Test Loss: 0.774 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9158961772918701
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.774 Vali Acc: 0.450 Test Loss: 0.774 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.106426954269409
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1161186695098877
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3345799446105957
Epoch: 7, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 1.5677580833435059
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1128735542297363
Epoch: 9, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 2.0949225425720215
Epoch: 10, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.779 Vali Acc: 0.450 Test Loss: 0.779 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.110589027404785
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.803 Vali Acc: 0.570 Test Loss: 0.803 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 2.0898988246917725
Epoch: 12, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0559487342834473
Epoch: 13, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.143554210662842
Epoch: 14, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.171205520629883
Epoch: 15, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2399535179138184
Epoch: 16, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.766636610031128
Epoch: 17, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.193544864654541
Epoch: 18, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2028889656066895
Epoch: 19, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.957 Vali Acc: 0.480 Test Loss: 0.957 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0555615425109863
Epoch: 20, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.734 Vali Acc: 0.600 Test Loss: 0.734 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599993).  Saving model ...
Epoch: 21 cost time: 2.0370867252349854
Epoch: 21, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9979000091552734
Epoch: 22, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9644742012023926
Epoch: 23, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4280626773834229
Epoch: 24, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.127211570739746
Epoch: 25, Steps: 20 | Train Loss: 0.564 Vali Loss: 1.105 Vali Acc: 0.530 Test Loss: 1.105 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.205625295639038
Epoch: 26, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.106 Vali Acc: 0.480 Test Loss: 1.106 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8695793151855469
Epoch: 27, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.908 Vali Acc: 0.590 Test Loss: 0.908 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.138627290725708
Epoch: 28, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0329391956329346
Epoch: 29, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.164797067642212
Epoch: 30, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.912 Vali Acc: 0.480 Test Loss: 0.912 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 442982
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.839570999145508
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.672 Vali Acc: 0.610 Test Loss: 0.672 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.3692879676818848
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.684 Vali Acc: 0.520 Test Loss: 0.684 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4527626037597656
Epoch: 3, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.467604160308838
Epoch: 4, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5015590190887451
Epoch: 5, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3791918754577637
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3966882228851318
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4127850532531738
Epoch: 8, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3129549026489258
Epoch: 9, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5067453384399414
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3570778369903564
Epoch: 11, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.871 Vali Acc: 0.480 Test Loss: 0.871 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 431878
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.765775680541992
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.6573853492736816
Epoch: 2, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.672342300415039
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5346953868865967
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.469452142715454
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 1.4362037181854248
Epoch: 6, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.5838282108306885
Epoch: 7, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.844 Vali Acc: 0.460 Test Loss: 0.844 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4380879402160645
Epoch: 8, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5034995079040527
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4282784461975098
Epoch: 10, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5983402729034424
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4756202697753906
Epoch: 12, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.864 Vali Acc: 0.520 Test Loss: 0.864 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5873217582702637
Epoch: 13, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6437971591949463
Epoch: 14, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3748717308044434
Epoch: 15, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.707 Vali Acc: 0.540 Test Loss: 0.707 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 1.4556753635406494
Epoch: 16, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5511016845703125
Epoch: 17, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6103038787841797
Epoch: 18, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6900579929351807
Epoch: 19, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.527658462524414
Epoch: 20, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.776 Vali Acc: 0.470 Test Loss: 0.776 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5085551738739014
Epoch: 21, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.800 Vali Acc: 0.450 Test Loss: 0.800 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5907490253448486
Epoch: 22, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4664206504821777
Epoch: 23, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.855 Vali Acc: 0.560 Test Loss: 0.855 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 24 cost time: 1.639805555343628
Epoch: 24, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6206104755401611
Epoch: 25, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.827 Vali Acc: 0.470 Test Loss: 0.827 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5279979705810547
Epoch: 26, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.170 Vali Acc: 0.490 Test Loss: 1.170 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6657090187072754
Epoch: 27, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.909 Vali Acc: 0.510 Test Loss: 0.909 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5941572189331055
Epoch: 28, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.121 Vali Acc: 0.470 Test Loss: 1.121 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6352026462554932
Epoch: 29, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.062 Vali Acc: 0.510 Test Loss: 1.062 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5352420806884766
Epoch: 30, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.010 Vali Acc: 0.530 Test Loss: 1.010 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4993410110473633
Epoch: 31, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.904 Vali Acc: 0.550 Test Loss: 0.904 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.397672414779663
Epoch: 32, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.623058557510376
Epoch: 33, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 431622
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.075331211090088
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.696 Vali Acc: 0.480 Test Loss: 0.696 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.4969780445098877
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.6697299480438232
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4956350326538086
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5355274677276611
Epoch: 5, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.453357458114624
Epoch: 6, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4414057731628418
Epoch: 7, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.888 Vali Acc: 0.490 Test Loss: 0.888 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4923293590545654
Epoch: 8, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.868 Vali Acc: 0.490 Test Loss: 0.868 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5107431411743164
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 1.4833898544311523
Epoch: 10, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6193854808807373
Epoch: 11, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5321235656738281
Epoch: 12, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6137564182281494
Epoch: 13, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6334285736083984
Epoch: 14, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.827 Vali Acc: 0.450 Test Loss: 0.827 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3689148426055908
Epoch: 15, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.804 Vali Acc: 0.470 Test Loss: 0.804 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6107518672943115
Epoch: 16, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3581230640411377
Epoch: 17, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.931 Vali Acc: 0.520 Test Loss: 0.931 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6155147552490234
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.930 Vali Acc: 0.460 Test Loss: 0.930 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4936912059783936
Epoch: 19, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.981 Vali Acc: 0.540 Test Loss: 0.981 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 431366
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8777596950531006
Epoch: 1, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.4526889324188232
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4314870834350586
Epoch: 3, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5547311305999756
Epoch: 4, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.516333818435669
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4745714664459229
Epoch: 6, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 1.3917672634124756
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4729585647583008
Epoch: 8, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4304695129394531
Epoch: 9, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5653326511383057
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 11 cost time: 1.594513177871704
Epoch: 11, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 12 cost time: 1.4003238677978516
Epoch: 12, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.329115867614746
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4911513328552246
Epoch: 14, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.766 Vali Acc: 0.450 Test Loss: 0.766 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6032190322875977
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.798 Vali Acc: 0.440 Test Loss: 0.798 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6340160369873047
Epoch: 16, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.869 Vali Acc: 0.530 Test Loss: 0.869 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 17 cost time: 1.5326781272888184
Epoch: 17, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5875415802001953
Epoch: 18, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7837774753570557
Epoch: 19, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.805 Vali Acc: 0.440 Test Loss: 0.805 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5773835182189941
Epoch: 20, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.34979248046875
Epoch: 21, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.970 Vali Acc: 0.500 Test Loss: 0.970 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6706790924072266
Epoch: 22, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.890 Vali Acc: 0.530 Test Loss: 0.890 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3625295162200928
Epoch: 23, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4583396911621094
Epoch: 24, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.875 Vali Acc: 0.440 Test Loss: 0.875 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.445610523223877
Epoch: 25, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.858 Vali Acc: 0.550 Test Loss: 0.858 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549991).  Saving model ...
Epoch: 26 cost time: 1.340662956237793
Epoch: 26, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.933 Vali Acc: 0.530 Test Loss: 0.933 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5002598762512207
Epoch: 27, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.907 Vali Acc: 0.530 Test Loss: 0.907 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5515778064727783
Epoch: 28, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3080463409423828
Epoch: 29, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.062 Vali Acc: 0.510 Test Loss: 1.062 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4690272808074951
Epoch: 30, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3279829025268555
Epoch: 31, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.120 Vali Acc: 0.490 Test Loss: 1.120 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.408900499343872
Epoch: 32, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.885 Vali Acc: 0.530 Test Loss: 0.885 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4827978610992432
Epoch: 33, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.036 Vali Acc: 0.530 Test Loss: 1.036 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.368826150894165
Epoch: 34, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.962 Vali Acc: 0.540 Test Loss: 0.962 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3379321098327637
Epoch: 35, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 431110
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9431393146514893
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.5602147579193115
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.689 Vali Acc: 0.530 Test Loss: 0.689 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4371123313903809
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.716 Vali Acc: 0.450 Test Loss: 0.716 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.419551134109497
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.723 Vali Acc: 0.450 Test Loss: 0.723 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4888312816619873
Epoch: 5, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5269827842712402
Epoch: 6, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.748 Vali Acc: 0.460 Test Loss: 0.748 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4871816635131836
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5498318672180176
Epoch: 8, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.888 Vali Acc: 0.440 Test Loss: 0.888 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5901679992675781
Epoch: 9, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5013091564178467
Epoch: 10, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.810 Vali Acc: 0.450 Test Loss: 0.810 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4308867454528809
Epoch: 11, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.769 Vali Acc: 0.450 Test Loss: 0.769 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 265478
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7509360313415527
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.683 Vali Acc: 0.610 Test Loss: 0.683 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.3360528945922852
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3527839183807373
Epoch: 3, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3678836822509766
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4655909538269043
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5235881805419922
Epoch: 6, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5362563133239746
Epoch: 7, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5440242290496826
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5489535331726074
Epoch: 9, Steps: 20 | Train Loss: 0.686 Vali Loss: 1.006 Vali Acc: 0.510 Test Loss: 1.006 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.54897141456604
Epoch: 10, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.786381483078003
Epoch: 11, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 265222
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8601436614990234
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.325998306274414
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4314954280853271
Epoch: 3, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3956835269927979
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.517829179763794
Epoch: 5, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5959765911102295
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 1.4634881019592285
Epoch: 7, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4180011749267578
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.863 Vali Acc: 0.480 Test Loss: 0.863 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5575945377349854
Epoch: 9, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.978 Vali Acc: 0.490 Test Loss: 0.978 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6203832626342773
Epoch: 10, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 11 cost time: 1.5315282344818115
Epoch: 11, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5976800918579102
Epoch: 12, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5771362781524658
Epoch: 13, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.732 Vali Acc: 0.580 Test Loss: 0.732 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 1.4183099269866943
Epoch: 14, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.494056224822998
Epoch: 15, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.569413661956787
Epoch: 16, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4491994380950928
Epoch: 17, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.974 Vali Acc: 0.490 Test Loss: 0.974 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5356040000915527
Epoch: 18, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5938835144042969
Epoch: 19, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.782 Vali Acc: 0.550 Test Loss: 0.782 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6025760173797607
Epoch: 20, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4725103378295898
Epoch: 21, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.461186170578003
Epoch: 22, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4227004051208496
Epoch: 23, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 264966
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0688819885253906
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.4455010890960693
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.467841625213623
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.707 Vali Acc: 0.460 Test Loss: 0.707 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7136011123657227
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4135782718658447
Epoch: 5, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.6257009506225586
Epoch: 6, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5209662914276123
Epoch: 7, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.993 Vali Acc: 0.490 Test Loss: 0.993 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4669849872589111
Epoch: 8, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.416550636291504
Epoch: 9, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6000843048095703
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.465747594833374
Epoch: 11, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5700135231018066
Epoch: 12, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7015302181243896
Epoch: 13, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.620121955871582
Epoch: 14, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6897501945495605
Epoch: 15, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6651322841644287
Epoch: 16, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4818024635314941
Epoch: 17, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5469441413879395
Epoch: 18, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.539229393005371
Epoch: 19, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5540714263916016
Epoch: 20, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 264710
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8071353435516357
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5583772659301758
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.6580066680908203
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5944581031799316
Epoch: 4, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6540844440460205
Epoch: 5, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.880 Vali Acc: 0.490 Test Loss: 0.880 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5371708869934082
Epoch: 6, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5120625495910645
Epoch: 7, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.44842529296875
Epoch: 8, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 1.4614787101745605
Epoch: 9, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4818122386932373
Epoch: 10, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6446869373321533
Epoch: 11, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.5932493209838867
Epoch: 12, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6122043132781982
Epoch: 13, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6578974723815918
Epoch: 14, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5620448589324951
Epoch: 15, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.816 Vali Acc: 0.470 Test Loss: 0.816 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7022531032562256
Epoch: 16, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.762416124343872
Epoch: 17, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9536383152008057
Epoch: 18, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.832 Vali Acc: 0.530 Test Loss: 0.832 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6725218296051025
Epoch: 19, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8289210796356201
Epoch: 20, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.461916446685791
Epoch: 21, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 182278
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.891293525695801
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.694 Vali Acc: 0.490 Test Loss: 0.694 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5051722526550293
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.5736782550811768
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.713 Vali Acc: 0.440 Test Loss: 0.713 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4013969898223877
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 1.6080505847930908
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3702707290649414
Epoch: 6, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6011316776275635
Epoch: 7, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6270732879638672
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7015225887298584
Epoch: 9, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.7168495655059814
Epoch: 10, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7709248065948486
Epoch: 11, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.709014892578125
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 13 cost time: 1.6423218250274658
Epoch: 13, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.702 Vali Acc: 0.570 Test Loss: 0.702 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.5630474090576172
Epoch: 14, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.784 Vali Acc: 0.410 Test Loss: 0.784 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6931254863739014
Epoch: 15, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5073537826538086
Epoch: 16, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5365684032440186
Epoch: 17, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5149672031402588
Epoch: 18, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.860 Vali Acc: 0.450 Test Loss: 0.860 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.499474048614502
Epoch: 19, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5704665184020996
Epoch: 20, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.379317283630371
Epoch: 21, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5177786350250244
Epoch: 22, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6451754570007324
Epoch: 23, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 182022
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8180410861968994
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.4854636192321777
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.692 Vali Acc: 0.490 Test Loss: 0.692 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3762342929840088
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.466217279434204
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5085532665252686
Epoch: 5, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5085387229919434
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4740636348724365
Epoch: 7, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5809834003448486
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5711705684661865
Epoch: 9, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.789 Vali Acc: 0.470 Test Loss: 0.789 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5720796585083008
Epoch: 10, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5710740089416504
Epoch: 11, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3125479221343994
Epoch: 12, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.601886510848999
Epoch: 13, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 181766
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.609682083129883
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.3105800151824951
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5034263134002686
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2863662242889404
Epoch: 4, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3603582382202148
Epoch: 5, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5868415832519531
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.45707106590271
Epoch: 7, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.464625597000122
Epoch: 8, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.941 Vali Acc: 0.490 Test Loss: 0.941 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4562404155731201
Epoch: 9, Steps: 20 | Train Loss: 0.812 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4940648078918457
Epoch: 10, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4301025867462158
Epoch: 11, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 181510
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.68550181388855
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.689 Vali Acc: 0.540 Test Loss: 0.689 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.402991771697998
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2948179244995117
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.366684913635254
Epoch: 4, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.585916519165039
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4722473621368408
Epoch: 6, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.51350998878479
Epoch: 7, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.741 Vali Acc: 0.450 Test Loss: 0.741 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4148297309875488
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4152791500091553
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.448225736618042
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2994093894958496
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 140678
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5119779109954834
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.4567415714263916
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.4492075443267822
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.541583776473999
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.765 Vali Acc: 0.450 Test Loss: 0.765 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4666545391082764
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4420299530029297
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4210577011108398
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4539189338684082
Epoch: 8, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3556034564971924
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4284858703613281
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3126530647277832
Epoch: 11, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3455615043640137
Epoch: 12, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 140422
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0089030265808105
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.521946907043457
Epoch: 2, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.519033670425415
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4576733112335205
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.713 Vali Acc: 0.450 Test Loss: 0.713 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5507621765136719
Epoch: 5, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.792 Vali Acc: 0.460 Test Loss: 0.792 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4014408588409424
Epoch: 6, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.326429843902588
Epoch: 7, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3798060417175293
Epoch: 8, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2795116901397705
Epoch: 9, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 1.3269989490509033
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.344128131866455
Epoch: 11, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.857 Vali Acc: 0.450 Test Loss: 0.857 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4294822216033936
Epoch: 12, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 13 cost time: 1.3321681022644043
Epoch: 13, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4976015090942383
Epoch: 14, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.785 Vali Acc: 0.450 Test Loss: 0.785 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6310524940490723
Epoch: 15, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 16 cost time: 1.4514756202697754
Epoch: 16, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5106356143951416
Epoch: 17, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 18 cost time: 1.5047950744628906
Epoch: 18, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.456895351409912
Epoch: 19, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4695534706115723
Epoch: 20, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5752296447753906
Epoch: 21, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4583427906036377
Epoch: 22, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4205529689788818
Epoch: 23, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4556403160095215
Epoch: 24, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.401806116104126
Epoch: 25, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 26 cost time: 1.2666213512420654
Epoch: 26, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3786780834197998
Epoch: 27, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.390944242477417
Epoch: 28, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.919 Vali Acc: 0.450 Test Loss: 0.919 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4267163276672363
Epoch: 29, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4570012092590332
Epoch: 30, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.877 Vali Acc: 0.460 Test Loss: 0.877 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5509636402130127
Epoch: 31, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4464483261108398
Epoch: 32, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3241980075836182
Epoch: 33, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.873 Vali Acc: 0.520 Test Loss: 0.873 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.421281337738037
Epoch: 34, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.000 Vali Acc: 0.520 Test Loss: 1.000 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3274531364440918
Epoch: 35, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.833 Vali Acc: 0.470 Test Loss: 0.833 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 140166
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.095158100128174
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.694 Vali Acc: 0.490 Test Loss: 0.694 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5288100242614746
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.469712257385254
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4303593635559082
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4473459720611572
Epoch: 5, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.669729232788086
Epoch: 6, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.998 Vali Acc: 0.490 Test Loss: 0.998 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6349256038665771
Epoch: 7, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5630402565002441
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4117379188537598
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4428086280822754
Epoch: 10, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.522611141204834
Epoch: 11, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6066505908966064
Epoch: 12, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 139910
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4644322395324707
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.0326626300811768
Epoch: 2, Steps: 20 | Train Loss: 0.933 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 1.3369150161743164
Epoch: 3, Steps: 20 | Train Loss: 1.012 Vali Loss: 0.888 Vali Acc: 0.550 Test Loss: 0.888 Test Acc: 0.550
Validation loss decreased (-0.499991 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 1.9764657020568848
Epoch: 4, Steps: 20 | Train Loss: 0.960 Vali Loss: 1.562 Vali Acc: 0.490 Test Loss: 1.562 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8832926750183105
Epoch: 5, Steps: 20 | Train Loss: 1.091 Vali Loss: 0.754 Vali Acc: 0.600 Test Loss: 0.754 Test Acc: 0.600
Validation loss decreased (-0.549991 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 1.8833897113800049
Epoch: 6, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.875 Vali Acc: 0.550 Test Loss: 0.875 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0171127319335938
Epoch: 7, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9314954280853271
Epoch: 8, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.879 Vali Acc: 0.480 Test Loss: 0.879 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.180668830871582
Epoch: 9, Steps: 20 | Train Loss: 0.869 Vali Loss: 2.402 Vali Acc: 0.510 Test Loss: 2.402 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.343881368637085
Epoch: 10, Steps: 20 | Train Loss: 1.316 Vali Loss: 1.369 Vali Acc: 0.540 Test Loss: 1.369 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0937347412109375
Epoch: 11, Steps: 20 | Train Loss: 1.094 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.122678518295288
Epoch: 12, Steps: 20 | Train Loss: 1.090 Vali Loss: 1.453 Vali Acc: 0.510 Test Loss: 1.453 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2384414672851562
Epoch: 13, Steps: 20 | Train Loss: 1.060 Vali Loss: 1.615 Vali Acc: 0.500 Test Loss: 1.615 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0176281929016113
Epoch: 14, Steps: 20 | Train Loss: 0.868 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1182916164398193
Epoch: 15, Steps: 20 | Train Loss: 0.922 Vali Loss: 1.300 Vali Acc: 0.530 Test Loss: 1.300 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4866074
model size : 23.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.076968193054199
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.045948028564453
Epoch: 2, Steps: 20 | Train Loss: 0.979 Vali Loss: 0.894 Vali Acc: 0.450 Test Loss: 0.894 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0475966930389404
Epoch: 3, Steps: 20 | Train Loss: 0.958 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9360196590423584
Epoch: 4, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.839 Vali Acc: 0.480 Test Loss: 0.839 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.208919048309326
Epoch: 5, Steps: 20 | Train Loss: 0.957 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.09468150138855
Epoch: 6, Steps: 20 | Train Loss: 1.099 Vali Loss: 0.931 Vali Acc: 0.530 Test Loss: 0.931 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 1.9750819206237793
Epoch: 7, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.895 Vali Acc: 0.630 Test Loss: 0.895 Test Acc: 0.630
Validation loss decreased (-0.529991 --> -0.629991).  Saving model ...
Epoch: 8 cost time: 1.5325148105621338
Epoch: 8, Steps: 20 | Train Loss: 1.284 Vali Loss: 0.771 Vali Acc: 0.580 Test Loss: 0.771 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.112128496170044
Epoch: 9, Steps: 20 | Train Loss: 0.875 Vali Loss: 0.836 Vali Acc: 0.530 Test Loss: 0.836 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2242515087127686
Epoch: 10, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.895 Vali Acc: 0.440 Test Loss: 0.895 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4637703895568848
Epoch: 11, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.816 Vali Acc: 0.570 Test Loss: 0.816 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.030003309249878
Epoch: 12, Steps: 20 | Train Loss: 0.971 Vali Loss: 1.552 Vali Acc: 0.520 Test Loss: 1.552 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9698078632354736
Epoch: 13, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.858 Vali Acc: 0.560 Test Loss: 0.858 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.88641357421875
Epoch: 14, Steps: 20 | Train Loss: 0.762 Vali Loss: 1.110 Vali Acc: 0.510 Test Loss: 1.110 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6952886581420898
Epoch: 15, Steps: 20 | Train Loss: 1.151 Vali Loss: 1.432 Vali Acc: 0.500 Test Loss: 1.432 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8132045269012451
Epoch: 16, Steps: 20 | Train Loss: 0.866 Vali Loss: 1.085 Vali Acc: 0.540 Test Loss: 1.085 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8568146228790283
Epoch: 17, Steps: 20 | Train Loss: 0.965 Vali Loss: 1.540 Vali Acc: 0.520 Test Loss: 1.540 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 4864794
model size : 23.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.291111469268799
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.699 Vali Acc: 0.540 Test Loss: 0.699 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.8885564804077148
Epoch: 2, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8593833446502686
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 1.066 Vali Acc: 0.510 Test Loss: 1.066 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9177815914154053
Epoch: 4, Steps: 20 | Train Loss: 0.787 Vali Loss: 1.083 Vali Acc: 0.490 Test Loss: 1.083 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.935971736907959
Epoch: 5, Steps: 20 | Train Loss: 0.844 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.397026538848877
Epoch: 6, Steps: 20 | Train Loss: 1.170 Vali Loss: 1.031 Vali Acc: 0.510 Test Loss: 1.031 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1650052070617676
Epoch: 7, Steps: 20 | Train Loss: 0.945 Vali Loss: 1.352 Vali Acc: 0.500 Test Loss: 1.352 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.797104835510254
Epoch: 8, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.979 Vali Acc: 0.510 Test Loss: 0.979 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.255873441696167
Epoch: 9, Steps: 20 | Train Loss: 0.880 Vali Loss: 1.151 Vali Acc: 0.530 Test Loss: 1.151 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4224681854248047
Epoch: 10, Steps: 20 | Train Loss: 0.931 Vali Loss: 1.847 Vali Acc: 0.470 Test Loss: 1.847 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.384511947631836
Epoch: 11, Steps: 20 | Train Loss: 1.483 Vali Loss: 1.001 Vali Acc: 0.510 Test Loss: 1.001 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 4863514
model size : 23.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.344698905944824
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.935 Vali Acc: 0.490 Test Loss: 0.935 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 1.9715917110443115
Epoch: 2, Steps: 20 | Train Loss: 0.857 Vali Loss: 1.083 Vali Acc: 0.470 Test Loss: 1.083 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8091881275177002
Epoch: 3, Steps: 20 | Train Loss: 0.891 Vali Loss: 0.837 Vali Acc: 0.490 Test Loss: 0.837 Test Acc: 0.490
Validation loss decreased (-0.489991 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 1.899900197982788
Epoch: 4, Steps: 20 | Train Loss: 0.831 Vali Loss: 0.991 Vali Acc: 0.510 Test Loss: 0.991 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509990).  Saving model ...
Epoch: 5 cost time: 1.8729586601257324
Epoch: 5, Steps: 20 | Train Loss: 0.876 Vali Loss: 0.843 Vali Acc: 0.580 Test Loss: 0.843 Test Acc: 0.580
Validation loss decreased (-0.509990 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 1.7616262435913086
Epoch: 6, Steps: 20 | Train Loss: 0.916 Vali Loss: 1.060 Vali Acc: 0.510 Test Loss: 1.060 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7950692176818848
Epoch: 7, Steps: 20 | Train Loss: 0.883 Vali Loss: 1.023 Vali Acc: 0.490 Test Loss: 1.023 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7559773921966553
Epoch: 8, Steps: 20 | Train Loss: 0.945 Vali Loss: 1.172 Vali Acc: 0.440 Test Loss: 1.172 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8351385593414307
Epoch: 9, Steps: 20 | Train Loss: 0.803 Vali Loss: 1.033 Vali Acc: 0.490 Test Loss: 1.033 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9493224620819092
Epoch: 10, Steps: 20 | Train Loss: 0.817 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.771759271621704
Epoch: 11, Steps: 20 | Train Loss: 0.798 Vali Loss: 1.079 Vali Acc: 0.510 Test Loss: 1.079 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.840719223022461
Epoch: 12, Steps: 20 | Train Loss: 1.308 Vali Loss: 4.063 Vali Acc: 0.510 Test Loss: 4.063 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8972954750061035
Epoch: 13, Steps: 20 | Train Loss: 2.195 Vali Loss: 3.738 Vali Acc: 0.510 Test Loss: 3.738 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4807136058807373
Epoch: 14, Steps: 20 | Train Loss: 1.320 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.06128191947937
Epoch: 15, Steps: 20 | Train Loss: 1.098 Vali Loss: 1.665 Vali Acc: 0.500 Test Loss: 1.665 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4862234
model size : 23.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.74407958984375
Epoch: 1, Steps: 20 | Train Loss: 0.812 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.9071807861328125
Epoch: 2, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.741 Vali Acc: 0.420 Test Loss: 0.741 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9518911838531494
Epoch: 3, Steps: 20 | Train Loss: 0.867 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509991).  Saving model ...
Epoch: 4 cost time: 1.3770623207092285
Epoch: 4, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.139 Vali Acc: 0.460 Test Loss: 1.139 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8040475845336914
Epoch: 5, Steps: 20 | Train Loss: 0.913 Vali Loss: 1.027 Vali Acc: 0.440 Test Loss: 1.027 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9114036560058594
Epoch: 6, Steps: 20 | Train Loss: 0.830 Vali Loss: 1.126 Vali Acc: 0.470 Test Loss: 1.126 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7362160682678223
Epoch: 7, Steps: 20 | Train Loss: 1.128 Vali Loss: 1.151 Vali Acc: 0.460 Test Loss: 1.151 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9447028636932373
Epoch: 8, Steps: 20 | Train Loss: 0.828 Vali Loss: 2.130 Vali Acc: 0.490 Test Loss: 2.130 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6635541915893555
Epoch: 9, Steps: 20 | Train Loss: 1.197 Vali Loss: 1.110 Vali Acc: 0.530 Test Loss: 1.110 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529989).  Saving model ...
Epoch: 10 cost time: 1.958385705947876
Epoch: 10, Steps: 20 | Train Loss: 0.894 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0912539958953857
Epoch: 11, Steps: 20 | Train Loss: 1.927 Vali Loss: 2.272 Vali Acc: 0.490 Test Loss: 2.272 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3115627765655518
Epoch: 12, Steps: 20 | Train Loss: 1.491 Vali Loss: 1.162 Vali Acc: 0.470 Test Loss: 1.162 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9026308059692383
Epoch: 13, Steps: 20 | Train Loss: 1.517 Vali Loss: 3.148 Vali Acc: 0.510 Test Loss: 3.148 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8866140842437744
Epoch: 14, Steps: 20 | Train Loss: 2.102 Vali Loss: 2.485 Vali Acc: 0.520 Test Loss: 2.485 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.832190752029419
Epoch: 15, Steps: 20 | Train Loss: 0.803 Vali Loss: 1.325 Vali Acc: 0.510 Test Loss: 1.325 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8851840496063232
Epoch: 16, Steps: 20 | Train Loss: 1.353 Vali Loss: 1.114 Vali Acc: 0.560 Test Loss: 1.114 Test Acc: 0.560
Validation loss decreased (-0.529989 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.9620351791381836
Epoch: 17, Steps: 20 | Train Loss: 1.372 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.885324478149414
Epoch: 18, Steps: 20 | Train Loss: 0.929 Vali Loss: 2.090 Vali Acc: 0.480 Test Loss: 2.090 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.391024112701416
Epoch: 19, Steps: 20 | Train Loss: 1.162 Vali Loss: 2.071 Vali Acc: 0.480 Test Loss: 2.071 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9297966957092285
Epoch: 20, Steps: 20 | Train Loss: 1.148 Vali Loss: 1.566 Vali Acc: 0.510 Test Loss: 1.566 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7408874034881592
Epoch: 21, Steps: 20 | Train Loss: 1.045 Vali Loss: 1.446 Vali Acc: 0.610 Test Loss: 1.446 Test Acc: 0.610
Validation loss decreased (-0.559989 --> -0.609986).  Saving model ...
Epoch: 22 cost time: 1.9156289100646973
Epoch: 22, Steps: 20 | Train Loss: 0.824 Vali Loss: 3.116 Vali Acc: 0.470 Test Loss: 3.116 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9309630393981934
Epoch: 23, Steps: 20 | Train Loss: 1.530 Vali Loss: 3.075 Vali Acc: 0.510 Test Loss: 3.075 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9765722751617432
Epoch: 24, Steps: 20 | Train Loss: 1.225 Vali Loss: 1.326 Vali Acc: 0.540 Test Loss: 1.326 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9152822494506836
Epoch: 25, Steps: 20 | Train Loss: 0.692 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0643374919891357
Epoch: 26, Steps: 20 | Train Loss: 1.096 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5981290340423584
Epoch: 27, Steps: 20 | Train Loss: 1.132 Vali Loss: 5.155 Vali Acc: 0.480 Test Loss: 5.155 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.009883165359497
Epoch: 28, Steps: 20 | Train Loss: 1.803 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.886167049407959
Epoch: 29, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.263 Vali Acc: 0.540 Test Loss: 1.263 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9862818717956543
Epoch: 30, Steps: 20 | Train Loss: 0.861 Vali Loss: 2.478 Vali Acc: 0.520 Test Loss: 2.478 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.109977960586548
Epoch: 31, Steps: 20 | Train Loss: 1.215 Vali Loss: 2.959 Vali Acc: 0.520 Test Loss: 2.959 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4078106
model size : 20.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9809560775756836
Epoch: 1, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.9255552291870117
Epoch: 2, Steps: 20 | Train Loss: 0.841 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9681074619293213
Epoch: 3, Steps: 20 | Train Loss: 0.840 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.8693811893463135
Epoch: 4, Steps: 20 | Train Loss: 1.291 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.8433823585510254
Epoch: 5, Steps: 20 | Train Loss: 1.646 Vali Loss: 2.972 Vali Acc: 0.490 Test Loss: 2.972 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5345335006713867
Epoch: 6, Steps: 20 | Train Loss: 1.170 Vali Loss: 0.920 Vali Acc: 0.480 Test Loss: 0.920 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9885437488555908
Epoch: 7, Steps: 20 | Train Loss: 0.858 Vali Loss: 1.009 Vali Acc: 0.520 Test Loss: 1.009 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9370007514953613
Epoch: 8, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.914 Vali Acc: 0.470 Test Loss: 0.914 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9655113220214844
Epoch: 9, Steps: 20 | Train Loss: 1.199 Vali Loss: 1.958 Vali Acc: 0.490 Test Loss: 1.958 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0763561725616455
Epoch: 10, Steps: 20 | Train Loss: 1.154 Vali Loss: 2.242 Vali Acc: 0.490 Test Loss: 2.242 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9767777919769287
Epoch: 11, Steps: 20 | Train Loss: 1.108 Vali Loss: 2.039 Vali Acc: 0.490 Test Loss: 2.039 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0195846557617188
Epoch: 12, Steps: 20 | Train Loss: 1.460 Vali Loss: 3.585 Vali Acc: 0.490 Test Loss: 3.585 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.080495595932007
Epoch: 13, Steps: 20 | Train Loss: 2.277 Vali Loss: 3.775 Vali Acc: 0.490 Test Loss: 3.775 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1251354217529297
Epoch: 14, Steps: 20 | Train Loss: 1.237 Vali Loss: 0.965 Vali Acc: 0.500 Test Loss: 0.965 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4076826
model size : 20.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3420848846435547
Epoch: 1, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 1.8474056720733643
Epoch: 2, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.875 Vali Acc: 0.450 Test Loss: 0.875 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.006337881088257
Epoch: 3, Steps: 20 | Train Loss: 0.895 Vali Loss: 1.077 Vali Acc: 0.490 Test Loss: 1.077 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0146851539611816
Epoch: 4, Steps: 20 | Train Loss: 0.943 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
Validation loss decreased (-0.509990 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 1.4835584163665771
Epoch: 5, Steps: 20 | Train Loss: 1.217 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 2.1349215507507324
Epoch: 6, Steps: 20 | Train Loss: 0.862 Vali Loss: 0.893 Vali Acc: 0.530 Test Loss: 0.893 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.140177011489868
Epoch: 7, Steps: 20 | Train Loss: 0.902 Vali Loss: 0.986 Vali Acc: 0.510 Test Loss: 0.986 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1491174697875977
Epoch: 8, Steps: 20 | Train Loss: 0.880 Vali Loss: 2.187 Vali Acc: 0.490 Test Loss: 2.187 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1977245807647705
Epoch: 9, Steps: 20 | Train Loss: 1.125 Vali Loss: 2.670 Vali Acc: 0.510 Test Loss: 2.670 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1205365657806396
Epoch: 10, Steps: 20 | Train Loss: 1.938 Vali Loss: 1.573 Vali Acc: 0.520 Test Loss: 1.573 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2084696292877197
Epoch: 11, Steps: 20 | Train Loss: 0.838 Vali Loss: 0.765 Vali Acc: 0.610 Test Loss: 0.765 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 12 cost time: 2.0786471366882324
Epoch: 12, Steps: 20 | Train Loss: 0.817 Vali Loss: 0.899 Vali Acc: 0.510 Test Loss: 0.899 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6930902004241943
Epoch: 13, Steps: 20 | Train Loss: 0.980 Vali Loss: 1.774 Vali Acc: 0.480 Test Loss: 1.774 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0347514152526855
Epoch: 14, Steps: 20 | Train Loss: 1.184 Vali Loss: 0.789 Vali Acc: 0.590 Test Loss: 0.789 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9147865772247314
Epoch: 15, Steps: 20 | Train Loss: 1.343 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1281778812408447
Epoch: 16, Steps: 20 | Train Loss: 1.339 Vali Loss: 0.925 Vali Acc: 0.590 Test Loss: 0.925 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1285603046417236
Epoch: 17, Steps: 20 | Train Loss: 1.277 Vali Loss: 1.881 Vali Acc: 0.520 Test Loss: 1.881 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9365134239196777
Epoch: 18, Steps: 20 | Train Loss: 1.545 Vali Loss: 1.592 Vali Acc: 0.520 Test Loss: 1.592 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9768106937408447
Epoch: 19, Steps: 20 | Train Loss: 1.110 Vali Loss: 1.238 Vali Acc: 0.540 Test Loss: 1.238 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.177443027496338
Epoch: 20, Steps: 20 | Train Loss: 1.244 Vali Loss: 1.730 Vali Acc: 0.450 Test Loss: 1.730 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5777032375335693
Epoch: 21, Steps: 20 | Train Loss: 2.414 Vali Loss: 2.617 Vali Acc: 0.450 Test Loss: 2.617 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4075546
model size : 20.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.473997116088867
Epoch: 1, Steps: 20 | Train Loss: 0.877 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.5257654190063477
Epoch: 2, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.958 Vali Acc: 0.530 Test Loss: 0.958 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 3 cost time: 1.52547287940979
Epoch: 3, Steps: 20 | Train Loss: 1.122 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.8034098148345947
Epoch: 4, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0363354682922363
Epoch: 5, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 2.000140428543091
Epoch: 6, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0861198902130127
Epoch: 7, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2268462181091309
Epoch: 8, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0797359943389893
Epoch: 9, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.974 Vali Acc: 0.460 Test Loss: 0.974 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0800623893737793
Epoch: 10, Steps: 20 | Train Loss: 1.090 Vali Loss: 1.469 Vali Acc: 0.490 Test Loss: 1.469 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6527414321899414
Epoch: 11, Steps: 20 | Train Loss: 1.070 Vali Loss: 0.960 Vali Acc: 0.470 Test Loss: 0.960 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9934144020080566
Epoch: 12, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.856 Vali Acc: 0.560 Test Loss: 0.856 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.179657459259033
Epoch: 13, Steps: 20 | Train Loss: 1.546 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9066553115844727
Epoch: 14, Steps: 20 | Train Loss: 0.996 Vali Loss: 1.090 Vali Acc: 0.550 Test Loss: 1.090 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9781675338745117
Epoch: 15, Steps: 20 | Train Loss: 0.886 Vali Loss: 1.319 Vali Acc: 0.490 Test Loss: 1.319 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4074266
model size : 20.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3386240005493164
Epoch: 1, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.859 Vali Acc: 0.460 Test Loss: 0.859 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 1.9853618144989014
Epoch: 2, Steps: 20 | Train Loss: 0.938 Vali Loss: 1.097 Vali Acc: 0.470 Test Loss: 1.097 Test Acc: 0.470
Validation loss decreased (-0.459991 --> -0.469989).  Saving model ...
Epoch: 3 cost time: 1.855790376663208
Epoch: 3, Steps: 20 | Train Loss: 0.874 Vali Loss: 1.073 Vali Acc: 0.480 Test Loss: 1.073 Test Acc: 0.480
Validation loss decreased (-0.469989 --> -0.479989).  Saving model ...
Epoch: 4 cost time: 1.7654471397399902
Epoch: 4, Steps: 20 | Train Loss: 0.838 Vali Loss: 1.352 Vali Acc: 0.490 Test Loss: 1.352 Test Acc: 0.490
Validation loss decreased (-0.479989 --> -0.489986).  Saving model ...
Epoch: 5 cost time: 1.925950050354004
Epoch: 5, Steps: 20 | Train Loss: 0.996 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.489986 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.9313030242919922
Epoch: 6, Steps: 20 | Train Loss: 0.936 Vali Loss: 0.790 Vali Acc: 0.590 Test Loss: 0.790 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.5095984935760498
Epoch: 7, Steps: 20 | Train Loss: 0.942 Vali Loss: 0.909 Vali Acc: 0.580 Test Loss: 0.909 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8062584400177002
Epoch: 8, Steps: 20 | Train Loss: 1.094 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8778297901153564
Epoch: 9, Steps: 20 | Train Loss: 1.028 Vali Loss: 0.712 Vali Acc: 0.600 Test Loss: 0.712 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599993).  Saving model ...
Epoch: 10 cost time: 1.6819512844085693
Epoch: 10, Steps: 20 | Train Loss: 0.859 Vali Loss: 2.297 Vali Acc: 0.500 Test Loss: 2.297 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9240498542785645
Epoch: 11, Steps: 20 | Train Loss: 0.899 Vali Loss: 0.896 Vali Acc: 0.550 Test Loss: 0.896 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8053505420684814
Epoch: 12, Steps: 20 | Train Loss: 1.185 Vali Loss: 0.891 Vali Acc: 0.620 Test Loss: 0.891 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619991).  Saving model ...
Epoch: 13 cost time: 1.9416136741638184
Epoch: 13, Steps: 20 | Train Loss: 1.210 Vali Loss: 1.418 Vali Acc: 0.510 Test Loss: 1.418 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5382452011108398
Epoch: 14, Steps: 20 | Train Loss: 1.014 Vali Loss: 1.400 Vali Acc: 0.560 Test Loss: 1.400 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.933492660522461
Epoch: 15, Steps: 20 | Train Loss: 1.029 Vali Loss: 0.854 Vali Acc: 0.530 Test Loss: 0.854 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.975682258605957
Epoch: 16, Steps: 20 | Train Loss: 1.938 Vali Loss: 1.016 Vali Acc: 0.580 Test Loss: 1.016 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9561736583709717
Epoch: 17, Steps: 20 | Train Loss: 0.874 Vali Loss: 1.874 Vali Acc: 0.510 Test Loss: 1.874 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.926187515258789
Epoch: 18, Steps: 20 | Train Loss: 1.076 Vali Loss: 2.049 Vali Acc: 0.500 Test Loss: 2.049 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6857221126556396
Epoch: 19, Steps: 20 | Train Loss: 1.237 Vali Loss: 0.927 Vali Acc: 0.520 Test Loss: 0.927 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9171249866485596
Epoch: 20, Steps: 20 | Train Loss: 1.103 Vali Loss: 1.764 Vali Acc: 0.470 Test Loss: 1.764 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.477374792098999
Epoch: 21, Steps: 20 | Train Loss: 1.028 Vali Loss: 1.296 Vali Acc: 0.600 Test Loss: 1.296 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9482426643371582
Epoch: 22, Steps: 20 | Train Loss: 0.855 Vali Loss: 1.576 Vali Acc: 0.510 Test Loss: 1.576 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3684122
model size : 19.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0396640300750732
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.808 Vali Acc: 0.460 Test Loss: 0.808 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.8109972476959229
Epoch: 2, Steps: 20 | Train Loss: 0.977 Vali Loss: 1.093 Vali Acc: 0.490 Test Loss: 1.093 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 1.9088311195373535
Epoch: 3, Steps: 20 | Train Loss: 0.930 Vali Loss: 0.919 Vali Acc: 0.480 Test Loss: 0.919 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6456630229949951
Epoch: 4, Steps: 20 | Train Loss: 0.947 Vali Loss: 0.833 Vali Acc: 0.590 Test Loss: 0.833 Test Acc: 0.590
Validation loss decreased (-0.489989 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 1.825737476348877
Epoch: 5, Steps: 20 | Train Loss: 0.820 Vali Loss: 0.940 Vali Acc: 0.490 Test Loss: 0.940 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8914124965667725
Epoch: 6, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.883476972579956
Epoch: 7, Steps: 20 | Train Loss: 0.866 Vali Loss: 1.115 Vali Acc: 0.490 Test Loss: 1.115 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6524748802185059
Epoch: 8, Steps: 20 | Train Loss: 1.091 Vali Loss: 2.070 Vali Acc: 0.510 Test Loss: 2.070 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9980285167694092
Epoch: 9, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9091389179229736
Epoch: 10, Steps: 20 | Train Loss: 1.197 Vali Loss: 1.373 Vali Acc: 0.530 Test Loss: 1.373 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.776578664779663
Epoch: 11, Steps: 20 | Train Loss: 1.195 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4025375843048096
Epoch: 12, Steps: 20 | Train Loss: 0.813 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.89646577835083
Epoch: 13, Steps: 20 | Train Loss: 1.300 Vali Loss: 0.798 Vali Acc: 0.610 Test Loss: 0.798 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609992).  Saving model ...
Epoch: 14 cost time: 1.9455528259277344
Epoch: 14, Steps: 20 | Train Loss: 1.013 Vali Loss: 1.118 Vali Acc: 0.490 Test Loss: 1.118 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8138720989227295
Epoch: 15, Steps: 20 | Train Loss: 0.718 Vali Loss: 1.330 Vali Acc: 0.530 Test Loss: 1.330 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8178856372833252
Epoch: 16, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.162 Vali Acc: 0.510 Test Loss: 1.162 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.927983283996582
Epoch: 17, Steps: 20 | Train Loss: 1.382 Vali Loss: 2.952 Vali Acc: 0.490 Test Loss: 2.952 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9252731800079346
Epoch: 18, Steps: 20 | Train Loss: 1.073 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7414250373840332
Epoch: 19, Steps: 20 | Train Loss: 0.950 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9891705513000488
Epoch: 20, Steps: 20 | Train Loss: 0.904 Vali Loss: 1.383 Vali Acc: 0.490 Test Loss: 1.383 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1174306869506836
Epoch: 21, Steps: 20 | Train Loss: 0.947 Vali Loss: 1.014 Vali Acc: 0.550 Test Loss: 1.014 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6118066310882568
Epoch: 22, Steps: 20 | Train Loss: 1.181 Vali Loss: 0.935 Vali Acc: 0.610 Test Loss: 0.935 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.00107479095459
Epoch: 23, Steps: 20 | Train Loss: 2.103 Vali Loss: 1.025 Vali Acc: 0.620 Test Loss: 1.025 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619990).  Saving model ...
Epoch: 24 cost time: 1.952977180480957
Epoch: 24, Steps: 20 | Train Loss: 1.308 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.793163776397705
Epoch: 25, Steps: 20 | Train Loss: 0.654 Vali Loss: 2.194 Vali Acc: 0.520 Test Loss: 2.194 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8700335025787354
Epoch: 26, Steps: 20 | Train Loss: 0.946 Vali Loss: 3.222 Vali Acc: 0.520 Test Loss: 3.222 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8522765636444092
Epoch: 27, Steps: 20 | Train Loss: 1.402 Vali Loss: 1.173 Vali Acc: 0.540 Test Loss: 1.173 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8438520431518555
Epoch: 28, Steps: 20 | Train Loss: 1.118 Vali Loss: 4.185 Vali Acc: 0.500 Test Loss: 4.185 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.623854160308838
Epoch: 29, Steps: 20 | Train Loss: 2.420 Vali Loss: 2.523 Vali Acc: 0.510 Test Loss: 2.523 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8623967170715332
Epoch: 30, Steps: 20 | Train Loss: 1.448 Vali Loss: 1.203 Vali Acc: 0.630 Test Loss: 1.203 Test Acc: 0.630
Validation loss decreased (-0.619990 --> -0.629988).  Saving model ...
Epoch: 31 cost time: 1.8778395652770996
Epoch: 31, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.360 Vali Acc: 0.580 Test Loss: 1.360 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7638819217681885
Epoch: 32, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.496 Vali Acc: 0.600 Test Loss: 1.496 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8245849609375
Epoch: 33, Steps: 20 | Train Loss: 1.169 Vali Loss: 1.460 Vali Acc: 0.530 Test Loss: 1.460 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8637542724609375
Epoch: 34, Steps: 20 | Train Loss: 1.227 Vali Loss: 3.242 Vali Acc: 0.500 Test Loss: 3.242 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9114205837249756
Epoch: 35, Steps: 20 | Train Loss: 1.402 Vali Loss: 1.936 Vali Acc: 0.540 Test Loss: 1.936 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9838392734527588
Epoch: 36, Steps: 20 | Train Loss: 1.051 Vali Loss: 4.135 Vali Acc: 0.540 Test Loss: 4.135 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.016202211380005
Epoch: 37, Steps: 20 | Train Loss: 1.214 Vali Loss: 1.960 Vali Acc: 0.610 Test Loss: 1.960 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.006575107574463
Epoch: 38, Steps: 20 | Train Loss: 0.926 Vali Loss: 2.445 Vali Acc: 0.480 Test Loss: 2.445 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2141916751861572
Epoch: 39, Steps: 20 | Train Loss: 0.968 Vali Loss: 4.074 Vali Acc: 0.510 Test Loss: 4.074 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.693420648574829
Epoch: 40, Steps: 20 | Train Loss: 1.045 Vali Loss: 2.778 Vali Acc: 0.500 Test Loss: 2.778 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3682842
model size : 19.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.688343048095703
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.895 Vali Acc: 0.430 Test Loss: 0.895 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 1.4165828227996826
Epoch: 2, Steps: 20 | Train Loss: 0.906 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.429991 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 1.9652230739593506
Epoch: 3, Steps: 20 | Train Loss: 0.818 Vali Loss: 1.459 Vali Acc: 0.450 Test Loss: 1.459 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8993659019470215
Epoch: 4, Steps: 20 | Train Loss: 0.996 Vali Loss: 1.125 Vali Acc: 0.460 Test Loss: 1.125 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9065051078796387
Epoch: 5, Steps: 20 | Train Loss: 0.959 Vali Loss: 1.166 Vali Acc: 0.490 Test Loss: 1.166 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.946631908416748
Epoch: 6, Steps: 20 | Train Loss: 0.963 Vali Loss: 0.854 Vali Acc: 0.500 Test Loss: 0.854 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6594412326812744
Epoch: 7, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.754028558731079
Epoch: 8, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.992 Vali Acc: 0.510 Test Loss: 0.992 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.088850736618042
Epoch: 9, Steps: 20 | Train Loss: 1.276 Vali Loss: 2.677 Vali Acc: 0.510 Test Loss: 2.677 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8808321952819824
Epoch: 10, Steps: 20 | Train Loss: 1.034 Vali Loss: 1.723 Vali Acc: 0.480 Test Loss: 1.723 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.063018321990967
Epoch: 11, Steps: 20 | Train Loss: 1.212 Vali Loss: 1.636 Vali Acc: 0.490 Test Loss: 1.636 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.035939931869507
Epoch: 12, Steps: 20 | Train Loss: 1.143 Vali Loss: 2.019 Vali Acc: 0.490 Test Loss: 2.019 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3681562
model size : 18.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1532092094421387
Epoch: 1, Steps: 20 | Train Loss: 0.944 Vali Loss: 1.044 Vali Acc: 0.490 Test Loss: 1.044 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 1.793456792831421
Epoch: 2, Steps: 20 | Train Loss: 1.208 Vali Loss: 0.978 Vali Acc: 0.500 Test Loss: 0.978 Test Acc: 0.500
Validation loss decreased (-0.489990 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 1.8484838008880615
Epoch: 3, Steps: 20 | Train Loss: 0.884 Vali Loss: 1.122 Vali Acc: 0.520 Test Loss: 1.122 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519989).  Saving model ...
Epoch: 4 cost time: 1.7527518272399902
Epoch: 4, Steps: 20 | Train Loss: 0.921 Vali Loss: 0.856 Vali Acc: 0.460 Test Loss: 0.856 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7927560806274414
Epoch: 5, Steps: 20 | Train Loss: 1.101 Vali Loss: 0.923 Vali Acc: 0.510 Test Loss: 0.923 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9578449726104736
Epoch: 6, Steps: 20 | Train Loss: 1.430 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6117136478424072
Epoch: 7, Steps: 20 | Train Loss: 1.101 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.8904712200164795
Epoch: 8, Steps: 20 | Train Loss: 1.048 Vali Loss: 0.934 Vali Acc: 0.620 Test Loss: 0.934 Test Acc: 0.620
Validation loss decreased (-0.549992 --> -0.619991).  Saving model ...
Epoch: 9 cost time: 1.8311805725097656
Epoch: 9, Steps: 20 | Train Loss: 1.142 Vali Loss: 1.478 Vali Acc: 0.510 Test Loss: 1.478 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9536099433898926
Epoch: 10, Steps: 20 | Train Loss: 1.425 Vali Loss: 1.064 Vali Acc: 0.530 Test Loss: 1.064 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8573024272918701
Epoch: 11, Steps: 20 | Train Loss: 1.497 Vali Loss: 1.163 Vali Acc: 0.470 Test Loss: 1.163 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7749767303466797
Epoch: 12, Steps: 20 | Train Loss: 1.162 Vali Loss: 1.486 Vali Acc: 0.520 Test Loss: 1.486 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.849557638168335
Epoch: 13, Steps: 20 | Train Loss: 1.332 Vali Loss: 2.028 Vali Acc: 0.480 Test Loss: 2.028 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4940557479858398
Epoch: 14, Steps: 20 | Train Loss: 0.827 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.01145601272583
Epoch: 15, Steps: 20 | Train Loss: 0.819 Vali Loss: 1.932 Vali Acc: 0.480 Test Loss: 1.932 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9443209171295166
Epoch: 16, Steps: 20 | Train Loss: 1.248 Vali Loss: 3.613 Vali Acc: 0.490 Test Loss: 3.613 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7806332111358643
Epoch: 17, Steps: 20 | Train Loss: 1.176 Vali Loss: 1.693 Vali Acc: 0.490 Test Loss: 1.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8925201892852783
Epoch: 18, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.144 Vali Acc: 0.480 Test Loss: 1.144 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3680282
model size : 18.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0319275856018066
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.067549705505371
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.957 Vali Acc: 0.510 Test Loss: 0.957 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0871329307556152
Epoch: 3, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.190437078475952
Epoch: 4, Steps: 20 | Train Loss: 1.120 Vali Loss: 1.334 Vali Acc: 0.510 Test Loss: 1.334 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0402190685272217
Epoch: 5, Steps: 20 | Train Loss: 1.427 Vali Loss: 1.354 Vali Acc: 0.450 Test Loss: 1.354 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0150816440582275
Epoch: 6, Steps: 20 | Train Loss: 1.068 Vali Loss: 1.412 Vali Acc: 0.460 Test Loss: 1.412 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1091883182525635
Epoch: 7, Steps: 20 | Train Loss: 1.436 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6285114288330078
Epoch: 8, Steps: 20 | Train Loss: 1.121 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0176992416381836
Epoch: 9, Steps: 20 | Train Loss: 0.826 Vali Loss: 0.980 Vali Acc: 0.570 Test Loss: 0.980 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569990).  Saving model ...
Epoch: 10 cost time: 1.9791982173919678
Epoch: 10, Steps: 20 | Train Loss: 0.769 Vali Loss: 1.425 Vali Acc: 0.510 Test Loss: 1.425 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0652780532836914
Epoch: 11, Steps: 20 | Train Loss: 1.327 Vali Loss: 1.031 Vali Acc: 0.490 Test Loss: 1.031 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0253753662109375
Epoch: 12, Steps: 20 | Train Loss: 1.202 Vali Loss: 1.192 Vali Acc: 0.490 Test Loss: 1.192 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.088446855545044
Epoch: 13, Steps: 20 | Train Loss: 1.342 Vali Loss: 1.010 Vali Acc: 0.540 Test Loss: 1.010 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0749449729919434
Epoch: 14, Steps: 20 | Train Loss: 1.196 Vali Loss: 1.211 Vali Acc: 0.530 Test Loss: 1.211 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9390335083007812
Epoch: 15, Steps: 20 | Train Loss: 1.015 Vali Loss: 0.904 Vali Acc: 0.590 Test Loss: 0.904 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589991).  Saving model ...
Epoch: 16 cost time: 1.9742441177368164
Epoch: 16, Steps: 20 | Train Loss: 1.163 Vali Loss: 2.656 Vali Acc: 0.490 Test Loss: 2.656 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.928957462310791
Epoch: 17, Steps: 20 | Train Loss: 1.332 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6651573181152344
Epoch: 18, Steps: 20 | Train Loss: 1.093 Vali Loss: 1.192 Vali Acc: 0.530 Test Loss: 1.192 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1340441703796387
Epoch: 19, Steps: 20 | Train Loss: 0.849 Vali Loss: 1.110 Vali Acc: 0.530 Test Loss: 1.110 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.156798839569092
Epoch: 20, Steps: 20 | Train Loss: 0.964 Vali Loss: 1.669 Vali Acc: 0.470 Test Loss: 1.669 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8183512687683105
Epoch: 21, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.856 Vali Acc: 0.560 Test Loss: 0.856 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0846378803253174
Epoch: 22, Steps: 20 | Train Loss: 1.542 Vali Loss: 2.114 Vali Acc: 0.490 Test Loss: 2.114 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7186367511749268
Epoch: 23, Steps: 20 | Train Loss: 1.171 Vali Loss: 0.982 Vali Acc: 0.530 Test Loss: 0.982 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2154271602630615
Epoch: 24, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.775324821472168
Epoch: 25, Steps: 20 | Train Loss: 1.346 Vali Loss: 1.921 Vali Acc: 0.520 Test Loss: 1.921 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3487130
model size : 18.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1699106693267822
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.940 Vali Acc: 0.500 Test Loss: 0.940 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.181751012802124
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.812 Vali Acc: 0.610 Test Loss: 0.812 Test Acc: 0.610
Validation loss decreased (-0.499991 --> -0.609992).  Saving model ...
Epoch: 3 cost time: 1.662259817123413
Epoch: 3, Steps: 20 | Train Loss: 0.950 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6711251735687256
Epoch: 4, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7552638053894043
Epoch: 5, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.875 Vali Acc: 0.480 Test Loss: 0.875 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.719679594039917
Epoch: 6, Steps: 20 | Train Loss: 0.943 Vali Loss: 1.131 Vali Acc: 0.520 Test Loss: 1.131 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6386868953704834
Epoch: 7, Steps: 20 | Train Loss: 0.903 Vali Loss: 1.332 Vali Acc: 0.490 Test Loss: 1.332 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3213376998901367
Epoch: 8, Steps: 20 | Train Loss: 1.175 Vali Loss: 1.402 Vali Acc: 0.520 Test Loss: 1.402 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7967166900634766
Epoch: 9, Steps: 20 | Train Loss: 1.042 Vali Loss: 1.219 Vali Acc: 0.440 Test Loss: 1.219 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6915555000305176
Epoch: 10, Steps: 20 | Train Loss: 1.052 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0283830165863037
Epoch: 11, Steps: 20 | Train Loss: 0.882 Vali Loss: 0.885 Vali Acc: 0.460 Test Loss: 0.885 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7691502571105957
Epoch: 12, Steps: 20 | Train Loss: 1.123 Vali Loss: 0.915 Vali Acc: 0.540 Test Loss: 0.915 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3485850
model size : 18.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.575096368789673
Epoch: 1, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.1077823638916016
Epoch: 2, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
Validation loss decreased (-0.499991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 1.3961060047149658
Epoch: 3, Steps: 20 | Train Loss: 1.070 Vali Loss: 0.931 Vali Acc: 0.490 Test Loss: 0.931 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4465570449829102
Epoch: 4, Steps: 20 | Train Loss: 0.999 Vali Loss: 1.366 Vali Acc: 0.510 Test Loss: 1.366 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3298070430755615
Epoch: 5, Steps: 20 | Train Loss: 0.877 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 1.358793020248413
Epoch: 6, Steps: 20 | Train Loss: 1.092 Vali Loss: 1.142 Vali Acc: 0.530 Test Loss: 1.142 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4650514125823975
Epoch: 7, Steps: 20 | Train Loss: 0.866 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3723268508911133
Epoch: 8, Steps: 20 | Train Loss: 1.110 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1922760009765625
Epoch: 9, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.818 Vali Acc: 0.570 Test Loss: 0.818 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3883726596832275
Epoch: 10, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2444605827331543
Epoch: 11, Steps: 20 | Train Loss: 1.135 Vali Loss: 3.341 Vali Acc: 0.490 Test Loss: 3.341 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.376854419708252
Epoch: 12, Steps: 20 | Train Loss: 1.610 Vali Loss: 1.021 Vali Acc: 0.520 Test Loss: 1.021 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2292873859405518
Epoch: 13, Steps: 20 | Train Loss: 1.094 Vali Loss: 1.219 Vali Acc: 0.480 Test Loss: 1.219 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8257615566253662
Epoch: 14, Steps: 20 | Train Loss: 1.255 Vali Loss: 2.594 Vali Acc: 0.490 Test Loss: 2.594 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9507486820220947
Epoch: 15, Steps: 20 | Train Loss: 1.985 Vali Loss: 2.025 Vali Acc: 0.490 Test Loss: 2.025 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3484570
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4208977222442627
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.873 Vali Acc: 0.470 Test Loss: 0.873 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 1.9465861320495605
Epoch: 2, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.782 Vali Acc: 0.600 Test Loss: 0.782 Test Acc: 0.600
Validation loss decreased (-0.469991 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 1.9105641841888428
Epoch: 3, Steps: 20 | Train Loss: 0.956 Vali Loss: 1.102 Vali Acc: 0.510 Test Loss: 1.102 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8575527667999268
Epoch: 4, Steps: 20 | Train Loss: 0.969 Vali Loss: 1.418 Vali Acc: 0.500 Test Loss: 1.418 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8747899532318115
Epoch: 5, Steps: 20 | Train Loss: 0.941 Vali Loss: 1.733 Vali Acc: 0.490 Test Loss: 1.733 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.804065465927124
Epoch: 6, Steps: 20 | Train Loss: 0.874 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4577360153198242
Epoch: 7, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.79766845703125
Epoch: 8, Steps: 20 | Train Loss: 1.116 Vali Loss: 1.483 Vali Acc: 0.490 Test Loss: 1.483 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8775463104248047
Epoch: 9, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8220291137695312
Epoch: 10, Steps: 20 | Train Loss: 1.136 Vali Loss: 0.779 Vali Acc: 0.570 Test Loss: 0.779 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8478124141693115
Epoch: 11, Steps: 20 | Train Loss: 1.036 Vali Loss: 2.142 Vali Acc: 0.520 Test Loss: 2.142 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7523038387298584
Epoch: 12, Steps: 20 | Train Loss: 1.263 Vali Loss: 1.949 Vali Acc: 0.490 Test Loss: 1.949 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3483290
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4940762519836426
Epoch: 1, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.6662356853485107
Epoch: 2, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.682297945022583
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.663313865661621
Epoch: 4, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509991).  Saving model ...
Epoch: 5 cost time: 1.3456311225891113
Epoch: 5, Steps: 20 | Train Loss: 0.841 Vali Loss: 1.120 Vali Acc: 0.470 Test Loss: 1.120 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7591311931610107
Epoch: 6, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6555027961730957
Epoch: 7, Steps: 20 | Train Loss: 0.833 Vali Loss: 0.750 Vali Acc: 0.580 Test Loss: 0.750 Test Acc: 0.580
Validation loss decreased (-0.509991 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 1.7686741352081299
Epoch: 8, Steps: 20 | Train Loss: 0.689 Vali Loss: 1.197 Vali Acc: 0.490 Test Loss: 1.197 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.814204216003418
Epoch: 9, Steps: 20 | Train Loss: 1.075 Vali Loss: 1.656 Vali Acc: 0.510 Test Loss: 1.656 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8458364009857178
Epoch: 10, Steps: 20 | Train Loss: 1.020 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7903740406036377
Epoch: 11, Steps: 20 | Train Loss: 0.883 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6071090698242188
Epoch: 12, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.841 Vali Acc: 0.610 Test Loss: 0.841 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 13 cost time: 1.7468743324279785
Epoch: 13, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.790 Vali Acc: 0.590 Test Loss: 0.790 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8082518577575684
Epoch: 14, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.793 Vali Acc: 0.590 Test Loss: 0.793 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3867461681365967
Epoch: 15, Steps: 20 | Train Loss: 0.821 Vali Loss: 1.257 Vali Acc: 0.490 Test Loss: 1.257 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7895357608795166
Epoch: 16, Steps: 20 | Train Loss: 0.892 Vali Loss: 1.081 Vali Acc: 0.500 Test Loss: 1.081 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.745912790298462
Epoch: 17, Steps: 20 | Train Loss: 0.932 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7133760452270508
Epoch: 18, Steps: 20 | Train Loss: 1.231 Vali Loss: 1.056 Vali Acc: 0.560 Test Loss: 1.056 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8592607975006104
Epoch: 19, Steps: 20 | Train Loss: 0.673 Vali Loss: 1.460 Vali Acc: 0.490 Test Loss: 1.460 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1662139892578125
Epoch: 20, Steps: 20 | Train Loss: 0.716 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9292631149291992
Epoch: 21, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.398 Vali Acc: 0.480 Test Loss: 1.398 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6409189701080322
Epoch: 22, Steps: 20 | Train Loss: 0.726 Vali Loss: 2.032 Vali Acc: 0.510 Test Loss: 2.032 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1648154
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8117854595184326
Epoch: 1, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.8527772426605225
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.9304726123809814
Epoch: 3, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.969 Vali Acc: 0.500 Test Loss: 0.969 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5631577968597412
Epoch: 4, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8842413425445557
Epoch: 5, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.793558120727539
Epoch: 6, Steps: 20 | Train Loss: 0.943 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.764704704284668
Epoch: 7, Steps: 20 | Train Loss: 0.874 Vali Loss: 1.177 Vali Acc: 0.490 Test Loss: 1.177 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7899293899536133
Epoch: 8, Steps: 20 | Train Loss: 0.898 Vali Loss: 1.007 Vali Acc: 0.510 Test Loss: 1.007 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3543241024017334
Epoch: 9, Steps: 20 | Train Loss: 1.055 Vali Loss: 0.901 Vali Acc: 0.540 Test Loss: 0.901 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7701702117919922
Epoch: 10, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.042 Vali Acc: 0.490 Test Loss: 1.042 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.827735185623169
Epoch: 11, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.790 Vali Acc: 0.570 Test Loss: 0.790 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 1.670125961303711
Epoch: 12, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7178843021392822
Epoch: 13, Steps: 20 | Train Loss: 0.917 Vali Loss: 2.095 Vali Acc: 0.510 Test Loss: 2.095 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7770366668701172
Epoch: 14, Steps: 20 | Train Loss: 0.958 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.79109525680542
Epoch: 15, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7952933311462402
Epoch: 16, Steps: 20 | Train Loss: 0.752 Vali Loss: 1.047 Vali Acc: 0.460 Test Loss: 1.047 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.894981861114502
Epoch: 17, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0234761238098145
Epoch: 18, Steps: 20 | Train Loss: 0.812 Vali Loss: 1.048 Vali Acc: 0.500 Test Loss: 1.048 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9517197608947754
Epoch: 19, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.993 Vali Acc: 0.520 Test Loss: 0.993 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5034434795379639
Epoch: 20, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9221413135528564
Epoch: 21, Steps: 20 | Train Loss: 0.678 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1647514
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.309255361557007
Epoch: 1, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.4631893634796143
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7726240158081055
Epoch: 3, Steps: 20 | Train Loss: 0.849 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7318053245544434
Epoch: 4, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.884 Vali Acc: 0.470 Test Loss: 0.884 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7471566200256348
Epoch: 5, Steps: 20 | Train Loss: 0.797 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8535408973693848
Epoch: 6, Steps: 20 | Train Loss: 0.904 Vali Loss: 1.728 Vali Acc: 0.490 Test Loss: 1.728 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.743894338607788
Epoch: 7, Steps: 20 | Train Loss: 0.979 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8140556812286377
Epoch: 8, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.766 Vali Acc: 0.610 Test Loss: 0.766 Test Acc: 0.610
Validation loss decreased (-0.519993 --> -0.609992).  Saving model ...
Epoch: 9 cost time: 1.6084790229797363
Epoch: 9, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.598707675933838
Epoch: 10, Steps: 20 | Train Loss: 0.853 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7830414772033691
Epoch: 11, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.785 Vali Acc: 0.600 Test Loss: 0.785 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8056437969207764
Epoch: 12, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5449769496917725
Epoch: 13, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9717395305633545
Epoch: 14, Steps: 20 | Train Loss: 0.784 Vali Loss: 1.684 Vali Acc: 0.500 Test Loss: 1.684 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.939070224761963
Epoch: 15, Steps: 20 | Train Loss: 1.070 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8319027423858643
Epoch: 16, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0823695659637451
Epoch: 17, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.042544364929199
Epoch: 18, Steps: 20 | Train Loss: 1.010 Vali Loss: 1.711 Vali Acc: 0.490 Test Loss: 1.711 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1646874
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3329951763153076
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.6821773052215576
Epoch: 2, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.9576294422149658
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.766 Vali Acc: 0.550 Test Loss: 0.766 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 1.5718138217926025
Epoch: 4, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.941 Vali Acc: 0.510 Test Loss: 0.941 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9171996116638184
Epoch: 5, Steps: 20 | Train Loss: 1.038 Vali Loss: 0.704 Vali Acc: 0.600 Test Loss: 0.704 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 2.0377707481384277
Epoch: 6, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.700 Vali Acc: 0.600 Test Loss: 0.700 Test Acc: 0.600
Validation loss decreased (-0.599993 --> -0.599993).  Saving model ...
Epoch: 7 cost time: 1.9379963874816895
Epoch: 7, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.817 Vali Acc: 0.460 Test Loss: 0.817 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0690762996673584
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 1.166 Vali Acc: 0.450 Test Loss: 1.166 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8648016452789307
Epoch: 9, Steps: 20 | Train Loss: 0.820 Vali Loss: 0.955 Vali Acc: 0.510 Test Loss: 0.955 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9979259967803955
Epoch: 10, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.148132085800171
Epoch: 11, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4281871318817139
Epoch: 12, Steps: 20 | Train Loss: 0.716 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8928983211517334
Epoch: 13, Steps: 20 | Train Loss: 0.807 Vali Loss: 1.613 Vali Acc: 0.490 Test Loss: 1.613 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8409507274627686
Epoch: 14, Steps: 20 | Train Loss: 0.966 Vali Loss: 0.889 Vali Acc: 0.490 Test Loss: 0.889 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0664541721343994
Epoch: 15, Steps: 20 | Train Loss: 0.913 Vali Loss: 2.555 Vali Acc: 0.490 Test Loss: 2.555 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9003679752349854
Epoch: 16, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1646234
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3199522495269775
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.924 Vali Acc: 0.490 Test Loss: 0.924 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 2.0516374111175537
Epoch: 2, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0178070068359375
Epoch: 3, Steps: 20 | Train Loss: 0.817 Vali Loss: 0.914 Vali Acc: 0.500 Test Loss: 0.914 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 2.052034378051758
Epoch: 4, Steps: 20 | Train Loss: 0.970 Vali Loss: 1.432 Vali Acc: 0.490 Test Loss: 1.432 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4896364212036133
Epoch: 5, Steps: 20 | Train Loss: 1.110 Vali Loss: 1.871 Vali Acc: 0.500 Test Loss: 1.871 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.141033887863159
Epoch: 6, Steps: 20 | Train Loss: 1.047 Vali Loss: 0.806 Vali Acc: 0.450 Test Loss: 0.806 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.945542812347412
Epoch: 7, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.922 Vali Acc: 0.490 Test Loss: 0.922 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9487459659576416
Epoch: 8, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
Validation loss decreased (-0.499991 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 1.9730722904205322
Epoch: 9, Steps: 20 | Train Loss: 0.844 Vali Loss: 0.831 Vali Acc: 0.570 Test Loss: 0.831 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.9933702945709229
Epoch: 10, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.311 Vali Acc: 0.510 Test Loss: 1.311 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8940746784210205
Epoch: 11, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.904 Vali Acc: 0.510 Test Loss: 0.904 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9779164791107178
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.760 Vali Acc: 0.600 Test Loss: 0.760 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 13 cost time: 1.6338744163513184
Epoch: 13, Steps: 20 | Train Loss: 0.851 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6587300300598145
Epoch: 14, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9352102279663086
Epoch: 15, Steps: 20 | Train Loss: 1.101 Vali Loss: 0.787 Vali Acc: 0.600 Test Loss: 0.787 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9599971771240234
Epoch: 16, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.947 Vali Acc: 0.500 Test Loss: 0.947 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9199697971343994
Epoch: 17, Steps: 20 | Train Loss: 0.664 Vali Loss: 1.732 Vali Acc: 0.490 Test Loss: 1.732 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8760473728179932
Epoch: 18, Steps: 20 | Train Loss: 1.089 Vali Loss: 1.091 Vali Acc: 0.530 Test Loss: 1.091 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2840099334716797
Epoch: 19, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.857 Vali Acc: 0.500 Test Loss: 0.857 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0215580463409424
Epoch: 20, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.166 Vali Acc: 0.540 Test Loss: 1.166 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0235743522644043
Epoch: 21, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.890 Vali Acc: 0.550 Test Loss: 0.890 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1550960540771484
Epoch: 22, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.994 Vali Acc: 0.540 Test Loss: 0.994 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1253402
model size : 7.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4535281658172607
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.0740649700164795
Epoch: 2, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.262450933456421
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.946981430053711
Epoch: 4, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.803 Vali Acc: 0.580 Test Loss: 0.803 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.9580042362213135
Epoch: 5, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.900 Vali Acc: 0.520 Test Loss: 0.900 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8735332489013672
Epoch: 6, Steps: 20 | Train Loss: 0.716 Vali Loss: 1.007 Vali Acc: 0.510 Test Loss: 1.007 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8160946369171143
Epoch: 7, Steps: 20 | Train Loss: 0.848 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.836219310760498
Epoch: 8, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.995 Vali Acc: 0.510 Test Loss: 0.995 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8504903316497803
Epoch: 9, Steps: 20 | Train Loss: 1.249 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5272619724273682
Epoch: 10, Steps: 20 | Train Loss: 0.904 Vali Loss: 1.373 Vali Acc: 0.470 Test Loss: 1.373 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7635982036590576
Epoch: 11, Steps: 20 | Train Loss: 1.133 Vali Loss: 1.517 Vali Acc: 0.490 Test Loss: 1.517 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.854262113571167
Epoch: 12, Steps: 20 | Train Loss: 0.939 Vali Loss: 1.138 Vali Acc: 0.510 Test Loss: 1.138 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0417022705078125
Epoch: 13, Steps: 20 | Train Loss: 0.911 Vali Loss: 1.165 Vali Acc: 0.490 Test Loss: 1.165 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8075482845306396
Epoch: 14, Steps: 20 | Train Loss: 0.842 Vali Loss: 1.456 Vali Acc: 0.480 Test Loss: 1.456 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1252762
model size : 7.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1219921112060547
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.7907636165618896
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.785386085510254
Epoch: 3, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.749 Vali Acc: 0.590 Test Loss: 0.749 Test Acc: 0.590
Validation loss decreased (-0.499993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 1.7744414806365967
Epoch: 4, Steps: 20 | Train Loss: 0.896 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6953115463256836
Epoch: 5, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.856 Vali Acc: 0.480 Test Loss: 0.856 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.894594669342041
Epoch: 6, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.810 Vali Acc: 0.450 Test Loss: 0.810 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.858583688735962
Epoch: 7, Steps: 20 | Train Loss: 0.873 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.53493332862854
Epoch: 8, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8463037014007568
Epoch: 9, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.540 Vali Acc: 0.510 Test Loss: 1.540 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8248443603515625
Epoch: 10, Steps: 20 | Train Loss: 0.918 Vali Loss: 0.749 Vali Acc: 0.580 Test Loss: 0.749 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7557613849639893
Epoch: 11, Steps: 20 | Train Loss: 0.786 Vali Loss: 1.043 Vali Acc: 0.580 Test Loss: 1.043 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8519887924194336
Epoch: 12, Steps: 20 | Train Loss: 0.840 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8087708950042725
Epoch: 13, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.832 Vali Acc: 0.570 Test Loss: 0.832 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1252122
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1179137229919434
Epoch: 1, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.992 Vali Acc: 0.490 Test Loss: 0.992 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 1.9578709602355957
Epoch: 2, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
Validation loss decreased (-0.489990 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 1.8250093460083008
Epoch: 3, Steps: 20 | Train Loss: 0.848 Vali Loss: 1.003 Vali Acc: 0.490 Test Loss: 1.003 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.651747465133667
Epoch: 4, Steps: 20 | Train Loss: 0.892 Vali Loss: 1.092 Vali Acc: 0.510 Test Loss: 1.092 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509989).  Saving model ...
Epoch: 5 cost time: 1.3709423542022705
Epoch: 5, Steps: 20 | Train Loss: 0.825 Vali Loss: 1.059 Vali Acc: 0.490 Test Loss: 1.059 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9969635009765625
Epoch: 6, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.906240701675415
Epoch: 7, Steps: 20 | Train Loss: 1.184 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
Validation loss decreased (-0.509989 --> -0.539989).  Saving model ...
Epoch: 8 cost time: 1.8873553276062012
Epoch: 8, Steps: 20 | Train Loss: 0.872 Vali Loss: 1.049 Vali Acc: 0.520 Test Loss: 1.049 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7818272113800049
Epoch: 9, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8394670486450195
Epoch: 10, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.923 Vali Acc: 0.520 Test Loss: 0.923 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8405046463012695
Epoch: 11, Steps: 20 | Train Loss: 1.046 Vali Loss: 1.472 Vali Acc: 0.490 Test Loss: 1.472 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.467015266418457
Epoch: 12, Steps: 20 | Train Loss: 0.824 Vali Loss: 1.079 Vali Acc: 0.460 Test Loss: 1.079 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8183374404907227
Epoch: 13, Steps: 20 | Train Loss: 0.783 Vali Loss: 1.334 Vali Acc: 0.520 Test Loss: 1.334 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.805915355682373
Epoch: 14, Steps: 20 | Train Loss: 0.819 Vali Loss: 1.165 Vali Acc: 0.470 Test Loss: 1.165 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3256487846374512
Epoch: 15, Steps: 20 | Train Loss: 0.844 Vali Loss: 2.045 Vali Acc: 0.490 Test Loss: 2.045 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8899202346801758
Epoch: 16, Steps: 20 | Train Loss: 0.952 Vali Loss: 1.245 Vali Acc: 0.510 Test Loss: 1.245 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6612744331359863
Epoch: 17, Steps: 20 | Train Loss: 0.923 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1251482
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2148208618164062
Epoch: 1, Steps: 20 | Train Loss: 0.787 Vali Loss: 1.101 Vali Acc: 0.490 Test Loss: 1.101 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 1.7249014377593994
Epoch: 2, Steps: 20 | Train Loss: 0.963 Vali Loss: 0.756 Vali Acc: 0.430 Test Loss: 0.756 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7801756858825684
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
Validation loss decreased (-0.489989 --> -0.489991).  Saving model ...
Epoch: 4 cost time: 1.7770888805389404
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.8181042671203613
Epoch: 5, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 1.598738431930542
Epoch: 6, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8741943836212158
Epoch: 7, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.336 Vali Acc: 0.510 Test Loss: 1.336 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3764159679412842
Epoch: 8, Steps: 20 | Train Loss: 0.995 Vali Loss: 1.262 Vali Acc: 0.510 Test Loss: 1.262 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6253876686096191
Epoch: 9, Steps: 20 | Train Loss: 0.879 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.764676809310913
Epoch: 10, Steps: 20 | Train Loss: 0.825 Vali Loss: 1.112 Vali Acc: 0.480 Test Loss: 1.112 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.789926528930664
Epoch: 11, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.922 Vali Acc: 0.530 Test Loss: 0.922 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.79386568069458
Epoch: 12, Steps: 20 | Train Loss: 0.872 Vali Loss: 1.342 Vali Acc: 0.490 Test Loss: 1.342 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7231571674346924
Epoch: 13, Steps: 20 | Train Loss: 0.754 Vali Loss: 1.161 Vali Acc: 0.450 Test Loss: 1.161 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7910795211791992
Epoch: 14, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.939 Vali Acc: 0.500 Test Loss: 0.939 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7833518981933594
Epoch: 15, Steps: 20 | Train Loss: 0.823 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1056026
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.140212059020996
Epoch: 1, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.952 Vali Acc: 0.500 Test Loss: 0.952 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 1.7646920680999756
Epoch: 2, Steps: 20 | Train Loss: 0.889 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2774415016174316
Epoch: 3, Steps: 20 | Train Loss: 0.908 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (-0.499990 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.8316876888275146
Epoch: 4, Steps: 20 | Train Loss: 0.861 Vali Loss: 0.950 Vali Acc: 0.470 Test Loss: 0.950 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9718716144561768
Epoch: 5, Steps: 20 | Train Loss: 0.903 Vali Loss: 1.125 Vali Acc: 0.460 Test Loss: 1.125 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9788796901702881
Epoch: 6, Steps: 20 | Train Loss: 0.880 Vali Loss: 1.243 Vali Acc: 0.510 Test Loss: 1.243 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9047393798828125
Epoch: 7, Steps: 20 | Train Loss: 0.948 Vali Loss: 0.951 Vali Acc: 0.470 Test Loss: 0.951 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8445343971252441
Epoch: 8, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.907 Vali Acc: 0.470 Test Loss: 0.907 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.693852424621582
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8674497604370117
Epoch: 10, Steps: 20 | Train Loss: 0.888 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8622915744781494
Epoch: 11, Steps: 20 | Train Loss: 0.772 Vali Loss: 1.113 Vali Acc: 0.480 Test Loss: 1.113 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7343425750732422
Epoch: 12, Steps: 20 | Train Loss: 0.881 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3361358642578125
Epoch: 13, Steps: 20 | Train Loss: 0.812 Vali Loss: 0.930 Vali Acc: 0.450 Test Loss: 0.930 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1055386
model size : 6.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.308903932571411
Epoch: 1, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.3369405269622803
Epoch: 2, Steps: 20 | Train Loss: 0.829 Vali Loss: 1.261 Vali Acc: 0.490 Test Loss: 1.261 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.030042886734009
Epoch: 3, Steps: 20 | Train Loss: 0.839 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0104026794433594
Epoch: 4, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 5 cost time: 1.8742256164550781
Epoch: 5, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.773 Vali Acc: 0.450 Test Loss: 0.773 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7452547550201416
Epoch: 6, Steps: 20 | Train Loss: 0.811 Vali Loss: 1.165 Vali Acc: 0.490 Test Loss: 1.165 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.997685432434082
Epoch: 7, Steps: 20 | Train Loss: 0.789 Vali Loss: 1.340 Vali Acc: 0.480 Test Loss: 1.340 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9735815525054932
Epoch: 8, Steps: 20 | Train Loss: 1.011 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0974550247192383
Epoch: 9, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.965 Vali Acc: 0.490 Test Loss: 0.965 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7246801853179932
Epoch: 10, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.882 Vali Acc: 0.530 Test Loss: 0.882 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529991).  Saving model ...
Epoch: 11 cost time: 1.5999650955200195
Epoch: 11, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.920 Vali Acc: 0.520 Test Loss: 0.920 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2574474811553955
Epoch: 12, Steps: 20 | Train Loss: 1.104 Vali Loss: 1.068 Vali Acc: 0.490 Test Loss: 1.068 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2640860080718994
Epoch: 13, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.895 Vali Acc: 0.520 Test Loss: 0.895 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2973639965057373
Epoch: 14, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539991).  Saving model ...
Epoch: 15 cost time: 1.289409875869751
Epoch: 15, Steps: 20 | Train Loss: 1.022 Vali Loss: 1.797 Vali Acc: 0.480 Test Loss: 1.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3706142902374268
Epoch: 16, Steps: 20 | Train Loss: 0.984 Vali Loss: 0.920 Vali Acc: 0.520 Test Loss: 0.920 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4486889839172363
Epoch: 17, Steps: 20 | Train Loss: 0.982 Vali Loss: 1.182 Vali Acc: 0.530 Test Loss: 1.182 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.331125259399414
Epoch: 18, Steps: 20 | Train Loss: 1.078 Vali Loss: 1.272 Vali Acc: 0.490 Test Loss: 1.272 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3569626808166504
Epoch: 19, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2147409915924072
Epoch: 20, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.395897388458252
Epoch: 21, Steps: 20 | Train Loss: 1.344 Vali Loss: 0.936 Vali Acc: 0.590 Test Loss: 0.936 Test Acc: 0.590
Validation loss decreased (-0.539991 --> -0.589991).  Saving model ...
Epoch: 22 cost time: 1.266824722290039
Epoch: 22, Steps: 20 | Train Loss: 0.782 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8663663864135742
Epoch: 23, Steps: 20 | Train Loss: 0.874 Vali Loss: 1.631 Vali Acc: 0.480 Test Loss: 1.631 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7872817516326904
Epoch: 24, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.052 Vali Acc: 0.510 Test Loss: 1.052 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0406417846679688
Epoch: 25, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0141072273254395
Epoch: 26, Steps: 20 | Train Loss: 0.606 Vali Loss: 1.081 Vali Acc: 0.520 Test Loss: 1.081 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0614869594573975
Epoch: 27, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.041 Vali Acc: 0.460 Test Loss: 1.041 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6841163635253906
Epoch: 28, Steps: 20 | Train Loss: 0.829 Vali Loss: 2.050 Vali Acc: 0.520 Test Loss: 2.050 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7000808715820312
Epoch: 29, Steps: 20 | Train Loss: 0.894 Vali Loss: 1.003 Vali Acc: 0.530 Test Loss: 1.003 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8851609230041504
Epoch: 30, Steps: 20 | Train Loss: 0.612 Vali Loss: 1.172 Vali Acc: 0.530 Test Loss: 1.172 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1920535564422607
Epoch: 31, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.050 Vali Acc: 0.510 Test Loss: 1.050 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1054746
model size : 6.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4712867736816406
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.748 Vali Acc: 0.410 Test Loss: 0.748 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.4499952793121338
Epoch: 2, Steps: 20 | Train Loss: 0.840 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
Validation loss decreased (-0.409993 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 1.8231873512268066
Epoch: 3, Steps: 20 | Train Loss: 0.981 Vali Loss: 1.019 Vali Acc: 0.490 Test Loss: 1.019 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.791558027267456
Epoch: 4, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.7464587688446045
Epoch: 5, Steps: 20 | Train Loss: 0.951 Vali Loss: 0.828 Vali Acc: 0.460 Test Loss: 0.828 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.681061029434204
Epoch: 6, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.979 Vali Acc: 0.480 Test Loss: 0.979 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8537390232086182
Epoch: 7, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.927 Vali Acc: 0.530 Test Loss: 0.927 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 8 cost time: 1.6563925743103027
Epoch: 8, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7443170547485352
Epoch: 9, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3849077224731445
Epoch: 10, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.802 Vali Acc: 0.620 Test Loss: 0.802 Test Acc: 0.620
Validation loss decreased (-0.529991 --> -0.619992).  Saving model ...
Epoch: 11 cost time: 1.7862279415130615
Epoch: 11, Steps: 20 | Train Loss: 0.874 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9391553401947021
Epoch: 12, Steps: 20 | Train Loss: 0.915 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.857389211654663
Epoch: 13, Steps: 20 | Train Loss: 0.905 Vali Loss: 0.923 Vali Acc: 0.560 Test Loss: 0.923 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8326528072357178
Epoch: 14, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7612967491149902
Epoch: 15, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.766486406326294
Epoch: 16, Steps: 20 | Train Loss: 0.893 Vali Loss: 1.550 Vali Acc: 0.490 Test Loss: 1.550 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6966795921325684
Epoch: 17, Steps: 20 | Train Loss: 0.816 Vali Loss: 1.303 Vali Acc: 0.470 Test Loss: 1.303 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2470741271972656
Epoch: 18, Steps: 20 | Train Loss: 0.777 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5666208267211914
Epoch: 19, Steps: 20 | Train Loss: 0.823 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8218626976013184
Epoch: 20, Steps: 20 | Train Loss: 0.835 Vali Loss: 1.443 Vali Acc: 0.450 Test Loss: 1.443 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1054106
model size : 6.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.787686824798584
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.795 Vali Acc: 0.480 Test Loss: 0.795 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.0169756412506104
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.690 Vali Acc: 0.480 Test Loss: 0.690 Test Acc: 0.480
Validation loss decreased (-0.479992 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.8976271152496338
Epoch: 3, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.762 Vali Acc: 0.440 Test Loss: 0.762 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9945018291473389
Epoch: 4, Steps: 20 | Train Loss: 0.803 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.823371171951294
Epoch: 5, Steps: 20 | Train Loss: 0.794 Vali Loss: 1.112 Vali Acc: 0.470 Test Loss: 1.112 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.786376953125
Epoch: 6, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519991).  Saving model ...
Epoch: 7 cost time: 1.8979966640472412
Epoch: 7, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.911 Vali Acc: 0.580 Test Loss: 0.911 Test Acc: 0.580
Validation loss decreased (-0.519991 --> -0.579991).  Saving model ...
Epoch: 8 cost time: 1.8808441162109375
Epoch: 8, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4737153053283691
Epoch: 9, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.841 Vali Acc: 0.480 Test Loss: 0.841 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5706942081451416
Epoch: 10, Steps: 20 | Train Loss: 0.714 Vali Loss: 1.052 Vali Acc: 0.480 Test Loss: 1.052 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8564705848693848
Epoch: 11, Steps: 20 | Train Loss: 0.871 Vali Loss: 0.803 Vali Acc: 0.470 Test Loss: 0.803 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.029456377029419
Epoch: 12, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.990 Vali Acc: 0.490 Test Loss: 0.990 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9120123386383057
Epoch: 13, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.919 Vali Acc: 0.480 Test Loss: 0.919 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8431236743927002
Epoch: 14, Steps: 20 | Train Loss: 0.714 Vali Loss: 1.105 Vali Acc: 0.470 Test Loss: 1.105 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.871243953704834
Epoch: 15, Steps: 20 | Train Loss: 0.853 Vali Loss: 0.841 Vali Acc: 0.540 Test Loss: 0.841 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9398880004882812
Epoch: 16, Steps: 20 | Train Loss: 0.854 Vali Loss: 1.138 Vali Acc: 0.510 Test Loss: 1.138 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2246794700622559
Epoch: 17, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 957338
model size : 6.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1739730834960938
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.837 Vali Acc: 0.490 Test Loss: 0.837 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.6849782466888428
Epoch: 2, Steps: 20 | Train Loss: 0.875 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.2880492210388184
Epoch: 3, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.830374002456665
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.793 Vali Acc: 0.460 Test Loss: 0.793 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7600278854370117
Epoch: 5, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
Validation loss decreased (-0.499989 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.7252357006072998
Epoch: 6, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.940 Vali Acc: 0.480 Test Loss: 0.940 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8068289756774902
Epoch: 7, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8109073638916016
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.756 Vali Acc: 0.580 Test Loss: 0.756 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 1.7845752239227295
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.738 Vali Acc: 0.590 Test Loss: 0.738 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 1.700301170349121
Epoch: 10, Steps: 20 | Train Loss: 0.804 Vali Loss: 1.831 Vali Acc: 0.510 Test Loss: 1.831 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7879929542541504
Epoch: 11, Steps: 20 | Train Loss: 0.908 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9289162158966064
Epoch: 12, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.903 Vali Acc: 0.560 Test Loss: 0.903 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.23637056350708
Epoch: 13, Steps: 20 | Train Loss: 0.940 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.805893898010254
Epoch: 14, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.729 Vali Acc: 0.570 Test Loss: 0.729 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.958573818206787
Epoch: 15, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8606364727020264
Epoch: 16, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.806 Vali Acc: 0.600 Test Loss: 0.806 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 17 cost time: 1.8748719692230225
Epoch: 17, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.274 Vali Acc: 0.510 Test Loss: 1.274 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4337208271026611
Epoch: 18, Steps: 20 | Train Loss: 0.933 Vali Loss: 0.888 Vali Acc: 0.590 Test Loss: 0.888 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8226613998413086
Epoch: 19, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.216 Vali Acc: 0.510 Test Loss: 1.216 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7696795463562012
Epoch: 20, Steps: 20 | Train Loss: 0.871 Vali Loss: 1.772 Vali Acc: 0.520 Test Loss: 1.772 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6484715938568115
Epoch: 21, Steps: 20 | Train Loss: 0.937 Vali Loss: 1.560 Vali Acc: 0.480 Test Loss: 1.560 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.033921957015991
Epoch: 22, Steps: 20 | Train Loss: 0.903 Vali Loss: 1.173 Vali Acc: 0.530 Test Loss: 1.173 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.967806339263916
Epoch: 23, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8456380367279053
Epoch: 24, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.241 Vali Acc: 0.570 Test Loss: 1.241 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9040467739105225
Epoch: 25, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.430 Vali Acc: 0.480 Test Loss: 1.430 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8912951946258545
Epoch: 26, Steps: 20 | Train Loss: 0.797 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 956698
model size : 6.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.141369104385376
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.7836897373199463
Epoch: 2, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3451077938079834
Epoch: 3, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8636462688446045
Epoch: 4, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.874011754989624
Epoch: 5, Steps: 20 | Train Loss: 0.865 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.0970191955566406
Epoch: 6, Steps: 20 | Train Loss: 0.982 Vali Loss: 1.048 Vali Acc: 0.470 Test Loss: 1.048 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9554424285888672
Epoch: 7, Steps: 20 | Train Loss: 0.942 Vali Loss: 1.217 Vali Acc: 0.460 Test Loss: 1.217 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9791600704193115
Epoch: 8, Steps: 20 | Train Loss: 0.982 Vali Loss: 1.251 Vali Acc: 0.470 Test Loss: 1.251 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9331488609313965
Epoch: 9, Steps: 20 | Train Loss: 0.886 Vali Loss: 0.929 Vali Acc: 0.520 Test Loss: 0.929 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5469870567321777
Epoch: 10, Steps: 20 | Train Loss: 0.911 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6870555877685547
Epoch: 11, Steps: 20 | Train Loss: 0.702 Vali Loss: 1.241 Vali Acc: 0.520 Test Loss: 1.241 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.017669677734375
Epoch: 12, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.570897102355957
Epoch: 13, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.848 Vali Acc: 0.460 Test Loss: 0.848 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1198768615722656
Epoch: 14, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6647136211395264
Epoch: 15, Steps: 20 | Train Loss: 0.858 Vali Loss: 1.143 Vali Acc: 0.510 Test Loss: 1.143 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 956058
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.749025344848633
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4868552684783936
Epoch: 2, Steps: 20 | Train Loss: 0.840 Vali Loss: 1.311 Vali Acc: 0.510 Test Loss: 1.311 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509987).  Saving model ...
Epoch: 3 cost time: 1.5003232955932617
Epoch: 3, Steps: 20 | Train Loss: 0.835 Vali Loss: 1.085 Vali Acc: 0.440 Test Loss: 1.085 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.558119297027588
Epoch: 4, Steps: 20 | Train Loss: 0.858 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5281331539154053
Epoch: 5, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.892 Vali Acc: 0.460 Test Loss: 0.892 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.554771900177002
Epoch: 6, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
Validation loss decreased (-0.509987 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 0.9384441375732422
Epoch: 7, Steps: 20 | Train Loss: 1.007 Vali Loss: 0.909 Vali Acc: 0.520 Test Loss: 0.909 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6797308921813965
Epoch: 8, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4547536373138428
Epoch: 9, Steps: 20 | Train Loss: 0.689 Vali Loss: 1.049 Vali Acc: 0.510 Test Loss: 1.049 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5705201625823975
Epoch: 10, Steps: 20 | Train Loss: 0.761 Vali Loss: 1.638 Vali Acc: 0.460 Test Loss: 1.638 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.627030372619629
Epoch: 11, Steps: 20 | Train Loss: 0.939 Vali Loss: 1.913 Vali Acc: 0.490 Test Loss: 1.913 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.635307788848877
Epoch: 12, Steps: 20 | Train Loss: 1.049 Vali Loss: 1.327 Vali Acc: 0.490 Test Loss: 1.327 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.000849485397339
Epoch: 13, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.816 Vali Acc: 0.470 Test Loss: 0.816 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5397233963012695
Epoch: 14, Steps: 20 | Train Loss: 1.125 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.065159320831299
Epoch: 15, Steps: 20 | Train Loss: 1.259 Vali Loss: 0.822 Vali Acc: 0.610 Test Loss: 0.822 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609992).  Saving model ...
Epoch: 16 cost time: 1.69752836227417
Epoch: 16, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.691504716873169
Epoch: 17, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7517995834350586
Epoch: 18, Steps: 20 | Train Loss: 1.013 Vali Loss: 0.912 Vali Acc: 0.520 Test Loss: 0.912 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7744712829589844
Epoch: 19, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.051 Vali Acc: 0.520 Test Loss: 1.051 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8535394668579102
Epoch: 20, Steps: 20 | Train Loss: 0.807 Vali Loss: 1.076 Vali Acc: 0.530 Test Loss: 1.076 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9030227661132812
Epoch: 21, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.939 Vali Acc: 0.450 Test Loss: 0.939 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.895059585571289
Epoch: 22, Steps: 20 | Train Loss: 0.956 Vali Loss: 1.429 Vali Acc: 0.520 Test Loss: 1.429 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.442014217376709
Epoch: 23, Steps: 20 | Train Loss: 1.261 Vali Loss: 0.825 Vali Acc: 0.610 Test Loss: 0.825 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9551072120666504
Epoch: 24, Steps: 20 | Train Loss: 1.067 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.900219202041626
Epoch: 25, Steps: 20 | Train Loss: 0.868 Vali Loss: 2.382 Vali Acc: 0.490 Test Loss: 2.382 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 955418
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1191046237945557
Epoch: 1, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.9276494979858398
Epoch: 2, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.816 Vali Acc: 0.470 Test Loss: 0.816 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0143661499023438
Epoch: 3, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.922672986984253
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9072682857513428
Epoch: 5, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.942 Vali Acc: 0.490 Test Loss: 0.942 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9122552871704102
Epoch: 6, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.778907299041748
Epoch: 7, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.726 Vali Acc: 0.620 Test Loss: 0.726 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619993).  Saving model ...
Epoch: 8 cost time: 1.8987281322479248
Epoch: 8, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.900 Vali Acc: 0.480 Test Loss: 0.900 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9071474075317383
Epoch: 9, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.951 Vali Acc: 0.520 Test Loss: 0.951 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7117209434509277
Epoch: 10, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.973 Vali Acc: 0.520 Test Loss: 0.973 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.007887363433838
Epoch: 11, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0723423957824707
Epoch: 12, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2402215003967285
Epoch: 13, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.055 Vali Acc: 0.490 Test Loss: 1.055 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8457131385803223
Epoch: 14, Steps: 20 | Train Loss: 0.876 Vali Loss: 1.150 Vali Acc: 0.510 Test Loss: 1.150 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9126930236816406
Epoch: 15, Steps: 20 | Train Loss: 0.937 Vali Loss: 0.823 Vali Acc: 0.470 Test Loss: 0.823 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.926044225692749
Epoch: 16, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9424583911895752
Epoch: 17, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 629018
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6572699546813965
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.709 Vali Acc: 0.450 Test Loss: 0.709 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.833785057067871
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 2.0494370460510254
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
Validation loss decreased (-0.469992 --> -0.469993).  Saving model ...
Epoch: 4 cost time: 1.8266966342926025
Epoch: 4, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.742 Vali Acc: 0.440 Test Loss: 0.742 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8326411247253418
Epoch: 5, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 1.6373751163482666
Epoch: 6, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.128 Vali Acc: 0.510 Test Loss: 1.128 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509989).  Saving model ...
Epoch: 7 cost time: 2.0843889713287354
Epoch: 7, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3625962734222412
Epoch: 8, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6163427829742432
Epoch: 9, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
Validation loss decreased (-0.509989 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 1.6059308052062988
Epoch: 10, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6295435428619385
Epoch: 11, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6257898807525635
Epoch: 12, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 13 cost time: 1.2900936603546143
Epoch: 13, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8651647567749023
Epoch: 14, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.750 Vali Acc: 0.590 Test Loss: 0.750 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 1.7403159141540527
Epoch: 15, Steps: 20 | Train Loss: 0.757 Vali Loss: 1.286 Vali Acc: 0.490 Test Loss: 1.286 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3875737190246582
Epoch: 16, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7117435932159424
Epoch: 17, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.845 Vali Acc: 0.550 Test Loss: 0.845 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7222862243652344
Epoch: 18, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7640790939331055
Epoch: 19, Steps: 20 | Train Loss: 0.755 Vali Loss: 1.781 Vali Acc: 0.510 Test Loss: 1.781 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.723487138748169
Epoch: 20, Steps: 20 | Train Loss: 1.122 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7871308326721191
Epoch: 21, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8346092700958252
Epoch: 22, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4179508686065674
Epoch: 23, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.770 Vali Acc: 0.570 Test Loss: 0.770 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.709991216659546
Epoch: 24, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 628698
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.63525652885437
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.715 Vali Acc: 0.430 Test Loss: 0.715 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.6422231197357178
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.837 Vali Acc: 0.460 Test Loss: 0.837 Test Acc: 0.460
Validation loss decreased (-0.429993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.847792148590088
Epoch: 3, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.3958914279937744
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.780 Vali Acc: 0.470 Test Loss: 0.780 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8285937309265137
Epoch: 5, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.765 Vali Acc: 0.440 Test Loss: 0.765 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8061771392822266
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.151 Vali Acc: 0.510 Test Loss: 1.151 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509988).  Saving model ...
Epoch: 7 cost time: 1.7959012985229492
Epoch: 7, Steps: 20 | Train Loss: 0.827 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.978652000427246
Epoch: 8, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8744244575500488
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (-0.509988 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 2.0900766849517822
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4838221073150635
Epoch: 11, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.899554967880249
Epoch: 12, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.996 Vali Acc: 0.490 Test Loss: 0.996 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.649231195449829
Epoch: 13, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.019 Vali Acc: 0.480 Test Loss: 1.019 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7549808025360107
Epoch: 14, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 1.944206953048706
Epoch: 15, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.975 Vali Acc: 0.530 Test Loss: 0.975 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7955467700958252
Epoch: 16, Steps: 20 | Train Loss: 0.925 Vali Loss: 1.382 Vali Acc: 0.460 Test Loss: 1.382 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.761746883392334
Epoch: 17, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.080 Vali Acc: 0.550 Test Loss: 1.080 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4011256694793701
Epoch: 18, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6721277236938477
Epoch: 19, Steps: 20 | Train Loss: 0.729 Vali Loss: 1.187 Vali Acc: 0.530 Test Loss: 1.187 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8514280319213867
Epoch: 20, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.971 Vali Acc: 0.520 Test Loss: 0.971 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3057467937469482
Epoch: 21, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.998443365097046
Epoch: 22, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.839 Vali Acc: 0.470 Test Loss: 0.839 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9103360176086426
Epoch: 23, Steps: 20 | Train Loss: 0.649 Vali Loss: 1.072 Vali Acc: 0.610 Test Loss: 1.072 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609989).  Saving model ...
Epoch: 24 cost time: 2.004704713821411
Epoch: 24, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.923 Vali Acc: 0.480 Test Loss: 0.923 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.86515212059021
Epoch: 25, Steps: 20 | Train Loss: 0.812 Vali Loss: 1.157 Vali Acc: 0.540 Test Loss: 1.157 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3614366054534912
Epoch: 26, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.779125690460205
Epoch: 27, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9119555950164795
Epoch: 28, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.939 Vali Acc: 0.510 Test Loss: 0.939 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.582364797592163
Epoch: 29, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.096 Vali Acc: 0.560 Test Loss: 1.096 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7905242443084717
Epoch: 30, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.013 Vali Acc: 0.550 Test Loss: 1.013 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8018240928649902
Epoch: 31, Steps: 20 | Train Loss: 0.777 Vali Loss: 1.501 Vali Acc: 0.540 Test Loss: 1.501 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7532246112823486
Epoch: 32, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.985 Vali Acc: 0.510 Test Loss: 0.985 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7485032081604004
Epoch: 33, Steps: 20 | Train Loss: 0.607 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 628378
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.126570463180542
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.776 Vali Acc: 0.450 Test Loss: 0.776 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.7777142524719238
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.6917831897735596
Epoch: 3, Steps: 20 | Train Loss: 0.878 Vali Loss: 0.937 Vali Acc: 0.460 Test Loss: 0.937 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6035866737365723
Epoch: 4, Steps: 20 | Train Loss: 0.852 Vali Loss: 1.147 Vali Acc: 0.490 Test Loss: 1.147 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9316270351409912
Epoch: 5, Steps: 20 | Train Loss: 0.907 Vali Loss: 0.948 Vali Acc: 0.510 Test Loss: 0.948 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509991).  Saving model ...
Epoch: 6 cost time: 1.6259324550628662
Epoch: 6, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 1.7320497035980225
Epoch: 7, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8863539695739746
Epoch: 8, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9386494159698486
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9654912948608398
Epoch: 10, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7512104511260986
Epoch: 11, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.818296194076538
Epoch: 12, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3697104454040527
Epoch: 13, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.7776374816894531
Epoch: 14, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8439042568206787
Epoch: 15, Steps: 20 | Train Loss: 0.699 Vali Loss: 1.129 Vali Acc: 0.480 Test Loss: 1.129 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3591060638427734
Epoch: 16, Steps: 20 | Train Loss: 0.761 Vali Loss: 1.504 Vali Acc: 0.520 Test Loss: 1.504 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7379019260406494
Epoch: 17, Steps: 20 | Train Loss: 0.843 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.749748945236206
Epoch: 18, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.164 Vali Acc: 0.510 Test Loss: 1.164 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7065274715423584
Epoch: 19, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.697 Vali Acc: 0.610 Test Loss: 0.697 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 20 cost time: 1.8004424571990967
Epoch: 20, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7746121883392334
Epoch: 21, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.011 Vali Acc: 0.540 Test Loss: 1.011 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8512084484100342
Epoch: 22, Steps: 20 | Train Loss: 0.715 Vali Loss: 1.129 Vali Acc: 0.520 Test Loss: 1.129 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3565633296966553
Epoch: 23, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9135768413543701
Epoch: 24, Steps: 20 | Train Loss: 0.686 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7019541263580322
Epoch: 25, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.012 Vali Acc: 0.520 Test Loss: 1.012 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8045470714569092
Epoch: 26, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.855 Vali Acc: 0.560 Test Loss: 0.855 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7923972606658936
Epoch: 27, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.276 Vali Acc: 0.470 Test Loss: 1.276 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7823846340179443
Epoch: 28, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.027 Vali Acc: 0.540 Test Loss: 1.027 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.770104169845581
Epoch: 29, Steps: 20 | Train Loss: 0.847 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 628058
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0280027389526367
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.675 Vali Acc: 0.520 Test Loss: 0.675 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.7759628295898438
Epoch: 2, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.696 Vali Acc: 0.610 Test Loss: 0.696 Test Acc: 0.610
Validation loss decreased (-0.519993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 1.8920857906341553
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.735318899154663
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.951056718826294
Epoch: 5, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.928 Vali Acc: 0.490 Test Loss: 0.928 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.563528060913086
Epoch: 6, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9016952514648438
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.722 Vali Acc: 0.610 Test Loss: 0.722 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7686426639556885
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8529729843139648
Epoch: 9, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.71431565284729
Epoch: 10, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8192634582519531
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.974 Vali Acc: 0.480 Test Loss: 0.974 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9656119346618652
Epoch: 12, Steps: 20 | Train Loss: 0.832 Vali Loss: 1.112 Vali Acc: 0.520 Test Loss: 1.112 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 430874
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4478719234466553
Epoch: 1, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.9694831371307373
Epoch: 2, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.723799467086792
Epoch: 3, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 1.4907987117767334
Epoch: 4, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.835 Vali Acc: 0.460 Test Loss: 0.835 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9806134700775146
Epoch: 5, Steps: 20 | Train Loss: 0.835 Vali Loss: 1.038 Vali Acc: 0.470 Test Loss: 1.038 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.95420241355896
Epoch: 6, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 1.5623779296875
Epoch: 7, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.944 Vali Acc: 0.420 Test Loss: 0.944 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9362573623657227
Epoch: 8, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.822 Vali Acc: 0.510 Test Loss: 0.822 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 1.796764850616455
Epoch: 9, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.853 Vali Acc: 0.470 Test Loss: 0.853 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.812685251235962
Epoch: 10, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.811 Vali Acc: 0.470 Test Loss: 0.811 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8584537506103516
Epoch: 11, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8865323066711426
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 13 cost time: 1.9198694229125977
Epoch: 13, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0718364715576172
Epoch: 14, Steps: 20 | Train Loss: 0.889 Vali Loss: 1.047 Vali Acc: 0.520 Test Loss: 1.047 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0203938484191895
Epoch: 15, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.027 Vali Acc: 0.520 Test Loss: 1.027 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9554905891418457
Epoch: 16, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 17 cost time: 1.7341675758361816
Epoch: 17, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9471590518951416
Epoch: 18, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9637119770050049
Epoch: 19, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9315669536590576
Epoch: 20, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.834 Vali Acc: 0.490 Test Loss: 0.834 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6195628643035889
Epoch: 21, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.978 Vali Acc: 0.530 Test Loss: 0.978 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9979116916656494
Epoch: 22, Steps: 20 | Train Loss: 0.761 Vali Loss: 1.117 Vali Acc: 0.480 Test Loss: 1.117 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.643812894821167
Epoch: 23, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.869 Vali Acc: 0.530 Test Loss: 0.869 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7535247802734375
Epoch: 24, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.805 Vali Acc: 0.580 Test Loss: 0.805 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 25 cost time: 1.839125633239746
Epoch: 25, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.83650803565979
Epoch: 26, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9558968544006348
Epoch: 27, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.889 Vali Acc: 0.510 Test Loss: 0.889 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.909576416015625
Epoch: 28, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.885 Vali Acc: 0.480 Test Loss: 0.885 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4087660312652588
Epoch: 29, Steps: 20 | Train Loss: 0.730 Vali Loss: 1.338 Vali Acc: 0.510 Test Loss: 1.338 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7621190547943115
Epoch: 30, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.135207414627075
Epoch: 31, Steps: 20 | Train Loss: 0.606 Vali Loss: 1.029 Vali Acc: 0.560 Test Loss: 1.029 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6911754608154297
Epoch: 32, Steps: 20 | Train Loss: 0.696 Vali Loss: 1.180 Vali Acc: 0.520 Test Loss: 1.180 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.949819564819336
Epoch: 33, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.221 Vali Acc: 0.530 Test Loss: 1.221 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9487998485565186
Epoch: 34, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 430554
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5743186473846436
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.9591431617736816
Epoch: 2, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.826 Vali Acc: 0.450 Test Loss: 0.826 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9073238372802734
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8285837173461914
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8366310596466064
Epoch: 5, Steps: 20 | Train Loss: 0.785 Vali Loss: 1.014 Vali Acc: 0.470 Test Loss: 1.014 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7122552394866943
Epoch: 6, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8078386783599854
Epoch: 7, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 8 cost time: 1.7693946361541748
Epoch: 8, Steps: 20 | Train Loss: 0.741 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 9 cost time: 1.3598589897155762
Epoch: 9, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.938 Vali Acc: 0.520 Test Loss: 0.938 Test Acc: 0.520
Validation loss decreased (-0.519990 --> -0.519991).  Saving model ...
Epoch: 10 cost time: 1.9917824268341064
Epoch: 10, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.848 Vali Acc: 0.430 Test Loss: 0.848 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9237711429595947
Epoch: 11, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.904 Vali Acc: 0.490 Test Loss: 0.904 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8781442642211914
Epoch: 12, Steps: 20 | Train Loss: 0.936 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
Validation loss decreased (-0.519991 --> -0.519992).  Saving model ...
Epoch: 13 cost time: 1.875715970993042
Epoch: 13, Steps: 20 | Train Loss: 0.894 Vali Loss: 1.363 Vali Acc: 0.470 Test Loss: 1.363 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8364298343658447
Epoch: 14, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6615252494812012
Epoch: 15, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.441 Vali Acc: 0.490 Test Loss: 1.441 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9086647033691406
Epoch: 16, Steps: 20 | Train Loss: 0.908 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2234129905700684
Epoch: 17, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 18 cost time: 1.6970317363739014
Epoch: 18, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7039227485656738
Epoch: 19, Steps: 20 | Train Loss: 0.844 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6906332969665527
Epoch: 20, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.064 Vali Acc: 0.520 Test Loss: 1.064 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7025995254516602
Epoch: 21, Steps: 20 | Train Loss: 0.724 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.716642141342163
Epoch: 22, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.016 Vali Acc: 0.500 Test Loss: 1.016 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8008956909179688
Epoch: 23, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 24 cost time: 1.874544382095337
Epoch: 24, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.309 Vali Acc: 0.490 Test Loss: 1.309 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.441997766494751
Epoch: 25, Steps: 20 | Train Loss: 0.915 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7936913967132568
Epoch: 26, Steps: 20 | Train Loss: 0.843 Vali Loss: 1.480 Vali Acc: 0.470 Test Loss: 1.480 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2460591793060303
Epoch: 27, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579993).  Saving model ...
Epoch: 28 cost time: 2.0500879287719727
Epoch: 28, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.214 Vali Acc: 0.520 Test Loss: 1.214 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2981104850769043
Epoch: 29, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3811030387878418
Epoch: 30, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2811853885650635
Epoch: 31, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.887 Vali Acc: 0.620 Test Loss: 0.887 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619991).  Saving model ...
Epoch: 32 cost time: 1.2584288120269775
Epoch: 32, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.288344144821167
Epoch: 33, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.964 Vali Acc: 0.540 Test Loss: 0.964 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3187735080718994
Epoch: 34, Steps: 20 | Train Loss: 0.638 Vali Loss: 1.214 Vali Acc: 0.520 Test Loss: 1.214 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2762584686279297
Epoch: 35, Steps: 20 | Train Loss: 0.697 Vali Loss: 2.082 Vali Acc: 0.490 Test Loss: 2.082 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3509166240692139
Epoch: 36, Steps: 20 | Train Loss: 0.805 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7664437294006348
Epoch: 37, Steps: 20 | Train Loss: 0.691 Vali Loss: 1.834 Vali Acc: 0.490 Test Loss: 1.834 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7663052082061768
Epoch: 38, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.974 Vali Acc: 0.540 Test Loss: 0.974 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8750972747802734
Epoch: 39, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8090095520019531
Epoch: 40, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.679 Vali Acc: 0.520 Test Loss: 1.679 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.8007686138153076
Epoch: 41, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.912 Vali Acc: 0.550 Test Loss: 0.912 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 430234
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3973336219787598
Epoch: 1, Steps: 20 | Train Loss: 0.812 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.8352577686309814
Epoch: 2, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6442632675170898
Epoch: 3, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.839 Vali Acc: 0.480 Test Loss: 0.839 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6136059761047363
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.9594929218292236
Epoch: 5, Steps: 20 | Train Loss: 0.790 Vali Loss: 1.084 Vali Acc: 0.490 Test Loss: 1.084 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9158132076263428
Epoch: 6, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8773510456085205
Epoch: 7, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.887 Vali Acc: 0.470 Test Loss: 0.887 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.668597936630249
Epoch: 8, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.809 Vali Acc: 0.460 Test Loss: 0.809 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8197169303894043
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7585644721984863
Epoch: 10, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.706 Vali Acc: 0.600 Test Loss: 0.706 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 1.8903658390045166
Epoch: 11, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.666811227798462
Epoch: 12, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.991 Vali Acc: 0.510 Test Loss: 0.991 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3651244640350342
Epoch: 13, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.688523769378662
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5697135925292969
Epoch: 15, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5522782802581787
Epoch: 16, Steps: 20 | Train Loss: 0.776 Vali Loss: 1.295 Vali Acc: 0.490 Test Loss: 1.295 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.565248966217041
Epoch: 17, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.987 Vali Acc: 0.530 Test Loss: 0.987 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.459998369216919
Epoch: 18, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.964 Vali Acc: 0.520 Test Loss: 0.964 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5710334777832031
Epoch: 19, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.974 Vali Acc: 0.520 Test Loss: 0.974 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8071041107177734
Epoch: 20, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.980 Vali Acc: 0.520 Test Loss: 0.980 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 429914
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.815305471420288
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.5401902198791504
Epoch: 2, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
Validation loss decreased (-0.439993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.8446927070617676
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.981626272201538
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.796 Vali Acc: 0.480 Test Loss: 0.796 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.606846570968628
Epoch: 5, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.820 Vali Acc: 0.460 Test Loss: 0.820 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9744367599487305
Epoch: 6, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 1.758270025253296
Epoch: 7, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8486902713775635
Epoch: 8, Steps: 20 | Train Loss: 0.867 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 9 cost time: 1.875218391418457
Epoch: 9, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.973 Vali Acc: 0.500 Test Loss: 0.973 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4006879329681396
Epoch: 10, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 11 cost time: 1.8576586246490479
Epoch: 11, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.694 Vali Acc: 0.560 Test Loss: 0.694 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.7068839073181152
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 1.024 Vali Acc: 0.500 Test Loss: 1.024 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.811945915222168
Epoch: 13, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.724 Vali Acc: 0.570 Test Loss: 0.724 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.730001449584961
Epoch: 14, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7715590000152588
Epoch: 15, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.695 Vali Acc: 0.600 Test Loss: 0.695 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 16 cost time: 1.7600505352020264
Epoch: 16, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8472533226013184
Epoch: 17, Steps: 20 | Train Loss: 0.819 Vali Loss: 0.934 Vali Acc: 0.520 Test Loss: 0.934 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.116231918334961
Epoch: 18, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9093079566955566
Epoch: 19, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7921736240386963
Epoch: 20, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.732 Vali Acc: 0.600 Test Loss: 0.732 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6814978122711182
Epoch: 21, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7599289417266846
Epoch: 22, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7130491733551025
Epoch: 23, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7836081981658936
Epoch: 24, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.042886257171631
Epoch: 25, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.787 Vali Acc: 0.580 Test Loss: 0.787 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 331802
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.92197847366333
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.9319987297058105
Epoch: 2, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.265622854232788
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6526646614074707
Epoch: 4, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.826 Vali Acc: 0.470 Test Loss: 0.826 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8664093017578125
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.860640525817871
Epoch: 6, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 7 cost time: 1.963200330734253
Epoch: 7, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.8972017765045166
Epoch: 8, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 1.8281676769256592
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.822 Vali Acc: 0.540 Test Loss: 0.822 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.5560965538024902
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.795 Vali Acc: 0.560 Test Loss: 0.795 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 1.9209730625152588
Epoch: 11, Steps: 20 | Train Loss: 0.685 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9069700241088867
Epoch: 12, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0315742492675781
Epoch: 13, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8531146049499512
Epoch: 14, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.751 Vali Acc: 0.630 Test Loss: 0.751 Test Acc: 0.630
Validation loss decreased (-0.559992 --> -0.629992).  Saving model ...
Epoch: 15 cost time: 1.7896616458892822
Epoch: 15, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.731 Vali Acc: 0.610 Test Loss: 0.731 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.837836742401123
Epoch: 16, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9941754341125488
Epoch: 17, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.05322265625
Epoch: 18, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.761 Vali Acc: 0.590 Test Loss: 0.761 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9758756160736084
Epoch: 19, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.769 Vali Acc: 0.620 Test Loss: 0.769 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3325796127319336
Epoch: 20, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.067307710647583
Epoch: 21, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7595789432525635
Epoch: 22, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9257581233978271
Epoch: 23, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.945 Vali Acc: 0.540 Test Loss: 0.945 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.896256923675537
Epoch: 24, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 331482
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4239227771759033
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.9471795558929443
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.7137494087219238
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8496975898742676
Epoch: 4, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8581087589263916
Epoch: 5, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9760847091674805
Epoch: 6, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.839 Vali Acc: 0.480 Test Loss: 0.839 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8183233737945557
Epoch: 7, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.740349292755127
Epoch: 8, Steps: 20 | Train Loss: 0.734 Vali Loss: 1.092 Vali Acc: 0.470 Test Loss: 1.092 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8688948154449463
Epoch: 9, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8187105655670166
Epoch: 10, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8725979328155518
Epoch: 11, Steps: 20 | Train Loss: 0.678 Vali Loss: 1.044 Vali Acc: 0.490 Test Loss: 1.044 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7976770401000977
Epoch: 12, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 331162
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2259647846221924
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.53193998336792
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7136776447296143
Epoch: 3, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.064037322998047
Epoch: 4, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.922 Vali Acc: 0.450 Test Loss: 0.922 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5568673610687256
Epoch: 5, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.5314733982086182
Epoch: 6, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.943 Vali Acc: 0.460 Test Loss: 0.943 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5589165687561035
Epoch: 7, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5315332412719727
Epoch: 8, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.5330450534820557
Epoch: 9, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.783 Vali Acc: 0.460 Test Loss: 0.783 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.427795648574829
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 0.9626505374908447
Epoch: 11, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.6042890548706055
Epoch: 12, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.830 Vali Acc: 0.450 Test Loss: 0.830 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7674059867858887
Epoch: 13, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6816840171813965
Epoch: 14, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7145130634307861
Epoch: 15, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.009 Vali Acc: 0.490 Test Loss: 1.009 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7812490463256836
Epoch: 16, Steps: 20 | Train Loss: 0.697 Vali Loss: 1.092 Vali Acc: 0.490 Test Loss: 1.092 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.715721845626831
Epoch: 17, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.105 Vali Acc: 0.510 Test Loss: 1.105 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7749991416931152
Epoch: 18, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.997 Vali Acc: 0.470 Test Loss: 0.997 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2856266498565674
Epoch: 19, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7803261280059814
Epoch: 20, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6722900867462158
Epoch: 21, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 330842
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.078629970550537
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.4024550914764404
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.750 Vali Acc: 0.450 Test Loss: 0.750 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8354487419128418
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.883 Vali Acc: 0.430 Test Loss: 0.883 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.816974401473999
Epoch: 4, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.8276152610778809
Epoch: 5, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.821 Vali Acc: 0.470 Test Loss: 0.821 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6877899169921875
Epoch: 6, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7837305068969727
Epoch: 7, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7669637203216553
Epoch: 8, Steps: 20 | Train Loss: 0.713 Vali Loss: 1.057 Vali Acc: 0.500 Test Loss: 1.057 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4171123504638672
Epoch: 9, Steps: 20 | Train Loss: 0.889 Vali Loss: 0.983 Vali Acc: 0.490 Test Loss: 0.983 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.71158766746521
Epoch: 10, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 1.7872748374938965
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.843 Vali Acc: 0.450 Test Loss: 0.843 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7820284366607666
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8057260513305664
Epoch: 13, Steps: 20 | Train Loss: 0.691 Vali Loss: 1.230 Vali Acc: 0.480 Test Loss: 1.230 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6665680408477783
Epoch: 14, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.836 Vali Acc: 0.530 Test Loss: 0.836 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8122382164001465
Epoch: 15, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7222418785095215
Epoch: 16, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.798 Vali Acc: 0.480 Test Loss: 0.798 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5100007057189941
Epoch: 17, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.818643569946289
Epoch: 18, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.760972499847412
Epoch: 19, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6985607147216797
Epoch: 20, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.717 Vali Acc: 0.620 Test Loss: 0.717 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619993).  Saving model ...
Epoch: 21 cost time: 1.6729347705841064
Epoch: 21, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.765 Vali Acc: 0.580 Test Loss: 0.765 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6897296905517578
Epoch: 22, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.007 Vali Acc: 0.550 Test Loss: 1.007 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7913708686828613
Epoch: 23, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6310796737670898
Epoch: 24, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5056324005126953
Epoch: 25, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.851 Vali Acc: 0.540 Test Loss: 0.851 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6194767951965332
Epoch: 26, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.330 Vali Acc: 0.520 Test Loss: 1.330 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7811863422393799
Epoch: 27, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.754751205444336
Epoch: 28, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6768529415130615
Epoch: 29, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7785563468933105
Epoch: 30, Steps: 20 | Train Loss: 0.818 Vali Loss: 1.487 Vali Acc: 0.520 Test Loss: 1.487 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 282266
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9398903846740723
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.795 Vali Acc: 0.480 Test Loss: 0.795 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.7885968685150146
Epoch: 2, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.741929054260254
Epoch: 3, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.890 Vali Acc: 0.460 Test Loss: 0.890 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6572315692901611
Epoch: 4, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 1.8461434841156006
Epoch: 5, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.788 Vali Acc: 0.460 Test Loss: 0.788 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.545644998550415
Epoch: 6, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.760 Vali Acc: 0.610 Test Loss: 0.760 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609992).  Saving model ...
Epoch: 7 cost time: 1.7194435596466064
Epoch: 7, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.799 Vali Acc: 0.470 Test Loss: 0.799 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7550601959228516
Epoch: 8, Steps: 20 | Train Loss: 0.754 Vali Loss: 1.221 Vali Acc: 0.510 Test Loss: 1.221 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8136770725250244
Epoch: 9, Steps: 20 | Train Loss: 0.918 Vali Loss: 1.257 Vali Acc: 0.490 Test Loss: 1.257 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.841780662536621
Epoch: 10, Steps: 20 | Train Loss: 0.980 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8316783905029297
Epoch: 11, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.814 Vali Acc: 0.470 Test Loss: 0.814 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8511555194854736
Epoch: 12, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8743438720703125
Epoch: 13, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0960192680358887
Epoch: 14, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.882 Vali Acc: 0.490 Test Loss: 0.882 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9335088729858398
Epoch: 15, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.890 Vali Acc: 0.490 Test Loss: 0.890 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.898498296737671
Epoch: 16, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 281946
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4395647048950195
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.5619115829467773
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.8296124935150146
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.858 Vali Acc: 0.480 Test Loss: 0.858 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479991).  Saving model ...
Epoch: 4 cost time: 1.7446069717407227
Epoch: 4, Steps: 20 | Train Loss: 0.760 Vali Loss: 1.163 Vali Acc: 0.490 Test Loss: 1.163 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489988).  Saving model ...
Epoch: 5 cost time: 1.7981774806976318
Epoch: 5, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
Validation loss decreased (-0.489988 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 1.6654126644134521
Epoch: 6, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.788 Vali Acc: 0.460 Test Loss: 0.788 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8953697681427002
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6581988334655762
Epoch: 8, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.770 Vali Acc: 0.460 Test Loss: 0.770 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5330228805541992
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.864 Vali Acc: 0.470 Test Loss: 0.864 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8215270042419434
Epoch: 10, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7450757026672363
Epoch: 11, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.77824068069458
Epoch: 12, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.918 Vali Acc: 0.500 Test Loss: 0.918 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6995766162872314
Epoch: 13, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.858 Vali Acc: 0.450 Test Loss: 0.858 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7998895645141602
Epoch: 14, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 15 cost time: 1.6712956428527832
Epoch: 15, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.792 Vali Acc: 0.570 Test Loss: 0.792 Test Acc: 0.570
Validation loss decreased (-0.539991 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 1.6707720756530762
Epoch: 16, Steps: 20 | Train Loss: 0.829 Vali Loss: 1.066 Vali Acc: 0.520 Test Loss: 1.066 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5646052360534668
Epoch: 17, Steps: 20 | Train Loss: 0.889 Vali Loss: 1.466 Vali Acc: 0.490 Test Loss: 1.466 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8313381671905518
Epoch: 18, Steps: 20 | Train Loss: 0.796 Vali Loss: 1.284 Vali Acc: 0.490 Test Loss: 1.284 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7457854747772217
Epoch: 19, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8517036437988281
Epoch: 20, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7769775390625
Epoch: 21, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1623759269714355
Epoch: 22, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.92051362991333
Epoch: 23, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.029 Vali Acc: 0.540 Test Loss: 1.029 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9771480560302734
Epoch: 24, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.756 Vali Acc: 0.610 Test Loss: 0.756 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609992).  Saving model ...
Epoch: 25 cost time: 1.2731091976165771
Epoch: 25, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.880 Vali Acc: 0.540 Test Loss: 0.880 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0665783882141113
Epoch: 26, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.101 Vali Acc: 0.480 Test Loss: 1.101 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8543145656585693
Epoch: 27, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7103238105773926
Epoch: 28, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.194 Vali Acc: 0.480 Test Loss: 1.194 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7479116916656494
Epoch: 29, Steps: 20 | Train Loss: 0.730 Vali Loss: 1.025 Vali Acc: 0.500 Test Loss: 1.025 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5836248397827148
Epoch: 30, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.767 Vali Acc: 0.580 Test Loss: 0.767 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.774855613708496
Epoch: 31, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.830540657043457
Epoch: 32, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.458850622177124
Epoch: 33, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.885817289352417
Epoch: 34, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 281626
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5451102256774902
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.692 Vali Acc: 0.590 Test Loss: 0.692 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.1023974418640137
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.828 Vali Acc: 0.450 Test Loss: 0.828 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8470358848571777
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1295526027679443
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.811 Vali Acc: 0.470 Test Loss: 0.811 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9066975116729736
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8791334629058838
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2872655391693115
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7482118606567383
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.699 Vali Acc: 0.580 Test Loss: 0.699 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7478382587432861
Epoch: 9, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2899448871612549
Epoch: 10, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9093189239501953
Epoch: 11, Steps: 20 | Train Loss: 0.771 Vali Loss: 1.147 Vali Acc: 0.480 Test Loss: 1.147 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 281306
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6723413467407227
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.705 Vali Acc: 0.520 Test Loss: 0.705 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.215545654296875
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1496729850769043
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1621263027191162
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1905238628387451
Epoch: 5, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2165043354034424
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1101200580596924
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 1.2242248058319092
Epoch: 8, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3442282676696777
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1835863590240479
Epoch: 10, Steps: 20 | Train Loss: 0.763 Vali Loss: 1.048 Vali Acc: 0.470 Test Loss: 1.048 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.294968843460083
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0764830112457275
Epoch: 12, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.147075891494751
Epoch: 13, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.987 Vali Acc: 0.490 Test Loss: 0.987 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0551888942718506
Epoch: 14, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.187943935394287
Epoch: 15, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 1.1954970359802246
Epoch: 16, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.923 Vali Acc: 0.480 Test Loss: 0.923 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2081260681152344
Epoch: 17, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 18 cost time: 1.169353723526001
Epoch: 18, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1483831405639648
Epoch: 19, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.878 Vali Acc: 0.550 Test Loss: 0.878 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0666756629943848
Epoch: 20, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.852 Vali Acc: 0.490 Test Loss: 0.852 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1389968395233154
Epoch: 21, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.762 Vali Acc: 0.590 Test Loss: 0.762 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 22 cost time: 1.1073627471923828
Epoch: 22, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9279463291168213
Epoch: 23, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1405298709869385
Epoch: 24, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0544705390930176
Epoch: 25, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.846 Vali Acc: 0.550 Test Loss: 0.846 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0160365104675293
Epoch: 26, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.039306402206421
Epoch: 27, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.866 Vali Acc: 0.570 Test Loss: 0.866 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.971266508102417
Epoch: 28, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.837 Vali Acc: 0.580 Test Loss: 0.837 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0417969226837158
Epoch: 29, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.990861177444458
Epoch: 30, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.863 Vali Acc: 0.560 Test Loss: 0.863 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0878071784973145
Epoch: 31, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.924 Vali Acc: 0.550 Test Loss: 0.924 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 266906
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.673064947128296
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.2201926708221436
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1313118934631348
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.017141580581665
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0909650325775146
Epoch: 5, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499990).  Saving model ...
Epoch: 6 cost time: 1.0533835887908936
Epoch: 6, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1664259433746338
Epoch: 7, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0906565189361572
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0329530239105225
Epoch: 9, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519991).  Saving model ...
Epoch: 10 cost time: 1.0023832321166992
Epoch: 10, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 1.007549524307251
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 1.0410146713256836
Epoch: 12, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1185681819915771
Epoch: 13, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.707 Vali Acc: 0.540 Test Loss: 0.707 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9682540893554688
Epoch: 14, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.116184949874878
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589993).  Saving model ...
Epoch: 16 cost time: 0.9626979827880859
Epoch: 16, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0681705474853516
Epoch: 17, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1426043510437012
Epoch: 18, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.992 Vali Acc: 0.450 Test Loss: 0.992 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0630559921264648
Epoch: 19, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.917 Vali Acc: 0.530 Test Loss: 0.917 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9657375812530518
Epoch: 20, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0094618797302246
Epoch: 21, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.843 Vali Acc: 0.550 Test Loss: 0.843 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0775625705718994
Epoch: 22, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.836 Vali Acc: 0.550 Test Loss: 0.836 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9013190269470215
Epoch: 23, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.885 Vali Acc: 0.540 Test Loss: 0.885 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.052077054977417
Epoch: 24, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.198 Vali Acc: 0.490 Test Loss: 1.198 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.013946771621704
Epoch: 25, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 266746
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5464491844177246
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.0097424983978271
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.0883021354675293
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.805 Vali Acc: 0.470 Test Loss: 0.805 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9800386428833008
Epoch: 4, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489991).  Saving model ...
Epoch: 5 cost time: 0.9209096431732178
Epoch: 5, Steps: 20 | Train Loss: 0.797 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.172867774963379
Epoch: 6, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0401341915130615
Epoch: 7, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.887 Vali Acc: 0.490 Test Loss: 0.887 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.10919189453125
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.828 Vali Acc: 0.480 Test Loss: 0.828 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.093569278717041
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0331761837005615
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 0.9969475269317627
Epoch: 11, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0309457778930664
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.220763921737671
Epoch: 13, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0412931442260742
Epoch: 14, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1877472400665283
Epoch: 15, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1505978107452393
Epoch: 16, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.873 Vali Acc: 0.460 Test Loss: 0.873 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1484434604644775
Epoch: 17, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1596214771270752
Epoch: 18, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0522067546844482
Epoch: 19, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 20 cost time: 1.0999305248260498
Epoch: 20, Steps: 20 | Train Loss: 0.655 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0853631496429443
Epoch: 21, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0428223609924316
Epoch: 22, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.073829174041748
Epoch: 23, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1589834690093994
Epoch: 24, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.801 Vali Acc: 0.460 Test Loss: 0.801 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.11716628074646
Epoch: 25, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1421458721160889
Epoch: 26, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.068690299987793
Epoch: 27, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.830 Vali Acc: 0.530 Test Loss: 0.830 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1019508838653564
Epoch: 28, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 29 cost time: 1.1253836154937744
Epoch: 29, Steps: 20 | Train Loss: 0.533 Vali Loss: 1.159 Vali Acc: 0.510 Test Loss: 1.159 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.159862995147705
Epoch: 30, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2579827308654785
Epoch: 31, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2074253559112549
Epoch: 32, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0864629745483398
Epoch: 33, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.912 Vali Acc: 0.490 Test Loss: 0.912 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1425490379333496
Epoch: 34, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.995 Vali Acc: 0.540 Test Loss: 0.995 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1924278736114502
Epoch: 35, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0779387950897217
Epoch: 36, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1069309711456299
Epoch: 37, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.929 Vali Acc: 0.520 Test Loss: 0.929 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0734293460845947
Epoch: 38, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.996 Vali Acc: 0.550 Test Loss: 0.996 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 266586
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6901798248291016
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.1117558479309082
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.0996341705322266
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.158036708831787
Epoch: 4, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0746498107910156
Epoch: 5, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0247669219970703
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.090505838394165
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.766 Vali Acc: 0.490 Test Loss: 0.766 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0288350582122803
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.023230791091919
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.002262830734253
Epoch: 10, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0841443538665771
Epoch: 11, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.10628080368042
Epoch: 12, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 266426
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7863881587982178
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.113062858581543
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.1349339485168457
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1939949989318848
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.749 Vali Acc: 0.560 Test Loss: 0.749 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 0.995180606842041
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.776 Vali Acc: 0.470 Test Loss: 0.776 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0723683834075928
Epoch: 6, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.812 Vali Acc: 0.470 Test Loss: 0.812 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0568456649780273
Epoch: 7, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9885964393615723
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1519651412963867
Epoch: 9, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.850 Vali Acc: 0.430 Test Loss: 0.850 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9400947093963623
Epoch: 10, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0419912338256836
Epoch: 11, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.821 Vali Acc: 0.470 Test Loss: 0.821 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1916959285736084
Epoch: 12, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.735 Vali Acc: 0.570 Test Loss: 0.735 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 1.0572946071624756
Epoch: 13, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0509302616119385
Epoch: 14, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.132002592086792
Epoch: 15, Steps: 20 | Train Loss: 0.698 Vali Loss: 1.081 Vali Acc: 0.490 Test Loss: 1.081 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1846790313720703
Epoch: 16, Steps: 20 | Train Loss: 0.956 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1768486499786377
Epoch: 17, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9606318473815918
Epoch: 18, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.080345630645752
Epoch: 19, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2182176113128662
Epoch: 20, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.880 Vali Acc: 0.470 Test Loss: 0.880 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0943188667297363
Epoch: 21, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.153651475906372
Epoch: 22, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.853 Vali Acc: 0.540 Test Loss: 0.853 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 167066
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3306078910827637
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.0879650115966797
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.988490104675293
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.746 Vali Acc: 0.450 Test Loss: 0.746 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1046638488769531
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.120419979095459
Epoch: 5, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1038095951080322
Epoch: 6, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.799 Vali Acc: 0.470 Test Loss: 0.799 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1868607997894287
Epoch: 7, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.1341426372528076
Epoch: 8, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0758185386657715
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.1333327293395996
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0868442058563232
Epoch: 11, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1391985416412354
Epoch: 12, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3006622791290283
Epoch: 13, Steps: 20 | Train Loss: 0.821 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.107069730758667
Epoch: 14, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1064281463623047
Epoch: 15, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1317801475524902
Epoch: 16, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2047557830810547
Epoch: 17, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.900 Vali Acc: 0.510 Test Loss: 0.900 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.141566276550293
Epoch: 18, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.964 Vali Acc: 0.480 Test Loss: 0.964 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0297987461090088
Epoch: 19, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 166906
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.721428394317627
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.685 Vali Acc: 0.590 Test Loss: 0.685 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.2596447467803955
Epoch: 2, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2622911930084229
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3137776851654053
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1550829410552979
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1149814128875732
Epoch: 6, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4351272583007812
Epoch: 7, Steps: 20 | Train Loss: 0.786 Vali Loss: 1.102 Vali Acc: 0.490 Test Loss: 1.102 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3394172191619873
Epoch: 8, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.263758659362793
Epoch: 9, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.914 Vali Acc: 0.520 Test Loss: 0.914 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.149268627166748
Epoch: 10, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2249903678894043
Epoch: 11, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 166746
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4755985736846924
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.692 Vali Acc: 0.520 Test Loss: 0.692 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.0587043762207031
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.1221094131469727
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0964140892028809
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1033649444580078
Epoch: 5, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0251712799072266
Epoch: 6, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.123551607131958
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.048492431640625
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 1.140855312347412
Epoch: 9, Steps: 20 | Train Loss: 0.797 Vali Loss: 0.819 Vali Acc: 0.470 Test Loss: 0.819 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1354568004608154
Epoch: 10, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.970 Vali Acc: 0.520 Test Loss: 0.970 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2360715866088867
Epoch: 11, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2518770694732666
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.109839677810669
Epoch: 13, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1490614414215088
Epoch: 14, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1589837074279785
Epoch: 15, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1491496562957764
Epoch: 16, Steps: 20 | Train Loss: 0.653 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1521239280700684
Epoch: 17, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0474791526794434
Epoch: 18, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 166586
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5351829528808594
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.686 Vali Acc: 0.580 Test Loss: 0.686 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.1538844108581543
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1478855609893799
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0404772758483887
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.101654291152954
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1291890144348145
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0401062965393066
Epoch: 7, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.886 Vali Acc: 0.500 Test Loss: 0.886 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1054584980010986
Epoch: 8, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2374944686889648
Epoch: 9, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1463942527770996
Epoch: 10, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1682231426239014
Epoch: 11, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 117146
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4948041439056396
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.708 Vali Acc: 0.410 Test Loss: 0.708 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.0478503704071045
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
Validation loss decreased (-0.409993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.026392936706543
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9728453159332275
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9452846050262451
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0000011920928955
Epoch: 6, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.797 Vali Acc: 0.450 Test Loss: 0.797 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.017479419708252
Epoch: 7, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 1.0694208145141602
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.913 Vali Acc: 0.480 Test Loss: 0.913 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0331416130065918
Epoch: 9, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.965 Vali Acc: 0.470 Test Loss: 0.965 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9886345863342285
Epoch: 10, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0382981300354004
Epoch: 11, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1097490787506104
Epoch: 12, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.835 Vali Acc: 0.490 Test Loss: 0.835 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2229716777801514
Epoch: 13, Steps: 20 | Train Loss: 0.672 Vali Loss: 1.079 Vali Acc: 0.490 Test Loss: 1.079 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0641372203826904
Epoch: 14, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9998273849487305
Epoch: 15, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 16 cost time: 1.0063121318817139
Epoch: 16, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 17 cost time: 1.1480891704559326
Epoch: 17, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0200636386871338
Epoch: 18, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.780 Vali Acc: 0.490 Test Loss: 0.780 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0512473583221436
Epoch: 19, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9598019123077393
Epoch: 20, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 21 cost time: 0.9608569145202637
Epoch: 21, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.758 Vali Acc: 0.590 Test Loss: 0.758 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 22 cost time: 1.0546975135803223
Epoch: 22, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0321192741394043
Epoch: 23, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0620198249816895
Epoch: 24, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.02687668800354
Epoch: 25, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0717880725860596
Epoch: 26, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0720999240875244
Epoch: 27, Steps: 20 | Train Loss: 0.664 Vali Loss: 1.038 Vali Acc: 0.490 Test Loss: 1.038 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0372724533081055
Epoch: 28, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0743701457977295
Epoch: 29, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1236002445220947
Epoch: 30, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.803 Vali Acc: 0.560 Test Loss: 0.803 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.157604694366455
Epoch: 31, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 116986
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.484316110610962
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.694 Vali Acc: 0.490 Test Loss: 0.694 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.0170879364013672
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.712 Vali Acc: 0.440 Test Loss: 0.712 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0602021217346191
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.116159439086914
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1155166625976562
Epoch: 5, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0429940223693848
Epoch: 6, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1049771308898926
Epoch: 7, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9935061931610107
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 1.011 Vali Acc: 0.520 Test Loss: 1.011 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0636546611785889
Epoch: 9, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0330145359039307
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2167139053344727
Epoch: 11, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.868 Vali Acc: 0.480 Test Loss: 0.868 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0199759006500244
Epoch: 12, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1283631324768066
Epoch: 13, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.2613844871520996
Epoch: 14, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1092994213104248
Epoch: 15, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1682543754577637
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 17 cost time: 0.9901885986328125
Epoch: 17, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1119256019592285
Epoch: 18, Steps: 20 | Train Loss: 0.838 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 19 cost time: 1.1820032596588135
Epoch: 19, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 20 cost time: 1.2767863273620605
Epoch: 20, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1655468940734863
Epoch: 21, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1497013568878174
Epoch: 22, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1149497032165527
Epoch: 23, Steps: 20 | Train Loss: 0.643 Vali Loss: 1.049 Vali Acc: 0.490 Test Loss: 1.049 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.217391014099121
Epoch: 24, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 25 cost time: 1.1674249172210693
Epoch: 25, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.745 Vali Acc: 0.620 Test Loss: 0.745 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619993).  Saving model ...
Epoch: 26 cost time: 1.099675178527832
Epoch: 26, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0683491230010986
Epoch: 27, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.763 Vali Acc: 0.600 Test Loss: 0.763 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1064231395721436
Epoch: 28, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.181647777557373
Epoch: 29, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0798511505126953
Epoch: 30, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1064302921295166
Epoch: 31, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.062 Vali Acc: 0.520 Test Loss: 1.062 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.97011399269104
Epoch: 32, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.059758186340332
Epoch: 33, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.097700595855713
Epoch: 34, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.902 Vali Acc: 0.540 Test Loss: 0.902 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8972570896148682
Epoch: 35, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 116826
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.2908055782318115
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.0100593566894531
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
Validation loss decreased (-0.429993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.0799710750579834
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9790694713592529
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.721 Vali Acc: 0.440 Test Loss: 0.721 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.076284408569336
Epoch: 5, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.769 Vali Acc: 0.430 Test Loss: 0.769 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.029850959777832
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0892822742462158
Epoch: 7, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1074278354644775
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.0440449714660645
Epoch: 9, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.836 Vali Acc: 0.440 Test Loss: 0.836 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9476869106292725
Epoch: 10, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.813 Vali Acc: 0.550 Test Loss: 0.813 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 1.0509312152862549
Epoch: 11, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.933089017868042
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.778 Vali Acc: 0.450 Test Loss: 0.778 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9668900966644287
Epoch: 13, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.204552412033081
Epoch: 14, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0162701606750488
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0608985424041748
Epoch: 16, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.008713722229004
Epoch: 17, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1592445373535156
Epoch: 18, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1597039699554443
Epoch: 19, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1603076457977295
Epoch: 20, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 21 cost time: 1.3718087673187256
Epoch: 21, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1692278385162354
Epoch: 22, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1079316139221191
Epoch: 23, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.863 Vali Acc: 0.470 Test Loss: 0.863 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1947367191314697
Epoch: 24, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2938592433929443
Epoch: 25, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.042 Vali Acc: 0.520 Test Loss: 1.042 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.384735345840454
Epoch: 26, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.254291296005249
Epoch: 27, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.339078664779663
Epoch: 28, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1774051189422607
Epoch: 29, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4117813110351562
Epoch: 30, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 116666
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.2510552406311035
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.07082200050354
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.704 Vali Acc: 0.460 Test Loss: 0.704 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0229110717773438
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1112239360809326
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0532760620117188
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.747 Vali Acc: 0.440 Test Loss: 0.747 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1198246479034424
Epoch: 6, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1394054889678955
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1343657970428467
Epoch: 8, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.125096321105957
Epoch: 9, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0884203910827637
Epoch: 10, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.068725824356079
Epoch: 11, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 92186
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6295390129089355
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.717 Vali Acc: 0.420 Test Loss: 0.717 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.1937198638916016
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
Validation loss decreased (-0.419993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.0919947624206543
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469993).  Saving model ...
Epoch: 4 cost time: 1.0792701244354248
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.754 Vali Acc: 0.430 Test Loss: 0.754 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2098877429962158
Epoch: 5, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.785 Vali Acc: 0.470 Test Loss: 0.785 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1981985569000244
Epoch: 6, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.777 Vali Acc: 0.450 Test Loss: 0.777 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1810622215270996
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 8 cost time: 1.157712459564209
Epoch: 8, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1504695415496826
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489993).  Saving model ...
Epoch: 10 cost time: 1.1121327877044678
Epoch: 10, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.789 Vali Acc: 0.490 Test Loss: 0.789 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2173922061920166
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 12 cost time: 1.1377322673797607
Epoch: 12, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.764 Vali Acc: 0.580 Test Loss: 0.764 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 1.2716701030731201
Epoch: 13, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.808 Vali Acc: 0.480 Test Loss: 0.808 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1720855236053467
Epoch: 14, Steps: 20 | Train Loss: 0.759 Vali Loss: 1.022 Vali Acc: 0.490 Test Loss: 1.022 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2564644813537598
Epoch: 15, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.790 Vali Acc: 0.470 Test Loss: 0.790 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2288219928741455
Epoch: 16, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1837499141693115
Epoch: 17, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0512042045593262
Epoch: 18, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1732025146484375
Epoch: 19, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1217515468597412
Epoch: 20, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.703 Vali Acc: 0.600 Test Loss: 0.703 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599993).  Saving model ...
Epoch: 21 cost time: 1.106083631515503
Epoch: 21, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.728 Vali Acc: 0.600 Test Loss: 0.728 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2452595233917236
Epoch: 22, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1395268440246582
Epoch: 23, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0732545852661133
Epoch: 24, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.175398349761963
Epoch: 25, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.813 Vali Acc: 0.570 Test Loss: 0.813 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0993075370788574
Epoch: 26, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2005603313446045
Epoch: 27, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.712 Vali Acc: 0.590 Test Loss: 0.712 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2228543758392334
Epoch: 28, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2351911067962646
Epoch: 29, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.765 Vali Acc: 0.590 Test Loss: 0.765 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1114916801452637
Epoch: 30, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.920 Vali Acc: 0.550 Test Loss: 0.920 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 92026
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4597764015197754
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.689 Vali Acc: 0.520 Test Loss: 0.689 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.8626401424407959
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9158506393432617
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.063251256942749
Epoch: 4, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.721 Vali Acc: 0.420 Test Loss: 0.721 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0192291736602783
Epoch: 5, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.784 Vali Acc: 0.450 Test Loss: 0.784 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0642435550689697
Epoch: 6, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.956082820892334
Epoch: 7, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9842081069946289
Epoch: 8, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0366847515106201
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0902659893035889
Epoch: 10, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0632145404815674
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 91866
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4310061931610107
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.9501748085021973
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.1602835655212402
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.712 Vali Acc: 0.460 Test Loss: 0.712 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0661900043487549
Epoch: 4, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1183454990386963
Epoch: 5, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0160174369812012
Epoch: 6, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1975312232971191
Epoch: 7, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9656169414520264
Epoch: 8, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9753594398498535
Epoch: 9, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0118987560272217
Epoch: 10, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.737 Vali Acc: 0.450 Test Loss: 0.737 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.978959321975708
Epoch: 11, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8066906929016113
Epoch: 12, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 0.9138445854187012
Epoch: 13, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0450148582458496
Epoch: 14, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.803 Vali Acc: 0.450 Test Loss: 0.803 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9578268527984619
Epoch: 15, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8910753726959229
Epoch: 16, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8623559474945068
Epoch: 17, Steps: 20 | Train Loss: 0.671 Vali Loss: 1.004 Vali Acc: 0.490 Test Loss: 1.004 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0248820781707764
Epoch: 18, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.705 Vali Acc: 0.590 Test Loss: 0.705 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 0.9907124042510986
Epoch: 19, Steps: 20 | Train Loss: 0.716 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0369126796722412
Epoch: 20, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0405759811401367
Epoch: 21, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0526847839355469
Epoch: 22, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0735368728637695
Epoch: 23, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.751 Vali Acc: 0.570 Test Loss: 0.751 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.068819522857666
Epoch: 24, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.836 Vali Acc: 0.470 Test Loss: 0.836 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.193624496459961
Epoch: 25, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1949427127838135
Epoch: 26, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.725 Vali Acc: 0.570 Test Loss: 0.725 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.218970775604248
Epoch: 27, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0631871223449707
Epoch: 28, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_Crossformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 91706
model size : 1.03MB
