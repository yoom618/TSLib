Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2367801666259766
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5065932273864746
Epoch: 2, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.364 Vali Acc: 0.425 Test Loss: 1.364 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.48470044136047363
Epoch: 3, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5166828632354736
Epoch: 4, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6487374305725098
Epoch: 5, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.6173427104949951
Epoch: 6, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.549989 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.5414838790893555
Epoch: 7, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.970 Vali Acc: 0.575 Test Loss: 0.970 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5207996368408203
Epoch: 8, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.787 Vali Acc: 0.625 Test Loss: 0.787 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6055564880371094
Epoch: 9, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.765 Vali Acc: 0.650 Test Loss: 0.765 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5870652198791504
Epoch: 10, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.818 Vali Acc: 0.600 Test Loss: 0.818 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5752372741699219
Epoch: 11, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6131110191345215
Epoch: 12, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.742 Vali Acc: 0.675 Test Loss: 0.742 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7418844699859619
Epoch: 13, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.463 Vali Acc: 0.700 Test Loss: 0.463 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5604677200317383
Epoch: 14, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.774991 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.5371735095977783
Epoch: 15, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5772671699523926
Epoch: 16, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.579 Vali Acc: 0.925 Test Loss: 0.579 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5669982433319092
Epoch: 17, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5901374816894531
Epoch: 18, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6081078052520752
Epoch: 19, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5588011741638184
Epoch: 20, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5426406860351562
Epoch: 21, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6709704399108887
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6039936542510986
Epoch: 23, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.603898286819458
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6339952945709229
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6289496421813965
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.602078914642334
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5892355442047119
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 14296896
model size : 59.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2417569160461426
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.492 Vali Acc: 0.250 Test Loss: 1.492 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.8463292121887207
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.458 Vali Acc: 0.350 Test Loss: 1.458 Test Acc: 0.350
Validation loss decreased (-0.249985 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.685253381729126
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.564 Vali Acc: 0.425 Test Loss: 1.564 Test Acc: 0.425
Validation loss decreased (-0.349985 --> -0.424984).  Saving model ...
Epoch: 4 cost time: 0.699286937713623
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.251 Vali Acc: 0.425 Test Loss: 1.251 Test Acc: 0.425
Validation loss decreased (-0.424984 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.9555342197418213
Epoch: 5, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.200 Vali Acc: 0.375 Test Loss: 1.200 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6558103561401367
Epoch: 6, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.071 Vali Acc: 0.525 Test Loss: 1.071 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.6744420528411865
Epoch: 7, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.994 Vali Acc: 0.575 Test Loss: 0.994 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 8 cost time: 0.6454799175262451
Epoch: 8, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.009 Vali Acc: 0.475 Test Loss: 1.009 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6204912662506104
Epoch: 9, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.817 Vali Acc: 0.625 Test Loss: 0.817 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624992).  Saving model ...
Epoch: 10 cost time: 0.6049685478210449
Epoch: 10, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
Validation loss decreased (-0.624992 --> -0.774994).  Saving model ...
Epoch: 11 cost time: 0.6616826057434082
Epoch: 11, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.762 Vali Acc: 0.625 Test Loss: 0.762 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7018253803253174
Epoch: 12, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.720 Vali Acc: 0.825 Test Loss: 0.720 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 0.6694512367248535
Epoch: 13, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.6281518936157227
Epoch: 14, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5923984050750732
Epoch: 15, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6552388668060303
Epoch: 16, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6504440307617188
Epoch: 17, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.7306931018829346
Epoch: 18, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7159759998321533
Epoch: 19, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.5883653163909912
Epoch: 20, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5791819095611572
Epoch: 21, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.677 Vali Acc: 0.875 Test Loss: 0.677 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5838403701782227
Epoch: 22, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5774765014648438
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5905003547668457
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.683279275894165
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5091581344604492
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.643204927444458
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5653822422027588
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5130724906921387
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 14292032
model size : 59.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9496209621429443
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.453 Vali Acc: 0.225 Test Loss: 1.453 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.6214118003845215
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
Validation loss decreased (-0.224985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.7016744613647461
Epoch: 3, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.284 Vali Acc: 0.250 Test Loss: 1.284 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7370226383209229
Epoch: 4, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.150 Vali Acc: 0.475 Test Loss: 1.150 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 0.7679898738861084
Epoch: 5, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.122 Vali Acc: 0.450 Test Loss: 1.122 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7168464660644531
Epoch: 6, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.923 Vali Acc: 0.725 Test Loss: 0.923 Test Acc: 0.725
Validation loss decreased (-0.474989 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.762437105178833
Epoch: 7, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.786 Vali Acc: 0.600 Test Loss: 0.786 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9311192035675049
Epoch: 8, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774993).  Saving model ...
Epoch: 9 cost time: 0.7466235160827637
Epoch: 9, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6603391170501709
Epoch: 10, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6989364624023438
Epoch: 11, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.479 Vali Acc: 0.800 Test Loss: 0.479 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 0.8039288520812988
Epoch: 12, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.503 Vali Acc: 0.725 Test Loss: 0.503 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8191332817077637
Epoch: 13, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8883209228515625
Epoch: 14, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.799995 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.758549690246582
Epoch: 15, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.6495566368103027
Epoch: 16, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.7178709506988525
Epoch: 17, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7052536010742188
Epoch: 18, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7399764060974121
Epoch: 19, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6896812915802002
Epoch: 20, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6824438571929932
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7540602684020996
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6922338008880615
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.691178560256958
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8444375991821289
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7603137493133545
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.925 Test Loss: 0.490 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 14287168
model size : 59.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.238086223602295
Epoch: 1, Steps: 3 | Train Loss: 1.579 Vali Loss: 1.369 Vali Acc: 0.325 Test Loss: 1.369 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6790900230407715
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.310 Vali Acc: 0.475 Test Loss: 1.310 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.8232102394104004
Epoch: 3, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.389 Vali Acc: 0.350 Test Loss: 1.389 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.755488395690918
Epoch: 4, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.160 Vali Acc: 0.450 Test Loss: 1.160 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7359602451324463
Epoch: 5, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.113 Vali Acc: 0.525 Test Loss: 1.113 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.658820629119873
Epoch: 6, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.026 Vali Acc: 0.550 Test Loss: 1.026 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 0.7570366859436035
Epoch: 7, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
Validation loss decreased (-0.549990 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.8332653045654297
Epoch: 8, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.698 Vali Acc: 0.750 Test Loss: 0.698 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6671450138092041
Epoch: 9, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.736 Vali Acc: 0.600 Test Loss: 0.736 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6837639808654785
Epoch: 10, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.767 Vali Acc: 0.625 Test Loss: 0.767 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7377636432647705
Epoch: 11, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.7519540786743164
Epoch: 12, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.548 Vali Acc: 0.675 Test Loss: 0.548 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7073235511779785
Epoch: 13, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.851 Vali Acc: 0.675 Test Loss: 0.851 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.740689754486084
Epoch: 14, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8905379772186279
Epoch: 15, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.506 Vali Acc: 0.650 Test Loss: 0.506 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.711909294128418
Epoch: 16, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.641 Vali Acc: 0.650 Test Loss: 0.641 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8358111381530762
Epoch: 17, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7795336246490479
Epoch: 18, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8418583869934082
Epoch: 19, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.890 Vali Acc: 0.675 Test Loss: 0.890 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7394740581512451
Epoch: 20, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 0.7447352409362793
Epoch: 21, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9791631698608398
Epoch: 22, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.7964913845062256
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.6886963844299316
Epoch: 24, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8099339008331299
Epoch: 25, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.730 Vali Acc: 0.875 Test Loss: 0.730 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6120564937591553
Epoch: 26, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8109567165374756
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8171696662902832
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8401100635528564
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7261168956756592
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7981288433074951
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8186244964599609
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7517082691192627
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 14282304
model size : 59.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.392421245574951
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.7598047256469727
Epoch: 2, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.409 Vali Acc: 0.350 Test Loss: 1.409 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.9767429828643799
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.523 Vali Acc: 0.250 Test Loss: 1.523 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7991740703582764
Epoch: 4, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.321 Vali Acc: 0.475 Test Loss: 1.321 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.8451898097991943
Epoch: 5, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.146 Vali Acc: 0.450 Test Loss: 1.146 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7626712322235107
Epoch: 6, Steps: 3 | Train Loss: 0.924 Vali Loss: 0.970 Vali Acc: 0.575 Test Loss: 0.970 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 0.8800420761108398
Epoch: 7, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.983 Vali Acc: 0.575 Test Loss: 0.983 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8458516597747803
Epoch: 8, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.574990 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.8496766090393066
Epoch: 9, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.635 Vali Acc: 0.775 Test Loss: 0.635 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774994).  Saving model ...
Epoch: 10 cost time: 0.833585262298584
Epoch: 10, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.774994 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.782865047454834
Epoch: 11, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7732434272766113
Epoch: 12, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7298367023468018
Epoch: 13, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.577 Vali Acc: 0.950 Test Loss: 0.577 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.9686546325683594
Epoch: 14, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8167543411254883
Epoch: 15, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8941202163696289
Epoch: 16, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8747169971466064
Epoch: 17, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.832603931427002
Epoch: 18, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8433537483215332
Epoch: 19, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.519 Vali Acc: 0.950 Test Loss: 0.519 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9255263805389404
Epoch: 20, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.7568497657775879
Epoch: 21, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7727947235107422
Epoch: 22, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8090660572052002
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.8617711067199707
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9515612125396729
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.485 Vali Acc: 0.950 Test Loss: 0.485 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.866962194442749
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.519 Vali Acc: 0.950 Test Loss: 0.519 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8001768589019775
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8641726970672607
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8474006652832031
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7209498882293701
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.7750134468078613
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.8204004764556885
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7803893089294434
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7706787586212158
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.876995325088501
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8123552799224854
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.732203483581543
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7174642086029053
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.950 Test Loss: 0.435 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7636549472808838
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8453981876373291
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7711019515991211
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 11932992
model size : 50.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.780325412750244
Epoch: 1, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8497366905212402
Epoch: 2, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.372 Vali Acc: 0.375 Test Loss: 1.372 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8822753429412842
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449985).  Saving model ...
Epoch: 4 cost time: 1.0883779525756836
Epoch: 4, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.292 Vali Acc: 0.475 Test Loss: 1.292 Test Acc: 0.475
Validation loss decreased (-0.449985 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 1.1837215423583984
Epoch: 5, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.9754550457000732
Epoch: 6, Steps: 3 | Train Loss: 0.954 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
Validation loss decreased (-0.549989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.9459831714630127
Epoch: 7, Steps: 3 | Train Loss: 0.759 Vali Loss: 1.079 Vali Acc: 0.775 Test Loss: 1.079 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 0.8939297199249268
Epoch: 8, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.946 Vali Acc: 0.825 Test Loss: 0.946 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.8438599109649658
Epoch: 9, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.724 Vali Acc: 0.625 Test Loss: 0.724 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9786643981933594
Epoch: 10, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.606 Vali Acc: 0.900 Test Loss: 0.606 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.8138611316680908
Epoch: 11, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.924506425857544
Epoch: 12, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9811513423919678
Epoch: 13, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9140775203704834
Epoch: 14, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8141689300537109
Epoch: 15, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.7633988857269287
Epoch: 16, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8721911907196045
Epoch: 17, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8840279579162598
Epoch: 18, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9055173397064209
Epoch: 19, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2212443351745605
Epoch: 20, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8592674732208252
Epoch: 21, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7769136428833008
Epoch: 22, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9180634021759033
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.9907422065734863
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9576117992401123
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8953237533569336
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9775826930999756
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9567725658416748
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9069318771362305
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8109328746795654
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9217574596405029
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9028587341308594
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.925 Test Loss: 0.526 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1607184410095215
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 11928128
model size : 50.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.137348175048828
Epoch: 1, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.377 Vali Acc: 0.450 Test Loss: 1.377 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.7753322124481201
Epoch: 2, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.01181960105896
Epoch: 3, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.276 Vali Acc: 0.375 Test Loss: 1.276 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8812770843505859
Epoch: 4, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.123 Vali Acc: 0.525 Test Loss: 1.123 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.7906317710876465
Epoch: 5, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.9240036010742188
Epoch: 6, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 1.0414097309112549
Epoch: 7, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.986 Vali Acc: 0.525 Test Loss: 0.986 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.917621374130249
Epoch: 8, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.755 Vali Acc: 0.600 Test Loss: 0.755 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9818294048309326
Epoch: 9, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.645 Vali Acc: 0.650 Test Loss: 0.645 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9243226051330566
Epoch: 10, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.564 Vali Acc: 0.725 Test Loss: 0.564 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724994).  Saving model ...
Epoch: 11 cost time: 0.9737253189086914
Epoch: 11, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.724994 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.8436026573181152
Epoch: 12, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.455 Vali Acc: 0.825 Test Loss: 0.455 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9738564491271973
Epoch: 13, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.520 Vali Acc: 0.625 Test Loss: 0.520 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9658634662628174
Epoch: 14, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8160479068756104
Epoch: 15, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.9639697074890137
Epoch: 16, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2228991985321045
Epoch: 17, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8834547996520996
Epoch: 18, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9498653411865234
Epoch: 19, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9505820274353027
Epoch: 20, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8826048374176025
Epoch: 21, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8229455947875977
Epoch: 22, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.819786787033081
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.001260757446289
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9201717376708984
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 11923264
model size : 50.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6614396572113037
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.0273017883300781
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.383 Vali Acc: 0.325 Test Loss: 1.383 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8805928230285645
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.367 Vali Acc: 0.475 Test Loss: 1.367 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.8520979881286621
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.269 Vali Acc: 0.425 Test Loss: 1.269 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8173706531524658
Epoch: 5, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.176 Vali Acc: 0.425 Test Loss: 1.176 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9427688121795654
Epoch: 6, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.161 Vali Acc: 0.575 Test Loss: 1.161 Test Acc: 0.575
Validation loss decreased (-0.474986 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.8376853466033936
Epoch: 7, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.936 Vali Acc: 0.625 Test Loss: 0.936 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624991).  Saving model ...
Epoch: 8 cost time: 0.843801736831665
Epoch: 8, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.847 Vali Acc: 0.600 Test Loss: 0.847 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0633511543273926
Epoch: 9, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.936 Vali Acc: 0.575 Test Loss: 0.936 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0064606666564941
Epoch: 10, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
Validation loss decreased (-0.624991 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.8796639442443848
Epoch: 11, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.604 Vali Acc: 0.625 Test Loss: 0.604 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7807927131652832
Epoch: 12, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.9469091892242432
Epoch: 13, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.670 Vali Acc: 0.675 Test Loss: 0.670 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8471603393554688
Epoch: 14, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.834627628326416
Epoch: 15, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7687983512878418
Epoch: 16, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.456 Vali Acc: 0.700 Test Loss: 0.456 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7964248657226562
Epoch: 17, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.8752682209014893
Epoch: 18, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.723 Vali Acc: 0.825 Test Loss: 0.723 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0339984893798828
Epoch: 19, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.651 Vali Acc: 0.825 Test Loss: 0.651 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8982579708099365
Epoch: 20, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.890690803527832
Epoch: 21, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9539341926574707
Epoch: 22, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9086301326751709
Epoch: 23, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8158490657806396
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8262560367584229
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.8533980846405029
Epoch: 26, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9617898464202881
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.825 Test Loss: 0.686 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.790581226348877
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8260436058044434
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9210686683654785
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8558573722839355
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8288207054138184
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8623771667480469
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8136551380157471
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9091224670410156
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 11918400
model size : 50.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7664990425109863
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.379 Vali Acc: 0.250 Test Loss: 1.379 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9153227806091309
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.285 Vali Acc: 0.375 Test Loss: 1.285 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.9331817626953125
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.934260368347168
Epoch: 4, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.144 Vali Acc: 0.475 Test Loss: 1.144 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 1.1034924983978271
Epoch: 5, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.069 Vali Acc: 0.725 Test Loss: 1.069 Test Acc: 0.725
Validation loss decreased (-0.474989 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 1.114281177520752
Epoch: 6, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.028 Vali Acc: 0.575 Test Loss: 1.028 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9117023944854736
Epoch: 7, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 1.0063519477844238
Epoch: 8, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.821 Vali Acc: 0.575 Test Loss: 0.821 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9110310077667236
Epoch: 9, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.661 Vali Acc: 0.700 Test Loss: 0.661 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1162803173065186
Epoch: 10, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.593 Vali Acc: 0.775 Test Loss: 0.593 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774994).  Saving model ...
Epoch: 11 cost time: 1.0019824504852295
Epoch: 11, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.774994 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.9372327327728271
Epoch: 12, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0059661865234375
Epoch: 13, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.435 Vali Acc: 0.675 Test Loss: 0.435 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9110925197601318
Epoch: 14, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7858221530914307
Epoch: 15, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.412 Vali Acc: 0.775 Test Loss: 0.412 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9201924800872803
Epoch: 16, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.437 Vali Acc: 0.650 Test Loss: 0.437 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1901812553405762
Epoch: 17, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.3153481483459473
Epoch: 18, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1775028705596924
Epoch: 19, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.1126306056976318
Epoch: 20, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9778764247894287
Epoch: 21, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9702918529510498
Epoch: 22, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0423228740692139
Epoch: 23, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9501681327819824
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1256392002105713
Epoch: 25, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1390860080718994
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.8576362133026123
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.9636890888214111
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.044785737991333
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1543054580688477
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2736926078796387
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0971341133117676
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.1603000164031982
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1347002983093262
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9844074249267578
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0582177639007568
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0848314762115479
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0332770347595215
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0822582244873047
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0895655155181885
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2184491157531738
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8386373519897461
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10751040
model size : 46.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.504098653793335
Epoch: 1, Steps: 3 | Train Loss: 1.595 Vali Loss: 1.417 Vali Acc: 0.175 Test Loss: 1.417 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.8640775680541992
Epoch: 2, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.455 Vali Acc: 0.275 Test Loss: 1.455 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.0242688655853271
Epoch: 3, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.708 Vali Acc: 0.250 Test Loss: 1.708 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9920923709869385
Epoch: 4, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
Validation loss decreased (-0.274985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.8350443840026855
Epoch: 5, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.8474178314208984
Epoch: 6, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.399988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7845449447631836
Epoch: 7, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.099 Vali Acc: 0.700 Test Loss: 1.099 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.9847447872161865
Epoch: 8, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.038 Vali Acc: 0.525 Test Loss: 1.038 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.057063341140747
Epoch: 9, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.814 Vali Acc: 0.675 Test Loss: 0.814 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9240086078643799
Epoch: 10, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.686 Vali Acc: 0.650 Test Loss: 0.686 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7638700008392334
Epoch: 11, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8456361293792725
Epoch: 12, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.744 Vali Acc: 0.650 Test Loss: 0.744 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8957388401031494
Epoch: 13, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.656 Vali Acc: 0.650 Test Loss: 0.656 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.865380048751831
Epoch: 14, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.437 Vali Acc: 0.675 Test Loss: 0.437 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7339978218078613
Epoch: 15, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.699989 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.7815794944763184
Epoch: 16, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.9265902042388916
Epoch: 17, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.806159496307373
Epoch: 18, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.371 Vali Acc: 0.800 Test Loss: 0.371 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8058478832244873
Epoch: 19, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8062517642974854
Epoch: 20, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.355 Vali Acc: 0.825 Test Loss: 0.355 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8701815605163574
Epoch: 21, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9134373664855957
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8581957817077637
Epoch: 23, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8380632400512695
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.722 Vali Acc: 0.875 Test Loss: 0.722 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9011034965515137
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8892772197723389
Epoch: 26, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.900 Test Loss: 0.210 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10746176
model size : 46.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.304685592651367
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.347 Vali Acc: 0.275 Test Loss: 1.347 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 1.2124009132385254
Epoch: 2, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.376 Vali Acc: 0.250 Test Loss: 1.376 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9808354377746582
Epoch: 3, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.478 Vali Acc: 0.475 Test Loss: 1.478 Test Acc: 0.475
Validation loss decreased (-0.274987 --> -0.474985).  Saving model ...
Epoch: 4 cost time: 1.044532060623169
Epoch: 4, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.300 Vali Acc: 0.475 Test Loss: 1.300 Test Acc: 0.475
Validation loss decreased (-0.474985 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 1.0610864162445068
Epoch: 5, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9748694896697998
Epoch: 6, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.027 Vali Acc: 0.675 Test Loss: 1.027 Test Acc: 0.675
Validation loss decreased (-0.474987 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 0.9292922019958496
Epoch: 7, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.049 Vali Acc: 0.475 Test Loss: 1.049 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1190741062164307
Epoch: 8, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.929 Vali Acc: 0.525 Test Loss: 0.929 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9737675189971924
Epoch: 9, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774993).  Saving model ...
Epoch: 10 cost time: 1.1024892330169678
Epoch: 10, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.709 Vali Acc: 0.700 Test Loss: 0.709 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1943309307098389
Epoch: 11, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.140216588973999
Epoch: 12, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.521 Vali Acc: 0.650 Test Loss: 0.521 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8907039165496826
Epoch: 13, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0003881454467773
Epoch: 14, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.8322715759277344
Epoch: 15, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0415911674499512
Epoch: 16, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2011466026306152
Epoch: 17, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 1.2604985237121582
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9975841045379639
Epoch: 19, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0364525318145752
Epoch: 20, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9505162239074707
Epoch: 21, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9199206829071045
Epoch: 22, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.867222785949707
Epoch: 23, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1036450862884521
Epoch: 24, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1153812408447266
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0894005298614502
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.120511531829834
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10741312
model size : 46.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6966660022735596
Epoch: 1, Steps: 3 | Train Loss: 1.584 Vali Loss: 1.475 Vali Acc: 0.375 Test Loss: 1.475 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.8494307994842529
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.459 Vali Acc: 0.275 Test Loss: 1.459 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9229161739349365
Epoch: 3, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.697 Vali Acc: 0.250 Test Loss: 1.697 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9159331321716309
Epoch: 4, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8560411930084229
Epoch: 5, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.269 Vali Acc: 0.450 Test Loss: 1.269 Test Acc: 0.450
Validation loss decreased (-0.374985 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.8056321144104004
Epoch: 6, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.8932452201843262
Epoch: 7, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.181 Vali Acc: 0.425 Test Loss: 1.181 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7568836212158203
Epoch: 8, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.7506461143493652
Epoch: 9, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.857 Vali Acc: 0.775 Test Loss: 0.857 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.8403472900390625
Epoch: 10, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.838 Vali Acc: 0.575 Test Loss: 0.838 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8174307346343994
Epoch: 11, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 0.753903865814209
Epoch: 12, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.726 Vali Acc: 0.675 Test Loss: 0.726 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8756873607635498
Epoch: 13, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9363911151885986
Epoch: 14, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.580 Vali Acc: 0.600 Test Loss: 0.580 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8365471363067627
Epoch: 15, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.9233417510986328
Epoch: 16, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.626 Vali Acc: 0.775 Test Loss: 0.626 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.841261625289917
Epoch: 17, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8828442096710205
Epoch: 18, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.849996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.9862661361694336
Epoch: 19, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0711472034454346
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8124356269836426
Epoch: 21, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9648690223693848
Epoch: 22, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.8117444515228271
Epoch: 23, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9004690647125244
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9458673000335693
Epoch: 25, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.890676736831665
Epoch: 26, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.9677672386169434
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9061141014099121
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9287910461425781
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9051220417022705
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.730400562286377
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 32 cost time: 0.8768315315246582
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 33 cost time: 0.9041290283203125
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.900 Test Loss: 0.218 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8534481525421143
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.899998 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.9642825126647949
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9871008396148682
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9856595993041992
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8942136764526367
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8495666980743408
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.904761791229248
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9102485179901123
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8241069316864014
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8229761123657227
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9318907260894775
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10736448
model size : 46.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5352306365966797
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.461 Vali Acc: 0.350 Test Loss: 1.461 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.9008502960205078
Epoch: 2, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.9216902256011963
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.866844892501831
Epoch: 4, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0206217765808105
Epoch: 5, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.330 Vali Acc: 0.450 Test Loss: 1.330 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.0206618309020996
Epoch: 6, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.449987 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.8937907218933105
Epoch: 7, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.979 Vali Acc: 0.625 Test Loss: 0.979 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8902804851531982
Epoch: 8, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7674980163574219
Epoch: 9, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.936 Vali Acc: 0.575 Test Loss: 0.936 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9291622638702393
Epoch: 10, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.770 Vali Acc: 0.600 Test Loss: 0.770 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8953702449798584
Epoch: 11, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.698 Vali Acc: 0.775 Test Loss: 0.698 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 0.8351602554321289
Epoch: 12, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.612 Vali Acc: 0.825 Test Loss: 0.612 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.029634952545166
Epoch: 13, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9464578628540039
Epoch: 14, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.685 Vali Acc: 0.650 Test Loss: 0.685 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8410234451293945
Epoch: 15, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 0.9419360160827637
Epoch: 16, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.8766131401062012
Epoch: 17, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.8877325057983398
Epoch: 18, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8177976608276367
Epoch: 19, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0535259246826172
Epoch: 20, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9233686923980713
Epoch: 21, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0974671840667725
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0337398052215576
Epoch: 23, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.549 Vali Acc: 0.925 Test Loss: 0.549 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9022610187530518
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8840649127960205
Epoch: 25, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9351191520690918
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8107552528381348
Epoch: 27, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.9771225452423096
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.873152494430542
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.060664176940918
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8394725322723389
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9443399906158447
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9642529487609863
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8211791515350342
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.9985535144805908
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8113608360290527
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9372642040252686
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.925 Test Loss: 0.529 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0055248737335205
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.084489107131958
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9329390525817871
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.950 Test Loss: 0.567 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0190908908843994
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.950 Test Loss: 0.534 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9133179187774658
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.950 Test Loss: 0.505 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8715860843658447
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9473223686218262
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 10160064
model size : 43.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.742750883102417
Epoch: 1, Steps: 3 | Train Loss: 1.546 Vali Loss: 1.481 Vali Acc: 0.250 Test Loss: 1.481 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2080662250518799
Epoch: 2, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
Validation loss decreased (-0.249985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.1887900829315186
Epoch: 3, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.277 Vali Acc: 0.325 Test Loss: 1.277 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1037464141845703
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.349986 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.0656585693359375
Epoch: 5, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.0972070693969727
Epoch: 6, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.168 Vali Acc: 0.425 Test Loss: 1.168 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1819140911102295
Epoch: 7, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.934 Vali Acc: 0.575 Test Loss: 0.934 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574991).  Saving model ...
Epoch: 8 cost time: 1.0204377174377441
Epoch: 8, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.850 Vali Acc: 0.700 Test Loss: 0.850 Test Acc: 0.700
Validation loss decreased (-0.574991 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 0.9826781749725342
Epoch: 9, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.851 Vali Acc: 0.600 Test Loss: 0.851 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2560722827911377
Epoch: 10, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.829 Vali Acc: 0.575 Test Loss: 0.829 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.12729811668396
Epoch: 11, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.747 Vali Acc: 0.650 Test Loss: 0.747 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9742472171783447
Epoch: 12, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774994).  Saving model ...
Epoch: 13 cost time: 1.018784761428833
Epoch: 13, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.735 Vali Acc: 0.625 Test Loss: 0.735 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.108548641204834
Epoch: 14, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9235837459564209
Epoch: 15, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 1.0114269256591797
Epoch: 16, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.799995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.9288711547851562
Epoch: 17, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2502946853637695
Epoch: 18, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.0821313858032227
Epoch: 19, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.724 Vali Acc: 0.650 Test Loss: 0.724 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0957419872283936
Epoch: 20, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1556472778320312
Epoch: 21, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.856492280960083
Epoch: 22, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 1.141770601272583
Epoch: 23, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1331043243408203
Epoch: 24, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1441872119903564
Epoch: 25, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0180072784423828
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.016357660293579
Epoch: 27, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.84651780128479
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9386200904846191
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.875 Test Loss: 0.606 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0620689392089844
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.298398733139038
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8999135494232178
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 10155200
model size : 43.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5603206157684326
Epoch: 1, Steps: 3 | Train Loss: 1.578 Vali Loss: 1.532 Vali Acc: 0.275 Test Loss: 1.532 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.6976909637451172
Epoch: 2, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.487 Vali Acc: 0.050 Test Loss: 1.487 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9306306838989258
Epoch: 3, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.378 Vali Acc: 0.225 Test Loss: 1.378 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1375460624694824
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.313 Vali Acc: 0.450 Test Loss: 1.313 Test Acc: 0.450
Validation loss decreased (-0.274985 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.9506237506866455
Epoch: 5, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.2091917991638184
Epoch: 6, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9115910530090332
Epoch: 7, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.181 Vali Acc: 0.525 Test Loss: 1.181 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.8625218868255615
Epoch: 8, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.036 Vali Acc: 0.550 Test Loss: 1.036 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549990).  Saving model ...
Epoch: 9 cost time: 0.8835012912750244
Epoch: 9, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0059220790863037
Epoch: 10, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.817 Vali Acc: 0.625 Test Loss: 0.817 Test Acc: 0.625
Validation loss decreased (-0.549990 --> -0.624992).  Saving model ...
Epoch: 11 cost time: 1.0520820617675781
Epoch: 11, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.855 Vali Acc: 0.575 Test Loss: 0.855 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1273562908172607
Epoch: 12, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.816 Vali Acc: 0.625 Test Loss: 0.816 Test Acc: 0.625
Validation loss decreased (-0.624992 --> -0.624992).  Saving model ...
Epoch: 13 cost time: 1.0630817413330078
Epoch: 13, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
Validation loss decreased (-0.624992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.8818202018737793
Epoch: 14, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.584 Vali Acc: 0.675 Test Loss: 0.584 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8394572734832764
Epoch: 15, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.9205114841461182
Epoch: 16, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0934791564941406
Epoch: 17, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.620 Vali Acc: 0.625 Test Loss: 0.620 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0721640586853027
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0386648178100586
Epoch: 19, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.9654426574707031
Epoch: 20, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.676 Vali Acc: 0.600 Test Loss: 0.676 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0029194355010986
Epoch: 21, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7879242897033691
Epoch: 22, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2220683097839355
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.069960355758667
Epoch: 24, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.8398580551147461
Epoch: 25, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.900 Test Loss: 0.586 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0286524295806885
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.691 Vali Acc: 0.875 Test Loss: 0.691 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9364075660705566
Epoch: 27, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.020498275756836
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8835744857788086
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.018749475479126
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9962692260742188
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0434329509735107
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.980302095413208
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.848639965057373
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10150336
model size : 43.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7329821586608887
Epoch: 1, Steps: 3 | Train Loss: 1.573 Vali Loss: 1.564 Vali Acc: 0.125 Test Loss: 1.564 Test Acc: 0.125
Validation loss decreased (inf --> -0.124984).  Saving model ...
Epoch: 2 cost time: 1.1007177829742432
Epoch: 2, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.499 Vali Acc: 0.100 Test Loss: 1.499 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2462971210479736
Epoch: 3, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.597 Vali Acc: 0.250 Test Loss: 1.597 Test Acc: 0.250
Validation loss decreased (-0.124984 --> -0.249984).  Saving model ...
Epoch: 4 cost time: 1.0975854396820068
Epoch: 4, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.325 Vali Acc: 0.325 Test Loss: 1.325 Test Acc: 0.325
Validation loss decreased (-0.249984 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 1.0137567520141602
Epoch: 5, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.324987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.8390614986419678
Epoch: 6, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8990850448608398
Epoch: 7, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.088 Vali Acc: 0.475 Test Loss: 1.088 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0099437236785889
Epoch: 8, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 0.9136753082275391
Epoch: 9, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.624990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.903902530670166
Epoch: 10, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 1.0175831317901611
Epoch: 11, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.9515669345855713
Epoch: 12, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.1170916557312012
Epoch: 13, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.653 Vali Acc: 0.650 Test Loss: 0.653 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9615721702575684
Epoch: 14, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.9728271961212158
Epoch: 15, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.452 Vali Acc: 0.800 Test Loss: 0.452 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0144414901733398
Epoch: 16, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.9436910152435303
Epoch: 17, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.882897138595581
Epoch: 18, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.523 Vali Acc: 0.750 Test Loss: 0.523 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9984068870544434
Epoch: 19, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0901286602020264
Epoch: 20, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.9811756610870361
Epoch: 21, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1950020790100098
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.957106351852417
Epoch: 23, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8033223152160645
Epoch: 24, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0110580921173096
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.087754726409912
Epoch: 26, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.166100025177002
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3034510612487793
Epoch: 28, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.0881149768829346
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1591331958770752
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.950 Test Loss: 0.624 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.071131944656372
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1107594966888428
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8824260234832764
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.9220025539398193
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1131484508514404
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2227356433868408
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1275644302368164
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0996248722076416
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.260718584060669
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.925 Test Loss: 0.490 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0188088417053223
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.967033863067627
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0043067932128906
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.025986671447754
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.925 Test Loss: 0.515 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 10145472
model size : 43.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.750412702560425
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.406 Vali Acc: 0.225 Test Loss: 1.406 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.0481269359588623
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.402 Vali Acc: 0.175 Test Loss: 1.402 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8965029716491699
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.9877493381500244
Epoch: 4, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.383 Vali Acc: 0.325 Test Loss: 1.383 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.8853256702423096
Epoch: 5, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.816542387008667
Epoch: 6, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.179 Vali Acc: 0.550 Test Loss: 1.179 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 1.0167083740234375
Epoch: 7, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.086 Vali Acc: 0.550 Test Loss: 1.086 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.8511295318603516
Epoch: 8, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.9200255870819092
Epoch: 9, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8601176738739014
Epoch: 10, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.962235689163208
Epoch: 11, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.9973640441894531
Epoch: 12, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.670 Vali Acc: 0.775 Test Loss: 0.670 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 0.7970340251922607
Epoch: 13, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.626 Vali Acc: 0.825 Test Loss: 0.626 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.0716512203216553
Epoch: 14, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.8411517143249512
Epoch: 15, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.9672493934631348
Epoch: 16, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8089168071746826
Epoch: 17, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.8013222217559814
Epoch: 18, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.813096284866333
Epoch: 19, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.901465892791748
Epoch: 20, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2575218677520752
Epoch: 21, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9360907077789307
Epoch: 22, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8880555629730225
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8986215591430664
Epoch: 24, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.98085618019104
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8690495491027832
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7940852642059326
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.604 Vali Acc: 0.825 Test Loss: 0.604 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4793792
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5279524326324463
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.375 Vali Acc: 0.275 Test Loss: 1.375 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9412803649902344
Epoch: 2, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.322 Vali Acc: 0.525 Test Loss: 1.322 Test Acc: 0.525
Validation loss decreased (-0.274986 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.9575860500335693
Epoch: 3, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.313 Vali Acc: 0.325 Test Loss: 1.313 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8439819812774658
Epoch: 4, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0407931804656982
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.348442792892456
Epoch: 6, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9879283905029297
Epoch: 7, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9208524227142334
Epoch: 8, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.9612081050872803
Epoch: 9, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.599990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.8581652641296387
Epoch: 10, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 0.7950477600097656
Epoch: 11, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.0598938465118408
Epoch: 12, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.714 Vali Acc: 0.725 Test Loss: 0.714 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9027366638183594
Epoch: 13, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.648 Vali Acc: 0.625 Test Loss: 0.648 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9357542991638184
Epoch: 14, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.0135364532470703
Epoch: 15, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 0.9928452968597412
Epoch: 16, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.799994 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.9167792797088623
Epoch: 17, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9290492534637451
Epoch: 18, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8934698104858398
Epoch: 19, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8275609016418457
Epoch: 20, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.881096363067627
Epoch: 21, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1521997451782227
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9047389030456543
Epoch: 23, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8144536018371582
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9256832599639893
Epoch: 25, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0918657779693604
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8743746280670166
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9135267734527588
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.727 Vali Acc: 0.825 Test Loss: 0.727 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0188555717468262
Epoch: 29, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0388810634613037
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 4791360
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.42903208732605
Epoch: 1, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.402 Vali Acc: 0.450 Test Loss: 1.402 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 1.2143840789794922
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8994929790496826
Epoch: 3, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.240 Vali Acc: 0.300 Test Loss: 1.240 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0239760875701904
Epoch: 4, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
Validation loss decreased (-0.449986 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 1.0229315757751465
Epoch: 5, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.7561876773834229
Epoch: 6, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7809820175170898
Epoch: 7, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.134 Vali Acc: 0.550 Test Loss: 1.134 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8006925582885742
Epoch: 8, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.914 Vali Acc: 0.675 Test Loss: 0.914 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 0.749828577041626
Epoch: 9, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.8805892467498779
Epoch: 10, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.866 Vali Acc: 0.550 Test Loss: 0.866 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.028930902481079
Epoch: 11, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.729 Vali Acc: 0.775 Test Loss: 0.729 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 0.8965351581573486
Epoch: 12, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 1.169149398803711
Epoch: 13, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.7992467880249023
Epoch: 14, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.8945510387420654
Epoch: 15, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8698179721832275
Epoch: 16, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.8965001106262207
Epoch: 17, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.538 Vali Acc: 0.650 Test Loss: 0.538 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9053921699523926
Epoch: 18, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8598277568817139
Epoch: 19, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.9190237522125244
Epoch: 20, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.1473846435546875
Epoch: 21, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8528432846069336
Epoch: 22, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9623210430145264
Epoch: 23, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8849081993103027
Epoch: 24, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9387812614440918
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8986296653747559
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.851616382598877
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9821381568908691
Epoch: 28, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8165278434753418
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9101564884185791
Epoch: 30, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4788928
model size : 20.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.63421893119812
Epoch: 1, Steps: 3 | Train Loss: 1.668 Vali Loss: 1.433 Vali Acc: 0.400 Test Loss: 1.433 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.255183219909668
Epoch: 2, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.393 Vali Acc: 0.325 Test Loss: 1.393 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0293197631835938
Epoch: 3, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.540 Vali Acc: 0.275 Test Loss: 1.540 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0180411338806152
Epoch: 4, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.631 Vali Acc: 0.350 Test Loss: 1.631 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1970391273498535
Epoch: 5, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8260190486907959
Epoch: 6, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.145 Vali Acc: 0.550 Test Loss: 1.145 Test Acc: 0.550
Validation loss decreased (-0.399986 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 1.0271611213684082
Epoch: 7, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 1.1936559677124023
Epoch: 8, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.987 Vali Acc: 0.800 Test Loss: 0.987 Test Acc: 0.800
Validation loss decreased (-0.599990 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.9099972248077393
Epoch: 9, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.962 Vali Acc: 0.625 Test Loss: 0.962 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.33740234375
Epoch: 10, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.967 Vali Acc: 0.650 Test Loss: 0.967 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2563958168029785
Epoch: 11, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.742 Vali Acc: 0.825 Test Loss: 0.742 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 0.9280588626861572
Epoch: 12, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.9920191764831543
Epoch: 13, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.0549302101135254
Epoch: 14, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.035999059677124
Epoch: 15, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 1.0783116817474365
Epoch: 16, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.9454758167266846
Epoch: 17, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.016465187072754
Epoch: 18, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.052659511566162
Epoch: 19, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 1.04384446144104
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0065381526947021
Epoch: 21, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.9589552879333496
Epoch: 22, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0466022491455078
Epoch: 23, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.555 Vali Acc: 0.925 Test Loss: 0.555 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9252839088439941
Epoch: 24, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.119471549987793
Epoch: 25, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.31095290184021
Epoch: 26, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.8525247573852539
Epoch: 27, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0478572845458984
Epoch: 28, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9839847087860107
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8609821796417236
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8764874935150146
Epoch: 31, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9151978492736816
Epoch: 32, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8597209453582764
Epoch: 33, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8692951202392578
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0617835521697998
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9513242244720459
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 4786496
model size : 20.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5024209022521973
Epoch: 1, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.431 Vali Acc: 0.275 Test Loss: 1.431 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8256871700286865
Epoch: 2, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.397 Vali Acc: 0.150 Test Loss: 1.397 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0087201595306396
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.371 Vali Acc: 0.450 Test Loss: 1.371 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.8145720958709717
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.9138267040252686
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.254 Vali Acc: 0.425 Test Loss: 1.254 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9672727584838867
Epoch: 6, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.859675407409668
Epoch: 7, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0439114570617676
Epoch: 8, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.9392731189727783
Epoch: 9, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.973 Vali Acc: 0.650 Test Loss: 0.973 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.8042497634887695
Epoch: 10, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.649990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.9763131141662598
Epoch: 11, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.874 Vali Acc: 0.725 Test Loss: 0.874 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0052752494812012
Epoch: 12, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9124300479888916
Epoch: 13, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.9379642009735107
Epoch: 14, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8770456314086914
Epoch: 15, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9593527317047119
Epoch: 16, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.8920090198516846
Epoch: 17, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.8818509578704834
Epoch: 18, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.0420093536376953
Epoch: 19, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.581 Vali Acc: 0.800 Test Loss: 0.581 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9149734973907471
Epoch: 20, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.8782353401184082
Epoch: 21, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9565258026123047
Epoch: 22, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.966116189956665
Epoch: 23, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.8095102310180664
Epoch: 24, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.7414596080780029
Epoch: 25, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8698198795318604
Epoch: 26, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9596223831176758
Epoch: 27, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9481117725372314
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9975523948669434
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8752257823944092
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9694273471832275
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9392745494842529
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8086133003234863
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0089282989501953
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3609536
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.074138641357422
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.1339714527130127
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.368 Vali Acc: 0.325 Test Loss: 1.368 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.0885798931121826
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.417 Vali Acc: 0.300 Test Loss: 1.417 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0238683223724365
Epoch: 4, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.504 Vali Acc: 0.275 Test Loss: 1.504 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9278531074523926
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.335 Vali Acc: 0.400 Test Loss: 1.335 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.9435124397277832
Epoch: 6, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.169 Vali Acc: 0.700 Test Loss: 1.169 Test Acc: 0.700
Validation loss decreased (-0.399987 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.9439566135406494
Epoch: 7, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9750113487243652
Epoch: 8, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.074 Vali Acc: 0.550 Test Loss: 1.074 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8597126007080078
Epoch: 9, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.041 Vali Acc: 0.500 Test Loss: 1.041 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9955596923828125
Epoch: 10, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9546465873718262
Epoch: 11, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.821 Vali Acc: 0.700 Test Loss: 0.821 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 0.7865252494812012
Epoch: 12, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.740 Vali Acc: 0.700 Test Loss: 0.740 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699993).  Saving model ...
Epoch: 13 cost time: 0.9334163665771484
Epoch: 13, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.695 Vali Acc: 0.600 Test Loss: 0.695 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.009488582611084
Epoch: 14, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.665 Vali Acc: 0.625 Test Loss: 0.665 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9240481853485107
Epoch: 15, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.699993 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.053466558456421
Epoch: 16, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.9629979133605957
Epoch: 17, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.8191440105438232
Epoch: 18, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7746126651763916
Epoch: 19, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.860015869140625
Epoch: 20, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.874996 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.9683728218078613
Epoch: 21, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1025919914245605
Epoch: 22, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.8923752307891846
Epoch: 23, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9211976528167725
Epoch: 24, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0075066089630127
Epoch: 25, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9761524200439453
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0872673988342285
Epoch: 27, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1748030185699463
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2480871677398682
Epoch: 29, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.059541940689087
Epoch: 30, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2587659358978271
Epoch: 31, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0437719821929932
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3607104
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.396867275238037
Epoch: 1, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.451 Vali Acc: 0.225 Test Loss: 1.451 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.9930739402770996
Epoch: 2, Steps: 3 | Train Loss: 1.542 Vali Loss: 1.432 Vali Acc: 0.325 Test Loss: 1.432 Test Acc: 0.325
Validation loss decreased (-0.224985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2469158172607422
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.430 Vali Acc: 0.250 Test Loss: 1.430 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8705246448516846
Epoch: 4, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0075500011444092
Epoch: 5, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8986048698425293
Epoch: 6, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.324986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.9411518573760986
Epoch: 7, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.192 Vali Acc: 0.525 Test Loss: 1.192 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.922313928604126
Epoch: 8, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.136 Vali Acc: 0.575 Test Loss: 1.136 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.018376111984253
Epoch: 9, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 1.0254411697387695
Epoch: 10, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.052 Vali Acc: 0.475 Test Loss: 1.052 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.968817949295044
Epoch: 11, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.936 Vali Acc: 0.650 Test Loss: 0.936 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 0.9927794933319092
Epoch: 12, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.791 Vali Acc: 0.700 Test Loss: 0.791 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 0.9854350090026855
Epoch: 13, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.758 Vali Acc: 0.625 Test Loss: 0.758 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.834242582321167
Epoch: 14, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
Validation loss decreased (-0.699992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.058774709701538
Epoch: 15, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9900393486022949
Epoch: 16, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 1.2445671558380127
Epoch: 17, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.9682562351226807
Epoch: 18, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8446519374847412
Epoch: 19, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0933659076690674
Epoch: 20, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.0117440223693848
Epoch: 21, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4650993347167969
Epoch: 22, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.437 Vali Acc: 0.825 Test Loss: 0.437 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9234755039215088
Epoch: 23, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9740939140319824
Epoch: 24, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.9689347743988037
Epoch: 25, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9184553623199463
Epoch: 26, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0822219848632812
Epoch: 27, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.104262113571167
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9669575691223145
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0062189102172852
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1096034049987793
Epoch: 31, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0250611305236816
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9143052101135254
Epoch: 33, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.185643196105957
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 3604672
model size : 16.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.078794240951538
Epoch: 1, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.428 Vali Acc: 0.200 Test Loss: 1.428 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.9076993465423584
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.525 Test Loss: 1.385 Test Acc: 0.525
Validation loss decreased (-0.199986 --> -0.524986).  Saving model ...
Epoch: 3 cost time: 1.0080955028533936
Epoch: 3, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1478683948516846
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.930828332901001
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9934165477752686
Epoch: 6, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.226 Vali Acc: 0.475 Test Loss: 1.226 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1891932487487793
Epoch: 7, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.524986 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 1.1136343479156494
Epoch: 8, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.002155065536499
Epoch: 9, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.094 Vali Acc: 0.625 Test Loss: 1.094 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.9484925270080566
Epoch: 10, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.0943336486816406
Epoch: 11, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.0236518383026123
Epoch: 12, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 0.9977743625640869
Epoch: 13, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.9601736068725586
Epoch: 14, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.740 Vali Acc: 0.825 Test Loss: 0.740 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 1.0549376010894775
Epoch: 15, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.2390236854553223
Epoch: 16, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.9248919486999512
Epoch: 17, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0573508739471436
Epoch: 18, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9515790939331055
Epoch: 19, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0002996921539307
Epoch: 20, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 1.1955618858337402
Epoch: 21, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0179617404937744
Epoch: 22, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0605523586273193
Epoch: 23, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1346526145935059
Epoch: 24, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9182708263397217
Epoch: 25, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0653502941131592
Epoch: 26, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9704878330230713
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.290419578552246
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1752150058746338
Epoch: 29, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.931490421295166
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3602240
model size : 16.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6867964267730713
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.454 Vali Acc: 0.350 Test Loss: 1.454 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.7917370796203613
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.416 Vali Acc: 0.325 Test Loss: 1.416 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.906740665435791
Epoch: 3, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.439 Vali Acc: 0.325 Test Loss: 1.439 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1353099346160889
Epoch: 4, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.419 Vali Acc: 0.325 Test Loss: 1.419 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0001811981201172
Epoch: 5, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.307 Vali Acc: 0.325 Test Loss: 1.307 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9441854953765869
Epoch: 6, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.349985 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.8017787933349609
Epoch: 7, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.170 Vali Acc: 0.475 Test Loss: 1.170 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.8047842979431152
Epoch: 8, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.7816386222839355
Epoch: 9, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.091 Vali Acc: 0.525 Test Loss: 1.091 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.892160177230835
Epoch: 10, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.004 Vali Acc: 0.550 Test Loss: 1.004 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 11 cost time: 0.8230199813842773
Epoch: 11, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.950 Vali Acc: 0.575 Test Loss: 0.950 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 1.0789744853973389
Epoch: 12, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.839 Vali Acc: 0.700 Test Loss: 0.839 Test Acc: 0.700
Validation loss decreased (-0.574990 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 0.9711868762969971
Epoch: 13, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.809 Vali Acc: 0.575 Test Loss: 0.809 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8274171352386475
Epoch: 14, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774993).  Saving model ...
Epoch: 15 cost time: 0.7883799076080322
Epoch: 15, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 16 cost time: 0.7792849540710449
Epoch: 16, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.576 Vali Acc: 0.650 Test Loss: 0.576 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0399978160858154
Epoch: 17, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
Validation loss decreased (-0.774993 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.8761367797851562
Epoch: 18, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9117727279663086
Epoch: 19, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.9153778553009033
Epoch: 20, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.9674673080444336
Epoch: 21, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9209098815917969
Epoch: 22, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8328461647033691
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.7548811435699463
Epoch: 24, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9808995723724365
Epoch: 25, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8957042694091797
Epoch: 26, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.021453619003296
Epoch: 27, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9656286239624023
Epoch: 28, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.9537620544433594
Epoch: 29, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0605814456939697
Epoch: 30, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9969539642333984
Epoch: 31, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.514 Vali Acc: 0.925 Test Loss: 0.514 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9662351608276367
Epoch: 32, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0667080879211426
Epoch: 33, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0394690036773682
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9071757793426514
Epoch: 35, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9451785087585449
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9001030921936035
Epoch: 37, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8943219184875488
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3017408
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1615231037139893
Epoch: 1, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.0612688064575195
Epoch: 2, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.3624343872070312
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.346 Vali Acc: 0.425 Test Loss: 1.346 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.0967025756835938
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.046710729598999
Epoch: 5, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.9407339096069336
Epoch: 6, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.152 Vali Acc: 0.575 Test Loss: 1.152 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 1.0964534282684326
Epoch: 7, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.2297687530517578
Epoch: 8, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.088 Vali Acc: 0.575 Test Loss: 1.088 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2288000583648682
Epoch: 9, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1268641948699951
Epoch: 10, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9986579418182373
Epoch: 11, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 1.110203742980957
Epoch: 12, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.803 Vali Acc: 0.625 Test Loss: 0.803 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0153782367706299
Epoch: 13, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.9131896495819092
Epoch: 14, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2871081829071045
Epoch: 15, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.767 Vali Acc: 0.625 Test Loss: 0.767 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9307315349578857
Epoch: 16, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.9974138736724854
Epoch: 17, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8377337455749512
Epoch: 18, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.739924430847168
Epoch: 19, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.463 Vali Acc: 0.825 Test Loss: 0.463 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1042535305023193
Epoch: 20, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.846895694732666
Epoch: 21, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.0853221416473389
Epoch: 22, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0416550636291504
Epoch: 23, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.475 Vali Acc: 0.825 Test Loss: 0.475 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1812958717346191
Epoch: 24, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.938692569732666
Epoch: 25, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9582316875457764
Epoch: 26, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.450 Vali Acc: 0.825 Test Loss: 0.450 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.903810977935791
Epoch: 27, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0820393562316895
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0009441375732422
Epoch: 29, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.435 Vali Acc: 0.800 Test Loss: 0.435 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.068100929260254
Epoch: 30, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3575654029846191
Epoch: 31, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 3014976
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.065014123916626
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.435 Vali Acc: 0.225 Test Loss: 1.435 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.9944441318511963
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.431 Vali Acc: 0.300 Test Loss: 1.431 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9457948207855225
Epoch: 3, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.432 Vali Acc: 0.300 Test Loss: 1.432 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9113142490386963
Epoch: 4, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.9923076629638672
Epoch: 5, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.375 Vali Acc: 0.475 Test Loss: 1.375 Test Acc: 0.475
Validation loss decreased (-0.299986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.9566404819488525
Epoch: 6, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.474986 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.8904953002929688
Epoch: 7, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.221 Vali Acc: 0.700 Test Loss: 1.221 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.9470455646514893
Epoch: 8, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9673202037811279
Epoch: 9, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.174 Vali Acc: 0.625 Test Loss: 1.174 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2668344974517822
Epoch: 10, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9972293376922607
Epoch: 11, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.9861090183258057
Epoch: 12, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.910 Vali Acc: 0.575 Test Loss: 0.910 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8139221668243408
Epoch: 13, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0715162754058838
Epoch: 14, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.816 Vali Acc: 0.700 Test Loss: 0.816 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.02052903175354
Epoch: 15, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.724991 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 1.366459608078003
Epoch: 16, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.727 Vali Acc: 0.625 Test Loss: 0.727 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0934982299804688
Epoch: 17, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0896599292755127
Epoch: 18, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.3944973945617676
Epoch: 19, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.8453965187072754
Epoch: 20, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.9821839332580566
Epoch: 21, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0132505893707275
Epoch: 22, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0341672897338867
Epoch: 23, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9842793941497803
Epoch: 24, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.3192901611328125
Epoch: 25, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.1745915412902832
Epoch: 26, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.972191333770752
Epoch: 27, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.9929549694061279
Epoch: 28, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9304156303405762
Epoch: 29, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.025852918624878
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.953993558883667
Epoch: 31, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9937524795532227
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.057164192199707
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.537 Vali Acc: 0.925 Test Loss: 0.537 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9343042373657227
Epoch: 34, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3538751602172852
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.970710039138794
Epoch: 36, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0042247772216797
Epoch: 37, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.505 Vali Acc: 0.925 Test Loss: 0.505 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9490799903869629
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.949918270111084
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8795125484466553
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3012544
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.650710344314575
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.1141679286956787
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.9807369709014893
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0670480728149414
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.1513285636901855
Epoch: 5, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.305 Vali Acc: 0.375 Test Loss: 1.305 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0835001468658447
Epoch: 6, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.9816303253173828
Epoch: 7, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.9564616680145264
Epoch: 8, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.089 Vali Acc: 0.625 Test Loss: 1.089 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.0362882614135742
Epoch: 9, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.036 Vali Acc: 0.550 Test Loss: 1.036 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9616944789886475
Epoch: 10, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.997 Vali Acc: 0.525 Test Loss: 0.997 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0669257640838623
Epoch: 11, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 1.240347146987915
Epoch: 12, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 13 cost time: 1.1496987342834473
Epoch: 13, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.740 Vali Acc: 0.675 Test Loss: 0.740 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9050617218017578
Epoch: 14, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.715 Vali Acc: 0.650 Test Loss: 0.715 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0186829566955566
Epoch: 15, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774994).  Saving model ...
Epoch: 16 cost time: 1.017730712890625
Epoch: 16, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.621 Vali Acc: 0.650 Test Loss: 0.621 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0491645336151123
Epoch: 17, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 0.9975383281707764
Epoch: 18, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0336453914642334
Epoch: 19, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.556 Vali Acc: 0.700 Test Loss: 0.556 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9777052402496338
Epoch: 20, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.538 Vali Acc: 0.700 Test Loss: 0.538 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9856522083282471
Epoch: 21, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.9212393760681152
Epoch: 22, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.9476547241210938
Epoch: 23, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.0423839092254639
Epoch: 24, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2272541522979736
Epoch: 25, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.213015079498291
Epoch: 26, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.977353572845459
Epoch: 27, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.455 Vali Acc: 0.825 Test Loss: 0.455 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9678869247436523
Epoch: 28, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9817626476287842
Epoch: 29, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8817710876464844
Epoch: 30, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.031111240386963
Epoch: 31, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.322011947631836
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0906848907470703
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9604635238647461
Epoch: 34, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0148992538452148
Epoch: 35, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0599632263183594
Epoch: 36, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 3010112
model size : 14.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5915277004241943
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.456 Vali Acc: 0.300 Test Loss: 1.456 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.8435745239257812
Epoch: 2, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.436 Vali Acc: 0.250 Test Loss: 1.436 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9710874557495117
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.399 Vali Acc: 0.375 Test Loss: 1.399 Test Acc: 0.375
Validation loss decreased (-0.299985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.1039862632751465
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.378 Vali Acc: 0.275 Test Loss: 1.378 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8773505687713623
Epoch: 5, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.338 Vali Acc: 0.275 Test Loss: 1.338 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.047858715057373
Epoch: 6, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.261 Vali Acc: 0.625 Test Loss: 1.261 Test Acc: 0.625
Validation loss decreased (-0.374986 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 1.1309247016906738
Epoch: 7, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.979926586151123
Epoch: 8, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1901276111602783
Epoch: 9, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.9386801719665527
Epoch: 10, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 1.0047366619110107
Epoch: 11, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2665128707885742
Epoch: 12, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.996 Vali Acc: 0.525 Test Loss: 0.996 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2484180927276611
Epoch: 13, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.1163275241851807
Epoch: 14, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.799 Vali Acc: 0.675 Test Loss: 0.799 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.138106107711792
Epoch: 15, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.740 Vali Acc: 0.825 Test Loss: 0.740 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.928626537322998
Epoch: 16, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.015010118484497
Epoch: 17, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0649049282073975
Epoch: 18, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 0.9508123397827148
Epoch: 19, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.8649260997772217
Epoch: 20, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.9769172668457031
Epoch: 21, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9472777843475342
Epoch: 22, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0086040496826172
Epoch: 23, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8975155353546143
Epoch: 24, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9891862869262695
Epoch: 25, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0854358673095703
Epoch: 26, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0198009014129639
Epoch: 27, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1841015815734863
Epoch: 28, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0028448104858398
Epoch: 29, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9421145915985107
Epoch: 30, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2721344
model size : 13.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.842325448989868
Epoch: 1, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.1094918251037598
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.2370035648345947
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.412 Vali Acc: 0.325 Test Loss: 1.412 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9413261413574219
Epoch: 4, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.400 Vali Acc: 0.375 Test Loss: 1.400 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9621953964233398
Epoch: 5, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.9050345420837402
Epoch: 6, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.214 Vali Acc: 0.675 Test Loss: 1.214 Test Acc: 0.675
Validation loss decreased (-0.399987 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.9621572494506836
Epoch: 7, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9286015033721924
Epoch: 8, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.138 Vali Acc: 0.525 Test Loss: 1.138 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9020674228668213
Epoch: 9, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0436723232269287
Epoch: 10, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1908257007598877
Epoch: 11, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.978 Vali Acc: 0.675 Test Loss: 0.978 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.8310747146606445
Epoch: 12, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.9419975280761719
Epoch: 13, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.832 Vali Acc: 0.600 Test Loss: 0.832 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0508179664611816
Epoch: 14, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.755 Vali Acc: 0.625 Test Loss: 0.755 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9091393947601318
Epoch: 15, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.720 Vali Acc: 0.725 Test Loss: 0.720 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9594564437866211
Epoch: 16, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.719 Vali Acc: 0.650 Test Loss: 0.719 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0281002521514893
Epoch: 17, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 0.9681684970855713
Epoch: 18, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.648 Vali Acc: 0.600 Test Loss: 0.648 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9971868991851807
Epoch: 19, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 1.158674716949463
Epoch: 20, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.8793563842773438
Epoch: 21, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.8954839706420898
Epoch: 22, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1334340572357178
Epoch: 23, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9565966129302979
Epoch: 24, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.9797279834747314
Epoch: 25, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8270001411437988
Epoch: 26, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4094250202178955
Epoch: 27, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.8032233715057373
Epoch: 28, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9661550521850586
Epoch: 29, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.9356486797332764
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8993854522705078
Epoch: 31, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0018787384033203
Epoch: 32, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 1.1363863945007324
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.905759334564209
Epoch: 34, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8333854675292969
Epoch: 35, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0364258289337158
Epoch: 36, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9004971981048584
Epoch: 37, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8646330833435059
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.9013614654541016
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1304128170013428
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9438998699188232
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8524746894836426
Epoch: 42, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.106600284576416
Epoch: 43, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8526711463928223
Epoch: 44, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.89705491065979
Epoch: 45, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9746067523956299
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0656886100769043
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0140066146850586
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2718912
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.879960298538208
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.399 Vali Acc: 0.275 Test Loss: 1.399 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.0668749809265137
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.346 Vali Acc: 0.300 Test Loss: 1.346 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.8808183670043945
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.259 Vali Acc: 0.525 Test Loss: 1.259 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 1.2216694355010986
Epoch: 4, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1905605792999268
Epoch: 5, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.190 Vali Acc: 0.575 Test Loss: 1.190 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 0.9064080715179443
Epoch: 6, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.226 Vali Acc: 0.600 Test Loss: 1.226 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.1412363052368164
Epoch: 7, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.229 Vali Acc: 0.725 Test Loss: 1.229 Test Acc: 0.725
Validation loss decreased (-0.599988 --> -0.724988).  Saving model ...
Epoch: 8 cost time: 1.199601650238037
Epoch: 8, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.108 Vali Acc: 0.550 Test Loss: 1.108 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8404488563537598
Epoch: 9, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9312374591827393
Epoch: 10, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.949 Vali Acc: 0.650 Test Loss: 0.949 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2242205142974854
Epoch: 11, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9678609371185303
Epoch: 12, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.9457440376281738
Epoch: 13, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.805 Vali Acc: 0.575 Test Loss: 0.805 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0444793701171875
Epoch: 14, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 0.8400576114654541
Epoch: 15, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.035494327545166
Epoch: 16, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9184551239013672
Epoch: 17, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0144786834716797
Epoch: 18, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 1.0203580856323242
Epoch: 19, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 1.0422067642211914
Epoch: 20, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 1.083183765411377
Epoch: 21, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1349191665649414
Epoch: 22, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.8544950485229492
Epoch: 23, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.123429536819458
Epoch: 24, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8510024547576904
Epoch: 25, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8657321929931641
Epoch: 26, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.8314516544342041
Epoch: 27, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.86911940574646
Epoch: 28, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9280200004577637
Epoch: 29, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0856540203094482
Epoch: 30, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.169769525527954
Epoch: 31, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8904542922973633
Epoch: 32, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.9388253688812256
Epoch: 33, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9869329929351807
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.991832971572876
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9050486087799072
Epoch: 36, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9061980247497559
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.074751853942871
Epoch: 38, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0143780708312988
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9891645908355713
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.117138147354126
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1037850379943848
Epoch: 42, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2716480
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5635194778442383
Epoch: 1, Steps: 3 | Train Loss: 1.555 Vali Loss: 1.479 Vali Acc: 0.125 Test Loss: 1.479 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 0.8155834674835205
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.430 Vali Acc: 0.200 Test Loss: 1.430 Test Acc: 0.200
Validation loss decreased (-0.124985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.9027035236358643
Epoch: 3, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.371 Vali Acc: 0.350 Test Loss: 1.371 Test Acc: 0.350
Validation loss decreased (-0.199986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.8179535865783691
Epoch: 4, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.8514494895935059
Epoch: 5, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.265 Vali Acc: 0.525 Test Loss: 1.265 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.7921185493469238
Epoch: 6, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9698822498321533
Epoch: 7, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.209 Vali Acc: 0.525 Test Loss: 1.209 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.9685580730438232
Epoch: 8, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.185 Vali Acc: 0.450 Test Loss: 1.185 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9923839569091797
Epoch: 9, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.9239625930786133
Epoch: 10, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.009 Vali Acc: 0.575 Test Loss: 1.009 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9723670482635498
Epoch: 11, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.930 Vali Acc: 0.575 Test Loss: 0.930 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9380905628204346
Epoch: 12, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.931 Vali Acc: 0.475 Test Loss: 0.931 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8564388751983643
Epoch: 13, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
Validation loss decreased (-0.599989 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 0.826528787612915
Epoch: 14, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.768 Vali Acc: 0.625 Test Loss: 0.768 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0869016647338867
Epoch: 15, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.8775646686553955
Epoch: 16, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8503282070159912
Epoch: 17, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.8963496685028076
Epoch: 18, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.625 Vali Acc: 0.825 Test Loss: 0.625 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0411837100982666
Epoch: 19, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.961207389831543
Epoch: 20, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 1.027388334274292
Epoch: 21, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.518 Vali Acc: 0.800 Test Loss: 0.518 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9459929466247559
Epoch: 22, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9530379772186279
Epoch: 23, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7879049777984619
Epoch: 24, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.9651274681091309
Epoch: 25, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.1506195068359375
Epoch: 26, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8955490589141846
Epoch: 27, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9856419563293457
Epoch: 28, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.462 Vali Acc: 0.925 Test Loss: 0.462 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8772845268249512
Epoch: 29, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9515001773834229
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9726002216339111
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7332849502563477
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8634369373321533
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7896180152893066
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0927784442901611
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2714048
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3122453689575195
Epoch: 1, Steps: 3 | Train Loss: 1.585 Vali Loss: 1.396 Vali Acc: 0.375 Test Loss: 1.396 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8659610748291016
Epoch: 2, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8704571723937988
Epoch: 3, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.401 Vali Acc: 0.400 Test Loss: 1.401 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.8427653312683105
Epoch: 4, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.403 Vali Acc: 0.375 Test Loss: 1.403 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9504148960113525
Epoch: 5, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.384 Vali Acc: 0.425 Test Loss: 1.384 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.237706184387207
Epoch: 6, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
Validation loss decreased (-0.424986 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.8908298015594482
Epoch: 7, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1511576175689697
Epoch: 8, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.128 Vali Acc: 0.525 Test Loss: 1.128 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8960959911346436
Epoch: 9, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.082 Vali Acc: 0.575 Test Loss: 1.082 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.9951918125152588
Epoch: 10, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 1.1620492935180664
Epoch: 11, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.062 Vali Acc: 0.525 Test Loss: 1.062 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0047788619995117
Epoch: 12, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.4181256294250488
Epoch: 13, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.930619478225708
Epoch: 14, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.860032320022583
Epoch: 15, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8253800868988037
Epoch: 16, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.982043981552124
Epoch: 17, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.9007599353790283
Epoch: 18, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4563264846801758
Epoch: 19, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 0.9420897960662842
Epoch: 20, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.615 Vali Acc: 0.650 Test Loss: 0.615 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0456390380859375
Epoch: 21, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.8102343082427979
Epoch: 22, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8677384853363037
Epoch: 23, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9459989070892334
Epoch: 24, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.8063986301422119
Epoch: 25, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.078094482421875
Epoch: 26, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9995982646942139
Epoch: 27, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.931795597076416
Epoch: 28, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1007282733917236
Epoch: 29, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.079282522201538
Epoch: 30, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.92964768409729
Epoch: 31, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8634092807769775
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9685595035552979
Epoch: 33, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1390395164489746
Epoch: 34, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1811712
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5557796955108643
Epoch: 1, Steps: 3 | Train Loss: 1.531 Vali Loss: 1.441 Vali Acc: 0.175 Test Loss: 1.441 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.7596545219421387
Epoch: 2, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.8850414752960205
Epoch: 3, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.429 Vali Acc: 0.325 Test Loss: 1.429 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8713154792785645
Epoch: 4, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.431 Vali Acc: 0.225 Test Loss: 1.431 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9973728656768799
Epoch: 5, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.378 Vali Acc: 0.325 Test Loss: 1.378 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.948533296585083
Epoch: 6, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1841764450073242
Epoch: 7, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.9654488563537598
Epoch: 8, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.178 Vali Acc: 0.675 Test Loss: 1.178 Test Acc: 0.675
Validation loss decreased (-0.449988 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.8377447128295898
Epoch: 9, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8901512622833252
Epoch: 10, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.062 Vali Acc: 0.575 Test Loss: 1.062 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0124566555023193
Epoch: 11, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.8192369937896729
Epoch: 12, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8386509418487549
Epoch: 13, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.9498469829559326
Epoch: 14, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 1.0065176486968994
Epoch: 15, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.775 Vali Acc: 0.650 Test Loss: 0.775 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8193047046661377
Epoch: 16, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 0.9264159202575684
Epoch: 17, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.673 Vali Acc: 0.700 Test Loss: 0.673 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9505460262298584
Epoch: 18, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.684 Vali Acc: 0.650 Test Loss: 0.684 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0540077686309814
Epoch: 19, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.558 Vali Acc: 0.800 Test Loss: 0.558 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9815170764923096
Epoch: 20, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.560 Vali Acc: 0.700 Test Loss: 0.560 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8137772083282471
Epoch: 21, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 1.0360910892486572
Epoch: 22, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0073230266571045
Epoch: 23, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 1.0392262935638428
Epoch: 24, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.981900691986084
Epoch: 25, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9583499431610107
Epoch: 26, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.465 Vali Acc: 0.825 Test Loss: 0.465 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8857254981994629
Epoch: 27, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8431150913238525
Epoch: 28, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.133357286453247
Epoch: 29, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8749127388000488
Epoch: 30, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0061967372894287
Epoch: 31, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8836753368377686
Epoch: 32, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0608208179473877
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1136488914489746
Epoch: 34, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1810496
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5223779678344727
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.411 Vali Acc: 0.375 Test Loss: 1.411 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8298816680908203
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.9009265899658203
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.0020036697387695
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.235 Vali Acc: 0.450 Test Loss: 1.235 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8074634075164795
Epoch: 5, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.191 Vali Acc: 0.475 Test Loss: 1.191 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.880760908126831
Epoch: 6, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.152 Vali Acc: 0.525 Test Loss: 1.152 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.9496691226959229
Epoch: 7, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.128 Vali Acc: 0.575 Test Loss: 1.128 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.8575050830841064
Epoch: 8, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0193209648132324
Epoch: 9, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.8185906410217285
Epoch: 10, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.897 Vali Acc: 0.650 Test Loss: 0.897 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 11 cost time: 0.8709032535552979
Epoch: 11, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.848 Vali Acc: 0.625 Test Loss: 0.848 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7764396667480469
Epoch: 12, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.768 Vali Acc: 0.650 Test Loss: 0.768 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649992).  Saving model ...
Epoch: 13 cost time: 1.031402587890625
Epoch: 13, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.715 Vali Acc: 0.825 Test Loss: 0.715 Test Acc: 0.825
Validation loss decreased (-0.649992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.8128180503845215
Epoch: 14, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.7734062671661377
Epoch: 15, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.587 Vali Acc: 0.650 Test Loss: 0.587 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8431470394134521
Epoch: 16, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.9671225547790527
Epoch: 17, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.8662216663360596
Epoch: 18, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.8271408081054688
Epoch: 19, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.793489933013916
Epoch: 20, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9237370491027832
Epoch: 21, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.8130311965942383
Epoch: 22, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.8905577659606934
Epoch: 23, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9559853076934814
Epoch: 24, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8100559711456299
Epoch: 25, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8832452297210693
Epoch: 26, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8674697875976562
Epoch: 27, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9370112419128418
Epoch: 28, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8255770206451416
Epoch: 29, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9515085220336914
Epoch: 30, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9164934158325195
Epoch: 31, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8061957359313965
Epoch: 32, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1809280
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8196864128112793
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.433 Vali Acc: 0.300 Test Loss: 1.433 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9360256195068359
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.9179391860961914
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.394 Vali Acc: 0.350 Test Loss: 1.394 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8546257019042969
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0327234268188477
Epoch: 5, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1052577495574951
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.337 Vali Acc: 0.325 Test Loss: 1.337 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8438100814819336
Epoch: 7, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
Validation loss decreased (-0.399986 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.7740345001220703
Epoch: 8, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.232 Vali Acc: 0.475 Test Loss: 1.232 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1672093868255615
Epoch: 9, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.191 Vali Acc: 0.475 Test Loss: 1.191 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8926079273223877
Epoch: 10, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.137 Vali Acc: 0.675 Test Loss: 1.137 Test Acc: 0.675
Validation loss decreased (-0.549987 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 1.05092191696167
Epoch: 11, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.8277766704559326
Epoch: 12, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.962 Vali Acc: 0.650 Test Loss: 0.962 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.974602460861206
Epoch: 13, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8812990188598633
Epoch: 14, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.8539345264434814
Epoch: 15, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.803 Vali Acc: 0.875 Test Loss: 0.803 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.8398561477661133
Epoch: 16, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 1.0622961521148682
Epoch: 17, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.8756849765777588
Epoch: 18, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9303750991821289
Epoch: 19, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0416202545166016
Epoch: 20, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 1.0424542427062988
Epoch: 21, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.8775653839111328
Epoch: 22, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0655641555786133
Epoch: 23, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.0241141319274902
Epoch: 24, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.939131498336792
Epoch: 25, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0259332656860352
Epoch: 26, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8708341121673584
Epoch: 27, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9532833099365234
Epoch: 28, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9688875675201416
Epoch: 29, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8735275268554688
Epoch: 30, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9857573509216309
Epoch: 31, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.681 Vali Acc: 0.775 Test Loss: 0.681 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9760620594024658
Epoch: 32, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8698101043701172
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1808064
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5522844791412354
Epoch: 1, Steps: 3 | Train Loss: 1.575 Vali Loss: 1.469 Vali Acc: 0.175 Test Loss: 1.469 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.9276442527770996
Epoch: 2, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.447 Vali Acc: 0.200 Test Loss: 1.447 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.8267917633056641
Epoch: 3, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.411 Vali Acc: 0.300 Test Loss: 1.411 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.9052855968475342
Epoch: 4, Steps: 3 | Train Loss: 1.498 Vali Loss: 1.381 Vali Acc: 0.350 Test Loss: 1.381 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.7568600177764893
Epoch: 5, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449986).  Saving model ...
Epoch: 6 cost time: 0.8712584972381592
Epoch: 6, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9134793281555176
Epoch: 7, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9739201068878174
Epoch: 8, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.227 Vali Acc: 0.450 Test Loss: 1.227 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 1.0337705612182617
Epoch: 9, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.139 Vali Acc: 0.575 Test Loss: 1.139 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.9757404327392578
Epoch: 10, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.097 Vali Acc: 0.575 Test Loss: 1.097 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 1.0719616413116455
Epoch: 11, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.9108231067657471
Epoch: 12, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.9522149562835693
Epoch: 13, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 1.070629358291626
Epoch: 14, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.895 Vali Acc: 0.825 Test Loss: 0.895 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.8855588436126709
Epoch: 15, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.837 Vali Acc: 0.825 Test Loss: 0.837 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.8244476318359375
Epoch: 16, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9812724590301514
Epoch: 17, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.729 Vali Acc: 0.825 Test Loss: 0.729 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.8201985359191895
Epoch: 18, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.9412899017333984
Epoch: 19, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.655 Vali Acc: 0.825 Test Loss: 0.655 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9188165664672852
Epoch: 20, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9387834072113037
Epoch: 21, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9911742210388184
Epoch: 22, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.9632682800292969
Epoch: 23, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.056084394454956
Epoch: 24, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.939929723739624
Epoch: 25, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9661862850189209
Epoch: 26, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9927380084991455
Epoch: 27, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8269875049591064
Epoch: 28, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.84757399559021
Epoch: 29, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1402320861816406
Epoch: 30, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9941713809967041
Epoch: 31, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.819063663482666
Epoch: 32, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1329283714294434
Epoch: 33, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0082862377166748
Epoch: 34, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0562951564788818
Epoch: 35, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8668181896209717
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0173907279968262
Epoch: 37, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9972896575927734
Epoch: 38, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1217280
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3910422325134277
Epoch: 1, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8874955177307129
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.425 Vali Acc: 0.350 Test Loss: 1.425 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8151121139526367
Epoch: 3, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8339884281158447
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.411 Vali Acc: 0.325 Test Loss: 1.411 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7798676490783691
Epoch: 5, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8011250495910645
Epoch: 6, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.8899226188659668
Epoch: 7, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.331 Vali Acc: 0.425 Test Loss: 1.331 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.8037810325622559
Epoch: 8, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.305 Vali Acc: 0.350 Test Loss: 1.305 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8616490364074707
Epoch: 9, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.95754075050354
Epoch: 10, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8724098205566406
Epoch: 11, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.7944808006286621
Epoch: 12, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.062 Vali Acc: 0.575 Test Loss: 1.062 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.8562180995941162
Epoch: 13, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7803177833557129
Epoch: 14, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.7478013038635254
Epoch: 15, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.599990 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.9775521755218506
Epoch: 16, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.8441927433013916
Epoch: 17, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8984341621398926
Epoch: 18, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.745 Vali Acc: 0.800 Test Loss: 0.745 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8699440956115723
Epoch: 19, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.724 Vali Acc: 0.775 Test Loss: 0.724 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9361510276794434
Epoch: 20, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.648 Vali Acc: 0.825 Test Loss: 0.648 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.9345824718475342
Epoch: 21, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.9600389003753662
Epoch: 22, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.7728121280670166
Epoch: 23, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.9239931106567383
Epoch: 24, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.9202113151550293
Epoch: 25, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0469319820404053
Epoch: 26, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.0141701698303223
Epoch: 27, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9636247158050537
Epoch: 28, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9670133590698242
Epoch: 29, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8702847957611084
Epoch: 30, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9264576435089111
Epoch: 31, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0189235210418701
Epoch: 32, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9483742713928223
Epoch: 33, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1201708316802979
Epoch: 34, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1374866962432861
Epoch: 35, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9916632175445557
Epoch: 36, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1216064
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.607246160507202
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.387 Vali Acc: 0.150 Test Loss: 1.387 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.8531737327575684
Epoch: 2, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.392 Vali Acc: 0.325 Test Loss: 1.392 Test Acc: 0.325
Validation loss decreased (-0.149986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.1296663284301758
Epoch: 3, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.396 Vali Acc: 0.350 Test Loss: 1.396 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0647659301757812
Epoch: 4, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.382 Vali Acc: 0.450 Test Loss: 1.382 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 1.3944003582000732
Epoch: 5, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.359 Vali Acc: 0.475 Test Loss: 1.359 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.8917679786682129
Epoch: 6, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.333 Vali Acc: 0.525 Test Loss: 1.333 Test Acc: 0.525
Validation loss decreased (-0.474986 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.8197810649871826
Epoch: 7, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.284 Vali Acc: 0.575 Test Loss: 1.284 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 0.7938508987426758
Epoch: 8, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.211 Vali Acc: 0.625 Test Loss: 1.211 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.9108350276947021
Epoch: 9, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.9178287982940674
Epoch: 10, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.9599363803863525
Epoch: 11, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.027 Vali Acc: 0.650 Test Loss: 1.027 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0662603378295898
Epoch: 12, Steps: 3 | Train Loss: 0.915 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8195734024047852
Epoch: 13, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.927 Vali Acc: 0.675 Test Loss: 0.927 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.900547981262207
Epoch: 14, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.9195718765258789
Epoch: 15, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.8901877403259277
Epoch: 16, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 1.0982069969177246
Epoch: 17, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.961045503616333
Epoch: 18, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8901481628417969
Epoch: 19, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.607 Vali Acc: 0.900 Test Loss: 0.607 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.9144837856292725
Epoch: 20, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.955695390701294
Epoch: 21, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.8946516513824463
Epoch: 22, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.518 Vali Acc: 0.800 Test Loss: 0.518 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0073258876800537
Epoch: 23, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.184016466140747
Epoch: 24, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1431999206542969
Epoch: 25, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8799972534179688
Epoch: 26, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8396308422088623
Epoch: 27, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8324298858642578
Epoch: 28, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.402 Vali Acc: 0.825 Test Loss: 0.402 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8168408870697021
Epoch: 29, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.85064697265625
Epoch: 30, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 1.0482738018035889
Epoch: 31, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0753672122955322
Epoch: 32, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2419681549072266
Epoch: 33, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.078371524810791
Epoch: 34, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.9003002643585205
Epoch: 35, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7843828201293945
Epoch: 36, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.982550859451294
Epoch: 37, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 0.8816654682159424
Epoch: 38, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9533786773681641
Epoch: 39, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.454 Vali Acc: 0.825 Test Loss: 0.454 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1139020919799805
Epoch: 40, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8918108940124512
Epoch: 41, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 0.9186651706695557
Epoch: 42, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.879112720489502
Epoch: 43, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.491 Vali Acc: 0.825 Test Loss: 0.491 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.960402250289917
Epoch: 44, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0120394229888916
Epoch: 45, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9843823909759521
Epoch: 46, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8402059078216553
Epoch: 47, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9976518154144287
Epoch: 48, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9073605537414551
Epoch: 49, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9930732250213623
Epoch: 50, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0370745658874512
Epoch: 51, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1214848
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6089179515838623
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.374 Vali Acc: 0.325 Test Loss: 1.374 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.867095947265625
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.8745729923248291
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.882979154586792
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.305 Vali Acc: 0.475 Test Loss: 1.305 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0737309455871582
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.8487973213195801
Epoch: 6, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.203 Vali Acc: 0.575 Test Loss: 1.203 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.9176359176635742
Epoch: 7, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.155 Vali Acc: 0.650 Test Loss: 1.155 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.8654618263244629
Epoch: 8, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.123 Vali Acc: 0.675 Test Loss: 1.123 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.9625706672668457
Epoch: 9, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.101 Vali Acc: 0.650 Test Loss: 1.101 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9927341938018799
Epoch: 10, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.9291024208068848
Epoch: 11, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9593770503997803
Epoch: 12, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.7890894412994385
Epoch: 13, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.849 Vali Acc: 0.850 Test Loss: 0.849 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.9024033546447754
Epoch: 14, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.895606279373169
Epoch: 15, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.813 Vali Acc: 0.650 Test Loss: 0.813 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9079916477203369
Epoch: 16, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.771 Vali Acc: 0.700 Test Loss: 0.771 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9942641258239746
Epoch: 17, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.8661665916442871
Epoch: 18, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.655 Vali Acc: 0.700 Test Loss: 0.655 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.926393985748291
Epoch: 19, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 0.9035506248474121
Epoch: 20, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.600 Vali Acc: 0.725 Test Loss: 0.600 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.003537893295288
Epoch: 21, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 1.0923337936401367
Epoch: 22, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.521 Vali Acc: 0.700 Test Loss: 0.521 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8729503154754639
Epoch: 23, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.8791368007659912
Epoch: 24, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.9234323501586914
Epoch: 25, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9652152061462402
Epoch: 26, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.024383783340454
Epoch: 27, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.0083863735198975
Epoch: 28, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9785544872283936
Epoch: 29, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8578529357910156
Epoch: 30, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.2608323097229004
Epoch: 31, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.9231038093566895
Epoch: 32, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.979802131652832
Epoch: 33, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0383005142211914
Epoch: 34, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.005613088607788
Epoch: 35, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9149191379547119
Epoch: 36, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8849341869354248
Epoch: 37, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9440979957580566
Epoch: 38, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1110584735870361
Epoch: 39, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9464421272277832
Epoch: 40, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.034165859222412
Epoch: 41, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1213632
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5703346729278564
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.398 Vali Acc: 0.175 Test Loss: 1.398 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.7939243316650391
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.397 Vali Acc: 0.225 Test Loss: 1.397 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.8525617122650146
Epoch: 3, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.400 Vali Acc: 0.375 Test Loss: 1.400 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.8933582305908203
Epoch: 4, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.425 Vali Acc: 0.350 Test Loss: 1.425 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7712392807006836
Epoch: 5, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.437 Vali Acc: 0.375 Test Loss: 1.437 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9537100791931152
Epoch: 6, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.8690156936645508
Epoch: 7, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.382 Vali Acc: 0.425 Test Loss: 1.382 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 1.03891921043396
Epoch: 8, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.316 Vali Acc: 0.375 Test Loss: 1.316 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.877098560333252
Epoch: 9, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.243 Vali Acc: 0.375 Test Loss: 1.243 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8331894874572754
Epoch: 10, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.7224302291870117
Epoch: 11, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8583745956420898
Epoch: 12, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.0384790897369385
Epoch: 13, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.104 Vali Acc: 0.525 Test Loss: 1.104 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.957298994064331
Epoch: 14, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.046 Vali Acc: 0.625 Test Loss: 1.046 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.9239976406097412
Epoch: 15, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.979 Vali Acc: 0.575 Test Loss: 0.979 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.006101369857788
Epoch: 16, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 0.8951196670532227
Epoch: 17, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 0.7756993770599365
Epoch: 18, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.8705494403839111
Epoch: 19, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.724 Vali Acc: 0.800 Test Loss: 0.724 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.845923900604248
Epoch: 20, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 0.9744832515716553
Epoch: 21, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.7851078510284424
Epoch: 22, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.8723158836364746
Epoch: 23, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.968834638595581
Epoch: 24, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.106489658355713
Epoch: 25, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.803692102432251
Epoch: 26, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.1879746913909912
Epoch: 27, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8401215076446533
Epoch: 28, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9098281860351562
Epoch: 29, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0457444190979004
Epoch: 30, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9192790985107422
Epoch: 31, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0780563354492188
Epoch: 32, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9765784740447998
Epoch: 33, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.9554660320281982
Epoch: 34, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.9309463500976562
Epoch: 35, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8972527980804443
Epoch: 36, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.997725248336792
Epoch: 37, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.078315258026123
Epoch: 38, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9411666393280029
Epoch: 39, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9117560386657715
Epoch: 40, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7732234001159668
Epoch: 41, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8141214847564697
Epoch: 42, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9197499752044678
Epoch: 43, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9584925174713135
Epoch: 44, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 920064
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.170928478240967
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.489 Vali Acc: 0.250 Test Loss: 1.489 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.9299483299255371
Epoch: 2, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.0468337535858154
Epoch: 3, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.410 Vali Acc: 0.350 Test Loss: 1.410 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.9874989986419678
Epoch: 4, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.374 Vali Acc: 0.350 Test Loss: 1.374 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.0127828121185303
Epoch: 5, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.349 Vali Acc: 0.275 Test Loss: 1.349 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.093794584274292
Epoch: 6, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.330 Vali Acc: 0.300 Test Loss: 1.330 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9346036911010742
Epoch: 7, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.312 Vali Acc: 0.425 Test Loss: 1.312 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.8484549522399902
Epoch: 8, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.306 Vali Acc: 0.475 Test Loss: 1.306 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.9751574993133545
Epoch: 9, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.975393533706665
Epoch: 10, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.221 Vali Acc: 0.425 Test Loss: 1.221 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9959824085235596
Epoch: 11, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.193 Vali Acc: 0.425 Test Loss: 1.193 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8609836101531982
Epoch: 12, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.159 Vali Acc: 0.450 Test Loss: 1.159 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9059598445892334
Epoch: 13, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.107 Vali Acc: 0.575 Test Loss: 1.107 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 0.9448704719543457
Epoch: 14, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.0736076831817627
Epoch: 15, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.046 Vali Acc: 0.575 Test Loss: 1.046 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9542391300201416
Epoch: 16, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.9752583503723145
Epoch: 17, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.981 Vali Acc: 0.575 Test Loss: 0.981 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9046766757965088
Epoch: 18, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.937 Vali Acc: 0.600 Test Loss: 0.937 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0829761028289795
Epoch: 19, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.9525229930877686
Epoch: 20, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.881 Vali Acc: 0.675 Test Loss: 0.881 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9644391536712646
Epoch: 21, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 0.8686578273773193
Epoch: 22, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 1.159667730331421
Epoch: 23, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.747 Vali Acc: 0.700 Test Loss: 0.747 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9009683132171631
Epoch: 24, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.750 Vali Acc: 0.625 Test Loss: 0.750 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8853311538696289
Epoch: 25, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.014704942703247
Epoch: 26, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9000434875488281
Epoch: 27, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 1.0747339725494385
Epoch: 28, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 0.9689393043518066
Epoch: 29, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9681391716003418
Epoch: 30, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.8832724094390869
Epoch: 31, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2153494358062744
Epoch: 32, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4364533424377441
Epoch: 33, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4600820541381836
Epoch: 34, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1402792930603027
Epoch: 35, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.625 Vali Acc: 0.825 Test Loss: 0.625 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0866587162017822
Epoch: 36, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1820454597473145
Epoch: 37, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0710387229919434
Epoch: 38, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 1.2377052307128906
Epoch: 39, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.628 Vali Acc: 0.825 Test Loss: 0.628 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2215099334716797
Epoch: 40, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 1.2922031879425049
Epoch: 41, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 1.1474273204803467
Epoch: 42, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3687522411346436
Epoch: 43, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1346814632415771
Epoch: 44, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0750634670257568
Epoch: 45, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3729734420776367
Epoch: 46, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3765382766723633
Epoch: 47, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2211790084838867
Epoch: 48, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.612 Vali Acc: 0.825 Test Loss: 0.612 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4738006591796875
Epoch: 49, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.615 Vali Acc: 0.825 Test Loss: 0.615 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.338761806488037
Epoch: 50, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4758703708648682
Epoch: 51, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 918848
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.692686080932617
Epoch: 1, Steps: 3 | Train Loss: 1.568 Vali Loss: 1.451 Vali Acc: 0.275 Test Loss: 1.451 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.5051865577697754
Epoch: 2, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.422 Vali Acc: 0.250 Test Loss: 1.422 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2581663131713867
Epoch: 3, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.393 Vali Acc: 0.300 Test Loss: 1.393 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.330021619796753
Epoch: 4, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.392 Vali Acc: 0.300 Test Loss: 1.392 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 1.159653663635254
Epoch: 5, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.432 Vali Acc: 0.375 Test Loss: 1.432 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.1980750560760498
Epoch: 6, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.438 Vali Acc: 0.375 Test Loss: 1.438 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0455970764160156
Epoch: 7, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.410 Vali Acc: 0.375 Test Loss: 1.410 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 1.299008846282959
Epoch: 8, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 1.1936264038085938
Epoch: 9, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.247 Vali Acc: 0.475 Test Loss: 1.247 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 1.0314087867736816
Epoch: 10, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.186 Vali Acc: 0.575 Test Loss: 1.186 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 1.281663417816162
Epoch: 11, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 1.1132557392120361
Epoch: 12, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.089 Vali Acc: 0.625 Test Loss: 1.089 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.149655818939209
Epoch: 13, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.071 Vali Acc: 0.625 Test Loss: 1.071 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.2302525043487549
Epoch: 14, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.052 Vali Acc: 0.550 Test Loss: 1.052 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.129786729812622
Epoch: 15, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 1.2766108512878418
Epoch: 16, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 1.3840913772583008
Epoch: 17, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.963 Vali Acc: 0.650 Test Loss: 0.963 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9717233180999756
Epoch: 18, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.1416189670562744
Epoch: 19, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.9902751445770264
Epoch: 20, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.839 Vali Acc: 0.850 Test Loss: 0.839 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.9536285400390625
Epoch: 21, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9183542728424072
Epoch: 22, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 1.2669095993041992
Epoch: 23, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0850975513458252
Epoch: 24, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1763076782226562
Epoch: 25, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0275788307189941
Epoch: 26, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 0.9485211372375488
Epoch: 27, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 28 cost time: 1.0641186237335205
Epoch: 28, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.387364387512207
Epoch: 29, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3169140815734863
Epoch: 30, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.273427963256836
Epoch: 31, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3632006645202637
Epoch: 32, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 1.2488901615142822
Epoch: 33, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1871743202209473
Epoch: 34, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 35 cost time: 1.0800118446350098
Epoch: 35, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2314960956573486
Epoch: 36, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.290132761001587
Epoch: 37, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.255371332168579
Epoch: 38, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.140303134918213
Epoch: 39, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1844151020050049
Epoch: 40, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4377102851867676
Epoch: 41, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0857999324798584
Epoch: 42, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9244208335876465
Epoch: 43, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2597014904022217
Epoch: 44, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 917632
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0350239276885986
Epoch: 1, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.422 Vali Acc: 0.375 Test Loss: 1.422 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8994746208190918
Epoch: 2, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.1820788383483887
Epoch: 3, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.400 Vali Acc: 0.225 Test Loss: 1.400 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2396349906921387
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.414 Vali Acc: 0.325 Test Loss: 1.414 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1706581115722656
Epoch: 5, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.440 Vali Acc: 0.350 Test Loss: 1.440 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0562264919281006
Epoch: 6, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.426 Vali Acc: 0.425 Test Loss: 1.426 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 1.2910420894622803
Epoch: 7, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.158174991607666
Epoch: 8, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2804887294769287
Epoch: 9, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.261 Vali Acc: 0.450 Test Loss: 1.261 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4174728393554688
Epoch: 10, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.38897705078125
Epoch: 11, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.171 Vali Acc: 0.450 Test Loss: 1.171 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.272371530532837
Epoch: 12, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.139 Vali Acc: 0.575 Test Loss: 1.139 Test Acc: 0.575
Validation loss decreased (-0.499986 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.9272170066833496
Epoch: 13, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.125 Vali Acc: 0.475 Test Loss: 1.125 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0170812606811523
Epoch: 14, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.6491124629974365
Epoch: 15, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.004 Vali Acc: 0.525 Test Loss: 1.004 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9773056507110596
Epoch: 16, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.920 Vali Acc: 0.625 Test Loss: 0.920 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1009252071380615
Epoch: 17, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.1174812316894531
Epoch: 18, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.824 Vali Acc: 0.625 Test Loss: 0.824 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2382464408874512
Epoch: 19, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 1.2564697265625
Epoch: 20, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.368129014968872
Epoch: 21, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 1.226083755493164
Epoch: 22, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0045459270477295
Epoch: 23, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0332984924316406
Epoch: 24, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.1497321128845215
Epoch: 25, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.2433679103851318
Epoch: 26, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0945165157318115
Epoch: 27, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.490 Vali Acc: 0.925 Test Loss: 0.490 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.4571008682250977
Epoch: 28, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8515524864196777
Epoch: 29, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1684114933013916
Epoch: 30, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 1.1046056747436523
Epoch: 31, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0620298385620117
Epoch: 32, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4234018325805664
Epoch: 33, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1154990196228027
Epoch: 34, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.103391408920288
Epoch: 35, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5677919387817383
Epoch: 36, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0258803367614746
Epoch: 37, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0729897022247314
Epoch: 38, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2153396606445312
Epoch: 39, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2278900146484375
Epoch: 40, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 916416
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9375252723693848
Epoch: 1, Steps: 3 | Train Loss: 1.846 Vali Loss: 1.679 Vali Acc: 0.250 Test Loss: 1.679 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 0.9105274677276611
Epoch: 2, Steps: 3 | Train Loss: 1.604 Vali Loss: 1.586 Vali Acc: 0.250 Test Loss: 1.586 Test Acc: 0.250
Validation loss decreased (-0.249983 --> -0.249984).  Saving model ...
Epoch: 3 cost time: 1.0332202911376953
Epoch: 3, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.496 Vali Acc: 0.275 Test Loss: 1.496 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.9005520343780518
Epoch: 4, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.438 Vali Acc: 0.325 Test Loss: 1.438 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.1153209209442139
Epoch: 5, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.207777976989746
Epoch: 6, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0216388702392578
Epoch: 7, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.430 Vali Acc: 0.375 Test Loss: 1.430 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.9757072925567627
Epoch: 8, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 1.054861307144165
Epoch: 9, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.9946637153625488
Epoch: 10, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.297 Vali Acc: 0.425 Test Loss: 1.297 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 0.9633183479309082
Epoch: 11, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.996161937713623
Epoch: 12, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 1.1104991436004639
Epoch: 13, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.200 Vali Acc: 0.475 Test Loss: 1.200 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 1.1835441589355469
Epoch: 14, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.154 Vali Acc: 0.475 Test Loss: 1.154 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 1.0837962627410889
Epoch: 15, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 1.083890676498413
Epoch: 16, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.073 Vali Acc: 0.550 Test Loss: 1.073 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.1316289901733398
Epoch: 17, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.549989 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 1.1670846939086914
Epoch: 18, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.918 Vali Acc: 0.625 Test Loss: 0.918 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2386507987976074
Epoch: 19, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.865 Vali Acc: 0.725 Test Loss: 0.865 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9456112384796143
Epoch: 20, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.642892837524414
Epoch: 21, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0432679653167725
Epoch: 22, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.775 Vali Acc: 0.725 Test Loss: 0.775 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.062849521636963
Epoch: 23, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1941745281219482
Epoch: 24, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.3366100788116455
Epoch: 25, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.0409760475158691
Epoch: 26, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4209375381469727
Epoch: 27, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1517443656921387
Epoch: 28, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 1.1261231899261475
Epoch: 29, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1528749465942383
Epoch: 30, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1078999042510986
Epoch: 31, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.9872000217437744
Epoch: 32, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.0903360843658447
Epoch: 33, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.457810878753662
Epoch: 34, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0425488948822021
Epoch: 35, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1091325283050537
Epoch: 36, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.041421890258789
Epoch: 37, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0387036800384521
Epoch: 38, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0007834434509277
Epoch: 39, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.088428020477295
Epoch: 40, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.410 Vali Acc: 0.825 Test Loss: 0.410 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1359355449676514
Epoch: 41, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2120099067687988
Epoch: 42, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1185500621795654
Epoch: 43, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.036858081817627
Epoch: 44, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2741756439208984
Epoch: 45, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.056450366973877
Epoch: 46, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1649818420410156
Epoch: 47, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0261642932891846
Epoch: 48, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9336614608764648
Epoch: 49, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 771456
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.667680263519287
Epoch: 1, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.428 Vali Acc: 0.275 Test Loss: 1.428 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8942351341247559
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.412 Vali Acc: 0.300 Test Loss: 1.412 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.0903830528259277
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.387 Vali Acc: 0.425 Test Loss: 1.387 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 1.277836561203003
Epoch: 4, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0346472263336182
Epoch: 5, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.342 Vali Acc: 0.250 Test Loss: 1.342 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.424036979675293
Epoch: 6, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1234142780303955
Epoch: 7, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
Validation loss decreased (-0.424986 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 1.302647352218628
Epoch: 8, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.295 Vali Acc: 0.600 Test Loss: 1.295 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 1.03755784034729
Epoch: 9, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.282 Vali Acc: 0.575 Test Loss: 1.282 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.049260139465332
Epoch: 10, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.026207685470581
Epoch: 11, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.220 Vali Acc: 0.475 Test Loss: 1.220 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.154590368270874
Epoch: 12, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5429911613464355
Epoch: 13, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.105 Vali Acc: 0.575 Test Loss: 1.105 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6423964500427246
Epoch: 14, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 1.7902805805206299
Epoch: 15, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.019 Vali Acc: 0.775 Test Loss: 1.019 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774990).  Saving model ...
Epoch: 16 cost time: 1.0789146423339844
Epoch: 16, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.998 Vali Acc: 0.500 Test Loss: 0.998 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.128969430923462
Epoch: 17, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.977 Vali Acc: 0.750 Test Loss: 0.977 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2637617588043213
Epoch: 18, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.894 Vali Acc: 0.650 Test Loss: 0.894 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0730016231536865
Epoch: 19, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4697940349578857
Epoch: 20, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.0483510494232178
Epoch: 21, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.691 Vali Acc: 0.875 Test Loss: 0.691 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 1.4282326698303223
Epoch: 22, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 1.3114135265350342
Epoch: 23, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 1.1203296184539795
Epoch: 24, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.0707659721374512
Epoch: 25, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 1.3189411163330078
Epoch: 26, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.2532317638397217
Epoch: 27, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2512469291687012
Epoch: 28, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.488 Vali Acc: 0.825 Test Loss: 0.488 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3020451068878174
Epoch: 29, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.0487115383148193
Epoch: 30, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.506 Vali Acc: 0.675 Test Loss: 0.506 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0103564262390137
Epoch: 31, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2427666187286377
Epoch: 32, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.451 Vali Acc: 0.825 Test Loss: 0.451 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1079685688018799
Epoch: 33, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3407294750213623
Epoch: 34, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 1.153590440750122
Epoch: 35, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4091465473175049
Epoch: 36, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3168017864227295
Epoch: 37, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2598721981048584
Epoch: 38, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.934483528137207
Epoch: 39, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1555147171020508
Epoch: 40, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2603683471679688
Epoch: 41, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1106359958648682
Epoch: 42, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.185603380203247
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5624840259552002
Epoch: 44, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7143921852111816
Epoch: 45, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4761371612548828
Epoch: 46, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1180901527404785
Epoch: 47, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.2016186714172363
Epoch: 48, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1207506656646729
Epoch: 49, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.155076503753662
Epoch: 50, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.2602615356445312
Epoch: 51, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1810035705566406
Epoch: 52, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0322847366333008
Epoch: 53, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0598783493041992
Epoch: 54, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.8301427364349365
Epoch: 55, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2565524578094482
Epoch: 56, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4661145210266113
Epoch: 57, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1851177215576172
Epoch: 58, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.183147668838501
Epoch: 59, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2839679718017578
Epoch: 60, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 770240
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.251075267791748
Epoch: 1, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.2093756198883057
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.477 Vali Acc: 0.300 Test Loss: 1.477 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.0547285079956055
Epoch: 3, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.431 Vali Acc: 0.350 Test Loss: 1.431 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.2319927215576172
Epoch: 4, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.392 Vali Acc: 0.375 Test Loss: 1.392 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.386261224746704
Epoch: 5, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1388130187988281
Epoch: 6, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.0576040744781494
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.1921193599700928
Epoch: 8, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.293 Vali Acc: 0.575 Test Loss: 1.293 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 1.139589548110962
Epoch: 9, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.368016242980957
Epoch: 10, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4976119995117188
Epoch: 11, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
Validation loss decreased (-0.574987 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 1.229541301727295
Epoch: 12, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.224 Vali Acc: 0.700 Test Loss: 1.224 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 1.1698119640350342
Epoch: 13, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.170 Vali Acc: 0.700 Test Loss: 1.170 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 14 cost time: 1.3765811920166016
Epoch: 14, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.190755844116211
Epoch: 15, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 1.3424222469329834
Epoch: 16, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.031 Vali Acc: 0.525 Test Loss: 1.031 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6847870349884033
Epoch: 17, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3417978286743164
Epoch: 18, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.897 Vali Acc: 0.825 Test Loss: 0.897 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824991).  Saving model ...
Epoch: 19 cost time: 1.0803554058074951
Epoch: 19, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0729107856750488
Epoch: 20, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 21 cost time: 1.1960639953613281
Epoch: 21, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.677 Vali Acc: 0.875 Test Loss: 0.677 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 1.3525536060333252
Epoch: 22, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2654681205749512
Epoch: 23, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4783875942230225
Epoch: 24, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5508882999420166
Epoch: 25, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.561 Vali Acc: 0.925 Test Loss: 0.561 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 1.0714316368103027
Epoch: 26, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.2884929180145264
Epoch: 27, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.485 Vali Acc: 0.825 Test Loss: 0.485 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1474637985229492
Epoch: 28, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.500 Vali Acc: 0.725 Test Loss: 0.500 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3696651458740234
Epoch: 29, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1892461776733398
Epoch: 30, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.449 Vali Acc: 0.700 Test Loss: 0.449 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1445558071136475
Epoch: 31, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 1.4240448474884033
Epoch: 32, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2271039485931396
Epoch: 33, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0833308696746826
Epoch: 34, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1785054206848145
Epoch: 35, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.228522777557373
Epoch: 36, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.084822416305542
Epoch: 37, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.200873613357544
Epoch: 38, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2858996391296387
Epoch: 39, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.017531156539917
Epoch: 40, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1213726997375488
Epoch: 41, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 769024
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.348520517349243
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.467 Vali Acc: 0.075 Test Loss: 1.467 Test Acc: 0.075
Validation loss decreased (inf --> -0.074985).  Saving model ...
Epoch: 2 cost time: 1.0222673416137695
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.464 Vali Acc: 0.150 Test Loss: 1.464 Test Acc: 0.150
Validation loss decreased (-0.074985 --> -0.149985).  Saving model ...
Epoch: 3 cost time: 1.028968334197998
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.468 Vali Acc: 0.200 Test Loss: 1.468 Test Acc: 0.200
Validation loss decreased (-0.149985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 1.1730835437774658
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.482 Vali Acc: 0.400 Test Loss: 1.482 Test Acc: 0.400
Validation loss decreased (-0.199985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.216109037399292
Epoch: 5, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.477 Vali Acc: 0.325 Test Loss: 1.477 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2461636066436768
Epoch: 6, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.459 Vali Acc: 0.325 Test Loss: 1.459 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3748269081115723
Epoch: 7, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.414 Vali Acc: 0.350 Test Loss: 1.414 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2239587306976318
Epoch: 8, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.9189493656158447
Epoch: 9, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.297 Vali Acc: 0.475 Test Loss: 1.297 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 1.295663595199585
Epoch: 10, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.257 Vali Acc: 0.600 Test Loss: 1.257 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.4085147380828857
Epoch: 11, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1770963668823242
Epoch: 12, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.219 Vali Acc: 0.450 Test Loss: 1.219 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1021459102630615
Epoch: 13, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.167 Vali Acc: 0.575 Test Loss: 1.167 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2163355350494385
Epoch: 14, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4800398349761963
Epoch: 15, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.064 Vali Acc: 0.575 Test Loss: 1.064 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.063859224319458
Epoch: 16, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 1.1445345878601074
Epoch: 17, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.951 Vali Acc: 0.775 Test Loss: 0.951 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.3530023097991943
Epoch: 18, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.895 Vali Acc: 0.700 Test Loss: 0.895 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1585681438446045
Epoch: 19, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5659406185150146
Epoch: 20, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.833 Vali Acc: 0.700 Test Loss: 0.833 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1150777339935303
Epoch: 21, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.9604103565216064
Epoch: 22, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 1.121483325958252
Epoch: 23, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 1.0985050201416016
Epoch: 24, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.1206440925598145
Epoch: 25, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1143970489501953
Epoch: 26, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.578 Vali Acc: 0.875 Test Loss: 0.578 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 1.1647169589996338
Epoch: 27, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 1.0331685543060303
Epoch: 28, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3538744449615479
Epoch: 29, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2792410850524902
Epoch: 30, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 1.3330152034759521
Epoch: 31, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2464649677276611
Epoch: 32, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2489581108093262
Epoch: 33, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.454 Vali Acc: 0.825 Test Loss: 0.454 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5433826446533203
Epoch: 34, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.091355800628662
Epoch: 35, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 1.2805700302124023
Epoch: 36, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.299407958984375
Epoch: 37, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0246877670288086
Epoch: 38, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 1.0335607528686523
Epoch: 39, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.234330415725708
Epoch: 40, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4036588668823242
Epoch: 41, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1372337341308594
Epoch: 42, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 1.002964735031128
Epoch: 43, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.301720142364502
Epoch: 44, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3001134395599365
Epoch: 45, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3678667545318604
Epoch: 46, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2120325565338135
Epoch: 47, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.990929365158081
Epoch: 48, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2981913089752197
Epoch: 49, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 1.4103829860687256
Epoch: 50, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 51 cost time: 1.0335392951965332
Epoch: 51, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2437777519226074
Epoch: 52, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3589556217193604
Epoch: 53, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1189932823181152
Epoch: 54, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.172555923461914
Epoch: 55, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.021054744720459
Epoch: 56, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9982993602752686
Epoch: 57, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2888875007629395
Epoch: 58, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.271517276763916
Epoch: 59, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1464576721191406
Epoch: 60, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 767808
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.404847860336304
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.353 Vali Acc: 0.225 Test Loss: 1.353 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.1131129264831543
Epoch: 2, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.339 Vali Acc: 0.225 Test Loss: 1.339 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.9358305931091309
Epoch: 3, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.343 Vali Acc: 0.450 Test Loss: 1.343 Test Acc: 0.450
Validation loss decreased (-0.224987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.99983811378479
Epoch: 4, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2851555347442627
Epoch: 5, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.395 Vali Acc: 0.300 Test Loss: 1.395 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0115604400634766
Epoch: 6, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.381 Vali Acc: 0.350 Test Loss: 1.381 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.054938793182373
Epoch: 7, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.345 Vali Acc: 0.475 Test Loss: 1.345 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 1.1589770317077637
Epoch: 8, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.286 Vali Acc: 0.375 Test Loss: 1.286 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3542611598968506
Epoch: 9, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.229 Vali Acc: 0.550 Test Loss: 1.229 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 1.2285168170928955
Epoch: 10, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.167 Vali Acc: 0.700 Test Loss: 1.167 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 1.1147820949554443
Epoch: 11, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.139 Vali Acc: 0.600 Test Loss: 1.139 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.300201177597046
Epoch: 12, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.043031930923462
Epoch: 13, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1261792182922363
Epoch: 14, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.294238567352295
Epoch: 15, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.968 Vali Acc: 0.775 Test Loss: 0.968 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 16 cost time: 1.1965901851654053
Epoch: 16, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.9809598922729492
Epoch: 17, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4104883670806885
Epoch: 18, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0945301055908203
Epoch: 19, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.0901329517364502
Epoch: 20, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.9571032524108887
Epoch: 21, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.082306146621704
Epoch: 22, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3509199619293213
Epoch: 23, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 1.19008207321167
Epoch: 24, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.628 Vali Acc: 0.800 Test Loss: 0.628 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 1.1469719409942627
Epoch: 25, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3052926063537598
Epoch: 26, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 1.1326944828033447
Epoch: 27, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 1.2748546600341797
Epoch: 28, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2456505298614502
Epoch: 29, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1953697204589844
Epoch: 30, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0213379859924316
Epoch: 31, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9822087287902832
Epoch: 32, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.227942943572998
Epoch: 33, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.454789638519287
Epoch: 34, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.381263256072998
Epoch: 35, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.121405839920044
Epoch: 36, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4694931507110596
Epoch: 37, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 763040
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9682693481445312
Epoch: 1, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.562 Vali Acc: 0.300 Test Loss: 1.562 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.9037141799926758
Epoch: 2, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.502 Vali Acc: 0.325 Test Loss: 1.502 Test Acc: 0.325
Validation loss decreased (-0.299984 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.9138569831848145
Epoch: 3, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
Validation loss decreased (-0.324985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.8955385684967041
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.371 Vali Acc: 0.475 Test Loss: 1.371 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474986).  Saving model ...
Epoch: 5 cost time: 0.9701910018920898
Epoch: 5, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5602104663848877
Epoch: 6, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3796679973602295
Epoch: 7, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.313 Vali Acc: 0.375 Test Loss: 1.313 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0633692741394043
Epoch: 8, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.194117546081543
Epoch: 9, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3115041255950928
Epoch: 10, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.245 Vali Acc: 0.625 Test Loss: 1.245 Test Acc: 0.625
Validation loss decreased (-0.474986 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 1.177860975265503
Epoch: 11, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9182674884796143
Epoch: 12, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.154 Vali Acc: 0.650 Test Loss: 1.154 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 1.0394198894500732
Epoch: 13, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0817863941192627
Epoch: 14, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 1.0122590065002441
Epoch: 15, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 1.065887689590454
Epoch: 16, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 1.3953065872192383
Epoch: 17, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 1.188671350479126
Epoch: 18, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.674991 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.3119938373565674
Epoch: 19, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2797255516052246
Epoch: 20, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3409440517425537
Epoch: 21, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.0468378067016602
Epoch: 22, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.9195106029510498
Epoch: 23, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 1.111790657043457
Epoch: 24, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.644 Vali Acc: 0.825 Test Loss: 0.644 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 1.0195322036743164
Epoch: 25, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 1.2671353816986084
Epoch: 26, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 1.1030704975128174
Epoch: 27, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.341829776763916
Epoch: 28, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 29 cost time: 1.1845784187316895
Epoch: 29, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 1.0482113361358643
Epoch: 30, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1063299179077148
Epoch: 31, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 32 cost time: 0.825721263885498
Epoch: 32, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2536907196044922
Epoch: 33, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1818194389343262
Epoch: 34, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.074296474456787
Epoch: 35, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3099629878997803
Epoch: 36, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.196124792098999
Epoch: 37, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2736930847167969
Epoch: 38, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9580683708190918
Epoch: 39, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1356797218322754
Epoch: 40, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1951549053192139
Epoch: 41, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 762432
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9228804111480713
Epoch: 1, Steps: 3 | Train Loss: 1.677 Vali Loss: 1.614 Vali Acc: 0.250 Test Loss: 1.614 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 1.13020920753479
Epoch: 2, Steps: 3 | Train Loss: 1.591 Vali Loss: 1.531 Vali Acc: 0.250 Test Loss: 1.531 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.8534798622131348
Epoch: 3, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.433 Vali Acc: 0.200 Test Loss: 1.433 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9493916034698486
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (-0.249985 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.1683707237243652
Epoch: 5, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.354 Vali Acc: 0.350 Test Loss: 1.354 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.112915277481079
Epoch: 6, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1484711170196533
Epoch: 7, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.9191298484802246
Epoch: 8, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 1.1750922203063965
Epoch: 9, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 1.0614817142486572
Epoch: 10, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.174 Vali Acc: 0.550 Test Loss: 1.174 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2868521213531494
Epoch: 11, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.158 Vali Acc: 0.525 Test Loss: 1.158 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.913916826248169
Epoch: 12, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.122 Vali Acc: 0.550 Test Loss: 1.122 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9613547325134277
Epoch: 13, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.9101784229278564
Epoch: 14, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.9016494750976562
Epoch: 15, Steps: 3 | Train Loss: 0.883 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9390017986297607
Epoch: 16, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 1.2270665168762207
Epoch: 17, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
Validation loss decreased (-0.674991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.881443977355957
Epoch: 18, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 1.277775764465332
Epoch: 19, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.9401106834411621
Epoch: 20, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.759 Vali Acc: 0.825 Test Loss: 0.759 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0757770538330078
Epoch: 21, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.189638614654541
Epoch: 22, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 0.9781355857849121
Epoch: 23, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.623 Vali Acc: 0.900 Test Loss: 0.623 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.9064292907714844
Epoch: 24, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9320034980773926
Epoch: 25, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.131775140762329
Epoch: 26, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0187034606933594
Epoch: 27, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.1664094924926758
Epoch: 28, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.1116185188293457
Epoch: 29, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.237370491027832
Epoch: 30, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.159919261932373
Epoch: 31, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3288373947143555
Epoch: 32, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.9314062595367432
Epoch: 33, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0710031986236572
Epoch: 34, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 1.0945003032684326
Epoch: 35, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.178703784942627
Epoch: 36, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9630904197692871
Epoch: 37, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0466339588165283
Epoch: 38, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2015788555145264
Epoch: 39, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0757498741149902
Epoch: 40, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2056071758270264
Epoch: 41, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9534006118774414
Epoch: 42, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9836995601654053
Epoch: 43, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2712080478668213
Epoch: 44, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 761824
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.035585880279541
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.340 Vali Acc: 0.250 Test Loss: 1.340 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 1.023606538772583
Epoch: 2, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.332 Vali Acc: 0.250 Test Loss: 1.332 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.9038259983062744
Epoch: 3, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 1.0326457023620605
Epoch: 4, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.348 Vali Acc: 0.550 Test Loss: 1.348 Test Acc: 0.550
Validation loss decreased (-0.274987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 1.165804147720337
Epoch: 5, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.368 Vali Acc: 0.450 Test Loss: 1.368 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.064073085784912
Epoch: 6, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.359 Vali Acc: 0.475 Test Loss: 1.359 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5802342891693115
Epoch: 7, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.320 Vali Acc: 0.450 Test Loss: 1.320 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1918489933013916
Epoch: 8, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0444560050964355
Epoch: 9, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.191 Vali Acc: 0.600 Test Loss: 1.191 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 0.9970273971557617
Epoch: 10, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.005981206893921
Epoch: 11, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.9312865734100342
Epoch: 12, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 1.0879392623901367
Epoch: 13, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 1.0336260795593262
Epoch: 14, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.176469326019287
Epoch: 15, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0407636165618896
Epoch: 16, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.976 Vali Acc: 0.625 Test Loss: 0.976 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3547112941741943
Epoch: 17, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.967 Vali Acc: 0.650 Test Loss: 0.967 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 18 cost time: 1.3068525791168213
Epoch: 18, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 19 cost time: 1.0120601654052734
Epoch: 19, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.857 Vali Acc: 0.650 Test Loss: 0.857 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0803375244140625
Epoch: 20, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.833 Vali Acc: 0.675 Test Loss: 0.833 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 21 cost time: 1.1099822521209717
Epoch: 21, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.780 Vali Acc: 0.675 Test Loss: 0.780 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 22 cost time: 0.9080343246459961
Epoch: 22, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.738 Vali Acc: 0.725 Test Loss: 0.738 Test Acc: 0.725
Validation loss decreased (-0.674992 --> -0.724993).  Saving model ...
Epoch: 23 cost time: 0.9925887584686279
Epoch: 23, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.729 Vali Acc: 0.700 Test Loss: 0.729 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2825403213500977
Epoch: 24, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.690 Vali Acc: 0.700 Test Loss: 0.690 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0105071067810059
Epoch: 25, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.724993 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 0.9295408725738525
Epoch: 26, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0738906860351562
Epoch: 27, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.027925968170166
Epoch: 28, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8594169616699219
Epoch: 29, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.8185000419616699
Epoch: 30, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 1.212641716003418
Epoch: 31, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1626451015472412
Epoch: 32, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.99643874168396
Epoch: 33, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 0.9296855926513672
Epoch: 34, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 1.0070903301239014
Epoch: 35, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 36 cost time: 1.037343978881836
Epoch: 36, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9718937873840332
Epoch: 37, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.491 Vali Acc: 0.800 Test Loss: 0.491 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.201338529586792
Epoch: 38, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0341715812683105
Epoch: 39, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 0.9397196769714355
Epoch: 40, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9425253868103027
Epoch: 41, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9248723983764648
Epoch: 42, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 1.0500266551971436
Epoch: 43, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 44 cost time: 0.9481582641601562
Epoch: 44, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 1.4803144931793213
Epoch: 45, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.162656307220459
Epoch: 46, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5086407661437988
Epoch: 47, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1199426651000977
Epoch: 48, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5489249229431152
Epoch: 49, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2368113994598389
Epoch: 50, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1033799648284912
Epoch: 51, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.061030387878418
Epoch: 52, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.0196495056152344
Epoch: 53, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.5950121879577637
Epoch: 54, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 761216
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.458275556564331
Epoch: 1, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.558 Vali Acc: 0.275 Test Loss: 1.558 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 1.1366088390350342
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.519 Vali Acc: 0.350 Test Loss: 1.519 Test Acc: 0.350
Validation loss decreased (-0.274984 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 1.1893956661224365
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.487 Vali Acc: 0.375 Test Loss: 1.487 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 4 cost time: 1.2365732192993164
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.457 Vali Acc: 0.450 Test Loss: 1.457 Test Acc: 0.450
Validation loss decreased (-0.374985 --> -0.449985).  Saving model ...
Epoch: 5 cost time: 1.2123498916625977
Epoch: 5, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.245568037033081
Epoch: 6, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.405 Vali Acc: 0.250 Test Loss: 1.405 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4745440483093262
Epoch: 7, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.387 Vali Acc: 0.275 Test Loss: 1.387 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6466319561004639
Epoch: 8, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0634729862213135
Epoch: 9, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.328 Vali Acc: 0.350 Test Loss: 1.328 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.256361722946167
Epoch: 10, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.304 Vali Acc: 0.450 Test Loss: 1.304 Test Acc: 0.450
Validation loss decreased (-0.449985 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 1.3113508224487305
Epoch: 11, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2309486865997314
Epoch: 12, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.37013578414917
Epoch: 13, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 1.6186583042144775
Epoch: 14, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.207 Vali Acc: 0.725 Test Loss: 1.207 Test Acc: 0.725
Validation loss decreased (-0.474988 --> -0.724988).  Saving model ...
Epoch: 15 cost time: 1.3886959552764893
Epoch: 15, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.189 Vali Acc: 0.650 Test Loss: 1.189 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2282912731170654
Epoch: 16, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.151 Vali Acc: 0.575 Test Loss: 1.151 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3442230224609375
Epoch: 17, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.125 Vali Acc: 0.525 Test Loss: 1.125 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1889853477478027
Epoch: 18, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4050300121307373
Epoch: 19, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4867134094238281
Epoch: 20, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5083117485046387
Epoch: 21, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.945 Vali Acc: 0.825 Test Loss: 0.945 Test Acc: 0.825
Validation loss decreased (-0.724988 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 1.2819664478302002
Epoch: 22, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.901 Vali Acc: 0.825 Test Loss: 0.901 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 23 cost time: 1.3549821376800537
Epoch: 23, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 24 cost time: 1.2146852016448975
Epoch: 24, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.837 Vali Acc: 0.850 Test Loss: 0.837 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 1.1563856601715088
Epoch: 25, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.810 Vali Acc: 0.850 Test Loss: 0.810 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 1.3486709594726562
Epoch: 26, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1964070796966553
Epoch: 27, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4726927280426025
Epoch: 28, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3897557258605957
Epoch: 29, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.405104160308838
Epoch: 30, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 1.2266671657562256
Epoch: 31, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1887354850769043
Epoch: 32, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1941192150115967
Epoch: 33, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 1.2800445556640625
Epoch: 34, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 1.6344645023345947
Epoch: 35, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 1.4380197525024414
Epoch: 36, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.461038589477539
Epoch: 37, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4479031562805176
Epoch: 38, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 1.184513807296753
Epoch: 39, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 1.2579472064971924
Epoch: 40, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 1.3528993129730225
Epoch: 41, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0627527236938477
Epoch: 42, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2987148761749268
Epoch: 43, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7401089668273926
Epoch: 44, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 1.3422377109527588
Epoch: 45, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 1.2121307849884033
Epoch: 46, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 1.357386589050293
Epoch: 47, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 1.1685960292816162
Epoch: 48, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 1.2541885375976562
Epoch: 49, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3692095279693604
Epoch: 50, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2717833518981934
Epoch: 51, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.43630051612854
Epoch: 52, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3336787223815918
Epoch: 53, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3617212772369385
Epoch: 54, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.5733897686004639
Epoch: 55, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.4971630573272705
Epoch: 56, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.258502721786499
Epoch: 57, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 1.4761126041412354
Epoch: 58, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5554835796356201
Epoch: 59, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.6125636100769043
Epoch: 60, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.6713488101959229
Epoch: 61, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.368642807006836
Epoch: 62, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.3354394435882568
Epoch: 63, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.4206228256225586
Epoch: 64, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.250074863433838
Epoch: 65, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.3719871044158936
Epoch: 66, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 1.5052266120910645
Epoch: 67, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2351348400115967
Epoch: 68, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.0286407470703125
Epoch: 69, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 70 cost time: 1.461301565170288
Epoch: 70, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.398388147354126
Epoch: 71, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.279831886291504
Epoch: 72, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.5323359966278076
Epoch: 73, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.2258694171905518
Epoch: 74, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.3258192539215088
Epoch: 75, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.2053921222686768
Epoch: 76, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.4404792785644531
Epoch: 77, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.2370002269744873
Epoch: 78, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.1936898231506348
Epoch: 79, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 463520
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4001734256744385
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.404 Vali Acc: 0.225 Test Loss: 1.404 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.1121652126312256
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.997307300567627
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.401 Vali Acc: 0.175 Test Loss: 1.401 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5214333534240723
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.400 Vali Acc: 0.100 Test Loss: 1.400 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1863625049591064
Epoch: 5, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.403 Vali Acc: 0.325 Test Loss: 1.403 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.5358359813690186
Epoch: 6, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.401 Vali Acc: 0.350 Test Loss: 1.401 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 1.1242303848266602
Epoch: 7, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.397 Vali Acc: 0.275 Test Loss: 1.397 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1136815547943115
Epoch: 8, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.394 Vali Acc: 0.250 Test Loss: 1.394 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3427238464355469
Epoch: 9, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.376 Vali Acc: 0.250 Test Loss: 1.376 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.299833059310913
Epoch: 10, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.343 Vali Acc: 0.300 Test Loss: 1.343 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.379671573638916
Epoch: 11, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 1.255838394165039
Epoch: 12, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.274 Vali Acc: 0.525 Test Loss: 1.274 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 13 cost time: 1.420323133468628
Epoch: 13, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.231 Vali Acc: 0.575 Test Loss: 1.231 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 1.0237605571746826
Epoch: 14, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 1.1193840503692627
Epoch: 15, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.151 Vali Acc: 0.625 Test Loss: 1.151 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.9934990406036377
Epoch: 16, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2629446983337402
Epoch: 17, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.071 Vali Acc: 0.475 Test Loss: 1.071 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3370966911315918
Epoch: 18, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.048 Vali Acc: 0.475 Test Loss: 1.048 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.667438268661499
Epoch: 19, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 1.254451036453247
Epoch: 20, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1651475429534912
Epoch: 21, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 1.1773309707641602
Epoch: 22, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.891 Vali Acc: 0.575 Test Loss: 0.891 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.433948278427124
Epoch: 23, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 1.238621711730957
Epoch: 24, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 1.2873914241790771
Epoch: 25, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 1.3940093517303467
Epoch: 26, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 1.029996395111084
Epoch: 27, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 1.2329134941101074
Epoch: 28, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 1.1100330352783203
Epoch: 29, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 1.0837018489837646
Epoch: 30, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 31 cost time: 1.0912179946899414
Epoch: 31, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 32 cost time: 1.175612211227417
Epoch: 32, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 1.3645081520080566
Epoch: 33, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1671960353851318
Epoch: 34, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1530451774597168
Epoch: 35, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0401420593261719
Epoch: 36, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1731324195861816
Epoch: 37, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 38 cost time: 1.2080693244934082
Epoch: 38, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 1.595733880996704
Epoch: 39, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5340852737426758
Epoch: 40, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.504 Vali Acc: 0.825 Test Loss: 0.504 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2765483856201172
Epoch: 41, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.187910795211792
Epoch: 42, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 43 cost time: 1.1295697689056396
Epoch: 43, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.504 Vali Acc: 0.825 Test Loss: 0.504 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.828629970550537
Epoch: 44, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.43168306350708
Epoch: 45, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5274989604949951
Epoch: 46, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1376214027404785
Epoch: 47, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0840187072753906
Epoch: 48, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9891226291656494
Epoch: 49, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0216283798217773
Epoch: 50, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2386631965637207
Epoch: 51, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.2188246250152588
Epoch: 52, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 462912
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8648414611816406
Epoch: 1, Steps: 3 | Train Loss: 1.634 Vali Loss: 1.628 Vali Acc: 0.250 Test Loss: 1.628 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 1.031318187713623
Epoch: 2, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.543 Vali Acc: 0.250 Test Loss: 1.543 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.9669458866119385
Epoch: 3, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.454 Vali Acc: 0.250 Test Loss: 1.454 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 1.0304973125457764
Epoch: 4, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.382 Vali Acc: 0.300 Test Loss: 1.382 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 1.2476606369018555
Epoch: 5, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.351 Vali Acc: 0.300 Test Loss: 1.351 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.2952582836151123
Epoch: 6, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.2973299026489258
Epoch: 7, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.338 Vali Acc: 0.425 Test Loss: 1.338 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.078645944595337
Epoch: 8, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.324 Vali Acc: 0.450 Test Loss: 1.324 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 1.1947104930877686
Epoch: 9, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.303 Vali Acc: 0.450 Test Loss: 1.303 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 1.020700216293335
Epoch: 10, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.272 Vali Acc: 0.450 Test Loss: 1.272 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.9976851940155029
Epoch: 11, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 1.0936975479125977
Epoch: 12, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.223 Vali Acc: 0.425 Test Loss: 1.223 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3074052333831787
Epoch: 13, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.208 Vali Acc: 0.475 Test Loss: 1.208 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 1.1322662830352783
Epoch: 14, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.185 Vali Acc: 0.525 Test Loss: 1.185 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 1.088101863861084
Epoch: 15, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.9618301391601562
Epoch: 16, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.143 Vali Acc: 0.525 Test Loss: 1.143 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 1.2521729469299316
Epoch: 17, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 1.2946274280548096
Epoch: 18, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.074 Vali Acc: 0.525 Test Loss: 1.074 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2235348224639893
Epoch: 19, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.030 Vali Acc: 0.575 Test Loss: 1.030 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2750389575958252
Epoch: 20, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3428504467010498
Epoch: 21, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.950 Vali Acc: 0.800 Test Loss: 0.950 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 1.1094930171966553
Epoch: 22, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5654847621917725
Epoch: 23, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1236732006072998
Epoch: 24, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 1.0027799606323242
Epoch: 25, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.824 Vali Acc: 0.850 Test Loss: 0.824 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 1.371567964553833
Epoch: 26, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 1.160365343093872
Epoch: 27, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 1.402630090713501
Epoch: 28, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3419749736785889
Epoch: 29, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 1.0571279525756836
Epoch: 30, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 31 cost time: 0.8618905544281006
Epoch: 31, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4260005950927734
Epoch: 32, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5722033977508545
Epoch: 33, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2159943580627441
Epoch: 34, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4347541332244873
Epoch: 35, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.438556432723999
Epoch: 36, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0475387573242188
Epoch: 37, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0171740055084229
Epoch: 38, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.722 Vali Acc: 0.875 Test Loss: 0.722 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 39 cost time: 1.3436923027038574
Epoch: 39, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.715 Vali Acc: 0.900 Test Loss: 0.715 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 40 cost time: 1.173560380935669
Epoch: 40, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.726 Vali Acc: 0.825 Test Loss: 0.726 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.242189645767212
Epoch: 41, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.295541763305664
Epoch: 42, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3334827423095703
Epoch: 43, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.477797031402588
Epoch: 44, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2085988521575928
Epoch: 45, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1314103603363037
Epoch: 46, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9960715770721436
Epoch: 47, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.678696632385254
Epoch: 48, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.693 Vali Acc: 0.900 Test Loss: 0.693 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 49 cost time: 1.0597641468048096
Epoch: 49, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1288702487945557
Epoch: 50, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.686 Vali Acc: 0.875 Test Loss: 0.686 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0350100994110107
Epoch: 51, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1246960163116455
Epoch: 52, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.699 Vali Acc: 0.875 Test Loss: 0.699 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1001088619232178
Epoch: 53, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.688 Vali Acc: 0.875 Test Loss: 0.688 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9827632904052734
Epoch: 54, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.294135570526123
Epoch: 55, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9307188987731934
Epoch: 56, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.182356595993042
Epoch: 57, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.717 Vali Acc: 0.875 Test Loss: 0.717 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9742615222930908
Epoch: 58, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 59 cost time: 0.966543436050415
Epoch: 59, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 60 cost time: 1.276498794555664
Epoch: 60, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2082571983337402
Epoch: 61, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.4118752479553223
Epoch: 62, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.198241949081421
Epoch: 63, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.653 Vali Acc: 0.900 Test Loss: 0.653 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.292182207107544
Epoch: 64, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.3141746520996094
Epoch: 65, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.090717077255249
Epoch: 66, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.6677513122558594
Epoch: 67, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.339303731918335
Epoch: 68, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.324488878250122
Epoch: 69, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.705 Vali Acc: 0.875 Test Loss: 0.705 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 462304
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4881107807159424
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.457 Vali Acc: 0.325 Test Loss: 1.457 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.13606858253479
Epoch: 2, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.440 Vali Acc: 0.300 Test Loss: 1.440 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0446815490722656
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.416 Vali Acc: 0.375 Test Loss: 1.416 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.220510721206665
Epoch: 4, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.192789077758789
Epoch: 5, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.3243403434753418
Epoch: 6, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.1138129234313965
Epoch: 7, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.340 Vali Acc: 0.425 Test Loss: 1.340 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3657426834106445
Epoch: 8, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.327 Vali Acc: 0.475 Test Loss: 1.327 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0733635425567627
Epoch: 9, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.311 Vali Acc: 0.550 Test Loss: 1.311 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 1.1948227882385254
Epoch: 10, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.301 Vali Acc: 0.575 Test Loss: 1.301 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 11 cost time: 1.1337122917175293
Epoch: 11, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.293 Vali Acc: 0.650 Test Loss: 1.293 Test Acc: 0.650
Validation loss decreased (-0.574987 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 1.027503490447998
Epoch: 12, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.254 Vali Acc: 0.700 Test Loss: 1.254 Test Acc: 0.700
Validation loss decreased (-0.649987 --> -0.699987).  Saving model ...
Epoch: 13 cost time: 1.0812315940856934
Epoch: 13, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.212 Vali Acc: 0.625 Test Loss: 1.212 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6338050365447998
Epoch: 14, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.190 Vali Acc: 0.625 Test Loss: 1.190 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4139947891235352
Epoch: 15, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2197020053863525
Epoch: 16, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.150 Vali Acc: 0.650 Test Loss: 1.150 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1695716381072998
Epoch: 17, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.130 Vali Acc: 0.750 Test Loss: 1.130 Test Acc: 0.750
Validation loss decreased (-0.699987 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 1.0419065952301025
Epoch: 18, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.111 Vali Acc: 0.775 Test Loss: 1.111 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 19 cost time: 1.3712289333343506
Epoch: 19, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.096 Vali Acc: 0.750 Test Loss: 1.096 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.375439167022705
Epoch: 20, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.100 Vali Acc: 0.775 Test Loss: 1.100 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 21 cost time: 1.3548872470855713
Epoch: 21, Steps: 3 | Train Loss: 0.730 Vali Loss: 1.063 Vali Acc: 0.775 Test Loss: 1.063 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 22 cost time: 1.0208220481872559
Epoch: 22, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.995 Vali Acc: 0.775 Test Loss: 0.995 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 23 cost time: 1.109910011291504
Epoch: 23, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.388981580734253
Epoch: 24, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.912 Vali Acc: 0.800 Test Loss: 0.912 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 1.6221566200256348
Epoch: 25, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3617756366729736
Epoch: 26, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.23502516746521
Epoch: 27, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3212008476257324
Epoch: 28, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3055651187896729
Epoch: 29, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 1.181619644165039
Epoch: 30, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.760 Vali Acc: 0.875 Test Loss: 0.760 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 31 cost time: 1.4781594276428223
Epoch: 31, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4127843379974365
Epoch: 32, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.782 Vali Acc: 0.800 Test Loss: 0.782 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.498206377029419
Epoch: 33, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.718 Vali Acc: 0.825 Test Loss: 0.718 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1435415744781494
Epoch: 34, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3167827129364014
Epoch: 35, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.064209222793579
Epoch: 36, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9603695869445801
Epoch: 37, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9252307415008545
Epoch: 38, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1494340896606445
Epoch: 39, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.286560297012329
Epoch: 40, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 461696
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4001576900482178
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.367 Vali Acc: 0.425 Test Loss: 1.367 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 1.1569087505340576
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 1.214808464050293
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5016908645629883
Epoch: 4, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0207462310791016
Epoch: 5, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.355 Vali Acc: 0.425 Test Loss: 1.355 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.099548578262329
Epoch: 6, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.354 Vali Acc: 0.300 Test Loss: 1.354 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1286718845367432
Epoch: 7, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2950055599212646
Epoch: 8, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.328 Vali Acc: 0.350 Test Loss: 1.328 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3808107376098633
Epoch: 9, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.306 Vali Acc: 0.475 Test Loss: 1.306 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 1.313685655593872
Epoch: 10, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.272 Vali Acc: 0.525 Test Loss: 1.272 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 1.5089666843414307
Epoch: 11, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.229 Vali Acc: 0.575 Test Loss: 1.229 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.2818334102630615
Epoch: 12, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.196 Vali Acc: 0.675 Test Loss: 1.196 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674988).  Saving model ...
Epoch: 13 cost time: 1.1358327865600586
Epoch: 13, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.168 Vali Acc: 0.675 Test Loss: 1.168 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 14 cost time: 1.14046049118042
Epoch: 14, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.136 Vali Acc: 0.650 Test Loss: 1.136 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0446100234985352
Epoch: 15, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 1.4649658203125
Epoch: 16, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2845358848571777
Epoch: 17, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 1.2585957050323486
Epoch: 18, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1305360794067383
Epoch: 19, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1171650886535645
Epoch: 20, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0680313110351562
Epoch: 21, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 1.1980464458465576
Epoch: 22, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 1.438063144683838
Epoch: 23, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.869 Vali Acc: 0.900 Test Loss: 0.869 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899991).  Saving model ...
Epoch: 24 cost time: 1.0519444942474365
Epoch: 24, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2027256488800049
Epoch: 25, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.801 Vali Acc: 0.875 Test Loss: 0.801 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0563545227050781
Epoch: 26, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.257500171661377
Epoch: 27, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.765 Vali Acc: 0.650 Test Loss: 0.765 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8826906681060791
Epoch: 28, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0943610668182373
Epoch: 29, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.723 Vali Acc: 0.900 Test Loss: 0.723 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899993).  Saving model ...
Epoch: 30 cost time: 1.2480804920196533
Epoch: 30, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.714 Vali Acc: 0.875 Test Loss: 0.714 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2477269172668457
Epoch: 31, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.701 Vali Acc: 0.900 Test Loss: 0.701 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 32 cost time: 1.0685150623321533
Epoch: 32, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 33 cost time: 1.1623914241790771
Epoch: 33, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 34 cost time: 1.1240153312683105
Epoch: 34, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.633 Vali Acc: 0.900 Test Loss: 0.633 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 35 cost time: 1.2242693901062012
Epoch: 35, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 36 cost time: 1.2715201377868652
Epoch: 36, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 1.1186394691467285
Epoch: 37, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 38 cost time: 1.1723277568817139
Epoch: 38, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.126539945602417
Epoch: 39, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1731057167053223
Epoch: 40, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.259321928024292
Epoch: 41, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2994308471679688
Epoch: 42, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.054373025894165
Epoch: 43, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 1.1870596408843994
Epoch: 44, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 1.081681728363037
Epoch: 45, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 1.2773582935333252
Epoch: 46, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0117931365966797
Epoch: 47, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2983014583587646
Epoch: 48, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2492868900299072
Epoch: 49, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1264586448669434
Epoch: 50, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1998143196105957
Epoch: 51, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.218780517578125
Epoch: 52, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.3083224296569824
Epoch: 53, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3233261108398438
Epoch: 54, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.205230474472046
Epoch: 55, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 313760
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.463461399078369
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.473 Vali Acc: 0.400 Test Loss: 1.473 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.2576944828033447
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.447 Vali Acc: 0.375 Test Loss: 1.447 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0278434753417969
Epoch: 3, Steps: 3 | Train Loss: 1.550 Vali Loss: 1.419 Vali Acc: 0.450 Test Loss: 1.419 Test Acc: 0.450
Validation loss decreased (-0.399985 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 1.3741014003753662
Epoch: 4, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.387 Vali Acc: 0.450 Test Loss: 1.387 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 1.0294404029846191
Epoch: 5, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.360 Vali Acc: 0.325 Test Loss: 1.360 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2843005657196045
Epoch: 6, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.345 Vali Acc: 0.300 Test Loss: 1.345 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2527048587799072
Epoch: 7, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1880073547363281
Epoch: 8, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1116564273834229
Epoch: 9, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.295 Vali Acc: 0.525 Test Loss: 1.295 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 1.1483690738677979
Epoch: 10, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.283 Vali Acc: 0.525 Test Loss: 1.283 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 1.3716185092926025
Epoch: 11, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.269 Vali Acc: 0.525 Test Loss: 1.269 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 1.4544651508331299
Epoch: 12, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.241 Vali Acc: 0.525 Test Loss: 1.241 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.319375991821289
Epoch: 13, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.1387360095977783
Epoch: 14, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.937755823135376
Epoch: 15, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.141 Vali Acc: 0.575 Test Loss: 1.141 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6085081100463867
Epoch: 16, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 1.0947680473327637
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.022704839706421
Epoch: 18, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5240471363067627
Epoch: 19, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 1.0185620784759521
Epoch: 20, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.964 Vali Acc: 0.675 Test Loss: 0.964 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2136566638946533
Epoch: 21, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.915 Vali Acc: 0.700 Test Loss: 0.915 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 1.1499595642089844
Epoch: 22, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 1.0003330707550049
Epoch: 23, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.811 Vali Acc: 0.700 Test Loss: 0.811 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.1556248664855957
Epoch: 24, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.773 Vali Acc: 0.675 Test Loss: 0.773 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.966576099395752
Epoch: 25, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.699992 --> -0.824993).  Saving model ...
Epoch: 26 cost time: 1.1143789291381836
Epoch: 26, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 1.2346034049987793
Epoch: 27, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.714 Vali Acc: 0.875 Test Loss: 0.714 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 28 cost time: 1.3440501689910889
Epoch: 28, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.094738483428955
Epoch: 29, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2271194458007812
Epoch: 30, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.615 Vali Acc: 0.825 Test Loss: 0.615 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.929288387298584
Epoch: 31, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.119946002960205
Epoch: 32, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 1.4903266429901123
Epoch: 33, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.554 Vali Acc: 0.925 Test Loss: 0.554 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 34 cost time: 1.035618543624878
Epoch: 34, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2760064601898193
Epoch: 35, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.04203462600708
Epoch: 36, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0237329006195068
Epoch: 37, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3419766426086426
Epoch: 38, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2674813270568848
Epoch: 39, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1264572143554688
Epoch: 40, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.462 Vali Acc: 0.925 Test Loss: 0.462 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 41 cost time: 1.2469456195831299
Epoch: 41, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 1.2754673957824707
Epoch: 42, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4135651588439941
Epoch: 43, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1208021640777588
Epoch: 44, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8745038509368896
Epoch: 45, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.9068777561187744
Epoch: 46, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0133640766143799
Epoch: 47, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.436 Vali Acc: 0.825 Test Loss: 0.436 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5254781246185303
Epoch: 48, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.150352954864502
Epoch: 49, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1382520198822021
Epoch: 50, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0251476764678955
Epoch: 51, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1480467319488525
Epoch: 52, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.426 Vali Acc: 0.825 Test Loss: 0.426 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1463203430175781
Epoch: 53, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1501610279083252
Epoch: 54, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2887513637542725
Epoch: 55, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 313152
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0910704135894775
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.448 Vali Acc: 0.250 Test Loss: 1.448 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1763336658477783
Epoch: 2, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.417 Vali Acc: 0.250 Test Loss: 1.417 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.198711633682251
Epoch: 3, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.378 Vali Acc: 0.275 Test Loss: 1.378 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.196997880935669
Epoch: 4, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.1160178184509277
Epoch: 5, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.314 Vali Acc: 0.325 Test Loss: 1.314 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.239633321762085
Epoch: 6, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1467576026916504
Epoch: 7, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.046915054321289
Epoch: 8, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.269 Vali Acc: 0.450 Test Loss: 1.269 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.8419132232666016
Epoch: 9, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9765036106109619
Epoch: 10, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8971576690673828
Epoch: 11, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9034018516540527
Epoch: 12, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 1.1344563961029053
Epoch: 13, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.185 Vali Acc: 0.425 Test Loss: 1.185 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0470068454742432
Epoch: 14, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.159 Vali Acc: 0.450 Test Loss: 1.159 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0506885051727295
Epoch: 15, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 1.5844087600708008
Epoch: 16, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.9033432006835938
Epoch: 17, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.072 Vali Acc: 0.700 Test Loss: 1.072 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 1.2537481784820557
Epoch: 18, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.055 Vali Acc: 0.750 Test Loss: 1.055 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 19 cost time: 1.2418243885040283
Epoch: 19, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.009 Vali Acc: 0.775 Test Loss: 1.009 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 1.198063611984253
Epoch: 20, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2428197860717773
Epoch: 21, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 1.3323256969451904
Epoch: 22, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0326802730560303
Epoch: 23, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.9753086566925049
Epoch: 24, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.826 Vali Acc: 0.800 Test Loss: 0.826 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.8928196430206299
Epoch: 25, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.0789310932159424
Epoch: 26, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2478296756744385
Epoch: 27, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.718 Vali Acc: 0.725 Test Loss: 0.718 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1420459747314453
Epoch: 28, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 0.9550185203552246
Epoch: 29, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1461658477783203
Epoch: 30, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.012382984161377
Epoch: 31, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0895464420318604
Epoch: 32, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.606 Vali Acc: 0.800 Test Loss: 0.606 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0271718502044678
Epoch: 33, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 1.0427091121673584
Epoch: 34, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1624128818511963
Epoch: 35, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 1.1618876457214355
Epoch: 36, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3068389892578125
Epoch: 37, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.867333173751831
Epoch: 38, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 39 cost time: 0.9535689353942871
Epoch: 39, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 0.9363486766815186
Epoch: 40, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9380176067352295
Epoch: 41, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7747318744659424
Epoch: 42, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0154547691345215
Epoch: 43, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 1.127263069152832
Epoch: 44, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2393012046813965
Epoch: 45, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.464 Vali Acc: 0.800 Test Loss: 0.464 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9708421230316162
Epoch: 46, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.083437442779541
Epoch: 47, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.897240161895752
Epoch: 48, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.979259729385376
Epoch: 49, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 0.8801498413085938
Epoch: 50, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.87363600730896
Epoch: 51, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.027904987335205
Epoch: 52, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9100236892700195
Epoch: 53, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0418059825897217
Epoch: 54, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.966961145401001
Epoch: 55, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0499827861785889
Epoch: 56, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.2173526287078857
Epoch: 57, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2879257202148438
Epoch: 58, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2930922508239746
Epoch: 59, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 312544
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.946639060974121
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.398 Vali Acc: 0.300 Test Loss: 1.398 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.0941143035888672
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.398 Vali Acc: 0.375 Test Loss: 1.398 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.2145109176635742
Epoch: 3, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.399 Vali Acc: 0.350 Test Loss: 1.399 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8131401538848877
Epoch: 4, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.400 Vali Acc: 0.375 Test Loss: 1.400 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1054513454437256
Epoch: 5, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6040782928466797
Epoch: 6, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.393 Vali Acc: 0.375 Test Loss: 1.393 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 1.3237345218658447
Epoch: 7, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1988022327423096
Epoch: 8, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5201513767242432
Epoch: 9, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5043978691101074
Epoch: 10, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.312 Vali Acc: 0.450 Test Loss: 1.312 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 1.4414699077606201
Epoch: 11, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.275 Vali Acc: 0.475 Test Loss: 1.275 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 1.1819515228271484
Epoch: 12, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.8148610591888428
Epoch: 13, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.4797160625457764
Epoch: 14, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 1.3417706489562988
Epoch: 15, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.141 Vali Acc: 0.725 Test Loss: 1.141 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 1.2323038578033447
Epoch: 16, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5381879806518555
Epoch: 17, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.107 Vali Acc: 0.750 Test Loss: 1.107 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 1.4711637496948242
Epoch: 18, Steps: 3 | Train Loss: 0.828 Vali Loss: 1.093 Vali Acc: 0.700 Test Loss: 1.093 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4543366432189941
Epoch: 19, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.085 Vali Acc: 0.700 Test Loss: 1.085 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.486475944519043
Epoch: 20, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.050 Vali Acc: 0.725 Test Loss: 1.050 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.532782793045044
Epoch: 21, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.019 Vali Acc: 0.750 Test Loss: 1.019 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 1.3147132396697998
Epoch: 22, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.985 Vali Acc: 0.775 Test Loss: 0.985 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 23 cost time: 1.349370002746582
Epoch: 23, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.955 Vali Acc: 0.675 Test Loss: 0.955 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.384800910949707
Epoch: 24, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.761845350265503
Epoch: 25, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.915 Vali Acc: 0.825 Test Loss: 0.915 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 1.2677221298217773
Epoch: 26, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.913 Vali Acc: 0.800 Test Loss: 0.913 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.36385178565979
Epoch: 27, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.904 Vali Acc: 0.825 Test Loss: 0.904 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 28 cost time: 1.745957612991333
Epoch: 28, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.876 Vali Acc: 0.825 Test Loss: 0.876 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 29 cost time: 1.4965465068817139
Epoch: 29, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.854 Vali Acc: 0.825 Test Loss: 0.854 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 30 cost time: 1.4174621105194092
Epoch: 30, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 31 cost time: 1.4047644138336182
Epoch: 31, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.799 Vali Acc: 0.825 Test Loss: 0.799 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 32 cost time: 1.174283742904663
Epoch: 32, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 33 cost time: 1.3526439666748047
Epoch: 33, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.773 Vali Acc: 0.825 Test Loss: 0.773 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 1.36222243309021
Epoch: 34, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2433009147644043
Epoch: 35, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.463695764541626
Epoch: 36, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 1.2989273071289062
Epoch: 37, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 1.3274211883544922
Epoch: 38, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.437232494354248
Epoch: 39, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8010351657867432
Epoch: 40, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7865512371063232
Epoch: 41, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.261491298675537
Epoch: 42, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.189347505569458
Epoch: 43, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.41762375831604
Epoch: 44, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4382984638214111
Epoch: 45, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.7038426399230957
Epoch: 46, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.7284719944000244
Epoch: 47, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.683 Vali Acc: 0.775 Test Loss: 0.683 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 311936
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3227226734161377
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.427 Vali Acc: 0.100 Test Loss: 1.427 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.8911550045013428
Epoch: 2, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.429 Vali Acc: 0.175 Test Loss: 1.429 Test Acc: 0.175
Validation loss decreased (-0.099986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.0789611339569092
Epoch: 3, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.428 Vali Acc: 0.325 Test Loss: 1.428 Test Acc: 0.325
Validation loss decreased (-0.174986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.0304384231567383
Epoch: 4, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.425 Vali Acc: 0.375 Test Loss: 1.425 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.062520980834961
Epoch: 5, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.425 Vali Acc: 0.325 Test Loss: 1.425 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3506488800048828
Epoch: 6, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4596900939941406
Epoch: 7, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.415 Vali Acc: 0.350 Test Loss: 1.415 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0876750946044922
Epoch: 8, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.411 Vali Acc: 0.350 Test Loss: 1.411 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2149083614349365
Epoch: 9, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1938931941986084
Epoch: 10, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.392 Vali Acc: 0.225 Test Loss: 1.392 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.023477554321289
Epoch: 11, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0916743278503418
Epoch: 12, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.363 Vali Acc: 0.275 Test Loss: 1.363 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.744913101196289
Epoch: 13, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3451435565948486
Epoch: 14, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.329 Vali Acc: 0.425 Test Loss: 1.329 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 15 cost time: 1.218611240386963
Epoch: 15, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 16 cost time: 1.0724492073059082
Epoch: 16, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.294 Vali Acc: 0.475 Test Loss: 1.294 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 1.231062650680542
Epoch: 17, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 1.0985684394836426
Epoch: 18, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.270 Vali Acc: 0.475 Test Loss: 1.270 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3188738822937012
Epoch: 19, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.254 Vali Acc: 0.475 Test Loss: 1.254 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3864901065826416
Epoch: 20, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.679973840713501
Epoch: 21, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4333908557891846
Epoch: 22, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.200 Vali Acc: 0.475 Test Loss: 1.200 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3266654014587402
Epoch: 23, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.189 Vali Acc: 0.625 Test Loss: 1.189 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 24 cost time: 1.2411298751831055
Epoch: 24, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2103183269500732
Epoch: 25, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.127 Vali Acc: 0.575 Test Loss: 1.127 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2007901668548584
Epoch: 26, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.326859951019287
Epoch: 27, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 1.145693302154541
Epoch: 28, Steps: 3 | Train Loss: 0.788 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4348633289337158
Epoch: 29, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2940475940704346
Epoch: 30, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1882953643798828
Epoch: 31, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.992 Vali Acc: 0.675 Test Loss: 0.992 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 1.0203213691711426
Epoch: 32, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.943 Vali Acc: 0.675 Test Loss: 0.943 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 33 cost time: 1.4230270385742188
Epoch: 33, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 34 cost time: 1.1528959274291992
Epoch: 34, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.900 Vali Acc: 0.625 Test Loss: 0.900 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4350991249084473
Epoch: 35, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
Validation loss decreased (-0.674991 --> -0.799991).  Saving model ...
Epoch: 36 cost time: 1.3944997787475586
Epoch: 36, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.821 Vali Acc: 0.800 Test Loss: 0.821 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 1.1422653198242188
Epoch: 37, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 38 cost time: 1.1493775844573975
Epoch: 38, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 1.1269190311431885
Epoch: 39, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 40 cost time: 1.2817630767822266
Epoch: 40, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 41 cost time: 1.3502655029296875
Epoch: 41, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 42 cost time: 1.2705621719360352
Epoch: 42, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 43 cost time: 1.3257215023040771
Epoch: 43, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 44 cost time: 1.381878137588501
Epoch: 44, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 45 cost time: 1.2672250270843506
Epoch: 45, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 46 cost time: 0.9494113922119141
Epoch: 46, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.091045618057251
Epoch: 47, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.122253179550171
Epoch: 48, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.188063383102417
Epoch: 49, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 50 cost time: 1.1871051788330078
Epoch: 50, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 1.3542156219482422
Epoch: 51, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 1.306729793548584
Epoch: 52, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0022642612457275
Epoch: 53, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2129242420196533
Epoch: 54, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.007646083831787
Epoch: 55, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 1.1528973579406738
Epoch: 56, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.498 Vali Acc: 0.925 Test Loss: 0.498 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 57 cost time: 1.0209035873413086
Epoch: 57, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1864562034606934
Epoch: 58, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.4675889015197754
Epoch: 59, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.2613210678100586
Epoch: 60, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.0256879329681396
Epoch: 61, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.0862407684326172
Epoch: 62, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.1370759010314941
Epoch: 63, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.0563931465148926
Epoch: 64, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.045593023300171
Epoch: 65, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.0647010803222656
Epoch: 66, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 67 cost time: 0.9403083324432373
Epoch: 67, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2990779876708984
Epoch: 68, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2251923084259033
Epoch: 69, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 70 cost time: 1.164534330368042
Epoch: 70, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 71 cost time: 1.0843875408172607
Epoch: 71, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4652597904205322
Epoch: 72, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.3186404705047607
Epoch: 73, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.123471975326538
Epoch: 74, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.9807705879211426
Epoch: 75, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 76 cost time: 1.2139792442321777
Epoch: 76, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 77 cost time: 1.005577564239502
Epoch: 77, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.4646358489990234
Epoch: 78, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.1542243957519531
Epoch: 79, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.2910096645355225
Epoch: 80, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.1508731842041016
Epoch: 81, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.2719712257385254
Epoch: 82, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.1386773586273193
Epoch: 83, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.087742805480957
Epoch: 84, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.0895781517028809
Epoch: 85, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.207477331161499
Epoch: 86, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 238880
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0077834129333496
Epoch: 1, Steps: 3 | Train Loss: 1.546 Vali Loss: 1.478 Vali Acc: 0.375 Test Loss: 1.478 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.8494482040405273
Epoch: 2, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.453 Vali Acc: 0.375 Test Loss: 1.453 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 3 cost time: 1.0291423797607422
Epoch: 3, Steps: 3 | Train Loss: 1.515 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.2088816165924072
Epoch: 4, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.99603271484375
Epoch: 5, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.374 Vali Acc: 0.425 Test Loss: 1.374 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.1075499057769775
Epoch: 6, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.359 Vali Acc: 0.200 Test Loss: 1.359 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1673545837402344
Epoch: 7, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.350 Vali Acc: 0.300 Test Loss: 1.350 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9718060493469238
Epoch: 8, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.351 Vali Acc: 0.325 Test Loss: 1.351 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3292241096496582
Epoch: 9, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.348 Vali Acc: 0.325 Test Loss: 1.348 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0439741611480713
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.342 Vali Acc: 0.325 Test Loss: 1.342 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.340545654296875
Epoch: 11, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.333 Vali Acc: 0.325 Test Loss: 1.333 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.136646032333374
Epoch: 12, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.311 Vali Acc: 0.275 Test Loss: 1.311 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2723329067230225
Epoch: 13, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.296 Vali Acc: 0.225 Test Loss: 1.296 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.427297592163086
Epoch: 14, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.277 Vali Acc: 0.275 Test Loss: 1.277 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.066025733947754
Epoch: 15, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.260 Vali Acc: 0.375 Test Loss: 1.260 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.425
model parameter : 238272
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.052417039871216
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9387319087982178
Epoch: 2, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.381 Vali Acc: 0.250 Test Loss: 1.381 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1135196685791016
Epoch: 3, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.373 Vali Acc: 0.250 Test Loss: 1.373 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8613312244415283
Epoch: 4, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.367 Vali Acc: 0.250 Test Loss: 1.367 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0243873596191406
Epoch: 5, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.367 Vali Acc: 0.250 Test Loss: 1.367 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9994368553161621
Epoch: 6, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.366 Vali Acc: 0.450 Test Loss: 1.366 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.8819642066955566
Epoch: 7, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9307022094726562
Epoch: 8, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.062737226486206
Epoch: 9, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.344 Vali Acc: 0.475 Test Loss: 1.344 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.9807825088500977
Epoch: 10, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.324 Vali Acc: 0.525 Test Loss: 1.324 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.944542407989502
Epoch: 11, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.304 Vali Acc: 0.525 Test Loss: 1.304 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 1.1277389526367188
Epoch: 12, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.281 Vali Acc: 0.550 Test Loss: 1.281 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 1.1231775283813477
Epoch: 13, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.253 Vali Acc: 0.600 Test Loss: 1.253 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 1.2450549602508545
Epoch: 14, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.237 Vali Acc: 0.625 Test Loss: 1.237 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 1.1733009815216064
Epoch: 15, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.216 Vali Acc: 0.625 Test Loss: 1.216 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 1.0463404655456543
Epoch: 16, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.197 Vali Acc: 0.650 Test Loss: 1.197 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 1.0438756942749023
Epoch: 17, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.180 Vali Acc: 0.700 Test Loss: 1.180 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 18 cost time: 1.0143043994903564
Epoch: 18, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0104024410247803
Epoch: 19, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1815707683563232
Epoch: 20, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.127 Vali Acc: 0.525 Test Loss: 1.127 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4663293361663818
Epoch: 21, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2754225730895996
Epoch: 22, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.056 Vali Acc: 0.675 Test Loss: 1.056 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0609362125396729
Epoch: 23, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 1.017768383026123
Epoch: 24, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0800776481628418
Epoch: 25, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.954 Vali Acc: 0.650 Test Loss: 0.954 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1591763496398926
Epoch: 26, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9962363243103027
Epoch: 27, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 1.0556786060333252
Epoch: 28, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 1.1462419033050537
Epoch: 29, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 30 cost time: 1.0627641677856445
Epoch: 30, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2647502422332764
Epoch: 31, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2998507022857666
Epoch: 32, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.821 Vali Acc: 0.725 Test Loss: 0.821 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1092655658721924
Epoch: 33, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.797 Vali Acc: 0.775 Test Loss: 0.797 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 34 cost time: 1.2090530395507812
Epoch: 34, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2271320819854736
Epoch: 35, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0741443634033203
Epoch: 36, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.262510061264038
Epoch: 37, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.764 Vali Acc: 0.750 Test Loss: 0.764 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.089446783065796
Epoch: 38, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 39 cost time: 1.115424633026123
Epoch: 39, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 40 cost time: 1.088775873184204
Epoch: 40, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 41 cost time: 0.9375133514404297
Epoch: 41, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0007133483886719
Epoch: 42, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.102696418762207
Epoch: 43, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 44 cost time: 1.0926079750061035
Epoch: 44, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.636 Vali Acc: 0.825 Test Loss: 0.636 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 45 cost time: 1.2460801601409912
Epoch: 45, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 46 cost time: 1.1608073711395264
Epoch: 46, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.610 Vali Acc: 0.825 Test Loss: 0.610 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 47 cost time: 1.170957326889038
Epoch: 47, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 48 cost time: 1.3365230560302734
Epoch: 48, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 49 cost time: 1.066500186920166
Epoch: 49, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.578 Vali Acc: 0.875 Test Loss: 0.578 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 1.159144639968872
Epoch: 50, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.3848412036895752
Epoch: 51, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.599 Vali Acc: 0.875 Test Loss: 0.599 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3075461387634277
Epoch: 52, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1684131622314453
Epoch: 53, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.464672565460205
Epoch: 54, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2291409969329834
Epoch: 55, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8701496124267578
Epoch: 56, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.938791036605835
Epoch: 57, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.663 Vali Acc: 0.800 Test Loss: 0.663 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.0578830242156982
Epoch: 58, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.644 Vali Acc: 0.825 Test Loss: 0.644 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.1878325939178467
Epoch: 59, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 237664
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9117822647094727
Epoch: 1, Steps: 3 | Train Loss: 1.619 Vali Loss: 1.431 Vali Acc: 0.350 Test Loss: 1.431 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.975147008895874
Epoch: 2, Steps: 3 | Train Loss: 1.590 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1888933181762695
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1454222202301025
Epoch: 4, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.337 Vali Acc: 0.325 Test Loss: 1.337 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.986011266708374
Epoch: 5, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.0642774105072021
Epoch: 6, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1488840579986572
Epoch: 7, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9853630065917969
Epoch: 8, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.317 Vali Acc: 0.425 Test Loss: 1.317 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.057586669921875
Epoch: 9, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.308 Vali Acc: 0.425 Test Loss: 1.308 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.9301996231079102
Epoch: 10, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.294 Vali Acc: 0.425 Test Loss: 1.294 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 0.9308745861053467
Epoch: 11, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.8586862087249756
Epoch: 12, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 1.2831692695617676
Epoch: 13, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.222 Vali Acc: 0.600 Test Loss: 1.222 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 1.1605474948883057
Epoch: 14, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.200 Vali Acc: 0.575 Test Loss: 1.200 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3486080169677734
Epoch: 15, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.272038221359253
Epoch: 16, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.155 Vali Acc: 0.550 Test Loss: 1.155 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.237638235092163
Epoch: 17, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 1.2203080654144287
Epoch: 18, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.118 Vali Acc: 0.675 Test Loss: 1.118 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3940935134887695
Epoch: 19, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0227656364440918
Epoch: 20, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9168505668640137
Epoch: 21, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3744986057281494
Epoch: 22, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9319784641265869
Epoch: 23, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 1.2940747737884521
Epoch: 24, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.189438819885254
Epoch: 25, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1709768772125244
Epoch: 26, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.903 Vali Acc: 0.800 Test Loss: 0.903 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 1.2431318759918213
Epoch: 27, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 28 cost time: 1.6726751327514648
Epoch: 28, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.839 Vali Acc: 0.825 Test Loss: 0.839 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 29 cost time: 0.9998605251312256
Epoch: 29, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 30 cost time: 1.1486172676086426
Epoch: 30, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4149298667907715
Epoch: 31, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3596587181091309
Epoch: 32, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.770 Vali Acc: 0.800 Test Loss: 0.770 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4124469757080078
Epoch: 33, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 1.5434303283691406
Epoch: 34, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6852807998657227
Epoch: 35, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4901363849639893
Epoch: 36, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2731373310089111
Epoch: 37, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3741910457611084
Epoch: 38, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2603206634521484
Epoch: 39, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4523980617523193
Epoch: 40, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2043395042419434
Epoch: 41, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.133681297302246
Epoch: 42, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 43 cost time: 1.1423487663269043
Epoch: 43, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 44 cost time: 0.9853835105895996
Epoch: 44, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 45 cost time: 1.1575927734375
Epoch: 45, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849994).  Saving model ...
Epoch: 46 cost time: 0.9776961803436279
Epoch: 46, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 1.0180561542510986
Epoch: 47, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.232234001159668
Epoch: 48, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2613632678985596
Epoch: 49, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 50 cost time: 0.8637206554412842
Epoch: 50, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 1.0956847667694092
Epoch: 51, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.9736874103546143
Epoch: 52, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9610292911529541
Epoch: 53, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.483 Vali Acc: 0.825 Test Loss: 0.483 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.4045355319976807
Epoch: 54, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.474 Vali Acc: 0.825 Test Loss: 0.474 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9345955848693848
Epoch: 55, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9414684772491455
Epoch: 56, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 1.04020094871521
Epoch: 57, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.238753318786621
Epoch: 58, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.2987685203552246
Epoch: 59, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.276616096496582
Epoch: 60, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.387946605682373
Epoch: 61, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.156933069229126
Epoch: 62, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.465 Vali Acc: 0.825 Test Loss: 0.465 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.1075422763824463
Epoch: 63, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.017162799835205
Epoch: 64, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 65 cost time: 0.8577601909637451
Epoch: 65, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 1.046701431274414
Epoch: 66, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.037339448928833
Epoch: 67, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1739959716796875
Epoch: 68, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8724877834320068
Epoch: 69, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.3423962593078613
Epoch: 70, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.414 Vali Acc: 0.825 Test Loss: 0.414 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1928515434265137
Epoch: 71, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.405 Vali Acc: 0.825 Test Loss: 0.405 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0466372966766357
Epoch: 72, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0560505390167236
Epoch: 73, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.1105284690856934
Epoch: 74, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.8331596851348877
Epoch: 75, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 237056
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.444509506225586
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.355 Vali Acc: 0.325 Test Loss: 1.355 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.0031626224517822
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.2211525440216064
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.2161214351654053
Epoch: 4, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8789689540863037
Epoch: 5, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.055 Vali Acc: 0.525 Test Loss: 1.055 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1271696090698242
Epoch: 6, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.938 Vali Acc: 0.775 Test Loss: 0.938 Test Acc: 0.775
Validation loss decreased (-0.574988 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.9881308078765869
Epoch: 7, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.067847490310669
Epoch: 8, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1653316020965576
Epoch: 9, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774993).  Saving model ...
Epoch: 10 cost time: 0.9240052700042725
Epoch: 10, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.774993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 1.055142879486084
Epoch: 11, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.591 Vali Acc: 0.675 Test Loss: 0.591 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0720431804656982
Epoch: 12, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 1.3295636177062988
Epoch: 13, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.492 Vali Acc: 0.675 Test Loss: 0.492 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.004610538482666
Epoch: 14, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1974327564239502
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 1.2161133289337158
Epoch: 16, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.467 Vali Acc: 0.675 Test Loss: 0.467 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1400814056396484
Epoch: 17, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9239094257354736
Epoch: 18, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8419384956359863
Epoch: 19, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 1.0918352603912354
Epoch: 20, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.0192019939422607
Epoch: 21, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9280726909637451
Epoch: 22, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9495570659637451
Epoch: 23, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1055257320404053
Epoch: 24, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9778680801391602
Epoch: 25, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.951793909072876
Epoch: 26, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0578904151916504
Epoch: 27, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8240485191345215
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8758645057678223
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1982498168945312
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 11135028
model size : 47.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.532583713531494
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.9180600643157959
Epoch: 2, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.301 Vali Acc: 0.325 Test Loss: 1.301 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.93898606300354
Epoch: 3, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.249 Vali Acc: 0.325 Test Loss: 1.249 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.7980518341064453
Epoch: 4, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.209 Vali Acc: 0.575 Test Loss: 1.209 Test Acc: 0.575
Validation loss decreased (-0.324988 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.8639681339263916
Epoch: 5, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.8698306083679199
Epoch: 6, Steps: 3 | Train Loss: 0.944 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.9454314708709717
Epoch: 7, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.878 Vali Acc: 0.675 Test Loss: 0.878 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674991).  Saving model ...
Epoch: 8 cost time: 0.850653886795044
Epoch: 8, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.725 Vali Acc: 0.750 Test Loss: 0.725 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.9537985324859619
Epoch: 9, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.895 Vali Acc: 0.525 Test Loss: 0.895 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9905338287353516
Epoch: 10, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.841 Vali Acc: 0.525 Test Loss: 0.841 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.792802095413208
Epoch: 11, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
Validation loss decreased (-0.749993 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.7514081001281738
Epoch: 12, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.574 Vali Acc: 0.650 Test Loss: 0.574 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9246370792388916
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
Validation loss decreased (-0.824995 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.8985912799835205
Epoch: 14, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9535436630249023
Epoch: 15, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.981705904006958
Epoch: 16, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.8667430877685547
Epoch: 17, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 18 cost time: 1.1564085483551025
Epoch: 18, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.05279541015625
Epoch: 19, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.303330421447754
Epoch: 20, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.8813619613647461
Epoch: 21, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.900050163269043
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.957512617111206
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.818676233291626
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9261143207550049
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9901547431945801
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0154345035552979
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.294370174407959
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0853075981140137
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.021998643875122
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.950 Test Loss: 0.487 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.952526330947876
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0366673469543457
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8329422473907471
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.950 Test Loss: 0.513 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9666097164154053
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1149110794067383
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8823237419128418
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8998796939849854
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 11130676
model size : 47.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1408605575561523
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.552 Vali Acc: 0.350 Test Loss: 1.552 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 0.7852625846862793
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.397 Vali Acc: 0.350 Test Loss: 1.397 Test Acc: 0.350
Validation loss decreased (-0.349984 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.1368279457092285
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.305 Vali Acc: 0.425 Test Loss: 1.305 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.1126296520233154
Epoch: 4, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.216 Vali Acc: 0.425 Test Loss: 1.216 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.9068272113800049
Epoch: 5, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.268 Vali Acc: 0.425 Test Loss: 1.268 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9821314811706543
Epoch: 6, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.009 Vali Acc: 0.625 Test Loss: 1.009 Test Acc: 0.625
Validation loss decreased (-0.424988 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.0341823101043701
Epoch: 7, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.964 Vali Acc: 0.550 Test Loss: 0.964 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1040623188018799
Epoch: 8, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.831 Vali Acc: 0.650 Test Loss: 0.831 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649992).  Saving model ...
Epoch: 9 cost time: 1.153308629989624
Epoch: 9, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.030 Vali Acc: 0.525 Test Loss: 1.030 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0514578819274902
Epoch: 10, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.718 Vali Acc: 0.600 Test Loss: 0.718 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1076407432556152
Epoch: 11, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.666 Vali Acc: 0.650 Test Loss: 0.666 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649993).  Saving model ...
Epoch: 12 cost time: 1.0711886882781982
Epoch: 12, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.622 Vali Acc: 0.700 Test Loss: 0.622 Test Acc: 0.700
Validation loss decreased (-0.649993 --> -0.699994).  Saving model ...
Epoch: 13 cost time: 1.3173761367797852
Epoch: 13, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
Validation loss decreased (-0.699994 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 1.0617997646331787
Epoch: 14, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.662 Vali Acc: 0.650 Test Loss: 0.662 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0079882144927979
Epoch: 15, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 1.0503926277160645
Epoch: 16, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 0.9009814262390137
Epoch: 17, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1157796382904053
Epoch: 18, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2005572319030762
Epoch: 19, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 1.0378599166870117
Epoch: 20, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3466079235076904
Epoch: 21, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0806005001068115
Epoch: 22, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9223124980926514
Epoch: 23, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.994046688079834
Epoch: 24, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8970077037811279
Epoch: 25, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.037916898727417
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5128250122070312
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1209728717803955
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.900 Test Loss: 0.562 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9254846572875977
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8933737277984619
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9999384880065918
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.9486658573150635
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.4043934345245361
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0551457405090332
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8926990032196045
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2170791625976562
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3491897583007812
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.27048659324646
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.148190975189209
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.267873764038086
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9895002841949463
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9541871547698975
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.925 Test Loss: 0.549 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 11126324
model size : 47.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3498024940490723
Epoch: 1, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.461 Vali Acc: 0.050 Test Loss: 1.461 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 0.9307878017425537
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.460 Vali Acc: 0.275 Test Loss: 1.460 Test Acc: 0.275
Validation loss decreased (-0.049985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.824082612991333
Epoch: 3, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.460 Vali Acc: 0.275 Test Loss: 1.460 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 1.2197389602661133
Epoch: 4, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.274985 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.8115079402923584
Epoch: 5, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.205 Vali Acc: 0.600 Test Loss: 1.205 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.1369304656982422
Epoch: 6, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.153 Vali Acc: 0.475 Test Loss: 1.153 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0889041423797607
Epoch: 7, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9330692291259766
Epoch: 8, Steps: 3 | Train Loss: 0.674 Vali Loss: 1.018 Vali Acc: 0.525 Test Loss: 1.018 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0986506938934326
Epoch: 9, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
Validation loss decreased (-0.599988 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.9532124996185303
Epoch: 10, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9930684566497803
Epoch: 11, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.733 Vali Acc: 0.600 Test Loss: 0.733 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9071407318115234
Epoch: 12, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3793184757232666
Epoch: 13, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.254258155822754
Epoch: 14, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 1.0539133548736572
Epoch: 15, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.440 Vali Acc: 0.825 Test Loss: 0.440 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0945627689361572
Epoch: 16, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.9969072341918945
Epoch: 17, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1517243385314941
Epoch: 18, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9794044494628906
Epoch: 19, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.299048900604248
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9937453269958496
Epoch: 21, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9902963638305664
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.038245677947998
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0328729152679443
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1931567192077637
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.875 Test Loss: 0.606 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0900046825408936
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.584 Vali Acc: 0.900 Test Loss: 0.584 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 11121972
model size : 47.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9171297550201416
Epoch: 1, Steps: 3 | Train Loss: 1.602 Vali Loss: 1.469 Vali Acc: 0.275 Test Loss: 1.469 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.004899263381958
Epoch: 2, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.415 Vali Acc: 0.150 Test Loss: 1.415 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0204062461853027
Epoch: 3, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.418 Vali Acc: 0.250 Test Loss: 1.418 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0882275104522705
Epoch: 4, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.267 Vali Acc: 0.375 Test Loss: 1.267 Test Acc: 0.375
Validation loss decreased (-0.274985 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9492275714874268
Epoch: 5, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.0525476932525635
Epoch: 6, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.126 Vali Acc: 0.525 Test Loss: 1.126 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9695179462432861
Epoch: 7, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.138 Vali Acc: 0.550 Test Loss: 1.138 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 1.0991389751434326
Epoch: 8, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 1.0783231258392334
Epoch: 9, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.887 Vali Acc: 0.650 Test Loss: 0.887 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0532314777374268
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.790 Vali Acc: 0.575 Test Loss: 0.790 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8529613018035889
Epoch: 11, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.736 Vali Acc: 0.700 Test Loss: 0.736 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.012727975845337
Epoch: 12, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774994).  Saving model ...
Epoch: 13 cost time: 1.2610869407653809
Epoch: 13, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824995).  Saving model ...
Epoch: 14 cost time: 1.2665743827819824
Epoch: 14, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.824995 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 0.9646952152252197
Epoch: 15, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.110083818435669
Epoch: 16, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.445 Vali Acc: 0.675 Test Loss: 0.445 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2452232837677002
Epoch: 17, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1406245231628418
Epoch: 18, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1244568824768066
Epoch: 19, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3045079708099365
Epoch: 20, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1632819175720215
Epoch: 21, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0652496814727783
Epoch: 22, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.9144537448883057
Epoch: 23, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.040590524673462
Epoch: 24, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9925422668457031
Epoch: 25, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.9671707153320312
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0589852333068848
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1865026950836182
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.00468111038208
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9709031581878662
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.941089391708374
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9498722553253174
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0479376316070557
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1603660583496094
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 1.4747793674468994
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0318307876586914
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0769684314727783
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3180935382843018
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2019267082214355
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1972956657409668
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.004380226135254
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.902230978012085
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.9428858757019043
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.8970320224761963
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.121478796005249
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0880365371704102
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.036224365234375
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2720751762390137
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.378387689590454
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1314244270324707
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.160912036895752
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.0935447216033936
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0297374725341797
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 9296436
model size : 40.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0538330078125
Epoch: 1, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.0122129917144775
Epoch: 2, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1383838653564453
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.313 Vali Acc: 0.275 Test Loss: 1.313 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0212113857269287
Epoch: 4, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.175 Vali Acc: 0.675 Test Loss: 1.175 Test Acc: 0.675
Validation loss decreased (-0.399986 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 1.1272587776184082
Epoch: 5, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.112 Vali Acc: 0.525 Test Loss: 1.112 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2803294658660889
Epoch: 6, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.019 Vali Acc: 0.700 Test Loss: 1.019 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 1.0393426418304443
Epoch: 7, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.857 Vali Acc: 0.850 Test Loss: 0.857 Test Acc: 0.850
Validation loss decreased (-0.699990 --> -0.849991).  Saving model ...
Epoch: 8 cost time: 0.9500529766082764
Epoch: 8, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.104170560836792
Epoch: 9, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 0.8850390911102295
Epoch: 10, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.1285955905914307
Epoch: 11, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.998305082321167
Epoch: 12, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.929781436920166
Epoch: 13, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9397773742675781
Epoch: 14, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.077859878540039
Epoch: 15, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0704233646392822
Epoch: 16, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1416752338409424
Epoch: 17, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 1.064068078994751
Epoch: 18, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1226770877838135
Epoch: 19, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.093606948852539
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.489278793334961
Epoch: 21, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2178521156311035
Epoch: 22, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.2926132678985596
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1771636009216309
Epoch: 24, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9303338527679443
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9900588989257812
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0805001258850098
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1985175609588623
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0686087608337402
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1260426044464111
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2468438148498535
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6556763648986816
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 9292084
model size : 40.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3380532264709473
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.452 Vali Acc: 0.200 Test Loss: 1.452 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.7369954586029053
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.396 Vali Acc: 0.325 Test Loss: 1.396 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.8494970798492432
Epoch: 3, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.273 Vali Acc: 0.325 Test Loss: 1.273 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.0980136394500732
Epoch: 4, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 1.038797378540039
Epoch: 5, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.935518741607666
Epoch: 6, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.068 Vali Acc: 0.525 Test Loss: 1.068 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.8988845348358154
Epoch: 7, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.866 Vali Acc: 0.575 Test Loss: 0.866 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574991).  Saving model ...
Epoch: 8 cost time: 1.0917649269104004
Epoch: 8, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.801 Vali Acc: 0.700 Test Loss: 0.801 Test Acc: 0.700
Validation loss decreased (-0.574991 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 1.1863703727722168
Epoch: 9, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.858 Vali Acc: 0.550 Test Loss: 0.858 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9059514999389648
Epoch: 10, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.652 Vali Acc: 0.625 Test Loss: 0.652 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8471841812133789
Epoch: 11, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.511 Vali Acc: 0.775 Test Loss: 0.511 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774995).  Saving model ...
Epoch: 12 cost time: 0.930797815322876
Epoch: 12, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.503 Vali Acc: 0.700 Test Loss: 0.503 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9605240821838379
Epoch: 13, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.774995 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.0170238018035889
Epoch: 14, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.0154266357421875
Epoch: 15, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.857412576675415
Epoch: 16, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.314 Vali Acc: 0.825 Test Loss: 0.314 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.903144121170044
Epoch: 17, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924998).  Saving model ...
Epoch: 18 cost time: 1.110508680343628
Epoch: 18, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.9754626750946045
Epoch: 19, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0997941493988037
Epoch: 20, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9644899368286133
Epoch: 21, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0070984363555908
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.0767443180084229
Epoch: 23, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0387380123138428
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1082508563995361
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0250718593597412
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.049187183380127
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.048612356185913
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.289133071899414
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0790753364562988
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0510976314544678
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0711884498596191
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 9287732
model size : 40.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.318686008453369
Epoch: 1, Steps: 3 | Train Loss: 1.639 Vali Loss: 1.491 Vali Acc: 0.450 Test Loss: 1.491 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 1.075761318206787
Epoch: 2, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.356 Vali Acc: 0.325 Test Loss: 1.356 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0119600296020508
Epoch: 3, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.362 Vali Acc: 0.250 Test Loss: 1.362 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2601923942565918
Epoch: 4, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.220 Vali Acc: 0.325 Test Loss: 1.220 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3877770900726318
Epoch: 5, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.215 Vali Acc: 0.600 Test Loss: 1.215 Test Acc: 0.600
Validation loss decreased (-0.449985 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.0502183437347412
Epoch: 6, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0614097118377686
Epoch: 7, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
Validation loss decreased (-0.599988 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 1.031571865081787
Epoch: 8, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.830 Vali Acc: 0.700 Test Loss: 0.830 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9749746322631836
Epoch: 9, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.735 Vali Acc: 0.675 Test Loss: 0.735 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0781333446502686
Epoch: 10, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.815 Vali Acc: 0.600 Test Loss: 0.815 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.256345510482788
Epoch: 11, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 0.9637305736541748
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.749993 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 1.0584990978240967
Epoch: 13, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.477 Vali Acc: 0.825 Test Loss: 0.477 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0427899360656738
Epoch: 14, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1766114234924316
Epoch: 15, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.9889469146728516
Epoch: 16, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 1.0251250267028809
Epoch: 17, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.0690174102783203
Epoch: 18, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1883530616760254
Epoch: 19, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2191567420959473
Epoch: 20, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 1.4275047779083252
Epoch: 21, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.430 Vali Acc: 0.825 Test Loss: 0.430 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1345877647399902
Epoch: 22, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3521406650543213
Epoch: 23, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1862425804138184
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1176605224609375
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0478909015655518
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1325304508209229
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3235602378845215
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9971356391906738
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4332354068756104
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 9283380
model size : 40.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.91634464263916
Epoch: 1, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.351 Vali Acc: 0.325 Test Loss: 1.351 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.9482429027557373
Epoch: 2, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8938066959381104
Epoch: 3, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.1884112358093262
Epoch: 4, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.269 Vali Acc: 0.325 Test Loss: 1.269 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3579747676849365
Epoch: 5, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.079 Vali Acc: 0.775 Test Loss: 1.079 Test Acc: 0.775
Validation loss decreased (-0.349987 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 1.098238229751587
Epoch: 6, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.023 Vali Acc: 0.575 Test Loss: 1.023 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0351946353912354
Epoch: 7, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.035085916519165
Epoch: 8, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.9421954154968262
Epoch: 9, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.789 Vali Acc: 0.600 Test Loss: 0.789 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9342236518859863
Epoch: 10, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.0391449928283691
Epoch: 11, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.0402796268463135
Epoch: 12, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.551 Vali Acc: 0.650 Test Loss: 0.551 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1117475032806396
Epoch: 13, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0089006423950195
Epoch: 14, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 1.1216099262237549
Epoch: 15, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.549 Vali Acc: 0.650 Test Loss: 0.549 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9821000099182129
Epoch: 16, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.466 Vali Acc: 0.825 Test Loss: 0.466 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8697159290313721
Epoch: 17, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.461 Vali Acc: 0.825 Test Loss: 0.461 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0103235244750977
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.9967629909515381
Epoch: 19, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.89089035987854
Epoch: 20, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2355823516845703
Epoch: 21, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2187824249267578
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0378007888793945
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0586333274841309
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.3429646492004395
Epoch: 25, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2018976211547852
Epoch: 26, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9792451858520508
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0212771892547607
Epoch: 28, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9860963821411133
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8105692863464355
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.097179889678955
Epoch: 31, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.9718072414398193
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9473600387573242
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.095198154449463
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1061325073242188
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0789453983306885
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9425604343414307
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.056929588317871
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0935122966766357
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.8192441463470459
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 1.0848472118377686
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2538797855377197
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1173911094665527
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 1.0207359790802002
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.8748831748962402
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.8940818309783936
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.7999355792999268
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 1.1117444038391113
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.031066656112671
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9656658172607422
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8847742080688477
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.916982889175415
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8744869232177734
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.87815260887146
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.8786277770996094
Epoch: 55, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.3806800842285156
Epoch: 56, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.1364243030548096
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 8377140
model size : 36.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.734243154525757
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.483 Vali Acc: 0.325 Test Loss: 1.483 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.8379337787628174
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7688500881195068
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0085821151733398
Epoch: 4, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.262 Vali Acc: 0.475 Test Loss: 1.262 Test Acc: 0.475
Validation loss decreased (-0.324985 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.930579662322998
Epoch: 5, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.9709773063659668
Epoch: 6, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.941483736038208
Epoch: 7, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.987 Vali Acc: 0.575 Test Loss: 0.987 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 8 cost time: 0.8398749828338623
Epoch: 8, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.883 Vali Acc: 0.600 Test Loss: 0.883 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 1.0918974876403809
Epoch: 9, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
Validation loss decreased (-0.599991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.959669828414917
Epoch: 10, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.824 Vali Acc: 0.650 Test Loss: 0.824 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1812834739685059
Epoch: 11, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.721 Vali Acc: 0.800 Test Loss: 0.721 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.1952435970306396
Epoch: 12, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 1.342106819152832
Epoch: 13, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9720232486724854
Epoch: 14, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.919675350189209
Epoch: 15, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2094991207122803
Epoch: 16, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0002858638763428
Epoch: 17, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 1.028052806854248
Epoch: 18, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.09999680519104
Epoch: 19, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9670608043670654
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 1.0428340435028076
Epoch: 21, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2685675621032715
Epoch: 22, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0033748149871826
Epoch: 23, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.2788712978363037
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0196962356567383
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.9961521625518799
Epoch: 26, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1974458694458008
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8353633880615234
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8426871299743652
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0030100345611572
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8565890789031982
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9552328586578369
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9917552471160889
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.467 Vali Acc: 0.950 Test Loss: 0.467 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.980802059173584
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.503 Vali Acc: 0.950 Test Loss: 0.503 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0896251201629639
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 8372788
model size : 36.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1208159923553467
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.480 Vali Acc: 0.225 Test Loss: 1.480 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.9323606491088867
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.373 Vali Acc: 0.350 Test Loss: 1.373 Test Acc: 0.350
Validation loss decreased (-0.224985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.0252532958984375
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.333 Vali Acc: 0.350 Test Loss: 1.333 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.8413689136505127
Epoch: 4, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.2406988143920898
Epoch: 5, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9011900424957275
Epoch: 6, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.301 Vali Acc: 0.700 Test Loss: 1.301 Test Acc: 0.700
Validation loss decreased (-0.499988 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 0.8851132392883301
Epoch: 7, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.047 Vali Acc: 0.550 Test Loss: 1.047 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0127558708190918
Epoch: 8, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.917 Vali Acc: 0.625 Test Loss: 0.917 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.08030366897583
Epoch: 9, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.904 Vali Acc: 0.600 Test Loss: 0.904 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9527642726898193
Epoch: 10, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.888 Vali Acc: 0.550 Test Loss: 0.888 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0307400226593018
Epoch: 11, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.699987 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 1.0396313667297363
Epoch: 12, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 13 cost time: 0.948216438293457
Epoch: 13, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.674 Vali Acc: 0.625 Test Loss: 0.674 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9993762969970703
Epoch: 14, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.774994 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.1660420894622803
Epoch: 15, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.9752061367034912
Epoch: 16, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 1.0681722164154053
Epoch: 17, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 1.0167031288146973
Epoch: 18, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8136816024780273
Epoch: 19, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.9629852771759033
Epoch: 20, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 1.2062444686889648
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.9215583801269531
Epoch: 22, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1980421543121338
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.131789207458496
Epoch: 24, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7440552711486816
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0520501136779785
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9632463455200195
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1130242347717285
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1171746253967285
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.0350439548492432
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 0.98982834815979
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.9225354194641113
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0421478748321533
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.8146986961364746
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.027012586593628
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.931412935256958
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.7879633903503418
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 1.0303280353546143
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.9205513000488281
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.8736999034881592
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.9931819438934326
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0473809242248535
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.950 Test Loss: 0.435 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3937313556671143
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0433790683746338
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8971188068389893
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.020401954650879
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1368896961212158
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.99019455909729
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0111019611358643
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0709116458892822
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 8368436
model size : 36.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3319904804229736
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.432 Vali Acc: 0.000 Test Loss: 1.432 Test Acc: 0.000
Validation loss decreased (inf --> 0.000014).  Saving model ...
Epoch: 2 cost time: 0.9935657978057861
Epoch: 2, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (0.000014 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.9758346080780029
Epoch: 3, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.402 Vali Acc: 0.425 Test Loss: 1.402 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.7469284534454346
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9600119590759277
Epoch: 5, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.424986 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.896571159362793
Epoch: 6, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.122 Vali Acc: 0.575 Test Loss: 1.122 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1114859580993652
Epoch: 7, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.8887672424316406
Epoch: 8, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.7631301879882812
Epoch: 9, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.866809606552124
Epoch: 10, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.894 Vali Acc: 0.575 Test Loss: 0.894 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7828044891357422
Epoch: 11, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9021635055541992
Epoch: 12, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.002082347869873
Epoch: 13, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1231122016906738
Epoch: 14, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.705 Vali Acc: 0.575 Test Loss: 0.705 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9499871730804443
Epoch: 15, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.935725212097168
Epoch: 16, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.618 Vali Acc: 0.725 Test Loss: 0.618 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9440255165100098
Epoch: 17, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.8691525459289551
Epoch: 18, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.9855961799621582
Epoch: 19, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8831472396850586
Epoch: 20, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.907181978225708
Epoch: 21, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3141539096832275
Epoch: 22, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.935676097869873
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0983824729919434
Epoch: 24, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.290097713470459
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9505102634429932
Epoch: 26, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9725158214569092
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0472605228424072
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 8364084
model size : 36.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8538992404937744
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.400 Vali Acc: 0.225 Test Loss: 1.400 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.8569097518920898
Epoch: 2, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.355 Vali Acc: 0.425 Test Loss: 1.355 Test Acc: 0.425
Validation loss decreased (-0.224986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 1.0522520542144775
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.292 Vali Acc: 0.525 Test Loss: 1.292 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 1.339613676071167
Epoch: 4, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.209 Vali Acc: 0.675 Test Loss: 1.209 Test Acc: 0.675
Validation loss decreased (-0.524987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 1.0106370449066162
Epoch: 5, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.192 Vali Acc: 0.450 Test Loss: 1.192 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0225050449371338
Epoch: 6, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.016 Vali Acc: 0.850 Test Loss: 1.016 Test Acc: 0.850
Validation loss decreased (-0.674988 --> -0.849990).  Saving model ...
Epoch: 7 cost time: 1.039776086807251
Epoch: 7, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1197853088378906
Epoch: 8, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.823 Vali Acc: 0.650 Test Loss: 0.823 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8943326473236084
Epoch: 9, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.804 Vali Acc: 0.600 Test Loss: 0.804 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9671666622161865
Epoch: 10, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2366104125976562
Epoch: 11, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1219253540039062
Epoch: 12, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.9171898365020752
Epoch: 13, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9689195156097412
Epoch: 14, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 1.2898542881011963
Epoch: 15, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 1.3212347030639648
Epoch: 16, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9723515510559082
Epoch: 17, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.9943349361419678
Epoch: 18, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924998).  Saving model ...
Epoch: 19 cost time: 1.1246628761291504
Epoch: 19, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8533365726470947
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2530992031097412
Epoch: 21, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9072811603546143
Epoch: 22, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.927318811416626
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0658047199249268
Epoch: 24, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8482935428619385
Epoch: 25, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9165534973144531
Epoch: 26, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8335278034210205
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.954214334487915
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.027261734008789
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9081821441650391
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3367278575897217
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1312427520751953
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 7917492
model size : 35.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7005159854888916
Epoch: 1, Steps: 3 | Train Loss: 1.571 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9225826263427734
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.459 Vali Acc: 0.275 Test Loss: 1.459 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.1000890731811523
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.065086841583252
Epoch: 4, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.324 Vali Acc: 0.350 Test Loss: 1.324 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.8582806587219238
Epoch: 5, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0012774467468262
Epoch: 6, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.0039799213409424
Epoch: 7, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.999 Vali Acc: 0.550 Test Loss: 0.999 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 0.8660881519317627
Epoch: 8, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.012 Vali Acc: 0.550 Test Loss: 1.012 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1082992553710938
Epoch: 9, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.895 Vali Acc: 0.600 Test Loss: 0.895 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599991).  Saving model ...
Epoch: 10 cost time: 1.1558926105499268
Epoch: 10, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
Validation loss decreased (-0.599991 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.133594036102295
Epoch: 11, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.664 Vali Acc: 0.650 Test Loss: 0.664 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1238300800323486
Epoch: 12, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.9746799468994141
Epoch: 13, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
Validation loss decreased (-0.749994 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.974005937576294
Epoch: 14, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.9787325859069824
Epoch: 15, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.021784782409668
Epoch: 16, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 1.068937063217163
Epoch: 17, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9941363334655762
Epoch: 18, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0168321132659912
Epoch: 19, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.538 Vali Acc: 0.625 Test Loss: 0.538 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0486488342285156
Epoch: 20, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.084806203842163
Epoch: 21, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1899442672729492
Epoch: 22, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2425215244293213
Epoch: 23, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0199611186981201
Epoch: 24, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.1386630535125732
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1129615306854248
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1680147647857666
Epoch: 27, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1049702167510986
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0040886402130127
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.087646245956421
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0880684852600098
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0406110286712646
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8839418888092041
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.947514533996582
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 7913140
model size : 35.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1658589839935303
Epoch: 1, Steps: 3 | Train Loss: 1.681 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9810669422149658
Epoch: 2, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.371 Vali Acc: 0.325 Test Loss: 1.371 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.9812302589416504
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.499 Vali Acc: 0.375 Test Loss: 1.499 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374985).  Saving model ...
Epoch: 4 cost time: 0.9805774688720703
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
Validation loss decreased (-0.374985 --> -0.449985).  Saving model ...
Epoch: 5 cost time: 0.9085071086883545
Epoch: 5, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.449985 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9518463611602783
Epoch: 6, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.106 Vali Acc: 0.525 Test Loss: 1.106 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.7380502223968506
Epoch: 7, Steps: 3 | Train Loss: 0.903 Vali Loss: 0.965 Vali Acc: 0.775 Test Loss: 0.965 Test Acc: 0.775
Validation loss decreased (-0.524989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.1453313827514648
Epoch: 8, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.062 Vali Acc: 0.500 Test Loss: 1.062 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.170395851135254
Epoch: 9, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.973 Vali Acc: 0.550 Test Loss: 0.973 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0017106533050537
Epoch: 10, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.797 Vali Acc: 0.575 Test Loss: 0.797 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0773305892944336
Epoch: 11, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.667 Vali Acc: 0.675 Test Loss: 0.667 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.78737473487854
Epoch: 12, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.777 Vali Acc: 0.650 Test Loss: 0.777 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9267957210540771
Epoch: 13, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.590 Vali Acc: 0.775 Test Loss: 0.590 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774994).  Saving model ...
Epoch: 14 cost time: 0.9852116107940674
Epoch: 14, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.670 Vali Acc: 0.650 Test Loss: 0.670 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8501243591308594
Epoch: 15, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 1.0105204582214355
Epoch: 16, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
Validation loss decreased (-0.799995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.8139946460723877
Epoch: 17, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.8883428573608398
Epoch: 18, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1040279865264893
Epoch: 19, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.7908005714416504
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9459109306335449
Epoch: 21, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.0018317699432373
Epoch: 22, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9557304382324219
Epoch: 23, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9725205898284912
Epoch: 24, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0063927173614502
Epoch: 25, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.853513240814209
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8698558807373047
Epoch: 27, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9438793659210205
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0491981506347656
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1479427814483643
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1256217956542969
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.476 Vali Acc: 0.925 Test Loss: 0.476 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 7908788
model size : 35.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.131171464920044
Epoch: 1, Steps: 3 | Train Loss: 1.518 Vali Loss: 1.510 Vali Acc: 0.250 Test Loss: 1.510 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.0694231986999512
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.452 Vali Acc: 0.300 Test Loss: 1.452 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.1365282535552979
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.396 Vali Acc: 0.225 Test Loss: 1.396 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2852766513824463
Epoch: 4, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.306 Vali Acc: 0.300 Test Loss: 1.306 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 1.3689229488372803
Epoch: 5, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.274 Vali Acc: 0.375 Test Loss: 1.274 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.1899399757385254
Epoch: 6, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 1.1093628406524658
Epoch: 7, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.449988 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.0106806755065918
Epoch: 8, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.904 Vali Acc: 0.650 Test Loss: 0.904 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 9 cost time: 0.9624209403991699
Epoch: 9, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.836 Vali Acc: 0.650 Test Loss: 0.836 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649992).  Saving model ...
Epoch: 10 cost time: 0.9355719089508057
Epoch: 10, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.927 Vali Acc: 0.575 Test Loss: 0.927 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0445513725280762
Epoch: 11, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.751 Vali Acc: 0.600 Test Loss: 0.751 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4504001140594482
Epoch: 12, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.608 Vali Acc: 0.650 Test Loss: 0.608 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649994).  Saving model ...
Epoch: 13 cost time: 0.8180325031280518
Epoch: 13, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.641 Vali Acc: 0.650 Test Loss: 0.641 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0226876735687256
Epoch: 14, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.548 Vali Acc: 0.700 Test Loss: 0.548 Test Acc: 0.700
Validation loss decreased (-0.649994 --> -0.699995).  Saving model ...
Epoch: 15 cost time: 1.115046739578247
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.538 Vali Acc: 0.650 Test Loss: 0.538 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0241880416870117
Epoch: 16, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.469 Vali Acc: 0.825 Test Loss: 0.469 Test Acc: 0.825
Validation loss decreased (-0.699995 --> -0.824995).  Saving model ...
Epoch: 17 cost time: 1.1477305889129639
Epoch: 17, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 1.120922565460205
Epoch: 18, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.438 Vali Acc: 0.825 Test Loss: 0.438 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.940040111541748
Epoch: 19, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 1.1081483364105225
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.354 Vali Acc: 0.825 Test Loss: 0.354 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9236576557159424
Epoch: 21, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.1144483089447021
Epoch: 22, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.231966257095337
Epoch: 23, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0401036739349365
Epoch: 24, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2343857288360596
Epoch: 25, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9424591064453125
Epoch: 26, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.8337531089782715
Epoch: 27, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.023848295211792
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.039475917816162
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1303529739379883
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1707077026367188
Epoch: 31, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2526097297668457
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.243523120880127
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9745461940765381
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 1.0276799201965332
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.0456509590148926
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9266221523284912
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2949120998382568
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.052933692932129
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9094235897064209
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0136597156524658
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2158076763153076
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1177661418914795
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1850407123565674
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2043395042419434
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 7904436
model size : 35.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8021814823150635
Epoch: 1, Steps: 3 | Train Loss: 1.604 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.924283504486084
Epoch: 2, Steps: 3 | Train Loss: 1.582 Vali Loss: 1.511 Vali Acc: 0.300 Test Loss: 1.511 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.9523036479949951
Epoch: 3, Steps: 3 | Train Loss: 1.544 Vali Loss: 1.396 Vali Acc: 0.225 Test Loss: 1.396 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9915344715118408
Epoch: 4, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2140014171600342
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.304 Vali Acc: 0.300 Test Loss: 1.304 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 1.0562515258789062
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.8949205875396729
Epoch: 7, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.215 Vali Acc: 0.525 Test Loss: 1.215 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.0386114120483398
Epoch: 8, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.149 Vali Acc: 0.725 Test Loss: 1.149 Test Acc: 0.725
Validation loss decreased (-0.524988 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.9092769622802734
Epoch: 9, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.037 Vali Acc: 0.575 Test Loss: 1.037 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.969834566116333
Epoch: 10, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3538432121276855
Epoch: 11, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.970 Vali Acc: 0.575 Test Loss: 0.970 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1320044994354248
Epoch: 12, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 1.213529109954834
Epoch: 13, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.728 Vali Acc: 0.575 Test Loss: 0.728 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9176597595214844
Epoch: 14, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.697 Vali Acc: 0.700 Test Loss: 0.697 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9277453422546387
Epoch: 15, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.712 Vali Acc: 0.700 Test Loss: 0.712 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9761002063751221
Epoch: 16, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.9474446773529053
Epoch: 17, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.601 Vali Acc: 0.775 Test Loss: 0.601 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0757410526275635
Epoch: 18, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.799993 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 1.1057608127593994
Epoch: 19, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1389992237091064
Epoch: 20, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1674330234527588
Epoch: 21, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9997835159301758
Epoch: 22, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1264934539794922
Epoch: 23, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8939242362976074
Epoch: 24, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0418498516082764
Epoch: 25, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0811593532562256
Epoch: 26, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.19718599319458
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0261242389678955
Epoch: 28, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3736116
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.016488790512085
Epoch: 1, Steps: 3 | Train Loss: 1.621 Vali Loss: 1.585 Vali Acc: 0.300 Test Loss: 1.585 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.140247106552124
Epoch: 2, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.491 Vali Acc: 0.325 Test Loss: 1.491 Test Acc: 0.325
Validation loss decreased (-0.299984 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 1.1129977703094482
Epoch: 3, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.397 Vali Acc: 0.375 Test Loss: 1.397 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.105485200881958
Epoch: 4, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.374 Vali Acc: 0.300 Test Loss: 1.374 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9189629554748535
Epoch: 5, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3015823364257812
Epoch: 6, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.306 Vali Acc: 0.350 Test Loss: 1.306 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.915473222732544
Epoch: 7, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.277 Vali Acc: 0.475 Test Loss: 1.277 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.9240143299102783
Epoch: 8, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.184 Vali Acc: 0.450 Test Loss: 1.184 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0371150970458984
Epoch: 9, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.045 Vali Acc: 0.775 Test Loss: 1.045 Test Acc: 0.775
Validation loss decreased (-0.474987 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.9258549213409424
Epoch: 10, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.991 Vali Acc: 0.550 Test Loss: 0.991 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4365925788879395
Epoch: 11, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.903 Vali Acc: 0.800 Test Loss: 0.903 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 0.9198393821716309
Epoch: 12, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1720664501190186
Epoch: 13, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1557884216308594
Epoch: 14, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.0062990188598633
Epoch: 15, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 1.1512782573699951
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 1.0023787021636963
Epoch: 17, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 1.1896560192108154
Epoch: 18, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3378627300262451
Epoch: 19, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1640758514404297
Epoch: 20, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 1.312309980392456
Epoch: 21, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2068958282470703
Epoch: 22, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.489 Vali Acc: 0.925 Test Loss: 0.489 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 1.0933527946472168
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0809886455535889
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0494041442871094
Epoch: 25, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.298403263092041
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0171186923980713
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2616019248962402
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8700940608978271
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0216712951660156
Epoch: 30, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1910312175750732
Epoch: 31, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1740443706512451
Epoch: 32, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.642 Vali Acc: 0.825 Test Loss: 0.642 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3733940
model size : 16.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.204528331756592
Epoch: 1, Steps: 3 | Train Loss: 1.743 Vali Loss: 1.742 Vali Acc: 0.225 Test Loss: 1.742 Test Acc: 0.225
Validation loss decreased (inf --> -0.224983).  Saving model ...
Epoch: 2 cost time: 1.0261027812957764
Epoch: 2, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.589 Vali Acc: 0.225 Test Loss: 1.589 Test Acc: 0.225
Validation loss decreased (-0.224983 --> -0.224984).  Saving model ...
Epoch: 3 cost time: 0.9782190322875977
Epoch: 3, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.405 Vali Acc: 0.125 Test Loss: 1.405 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.95664381980896
Epoch: 4, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.388 Vali Acc: 0.225 Test Loss: 1.388 Test Acc: 0.225
Validation loss decreased (-0.224984 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.9328367710113525
Epoch: 5, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.334 Vali Acc: 0.225 Test Loss: 1.334 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 6 cost time: 1.1389267444610596
Epoch: 6, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.290 Vali Acc: 0.450 Test Loss: 1.290 Test Acc: 0.450
Validation loss decreased (-0.224987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 1.1545567512512207
Epoch: 7, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.316 Vali Acc: 0.375 Test Loss: 1.316 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.237137794494629
Epoch: 8, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3084824085235596
Epoch: 9, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.264 Vali Acc: 0.650 Test Loss: 1.264 Test Acc: 0.650
Validation loss decreased (-0.449987 --> -0.649987).  Saving model ...
Epoch: 10 cost time: 1.191016674041748
Epoch: 10, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.8954293727874756
Epoch: 11, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 1.1382360458374023
Epoch: 12, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0441360473632812
Epoch: 13, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.905 Vali Acc: 0.525 Test Loss: 0.905 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0611779689788818
Epoch: 14, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.865 Vali Acc: 0.700 Test Loss: 0.865 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.011880874633789
Epoch: 15, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.9919209480285645
Epoch: 16, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.9159853458404541
Epoch: 17, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.0205976963043213
Epoch: 18, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.138887643814087
Epoch: 19, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1221592426300049
Epoch: 20, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2151825428009033
Epoch: 21, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 0.943476676940918
Epoch: 22, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 0.8858606815338135
Epoch: 23, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.524 Vali Acc: 0.800 Test Loss: 0.524 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1347248554229736
Epoch: 24, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9535102844238281
Epoch: 25, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1517417430877686
Epoch: 26, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.1868207454681396
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.9325728416442871
Epoch: 28, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4094653129577637
Epoch: 29, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1332676410675049
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0817101001739502
Epoch: 31, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0645976066589355
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0125010013580322
Epoch: 33, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.87528395652771
Epoch: 34, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9086618423461914
Epoch: 35, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.092541217803955
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2694697380065918
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3731764
model size : 16.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.920262575149536
Epoch: 1, Steps: 3 | Train Loss: 1.604 Vali Loss: 1.350 Vali Acc: 0.250 Test Loss: 1.350 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.8637535572052002
Epoch: 2, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.335 Vali Acc: 0.425 Test Loss: 1.335 Test Acc: 0.425
Validation loss decreased (-0.249987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.068448781967163
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.378 Vali Acc: 0.300 Test Loss: 1.378 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0040833950042725
Epoch: 4, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.404 Vali Acc: 0.375 Test Loss: 1.404 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9421830177307129
Epoch: 5, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.274 Vali Acc: 0.375 Test Loss: 1.274 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9760563373565674
Epoch: 6, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.151 Vali Acc: 0.475 Test Loss: 1.151 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.7622931003570557
Epoch: 7, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.091 Vali Acc: 0.525 Test Loss: 1.091 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.9595913887023926
Epoch: 8, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 1.0616862773895264
Epoch: 9, Steps: 3 | Train Loss: 0.886 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.8376901149749756
Epoch: 10, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.942 Vali Acc: 0.575 Test Loss: 0.942 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.083608865737915
Epoch: 11, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.649990 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.0087320804595947
Epoch: 12, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.756 Vali Acc: 0.725 Test Loss: 0.756 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0742998123168945
Epoch: 13, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9844551086425781
Epoch: 14, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.670 Vali Acc: 0.800 Test Loss: 0.670 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 1.0434818267822266
Epoch: 15, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 1.0305757522583008
Epoch: 16, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.799994 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.9937264919281006
Epoch: 17, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.8747527599334717
Epoch: 18, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0320448875427246
Epoch: 19, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.9321660995483398
Epoch: 20, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.055720329284668
Epoch: 21, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.79067063331604
Epoch: 22, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.2286572456359863
Epoch: 23, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.1448633670806885
Epoch: 24, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2522189617156982
Epoch: 25, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2477476596832275
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0573220252990723
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9144318103790283
Epoch: 28, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.993215799331665
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1302931308746338
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.098809003829956
Epoch: 31, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2560491561889648
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.963212251663208
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9910016059875488
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0784544944763184
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1295051574707031
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9362752437591553
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1262128353118896
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3729588
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0210490226745605
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.480 Vali Acc: 0.400 Test Loss: 1.480 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 0.861647367477417
Epoch: 2, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.413 Vali Acc: 0.450 Test Loss: 1.413 Test Acc: 0.450
Validation loss decreased (-0.399985 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.8928537368774414
Epoch: 3, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.350 Vali Acc: 0.475 Test Loss: 1.350 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.9374682903289795
Epoch: 4, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.301 Vali Acc: 0.275 Test Loss: 1.301 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9888122081756592
Epoch: 5, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.268 Vali Acc: 0.475 Test Loss: 1.268 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 1.2392661571502686
Epoch: 6, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.1397674083709717
Epoch: 7, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.207 Vali Acc: 0.625 Test Loss: 1.207 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 1.1503241062164307
Epoch: 8, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.126394271850586
Epoch: 9, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1026098728179932
Epoch: 10, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.045 Vali Acc: 0.500 Test Loss: 1.045 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0189452171325684
Epoch: 11, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 1.3631856441497803
Epoch: 12, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.902 Vali Acc: 0.625 Test Loss: 0.902 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.220782995223999
Epoch: 13, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.8608443737030029
Epoch: 14, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.734 Vali Acc: 0.700 Test Loss: 0.734 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1298751831054688
Epoch: 15, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774994).  Saving model ...
Epoch: 16 cost time: 1.1159520149230957
Epoch: 16, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.577 Vali Acc: 0.700 Test Loss: 0.577 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1240034103393555
Epoch: 17, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824995).  Saving model ...
Epoch: 18 cost time: 0.952855110168457
Epoch: 18, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.824995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.9256558418273926
Epoch: 19, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.17863130569458
Epoch: 20, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2794926166534424
Epoch: 21, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 1.1301052570343018
Epoch: 22, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1543443202972412
Epoch: 23, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1050291061401367
Epoch: 24, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9892821311950684
Epoch: 25, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2160639762878418
Epoch: 26, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9813687801361084
Epoch: 27, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8889114856719971
Epoch: 28, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3219027519226074
Epoch: 29, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.039964199066162
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.096330165863037
Epoch: 31, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2815028
model size : 13.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9642183780670166
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.338 Vali Acc: 0.225 Test Loss: 1.338 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.9097003936767578
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.316 Vali Acc: 0.250 Test Loss: 1.316 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.933617115020752
Epoch: 3, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.348 Vali Acc: 0.225 Test Loss: 1.348 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.979773998260498
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.326 Vali Acc: 0.225 Test Loss: 1.326 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0673346519470215
Epoch: 5, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.232 Vali Acc: 0.325 Test Loss: 1.232 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324988).  Saving model ...
Epoch: 6 cost time: 0.9238104820251465
Epoch: 6, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.324988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 1.0973269939422607
Epoch: 7, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9905977249145508
Epoch: 8, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.069126844406128
Epoch: 9, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.996 Vali Acc: 0.550 Test Loss: 0.996 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1867356300354004
Epoch: 10, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9838228225708008
Epoch: 11, Steps: 3 | Train Loss: 0.725 Vali Loss: 1.041 Vali Acc: 0.475 Test Loss: 1.041 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3054821491241455
Epoch: 12, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.02119779586792
Epoch: 13, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.764 Vali Acc: 0.750 Test Loss: 0.764 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.8559854030609131
Epoch: 14, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 15 cost time: 1.2245733737945557
Epoch: 15, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.758 Vali Acc: 0.700 Test Loss: 0.758 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.926234245300293
Epoch: 16, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.626 Vali Acc: 0.775 Test Loss: 0.626 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 17 cost time: 1.0376296043395996
Epoch: 17, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.774994 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.0689499378204346
Epoch: 18, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 1.0114245414733887
Epoch: 19, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1034507751464844
Epoch: 20, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.849609375
Epoch: 21, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0504088401794434
Epoch: 22, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1298298835754395
Epoch: 23, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0667288303375244
Epoch: 24, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.438 Vali Acc: 0.825 Test Loss: 0.438 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0742597579956055
Epoch: 25, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4085259437561035
Epoch: 26, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 1.0462181568145752
Epoch: 27, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3809239864349365
Epoch: 28, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0124015808105469
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.9978690147399902
Epoch: 30, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9515540599822998
Epoch: 31, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9649467468261719
Epoch: 32, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.88909912109375
Epoch: 33, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2166335582733154
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.121272087097168
Epoch: 35, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0798909664154053
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2836077213287354
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2461884021759033
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.431697130203247
Epoch: 39, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 2812852
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.923525810241699
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.426 Vali Acc: 0.200 Test Loss: 1.426 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.3666727542877197
Epoch: 2, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.401 Vali Acc: 0.150 Test Loss: 1.401 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.975895881652832
Epoch: 3, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
Validation loss decreased (-0.199986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.267284631729126
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.395 Vali Acc: 0.300 Test Loss: 1.395 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2123641967773438
Epoch: 5, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.335 Vali Acc: 0.475 Test Loss: 1.335 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 1.2544469833374023
Epoch: 6, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.215 Vali Acc: 0.525 Test Loss: 1.215 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.3339452743530273
Epoch: 7, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.2463436126708984
Epoch: 8, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 1.1397879123687744
Epoch: 9, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.044 Vali Acc: 0.775 Test Loss: 1.044 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 1.3464818000793457
Epoch: 10, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.03501558303833
Epoch: 11, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.876 Vali Acc: 0.850 Test Loss: 0.876 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 1.3777201175689697
Epoch: 12, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.772 Vali Acc: 0.900 Test Loss: 0.772 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 1.2772142887115479
Epoch: 13, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.725 Vali Acc: 0.875 Test Loss: 0.725 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.099822998046875
Epoch: 14, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.154419183731079
Epoch: 15, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.627 Vali Acc: 0.925 Test Loss: 0.627 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 1.066192626953125
Epoch: 16, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.567 Vali Acc: 0.725 Test Loss: 0.567 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0267002582550049
Epoch: 17, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 1.3428423404693604
Epoch: 18, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5292410850524902
Epoch: 19, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 1.1907880306243896
Epoch: 20, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.9578309059143066
Epoch: 21, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.031332015991211
Epoch: 22, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.0522289276123047
Epoch: 23, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1931679248809814
Epoch: 24, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.121203899383545
Epoch: 25, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1907997131347656
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9076085090637207
Epoch: 27, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.300706148147583
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5088412761688232
Epoch: 29, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0660130977630615
Epoch: 30, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2182121276855469
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1357009410858154
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2810676
model size : 13.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8814361095428467
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.443 Vali Acc: 0.400 Test Loss: 1.443 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.09932279586792
Epoch: 2, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.385 Vali Acc: 0.425 Test Loss: 1.385 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 1.2221355438232422
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9497025012969971
Epoch: 4, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.266 Vali Acc: 0.575 Test Loss: 1.266 Test Acc: 0.575
Validation loss decreased (-0.424986 --> -0.574987).  Saving model ...
Epoch: 5 cost time: 1.0129609107971191
Epoch: 5, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.218 Vali Acc: 0.525 Test Loss: 1.218 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9884076118469238
Epoch: 6, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.156 Vali Acc: 0.575 Test Loss: 1.156 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.8644678592681885
Epoch: 7, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.1160368919372559
Epoch: 8, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.090 Vali Acc: 0.575 Test Loss: 1.090 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.1544206142425537
Epoch: 9, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 1.2666480541229248
Epoch: 10, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.905 Vali Acc: 0.650 Test Loss: 0.905 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 11 cost time: 1.0266728401184082
Epoch: 11, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.871 Vali Acc: 0.600 Test Loss: 0.871 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1367089748382568
Epoch: 12, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.790 Vali Acc: 0.725 Test Loss: 0.790 Test Acc: 0.725
Validation loss decreased (-0.649991 --> -0.724992).  Saving model ...
Epoch: 13 cost time: 0.9043712615966797
Epoch: 13, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.769 Vali Acc: 0.650 Test Loss: 0.769 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0553061962127686
Epoch: 14, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.113295555114746
Epoch: 15, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.646 Vali Acc: 0.625 Test Loss: 0.646 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1556882858276367
Epoch: 16, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.749993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.1754345893859863
Epoch: 17, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1591806411743164
Epoch: 18, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.2624237537384033
Epoch: 19, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.1239957809448242
Epoch: 20, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0490939617156982
Epoch: 21, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.304553747177124
Epoch: 22, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.1165049076080322
Epoch: 23, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.0499496459960938
Epoch: 24, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0572044849395752
Epoch: 25, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9430637359619141
Epoch: 26, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.266101598739624
Epoch: 27, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1957640647888184
Epoch: 28, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.3212568759918213
Epoch: 29, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.349184513092041
Epoch: 30, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9967589378356934
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0222818851470947
Epoch: 32, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2154796123504639
Epoch: 33, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.187382459640503
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1320350170135498
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.010880708694458
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9441688060760498
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9683496952056885
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1823492050170898
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2808500
model size : 13.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1695683002471924
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.3518438339233398
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.340 Vali Acc: 0.375 Test Loss: 1.340 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0459797382354736
Epoch: 3, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.337 Vali Acc: 0.275 Test Loss: 1.337 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2982254028320312
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.332 Vali Acc: 0.275 Test Loss: 1.332 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2351999282836914
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.8713359832763672
Epoch: 6, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.284 Vali Acc: 0.475 Test Loss: 1.284 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 1.092782735824585
Epoch: 7, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.1141705513000488
Epoch: 8, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.059765338897705
Epoch: 9, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.2526414394378662
Epoch: 10, Steps: 3 | Train Loss: 0.887 Vali Loss: 0.983 Vali Acc: 0.775 Test Loss: 0.983 Test Acc: 0.775
Validation loss decreased (-0.499989 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 1.4545886516571045
Epoch: 11, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1568217277526855
Epoch: 12, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 1.280813217163086
Epoch: 13, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.2569026947021484
Epoch: 14, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 1.2865097522735596
Epoch: 15, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 1.302380084991455
Epoch: 16, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.0606317520141602
Epoch: 17, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.9395790100097656
Epoch: 18, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 1.0799086093902588
Epoch: 19, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 1.300980567932129
Epoch: 20, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0664026737213135
Epoch: 21, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9661922454833984
Epoch: 22, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1806201934814453
Epoch: 23, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.2297170162200928
Epoch: 24, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1986207962036133
Epoch: 25, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9119954109191895
Epoch: 26, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.15120267868042
Epoch: 27, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1669561862945557
Epoch: 28, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.269313097000122
Epoch: 29, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5440518856048584
Epoch: 30, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.987328290939331
Epoch: 31, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0163722038269043
Epoch: 32, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1224265098571777
Epoch: 33, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9263544082641602
Epoch: 34, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0762536525726318
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0821921825408936
Epoch: 36, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2354484
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.109699010848999
Epoch: 1, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.558 Vali Acc: 0.350 Test Loss: 1.558 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 1.3321967124938965
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.471 Vali Acc: 0.325 Test Loss: 1.471 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.65824556350708
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.396 Vali Acc: 0.350 Test Loss: 1.396 Test Acc: 0.350
Validation loss decreased (-0.349984 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0663249492645264
Epoch: 4, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.328 Vali Acc: 0.150 Test Loss: 1.328 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1001145839691162
Epoch: 5, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.285 Vali Acc: 0.200 Test Loss: 1.285 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9640800952911377
Epoch: 6, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.271 Vali Acc: 0.550 Test Loss: 1.271 Test Acc: 0.550
Validation loss decreased (-0.349986 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.8953208923339844
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.297 Vali Acc: 0.525 Test Loss: 1.297 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1162924766540527
Epoch: 8, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 1.146599292755127
Epoch: 9, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 1.2914257049560547
Epoch: 10, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.045 Vali Acc: 0.575 Test Loss: 1.045 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1410951614379883
Epoch: 11, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.1584489345550537
Epoch: 12, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.958 Vali Acc: 0.575 Test Loss: 0.958 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2926888465881348
Epoch: 13, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.928781270980835
Epoch: 14, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2254371643066406
Epoch: 15, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 1.00557279586792
Epoch: 16, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.714 Vali Acc: 0.650 Test Loss: 0.714 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2169830799102783
Epoch: 17, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
Validation loss decreased (-0.799993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.9629030227661133
Epoch: 18, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1374316215515137
Epoch: 19, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.498 Vali Acc: 0.775 Test Loss: 0.498 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1600615978240967
Epoch: 20, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9915938377380371
Epoch: 21, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 1.245673656463623
Epoch: 22, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.340653896331787
Epoch: 23, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1636381149291992
Epoch: 24, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3087818622589111
Epoch: 25, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9191315174102783
Epoch: 26, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 1.2219781875610352
Epoch: 27, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.153688669204712
Epoch: 28, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1016628742218018
Epoch: 29, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.231170654296875
Epoch: 30, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2430999279022217
Epoch: 31, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.184283971786499
Epoch: 32, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3412551879882812
Epoch: 33, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0577831268310547
Epoch: 34, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2880876064300537
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1799795627593994
Epoch: 36, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2463414669036865
Epoch: 37, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.091895341873169
Epoch: 38, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2160673141479492
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 2352308
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1536312103271484
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.575 Vali Acc: 0.350 Test Loss: 1.575 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 1.1423711776733398
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.487 Vali Acc: 0.300 Test Loss: 1.487 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9989635944366455
Epoch: 3, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.391 Vali Acc: 0.150 Test Loss: 1.391 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9130871295928955
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.370 Vali Acc: 0.200 Test Loss: 1.370 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0718252658843994
Epoch: 5, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (-0.349984 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.1772229671478271
Epoch: 6, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.345 Vali Acc: 0.275 Test Loss: 1.345 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.314436674118042
Epoch: 7, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 1.3151352405548096
Epoch: 8, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 1.223081350326538
Epoch: 9, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.129805564880371
Epoch: 10, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.145 Vali Acc: 0.450 Test Loss: 1.145 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449989).  Saving model ...
Epoch: 11 cost time: 1.0363166332244873
Epoch: 11, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
Validation loss decreased (-0.449989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.2474045753479004
Epoch: 12, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.059 Vali Acc: 0.525 Test Loss: 1.059 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.964268684387207
Epoch: 13, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.008 Vali Acc: 0.675 Test Loss: 1.008 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.9095926284790039
Epoch: 14, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.891878604888916
Epoch: 15, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.822 Vali Acc: 0.575 Test Loss: 0.822 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9044086933135986
Epoch: 16, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774993).  Saving model ...
Epoch: 17 cost time: 1.0727145671844482
Epoch: 17, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.840031623840332
Epoch: 18, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.0663657188415527
Epoch: 19, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 0.9786937236785889
Epoch: 20, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0487818717956543
Epoch: 21, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.9979410171508789
Epoch: 22, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9965639114379883
Epoch: 23, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.8935019969940186
Epoch: 24, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.485 Vali Acc: 0.750 Test Loss: 0.485 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0725677013397217
Epoch: 25, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2048540115356445
Epoch: 26, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1994636058807373
Epoch: 27, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 1.0986831188201904
Epoch: 28, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9670834541320801
Epoch: 29, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.9010047912597656
Epoch: 30, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9027872085571289
Epoch: 31, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1252520084381104
Epoch: 32, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.9908084869384766
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.0486626625061035
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0192131996154785
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.300349473953247
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 1.1850693225860596
Epoch: 37, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1332495212554932
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0372610092163086
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8560166358947754
Epoch: 40, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9045665264129639
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 1.1056222915649414
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.129950761795044
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.03657865524292
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9864952564239502
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2178232669830322
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 1.0005838871002197
Epoch: 47, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.476 Vali Acc: 0.825 Test Loss: 0.476 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3101773262023926
Epoch: 48, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1775774955749512
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.172262191772461
Epoch: 50, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1346664428710938
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1902940273284912
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.0489187240600586
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2506766319274902
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 55 cost time: 1.0117261409759521
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.241976261138916
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9188230037689209
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.5256836414337158
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.4289472103118896
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.5549225807189941
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8757143020629883
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0738646984100342
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.15578293800354
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.9540867805480957
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2350132
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.948545455932617
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.389 Vali Acc: 0.175 Test Loss: 1.389 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.9680864810943604
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.391 Vali Acc: 0.250 Test Loss: 1.391 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.0715303421020508
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.376 Vali Acc: 0.275 Test Loss: 1.376 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.1617076396942139
Epoch: 4, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.0551302433013916
Epoch: 5, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 1.1045751571655273
Epoch: 6, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.224 Vali Acc: 0.525 Test Loss: 1.224 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.0953640937805176
Epoch: 7, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.183 Vali Acc: 0.575 Test Loss: 1.183 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 1.1381895542144775
Epoch: 8, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.135 Vali Acc: 0.525 Test Loss: 1.135 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1847758293151855
Epoch: 9, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.132 Vali Acc: 0.525 Test Loss: 1.132 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0562844276428223
Epoch: 10, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.117 Vali Acc: 0.525 Test Loss: 1.117 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9091482162475586
Epoch: 11, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.8211917877197266
Epoch: 12, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.933 Vali Acc: 0.575 Test Loss: 0.933 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1871232986450195
Epoch: 13, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.599990 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.0451233386993408
Epoch: 14, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.762 Vali Acc: 0.675 Test Loss: 0.762 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2629339694976807
Epoch: 15, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.750 Vali Acc: 0.725 Test Loss: 0.750 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1812727451324463
Epoch: 16, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.747 Vali Acc: 0.675 Test Loss: 0.747 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.305403709411621
Epoch: 17, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.1818363666534424
Epoch: 18, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.1039373874664307
Epoch: 19, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 1.0397825241088867
Epoch: 20, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.8967499732971191
Epoch: 21, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0658879280090332
Epoch: 22, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2257928848266602
Epoch: 23, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9938669204711914
Epoch: 24, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.540 Vali Acc: 0.625 Test Loss: 0.540 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.087069034576416
Epoch: 25, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.2305197715759277
Epoch: 26, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2098681926727295
Epoch: 27, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.4278485774993896
Epoch: 28, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1708533763885498
Epoch: 29, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0263326168060303
Epoch: 30, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2608768939971924
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8225264549255371
Epoch: 32, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.189065933227539
Epoch: 33, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.862429141998291
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0696651935577393
Epoch: 35, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.246608018875122
Epoch: 36, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1271004676818848
Epoch: 37, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2347956
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.112266778945923
Epoch: 1, Steps: 3 | Train Loss: 1.663 Vali Loss: 1.479 Vali Acc: 0.275 Test Loss: 1.479 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.0004281997680664
Epoch: 2, Steps: 3 | Train Loss: 1.551 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
Validation loss decreased (-0.274985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.8858404159545898
Epoch: 3, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.358 Vali Acc: 0.350 Test Loss: 1.358 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9613733291625977
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.383 Vali Acc: 0.250 Test Loss: 1.383 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9965291023254395
Epoch: 5, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.421 Vali Acc: 0.250 Test Loss: 1.421 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8528029918670654
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.336 Vali Acc: 0.325 Test Loss: 1.336 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9483168125152588
Epoch: 7, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.219 Vali Acc: 0.525 Test Loss: 1.219 Test Acc: 0.525
Validation loss decreased (-0.399986 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.95340895652771
Epoch: 8, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.968487024307251
Epoch: 9, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.966458797454834
Epoch: 10, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.016 Vali Acc: 0.550 Test Loss: 1.016 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.080812931060791
Epoch: 11, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.1594810485839844
Epoch: 12, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.911 Vali Acc: 0.625 Test Loss: 0.911 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0959510803222656
Epoch: 13, Steps: 3 | Train Loss: 0.750 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 1.161794900894165
Epoch: 14, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.828 Vali Acc: 0.725 Test Loss: 0.828 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.080686330795288
Epoch: 15, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.1704225540161133
Epoch: 16, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 17 cost time: 1.1643147468566895
Epoch: 17, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 0.9605693817138672
Epoch: 18, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 1.0280249118804932
Epoch: 19, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9846503734588623
Epoch: 20, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.8011932373046875
Epoch: 21, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 1.0613031387329102
Epoch: 22, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 1.0075147151947021
Epoch: 23, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 24 cost time: 0.8943459987640381
Epoch: 24, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 1.2129170894622803
Epoch: 25, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.0401155948638916
Epoch: 26, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.849997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.1381943225860596
Epoch: 27, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.8899006843566895
Epoch: 28, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.891390323638916
Epoch: 29, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9579579830169678
Epoch: 30, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.8562643527984619
Epoch: 31, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.985360860824585
Epoch: 32, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8752536773681641
Epoch: 33, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.438122034072876
Epoch: 34, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.926023006439209
Epoch: 35, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0735492706298828
Epoch: 36, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9922738075256348
Epoch: 37, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0113537311553955
Epoch: 38, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9751431941986084
Epoch: 39, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9596066474914551
Epoch: 40, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2124212
model size : 10.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0704545974731445
Epoch: 1, Steps: 3 | Train Loss: 1.615 Vali Loss: 1.639 Vali Acc: 0.250 Test Loss: 1.639 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 1.052083969116211
Epoch: 2, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.540 Vali Acc: 0.175 Test Loss: 1.540 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2903523445129395
Epoch: 3, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
Validation loss decreased (-0.249984 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.0852441787719727
Epoch: 4, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.373 Vali Acc: 0.225 Test Loss: 1.373 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0941312313079834
Epoch: 5, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.337 Vali Acc: 0.225 Test Loss: 1.337 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1067428588867188
Epoch: 6, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.318 Vali Acc: 0.425 Test Loss: 1.318 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.1218571662902832
Epoch: 7, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.314 Vali Acc: 0.475 Test Loss: 1.314 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.9270970821380615
Epoch: 8, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0105838775634766
Epoch: 9, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.202 Vali Acc: 0.550 Test Loss: 1.202 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.8140592575073242
Epoch: 10, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.113 Vali Acc: 0.725 Test Loss: 1.113 Test Acc: 0.725
Validation loss decreased (-0.549988 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 1.0420186519622803
Epoch: 11, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.956352949142456
Epoch: 12, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9747397899627686
Epoch: 13, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.016 Vali Acc: 0.575 Test Loss: 1.016 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.112558364868164
Epoch: 14, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9961750507354736
Epoch: 15, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.9989602565765381
Epoch: 16, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.826 Vali Acc: 0.725 Test Loss: 0.826 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0069947242736816
Epoch: 17, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.783 Vali Acc: 0.575 Test Loss: 0.783 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9954583644866943
Epoch: 18, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.721 Vali Acc: 0.800 Test Loss: 0.721 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8626551628112793
Epoch: 19, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 1.1246154308319092
Epoch: 20, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.1327252388000488
Epoch: 21, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 1.0555739402770996
Epoch: 22, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1490347385406494
Epoch: 23, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.992866039276123
Epoch: 24, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.670 Vali Acc: 0.800 Test Loss: 0.670 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0334529876708984
Epoch: 25, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0559697151184082
Epoch: 26, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8725805282592773
Epoch: 27, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.9342567920684814
Epoch: 28, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2028398513793945
Epoch: 29, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0231623649597168
Epoch: 30, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 1.0635745525360107
Epoch: 31, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0806682109832764
Epoch: 32, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1771564483642578
Epoch: 33, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9086012840270996
Epoch: 34, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0230412483215332
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9338381290435791
Epoch: 36, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5682859420776367
Epoch: 37, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1082484722137451
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8197007179260254
Epoch: 39, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0559806823730469
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 2122036
model size : 10.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.745004892349243
Epoch: 1, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.387 Vali Acc: 0.275 Test Loss: 1.387 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9665260314941406
Epoch: 2, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.385 Vali Acc: 0.450 Test Loss: 1.385 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.0212278366088867
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.406 Vali Acc: 0.375 Test Loss: 1.406 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0392727851867676
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9428725242614746
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.326 Vali Acc: 0.450 Test Loss: 1.326 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.9436852931976318
Epoch: 6, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.7896862030029297
Epoch: 7, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.229 Vali Acc: 0.600 Test Loss: 1.229 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.9184792041778564
Epoch: 8, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.173 Vali Acc: 0.650 Test Loss: 1.173 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.8697257041931152
Epoch: 9, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.098 Vali Acc: 0.725 Test Loss: 1.098 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.8694114685058594
Epoch: 10, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.981386661529541
Epoch: 11, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.9744117259979248
Epoch: 12, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.004253625869751
Epoch: 13, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.859410285949707
Epoch: 14, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 1.1775689125061035
Epoch: 15, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.741 Vali Acc: 0.800 Test Loss: 0.741 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 1.0042345523834229
Epoch: 16, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.9133963584899902
Epoch: 17, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.9023139476776123
Epoch: 18, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.1034619808197021
Epoch: 19, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1053588390350342
Epoch: 20, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.8731088638305664
Epoch: 21, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 1.4750924110412598
Epoch: 22, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0024592876434326
Epoch: 23, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9116389751434326
Epoch: 24, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0850393772125244
Epoch: 25, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.847111701965332
Epoch: 26, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.003584384918213
Epoch: 27, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0830316543579102
Epoch: 28, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0693371295928955
Epoch: 29, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1121649742126465
Epoch: 30, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5578508377075195
Epoch: 31, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2119860
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4543509483337402
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.344 Vali Acc: 0.450 Test Loss: 1.344 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.030261754989624
Epoch: 2, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.332 Vali Acc: 0.425 Test Loss: 1.332 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4350135326385498
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.313 Vali Acc: 0.375 Test Loss: 1.313 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1791927814483643
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 1.0348923206329346
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9755587577819824
Epoch: 6, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.182 Vali Acc: 0.575 Test Loss: 1.182 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 1.0570652484893799
Epoch: 7, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2629234790802002
Epoch: 8, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.098 Vali Acc: 0.700 Test Loss: 1.098 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 1.0934128761291504
Epoch: 9, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.025 Vali Acc: 0.775 Test Loss: 1.025 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 1.1682758331298828
Epoch: 10, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1756165027618408
Epoch: 11, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.899 Vali Acc: 0.900 Test Loss: 0.899 Test Acc: 0.900
Validation loss decreased (-0.774990 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 1.0416455268859863
Epoch: 12, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.876 Vali Acc: 0.825 Test Loss: 0.876 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1188750267028809
Epoch: 13, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8724491596221924
Epoch: 14, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.791 Vali Acc: 0.625 Test Loss: 0.791 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2447292804718018
Epoch: 15, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 1.180436134338379
Epoch: 16, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 1.147186279296875
Epoch: 17, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2088501453399658
Epoch: 18, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9215431213378906
Epoch: 19, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2620720863342285
Epoch: 20, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1814215183258057
Epoch: 21, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.535 Vali Acc: 0.750 Test Loss: 0.535 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0634329319000244
Epoch: 22, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1692109107971191
Epoch: 23, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.9934298992156982
Epoch: 24, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3175568580627441
Epoch: 25, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.394 Vali Acc: 0.825 Test Loss: 0.394 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9924008846282959
Epoch: 26, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.036954641342163
Epoch: 27, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1240239143371582
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8326747417449951
Epoch: 29, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3681657314300537
Epoch: 30, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2390997409820557
Epoch: 31, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.335038185119629
Epoch: 32, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.176675796508789
Epoch: 33, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3835818767547607
Epoch: 34, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2105305194854736
Epoch: 35, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.049471139907837
Epoch: 36, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2117684
model size : 10.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.454479217529297
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9796853065490723
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.0378389358520508
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.0547590255737305
Epoch: 4, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.359 Vali Acc: 0.450 Test Loss: 1.359 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 0.7877695560455322
Epoch: 5, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.316 Vali Acc: 0.475 Test Loss: 1.316 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.980457067489624
Epoch: 6, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 1.2558279037475586
Epoch: 7, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.196 Vali Acc: 0.475 Test Loss: 1.196 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9888734817504883
Epoch: 8, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4326388835906982
Epoch: 9, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.086 Vali Acc: 0.725 Test Loss: 1.086 Test Acc: 0.725
Validation loss decreased (-0.549987 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.9907946586608887
Epoch: 10, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.074401617050171
Epoch: 11, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.009 Vali Acc: 0.550 Test Loss: 1.009 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9833700656890869
Epoch: 12, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.044724702835083
Epoch: 13, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.9758152961730957
Epoch: 14, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.782 Vali Acc: 0.800 Test Loss: 0.782 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.3827354907989502
Epoch: 15, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.776 Vali Acc: 0.725 Test Loss: 0.776 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.142261028289795
Epoch: 16, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.1068642139434814
Epoch: 17, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0564775466918945
Epoch: 18, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.215033769607544
Epoch: 19, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 1.1757140159606934
Epoch: 20, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 1.0578012466430664
Epoch: 21, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2926757335662842
Epoch: 22, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.0114521980285645
Epoch: 23, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.305311918258667
Epoch: 24, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.0522336959838867
Epoch: 25, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.5723798274993896
Epoch: 26, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0932743549346924
Epoch: 27, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2212543487548828
Epoch: 28, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.236727237701416
Epoch: 29, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.2122244834899902
Epoch: 30, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3163173198699951
Epoch: 31, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1824522018432617
Epoch: 32, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0182385444641113
Epoch: 33, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9719326496124268
Epoch: 34, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.206517219543457
Epoch: 35, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2706634998321533
Epoch: 36, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2419638633728027
Epoch: 37, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.193938970565796
Epoch: 38, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4849960803985596
Epoch: 39, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1412916
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8050661087036133
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.472 Vali Acc: 0.300 Test Loss: 1.472 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.0786633491516113
Epoch: 2, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.444 Vali Acc: 0.475 Test Loss: 1.444 Test Acc: 0.475
Validation loss decreased (-0.299985 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 1.1229686737060547
Epoch: 3, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.409 Vali Acc: 0.475 Test Loss: 1.409 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 1.01369047164917
Epoch: 4, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.368 Vali Acc: 0.425 Test Loss: 1.368 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9523003101348877
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.104285717010498
Epoch: 6, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.291 Vali Acc: 0.575 Test Loss: 1.291 Test Acc: 0.575
Validation loss decreased (-0.474986 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 0.972980260848999
Epoch: 7, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.266 Vali Acc: 0.375 Test Loss: 1.266 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0320701599121094
Epoch: 8, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0518202781677246
Epoch: 9, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.207 Vali Acc: 0.425 Test Loss: 1.207 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.040525197982788
Epoch: 10, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.125223159790039
Epoch: 11, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.108 Vali Acc: 0.575 Test Loss: 1.108 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0302395820617676
Epoch: 12, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.056 Vali Acc: 0.725 Test Loss: 1.056 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.4359023571014404
Epoch: 13, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.174105167388916
Epoch: 14, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.932 Vali Acc: 0.775 Test Loss: 0.932 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 1.0767030715942383
Epoch: 15, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.863 Vali Acc: 0.825 Test Loss: 0.863 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 1.0994925498962402
Epoch: 16, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 1.0893146991729736
Epoch: 17, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 1.0583703517913818
Epoch: 18, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3636791706085205
Epoch: 19, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.740 Vali Acc: 0.725 Test Loss: 0.740 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1567788124084473
Epoch: 20, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.3863434791564941
Epoch: 21, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1723062992095947
Epoch: 22, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.9984161853790283
Epoch: 23, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.9645898342132568
Epoch: 24, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 1.5512316226959229
Epoch: 25, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.221313238143921
Epoch: 26, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.483 Vali Acc: 0.825 Test Loss: 0.483 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3945777416229248
Epoch: 27, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1588389873504639
Epoch: 28, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3606781959533691
Epoch: 29, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.096308708190918
Epoch: 30, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.232790470123291
Epoch: 31, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2186405658721924
Epoch: 32, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.375990867614746
Epoch: 33, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1482882499694824
Epoch: 34, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1411828
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0704426765441895
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.441 Vali Acc: 0.300 Test Loss: 1.441 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9029028415679932
Epoch: 2, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.421 Vali Acc: 0.300 Test Loss: 1.421 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9245340824127197
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.384 Vali Acc: 0.225 Test Loss: 1.384 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3423492908477783
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 1.0378649234771729
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.342 Vali Acc: 0.450 Test Loss: 1.342 Test Acc: 0.450
Validation loss decreased (-0.299986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.9958047866821289
Epoch: 6, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.9438576698303223
Epoch: 7, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.291 Vali Acc: 0.475 Test Loss: 1.291 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 1.0779502391815186
Epoch: 8, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.242 Vali Acc: 0.350 Test Loss: 1.242 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2396986484527588
Epoch: 9, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.174 Vali Acc: 0.375 Test Loss: 1.174 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8061094284057617
Epoch: 10, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.474987 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.9419984817504883
Epoch: 11, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0387945175170898
Epoch: 12, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.036 Vali Acc: 0.475 Test Loss: 1.036 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1745288372039795
Epoch: 13, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3783164024353027
Epoch: 14, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.921 Vali Acc: 0.650 Test Loss: 0.921 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4727635383605957
Epoch: 15, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.844 Vali Acc: 0.700 Test Loss: 0.844 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699992).  Saving model ...
Epoch: 16 cost time: 1.1130812168121338
Epoch: 16, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.746 Vali Acc: 0.750 Test Loss: 0.746 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 1.0649535655975342
Epoch: 17, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.681 Vali Acc: 0.650 Test Loss: 0.681 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9260406494140625
Epoch: 18, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.749993 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.5537517070770264
Epoch: 19, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1461243629455566
Epoch: 20, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1043922901153564
Epoch: 21, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4949061870574951
Epoch: 22, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.2867388725280762
Epoch: 23, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3575563430786133
Epoch: 24, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.3620398044586182
Epoch: 25, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.409317970275879
Epoch: 26, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5502111911773682
Epoch: 27, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.402 Vali Acc: 0.825 Test Loss: 0.402 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5851631164550781
Epoch: 28, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.396 Vali Acc: 0.825 Test Loss: 0.396 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3382899761199951
Epoch: 29, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.401 Vali Acc: 0.825 Test Loss: 0.401 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3182454109191895
Epoch: 30, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4697473049163818
Epoch: 31, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1233532428741455
Epoch: 32, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.389 Vali Acc: 0.825 Test Loss: 0.389 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1650714874267578
Epoch: 33, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1927142143249512
Epoch: 34, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1410740
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8343372344970703
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.406 Vali Acc: 0.225 Test Loss: 1.406 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.8360035419464111
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.379 Vali Acc: 0.225 Test Loss: 1.379 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.1371185779571533
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.349 Vali Acc: 0.150 Test Loss: 1.349 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0904598236083984
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.8257060050964355
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.299 Vali Acc: 0.350 Test Loss: 1.299 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 1.1158881187438965
Epoch: 6, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.255 Vali Acc: 0.425 Test Loss: 1.255 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.1338706016540527
Epoch: 7, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.226 Vali Acc: 0.300 Test Loss: 1.226 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1531081199645996
Epoch: 8, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.187 Vali Acc: 0.450 Test Loss: 1.187 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 1.2128159999847412
Epoch: 9, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.1505630016326904
Epoch: 10, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
Validation loss decreased (-0.499989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.0639393329620361
Epoch: 11, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 1.1042053699493408
Epoch: 12, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4775078296661377
Epoch: 13, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.878 Vali Acc: 0.700 Test Loss: 0.878 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1919209957122803
Epoch: 14, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 1.0109095573425293
Epoch: 15, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1052024364471436
Epoch: 16, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.780 Vali Acc: 0.700 Test Loss: 0.780 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2314584255218506
Epoch: 17, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.0941505432128906
Epoch: 18, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.615 Vali Acc: 0.875 Test Loss: 0.615 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.2798035144805908
Epoch: 19, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 1.121577501296997
Epoch: 20, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1677427291870117
Epoch: 21, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.315281867980957
Epoch: 22, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 1.1135482788085938
Epoch: 23, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.448 Vali Acc: 0.825 Test Loss: 0.448 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0956156253814697
Epoch: 24, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 1.2831478118896484
Epoch: 25, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.0581512451171875
Epoch: 26, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.080211877822876
Epoch: 27, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.243940830230713
Epoch: 28, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3581135272979736
Epoch: 29, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.4322047233581543
Epoch: 30, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2623794078826904
Epoch: 31, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1181390285491943
Epoch: 32, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.0200269222259521
Epoch: 33, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1668269634246826
Epoch: 34, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2838304042816162
Epoch: 35, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1820929050445557
Epoch: 36, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.0257458686828613
Epoch: 37, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.157189130783081
Epoch: 38, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1921041011810303
Epoch: 39, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.441 Vali Acc: 0.825 Test Loss: 0.441 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2232158184051514
Epoch: 40, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.1276912689208984
Epoch: 41, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 1.3348474502563477
Epoch: 42, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.400 Vali Acc: 0.825 Test Loss: 0.400 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0699553489685059
Epoch: 43, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.190873622894287
Epoch: 44, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4867370128631592
Epoch: 45, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.151838779449463
Epoch: 46, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0312585830688477
Epoch: 47, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0708644390106201
Epoch: 48, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.2393455505371094
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2349793910980225
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2413125038146973
Epoch: 51, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1409652
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.012427806854248
Epoch: 1, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.337 Vali Acc: 0.200 Test Loss: 1.337 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.9374856948852539
Epoch: 2, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.336 Vali Acc: 0.200 Test Loss: 1.336 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.8349332809448242
Epoch: 3, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.334 Vali Acc: 0.200 Test Loss: 1.334 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.9171385765075684
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.321 Vali Acc: 0.200 Test Loss: 1.321 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.9303319454193115
Epoch: 5, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.303 Vali Acc: 0.275 Test Loss: 1.303 Test Acc: 0.275
Validation loss decreased (-0.199987 --> -0.274987).  Saving model ...
Epoch: 6 cost time: 1.0177476406097412
Epoch: 6, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.274 Vali Acc: 0.425 Test Loss: 1.274 Test Acc: 0.425
Validation loss decreased (-0.274987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.86944580078125
Epoch: 7, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.235 Vali Acc: 0.300 Test Loss: 1.235 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0364913940429688
Epoch: 8, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.201 Vali Acc: 0.475 Test Loss: 1.201 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.9165356159210205
Epoch: 9, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.0660068988800049
Epoch: 10, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.131 Vali Acc: 0.475 Test Loss: 1.131 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0684738159179688
Epoch: 11, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.094 Vali Acc: 0.525 Test Loss: 1.094 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 12 cost time: 1.1631357669830322
Epoch: 12, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.045 Vali Acc: 0.750 Test Loss: 1.045 Test Acc: 0.750
Validation loss decreased (-0.524989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.9925110340118408
Epoch: 13, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8700926303863525
Epoch: 14, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.916 Vali Acc: 0.675 Test Loss: 0.916 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0880091190338135
Epoch: 15, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.9002296924591064
Epoch: 16, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.9002153873443604
Epoch: 17, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8529379367828369
Epoch: 18, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.944080114364624
Epoch: 19, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.9522156715393066
Epoch: 20, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8497054576873779
Epoch: 21, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.9955811500549316
Epoch: 22, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.7998733520507812
Epoch: 23, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8357224464416504
Epoch: 24, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.9291675090789795
Epoch: 25, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.9732825756072998
Epoch: 26, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.0432987213134766
Epoch: 27, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.970585823059082
Epoch: 28, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.8052244186401367
Epoch: 29, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9000406265258789
Epoch: 30, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 1.2265574932098389
Epoch: 31, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8668012619018555
Epoch: 32, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9997768402099609
Epoch: 33, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3653013706207275
Epoch: 34, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8336789608001709
Epoch: 35, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9458541870117188
Epoch: 36, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9949946403503418
Epoch: 37, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0872290134429932
Epoch: 38, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.9744477272033691
Epoch: 39, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8074624538421631
Epoch: 40, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0415210723876953
Epoch: 41, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.065824270248413
Epoch: 42, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0286905765533447
Epoch: 43, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9917504787445068
Epoch: 44, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.405439853668213
Epoch: 45, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8877863883972168
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.049250841140747
Epoch: 47, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 1.001887559890747
Epoch: 48, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8617892265319824
Epoch: 49, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1746153831481934
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9854085445404053
Epoch: 51, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2057397365570068
Epoch: 52, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0834050178527832
Epoch: 53, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9738574028015137
Epoch: 54, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9836411476135254
Epoch: 55, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0022869110107422
Epoch: 56, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9613869190216064
Epoch: 57, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 950580
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1966259479522705
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.9741189479827881
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.9073259830474854
Epoch: 3, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.308 Vali Acc: 0.450 Test Loss: 1.308 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.0487885475158691
Epoch: 4, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.294 Vali Acc: 0.600 Test Loss: 1.294 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.7546653747558594
Epoch: 5, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9536335468292236
Epoch: 6, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.263 Vali Acc: 0.450 Test Loss: 1.263 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9643986225128174
Epoch: 7, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0415475368499756
Epoch: 8, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.198 Vali Acc: 0.425 Test Loss: 1.198 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0145933628082275
Epoch: 9, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9430587291717529
Epoch: 10, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.133 Vali Acc: 0.525 Test Loss: 1.133 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7545387744903564
Epoch: 11, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.069 Vali Acc: 0.575 Test Loss: 1.069 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8846836090087891
Epoch: 12, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 1.0122478008270264
Epoch: 13, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.939314603805542
Epoch: 14, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 0.8591699600219727
Epoch: 15, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.855 Vali Acc: 0.700 Test Loss: 0.855 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9129607677459717
Epoch: 16, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.802 Vali Acc: 0.825 Test Loss: 0.802 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.8212766647338867
Epoch: 17, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.9156756401062012
Epoch: 18, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.9380407333374023
Epoch: 19, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9542038440704346
Epoch: 20, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8151183128356934
Epoch: 21, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.8301787376403809
Epoch: 22, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 1.1016135215759277
Epoch: 23, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8420670032501221
Epoch: 24, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 1.0841264724731445
Epoch: 25, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.9378461837768555
Epoch: 26, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.856680154800415
Epoch: 27, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.8646049499511719
Epoch: 28, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 1.1003661155700684
Epoch: 29, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.26259446144104
Epoch: 30, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.8681633472442627
Epoch: 31, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.0372424125671387
Epoch: 32, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.9265060424804688
Epoch: 33, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.8727278709411621
Epoch: 34, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.170846939086914
Epoch: 35, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9387538433074951
Epoch: 36, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8853809833526611
Epoch: 37, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0149884223937988
Epoch: 38, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0575933456420898
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.8018069267272949
Epoch: 40, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9423444271087646
Epoch: 41, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.924555778503418
Epoch: 42, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.632002353668213
Epoch: 43, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2822327613830566
Epoch: 44, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.802771806716919
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4198791980743408
Epoch: 46, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.642449140548706
Epoch: 47, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3359606266021729
Epoch: 48, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2596983909606934
Epoch: 49, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 949492
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4416744709014893
Epoch: 1, Steps: 3 | Train Loss: 1.576 Vali Loss: 1.474 Vali Acc: 0.300 Test Loss: 1.474 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.141183614730835
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.454 Vali Acc: 0.275 Test Loss: 1.454 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2389967441558838
Epoch: 3, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.449 Vali Acc: 0.250 Test Loss: 1.449 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0516257286071777
Epoch: 4, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.8293912410736084
Epoch: 5, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.425 Test Loss: 1.386 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.118241786956787
Epoch: 6, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.424986 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 1.1028125286102295
Epoch: 7, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.7936477661132812
Epoch: 8, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.8837676048278809
Epoch: 9, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.024752140045166
Epoch: 10, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.145 Vali Acc: 0.550 Test Loss: 1.145 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9614593982696533
Epoch: 11, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.8694047927856445
Epoch: 12, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.8894305229187012
Epoch: 13, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.9978997707366943
Epoch: 14, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.9304654598236084
Epoch: 15, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.896 Vali Acc: 0.725 Test Loss: 0.896 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.9432175159454346
Epoch: 16, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.8975429534912109
Epoch: 17, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.9718015193939209
Epoch: 18, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 1.1367602348327637
Epoch: 19, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2481513023376465
Epoch: 20, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.017540693283081
Epoch: 21, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1910269260406494
Epoch: 22, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.135443925857544
Epoch: 23, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.214444875717163
Epoch: 24, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.9345090389251709
Epoch: 25, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.96809983253479
Epoch: 26, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8840656280517578
Epoch: 27, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.9936282634735107
Epoch: 28, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.153902530670166
Epoch: 29, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9840974807739258
Epoch: 30, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.048689842224121
Epoch: 31, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1405720710754395
Epoch: 32, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1806449890136719
Epoch: 33, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0648205280303955
Epoch: 34, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.9336881637573242
Epoch: 35, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8137884140014648
Epoch: 36, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0974369049072266
Epoch: 37, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1455113887786865
Epoch: 38, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 39 cost time: 0.9826059341430664
Epoch: 39, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 1.2171568870544434
Epoch: 40, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0213608741760254
Epoch: 41, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.144380807876587
Epoch: 42, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1772220134735107
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9834702014923096
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 45 cost time: 1.1503276824951172
Epoch: 45, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.398998498916626
Epoch: 46, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1112444400787354
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1730530261993408
Epoch: 48, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1684975624084473
Epoch: 49, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3564212322235107
Epoch: 50, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9926161766052246
Epoch: 51, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9754936695098877
Epoch: 52, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1597840785980225
Epoch: 53, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9989242553710938
Epoch: 54, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 948404
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.328350305557251
Epoch: 1, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.455 Vali Acc: 0.175 Test Loss: 1.455 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 1.4718174934387207
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.448 Vali Acc: 0.175 Test Loss: 1.448 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.1643474102020264
Epoch: 3, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.438 Vali Acc: 0.250 Test Loss: 1.438 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.3744947910308838
Epoch: 4, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.429 Vali Acc: 0.225 Test Loss: 1.429 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9856019020080566
Epoch: 5, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.423 Vali Acc: 0.150 Test Loss: 1.423 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1048893928527832
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.422 Vali Acc: 0.125 Test Loss: 1.422 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2237522602081299
Epoch: 7, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 1.16819167137146
Epoch: 8, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.337 Vali Acc: 0.425 Test Loss: 1.337 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.265362024307251
Epoch: 9, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.14229416847229
Epoch: 10, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.221 Vali Acc: 0.475 Test Loss: 1.221 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2179982662200928
Epoch: 11, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.0228979587554932
Epoch: 12, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.131 Vali Acc: 0.550 Test Loss: 1.131 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3304164409637451
Epoch: 13, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1552326679229736
Epoch: 14, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 15 cost time: 1.2534384727478027
Epoch: 15, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 1.142728328704834
Epoch: 16, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.973 Vali Acc: 0.625 Test Loss: 0.973 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 1.0447578430175781
Epoch: 17, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1288731098175049
Epoch: 18, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.864 Vali Acc: 0.575 Test Loss: 0.864 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8792128562927246
Epoch: 19, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.624990 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.8333871364593506
Epoch: 20, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.775 Vali Acc: 0.725 Test Loss: 0.775 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.163783073425293
Epoch: 21, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.776 Vali Acc: 0.675 Test Loss: 0.776 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0801610946655273
Epoch: 22, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.735 Vali Acc: 0.700 Test Loss: 0.735 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.43595552444458
Epoch: 23, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.683 Vali Acc: 0.725 Test Loss: 0.683 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5061066150665283
Epoch: 24, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 1.2214829921722412
Epoch: 25, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.99582839012146
Epoch: 26, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 27 cost time: 1.0705184936523438
Epoch: 27, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
Validation loss decreased (-0.824995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.21915602684021
Epoch: 28, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0939836502075195
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5203309059143066
Epoch: 30, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.514 Vali Acc: 0.800 Test Loss: 0.514 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3975262641906738
Epoch: 31, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1218361854553223
Epoch: 32, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9628028869628906
Epoch: 33, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.140428066253662
Epoch: 34, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4899826049804688
Epoch: 35, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.430 Vali Acc: 0.825 Test Loss: 0.430 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2551422119140625
Epoch: 36, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.427 Vali Acc: 0.825 Test Loss: 0.427 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.039179801940918
Epoch: 37, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 947316
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.275879144668579
Epoch: 1, Steps: 3 | Train Loss: 1.655 Vali Loss: 1.595 Vali Acc: 0.250 Test Loss: 1.595 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 1.049086093902588
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.508 Vali Acc: 0.500 Test Loss: 1.508 Test Acc: 0.500
Validation loss decreased (-0.249984 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.8045258522033691
Epoch: 3, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.426 Vali Acc: 0.375 Test Loss: 1.426 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0893592834472656
Epoch: 4, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1748616695404053
Epoch: 5, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0530359745025635
Epoch: 6, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9419224262237549
Epoch: 7, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.259 Vali Acc: 0.450 Test Loss: 1.259 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0054118633270264
Epoch: 8, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9070017337799072
Epoch: 9, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.229 Vali Acc: 0.525 Test Loss: 1.229 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.0765111446380615
Epoch: 10, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.9258325099945068
Epoch: 11, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.198 Vali Acc: 0.650 Test Loss: 1.198 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 1.1297917366027832
Epoch: 12, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.148 Vali Acc: 0.650 Test Loss: 1.148 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 1.2653231620788574
Epoch: 13, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.089 Vali Acc: 0.675 Test Loss: 1.089 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.8995628356933594
Epoch: 14, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.2676117420196533
Epoch: 15, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 1.0016489028930664
Epoch: 16, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.941 Vali Acc: 0.825 Test Loss: 0.941 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 0.97536301612854
Epoch: 17, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.896 Vali Acc: 0.850 Test Loss: 0.896 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 1.236645221710205
Epoch: 18, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.875 Vali Acc: 0.825 Test Loss: 0.875 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9759564399719238
Epoch: 19, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.801 Vali Acc: 0.850 Test Loss: 0.801 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 1.0251128673553467
Epoch: 20, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9359900951385498
Epoch: 21, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.9119150638580322
Epoch: 22, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.9785306453704834
Epoch: 23, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8743624687194824
Epoch: 24, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.8915808200836182
Epoch: 25, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.941735029220581
Epoch: 26, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8885674476623535
Epoch: 27, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.8881750106811523
Epoch: 28, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 0.9995720386505127
Epoch: 29, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.9906563758850098
Epoch: 30, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 31 cost time: 0.9646575450897217
Epoch: 31, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 32 cost time: 1.0119907855987549
Epoch: 32, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 33 cost time: 0.7673506736755371
Epoch: 33, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.8498506546020508
Epoch: 34, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.027193307876587
Epoch: 35, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8984477519989014
Epoch: 36, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9527297019958496
Epoch: 37, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9233720302581787
Epoch: 38, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9096777439117432
Epoch: 39, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.892003059387207
Epoch: 40, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1221098899841309
Epoch: 41, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9826149940490723
Epoch: 42, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0172605514526367
Epoch: 43, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 719412
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.959829568862915
Epoch: 1, Steps: 3 | Train Loss: 1.620 Vali Loss: 1.421 Vali Acc: 0.250 Test Loss: 1.421 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.0028166770935059
Epoch: 2, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.386 Vali Acc: 0.175 Test Loss: 1.386 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6044375896453857
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.372 Vali Acc: 0.425 Test Loss: 1.372 Test Acc: 0.425
Validation loss decreased (-0.249986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 1.0593328475952148
Epoch: 4, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 1.0693600177764893
Epoch: 5, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.417 Vali Acc: 0.225 Test Loss: 1.417 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9195454120635986
Epoch: 6, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.435 Vali Acc: 0.300 Test Loss: 1.435 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3485784530639648
Epoch: 7, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8360192775726318
Epoch: 8, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.337 Vali Acc: 0.325 Test Loss: 1.337 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.250077724456787
Epoch: 9, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.266 Vali Acc: 0.375 Test Loss: 1.266 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8506853580474854
Epoch: 10, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.215 Vali Acc: 0.525 Test Loss: 1.215 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.9181759357452393
Epoch: 11, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 1.0695464611053467
Epoch: 12, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.9184865951538086
Epoch: 13, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.8817949295043945
Epoch: 14, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.181516170501709
Epoch: 15, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8646881580352783
Epoch: 16, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.021 Vali Acc: 0.625 Test Loss: 1.021 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 1.0734515190124512
Epoch: 17, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.943 Vali Acc: 0.625 Test Loss: 0.943 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 18 cost time: 0.9938499927520752
Epoch: 18, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.879 Vali Acc: 0.800 Test Loss: 0.879 Test Acc: 0.800
Validation loss decreased (-0.624991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.9352526664733887
Epoch: 19, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9893360137939453
Epoch: 20, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8741772174835205
Epoch: 21, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.103259563446045
Epoch: 22, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.698 Vali Acc: 0.750 Test Loss: 0.698 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.002303123474121
Epoch: 23, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.9499971866607666
Epoch: 24, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.082331895828247
Epoch: 25, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0061371326446533
Epoch: 26, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.8725709915161133
Epoch: 27, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.579 Vali Acc: 0.925 Test Loss: 0.579 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 0.9926915168762207
Epoch: 28, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0430467128753662
Epoch: 29, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0147652626037598
Epoch: 30, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.8569352626800537
Epoch: 31, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9917585849761963
Epoch: 32, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9849410057067871
Epoch: 33, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0157172679901123
Epoch: 34, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8967573642730713
Epoch: 35, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8532211780548096
Epoch: 36, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.468 Vali Acc: 0.825 Test Loss: 0.468 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8631212711334229
Epoch: 37, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.191596508026123
Epoch: 38, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.475 Vali Acc: 0.825 Test Loss: 0.475 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8743391036987305
Epoch: 39, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9495353698730469
Epoch: 40, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 718324
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1558945178985596
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.463 Vali Acc: 0.375 Test Loss: 1.463 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 1.1661090850830078
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.425 Vali Acc: 0.350 Test Loss: 1.425 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1530182361602783
Epoch: 3, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.391 Vali Acc: 0.275 Test Loss: 1.391 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0595192909240723
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.362 Vali Acc: 0.275 Test Loss: 1.362 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9984285831451416
Epoch: 5, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.341 Vali Acc: 0.275 Test Loss: 1.341 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3826203346252441
Epoch: 6, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.168226957321167
Epoch: 7, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.0101079940795898
Epoch: 8, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.275 Vali Acc: 0.350 Test Loss: 1.275 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.293668270111084
Epoch: 9, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.262089729309082
Epoch: 10, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.224 Vali Acc: 0.475 Test Loss: 1.224 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8227179050445557
Epoch: 11, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.174 Vali Acc: 0.575 Test Loss: 1.174 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.0691206455230713
Epoch: 12, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.167020559310913
Epoch: 13, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0610201358795166
Epoch: 14, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9426336288452148
Epoch: 15, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.994 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 1.1458539962768555
Epoch: 16, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.941 Vali Acc: 0.675 Test Loss: 0.941 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 0.9449136257171631
Epoch: 17, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.928 Vali Acc: 0.675 Test Loss: 0.928 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 1.100672960281372
Epoch: 18, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 1.0153422355651855
Epoch: 19, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 1.0348255634307861
Epoch: 20, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 0.9698758125305176
Epoch: 21, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 1.0397429466247559
Epoch: 22, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.699 Vali Acc: 0.750 Test Loss: 0.699 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2792863845825195
Epoch: 23, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.641 Vali Acc: 0.775 Test Loss: 0.641 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 24 cost time: 0.8501393795013428
Epoch: 24, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.578 Vali Acc: 0.875 Test Loss: 0.578 Test Acc: 0.875
Validation loss decreased (-0.774994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.1235079765319824
Epoch: 25, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.1203503608703613
Epoch: 26, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.2007486820220947
Epoch: 27, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3421485424041748
Epoch: 28, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.053192138671875
Epoch: 29, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.493 Vali Acc: 0.750 Test Loss: 0.493 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.131263256072998
Epoch: 30, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1603641510009766
Epoch: 31, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1631405353546143
Epoch: 32, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5556578636169434
Epoch: 33, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.0340077877044678
Epoch: 34, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1347475051879883
Epoch: 35, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2593457698822021
Epoch: 36, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8780512809753418
Epoch: 37, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 0.940065860748291
Epoch: 38, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.071256160736084
Epoch: 39, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.8782868385314941
Epoch: 40, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 1.3552889823913574
Epoch: 41, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2656500339508057
Epoch: 42, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 1.1007874011993408
Epoch: 43, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1659960746765137
Epoch: 44, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1408214569091797
Epoch: 45, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1491107940673828
Epoch: 46, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2149672508239746
Epoch: 47, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1941468715667725
Epoch: 48, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3915448188781738
Epoch: 49, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2284965515136719
Epoch: 50, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.1051177978515625
Epoch: 51, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1440050601959229
Epoch: 52, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 717236
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2763407230377197
Epoch: 1, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.549 Vali Acc: 0.250 Test Loss: 1.549 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2263453006744385
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.493 Vali Acc: 0.200 Test Loss: 1.493 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.213395357131958
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.449 Vali Acc: 0.250 Test Loss: 1.449 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.2145845890045166
Epoch: 4, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.426 Vali Acc: 0.200 Test Loss: 1.426 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8431687355041504
Epoch: 5, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.424 Vali Acc: 0.325 Test Loss: 1.424 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.2064886093139648
Epoch: 6, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.429 Vali Acc: 0.275 Test Loss: 1.429 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.044398546218872
Epoch: 7, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.391 Vali Acc: 0.300 Test Loss: 1.391 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5098838806152344
Epoch: 8, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 1.2122373580932617
Epoch: 9, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2672643661499023
Epoch: 10, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.286 Vali Acc: 0.450 Test Loss: 1.286 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 1.089369297027588
Epoch: 11, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.1143276691436768
Epoch: 12, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.200 Vali Acc: 0.425 Test Loss: 1.200 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.009354591369629
Epoch: 13, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.143 Vali Acc: 0.550 Test Loss: 1.143 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 14 cost time: 1.1022861003875732
Epoch: 14, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.108 Vali Acc: 0.525 Test Loss: 1.108 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0504233837127686
Epoch: 15, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.067 Vali Acc: 0.575 Test Loss: 1.067 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.9571309089660645
Epoch: 16, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.057 Vali Acc: 0.475 Test Loss: 1.057 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1822826862335205
Epoch: 17, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.045 Vali Acc: 0.475 Test Loss: 1.045 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3900032043457031
Epoch: 18, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.0218415260314941
Epoch: 19, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.898 Vali Acc: 0.675 Test Loss: 0.898 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3271307945251465
Epoch: 20, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.844 Vali Acc: 0.650 Test Loss: 0.844 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5386402606964111
Epoch: 21, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.5533955097198486
Epoch: 22, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.8758289813995361
Epoch: 23, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.043053150177002
Epoch: 24, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.451979160308838
Epoch: 25, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.073035478591919
Epoch: 26, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.2853331565856934
Epoch: 27, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.086815357208252
Epoch: 28, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1475045680999756
Epoch: 29, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.1043901443481445
Epoch: 30, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.9169530868530273
Epoch: 31, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0672023296356201
Epoch: 32, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 1.1115295886993408
Epoch: 33, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 34 cost time: 0.9734511375427246
Epoch: 34, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1046645641326904
Epoch: 35, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 36 cost time: 1.3647661209106445
Epoch: 36, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2617113590240479
Epoch: 37, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.9040939807891846
Epoch: 38, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0137367248535156
Epoch: 39, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1995174884796143
Epoch: 40, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0701661109924316
Epoch: 41, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 42 cost time: 1.1689162254333496
Epoch: 42, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1651742458343506
Epoch: 43, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.143784523010254
Epoch: 44, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.354590892791748
Epoch: 45, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0045528411865234
Epoch: 46, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9743638038635254
Epoch: 47, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0373435020446777
Epoch: 48, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 1.1157901287078857
Epoch: 49, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 1.1275458335876465
Epoch: 50, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1679422855377197
Epoch: 51, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.060865879058838
Epoch: 52, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.0937798023223877
Epoch: 53, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2293670177459717
Epoch: 54, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2392899990081787
Epoch: 55, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.524134635925293
Epoch: 56, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0478808879852295
Epoch: 57, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2409653663635254
Epoch: 58, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9544105529785156
Epoch: 59, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 1.0013487339019775
Epoch: 60, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 61 cost time: 1.0814833641052246
Epoch: 61, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2174925804138184
Epoch: 62, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1080245971679688
Epoch: 63, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0472009181976318
Epoch: 64, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.2212226390838623
Epoch: 65, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.2025346755981445
Epoch: 66, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.1856446266174316
Epoch: 67, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.956885814666748
Epoch: 68, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.4590325355529785
Epoch: 69, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.0262055397033691
Epoch: 70, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 716148
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3278377056121826
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.551 Vali Acc: 0.250 Test Loss: 1.551 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.9779872894287109
Epoch: 2, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.482 Vali Acc: 0.250 Test Loss: 1.482 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.3194546699523926
Epoch: 3, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
Validation loss decreased (-0.249985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.0079011917114258
Epoch: 4, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.374 Vali Acc: 0.350 Test Loss: 1.374 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4480645656585693
Epoch: 5, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.0128931999206543
Epoch: 6, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.308 Vali Acc: 0.250 Test Loss: 1.308 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.387920618057251
Epoch: 7, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.288 Vali Acc: 0.325 Test Loss: 1.288 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2186362743377686
Epoch: 8, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.1057982444763184
Epoch: 9, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8473918437957764
Epoch: 10, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0689048767089844
Epoch: 11, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.254 Vali Acc: 0.525 Test Loss: 1.254 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 1.0486807823181152
Epoch: 12, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.232 Vali Acc: 0.450 Test Loss: 1.232 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4401040077209473
Epoch: 13, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2630643844604492
Epoch: 14, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.0059692859649658
Epoch: 15, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.088047742843628
Epoch: 16, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.029 Vali Acc: 0.550 Test Loss: 1.029 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.171787977218628
Epoch: 17, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.998 Vali Acc: 0.550 Test Loss: 0.998 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4223806858062744
Epoch: 18, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 1.2139921188354492
Epoch: 19, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 1.0774610042572021
Epoch: 20, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2105598449707031
Epoch: 21, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 1.1314671039581299
Epoch: 22, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.1823747158050537
Epoch: 23, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 1.3967158794403076
Epoch: 24, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1086313724517822
Epoch: 25, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 1.2950775623321533
Epoch: 26, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.197810411453247
Epoch: 27, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.631 Vali Acc: 0.925 Test Loss: 0.631 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 1.0171163082122803
Epoch: 28, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0702824592590332
Epoch: 29, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.568 Vali Acc: 0.925 Test Loss: 0.568 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.8403937816619873
Epoch: 30, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.942633867263794
Epoch: 31, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.8833885192871094
Epoch: 32, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 1.1385414600372314
Epoch: 33, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9822406768798828
Epoch: 34, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1535348892211914
Epoch: 35, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0205433368682861
Epoch: 36, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2329821586608887
Epoch: 37, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9669108390808105
Epoch: 38, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0906877517700195
Epoch: 39, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3932030200958252
Epoch: 40, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.1105811595916748
Epoch: 41, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0123240947723389
Epoch: 42, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.159367322921753
Epoch: 43, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1427452564239502
Epoch: 44, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0202162265777588
Epoch: 45, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.097672462463379
Epoch: 46, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1354799270629883
Epoch: 47, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9554791450500488
Epoch: 48, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2896089553833008
Epoch: 49, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 1.0244851112365723
Epoch: 50, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9460234642028809
Epoch: 51, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1422011852264404
Epoch: 52, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1353933811187744
Epoch: 53, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9434719085693359
Epoch: 54, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.5400822162628174
Epoch: 55, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2508037090301514
Epoch: 56, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9587016105651855
Epoch: 57, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.957061767578125
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 1.0862197875976562
Epoch: 59, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 1.040539026260376
Epoch: 60, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9559214115142822
Epoch: 61, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0566272735595703
Epoch: 62, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.3303041458129883
Epoch: 63, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.138232946395874
Epoch: 64, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.2713427543640137
Epoch: 65, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.238835334777832
Epoch: 66, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.2736830711364746
Epoch: 67, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.1278934478759766
Epoch: 68, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.144646406173706
Epoch: 69, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 70 cost time: 1.1608586311340332
Epoch: 70, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 71 cost time: 1.0452890396118164
Epoch: 71, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4914522171020508
Epoch: 72, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.8601229190826416
Epoch: 73, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0030324459075928
Epoch: 74, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.0522441864013672
Epoch: 75, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.2099025249481201
Epoch: 76, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.1248114109039307
Epoch: 77, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.0764844417572021
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.1129722595214844
Epoch: 79, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.0856144428253174
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 603828
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.045502185821533
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2510628700256348
Epoch: 2, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.9206178188323975
Epoch: 3, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.1957263946533203
Epoch: 4, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1951572895050049
Epoch: 5, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.343 Vali Acc: 0.325 Test Loss: 1.343 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0850896835327148
Epoch: 6, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.9671988487243652
Epoch: 7, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.290 Vali Acc: 0.475 Test Loss: 1.290 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.9378988742828369
Epoch: 8, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.251 Vali Acc: 0.625 Test Loss: 1.251 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.9383716583251953
Epoch: 9, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.210 Vali Acc: 0.575 Test Loss: 1.210 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9698019027709961
Epoch: 10, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 1.0417394638061523
Epoch: 11, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.135 Vali Acc: 0.700 Test Loss: 1.135 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.9662928581237793
Epoch: 12, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.105 Vali Acc: 0.775 Test Loss: 1.105 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 13 cost time: 1.1197090148925781
Epoch: 13, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.079 Vali Acc: 0.800 Test Loss: 1.079 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799989).  Saving model ...
Epoch: 14 cost time: 1.0196549892425537
Epoch: 14, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.193551778793335
Epoch: 15, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.999 Vali Acc: 0.625 Test Loss: 0.999 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.01535964012146
Epoch: 16, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.942 Vali Acc: 0.800 Test Loss: 0.942 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.958228588104248
Epoch: 17, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.075282096862793
Epoch: 18, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.837 Vali Acc: 0.825 Test Loss: 0.837 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.9493575096130371
Epoch: 19, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 1.0308291912078857
Epoch: 20, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.8234884738922119
Epoch: 21, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9992835521697998
Epoch: 22, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3061747550964355
Epoch: 23, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.8423750400543213
Epoch: 24, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0201237201690674
Epoch: 25, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.9369935989379883
Epoch: 26, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.985220193862915
Epoch: 27, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9469344615936279
Epoch: 28, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 1.1835224628448486
Epoch: 29, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.9153885841369629
Epoch: 30, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 0.935748815536499
Epoch: 31, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 1.4072513580322266
Epoch: 32, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.092872142791748
Epoch: 33, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.174912929534912
Epoch: 34, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1344845294952393
Epoch: 35, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 1.2280597686767578
Epoch: 36, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 1.031738042831421
Epoch: 37, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 0.8934276103973389
Epoch: 38, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1446433067321777
Epoch: 39, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9628622531890869
Epoch: 40, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.247 Vali Acc: 0.875 Test Loss: 0.247 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2871720790863037
Epoch: 41, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 42 cost time: 1.0450074672698975
Epoch: 42, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.239 Vali Acc: 0.850 Test Loss: 0.239 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3106448650360107
Epoch: 43, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.237 Vali Acc: 0.850 Test Loss: 0.237 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5271730422973633
Epoch: 44, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
Validation loss decreased (-0.899998 --> -0.924998).  Saving model ...
Epoch: 45 cost time: 1.3369989395141602
Epoch: 45, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 1.0727529525756836
Epoch: 46, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.93292236328125
Epoch: 47, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9854614734649658
Epoch: 48, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.9727363586425781
Epoch: 49, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.043163776397705
Epoch: 50, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9541711807250977
Epoch: 51, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9647235870361328
Epoch: 52, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1763803958892822
Epoch: 53, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.023416519165039
Epoch: 54, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.253 Vali Acc: 0.875 Test Loss: 0.253 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.989722490310669
Epoch: 55, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.1253376007080078
Epoch: 56, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.1141517162322998
Epoch: 57, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.925 Test Loss: 0.209 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.0983467102050781
Epoch: 58, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 602740
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.887249708175659
Epoch: 1, Steps: 3 | Train Loss: 1.631 Vali Loss: 1.527 Vali Acc: 0.250 Test Loss: 1.527 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.0720577239990234
Epoch: 2, Steps: 3 | Train Loss: 1.566 Vali Loss: 1.450 Vali Acc: 0.275 Test Loss: 1.450 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.0007061958312988
Epoch: 3, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.374 Vali Acc: 0.250 Test Loss: 1.374 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7261691093444824
Epoch: 4, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.322 Vali Acc: 0.325 Test Loss: 1.322 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 1.0212650299072266
Epoch: 5, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.313 Vali Acc: 0.300 Test Loss: 1.313 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8748836517333984
Epoch: 6, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.301 Vali Acc: 0.275 Test Loss: 1.301 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0168640613555908
Epoch: 7, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.287 Vali Acc: 0.300 Test Loss: 1.287 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1289012432098389
Epoch: 8, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.259 Vali Acc: 0.300 Test Loss: 1.259 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.001589059829712
Epoch: 9, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.229 Vali Acc: 0.450 Test Loss: 1.229 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.0349993705749512
Epoch: 10, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.9454004764556885
Epoch: 11, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.8330390453338623
Epoch: 12, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.9086673259735107
Epoch: 13, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.002945899963379
Epoch: 14, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.0758392810821533
Epoch: 15, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.014 Vali Acc: 0.550 Test Loss: 1.014 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0830166339874268
Epoch: 16, Steps: 3 | Train Loss: 0.934 Vali Loss: 0.967 Vali Acc: 0.650 Test Loss: 0.967 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 0.8773531913757324
Epoch: 17, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 1.0338890552520752
Epoch: 18, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.884 Vali Acc: 0.650 Test Loss: 0.884 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0117511749267578
Epoch: 19, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 0.9805984497070312
Epoch: 20, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.9149565696716309
Epoch: 21, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.129408836364746
Epoch: 22, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.2712664604187012
Epoch: 23, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.679 Vali Acc: 0.675 Test Loss: 0.679 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9916853904724121
Epoch: 24, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.646 Vali Acc: 0.650 Test Loss: 0.646 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9405374526977539
Epoch: 25, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.103421926498413
Epoch: 26, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1048264503479004
Epoch: 27, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.9810335636138916
Epoch: 28, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.508 Vali Acc: 0.775 Test Loss: 0.508 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1121344566345215
Epoch: 29, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.9025838375091553
Epoch: 30, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 31 cost time: 1.0716934204101562
Epoch: 31, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.8445024490356445
Epoch: 32, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.9502236843109131
Epoch: 33, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.2653887271881104
Epoch: 34, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.9484102725982666
Epoch: 35, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.0724096298217773
Epoch: 36, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.940108060836792
Epoch: 37, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0708768367767334
Epoch: 38, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.211435079574585
Epoch: 39, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0427470207214355
Epoch: 40, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0594820976257324
Epoch: 41, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1097099781036377
Epoch: 42, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0125727653503418
Epoch: 43, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.048424482345581
Epoch: 44, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.908327579498291
Epoch: 45, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9186837673187256
Epoch: 46, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0934996604919434
Epoch: 47, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.845104455947876
Epoch: 48, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1421689987182617
Epoch: 49, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.871943473815918
Epoch: 50, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1217198371887207
Epoch: 51, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 0.9303696155548096
Epoch: 52, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.790886640548706
Epoch: 53, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1050519943237305
Epoch: 54, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.798647403717041
Epoch: 55, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8171672821044922
Epoch: 56, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8376290798187256
Epoch: 57, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8396828174591064
Epoch: 58, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8920032978057861
Epoch: 59, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0022783279418945
Epoch: 60, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.8178277015686035
Epoch: 61, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 601652
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6796698570251465
Epoch: 1, Steps: 3 | Train Loss: 1.584 Vali Loss: 1.624 Vali Acc: 0.325 Test Loss: 1.624 Test Acc: 0.325
Validation loss decreased (inf --> -0.324984).  Saving model ...
Epoch: 2 cost time: 0.8142812252044678
Epoch: 2, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.564 Vali Acc: 0.300 Test Loss: 1.564 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8975794315338135
Epoch: 3, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.506 Vali Acc: 0.275 Test Loss: 1.506 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9489781856536865
Epoch: 4, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.449 Vali Acc: 0.325 Test Loss: 1.449 Test Acc: 0.325
Validation loss decreased (-0.324984 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.9043805599212646
Epoch: 5, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.400 Vali Acc: 0.375 Test Loss: 1.400 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.005115270614624
Epoch: 6, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.367 Vali Acc: 0.325 Test Loss: 1.367 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0634310245513916
Epoch: 7, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.119616985321045
Epoch: 8, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.340 Vali Acc: 0.475 Test Loss: 1.340 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.0698184967041016
Epoch: 9, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.343 Vali Acc: 0.550 Test Loss: 1.343 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 0.7921383380889893
Epoch: 10, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.331 Vali Acc: 0.550 Test Loss: 1.331 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 1.2561185359954834
Epoch: 11, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.295 Vali Acc: 0.550 Test Loss: 1.295 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 12 cost time: 1.320814847946167
Epoch: 12, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.239 Vali Acc: 0.625 Test Loss: 1.239 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 1.0389394760131836
Epoch: 13, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3606064319610596
Epoch: 14, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.155 Vali Acc: 0.575 Test Loss: 1.155 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.217928171157837
Epoch: 15, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.943232536315918
Epoch: 16, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.072 Vali Acc: 0.725 Test Loss: 1.072 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 17 cost time: 0.9396085739135742
Epoch: 17, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.038 Vali Acc: 0.775 Test Loss: 1.038 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 0.8080887794494629
Epoch: 18, Steps: 3 | Train Loss: 0.752 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9907677173614502
Epoch: 19, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 1.053955078125
Epoch: 20, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.7860734462738037
Epoch: 21, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.853 Vali Acc: 0.825 Test Loss: 0.853 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.8026406764984131
Epoch: 22, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.807 Vali Acc: 0.775 Test Loss: 0.807 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8220319747924805
Epoch: 23, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.354724645614624
Epoch: 24, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0152451992034912
Epoch: 25, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.729 Vali Acc: 0.825 Test Loss: 0.729 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 26 cost time: 1.1907587051391602
Epoch: 26, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.695 Vali Acc: 0.825 Test Loss: 0.695 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 1.030728816986084
Epoch: 27, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 1.2628278732299805
Epoch: 28, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 29 cost time: 0.9876859188079834
Epoch: 29, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.1828174591064453
Epoch: 30, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.1546001434326172
Epoch: 31, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0324842929840088
Epoch: 32, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 1.2076694965362549
Epoch: 33, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 1.2395155429840088
Epoch: 34, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 1.189460039138794
Epoch: 35, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 36 cost time: 1.1328823566436768
Epoch: 36, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 37 cost time: 1.2130911350250244
Epoch: 37, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 38 cost time: 1.2707850933074951
Epoch: 38, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.283219575881958
Epoch: 39, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1736009120941162
Epoch: 40, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4770450592041016
Epoch: 41, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0737617015838623
Epoch: 42, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0966885089874268
Epoch: 43, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.6301374435424805
Epoch: 44, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.276634693145752
Epoch: 45, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.988048791885376
Epoch: 46, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9664161205291748
Epoch: 47, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 600564
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7434911727905273
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.431 Vali Acc: 0.325 Test Loss: 1.431 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.9979312419891357
Epoch: 2, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.411 Vali Acc: 0.325 Test Loss: 1.411 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.902416467666626
Epoch: 3, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.392 Vali Acc: 0.350 Test Loss: 1.392 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.9863994121551514
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.389 Vali Acc: 0.225 Test Loss: 1.389 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0299029350280762
Epoch: 5, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.394 Vali Acc: 0.500 Test Loss: 1.394 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.0547051429748535
Epoch: 6, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.384 Vali Acc: 0.425 Test Loss: 1.384 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9607131481170654
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.365 Vali Acc: 0.450 Test Loss: 1.365 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9436583518981934
Epoch: 8, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8945612907409668
Epoch: 9, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.277 Vali Acc: 0.525 Test Loss: 1.277 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.9478800296783447
Epoch: 10, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.240 Vali Acc: 0.375 Test Loss: 1.240 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9153668880462646
Epoch: 11, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.208 Vali Acc: 0.450 Test Loss: 1.208 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1073393821716309
Epoch: 12, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5371367931365967
Epoch: 13, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.185 Vali Acc: 0.525 Test Loss: 1.185 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.0036332607269287
Epoch: 14, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674988).  Saving model ...
Epoch: 15 cost time: 1.0393235683441162
Epoch: 15, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 1.0073957443237305
Epoch: 16, Steps: 3 | Train Loss: 0.862 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.7160484790802002
Epoch: 17, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.9464995861053467
Epoch: 18, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0392942428588867
Epoch: 19, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.912 Vali Acc: 0.800 Test Loss: 0.912 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 1.1658556461334229
Epoch: 20, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.866 Vali Acc: 0.775 Test Loss: 0.866 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9744009971618652
Epoch: 21, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 0.7873566150665283
Epoch: 22, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.776 Vali Acc: 0.850 Test Loss: 0.776 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 0.7822525501251221
Epoch: 23, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9101071357727051
Epoch: 24, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.8305678367614746
Epoch: 25, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 0.7588531970977783
Epoch: 26, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.663 Vali Acc: 0.875 Test Loss: 0.663 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 1.027116298675537
Epoch: 27, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.9010367393493652
Epoch: 28, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.9669468402862549
Epoch: 29, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0522534847259521
Epoch: 30, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8027811050415039
Epoch: 31, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1914238929748535
Epoch: 32, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1206700801849365
Epoch: 33, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9844386577606201
Epoch: 34, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9945735931396484
Epoch: 35, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.604 Vali Acc: 0.825 Test Loss: 0.604 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8383169174194336
Epoch: 36, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9613189697265625
Epoch: 37, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9682338237762451
Epoch: 38, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 595380
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1793997287750244
Epoch: 1, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.372 Vali Acc: 0.275 Test Loss: 1.372 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8994593620300293
Epoch: 2, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.344 Vali Acc: 0.250 Test Loss: 1.344 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.14473295211792
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.322 Vali Acc: 0.200 Test Loss: 1.322 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0361640453338623
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.7493913173675537
Epoch: 5, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.347 Vali Acc: 0.425 Test Loss: 1.347 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.8324966430664062
Epoch: 6, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8706271648406982
Epoch: 7, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.358 Vali Acc: 0.425 Test Loss: 1.358 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9115667343139648
Epoch: 8, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.319 Vali Acc: 0.450 Test Loss: 1.319 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.8680503368377686
Epoch: 9, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.8985862731933594
Epoch: 10, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.194 Vali Acc: 0.600 Test Loss: 1.194 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.9509291648864746
Epoch: 11, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.132 Vali Acc: 0.575 Test Loss: 1.132 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9889156818389893
Epoch: 12, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.8199951648712158
Epoch: 13, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.8058786392211914
Epoch: 14, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 0.9278345108032227
Epoch: 15, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.790001392364502
Epoch: 16, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.007356882095337
Epoch: 17, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8278377056121826
Epoch: 18, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.849 Vali Acc: 0.825 Test Loss: 0.849 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.8556339740753174
Epoch: 19, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9687237739562988
Epoch: 20, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.939467191696167
Epoch: 21, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.203932285308838
Epoch: 22, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 0.8577437400817871
Epoch: 23, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 1.031141757965088
Epoch: 24, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9806790351867676
Epoch: 25, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.798769474029541
Epoch: 26, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.0283572673797607
Epoch: 27, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.9121074676513672
Epoch: 28, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0673325061798096
Epoch: 29, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.41182279586792
Epoch: 30, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.985316276550293
Epoch: 31, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.8727724552154541
Epoch: 32, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7544794082641602
Epoch: 33, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9441192150115967
Epoch: 34, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.826711893081665
Epoch: 35, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8114166259765625
Epoch: 36, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.0621347427368164
Epoch: 37, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.9904036521911621
Epoch: 38, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.869774341583252
Epoch: 39, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.061445951461792
Epoch: 40, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.8849935531616211
Epoch: 41, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 1.3708202838897705
Epoch: 42, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.8710877895355225
Epoch: 43, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.9248135089874268
Epoch: 44, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0016393661499023
Epoch: 45, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1825988292694092
Epoch: 46, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9964206218719482
Epoch: 47, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0073113441467285
Epoch: 48, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8603966236114502
Epoch: 49, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8786818981170654
Epoch: 50, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0617139339447021
Epoch: 51, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.2236506938934326
Epoch: 52, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.9683887958526611
Epoch: 53, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 594836
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.753659725189209
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.483 Vali Acc: 0.300 Test Loss: 1.483 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.8691599369049072
Epoch: 2, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.451 Vali Acc: 0.325 Test Loss: 1.451 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.8781278133392334
Epoch: 3, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.419 Vali Acc: 0.325 Test Loss: 1.419 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.9079897403717041
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.9328982830047607
Epoch: 5, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.358 Vali Acc: 0.425 Test Loss: 1.358 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.1672148704528809
Epoch: 6, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.332 Vali Acc: 0.450 Test Loss: 1.332 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.9064924716949463
Epoch: 7, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.7752985954284668
Epoch: 8, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.284 Vali Acc: 0.475 Test Loss: 1.284 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7880830764770508
Epoch: 9, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.264 Vali Acc: 0.600 Test Loss: 1.264 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 0.7835345268249512
Epoch: 10, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.241 Vali Acc: 0.600 Test Loss: 1.241 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.8256537914276123
Epoch: 11, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.201 Vali Acc: 0.575 Test Loss: 1.201 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0435686111450195
Epoch: 12, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.102220058441162
Epoch: 13, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.0486392974853516
Epoch: 14, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8323972225189209
Epoch: 15, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.053 Vali Acc: 0.575 Test Loss: 1.053 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8450195789337158
Epoch: 16, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.017 Vali Acc: 0.825 Test Loss: 1.017 Test Acc: 0.825
Validation loss decreased (-0.624989 --> -0.824990).  Saving model ...
Epoch: 17 cost time: 0.8202135562896729
Epoch: 17, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0023455619812012
Epoch: 18, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.013 Vali Acc: 0.550 Test Loss: 1.013 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7928955554962158
Epoch: 19, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.995 Vali Acc: 0.575 Test Loss: 0.995 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9936127662658691
Epoch: 20, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.852947473526001
Epoch: 21, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8254764080047607
Epoch: 22, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9364418983459473
Epoch: 23, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.837 Vali Acc: 0.825 Test Loss: 0.837 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.9212973117828369
Epoch: 24, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.924670934677124
Epoch: 25, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1221928596496582
Epoch: 26, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9771828651428223
Epoch: 27, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 1.1056296825408936
Epoch: 28, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0478150844573975
Epoch: 29, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 0.9980478286743164
Epoch: 30, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 1.2959065437316895
Epoch: 31, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.611 Vali Acc: 0.875 Test Loss: 0.611 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0193324089050293
Epoch: 32, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.131098747253418
Epoch: 33, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.48844313621521
Epoch: 34, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1067743301391602
Epoch: 35, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.18184494972229
Epoch: 36, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9234170913696289
Epoch: 37, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.034656047821045
Epoch: 38, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0077440738677979
Epoch: 39, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2734358310699463
Epoch: 40, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 594292
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1513242721557617
Epoch: 1, Steps: 3 | Train Loss: 1.626 Vali Loss: 1.662 Vali Acc: 0.150 Test Loss: 1.662 Test Acc: 0.150
Validation loss decreased (inf --> -0.149983).  Saving model ...
Epoch: 2 cost time: 0.9046640396118164
Epoch: 2, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.618 Vali Acc: 0.075 Test Loss: 1.618 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.852046012878418
Epoch: 3, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.561 Vali Acc: 0.150 Test Loss: 1.561 Test Acc: 0.150
Validation loss decreased (-0.149983 --> -0.149984).  Saving model ...
Epoch: 4 cost time: 0.974616289138794
Epoch: 4, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.499 Vali Acc: 0.125 Test Loss: 1.499 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.974114179611206
Epoch: 5, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.445 Vali Acc: 0.175 Test Loss: 1.445 Test Acc: 0.175
Validation loss decreased (-0.149984 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 1.0677855014801025
Epoch: 6, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.392 Vali Acc: 0.325 Test Loss: 1.392 Test Acc: 0.325
Validation loss decreased (-0.174986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.9700369834899902
Epoch: 7, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.353 Vali Acc: 0.275 Test Loss: 1.353 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.158367395401001
Epoch: 8, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.318 Vali Acc: 0.250 Test Loss: 1.318 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9653012752532959
Epoch: 9, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.9350316524505615
Epoch: 10, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 1.0141897201538086
Epoch: 11, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 1.04420804977417
Epoch: 12, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.0230422019958496
Epoch: 13, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.203 Vali Acc: 0.525 Test Loss: 1.203 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.3021221160888672
Epoch: 14, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9125571250915527
Epoch: 15, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.135927677154541
Epoch: 16, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 1.0988073348999023
Epoch: 17, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 0.8993711471557617
Epoch: 18, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.064788579940796
Epoch: 19, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.9486982822418213
Epoch: 20, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.966 Vali Acc: 0.650 Test Loss: 0.966 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9817533493041992
Epoch: 21, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.930 Vali Acc: 0.650 Test Loss: 0.930 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9675509929656982
Epoch: 22, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.9518897533416748
Epoch: 23, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.847 Vali Acc: 0.650 Test Loss: 0.847 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.833524227142334
Epoch: 24, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.805 Vali Acc: 0.875 Test Loss: 0.805 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.9875361919403076
Epoch: 25, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0830707550048828
Epoch: 26, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9812071323394775
Epoch: 27, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.729 Vali Acc: 0.900 Test Loss: 0.729 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.7963650226593018
Epoch: 28, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.707 Vali Acc: 0.900 Test Loss: 0.707 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.908322811126709
Epoch: 29, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1074776649475098
Epoch: 30, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9956834316253662
Epoch: 31, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9586234092712402
Epoch: 32, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 33 cost time: 0.9873948097229004
Epoch: 33, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9368815422058105
Epoch: 34, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0775957107543945
Epoch: 35, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9396026134490967
Epoch: 36, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 37 cost time: 0.9774761199951172
Epoch: 37, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8737578392028809
Epoch: 38, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.951892614364624
Epoch: 39, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.194021463394165
Epoch: 40, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.077906847000122
Epoch: 41, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0951850414276123
Epoch: 42, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1110482215881348
Epoch: 43, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1802525520324707
Epoch: 44, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3133022785186768
Epoch: 45, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0827505588531494
Epoch: 46, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 593748
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1319847106933594
Epoch: 1, Steps: 3 | Train Loss: 1.655 Vali Loss: 1.621 Vali Acc: 0.250 Test Loss: 1.621 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 1.0342423915863037
Epoch: 2, Steps: 3 | Train Loss: 1.518 Vali Loss: 1.570 Vali Acc: 0.275 Test Loss: 1.570 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274984).  Saving model ...
Epoch: 3 cost time: 0.8654694557189941
Epoch: 3, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.520 Vali Acc: 0.275 Test Loss: 1.520 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.9056367874145508
Epoch: 4, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.475 Vali Acc: 0.275 Test Loss: 1.475 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 5 cost time: 0.8939733505249023
Epoch: 5, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.0044190883636475
Epoch: 6, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.380 Vali Acc: 0.325 Test Loss: 1.380 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.7413673400878906
Epoch: 7, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.351 Vali Acc: 0.275 Test Loss: 1.351 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8901069164276123
Epoch: 8, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.330 Vali Acc: 0.250 Test Loss: 1.330 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.836209774017334
Epoch: 9, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.313 Vali Acc: 0.475 Test Loss: 1.313 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.9581058025360107
Epoch: 10, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.8307063579559326
Epoch: 11, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.286 Vali Acc: 0.475 Test Loss: 1.286 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9307098388671875
Epoch: 12, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 1.0421924591064453
Epoch: 13, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.7480001449584961
Epoch: 14, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 1.0782036781311035
Epoch: 15, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.915513277053833
Epoch: 16, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.137 Vali Acc: 0.525 Test Loss: 1.137 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9107913970947266
Epoch: 17, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.107 Vali Acc: 0.525 Test Loss: 1.107 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8433117866516113
Epoch: 18, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.091 Vali Acc: 0.525 Test Loss: 1.091 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9282608032226562
Epoch: 19, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 0.8064670562744141
Epoch: 20, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749990).  Saving model ...
Epoch: 21 cost time: 0.8424472808837891
Epoch: 21, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 0.9819974899291992
Epoch: 22, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.8350999355316162
Epoch: 23, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 24 cost time: 0.9598503112792969
Epoch: 24, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 0.8553249835968018
Epoch: 25, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.842 Vali Acc: 0.675 Test Loss: 0.842 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.954815149307251
Epoch: 26, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 0.8692903518676758
Epoch: 27, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 1.0285310745239258
Epoch: 28, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 0.9615962505340576
Epoch: 29, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.718 Vali Acc: 0.825 Test Loss: 0.718 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 0.8785781860351562
Epoch: 30, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.682 Vali Acc: 0.825 Test Loss: 0.682 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 31 cost time: 0.8664126396179199
Epoch: 31, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 32 cost time: 1.346120834350586
Epoch: 32, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8886590003967285
Epoch: 33, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899994).  Saving model ...
Epoch: 34 cost time: 0.8465991020202637
Epoch: 34, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 35 cost time: 0.9802539348602295
Epoch: 35, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.879143476486206
Epoch: 36, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9347236156463623
Epoch: 37, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2072620391845703
Epoch: 38, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8280322551727295
Epoch: 39, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8867108821868896
Epoch: 40, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8459405899047852
Epoch: 41, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1275382041931152
Epoch: 42, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8298869132995605
Epoch: 43, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.214353084564209
Epoch: 44, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 362420
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.57472562789917
Epoch: 1, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.483 Vali Acc: 0.275 Test Loss: 1.483 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.827686071395874
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.442 Vali Acc: 0.275 Test Loss: 1.442 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.9232673645019531
Epoch: 3, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.410 Vali Acc: 0.275 Test Loss: 1.410 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.9035189151763916
Epoch: 4, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 1.0420682430267334
Epoch: 5, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.370 Vali Acc: 0.300 Test Loss: 1.370 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.8765616416931152
Epoch: 6, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.363 Vali Acc: 0.350 Test Loss: 1.363 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.8468201160430908
Epoch: 7, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.8359897136688232
Epoch: 8, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.8620517253875732
Epoch: 9, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.8633530139923096
Epoch: 10, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.0519523620605469
Epoch: 11, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.274 Vali Acc: 0.475 Test Loss: 1.274 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.921133279800415
Epoch: 12, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.258 Vali Acc: 0.450 Test Loss: 1.258 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9652066230773926
Epoch: 13, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8477606773376465
Epoch: 14, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8619134426116943
Epoch: 15, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.9270687103271484
Epoch: 16, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.166 Vali Acc: 0.550 Test Loss: 1.166 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9368150234222412
Epoch: 17, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.139 Vali Acc: 0.550 Test Loss: 1.139 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.114987850189209
Epoch: 18, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 1.399226427078247
Epoch: 19, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.060 Vali Acc: 0.775 Test Loss: 1.060 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774989).  Saving model ...
Epoch: 20 cost time: 0.9967677593231201
Epoch: 20, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.778261661529541
Epoch: 21, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.970 Vali Acc: 0.775 Test Loss: 0.970 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 22 cost time: 0.8653316497802734
Epoch: 22, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.938 Vali Acc: 0.775 Test Loss: 0.938 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 1.0109636783599854
Epoch: 23, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0456273555755615
Epoch: 24, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1361191272735596
Epoch: 25, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.842 Vali Acc: 0.825 Test Loss: 0.842 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.2246716022491455
Epoch: 26, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.799 Vali Acc: 0.825 Test Loss: 0.799 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.9285571575164795
Epoch: 27, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.757 Vali Acc: 0.775 Test Loss: 0.757 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.062450647354126
Epoch: 28, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0297460556030273
Epoch: 29, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9867286682128906
Epoch: 30, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8617630004882812
Epoch: 31, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0098464488983154
Epoch: 32, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3014843463897705
Epoch: 33, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874994).  Saving model ...
Epoch: 34 cost time: 0.9996974468231201
Epoch: 34, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1149821281433105
Epoch: 35, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9879355430603027
Epoch: 36, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8676221370697021
Epoch: 37, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9153866767883301
Epoch: 38, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 1.049670696258545
Epoch: 39, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 1.4093644618988037
Epoch: 40, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 1.1233060359954834
Epoch: 41, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 0.8352415561676025
Epoch: 42, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.8018038272857666
Epoch: 43, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 0.9001681804656982
Epoch: 44, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9325432777404785
Epoch: 45, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 1.114328384399414
Epoch: 46, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 0.8729453086853027
Epoch: 47, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 0.8764574527740479
Epoch: 48, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 1.088759422302246
Epoch: 49, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8207776546478271
Epoch: 50, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 0.9281177520751953
Epoch: 51, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 0.9979386329650879
Epoch: 52, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 0.9192895889282227
Epoch: 53, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 54 cost time: 0.800447940826416
Epoch: 54, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 55 cost time: 0.9069006443023682
Epoch: 55, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8808069229125977
Epoch: 56, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.099029779434204
Epoch: 57, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9118428230285645
Epoch: 58, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7534868717193604
Epoch: 59, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7463195323944092
Epoch: 60, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8071408271789551
Epoch: 61, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.9318780899047852
Epoch: 62, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7868309020996094
Epoch: 63, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.8666880130767822
Epoch: 64, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 361876
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0779922008514404
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.0646626949310303
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.386 Vali Acc: 0.350 Test Loss: 1.386 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.32716965675354
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.382 Vali Acc: 0.275 Test Loss: 1.382 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4159579277038574
Epoch: 4, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.385 Vali Acc: 0.175 Test Loss: 1.385 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.966219425201416
Epoch: 5, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.395 Vali Acc: 0.350 Test Loss: 1.395 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.255793571472168
Epoch: 6, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.398 Vali Acc: 0.350 Test Loss: 1.398 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9631438255310059
Epoch: 7, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.383 Vali Acc: 0.400 Test Loss: 1.383 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.9441454410552979
Epoch: 8, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 9 cost time: 1.1487598419189453
Epoch: 9, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.339 Vali Acc: 0.250 Test Loss: 1.339 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1948943138122559
Epoch: 10, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.308 Vali Acc: 0.350 Test Loss: 1.308 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.061598777770996
Epoch: 11, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.283 Vali Acc: 0.450 Test Loss: 1.283 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 1.1411263942718506
Epoch: 12, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.255 Vali Acc: 0.425 Test Loss: 1.255 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0141160488128662
Epoch: 13, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.231 Vali Acc: 0.575 Test Loss: 1.231 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.9010217189788818
Epoch: 14, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.213 Vali Acc: 0.550 Test Loss: 1.213 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1447548866271973
Epoch: 15, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0443322658538818
Epoch: 16, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2728512287139893
Epoch: 17, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.139 Vali Acc: 0.450 Test Loss: 1.139 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.095308780670166
Epoch: 18, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2469689846038818
Epoch: 19, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.089 Vali Acc: 0.525 Test Loss: 1.089 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.066556692123413
Epoch: 20, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.043 Vali Acc: 0.525 Test Loss: 1.043 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0780162811279297
Epoch: 21, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.007 Vali Acc: 0.700 Test Loss: 1.007 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.9331891536712646
Epoch: 22, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.9067056179046631
Epoch: 23, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1110191345214844
Epoch: 24, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 1.3479194641113281
Epoch: 25, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.893 Vali Acc: 0.650 Test Loss: 0.893 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8971602916717529
Epoch: 26, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.876 Vali Acc: 0.675 Test Loss: 0.876 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9563937187194824
Epoch: 27, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 1.1871426105499268
Epoch: 28, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.816 Vali Acc: 0.600 Test Loss: 0.816 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2484471797943115
Epoch: 29, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.797 Vali Acc: 0.600 Test Loss: 0.797 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9848349094390869
Epoch: 30, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 0.9562926292419434
Epoch: 31, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.758 Vali Acc: 0.700 Test Loss: 0.758 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0432109832763672
Epoch: 32, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.735 Vali Acc: 0.700 Test Loss: 0.735 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2100603580474854
Epoch: 33, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 34 cost time: 0.8887035846710205
Epoch: 34, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9296455383300781
Epoch: 35, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.894618034362793
Epoch: 36, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8998613357543945
Epoch: 37, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9304423332214355
Epoch: 38, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9391233921051025
Epoch: 39, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.586 Vali Acc: 0.825 Test Loss: 0.586 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8719117641448975
Epoch: 40, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0361979007720947
Epoch: 41, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.177886724472046
Epoch: 42, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9823942184448242
Epoch: 43, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874995).  Saving model ...
Epoch: 44 cost time: 0.8565709590911865
Epoch: 44, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 45 cost time: 1.028395414352417
Epoch: 45, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9626200199127197
Epoch: 46, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1971337795257568
Epoch: 47, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9921431541442871
Epoch: 48, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7976899147033691
Epoch: 49, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 1.0158019065856934
Epoch: 50, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.9607844352722168
Epoch: 51, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 1.161081075668335
Epoch: 52, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 1.105337142944336
Epoch: 53, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.839524507522583
Epoch: 54, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8424174785614014
Epoch: 55, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9042313098907471
Epoch: 56, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 1.0531179904937744
Epoch: 57, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3779041767120361
Epoch: 58, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0073974132537842
Epoch: 59, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9966785907745361
Epoch: 60, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.001577615737915
Epoch: 61, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9745457172393799
Epoch: 62, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.2225852012634277
Epoch: 63, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.139178991317749
Epoch: 64, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.028134822845459
Epoch: 65, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.0722501277923584
Epoch: 66, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 67 cost time: 1.01578688621521
Epoch: 67, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.917391300201416
Epoch: 68, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.453 Vali Acc: 0.825 Test Loss: 0.453 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0042767524719238
Epoch: 69, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.3741886615753174
Epoch: 70, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9769570827484131
Epoch: 71, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.0756700038909912
Epoch: 72, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0569050312042236
Epoch: 73, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.1105906963348389
Epoch: 74, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.9596235752105713
Epoch: 75, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.051891565322876
Epoch: 76, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 77 cost time: 0.991182804107666
Epoch: 77, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 78 cost time: 1.2557339668273926
Epoch: 78, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 79 cost time: 1.3042821884155273
Epoch: 79, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 80 cost time: 1.2159650325775146
Epoch: 80, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.0780138969421387
Epoch: 81, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9765486717224121
Epoch: 82, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.8868403434753418
Epoch: 83, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 84 cost time: 0.9005486965179443
Epoch: 84, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.025313138961792
Epoch: 85, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.082444429397583
Epoch: 86, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.0666680335998535
Epoch: 87, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 88 cost time: 0.9451091289520264
Epoch: 88, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 89 cost time: 0.967017412185669
Epoch: 89, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.0407969951629639
Epoch: 90, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.1293072700500488
Epoch: 91, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.1117630004882812
Epoch: 92, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.0172595977783203
Epoch: 93, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 94 cost time: 1.0080606937408447
Epoch: 94, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 95 cost time: 1.250246524810791
Epoch: 95, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.0120182037353516
Epoch: 96, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.0037939548492432
Epoch: 97, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.9580585956573486
Epoch: 98, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.2744114398956299
Epoch: 99, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 1.0077793598175049
Epoch: 100, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 361332
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.776442766189575
Epoch: 1, Steps: 3 | Train Loss: 1.574 Vali Loss: 1.404 Vali Acc: 0.225 Test Loss: 1.404 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.9045565128326416
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.392 Vali Acc: 0.225 Test Loss: 1.392 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.909475564956665
Epoch: 3, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.036566972732544
Epoch: 4, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.9509897232055664
Epoch: 5, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0397579669952393
Epoch: 6, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.406 Vali Acc: 0.225 Test Loss: 1.406 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1033782958984375
Epoch: 7, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.412 Vali Acc: 0.275 Test Loss: 1.412 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.035008192062378
Epoch: 8, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.9646003246307373
Epoch: 9, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.374 Vali Acc: 0.450 Test Loss: 1.374 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 1.1625292301177979
Epoch: 10, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.009495735168457
Epoch: 11, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8845808506011963
Epoch: 12, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.9015233516693115
Epoch: 13, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.255 Vali Acc: 0.450 Test Loss: 1.255 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8358407020568848
Epoch: 14, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.240 Vali Acc: 0.475 Test Loss: 1.240 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9467024803161621
Epoch: 15, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 1.2412056922912598
Epoch: 16, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.187 Vali Acc: 0.475 Test Loss: 1.187 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0765233039855957
Epoch: 17, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.121790885925293
Epoch: 18, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.9745666980743408
Epoch: 19, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.106 Vali Acc: 0.550 Test Loss: 1.106 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.9181995391845703
Epoch: 20, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.073 Vali Acc: 0.625 Test Loss: 1.073 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.9812204837799072
Epoch: 21, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.9424283504486084
Epoch: 22, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.038 Vali Acc: 0.625 Test Loss: 1.038 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9587838649749756
Epoch: 23, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 0.9333927631378174
Epoch: 24, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0401298999786377
Epoch: 25, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.905 Vali Acc: 0.675 Test Loss: 0.905 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1153225898742676
Epoch: 26, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.857 Vali Acc: 0.675 Test Loss: 0.857 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.98238205909729
Epoch: 27, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.815 Vali Acc: 0.700 Test Loss: 0.815 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2475054264068604
Epoch: 28, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749992).  Saving model ...
Epoch: 29 cost time: 1.1436734199523926
Epoch: 29, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 30 cost time: 0.9023542404174805
Epoch: 30, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9400074481964111
Epoch: 31, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9385149478912354
Epoch: 32, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.025885820388794
Epoch: 33, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.7999012470245361
Epoch: 34, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 35 cost time: 0.9246063232421875
Epoch: 35, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0376274585723877
Epoch: 36, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0755047798156738
Epoch: 37, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.980053186416626
Epoch: 38, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.9709148406982422
Epoch: 39, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9044082164764404
Epoch: 40, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0198640823364258
Epoch: 41, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1930665969848633
Epoch: 42, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1242620944976807
Epoch: 43, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0167076587677002
Epoch: 44, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 45 cost time: 0.8800368309020996
Epoch: 45, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8965399265289307
Epoch: 46, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1551673412322998
Epoch: 47, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8350565433502197
Epoch: 48, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.9298443794250488
Epoch: 49, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.9327800273895264
Epoch: 50, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.915363073348999
Epoch: 51, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0225882530212402
Epoch: 52, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7818090915679932
Epoch: 53, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9500439167022705
Epoch: 54, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2785260677337646
Epoch: 55, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1378355026245117
Epoch: 56, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 57 cost time: 1.0779764652252197
Epoch: 57, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2138206958770752
Epoch: 58, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8971097469329834
Epoch: 59, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.2640674114227295
Epoch: 60, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 1.041884422302246
Epoch: 61, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9585366249084473
Epoch: 62, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1929800510406494
Epoch: 63, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 64 cost time: 1.1385962963104248
Epoch: 64, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 65 cost time: 1.0383496284484863
Epoch: 65, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.099153995513916
Epoch: 66, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.090496301651001
Epoch: 67, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.107487678527832
Epoch: 68, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.6699128150939941
Epoch: 69, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.4238531589508057
Epoch: 70, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 71 cost time: 1.0858731269836426
Epoch: 71, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 72 cost time: 1.3077754974365234
Epoch: 72, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9619221687316895
Epoch: 73, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.3223528861999512
Epoch: 74, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.0661935806274414
Epoch: 75, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.1221954822540283
Epoch: 76, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.0863630771636963
Epoch: 77, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.3251354694366455
Epoch: 78, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.2151360511779785
Epoch: 79, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.1620633602142334
Epoch: 80, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.2005491256713867
Epoch: 81, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 360788
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.870786666870117
Epoch: 1, Steps: 3 | Train Loss: 1.624 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8903660774230957
Epoch: 2, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7343618869781494
Epoch: 3, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.396 Vali Acc: 0.300 Test Loss: 1.396 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.9680676460266113
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.9761385917663574
Epoch: 5, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.357 Vali Acc: 0.425 Test Loss: 1.357 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.9941463470458984
Epoch: 6, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0903348922729492
Epoch: 7, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2921142578125
Epoch: 8, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1641449928283691
Epoch: 9, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.332 Vali Acc: 0.325 Test Loss: 1.332 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2328882217407227
Epoch: 10, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0628602504730225
Epoch: 11, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.277 Vali Acc: 0.475 Test Loss: 1.277 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 1.3888928890228271
Epoch: 12, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.255 Vali Acc: 0.625 Test Loss: 1.255 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624987).  Saving model ...
Epoch: 13 cost time: 1.0473353862762451
Epoch: 13, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.225 Vali Acc: 0.550 Test Loss: 1.225 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2040951251983643
Epoch: 14, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1315207481384277
Epoch: 15, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1418180465698242
Epoch: 16, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2279636859893799
Epoch: 17, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.131 Vali Acc: 0.700 Test Loss: 1.131 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 1.047118902206421
Epoch: 18, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.109 Vali Acc: 0.725 Test Loss: 1.109 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 19 cost time: 1.1733863353729248
Epoch: 19, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1126818656921387
Epoch: 20, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1950953006744385
Epoch: 21, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.013 Vali Acc: 0.750 Test Loss: 1.013 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 1.3754053115844727
Epoch: 22, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 1.0918543338775635
Epoch: 23, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 1.1338012218475342
Epoch: 24, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 25 cost time: 0.8792822360992432
Epoch: 25, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.870 Vali Acc: 0.825 Test Loss: 0.870 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 1.1059577465057373
Epoch: 26, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1502642631530762
Epoch: 27, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 1.2086238861083984
Epoch: 28, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2793591022491455
Epoch: 29, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.796 Vali Acc: 0.725 Test Loss: 0.796 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0811772346496582
Epoch: 30, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 31 cost time: 1.001631736755371
Epoch: 31, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9956188201904297
Epoch: 32, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0488858222961426
Epoch: 33, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 1.2443301677703857
Epoch: 34, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3713736534118652
Epoch: 35, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4452733993530273
Epoch: 36, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3005046844482422
Epoch: 37, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 1.1059434413909912
Epoch: 38, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.9939043521881104
Epoch: 39, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 1.0300066471099854
Epoch: 40, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.8973147869110107
Epoch: 41, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.263258934020996
Epoch: 42, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 1.3308372497558594
Epoch: 43, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 44 cost time: 1.1160526275634766
Epoch: 44, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 45 cost time: 1.2294516563415527
Epoch: 45, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0568702220916748
Epoch: 46, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.118004322052002
Epoch: 47, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1003868579864502
Epoch: 48, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.9773778915405273
Epoch: 49, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1375465393066406
Epoch: 50, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0655052661895752
Epoch: 51, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1115074157714844
Epoch: 52, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 1.3990235328674316
Epoch: 53, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1684887409210205
Epoch: 54, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1918599605560303
Epoch: 55, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 1.0020287036895752
Epoch: 56, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.905463695526123
Epoch: 57, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1208360195159912
Epoch: 58, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.4176344871520996
Epoch: 59, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.3266866207122803
Epoch: 60, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.5313918590545654
Epoch: 61, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.1349339485168457
Epoch: 62, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.275831937789917
Epoch: 63, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.7315828800201416
Epoch: 64, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.3131508827209473
Epoch: 65, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.089266300201416
Epoch: 66, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 245940
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.975325345993042
Epoch: 1, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 1.1291651725769043
Epoch: 2, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.282 Vali Acc: 0.475 Test Loss: 1.282 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.185405969619751
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.277 Vali Acc: 0.475 Test Loss: 1.277 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.0850121974945068
Epoch: 4, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.275 Vali Acc: 0.625 Test Loss: 1.275 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 1.182748794555664
Epoch: 5, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.116089105606079
Epoch: 6, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.264 Vali Acc: 0.450 Test Loss: 1.264 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9881255626678467
Epoch: 7, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9861965179443359
Epoch: 8, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.244 Vali Acc: 0.475 Test Loss: 1.244 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0338654518127441
Epoch: 9, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 1.1552565097808838
Epoch: 10, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.204 Vali Acc: 0.650 Test Loss: 1.204 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 1.101945161819458
Epoch: 11, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.191 Vali Acc: 0.650 Test Loss: 1.191 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 1.366973876953125
Epoch: 12, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0292856693267822
Epoch: 13, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.9746339321136475
Epoch: 14, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.1303081512451172
Epoch: 15, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.2710843086242676
Epoch: 16, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 1.2137353420257568
Epoch: 17, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.048 Vali Acc: 0.725 Test Loss: 1.048 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.9313173294067383
Epoch: 18, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.028 Vali Acc: 0.800 Test Loss: 1.028 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 19 cost time: 1.0147874355316162
Epoch: 19, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.087681531906128
Epoch: 20, Steps: 3 | Train Loss: 0.907 Vali Loss: 0.963 Vali Acc: 0.675 Test Loss: 0.963 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1981532573699951
Epoch: 21, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.927 Vali Acc: 0.775 Test Loss: 0.927 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9928157329559326
Epoch: 22, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.889 Vali Acc: 0.825 Test Loss: 0.889 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 23 cost time: 1.372816801071167
Epoch: 23, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2751729488372803
Epoch: 24, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0478479862213135
Epoch: 25, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0674214363098145
Epoch: 26, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9260001182556152
Epoch: 27, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 0.9876880645751953
Epoch: 28, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.706 Vali Acc: 0.875 Test Loss: 0.706 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 29 cost time: 1.0415668487548828
Epoch: 29, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 1.0383059978485107
Epoch: 30, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0569286346435547
Epoch: 31, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0911498069763184
Epoch: 32, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 0.9746570587158203
Epoch: 33, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 34 cost time: 0.929349422454834
Epoch: 34, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 35 cost time: 1.0681507587432861
Epoch: 35, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.118523120880127
Epoch: 36, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.01651930809021
Epoch: 37, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.035444736480713
Epoch: 38, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9347531795501709
Epoch: 39, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 0.9374692440032959
Epoch: 40, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1821248531341553
Epoch: 41, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0542924404144287
Epoch: 42, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.473 Vali Acc: 0.825 Test Loss: 0.473 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0436127185821533
Epoch: 43, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.9802961349487305
Epoch: 44, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.165611982345581
Epoch: 45, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9135408401489258
Epoch: 46, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.449 Vali Acc: 0.825 Test Loss: 0.449 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2583680152893066
Epoch: 47, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.452 Vali Acc: 0.825 Test Loss: 0.452 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1047227382659912
Epoch: 48, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.035637617111206
Epoch: 49, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 50 cost time: 1.0799586772918701
Epoch: 50, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4230854511260986
Epoch: 51, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1063930988311768
Epoch: 52, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0781888961791992
Epoch: 53, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0746984481811523
Epoch: 54, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.0814456939697266
Epoch: 55, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.3794639110565186
Epoch: 56, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.9769957065582275
Epoch: 57, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.0520946979522705
Epoch: 58, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 0.9330737590789795
Epoch: 59, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 1.1996619701385498
Epoch: 60, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9804320335388184
Epoch: 61, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.226130723953247
Epoch: 62, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.959075927734375
Epoch: 63, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9447901248931885
Epoch: 64, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1138129234313965
Epoch: 65, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0970745086669922
Epoch: 66, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1733043193817139
Epoch: 67, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924995).  Saving model ...
Epoch: 68 cost time: 1.306035041809082
Epoch: 68, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 69 cost time: 1.02911376953125
Epoch: 69, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0676844120025635
Epoch: 70, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 71 cost time: 0.9221761226654053
Epoch: 71, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1935343742370605
Epoch: 72, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.9694662094116211
Epoch: 73, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.2800705432891846
Epoch: 74, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 75 cost time: 1.1557655334472656
Epoch: 75, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9258038997650146
Epoch: 76, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.9467761516571045
Epoch: 77, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.1254596710205078
Epoch: 78, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.9146802425384521
Epoch: 79, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.2592737674713135
Epoch: 80, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.2452356815338135
Epoch: 81, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.2323808670043945
Epoch: 82, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.2189550399780273
Epoch: 83, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.9342806339263916
Epoch: 84, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 245396
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8062214851379395
Epoch: 1, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.445 Vali Acc: 0.125 Test Loss: 1.445 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.8600320816040039
Epoch: 2, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.447 Vali Acc: 0.100 Test Loss: 1.447 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2780590057373047
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.448 Vali Acc: 0.100 Test Loss: 1.448 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0480139255523682
Epoch: 4, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.455 Vali Acc: 0.225 Test Loss: 1.455 Test Acc: 0.225
Validation loss decreased (-0.124986 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 1.0770976543426514
Epoch: 5, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.459 Vali Acc: 0.375 Test Loss: 1.459 Test Acc: 0.375
Validation loss decreased (-0.224985 --> -0.374985).  Saving model ...
Epoch: 6 cost time: 1.0231337547302246
Epoch: 6, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.461 Vali Acc: 0.375 Test Loss: 1.461 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8452129364013672
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.453 Vali Acc: 0.325 Test Loss: 1.453 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9301788806915283
Epoch: 8, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.438 Vali Acc: 0.325 Test Loss: 1.438 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9884109497070312
Epoch: 9, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.428 Vali Acc: 0.350 Test Loss: 1.428 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0899159908294678
Epoch: 10, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.413 Vali Acc: 0.425 Test Loss: 1.413 Test Acc: 0.425
Validation loss decreased (-0.374985 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 1.055276870727539
Epoch: 11, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.391 Vali Acc: 0.400 Test Loss: 1.391 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9389951229095459
Epoch: 12, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.366 Vali Acc: 0.375 Test Loss: 1.366 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0990750789642334
Epoch: 13, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.348 Vali Acc: 0.350 Test Loss: 1.348 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1852178573608398
Epoch: 14, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.332 Vali Acc: 0.350 Test Loss: 1.332 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1172215938568115
Epoch: 15, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9999496936798096
Epoch: 16, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1402077674865723
Epoch: 17, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1736118793487549
Epoch: 18, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.291 Vali Acc: 0.375 Test Loss: 1.291 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0740220546722412
Epoch: 19, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3537399768829346
Epoch: 20, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 0.8813314437866211
Epoch: 21, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 22 cost time: 0.9636058807373047
Epoch: 22, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.218 Vali Acc: 0.425 Test Loss: 1.218 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2069225311279297
Epoch: 23, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.191 Vali Acc: 0.450 Test Loss: 1.191 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 24 cost time: 1.078706979751587
Epoch: 24, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 1.2023348808288574
Epoch: 25, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 1.0626401901245117
Epoch: 26, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.099 Vali Acc: 0.575 Test Loss: 1.099 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0591561794281006
Epoch: 27, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.075 Vali Acc: 0.525 Test Loss: 1.075 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2704436779022217
Epoch: 28, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9857492446899414
Epoch: 29, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.011 Vali Acc: 0.575 Test Loss: 1.011 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0398163795471191
Epoch: 30, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.971 Vali Acc: 0.625 Test Loss: 0.971 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 31 cost time: 0.8731691837310791
Epoch: 31, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699991).  Saving model ...
Epoch: 32 cost time: 0.8999195098876953
Epoch: 32, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.943 Vali Acc: 0.650 Test Loss: 0.943 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9400653839111328
Epoch: 33, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.932 Vali Acc: 0.650 Test Loss: 0.932 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.400285243988037
Epoch: 34, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 1.0156030654907227
Epoch: 35, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 36 cost time: 1.0342152118682861
Epoch: 36, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9619412422180176
Epoch: 37, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.774 Vali Acc: 0.825 Test Loss: 0.774 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 1.4132680892944336
Epoch: 38, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 39 cost time: 1.140427827835083
Epoch: 39, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 40 cost time: 0.8475983142852783
Epoch: 40, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 41 cost time: 0.8187589645385742
Epoch: 41, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 42 cost time: 0.9031579494476318
Epoch: 42, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 43 cost time: 0.9264402389526367
Epoch: 43, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8654396533966064
Epoch: 44, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 1.035731315612793
Epoch: 45, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0974948406219482
Epoch: 46, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 1.004343032836914
Epoch: 47, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3506057262420654
Epoch: 48, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0099797248840332
Epoch: 49, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9215612411499023
Epoch: 50, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.9158203601837158
Epoch: 51, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 1.039459228515625
Epoch: 52, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 1.1223397254943848
Epoch: 53, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8725340366363525
Epoch: 54, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 55 cost time: 0.8400890827178955
Epoch: 55, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 56 cost time: 0.9248595237731934
Epoch: 56, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8604352474212646
Epoch: 57, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9675464630126953
Epoch: 58, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9853785037994385
Epoch: 59, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9446418285369873
Epoch: 60, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 61 cost time: 0.785853385925293
Epoch: 61, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9202370643615723
Epoch: 62, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0200788974761963
Epoch: 63, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9356863498687744
Epoch: 64, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8550472259521484
Epoch: 65, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9700040817260742
Epoch: 66, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.9366147518157959
Epoch: 67, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.838080644607544
Epoch: 68, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.9440646171569824
Epoch: 69, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.851219892501831
Epoch: 70, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 244852
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.718294620513916
Epoch: 1, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.517 Vali Acc: 0.325 Test Loss: 1.517 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.8848140239715576
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.493 Vali Acc: 0.325 Test Loss: 1.493 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 1.1180939674377441
Epoch: 3, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.471 Vali Acc: 0.350 Test Loss: 1.471 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.8905997276306152
Epoch: 4, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.448 Vali Acc: 0.350 Test Loss: 1.448 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.9507129192352295
Epoch: 5, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.431 Vali Acc: 0.275 Test Loss: 1.431 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8953161239624023
Epoch: 6, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.426 Vali Acc: 0.325 Test Loss: 1.426 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.193434715270996
Epoch: 7, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.421 Vali Acc: 0.325 Test Loss: 1.421 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0578854084014893
Epoch: 8, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.410 Vali Acc: 0.325 Test Loss: 1.410 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0915858745574951
Epoch: 9, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.397 Vali Acc: 0.300 Test Loss: 1.397 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9928786754608154
Epoch: 10, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.386 Vali Acc: 0.350 Test Loss: 1.386 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 11 cost time: 0.9083409309387207
Epoch: 11, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.099067211151123
Epoch: 12, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9954450130462646
Epoch: 13, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.310 Vali Acc: 0.425 Test Loss: 1.310 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 1.0643863677978516
Epoch: 14, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.280 Vali Acc: 0.575 Test Loss: 1.280 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574987).  Saving model ...
Epoch: 15 cost time: 1.0862648487091064
Epoch: 15, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.254 Vali Acc: 0.575 Test Loss: 1.254 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 16 cost time: 0.8544454574584961
Epoch: 16, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.226 Vali Acc: 0.625 Test Loss: 1.226 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624988).  Saving model ...
Epoch: 17 cost time: 0.9288175106048584
Epoch: 17, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9865705966949463
Epoch: 18, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.179 Vali Acc: 0.450 Test Loss: 1.179 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1395726203918457
Epoch: 19, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.153 Vali Acc: 0.475 Test Loss: 1.153 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9158477783203125
Epoch: 20, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1138279438018799
Epoch: 21, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.093 Vali Acc: 0.525 Test Loss: 1.093 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8851196765899658
Epoch: 22, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.069 Vali Acc: 0.550 Test Loss: 1.069 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8490121364593506
Epoch: 23, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.862776517868042
Epoch: 24, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8590297698974609
Epoch: 25, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.970 Vali Acc: 0.650 Test Loss: 0.970 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 0.99267578125
Epoch: 26, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 0.8495829105377197
Epoch: 27, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.9967143535614014
Epoch: 28, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 29 cost time: 0.7930681705474854
Epoch: 29, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 0.8859703540802002
Epoch: 30, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 31 cost time: 0.8095529079437256
Epoch: 31, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 32 cost time: 0.8934857845306396
Epoch: 32, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 33 cost time: 0.942263126373291
Epoch: 33, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 1.0243875980377197
Epoch: 34, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.06313157081604
Epoch: 35, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.7877914905548096
Epoch: 36, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0487866401672363
Epoch: 37, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1409752368927002
Epoch: 38, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.8963336944580078
Epoch: 39, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.7724852561950684
Epoch: 40, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.9787018299102783
Epoch: 41, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8710689544677734
Epoch: 42, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2008671760559082
Epoch: 43, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8893492221832275
Epoch: 44, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.860886812210083
Epoch: 45, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0557184219360352
Epoch: 46, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7606120109558105
Epoch: 47, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.847463846206665
Epoch: 48, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9251008033752441
Epoch: 49, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.953822135925293
Epoch: 50, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 244308
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4723587036132812
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.469 Vali Acc: 0.225 Test Loss: 1.469 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.9647848606109619
Epoch: 2, Steps: 3 | Train Loss: 1.555 Vali Loss: 1.459 Vali Acc: 0.200 Test Loss: 1.459 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9210271835327148
Epoch: 3, Steps: 3 | Train Loss: 1.624 Vali Loss: 1.451 Vali Acc: 0.175 Test Loss: 1.451 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1429970264434814
Epoch: 4, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.444 Vali Acc: 0.200 Test Loss: 1.444 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0090758800506592
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.438 Vali Acc: 0.225 Test Loss: 1.438 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 6 cost time: 1.161344051361084
Epoch: 6, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.436 Vali Acc: 0.200 Test Loss: 1.436 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9695181846618652
Epoch: 7, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.427 Vali Acc: 0.200 Test Loss: 1.427 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8505563735961914
Epoch: 8, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.413 Vali Acc: 0.200 Test Loss: 1.413 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9579966068267822
Epoch: 9, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.397 Vali Acc: 0.200 Test Loss: 1.397 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8480515480041504
Epoch: 10, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.373 Vali Acc: 0.250 Test Loss: 1.373 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 0.7561404705047607
Epoch: 11, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 12 cost time: 0.9701061248779297
Epoch: 12, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.319 Vali Acc: 0.350 Test Loss: 1.319 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 13 cost time: 0.9239411354064941
Epoch: 13, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.302 Vali Acc: 0.350 Test Loss: 1.302 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 14 cost time: 0.8905651569366455
Epoch: 14, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.8541886806488037
Epoch: 15, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.281 Vali Acc: 0.425 Test Loss: 1.281 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 16 cost time: 0.8312420845031738
Epoch: 16, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2258408069610596
Epoch: 17, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.242 Vali Acc: 0.425 Test Loss: 1.242 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 18 cost time: 0.8875579833984375
Epoch: 18, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.236 Vali Acc: 0.425 Test Loss: 1.236 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 19 cost time: 0.9856114387512207
Epoch: 19, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.218 Vali Acc: 0.550 Test Loss: 1.218 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.9470064640045166
Epoch: 20, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.191 Vali Acc: 0.600 Test Loss: 1.191 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.901639461517334
Epoch: 21, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9675412178039551
Epoch: 22, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 1.120121955871582
Epoch: 23, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.102 Vali Acc: 0.575 Test Loss: 1.102 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9559307098388672
Epoch: 24, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.076 Vali Acc: 0.575 Test Loss: 1.076 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1386780738830566
Epoch: 25, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.7574234008789062
Epoch: 26, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.026 Vali Acc: 0.625 Test Loss: 1.026 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.85318922996521
Epoch: 27, Steps: 3 | Train Loss: 0.754 Vali Loss: 0.986 Vali Acc: 0.650 Test Loss: 0.986 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.8839139938354492
Epoch: 28, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.941 Vali Acc: 0.750 Test Loss: 0.941 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 0.9655249118804932
Epoch: 29, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9939174652099609
Epoch: 30, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9793071746826172
Epoch: 31, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9651572704315186
Epoch: 32, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3578102588653564
Epoch: 33, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 34 cost time: 1.1634860038757324
Epoch: 34, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 1.0303936004638672
Epoch: 35, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 36 cost time: 0.9198100566864014
Epoch: 36, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0914404392242432
Epoch: 37, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 38 cost time: 0.8513669967651367
Epoch: 38, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.695 Vali Acc: 0.825 Test Loss: 0.695 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9917733669281006
Epoch: 39, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9400269985198975
Epoch: 40, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 1.006251573562622
Epoch: 41, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.9957332611083984
Epoch: 42, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.8701479434967041
Epoch: 43, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.9533669948577881
Epoch: 44, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 1.061920166015625
Epoch: 45, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 1.0666141510009766
Epoch: 46, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.8195643424987793
Epoch: 47, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 0.8975465297698975
Epoch: 48, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.8915634155273438
Epoch: 49, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.8314647674560547
Epoch: 50, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0385487079620361
Epoch: 51, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0412747859954834
Epoch: 52, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.9881491661071777
Epoch: 53, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0069036483764648
Epoch: 54, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 55 cost time: 0.7585961818695068
Epoch: 55, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 56 cost time: 0.8676767349243164
Epoch: 56, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7720580101013184
Epoch: 57, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7707619667053223
Epoch: 58, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 59 cost time: 0.7866764068603516
Epoch: 59, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.493 Vali Acc: 0.950 Test Loss: 0.493 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 60 cost time: 0.8821849822998047
Epoch: 60, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 61 cost time: 1.004420280456543
Epoch: 61, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 62 cost time: 0.8238570690155029
Epoch: 62, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9244146347045898
Epoch: 63, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8383638858795166
Epoch: 64, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.460 Vali Acc: 0.950 Test Loss: 0.460 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 65 cost time: 0.9127612113952637
Epoch: 65, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8171417713165283
Epoch: 66, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8359253406524658
Epoch: 67, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7919635772705078
Epoch: 68, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.9501285552978516
Epoch: 69, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.9136240482330322
Epoch: 70, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.9317984580993652
Epoch: 71, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.8462197780609131
Epoch: 72, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.9946086406707764
Epoch: 73, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.0398731231689453
Epoch: 74, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 187700
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2035531997680664
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.495 Vali Acc: 0.125 Test Loss: 1.495 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 0.97072434425354
Epoch: 2, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.496 Vali Acc: 0.100 Test Loss: 1.496 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.159019947052002
Epoch: 3, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.491 Vali Acc: 0.100 Test Loss: 1.491 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.856835126876831
Epoch: 4, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.482 Vali Acc: 0.125 Test Loss: 1.482 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124985).  Saving model ...
Epoch: 5 cost time: 1.1687207221984863
Epoch: 5, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.474 Vali Acc: 0.075 Test Loss: 1.474 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1435267925262451
Epoch: 6, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.461 Vali Acc: 0.075 Test Loss: 1.461 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0266995429992676
Epoch: 7, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.455 Vali Acc: 0.075 Test Loss: 1.455 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0520927906036377
Epoch: 8, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.445 Vali Acc: 0.125 Test Loss: 1.445 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124986).  Saving model ...
Epoch: 9 cost time: 1.2695295810699463
Epoch: 9, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.435 Vali Acc: 0.250 Test Loss: 1.435 Test Acc: 0.250
Validation loss decreased (-0.124986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 0.9038703441619873
Epoch: 10, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 1.0190253257751465
Epoch: 11, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.412 Vali Acc: 0.250 Test Loss: 1.412 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9663805961608887
Epoch: 12, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.395 Vali Acc: 0.325 Test Loss: 1.395 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 13 cost time: 0.8758444786071777
Epoch: 13, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 14 cost time: 0.9950263500213623
Epoch: 14, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.357 Vali Acc: 0.400 Test Loss: 1.357 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 15 cost time: 1.0760142803192139
Epoch: 15, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 1.0403430461883545
Epoch: 16, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.309 Vali Acc: 0.450 Test Loss: 1.309 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9385025501251221
Epoch: 17, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.292 Vali Acc: 0.550 Test Loss: 1.292 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 1.1500561237335205
Epoch: 18, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0436758995056152
Epoch: 19, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9205100536346436
Epoch: 20, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.267 Vali Acc: 0.475 Test Loss: 1.267 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.065948724746704
Epoch: 21, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.260 Vali Acc: 0.475 Test Loss: 1.260 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0794212818145752
Epoch: 22, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7423560619354248
Epoch: 23, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3613295555114746
Epoch: 24, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.187 Vali Acc: 0.450 Test Loss: 1.187 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1529455184936523
Epoch: 25, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.160 Vali Acc: 0.425 Test Loss: 1.160 Test Acc: 0.425
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2637608051300049
Epoch: 26, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.129 Vali Acc: 0.450 Test Loss: 1.129 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1711218357086182
Epoch: 27, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.092 Vali Acc: 0.450 Test Loss: 1.092 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.55
model parameter : 187156
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8747425079345703
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.9921045303344727
Epoch: 2, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.303 Vali Acc: 0.450 Test Loss: 1.303 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.8880839347839355
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.301 Vali Acc: 0.350 Test Loss: 1.301 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9115397930145264
Epoch: 4, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.299 Vali Acc: 0.525 Test Loss: 1.299 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.9488606452941895
Epoch: 5, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.294 Vali Acc: 0.525 Test Loss: 1.294 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.9893543720245361
Epoch: 6, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.288 Vali Acc: 0.525 Test Loss: 1.288 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 1.0993094444274902
Epoch: 7, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.280 Vali Acc: 0.525 Test Loss: 1.280 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.8160500526428223
Epoch: 8, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.266 Vali Acc: 0.575 Test Loss: 1.266 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 1.006295919418335
Epoch: 9, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.251 Vali Acc: 0.600 Test Loss: 1.251 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 0.9523434638977051
Epoch: 10, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.235 Vali Acc: 0.625 Test Loss: 1.235 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.949514627456665
Epoch: 11, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.209 Vali Acc: 0.650 Test Loss: 1.209 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.8111858367919922
Epoch: 12, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.192 Vali Acc: 0.650 Test Loss: 1.192 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 0.9404559135437012
Epoch: 13, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9828479290008545
Epoch: 14, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.156 Vali Acc: 0.675 Test Loss: 1.156 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 15 cost time: 0.8859779834747314
Epoch: 15, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.132 Vali Acc: 0.725 Test Loss: 1.132 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 0.9119012355804443
Epoch: 16, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8671035766601562
Epoch: 17, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.085 Vali Acc: 0.700 Test Loss: 1.085 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.986391544342041
Epoch: 18, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.047 Vali Acc: 0.750 Test Loss: 1.047 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.9069123268127441
Epoch: 19, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.020 Vali Acc: 0.800 Test Loss: 1.020 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 20 cost time: 0.8907341957092285
Epoch: 20, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.001 Vali Acc: 0.775 Test Loss: 1.001 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.03849458694458
Epoch: 21, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.00260329246521
Epoch: 22, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.054412841796875
Epoch: 23, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9046361446380615
Epoch: 24, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9965500831604004
Epoch: 25, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.983142614364624
Epoch: 26, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9323880672454834
Epoch: 27, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.782 Vali Acc: 0.775 Test Loss: 0.782 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9513900279998779
Epoch: 28, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.029104232788086
Epoch: 29, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.758 Vali Acc: 0.725 Test Loss: 0.758 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 186612
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7351768016815186
Epoch: 1, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.351 Vali Acc: 0.300 Test Loss: 1.351 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9446365833282471
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.336 Vali Acc: 0.300 Test Loss: 1.336 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.8284552097320557
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.326 Vali Acc: 0.250 Test Loss: 1.326 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8633260726928711
Epoch: 4, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.317 Vali Acc: 0.425 Test Loss: 1.317 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.900998592376709
Epoch: 5, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.315 Vali Acc: 0.475 Test Loss: 1.315 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 1.0106542110443115
Epoch: 6, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8218128681182861
Epoch: 7, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.315 Vali Acc: 0.425 Test Loss: 1.315 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.211085319519043
Epoch: 8, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.818519115447998
Epoch: 9, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9746055603027344
Epoch: 10, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8817098140716553
Epoch: 11, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.297 Vali Acc: 0.425 Test Loss: 1.297 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8243029117584229
Epoch: 12, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.268 Vali Acc: 0.450 Test Loss: 1.268 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8636469841003418
Epoch: 13, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.246 Vali Acc: 0.475 Test Loss: 1.246 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.765526294708252
Epoch: 14, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.8854024410247803
Epoch: 15, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.9625449180603027
Epoch: 16, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 17 cost time: 0.8575990200042725
Epoch: 17, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.8996355533599854
Epoch: 18, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.122 Vali Acc: 0.650 Test Loss: 1.122 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.9019379615783691
Epoch: 19, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2030987739562988
Epoch: 20, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.088 Vali Acc: 0.625 Test Loss: 1.088 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9400918483734131
Epoch: 21, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.085 Vali Acc: 0.475 Test Loss: 1.085 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9312038421630859
Epoch: 22, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.069 Vali Acc: 0.425 Test Loss: 1.069 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7690660953521729
Epoch: 23, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.7323944568634033
Epoch: 24, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.016 Vali Acc: 0.625 Test Loss: 1.016 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7907397747039795
Epoch: 25, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.8480958938598633
Epoch: 26, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.944 Vali Acc: 0.675 Test Loss: 0.944 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 27 cost time: 1.1703453063964844
Epoch: 27, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.914787769317627
Epoch: 28, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 0.9611661434173584
Epoch: 29, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.004225254058838
Epoch: 30, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.843 Vali Acc: 0.725 Test Loss: 0.843 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.988152027130127
Epoch: 31, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.822 Vali Acc: 0.725 Test Loss: 0.822 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9389986991882324
Epoch: 32, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.796 Vali Acc: 0.725 Test Loss: 0.796 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.981550931930542
Epoch: 33, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.773 Vali Acc: 0.700 Test Loss: 0.773 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9024159908294678
Epoch: 34, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774993).  Saving model ...
Epoch: 35 cost time: 0.8464043140411377
Epoch: 35, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 0.9662513732910156
Epoch: 36, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 37 cost time: 0.7900893688201904
Epoch: 37, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.672 Vali Acc: 0.775 Test Loss: 0.672 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0841214656829834
Epoch: 38, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.652 Vali Acc: 0.800 Test Loss: 0.652 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 39 cost time: 0.9903554916381836
Epoch: 39, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 40 cost time: 0.7259151935577393
Epoch: 40, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.854947566986084
Epoch: 41, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.610 Vali Acc: 0.825 Test Loss: 0.610 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 42 cost time: 0.8608489036560059
Epoch: 42, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 0.9688520431518555
Epoch: 43, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.950270414352417
Epoch: 44, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.175441026687622
Epoch: 45, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 46 cost time: 0.9154365062713623
Epoch: 46, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 47 cost time: 0.996211051940918
Epoch: 47, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0171375274658203
Epoch: 48, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8935024738311768
Epoch: 49, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.8842511177062988
Epoch: 50, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.8577446937561035
Epoch: 51, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.9734752178192139
Epoch: 52, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7999846935272217
Epoch: 53, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 1.0733048915863037
Epoch: 54, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 1.056105136871338
Epoch: 55, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 1.1077253818511963
Epoch: 56, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 1.0111005306243896
Epoch: 57, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 0.8660702705383301
Epoch: 58, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 1.1483557224273682
Epoch: 59, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.131718635559082
Epoch: 60, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9646692276000977
Epoch: 61, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8539652824401855
Epoch: 62, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0607974529266357
Epoch: 63, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8484582901000977
Epoch: 64, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1880090236663818
Epoch: 65, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.2198596000671387
Epoch: 66, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 0.8939521312713623
Epoch: 67, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 0.9119431972503662
Epoch: 68, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 69 cost time: 0.8768212795257568
Epoch: 69, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.1703684329986572
Epoch: 70, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 71 cost time: 1.0514476299285889
Epoch: 71, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0937750339508057
Epoch: 72, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.9153215885162354
Epoch: 73, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.2073419094085693
Epoch: 74, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.849722146987915
Epoch: 75, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.8555831909179688
Epoch: 76, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.9317266941070557
Epoch: 77, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.0747265815734863
Epoch: 78, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.1025738716125488
Epoch: 79, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.9602835178375244
Epoch: 80, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 186068
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4157841205596924
Epoch: 1, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9832963943481445
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
Validation loss decreased (-0.299986 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 1.059417724609375
Epoch: 3, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.346 Vali Acc: 0.250 Test Loss: 1.346 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9494724273681641
Epoch: 4, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.236 Vali Acc: 0.525 Test Loss: 1.236 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.171492338180542
Epoch: 5, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.088 Vali Acc: 0.625 Test Loss: 1.088 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.9636504650115967
Epoch: 6, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 1.1197762489318848
Epoch: 7, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0074305534362793
Epoch: 8, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.836 Vali Acc: 0.625 Test Loss: 0.836 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0218384265899658
Epoch: 9, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.744 Vali Acc: 0.625 Test Loss: 0.744 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9556951522827148
Epoch: 10, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.687 Vali Acc: 0.650 Test Loss: 0.687 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9147264957427979
Epoch: 11, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.674990 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 0.8745877742767334
Epoch: 12, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.767 Vali Acc: 0.650 Test Loss: 0.767 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8786137104034424
Epoch: 13, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.0730268955230713
Epoch: 14, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.483 Vali Acc: 0.650 Test Loss: 0.483 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.060595989227295
Epoch: 15, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.442 Vali Acc: 0.825 Test Loss: 0.442 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9322452545166016
Epoch: 16, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.9831323623657227
Epoch: 17, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.9351987838745117
Epoch: 18, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9192681312561035
Epoch: 19, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.9839439392089844
Epoch: 20, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.278 Vali Acc: 0.850 Test Loss: 0.278 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0516269207000732
Epoch: 21, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0775690078735352
Epoch: 22, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8834795951843262
Epoch: 23, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.141728401184082
Epoch: 24, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.7950992584228516
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8654398918151855
Epoch: 26, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.8795924186706543
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.067460536956787
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0437195301055908
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0060038566589355
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9253227710723877
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.037194013595581
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0552222728729248
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9351024627685547
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0976982116699219
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.955268144607544
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 7978280
model size : 35.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5019471645355225
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.7709174156188965
Epoch: 2, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.895820140838623
Epoch: 3, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.9225575923919678
Epoch: 4, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
Validation loss decreased (-0.399987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.7968399524688721
Epoch: 5, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.117 Vali Acc: 0.700 Test Loss: 1.117 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.7826831340789795
Epoch: 6, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.097 Vali Acc: 0.525 Test Loss: 1.097 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.198596715927124
Epoch: 7, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8506412506103516
Epoch: 8, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.872 Vali Acc: 0.700 Test Loss: 0.872 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.9596660137176514
Epoch: 9, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 0.9141263961791992
Epoch: 10, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.733 Vali Acc: 0.650 Test Loss: 0.733 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.825598955154419
Epoch: 11, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.681 Vali Acc: 0.600 Test Loss: 0.681 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8130354881286621
Epoch: 12, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.9411361217498779
Epoch: 13, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.8487920761108398
Epoch: 14, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.019047498703003
Epoch: 15, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8353121280670166
Epoch: 16, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0991275310516357
Epoch: 17, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8649306297302246
Epoch: 18, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.2781779766082764
Epoch: 19, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.066110610961914
Epoch: 20, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.9961347579956055
Epoch: 21, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9185433387756348
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9402937889099121
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8598558902740479
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0971908569335938
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8446855545043945
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1500589847564697
Epoch: 27, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9186434745788574
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9115033149719238
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.062220573425293
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 7974696
model size : 35.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.654648780822754
Epoch: 1, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.505 Vali Acc: 0.175 Test Loss: 1.505 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.9103777408599854
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.419 Vali Acc: 0.325 Test Loss: 1.419 Test Acc: 0.325
Validation loss decreased (-0.174985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.8019444942474365
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.318 Vali Acc: 0.150 Test Loss: 1.318 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8610343933105469
Epoch: 4, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.7921392917633057
Epoch: 5, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.287 Vali Acc: 0.575 Test Loss: 1.287 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.8341500759124756
Epoch: 6, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0730905532836914
Epoch: 7, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.041 Vali Acc: 0.525 Test Loss: 1.041 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9886212348937988
Epoch: 8, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
Validation loss decreased (-0.574987 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.013115406036377
Epoch: 9, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.809 Vali Acc: 0.875 Test Loss: 0.809 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.8622143268585205
Epoch: 10, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.711341142654419
Epoch: 11, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.894 Vali Acc: 0.575 Test Loss: 0.894 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8315479755401611
Epoch: 12, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1391777992248535
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1650266647338867
Epoch: 14, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8767836093902588
Epoch: 15, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.9951326847076416
Epoch: 16, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.467 Vali Acc: 0.725 Test Loss: 0.467 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8919460773468018
Epoch: 17, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.0031633377075195
Epoch: 18, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0103769302368164
Epoch: 19, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.032501459121704
Epoch: 20, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0594403743743896
Epoch: 21, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9557981491088867
Epoch: 22, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9328339099884033
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.437 Vali Acc: 0.825 Test Loss: 0.437 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9703578948974609
Epoch: 24, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0102365016937256
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9783267974853516
Epoch: 26, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8860061168670654
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 1.018338680267334
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8205311298370361
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9260556697845459
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0035195350646973
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9350042343139648
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0788612365722656
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8928115367889404
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9662489891052246
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2470881938934326
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0254812240600586
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 7971112
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8648829460144043
Epoch: 1, Steps: 3 | Train Loss: 1.665 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1936883926391602
Epoch: 2, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7344813346862793
Epoch: 3, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.452 Vali Acc: 0.250 Test Loss: 1.452 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9961814880371094
Epoch: 4, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.307 Vali Acc: 0.250 Test Loss: 1.307 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8988051414489746
Epoch: 5, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.139 Vali Acc: 0.725 Test Loss: 1.139 Test Acc: 0.725
Validation loss decreased (-0.299986 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 1.2144355773925781
Epoch: 6, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.165 Vali Acc: 0.450 Test Loss: 1.165 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1180710792541504
Epoch: 7, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.971 Vali Acc: 0.850 Test Loss: 0.971 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 1.0099780559539795
Epoch: 8, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.958 Vali Acc: 0.525 Test Loss: 0.958 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0046474933624268
Epoch: 9, Steps: 3 | Train Loss: 0.750 Vali Loss: 0.827 Vali Acc: 0.675 Test Loss: 0.827 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9037866592407227
Epoch: 10, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.782 Vali Acc: 0.675 Test Loss: 0.782 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1322216987609863
Epoch: 11, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.793 Vali Acc: 0.700 Test Loss: 0.793 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9199390411376953
Epoch: 12, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.606 Vali Acc: 0.800 Test Loss: 0.606 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8535616397857666
Epoch: 13, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.0316531658172607
Epoch: 14, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 0.9887585639953613
Epoch: 15, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.849996 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.9756338596343994
Epoch: 16, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.654 Vali Acc: 0.600 Test Loss: 0.654 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9543721675872803
Epoch: 17, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9279682636260986
Epoch: 18, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9779822826385498
Epoch: 19, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8573422431945801
Epoch: 20, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.007746934890747
Epoch: 21, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.8037655353546143
Epoch: 22, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8225972652435303
Epoch: 23, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9052393436431885
Epoch: 24, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0042083263397217
Epoch: 25, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0757579803466797
Epoch: 26, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1646361351013184
Epoch: 27, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0655510425567627
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0264158248901367
Epoch: 29, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3172826766967773
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0297043323516846
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 7967528
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6581039428710938
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.311 Vali Acc: 0.275 Test Loss: 1.311 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.940850019454956
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.9429974555969238
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.397 Vali Acc: 0.450 Test Loss: 1.397 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 1.0214219093322754
Epoch: 4, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1108992099761963
Epoch: 5, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.108 Vali Acc: 0.625 Test Loss: 1.108 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.2712292671203613
Epoch: 6, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 1.0613019466400146
Epoch: 7, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.049 Vali Acc: 0.450 Test Loss: 1.049 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0850110054016113
Epoch: 8, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 1.2628569602966309
Epoch: 9, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
Validation loss decreased (-0.724991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.8643288612365723
Epoch: 10, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.764 Vali Acc: 0.650 Test Loss: 0.764 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1739215850830078
Epoch: 11, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.958564281463623
Epoch: 12, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.735 Vali Acc: 0.625 Test Loss: 0.735 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9238975048065186
Epoch: 13, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.625 Vali Acc: 0.700 Test Loss: 0.625 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1872048377990723
Epoch: 14, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.592 Vali Acc: 0.700 Test Loss: 0.592 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8464994430541992
Epoch: 15, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.556 Vali Acc: 0.625 Test Loss: 0.556 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.86966872215271
Epoch: 16, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.067021369934082
Epoch: 17, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.493 Vali Acc: 0.725 Test Loss: 0.493 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8837337493896484
Epoch: 18, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.2060246467590332
Epoch: 19, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.374 Vali Acc: 0.800 Test Loss: 0.374 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9535524845123291
Epoch: 20, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.0809991359710693
Epoch: 21, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.9590244293212891
Epoch: 22, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8140349388122559
Epoch: 23, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9818978309631348
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.8171160221099854
Epoch: 25, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.9293651580810547
Epoch: 26, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0924818515777588
Epoch: 27, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.9734325408935547
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9134378433227539
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2160634994506836
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.9962501525878906
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 32 cost time: 0.8352813720703125
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0628111362457275
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9308149814605713
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9895689487457275
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0079891681671143
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.0987253189086914
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.923163890838623
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1217713356018066
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.8267440795898438
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.020414113998413
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.897019624710083
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8531448841094971
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8945879936218262
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2184250354766846
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1857624053955078
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0284569263458252
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9248149394989014
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9293122291564941
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0659677982330322
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 0.9212954044342041
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9823572635650635
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.971245527267456
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9766955375671387
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9920756816864014
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9397509098052979
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.114591121673584
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.0326268672943115
Epoch: 58, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8699178695678711
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.028123140335083
Epoch: 60, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 6665000
model size : 30.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.151516914367676
Epoch: 1, Steps: 3 | Train Loss: 1.630 Vali Loss: 1.372 Vali Acc: 0.300 Test Loss: 1.372 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9578502178192139
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.333 Vali Acc: 0.425 Test Loss: 1.333 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.8391592502593994
Epoch: 3, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.329 Vali Acc: 0.475 Test Loss: 1.329 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.8341495990753174
Epoch: 4, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.226 Vali Acc: 0.575 Test Loss: 1.226 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.9265031814575195
Epoch: 5, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9287443161010742
Epoch: 6, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 1.0896849632263184
Epoch: 7, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.960 Vali Acc: 0.650 Test Loss: 0.960 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.8271911144256592
Epoch: 8, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.891 Vali Acc: 0.650 Test Loss: 0.891 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 9 cost time: 0.8848006725311279
Epoch: 9, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.649991 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.9870774745941162
Epoch: 10, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.114497423171997
Epoch: 11, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799994).  Saving model ...
Epoch: 12 cost time: 1.225097894668579
Epoch: 12, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.0495996475219727
Epoch: 13, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.670 Vali Acc: 0.650 Test Loss: 0.670 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1920382976531982
Epoch: 14, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8334023952484131
Epoch: 15, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.538 Vali Acc: 0.775 Test Loss: 0.538 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7816228866577148
Epoch: 16, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.484 Vali Acc: 0.675 Test Loss: 0.484 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9973931312561035
Epoch: 17, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.824994 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.7801179885864258
Epoch: 18, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.450 Vali Acc: 0.725 Test Loss: 0.450 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7939298152923584
Epoch: 19, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8567755222320557
Epoch: 20, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0135741233825684
Epoch: 21, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.505 Vali Acc: 0.750 Test Loss: 0.505 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.996758222579956
Epoch: 22, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.635 Vali Acc: 0.700 Test Loss: 0.635 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3734135627746582
Epoch: 23, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.061500072479248
Epoch: 24, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.863 Vali Acc: 0.650 Test Loss: 0.863 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9215085506439209
Epoch: 25, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8718702793121338
Epoch: 26, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8974690437316895
Epoch: 27, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 6661416
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.446370840072632
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.399 Vali Acc: 0.375 Test Loss: 1.399 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.9032025337219238
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.7575905323028564
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.319 Vali Acc: 0.275 Test Loss: 1.319 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8369889259338379
Epoch: 4, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.235 Vali Acc: 0.475 Test Loss: 1.235 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.6907651424407959
Epoch: 5, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.202 Vali Acc: 0.525 Test Loss: 1.202 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.9452483654022217
Epoch: 6, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.161 Vali Acc: 0.450 Test Loss: 1.161 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8148143291473389
Epoch: 7, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 1.0056476593017578
Epoch: 8, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.018601417541504
Epoch: 9, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.863 Vali Acc: 0.725 Test Loss: 0.863 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9500393867492676
Epoch: 10, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 0.8731613159179688
Epoch: 11, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.734 Vali Acc: 0.575 Test Loss: 0.734 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.905933141708374
Epoch: 12, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.749992 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.9061636924743652
Epoch: 13, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.513 Vali Acc: 0.750 Test Loss: 0.513 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7670836448669434
Epoch: 14, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.921675443649292
Epoch: 15, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8560013771057129
Epoch: 16, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.8112130165100098
Epoch: 17, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.9937255382537842
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9218912124633789
Epoch: 19, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.9138672351837158
Epoch: 20, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9511663913726807
Epoch: 21, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.9668228626251221
Epoch: 22, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.059335708618164
Epoch: 23, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9264147281646729
Epoch: 24, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9842231273651123
Epoch: 25, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.084277629852295
Epoch: 26, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1376514434814453
Epoch: 27, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9745991230010986
Epoch: 28, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8560924530029297
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8452136516571045
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0212161540985107
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 6657832
model size : 30.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.001451253890991
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8772134780883789
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.010683536529541
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.337 Vali Acc: 0.200 Test Loss: 1.337 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9236536026000977
Epoch: 4, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.251 Vali Acc: 0.275 Test Loss: 1.251 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.8058407306671143
Epoch: 5, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
Validation loss decreased (-0.274987 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.7353448867797852
Epoch: 6, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.053 Vali Acc: 0.775 Test Loss: 1.053 Test Acc: 0.775
Validation loss decreased (-0.524989 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.9751970767974854
Epoch: 7, Steps: 3 | Train Loss: 0.923 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.195664882659912
Epoch: 8, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.901 Vali Acc: 0.725 Test Loss: 0.901 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9678213596343994
Epoch: 9, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.896 Vali Acc: 0.550 Test Loss: 0.896 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0304820537567139
Epoch: 10, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.744 Vali Acc: 0.750 Test Loss: 0.744 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9236257076263428
Epoch: 11, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.9293720722198486
Epoch: 12, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.778 Vali Acc: 0.600 Test Loss: 0.778 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.056884765625
Epoch: 13, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.654 Vali Acc: 0.625 Test Loss: 0.654 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9847536087036133
Epoch: 14, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.623 Vali Acc: 0.625 Test Loss: 0.623 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.704491376876831
Epoch: 15, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.496 Vali Acc: 0.800 Test Loss: 0.496 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 0.8902990818023682
Epoch: 16, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.799995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.8661394119262695
Epoch: 17, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.878471851348877
Epoch: 18, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.411 Vali Acc: 0.825 Test Loss: 0.411 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9318370819091797
Epoch: 19, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9397416114807129
Epoch: 20, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0183987617492676
Epoch: 21, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.321 Vali Acc: 0.825 Test Loss: 0.321 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0086941719055176
Epoch: 22, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.950415849685669
Epoch: 23, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1045942306518555
Epoch: 24, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.264 Vali Acc: 0.875 Test Loss: 0.264 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0033578872680664
Epoch: 25, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8964343070983887
Epoch: 26, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9062025547027588
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.7984912395477295
Epoch: 28, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9484210014343262
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.941645622253418
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.8615860939025879
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9458127021789551
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8510410785675049
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.721031904220581
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.7964203357696533
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.9082584381103516
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.8595376014709473
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.789949893951416
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.916834831237793
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0046536922454834
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9362459182739258
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8990540504455566
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8543093204498291
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8161106109619141
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9182288646697998
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8710496425628662
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8690812587738037
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8457310199737549
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 6654248
model size : 30.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.147876739501953
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.376 Vali Acc: 0.450 Test Loss: 1.376 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.8790442943572998
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9299349784851074
Epoch: 3, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.406 Vali Acc: 0.300 Test Loss: 1.406 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0406699180603027
Epoch: 4, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.326 Vali Acc: 0.375 Test Loss: 1.326 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8272590637207031
Epoch: 5, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9422900676727295
Epoch: 6, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.9708540439605713
Epoch: 7, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 0.852135419845581
Epoch: 8, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.948 Vali Acc: 0.775 Test Loss: 0.948 Test Acc: 0.775
Validation loss decreased (-0.549990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.8089220523834229
Epoch: 9, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.992 Vali Acc: 0.550 Test Loss: 0.992 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8143916130065918
Epoch: 10, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.875 Vali Acc: 0.725 Test Loss: 0.875 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8791539669036865
Epoch: 11, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.713 Vali Acc: 0.625 Test Loss: 0.713 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8048303127288818
Epoch: 12, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.639 Vali Acc: 0.900 Test Loss: 0.639 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.840632438659668
Epoch: 13, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.688 Vali Acc: 0.775 Test Loss: 0.688 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.920860767364502
Epoch: 14, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.672 Vali Acc: 0.625 Test Loss: 0.672 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9866433143615723
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.510 Vali Acc: 0.700 Test Loss: 0.510 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9349880218505859
Epoch: 16, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8920853137969971
Epoch: 17, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9864566326141357
Epoch: 18, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7766494750976562
Epoch: 19, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.603 Vali Acc: 0.625 Test Loss: 0.603 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8090965747833252
Epoch: 20, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.9112429618835449
Epoch: 21, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.530 Vali Acc: 0.775 Test Loss: 0.530 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9931657314300537
Epoch: 22, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.8653087615966797
Epoch: 23, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.7393581867218018
Epoch: 24, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.943549394607544
Epoch: 25, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.8760247230529785
Epoch: 26, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1256861686706543
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7938666343688965
Epoch: 28, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0379559993743896
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9341816902160645
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9369735717773438
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.9101197719573975
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.1097421646118164
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9580364227294922
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8420455455780029
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9972524642944336
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.047738790512085
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.820117712020874
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8706574440002441
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8172245025634766
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8859410285949707
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8106138706207275
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 6008360
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7467997074127197
Epoch: 1, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.8354160785675049
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.299 Vali Acc: 0.425 Test Loss: 1.299 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.9244918823242188
Epoch: 3, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.247 Vali Acc: 0.575 Test Loss: 1.247 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.8982968330383301
Epoch: 4, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8926002979278564
Epoch: 5, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.086 Vali Acc: 0.575 Test Loss: 1.086 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.8131186962127686
Epoch: 6, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.8086903095245361
Epoch: 7, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.943 Vali Acc: 0.550 Test Loss: 0.943 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8996443748474121
Epoch: 8, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.599990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.9450497627258301
Epoch: 9, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.8536641597747803
Epoch: 10, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8547525405883789
Epoch: 11, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.642 Vali Acc: 0.700 Test Loss: 0.642 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9607021808624268
Epoch: 12, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.941852331161499
Epoch: 13, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.551 Vali Acc: 0.750 Test Loss: 0.551 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8335487842559814
Epoch: 14, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.7969400882720947
Epoch: 15, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8169276714324951
Epoch: 16, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.8796699047088623
Epoch: 17, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.416 Vali Acc: 0.825 Test Loss: 0.416 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9770336151123047
Epoch: 18, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.753591775894165
Epoch: 19, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.578 Vali Acc: 0.675 Test Loss: 0.578 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0244572162628174
Epoch: 20, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.928318977355957
Epoch: 21, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.137620210647583
Epoch: 22, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 0.9742631912231445
Epoch: 23, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1182529926300049
Epoch: 24, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9001660346984863
Epoch: 25, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8849554061889648
Epoch: 26, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3210899829864502
Epoch: 27, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.08518648147583
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.905501127243042
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8773634433746338
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9295878410339355
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.9408280849456787
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.9932701587677002
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.0896837711334229
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9353945255279541
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.052053451538086
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.9559850692749023
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 1.0143396854400635
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9783999919891357
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9818539619445801
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8723294734954834
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9129879474639893
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9309327602386475
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1025381088256836
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0826992988586426
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8909425735473633
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9259011745452881
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 6004776
model size : 27.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.844618797302246
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.390 Vali Acc: 0.225 Test Loss: 1.390 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6667220592498779
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.396 Vali Acc: 0.350 Test Loss: 1.396 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.809328556060791
Epoch: 3, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.387 Vali Acc: 0.425 Test Loss: 1.387 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.7279078960418701
Epoch: 4, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.273 Vali Acc: 0.475 Test Loss: 1.273 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.7094004154205322
Epoch: 5, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.170 Vali Acc: 0.625 Test Loss: 1.170 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.7740073204040527
Epoch: 6, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8332853317260742
Epoch: 7, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.624988 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.7621309757232666
Epoch: 8, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.918 Vali Acc: 0.675 Test Loss: 0.918 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9868838787078857
Epoch: 9, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.834230899810791
Epoch: 10, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.944 Vali Acc: 0.525 Test Loss: 0.944 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0860686302185059
Epoch: 11, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.709 Vali Acc: 0.750 Test Loss: 0.709 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7616193294525146
Epoch: 12, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8722274303436279
Epoch: 13, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8030600547790527
Epoch: 14, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.663 Vali Acc: 0.725 Test Loss: 0.663 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7885901927947998
Epoch: 15, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 0.8449728488922119
Epoch: 16, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.9836568832397461
Epoch: 17, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.827200174331665
Epoch: 18, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9433739185333252
Epoch: 19, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8325128555297852
Epoch: 20, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0811574459075928
Epoch: 21, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9635419845581055
Epoch: 22, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6742775440216064
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8438079357147217
Epoch: 24, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.7572956085205078
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.7834632396697998
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8029532432556152
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9180536270141602
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0960137844085693
Epoch: 29, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9247646331787109
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0260989665985107
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9160318374633789
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9954037666320801
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8008551597595215
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7970306873321533
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 6001192
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4346094131469727
Epoch: 1, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.462 Vali Acc: 0.150 Test Loss: 1.462 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.9622416496276855
Epoch: 2, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.487 Vali Acc: 0.275 Test Loss: 1.487 Test Acc: 0.275
Validation loss decreased (-0.149985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.0812592506408691
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.502 Vali Acc: 0.250 Test Loss: 1.502 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9309229850769043
Epoch: 4, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
Validation loss decreased (-0.274985 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.9371562004089355
Epoch: 5, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.2656567096710205
Epoch: 6, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.207 Vali Acc: 0.425 Test Loss: 1.207 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.969968318939209
Epoch: 7, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.153 Vali Acc: 0.525 Test Loss: 1.153 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.856781005859375
Epoch: 8, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9199678897857666
Epoch: 9, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.964 Vali Acc: 0.575 Test Loss: 0.964 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574990).  Saving model ...
Epoch: 10 cost time: 1.0806353092193604
Epoch: 10, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.925 Vali Acc: 0.575 Test Loss: 0.925 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574991).  Saving model ...
Epoch: 11 cost time: 1.0017797946929932
Epoch: 11, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.966 Vali Acc: 0.500 Test Loss: 0.966 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9047729969024658
Epoch: 12, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.817 Vali Acc: 0.575 Test Loss: 0.817 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574992).  Saving model ...
Epoch: 13 cost time: 0.8989286422729492
Epoch: 13, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.665 Vali Acc: 0.725 Test Loss: 0.665 Test Acc: 0.725
Validation loss decreased (-0.574992 --> -0.724993).  Saving model ...
Epoch: 14 cost time: 0.8125448226928711
Epoch: 14, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.699 Vali Acc: 0.575 Test Loss: 0.699 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.959357500076294
Epoch: 15, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.726 Vali Acc: 0.625 Test Loss: 0.726 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9404468536376953
Epoch: 16, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.667 Vali Acc: 0.675 Test Loss: 0.667 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8951358795166016
Epoch: 17, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
Validation loss decreased (-0.724993 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.077777624130249
Epoch: 18, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.689 Vali Acc: 0.625 Test Loss: 0.689 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1125550270080566
Epoch: 19, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.464 Vali Acc: 0.675 Test Loss: 0.464 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9820926189422607
Epoch: 20, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.545 Vali Acc: 0.725 Test Loss: 0.545 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8196277618408203
Epoch: 21, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.9092350006103516
Epoch: 22, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.637 Vali Acc: 0.625 Test Loss: 0.637 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1150257587432861
Epoch: 23, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.495 Vali Acc: 0.725 Test Loss: 0.495 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1113495826721191
Epoch: 24, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.9320917129516602
Epoch: 25, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 1.1373741626739502
Epoch: 26, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8593647480010986
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0173556804656982
Epoch: 28, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0061357021331787
Epoch: 29, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.225691556930542
Epoch: 30, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 1.222411870956421
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1271045207977295
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.990868330001831
Epoch: 33, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1129505634307861
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.275195837020874
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.224421739578247
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 1.078197717666626
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 1.1258807182312012
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.9063057899475098
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1173651218414307
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2192389965057373
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.0403380393981934
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.0916321277618408
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.1947519779205322
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.9705464839935303
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.106468677520752
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0079236030578613
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.088423490524292
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1150362491607666
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1216819286346436
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1501092910766602
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.0187666416168213
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9631233215332031
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.873537540435791
Epoch: 54, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 5997608
model size : 27.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.22348690032959
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.374 Vali Acc: 0.350 Test Loss: 1.374 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.9436888694763184
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9270052909851074
Epoch: 3, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.302 Vali Acc: 0.350 Test Loss: 1.302 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.1348841190338135
Epoch: 4, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.266 Vali Acc: 0.525 Test Loss: 1.266 Test Acc: 0.525
Validation loss decreased (-0.349987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.9625444412231445
Epoch: 5, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 1.0344698429107666
Epoch: 6, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.049884557723999
Epoch: 7, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.7984552383422852
Epoch: 8, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.942 Vali Acc: 0.725 Test Loss: 0.942 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.965674877166748
Epoch: 9, Steps: 3 | Train Loss: 0.669 Vali Loss: 1.014 Vali Acc: 0.725 Test Loss: 1.014 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.855353593826294
Epoch: 10, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.810 Vali Acc: 0.675 Test Loss: 0.810 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8560502529144287
Epoch: 11, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.9211907386779785
Epoch: 12, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.077688217163086
Epoch: 13, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8830270767211914
Epoch: 14, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0753331184387207
Epoch: 15, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8856370449066162
Epoch: 16, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.511 Vali Acc: 0.775 Test Loss: 0.511 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8833394050598145
Epoch: 17, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.7543015480041504
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.8963403701782227
Epoch: 19, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.8190791606903076
Epoch: 20, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9958748817443848
Epoch: 21, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8295736312866211
Epoch: 22, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9658453464508057
Epoch: 23, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8848423957824707
Epoch: 24, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9736521244049072
Epoch: 25, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9069759845733643
Epoch: 26, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.9685158729553223
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9044747352600098
Epoch: 28, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.9843227863311768
Epoch: 29, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9142990112304688
Epoch: 30, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9864916801452637
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8432934284210205
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.9181993007659912
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7967331409454346
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9933953285217285
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1839985847473145
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.7633934020996094
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.9478836059570312
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.0043277740478516
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.9190161228179932
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9340941905975342
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9494583606719971
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1660633087158203
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8777432441711426
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7904717922210693
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0635054111480713
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9071955680847168
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9299664497375488
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.994734525680542
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 5680040
model size : 26.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5898568630218506
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.445 Vali Acc: 0.400 Test Loss: 1.445 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8692770004272461
Epoch: 2, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.377 Vali Acc: 0.425 Test Loss: 1.377 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.9061474800109863
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.325 Vali Acc: 0.600 Test Loss: 1.325 Test Acc: 0.600
Validation loss decreased (-0.424986 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 1.0020244121551514
Epoch: 4, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8732028007507324
Epoch: 5, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.212 Vali Acc: 0.425 Test Loss: 1.212 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8768837451934814
Epoch: 6, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.226 Vali Acc: 0.600 Test Loss: 1.226 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.8648529052734375
Epoch: 7, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.8007118701934814
Epoch: 8, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.8852794170379639
Epoch: 9, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.922 Vali Acc: 0.775 Test Loss: 0.922 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.9213764667510986
Epoch: 10, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9908339977264404
Epoch: 11, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.823 Vali Acc: 0.700 Test Loss: 0.823 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9383251667022705
Epoch: 12, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 0.7666776180267334
Epoch: 13, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.0700607299804688
Epoch: 14, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0172724723815918
Epoch: 15, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.8021001815795898
Epoch: 16, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8002235889434814
Epoch: 17, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9574160575866699
Epoch: 18, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.8943579196929932
Epoch: 19, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.772 Vali Acc: 0.625 Test Loss: 0.772 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8967468738555908
Epoch: 20, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8191919326782227
Epoch: 21, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8340106010437012
Epoch: 22, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8261313438415527
Epoch: 23, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.8639473915100098
Epoch: 24, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0179133415222168
Epoch: 25, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.7948980331420898
Epoch: 26, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9761853218078613
Epoch: 27, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8251597881317139
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8269572257995605
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7663331031799316
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.96712327003479
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8601746559143066
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8161234855651855
Epoch: 33, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.886436939239502
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8674540519714355
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.716916561126709
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.7511096000671387
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8379619121551514
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9398465156555176
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.01076078414917
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0059270858764648
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.062666654586792
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1439507007598877
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9194686412811279
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8871781826019287
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9349172115325928
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 5676456
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.532728672027588
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.395 Vali Acc: 0.350 Test Loss: 1.395 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.8413856029510498
Epoch: 2, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7095911502838135
Epoch: 3, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.0456104278564453
Epoch: 4, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.9478039741516113
Epoch: 5, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.185 Vali Acc: 0.725 Test Loss: 1.185 Test Acc: 0.725
Validation loss decreased (-0.499987 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 0.8199312686920166
Epoch: 6, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.119 Vali Acc: 0.525 Test Loss: 1.119 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8541688919067383
Epoch: 7, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.014 Vali Acc: 0.725 Test Loss: 1.014 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.9209413528442383
Epoch: 8, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.954 Vali Acc: 0.550 Test Loss: 0.954 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8589229583740234
Epoch: 9, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.861 Vali Acc: 0.625 Test Loss: 0.861 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9416391849517822
Epoch: 10, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.739 Vali Acc: 0.700 Test Loss: 0.739 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9469432830810547
Epoch: 11, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.8384511470794678
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7473111152648926
Epoch: 13, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.828427791595459
Epoch: 14, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.755 Vali Acc: 0.725 Test Loss: 0.755 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8835711479187012
Epoch: 15, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.590 Vali Acc: 0.725 Test Loss: 0.590 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9831805229187012
Epoch: 16, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.833838939666748
Epoch: 17, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.610 Vali Acc: 0.675 Test Loss: 0.610 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7814736366271973
Epoch: 18, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.433 Vali Acc: 0.775 Test Loss: 0.433 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8288247585296631
Epoch: 19, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.410 Vali Acc: 0.700 Test Loss: 0.410 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0328574180603027
Epoch: 20, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.0043582916259766
Epoch: 21, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0634994506835938
Epoch: 22, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9160971641540527
Epoch: 23, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1388204097747803
Epoch: 24, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.030808687210083
Epoch: 25, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9422690868377686
Epoch: 26, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.864938497543335
Epoch: 27, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9946255683898926
Epoch: 28, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.8370254039764404
Epoch: 29, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1208224296569824
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9125373363494873
Epoch: 31, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.8317854404449463
Epoch: 32, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.9102339744567871
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7496111392974854
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8351578712463379
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9058837890625
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.8644795417785645
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0340893268585205
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9948668479919434
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0010616779327393
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0014946460723877
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.1035230159759521
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.8972454071044922
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7602283954620361
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8839538097381592
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.806410551071167
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9935970306396484
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0157999992370605
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9537429809570312
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9826245307922363
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.924342155456543
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.2358522415161133
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 5672872
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7988438606262207
Epoch: 1, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.363 Vali Acc: 0.175 Test Loss: 1.363 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.8124580383300781
Epoch: 2, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.387 Vali Acc: 0.150 Test Loss: 1.387 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8378868103027344
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.174986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.0321857929229736
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.330 Vali Acc: 0.450 Test Loss: 1.330 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.9397518634796143
Epoch: 5, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.8020105361938477
Epoch: 6, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.8685195446014404
Epoch: 7, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.9347105026245117
Epoch: 8, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.050 Vali Acc: 0.525 Test Loss: 1.050 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1005144119262695
Epoch: 9, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.966 Vali Acc: 0.575 Test Loss: 0.966 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8081974983215332
Epoch: 10, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.749 Vali Acc: 0.625 Test Loss: 0.749 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0042715072631836
Epoch: 11, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.767 Vali Acc: 0.700 Test Loss: 0.767 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 0.842174768447876
Epoch: 12, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.789 Vali Acc: 0.700 Test Loss: 0.789 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7393324375152588
Epoch: 13, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774994).  Saving model ...
Epoch: 14 cost time: 0.8443207740783691
Epoch: 14, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 1.0591778755187988
Epoch: 15, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.7812550067901611
Epoch: 16, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8678743839263916
Epoch: 17, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.515 Vali Acc: 0.775 Test Loss: 0.515 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9915275573730469
Epoch: 18, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.423 Vali Acc: 0.825 Test Loss: 0.423 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0765910148620605
Epoch: 19, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.484 Vali Acc: 0.725 Test Loss: 0.484 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8997147083282471
Epoch: 20, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.385 Vali Acc: 0.825 Test Loss: 0.385 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9316999912261963
Epoch: 21, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.431 Vali Acc: 0.825 Test Loss: 0.431 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9890305995941162
Epoch: 22, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.9245235919952393
Epoch: 23, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8980340957641602
Epoch: 24, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.8165240287780762
Epoch: 25, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1370174884796143
Epoch: 26, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9021759033203125
Epoch: 27, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9559400081634521
Epoch: 28, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.0258948802947998
Epoch: 29, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.00215744972229
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8335177898406982
Epoch: 31, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.2628350257873535
Epoch: 32, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.8698430061340332
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7727315425872803
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.7709493637084961
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9157907962799072
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.0873608589172363
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7762200832366943
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1860215663909912
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8497438430786133
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8303947448730469
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7302861213684082
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8928816318511963
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9283175468444824
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7955930233001709
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.7860598564147949
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.9449217319488525
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.7840766906738281
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.908320426940918
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8320400714874268
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.699378490447998
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8628635406494141
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8976707458496094
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.914442777633667
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8486800193786621
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8871541023254395
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7446990013122559
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9066855907440186
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 5669288
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9618000984191895
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9482746124267578
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.436 Vali Acc: 0.250 Test Loss: 1.436 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.795461893081665
Epoch: 3, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.407 Vali Acc: 0.450 Test Loss: 1.407 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.8837614059448242
Epoch: 4, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.375 Vali Acc: 0.425 Test Loss: 1.375 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9851794242858887
Epoch: 5, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.316 Vali Acc: 0.450 Test Loss: 1.316 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.0306479930877686
Epoch: 6, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7407188415527344
Epoch: 7, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 1.0275745391845703
Epoch: 8, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.8620460033416748
Epoch: 9, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.097 Vali Acc: 0.575 Test Loss: 1.097 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.019890308380127
Epoch: 10, Steps: 3 | Train Loss: 0.754 Vali Loss: 1.020 Vali Acc: 0.575 Test Loss: 1.020 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1029372215270996
Epoch: 11, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.958 Vali Acc: 0.675 Test Loss: 0.958 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.2139270305633545
Epoch: 12, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.925 Vali Acc: 0.800 Test Loss: 0.925 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.9718704223632812
Epoch: 13, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.8898968696594238
Epoch: 14, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8245019912719727
Epoch: 15, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.809551477432251
Epoch: 16, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.7515482902526855
Epoch: 17, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.779029130935669
Epoch: 18, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8684303760528564
Epoch: 19, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.9745566844940186
Epoch: 20, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9430577754974365
Epoch: 21, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.108149528503418
Epoch: 22, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.8794794082641602
Epoch: 23, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9559314250946045
Epoch: 24, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8292639255523682
Epoch: 25, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.9095885753631592
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9008462429046631
Epoch: 27, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.865149974822998
Epoch: 28, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7521827220916748
Epoch: 29, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.7973916530609131
Epoch: 30, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7931139469146729
Epoch: 31, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 32 cost time: 0.9312441349029541
Epoch: 32, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8605461120605469
Epoch: 33, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9095592498779297
Epoch: 34, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0157058238983154
Epoch: 35, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8612182140350342
Epoch: 36, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.749232292175293
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7654693126678467
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9262456893920898
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.84159255027771
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8588111400604248
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 2681000
model size : 12.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.244945764541626
Epoch: 1, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.364 Vali Acc: 0.250 Test Loss: 1.364 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.005631923675537
Epoch: 2, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.8372008800506592
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.326 Vali Acc: 0.375 Test Loss: 1.326 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.8107852935791016
Epoch: 4, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.282 Vali Acc: 0.475 Test Loss: 1.282 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 1.163546085357666
Epoch: 5, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.244 Vali Acc: 0.525 Test Loss: 1.244 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.8332757949829102
Epoch: 6, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.7787883281707764
Epoch: 7, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.120 Vali Acc: 0.650 Test Loss: 1.120 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.8845841884613037
Epoch: 8, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.057 Vali Acc: 0.550 Test Loss: 1.057 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.046973466873169
Epoch: 9, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.966 Vali Acc: 0.575 Test Loss: 0.966 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7676472663879395
Epoch: 10, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.9513137340545654
Epoch: 11, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.918 Vali Acc: 0.550 Test Loss: 0.918 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8707273006439209
Epoch: 12, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.902 Vali Acc: 0.525 Test Loss: 0.902 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8155524730682373
Epoch: 13, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 0.7256176471710205
Epoch: 14, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
Validation loss decreased (-0.799992 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.950162410736084
Epoch: 15, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.583 Vali Acc: 0.925 Test Loss: 0.583 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.8039758205413818
Epoch: 16, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8950657844543457
Epoch: 17, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.992966890335083
Epoch: 18, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8394608497619629
Epoch: 19, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0409574508666992
Epoch: 20, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8919496536254883
Epoch: 21, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.829719066619873
Epoch: 22, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9017531871795654
Epoch: 23, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9938652515411377
Epoch: 24, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.9981808662414551
Epoch: 25, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.012181043624878
Epoch: 26, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9461517333984375
Epoch: 27, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0100526809692383
Epoch: 28, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0422253608703613
Epoch: 29, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.861497163772583
Epoch: 30, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.271 Vali Acc: 0.875 Test Loss: 0.271 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9282755851745605
Epoch: 31, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.266 Vali Acc: 0.875 Test Loss: 0.266 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9735586643218994
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9039709568023682
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9713692665100098
Epoch: 34, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.8514964580535889
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9723906517028809
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9399433135986328
Epoch: 37, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0413897037506104
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.902808427810669
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0647995471954346
Epoch: 40, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8033168315887451
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9990251064300537
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9442918300628662
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9507031440734863
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2679208
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7453315258026123
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.437 Vali Acc: 0.150 Test Loss: 1.437 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.8340203762054443
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.369 Vali Acc: 0.375 Test Loss: 1.369 Test Acc: 0.375
Validation loss decreased (-0.149986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.846494197845459
Epoch: 3, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9820106029510498
Epoch: 4, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.6870474815368652
Epoch: 5, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.217 Vali Acc: 0.425 Test Loss: 1.217 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9426746368408203
Epoch: 6, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.180 Vali Acc: 0.600 Test Loss: 1.180 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.3942971229553223
Epoch: 7, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.202 Vali Acc: 0.475 Test Loss: 1.202 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8143830299377441
Epoch: 8, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.6869521141052246
Epoch: 9, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.013 Vali Acc: 0.800 Test Loss: 1.013 Test Acc: 0.800
Validation loss decreased (-0.599989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.7560074329376221
Epoch: 10, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.944 Vali Acc: 0.800 Test Loss: 0.944 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.8114798069000244
Epoch: 11, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8700425624847412
Epoch: 12, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.878 Vali Acc: 0.650 Test Loss: 0.878 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8510124683380127
Epoch: 13, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.771 Vali Acc: 0.650 Test Loss: 0.771 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.837637186050415
Epoch: 14, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.755 Vali Acc: 0.575 Test Loss: 0.755 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8902654647827148
Epoch: 15, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.8651933670043945
Epoch: 16, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8472900390625
Epoch: 17, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.7903454303741455
Epoch: 18, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.9339542388916016
Epoch: 19, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.8353278636932373
Epoch: 20, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.8854272365570068
Epoch: 21, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.972891092300415
Epoch: 22, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9015102386474609
Epoch: 23, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9886007308959961
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8559622764587402
Epoch: 25, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8927803039550781
Epoch: 26, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0253221988677979
Epoch: 27, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8536179065704346
Epoch: 28, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1729795932769775
Epoch: 29, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.434274673461914
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.9528748989105225
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0466761589050293
Epoch: 32, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9755213260650635
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2927629947662354
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.06760835647583
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0459880828857422
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8769674301147461
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.8682570457458496
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.058309555053711
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1324405670166016
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9960095882415771
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0502443313598633
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9390459060668945
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9375483989715576
Epoch: 44, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0552945137023926
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0592658519744873
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9706780910491943
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2677416
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6287953853607178
Epoch: 1, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.356 Vali Acc: 0.425 Test Loss: 1.356 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.9458985328674316
Epoch: 2, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.341 Vali Acc: 0.425 Test Loss: 1.341 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.965399980545044
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8943066596984863
Epoch: 4, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.8469674587249756
Epoch: 5, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.229 Vali Acc: 0.600 Test Loss: 1.229 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.8867731094360352
Epoch: 6, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.206 Vali Acc: 0.675 Test Loss: 1.206 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.7386865615844727
Epoch: 7, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.125 Vali Acc: 0.675 Test Loss: 1.125 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.8994698524475098
Epoch: 8, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8908329010009766
Epoch: 9, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.987 Vali Acc: 0.800 Test Loss: 0.987 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.926983118057251
Epoch: 10, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9523797035217285
Epoch: 11, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.980914831161499
Epoch: 12, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.919266939163208
Epoch: 13, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.726 Vali Acc: 0.625 Test Loss: 0.726 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.025733470916748
Epoch: 14, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0627994537353516
Epoch: 15, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9912149906158447
Epoch: 16, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.9814865589141846
Epoch: 17, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.8623764514923096
Epoch: 18, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8599612712860107
Epoch: 19, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0519702434539795
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8434107303619385
Epoch: 21, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.357 Vali Acc: 0.825 Test Loss: 0.357 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7694833278656006
Epoch: 22, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.090522289276123
Epoch: 23, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7364346981048584
Epoch: 24, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.7533268928527832
Epoch: 25, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8162932395935059
Epoch: 26, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.7877712249755859
Epoch: 27, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.9652056694030762
Epoch: 28, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7841625213623047
Epoch: 29, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8192174434661865
Epoch: 30, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.8346004486083984
Epoch: 31, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.073650598526001
Epoch: 32, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.824753999710083
Epoch: 33, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8875348567962646
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7699155807495117
Epoch: 35, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9072010517120361
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8186776638031006
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7631821632385254
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8994705677032471
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8303794860839844
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 2675624
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9960947036743164
Epoch: 1, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.444 Vali Acc: 0.300 Test Loss: 1.444 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9056217670440674
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9556329250335693
Epoch: 3, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.419 Vali Acc: 0.350 Test Loss: 1.419 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0036725997924805
Epoch: 4, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.381 Vali Acc: 0.325 Test Loss: 1.381 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1251726150512695
Epoch: 5, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.0844199657440186
Epoch: 6, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.326 Vali Acc: 0.425 Test Loss: 1.326 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0312035083770752
Epoch: 7, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.9583969116210938
Epoch: 8, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0629096031188965
Epoch: 9, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 1.1689186096191406
Epoch: 10, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.9043340682983398
Epoch: 11, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.0035085678100586
Epoch: 12, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9333376884460449
Epoch: 13, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 1.0589864253997803
Epoch: 14, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.860 Vali Acc: 0.625 Test Loss: 0.860 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9308257102966309
Epoch: 15, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.696631908416748
Epoch: 16, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.7917537689208984
Epoch: 17, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.730 Vali Acc: 0.825 Test Loss: 0.730 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.8972885608673096
Epoch: 18, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8316423892974854
Epoch: 19, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9314742088317871
Epoch: 20, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 1.0098884105682373
Epoch: 21, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.8908588886260986
Epoch: 22, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8527755737304688
Epoch: 23, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.518 Vali Acc: 0.800 Test Loss: 0.518 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8096203804016113
Epoch: 24, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8783888816833496
Epoch: 25, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 0.7960729598999023
Epoch: 26, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 27 cost time: 1.1800577640533447
Epoch: 27, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 0.7826721668243408
Epoch: 28, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8974423408508301
Epoch: 29, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9305779933929443
Epoch: 30, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9172463417053223
Epoch: 31, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8926441669464111
Epoch: 32, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1537907123565674
Epoch: 33, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8082537651062012
Epoch: 34, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0296359062194824
Epoch: 35, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 0.8996610641479492
Epoch: 36, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1229736804962158
Epoch: 37, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1048591136932373
Epoch: 38, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.8288724422454834
Epoch: 39, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.8228752613067627
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.782172441482544
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9008359909057617
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8543715476989746
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9746687412261963
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0851020812988281
Epoch: 45, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0832796096801758
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8590874671936035
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9136998653411865
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8547289371490479
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2023080
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1355690956115723
Epoch: 1, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.9213027954101562
Epoch: 2, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.8667740821838379
Epoch: 3, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.273 Vali Acc: 0.575 Test Loss: 1.273 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574987).  Saving model ...
Epoch: 4 cost time: 0.8738119602203369
Epoch: 4, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.325 Vali Acc: 0.525 Test Loss: 1.325 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8814582824707031
Epoch: 5, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.001225233078003
Epoch: 6, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.8000519275665283
Epoch: 7, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.0073349475860596
Epoch: 8, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.1397056579589844
Epoch: 9, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.8561999797821045
Epoch: 10, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8102214336395264
Epoch: 11, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.8993899822235107
Epoch: 12, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9074130058288574
Epoch: 13, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.9415526390075684
Epoch: 14, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8532629013061523
Epoch: 15, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8813302516937256
Epoch: 16, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.664 Vali Acc: 0.775 Test Loss: 0.664 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9692671298980713
Epoch: 17, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.659 Vali Acc: 0.625 Test Loss: 0.659 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8615033626556396
Epoch: 18, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.8399138450622559
Epoch: 19, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0253889560699463
Epoch: 20, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7266485691070557
Epoch: 21, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8940722942352295
Epoch: 22, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.7634913921356201
Epoch: 23, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.927692174911499
Epoch: 24, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8421540260314941
Epoch: 25, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.9302668571472168
Epoch: 26, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.8917272090911865
Epoch: 27, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9165377616882324
Epoch: 28, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9982295036315918
Epoch: 29, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8817994594573975
Epoch: 30, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.9262239933013916
Epoch: 31, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.9162986278533936
Epoch: 32, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9573636054992676
Epoch: 33, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.8381524085998535
Epoch: 34, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.8605492115020752
Epoch: 35, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.794968843460083
Epoch: 36, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0007436275482178
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.020228385925293
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9593400955200195
Epoch: 39, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7244281768798828
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.76300048828125
Epoch: 41, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.950944185256958
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0337893962860107
Epoch: 43, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8538961410522461
Epoch: 44, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9121694564819336
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2021288
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.561807870864868
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.416 Vali Acc: 0.250 Test Loss: 1.416 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.049764633178711
Epoch: 2, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.9277703762054443
Epoch: 3, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.379 Vali Acc: 0.350 Test Loss: 1.379 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.7514636516571045
Epoch: 4, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.0786101818084717
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.8537812232971191
Epoch: 6, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.09456467628479
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.192 Vali Acc: 0.525 Test Loss: 1.192 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.8945920467376709
Epoch: 8, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.138 Vali Acc: 0.525 Test Loss: 1.138 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.8587400913238525
Epoch: 9, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.524989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.8603746891021729
Epoch: 10, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.8705530166625977
Epoch: 11, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7477562427520752
Epoch: 12, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.912 Vali Acc: 0.800 Test Loss: 0.912 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.8969109058380127
Epoch: 13, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.850 Vali Acc: 0.825 Test Loss: 0.850 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.7186908721923828
Epoch: 14, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.8680706024169922
Epoch: 15, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8060483932495117
Epoch: 16, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9974179267883301
Epoch: 17, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.9506142139434814
Epoch: 18, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.988330602645874
Epoch: 19, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8890500068664551
Epoch: 20, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.8966188430786133
Epoch: 21, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.532 Vali Acc: 0.625 Test Loss: 0.532 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9941942691802979
Epoch: 22, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.408 Vali Acc: 0.825 Test Loss: 0.408 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9212193489074707
Epoch: 23, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9811646938323975
Epoch: 24, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9297459125518799
Epoch: 25, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0680391788482666
Epoch: 26, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 1.193861961364746
Epoch: 27, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.395 Vali Acc: 0.825 Test Loss: 0.395 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.932441234588623
Epoch: 28, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9296960830688477
Epoch: 29, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7470314502716064
Epoch: 30, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 31 cost time: 0.8909285068511963
Epoch: 31, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.790273904800415
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0790131092071533
Epoch: 33, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 1.036759376525879
Epoch: 34, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.8525702953338623
Epoch: 35, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.964015007019043
Epoch: 36, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.7608833312988281
Epoch: 37, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8424670696258545
Epoch: 38, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.9737558364868164
Epoch: 39, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.922532320022583
Epoch: 40, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8448917865753174
Epoch: 41, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8430345058441162
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9154515266418457
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.7960853576660156
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8420150279998779
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.9613780975341797
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9251880645751953
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7508692741394043
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9153904914855957
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7447502613067627
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1148316860198975
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7698907852172852
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8666467666625977
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9788496494293213
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.075394630432129
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2019496
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0114023685455322
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.402 Vali Acc: 0.225 Test Loss: 1.402 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.8341059684753418
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.413 Vali Acc: 0.300 Test Loss: 1.413 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.0536692142486572
Epoch: 3, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.412 Vali Acc: 0.350 Test Loss: 1.412 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.8070416450500488
Epoch: 4, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.7875995635986328
Epoch: 5, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.8239231109619141
Epoch: 6, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7571544647216797
Epoch: 7, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.7775843143463135
Epoch: 8, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.182 Vali Acc: 0.525 Test Loss: 1.182 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.8326387405395508
Epoch: 9, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.144 Vali Acc: 0.450 Test Loss: 1.144 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2351398468017578
Epoch: 10, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.8980562686920166
Epoch: 11, Steps: 3 | Train Loss: 0.793 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8673496246337891
Epoch: 12, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.857982873916626
Epoch: 13, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.914 Vali Acc: 0.600 Test Loss: 0.914 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8813748359680176
Epoch: 14, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.908 Vali Acc: 0.575 Test Loss: 0.908 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0314249992370605
Epoch: 15, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.839 Vali Acc: 0.650 Test Loss: 0.839 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0205020904541016
Epoch: 16, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.808 Vali Acc: 0.575 Test Loss: 0.808 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7431104183197021
Epoch: 17, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.7351975440979004
Epoch: 18, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9058811664581299
Epoch: 19, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 0.7510278224945068
Epoch: 20, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.8198947906494141
Epoch: 21, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.8561561107635498
Epoch: 22, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.8012924194335938
Epoch: 23, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8949425220489502
Epoch: 24, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.8858766555786133
Epoch: 25, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.7948989868164062
Epoch: 26, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.8481435775756836
Epoch: 27, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7743406295776367
Epoch: 28, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8792705535888672
Epoch: 29, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8412952423095703
Epoch: 30, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0326597690582275
Epoch: 31, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.89383864402771
Epoch: 32, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8831524848937988
Epoch: 33, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.8827207088470459
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.7852072715759277
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7933506965637207
Epoch: 36, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9298923015594482
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.8546338081359863
Epoch: 38, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8383266925811768
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9729781150817871
Epoch: 40, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0851778984069824
Epoch: 41, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9343562126159668
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0653538703918457
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.124671220779419
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8513481616973877
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8330409526824951
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0168113708496094
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2017704
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.708676338195801
Epoch: 1, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.480 Vali Acc: 0.275 Test Loss: 1.480 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.8983099460601807
Epoch: 2, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.433 Vali Acc: 0.350 Test Loss: 1.433 Test Acc: 0.350
Validation loss decreased (-0.274985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.9897487163543701
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.403 Vali Acc: 0.300 Test Loss: 1.403 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7590248584747314
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.361 Vali Acc: 0.325 Test Loss: 1.361 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9753034114837646
Epoch: 5, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.332 Vali Acc: 0.425 Test Loss: 1.332 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.8460218906402588
Epoch: 6, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.296 Vali Acc: 0.350 Test Loss: 1.296 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.048828363418579
Epoch: 7, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.272 Vali Acc: 0.400 Test Loss: 1.272 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7848842144012451
Epoch: 8, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.263 Vali Acc: 0.475 Test Loss: 1.263 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.8761825561523438
Epoch: 9, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.168 Vali Acc: 0.650 Test Loss: 1.168 Test Acc: 0.650
Validation loss decreased (-0.474987 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.8315813541412354
Epoch: 10, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.9636313915252686
Epoch: 11, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.016 Vali Acc: 0.625 Test Loss: 1.016 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8140108585357666
Epoch: 12, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8999588489532471
Epoch: 13, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.0492916107177734
Epoch: 14, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.2080931663513184
Epoch: 15, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.798 Vali Acc: 0.725 Test Loss: 0.798 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0066142082214355
Epoch: 16, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.700 Vali Acc: 0.800 Test Loss: 0.700 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.9021928310394287
Epoch: 17, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.971409797668457
Epoch: 18, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.678 Vali Acc: 0.575 Test Loss: 0.678 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8912265300750732
Epoch: 19, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9452660083770752
Epoch: 20, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.657 Vali Acc: 0.675 Test Loss: 0.657 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.044517993927002
Epoch: 21, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.758 Vali Acc: 0.675 Test Loss: 0.758 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9504494667053223
Epoch: 22, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.8655073642730713
Epoch: 23, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.532 Vali Acc: 0.650 Test Loss: 0.532 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8237309455871582
Epoch: 24, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.9389538764953613
Epoch: 25, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8860242366790771
Epoch: 26, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.516 Vali Acc: 0.800 Test Loss: 0.516 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.018559217453003
Epoch: 27, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.9833245277404785
Epoch: 28, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.463 Vali Acc: 0.750 Test Loss: 0.463 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2491614818572998
Epoch: 29, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.1103541851043701
Epoch: 30, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9410512447357178
Epoch: 31, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.8118124008178711
Epoch: 32, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9118824005126953
Epoch: 33, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0073764324188232
Epoch: 34, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.989957332611084
Epoch: 35, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.8355085849761963
Epoch: 36, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.924236536026001
Epoch: 37, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.2449376583099365
Epoch: 38, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.944115400314331
Epoch: 39, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8262972831726074
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9257357120513916
Epoch: 41, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.771592378616333
Epoch: 42, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8341310024261475
Epoch: 43, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.737311840057373
Epoch: 44, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8871142864227295
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8879380226135254
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6964077949523926
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.044069528579712
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1694120
model size : 9.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.508042573928833
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.485 Vali Acc: 0.075 Test Loss: 1.485 Test Acc: 0.075
Validation loss decreased (inf --> -0.074985).  Saving model ...
Epoch: 2 cost time: 0.8236651420593262
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.466 Vali Acc: 0.275 Test Loss: 1.466 Test Acc: 0.275
Validation loss decreased (-0.074985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.878502607345581
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.459 Vali Acc: 0.275 Test Loss: 1.459 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.9636282920837402
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.435 Vali Acc: 0.250 Test Loss: 1.435 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8328700065612793
Epoch: 5, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.389 Vali Acc: 0.275 Test Loss: 1.389 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.8030214309692383
Epoch: 6, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.891197919845581
Epoch: 7, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.2052905559539795
Epoch: 8, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
Validation loss decreased (-0.424987 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 1.2628142833709717
Epoch: 9, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.186 Vali Acc: 0.525 Test Loss: 1.186 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.03074049949646
Epoch: 10, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.189 Vali Acc: 0.450 Test Loss: 1.189 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9632728099822998
Epoch: 11, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0172955989837646
Epoch: 12, Steps: 3 | Train Loss: 0.777 Vali Loss: 1.009 Vali Acc: 0.675 Test Loss: 1.009 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 1.0050106048583984
Epoch: 13, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 1.0136666297912598
Epoch: 14, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.913 Vali Acc: 0.700 Test Loss: 0.913 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1813480854034424
Epoch: 15, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.148723840713501
Epoch: 16, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.90987229347229
Epoch: 17, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.763 Vali Acc: 0.625 Test Loss: 0.763 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2017543315887451
Epoch: 18, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 1.0152244567871094
Epoch: 19, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0226969718933105
Epoch: 20, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9275789260864258
Epoch: 21, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 1.0204389095306396
Epoch: 22, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9497029781341553
Epoch: 23, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 1.2519173622131348
Epoch: 24, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 1.1158602237701416
Epoch: 25, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.115757703781128
Epoch: 26, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1367065906524658
Epoch: 27, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.421 Vali Acc: 0.825 Test Loss: 0.421 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0944533348083496
Epoch: 28, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 1.2809956073760986
Epoch: 29, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.919100284576416
Epoch: 30, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.9616789817810059
Epoch: 31, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 1.164618968963623
Epoch: 32, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.269 Vali Acc: 0.875 Test Loss: 0.269 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.109299898147583
Epoch: 33, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2706124782562256
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2721879482269287
Epoch: 35, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0093681812286377
Epoch: 36, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.045147180557251
Epoch: 37, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.021071434020996
Epoch: 38, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0939245223999023
Epoch: 39, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.9103963375091553
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 0.826526403427124
Epoch: 41, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9749243259429932
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.007856845855713
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 1.0981807708740234
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.9021162986755371
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9841983318328857
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9343485832214355
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.827063798904419
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9649605751037598
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9266197681427002
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1166460514068604
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 1.1089818477630615
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0235934257507324
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9092535972595215
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8845648765563965
Epoch: 55, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8670918941497803
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 0.8244109153747559
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 0.856605052947998
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0023422241210938
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1939454078674316
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.1050868034362793
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0608198642730713
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.042586326599121
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0267908573150635
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9021170139312744
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.008481502532959
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.0128471851348877
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1692328
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.934539556503296
Epoch: 1, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.373 Vali Acc: 0.375 Test Loss: 1.373 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8484225273132324
Epoch: 2, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.372 Vali Acc: 0.350 Test Loss: 1.372 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9171898365020752
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.390 Vali Acc: 0.325 Test Loss: 1.390 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8480961322784424
Epoch: 4, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7416703701019287
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9510676860809326
Epoch: 6, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.297 Vali Acc: 0.525 Test Loss: 1.297 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.7858009338378906
Epoch: 7, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.0932059288024902
Epoch: 8, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.9187235832214355
Epoch: 9, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.116 Vali Acc: 0.750 Test Loss: 1.116 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749989).  Saving model ...
Epoch: 10 cost time: 0.6980440616607666
Epoch: 10, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.133 Vali Acc: 0.450 Test Loss: 1.133 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8669373989105225
Epoch: 11, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7330694198608398
Epoch: 12, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.993 Vali Acc: 0.650 Test Loss: 0.993 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9157543182373047
Epoch: 13, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 0.6981420516967773
Epoch: 14, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 1.0542089939117432
Epoch: 15, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9319765567779541
Epoch: 16, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.789 Vali Acc: 0.825 Test Loss: 0.789 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9388999938964844
Epoch: 17, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8518044948577881
Epoch: 18, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9232418537139893
Epoch: 19, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.8728463649749756
Epoch: 20, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 0.762549877166748
Epoch: 21, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.7693190574645996
Epoch: 22, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.7919237613677979
Epoch: 23, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.478 Vali Acc: 0.825 Test Loss: 0.478 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7095870971679688
Epoch: 24, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7810330390930176
Epoch: 25, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7467911243438721
Epoch: 26, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.9067983627319336
Epoch: 27, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.7053103446960449
Epoch: 28, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8876912593841553
Epoch: 29, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9690992832183838
Epoch: 30, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 0.8686110973358154
Epoch: 31, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.6968965530395508
Epoch: 32, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.8268623352050781
Epoch: 33, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.692828893661499
Epoch: 34, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9733941555023193
Epoch: 35, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8221356868743896
Epoch: 36, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8933391571044922
Epoch: 37, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.8795416355133057
Epoch: 38, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8795685768127441
Epoch: 39, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9323792457580566
Epoch: 40, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8472342491149902
Epoch: 41, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.7786097526550293
Epoch: 42, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.853926420211792
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7954931259155273
Epoch: 44, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7800443172454834
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8674988746643066
Epoch: 46, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0956377983093262
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9332406520843506
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8190133571624756
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9292042255401611
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8758835792541504
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1690536
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0644798278808594
Epoch: 1, Steps: 3 | Train Loss: 1.554 Vali Loss: 1.479 Vali Acc: 0.325 Test Loss: 1.479 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.8594117164611816
Epoch: 2, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0684900283813477
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.452 Vali Acc: 0.200 Test Loss: 1.452 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.903618335723877
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.469 Vali Acc: 0.300 Test Loss: 1.469 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7950763702392578
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.464 Vali Acc: 0.375 Test Loss: 1.464 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 6 cost time: 1.1922879219055176
Epoch: 6, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.8935532569885254
Epoch: 7, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.2207450866699219
Epoch: 8, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.9445817470550537
Epoch: 9, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0151760578155518
Epoch: 10, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.159 Vali Acc: 0.475 Test Loss: 1.159 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.9917967319488525
Epoch: 11, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.088 Vali Acc: 0.575 Test Loss: 1.088 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.9768662452697754
Epoch: 12, Steps: 3 | Train Loss: 0.773 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.9303586483001709
Epoch: 13, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.843609094619751
Epoch: 14, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.933 Vali Acc: 0.625 Test Loss: 0.933 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2444655895233154
Epoch: 15, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.864 Vali Acc: 0.650 Test Loss: 0.864 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8287930488586426
Epoch: 16, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.819 Vali Acc: 0.600 Test Loss: 0.819 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8988313674926758
Epoch: 17, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.827 Vali Acc: 0.550 Test Loss: 0.827 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9842085838317871
Epoch: 18, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 0.8945457935333252
Epoch: 19, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.653 Vali Acc: 0.775 Test Loss: 0.653 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 20 cost time: 0.8542182445526123
Epoch: 20, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
Validation loss decreased (-0.774993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.8539535999298096
Epoch: 21, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9856786727905273
Epoch: 22, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9650919437408447
Epoch: 23, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9322967529296875
Epoch: 24, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.7273547649383545
Epoch: 25, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.8187079429626465
Epoch: 26, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7816355228424072
Epoch: 27, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9343595504760742
Epoch: 28, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.8098747730255127
Epoch: 29, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.9463083744049072
Epoch: 30, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8725898265838623
Epoch: 31, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.8624494075775146
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.7964534759521484
Epoch: 33, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9436545372009277
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.9337906837463379
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8886146545410156
Epoch: 36, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8966894149780273
Epoch: 37, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.0164353847503662
Epoch: 38, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8382670879364014
Epoch: 39, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9852454662322998
Epoch: 40, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9744372367858887
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9330282211303711
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.754539966583252
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8832218647003174
Epoch: 44, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.775068998336792
Epoch: 45, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8045973777770996
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.931710958480835
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9567258358001709
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0977590084075928
Epoch: 49, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9379336833953857
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9579405784606934
Epoch: 51, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9707169532775879
Epoch: 52, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8650624752044678
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9743716716766357
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0410854816436768
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1024510860443115
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1688744
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.44787859916687
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8359317779541016
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.7937030792236328
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.386 Vali Acc: 0.300 Test Loss: 1.386 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1204781532287598
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0665440559387207
Epoch: 5, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.378 Vali Acc: 0.350 Test Loss: 1.378 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8865373134613037
Epoch: 6, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.0283091068267822
Epoch: 7, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 1.1316251754760742
Epoch: 8, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9619705677032471
Epoch: 9, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8090345859527588
Epoch: 10, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.813460111618042
Epoch: 11, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.716480016708374
Epoch: 12, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.041 Vali Acc: 0.700 Test Loss: 1.041 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.9746601581573486
Epoch: 13, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 1.0364224910736084
Epoch: 14, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.805 Vali Acc: 0.825 Test Loss: 0.805 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.7700042724609375
Epoch: 15, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7294864654541016
Epoch: 16, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9690947532653809
Epoch: 17, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.948089599609375
Epoch: 18, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.740 Vali Acc: 0.575 Test Loss: 0.740 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8387162685394287
Epoch: 19, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.9023170471191406
Epoch: 20, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8564407825469971
Epoch: 21, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.8868303298950195
Epoch: 22, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8616435527801514
Epoch: 23, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9253597259521484
Epoch: 24, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.929208517074585
Epoch: 25, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.7593028545379639
Epoch: 26, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.9174327850341797
Epoch: 27, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.9173078536987305
Epoch: 28, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.7433443069458008
Epoch: 29, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 0.670175313949585
Epoch: 30, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8682718276977539
Epoch: 31, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8768117427825928
Epoch: 32, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9535589218139648
Epoch: 33, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9106273651123047
Epoch: 34, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9920849800109863
Epoch: 35, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.9829199314117432
Epoch: 36, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8533930778503418
Epoch: 37, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.9537360668182373
Epoch: 38, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.8607048988342285
Epoch: 39, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.9852910041809082
Epoch: 40, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7930097579956055
Epoch: 41, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.8361222743988037
Epoch: 42, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.726071834564209
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9421584606170654
Epoch: 44, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9400880336761475
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9933831691741943
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0347373485565186
Epoch: 47, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8539977073669434
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.778709888458252
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8516936302185059
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8923213481903076
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.8324992656707764
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1529640
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4676661491394043
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.8795406818389893
Epoch: 2, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.372 Vali Acc: 0.325 Test Loss: 1.372 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.7140002250671387
Epoch: 3, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.373 Vali Acc: 0.275 Test Loss: 1.373 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8675267696380615
Epoch: 4, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.399 Vali Acc: 0.325 Test Loss: 1.399 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7839913368225098
Epoch: 5, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.415 Vali Acc: 0.300 Test Loss: 1.415 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1804041862487793
Epoch: 6, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.8389551639556885
Epoch: 7, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.221 Vali Acc: 0.575 Test Loss: 1.221 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.9471495151519775
Epoch: 8, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.158 Vali Acc: 0.575 Test Loss: 1.158 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.8555505275726318
Epoch: 9, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.7648313045501709
Epoch: 10, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.8502662181854248
Epoch: 11, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7414200305938721
Epoch: 12, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.7871246337890625
Epoch: 13, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.920 Vali Acc: 0.650 Test Loss: 0.920 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7383913993835449
Epoch: 14, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.886 Vali Acc: 0.600 Test Loss: 0.886 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8332805633544922
Epoch: 15, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.7515742778778076
Epoch: 16, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.8558375835418701
Epoch: 17, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.8861868381500244
Epoch: 18, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.699 Vali Acc: 0.800 Test Loss: 0.699 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.921860933303833
Epoch: 19, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.9372806549072266
Epoch: 20, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 0.8351469039916992
Epoch: 21, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8626844882965088
Epoch: 22, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.711493968963623
Epoch: 23, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.8277597427368164
Epoch: 24, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.7680046558380127
Epoch: 25, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.8831009864807129
Epoch: 26, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0208256244659424
Epoch: 27, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2046892642974854
Epoch: 28, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9473934173583984
Epoch: 29, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0300910472869873
Epoch: 30, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.389 Vali Acc: 0.825 Test Loss: 0.389 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8054513931274414
Epoch: 31, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.358 Vali Acc: 0.825 Test Loss: 0.358 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8497438430786133
Epoch: 32, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7779209613800049
Epoch: 33, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9680147171020508
Epoch: 34, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8724291324615479
Epoch: 35, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1527848
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2601585388183594
Epoch: 1, Steps: 3 | Train Loss: 1.634 Vali Loss: 1.391 Vali Acc: 0.250 Test Loss: 1.391 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9779243469238281
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.384 Vali Acc: 0.200 Test Loss: 1.384 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9424242973327637
Epoch: 3, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.9638621807098389
Epoch: 4, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.393 Vali Acc: 0.275 Test Loss: 1.393 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9972693920135498
Epoch: 5, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.358 Vali Acc: 0.375 Test Loss: 1.358 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.8944401741027832
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.313 Vali Acc: 0.275 Test Loss: 1.313 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8730669021606445
Epoch: 7, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.271 Vali Acc: 0.375 Test Loss: 1.271 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.973743200302124
Epoch: 8, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.209 Vali Acc: 0.475 Test Loss: 1.209 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.8291816711425781
Epoch: 9, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 0.9337842464447021
Epoch: 10, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.121 Vali Acc: 0.575 Test Loss: 1.121 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8125588893890381
Epoch: 11, Steps: 3 | Train Loss: 0.862 Vali Loss: 1.080 Vali Acc: 0.725 Test Loss: 1.080 Test Acc: 0.725
Validation loss decreased (-0.599988 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.8184370994567871
Epoch: 12, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9096736907958984
Epoch: 13, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.841583251953125
Epoch: 14, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.8843016624450684
Epoch: 15, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.7043499946594238
Epoch: 16, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 0.7787463665008545
Epoch: 17, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.7982070446014404
Epoch: 18, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.7534513473510742
Epoch: 19, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9171733856201172
Epoch: 20, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7923927307128906
Epoch: 21, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.6576409339904785
Epoch: 22, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.7862710952758789
Epoch: 23, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.7671411037445068
Epoch: 24, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8696038722991943
Epoch: 25, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.8496658802032471
Epoch: 26, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8354425430297852
Epoch: 27, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6979990005493164
Epoch: 28, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.7907867431640625
Epoch: 29, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9546844959259033
Epoch: 30, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.7854313850402832
Epoch: 31, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.8697428703308105
Epoch: 32, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.8032331466674805
Epoch: 33, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7935864925384521
Epoch: 34, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8828623294830322
Epoch: 35, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7969462871551514
Epoch: 36, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9129254817962646
Epoch: 37, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8708477020263672
Epoch: 38, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.9604306221008301
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.7187755107879639
Epoch: 40, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9093470573425293
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7824225425720215
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8844144344329834
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0409140586853027
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7718489170074463
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8752825260162354
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0623326301574707
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.159635066986084
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.8538930416107178
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9537539482116699
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1543262004852295
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9306783676147461
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7966310977935791
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7866263389587402
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8590168952941895
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.703277587890625
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7595696449279785
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9722661972045898
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1526056
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3355484008789062
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.490 Vali Acc: 0.125 Test Loss: 1.490 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 0.8887369632720947
Epoch: 2, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (-0.124985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.8260056972503662
Epoch: 3, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.383 Vali Acc: 0.250 Test Loss: 1.383 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8702883720397949
Epoch: 4, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.362 Vali Acc: 0.175 Test Loss: 1.362 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.025458812713623
Epoch: 5, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8305392265319824
Epoch: 6, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.263 Vali Acc: 0.425 Test Loss: 1.263 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.9146533012390137
Epoch: 7, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.7377498149871826
Epoch: 8, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.8143136501312256
Epoch: 9, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.150 Vali Acc: 0.525 Test Loss: 1.150 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.9091358184814453
Epoch: 10, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.058 Vali Acc: 0.575 Test Loss: 1.058 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.8812680244445801
Epoch: 11, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.999 Vali Acc: 0.650 Test Loss: 0.999 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.9497747421264648
Epoch: 12, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.971 Vali Acc: 0.575 Test Loss: 0.971 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7856359481811523
Epoch: 13, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.8327960968017578
Epoch: 14, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.880 Vali Acc: 0.625 Test Loss: 0.880 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9725415706634521
Epoch: 15, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.7445070743560791
Epoch: 16, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 17 cost time: 0.7792654037475586
Epoch: 17, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.682 Vali Acc: 0.875 Test Loss: 0.682 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.6409444808959961
Epoch: 18, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.692582368850708
Epoch: 19, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7740185260772705
Epoch: 20, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.808790922164917
Epoch: 21, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8241844177246094
Epoch: 22, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.699190616607666
Epoch: 23, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.7087407112121582
Epoch: 24, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0112037658691406
Epoch: 25, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7494564056396484
Epoch: 26, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.7707326412200928
Epoch: 27, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7553551197052002
Epoch: 28, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.8694643974304199
Epoch: 29, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.7827861309051514
Epoch: 30, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.849311113357544
Epoch: 31, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7799530029296875
Epoch: 32, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.9599699974060059
Epoch: 33, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.9132976531982422
Epoch: 34, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1105058193206787
Epoch: 35, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8703887462615967
Epoch: 36, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8252542018890381
Epoch: 37, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.1895947456359863
Epoch: 38, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.825493574142456
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.892045259475708
Epoch: 40, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8806419372558594
Epoch: 41, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7713701725006104
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8794417381286621
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8890008926391602
Epoch: 44, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0116548538208008
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9349088668823242
Epoch: 46, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8321871757507324
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.8665680885314941
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.8343410491943359
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8501071929931641
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8352658748626709
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0501337051391602
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8232653141021729
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8639786243438721
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8320748805999756
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9607210159301758
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.8911547660827637
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8211631774902344
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1524264
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.042416572570801
Epoch: 1, Steps: 3 | Train Loss: 1.607 Vali Loss: 1.529 Vali Acc: 0.175 Test Loss: 1.529 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.8029031753540039
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.464 Vali Acc: 0.200 Test Loss: 1.464 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.9292535781860352
Epoch: 3, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.929915189743042
Epoch: 4, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.359 Vali Acc: 0.300 Test Loss: 1.359 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.8625965118408203
Epoch: 5, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.025200366973877
Epoch: 6, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.7469954490661621
Epoch: 7, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.277 Vali Acc: 0.325 Test Loss: 1.277 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1105711460113525
Epoch: 8, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.8244988918304443
Epoch: 9, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.8140683174133301
Epoch: 10, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.147 Vali Acc: 0.575 Test Loss: 1.147 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 1.1561596393585205
Epoch: 11, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.8920729160308838
Epoch: 12, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9286575317382812
Epoch: 13, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.022 Vali Acc: 0.725 Test Loss: 1.022 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.9754786491394043
Epoch: 14, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.9990377426147461
Epoch: 15, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.927 Vali Acc: 0.775 Test Loss: 0.927 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 0.7573761940002441
Epoch: 16, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.9186158180236816
Epoch: 17, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.825 Vali Acc: 0.650 Test Loss: 0.825 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9779114723205566
Epoch: 18, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 19 cost time: 0.9488744735717773
Epoch: 19, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.8008415699005127
Epoch: 20, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.668 Vali Acc: 0.800 Test Loss: 0.668 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3258697986602783
Epoch: 21, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.647 Vali Acc: 0.700 Test Loss: 0.647 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9072790145874023
Epoch: 22, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.7599337100982666
Epoch: 23, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.7420353889465332
Epoch: 24, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9807286262512207
Epoch: 25, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9753820896148682
Epoch: 26, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8997519016265869
Epoch: 27, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.462 Vali Acc: 0.825 Test Loss: 0.462 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0894794464111328
Epoch: 28, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9564223289489746
Epoch: 29, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9692130088806152
Epoch: 30, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0402145385742188
Epoch: 31, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8974931240081787
Epoch: 32, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.864337682723999
Epoch: 33, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.7696969509124756
Epoch: 34, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.9624707698822021
Epoch: 35, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 0.8603191375732422
Epoch: 36, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.864323616027832
Epoch: 37, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1141064167022705
Epoch: 38, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.007309913635254
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9404680728912354
Epoch: 40, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 0.8142647743225098
Epoch: 41, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 0.9179625511169434
Epoch: 42, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 0.8636946678161621
Epoch: 43, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8839817047119141
Epoch: 44, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8490245342254639
Epoch: 45, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8904798030853271
Epoch: 46, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.88616943359375
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 0.879990816116333
Epoch: 48, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 49 cost time: 1.0020406246185303
Epoch: 49, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.909127950668335
Epoch: 50, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9113671779632568
Epoch: 51, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9956321716308594
Epoch: 52, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0138287544250488
Epoch: 53, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9481892585754395
Epoch: 54, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9314830303192139
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.959604024887085
Epoch: 56, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7607238292694092
Epoch: 57, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.0404465198516846
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.1140878200531006
Epoch: 59, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 0.890190839767456
Epoch: 60, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 0.907874584197998
Epoch: 61, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 62 cost time: 0.8621096611022949
Epoch: 62, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 63 cost time: 0.9648187160491943
Epoch: 63, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 64 cost time: 0.8309648036956787
Epoch: 64, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 65 cost time: 0.9791598320007324
Epoch: 65, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9874589443206787
Epoch: 66, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.983593225479126
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.92340087890625
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.223484754562378
Epoch: 69, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.0032289028167725
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.062864065170288
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 72 cost time: 1.2082083225250244
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 73 cost time: 1.0771846771240234
Epoch: 73, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 74 cost time: 0.9412164688110352
Epoch: 74, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8580210208892822
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.92112135887146
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7474355697631836
Epoch: 77, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.951939582824707
Epoch: 78, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.0392754077911377
Epoch: 79, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.816439151763916
Epoch: 80, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.9139773845672607
Epoch: 81, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.9765188694000244
Epoch: 82, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.820120096206665
Epoch: 83, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1015400
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.958540678024292
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.7035961151123047
Epoch: 2, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.411 Vali Acc: 0.350 Test Loss: 1.411 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7801382541656494
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.8185887336730957
Epoch: 4, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.340 Vali Acc: 0.450 Test Loss: 1.340 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.8920598030090332
Epoch: 5, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.309 Vali Acc: 0.525 Test Loss: 1.309 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.807342529296875
Epoch: 6, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.274 Vali Acc: 0.375 Test Loss: 1.274 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7259047031402588
Epoch: 7, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.243 Vali Acc: 0.350 Test Loss: 1.243 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9223301410675049
Epoch: 8, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.229 Vali Acc: 0.350 Test Loss: 1.229 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1270596981048584
Epoch: 9, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.0643284320831299
Epoch: 10, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.7946426868438721
Epoch: 11, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.0663633346557617
Epoch: 12, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.015 Vali Acc: 0.650 Test Loss: 1.015 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.6668565273284912
Epoch: 13, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.6667277812957764
Epoch: 14, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.6685154438018799
Epoch: 15, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 0.6672704219818115
Epoch: 16, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7159590721130371
Epoch: 17, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.794 Vali Acc: 0.700 Test Loss: 0.794 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7370829582214355
Epoch: 18, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.716 Vali Acc: 0.725 Test Loss: 0.716 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7746715545654297
Epoch: 19, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8486955165863037
Epoch: 20, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 1.074051856994629
Epoch: 21, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.621 Vali Acc: 0.625 Test Loss: 0.621 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.970149040222168
Epoch: 22, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.605 Vali Acc: 0.625 Test Loss: 0.605 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8661725521087646
Epoch: 23, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 1.1245477199554443
Epoch: 24, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.480 Vali Acc: 0.825 Test Loss: 0.480 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8824284076690674
Epoch: 25, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.440 Vali Acc: 0.825 Test Loss: 0.440 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8189973831176758
Epoch: 26, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.7791216373443604
Epoch: 27, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7351875305175781
Epoch: 28, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.462 Vali Acc: 0.825 Test Loss: 0.462 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8034837245941162
Epoch: 29, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0279221534729004
Epoch: 30, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7910747528076172
Epoch: 31, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9651789665222168
Epoch: 32, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.7848055362701416
Epoch: 33, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.927814245223999
Epoch: 34, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 0.9464747905731201
Epoch: 35, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7840006351470947
Epoch: 36, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7424836158752441
Epoch: 37, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9837443828582764
Epoch: 38, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8498749732971191
Epoch: 39, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9090940952301025
Epoch: 40, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7418227195739746
Epoch: 41, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.743661642074585
Epoch: 42, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9164950847625732
Epoch: 43, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9186904430389404
Epoch: 44, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1014504
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2730164527893066
Epoch: 1, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.350 Vali Acc: 0.350 Test Loss: 1.350 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.0532314777374268
Epoch: 2, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9172546863555908
Epoch: 3, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.8035242557525635
Epoch: 4, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.7711648941040039
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.7502455711364746
Epoch: 6, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.219 Vali Acc: 0.525 Test Loss: 1.219 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.8536443710327148
Epoch: 7, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.180 Vali Acc: 0.550 Test Loss: 1.180 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.8788888454437256
Epoch: 8, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.155 Vali Acc: 0.575 Test Loss: 1.155 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.7247047424316406
Epoch: 9, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.132 Vali Acc: 0.525 Test Loss: 1.132 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.76363205909729
Epoch: 10, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.106 Vali Acc: 0.475 Test Loss: 1.106 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8832600116729736
Epoch: 11, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
Validation loss decreased (-0.574988 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.8219411373138428
Epoch: 12, Steps: 3 | Train Loss: 0.862 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7722864151000977
Epoch: 13, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7665035724639893
Epoch: 14, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8950901031494141
Epoch: 15, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.875 Vali Acc: 0.825 Test Loss: 0.875 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 0.7494945526123047
Epoch: 16, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.839 Vali Acc: 0.675 Test Loss: 0.839 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7749888896942139
Epoch: 17, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.7214803695678711
Epoch: 18, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.896155834197998
Epoch: 19, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.733196496963501
Epoch: 20, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.590 Vali Acc: 0.925 Test Loss: 0.590 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.7871565818786621
Epoch: 21, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.560 Vali Acc: 0.900 Test Loss: 0.560 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8359768390655518
Epoch: 22, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8771300315856934
Epoch: 23, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.840925931930542
Epoch: 24, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.8193509578704834
Epoch: 25, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9454562664031982
Epoch: 26, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9969770908355713
Epoch: 27, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7403640747070312
Epoch: 28, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8313553333282471
Epoch: 29, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1412644386291504
Epoch: 30, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.7679405212402344
Epoch: 31, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9828445911407471
Epoch: 32, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9519643783569336
Epoch: 33, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.085310697555542
Epoch: 34, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.8136477470397949
Epoch: 35, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.8747029304504395
Epoch: 36, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.9195113182067871
Epoch: 37, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.6938192844390869
Epoch: 38, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.738804817199707
Epoch: 39, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8066623210906982
Epoch: 40, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0527303218841553
Epoch: 41, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0888774394989014
Epoch: 42, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.901007890701294
Epoch: 43, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8330163955688477
Epoch: 44, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.852189302444458
Epoch: 45, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8355696201324463
Epoch: 46, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6677379608154297
Epoch: 47, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1013608
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.904104709625244
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.449 Vali Acc: 0.375 Test Loss: 1.449 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8703374862670898
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.438 Vali Acc: 0.325 Test Loss: 1.438 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8063297271728516
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.432 Vali Acc: 0.250 Test Loss: 1.432 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8299746513366699
Epoch: 4, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.436 Vali Acc: 0.350 Test Loss: 1.436 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7860960960388184
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.440 Vali Acc: 0.375 Test Loss: 1.440 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.822028398513794
Epoch: 6, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.426 Vali Acc: 0.425 Test Loss: 1.426 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.8324711322784424
Epoch: 7, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.370 Vali Acc: 0.525 Test Loss: 1.370 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524986).  Saving model ...
Epoch: 8 cost time: 0.8213968276977539
Epoch: 8, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8239579200744629
Epoch: 9, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.265 Vali Acc: 0.375 Test Loss: 1.265 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1115694046020508
Epoch: 10, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.215 Vali Acc: 0.475 Test Loss: 1.215 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9590649604797363
Epoch: 11, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.837235689163208
Epoch: 12, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9037353992462158
Epoch: 13, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.075 Vali Acc: 0.575 Test Loss: 1.075 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 1.0428314208984375
Epoch: 14, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.9993894100189209
Epoch: 15, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.599990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.8277072906494141
Epoch: 16, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.933 Vali Acc: 0.725 Test Loss: 0.933 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8574068546295166
Epoch: 17, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.7546262741088867
Epoch: 18, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.788 Vali Acc: 0.725 Test Loss: 0.788 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9134640693664551
Epoch: 19, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.745 Vali Acc: 0.725 Test Loss: 0.745 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8456282615661621
Epoch: 20, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.7743721008300781
Epoch: 21, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.7682514190673828
Epoch: 22, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.7537369728088379
Epoch: 23, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.742945671081543
Epoch: 24, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.8065006732940674
Epoch: 25, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7645285129547119
Epoch: 26, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7721073627471924
Epoch: 27, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6944289207458496
Epoch: 28, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9218833446502686
Epoch: 29, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7169091701507568
Epoch: 30, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8580362796783447
Epoch: 31, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9999117851257324
Epoch: 32, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8979907035827637
Epoch: 33, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7907383441925049
Epoch: 34, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1012712
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6129050254821777
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.407 Vali Acc: 0.225 Test Loss: 1.407 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.9281070232391357
Epoch: 2, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.381 Vali Acc: 0.225 Test Loss: 1.381 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.1287140846252441
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.9460394382476807
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.7695286273956299
Epoch: 5, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.347 Vali Acc: 0.425 Test Loss: 1.347 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.808525800704956
Epoch: 6, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7979800701141357
Epoch: 7, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.286 Vali Acc: 0.425 Test Loss: 1.286 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6788485050201416
Epoch: 8, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.248 Vali Acc: 0.575 Test Loss: 1.248 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 1.0002946853637695
Epoch: 9, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.206 Vali Acc: 0.650 Test Loss: 1.206 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.9145517349243164
Epoch: 10, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.156 Vali Acc: 0.650 Test Loss: 1.156 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.8140320777893066
Epoch: 11, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.8534481525421143
Epoch: 12, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8383100032806396
Epoch: 13, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9493265151977539
Epoch: 14, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.029 Vali Acc: 0.575 Test Loss: 1.029 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0552799701690674
Epoch: 15, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 1.1368885040283203
Epoch: 16, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.941 Vali Acc: 0.700 Test Loss: 0.941 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8015291690826416
Epoch: 17, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.7343547344207764
Epoch: 18, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.808 Vali Acc: 0.800 Test Loss: 0.808 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.7201509475708008
Epoch: 19, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7188904285430908
Epoch: 20, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.8492832183837891
Epoch: 21, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 0.8990094661712646
Epoch: 22, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 0.8869867324829102
Epoch: 23, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 0.8863668441772461
Epoch: 24, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.8668842315673828
Epoch: 25, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.8496513366699219
Epoch: 26, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9285392761230469
Epoch: 27, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8159134387969971
Epoch: 28, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.7852094173431396
Epoch: 29, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8545708656311035
Epoch: 30, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7442891597747803
Epoch: 31, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8122756481170654
Epoch: 32, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0309538841247559
Epoch: 33, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.782573938369751
Epoch: 34, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.466 Vali Acc: 0.675 Test Loss: 0.466 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9034287929534912
Epoch: 35, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0744776725769043
Epoch: 36, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.930539608001709
Epoch: 37, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8134186267852783
Epoch: 38, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9746091365814209
Epoch: 39, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7340114116668701
Epoch: 40, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.6678569316864014
Epoch: 41, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.931572675704956
Epoch: 42, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9641830921173096
Epoch: 43, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.8141789436340332
Epoch: 44, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.7687222957611084
Epoch: 45, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8381824493408203
Epoch: 46, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7291419506072998
Epoch: 47, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7542223930358887
Epoch: 48, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9462270736694336
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8537325859069824
Epoch: 50, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8484570980072021
Epoch: 51, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.893653154373169
Epoch: 52, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7377719879150391
Epoch: 53, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.8209171295166016
Epoch: 54, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 685160
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4583849906921387
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.367 Vali Acc: 0.425 Test Loss: 1.367 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.7993700504302979
Epoch: 2, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9422125816345215
Epoch: 3, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7765140533447266
Epoch: 4, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.332 Vali Acc: 0.275 Test Loss: 1.332 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9069297313690186
Epoch: 5, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.305 Vali Acc: 0.450 Test Loss: 1.305 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.213829755783081
Epoch: 6, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 1.1444082260131836
Epoch: 7, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.237 Vali Acc: 0.450 Test Loss: 1.237 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.9563813209533691
Epoch: 8, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.8501791954040527
Epoch: 9, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.826732873916626
Epoch: 10, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.147 Vali Acc: 0.525 Test Loss: 1.147 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.938831090927124
Epoch: 11, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 1.013218641281128
Epoch: 12, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.9289379119873047
Epoch: 13, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.9330086708068848
Epoch: 14, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.978 Vali Acc: 0.650 Test Loss: 0.978 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9997892379760742
Epoch: 15, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.933 Vali Acc: 0.775 Test Loss: 0.933 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 0.9801537990570068
Epoch: 16, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.887 Vali Acc: 0.850 Test Loss: 0.887 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 1.0081472396850586
Epoch: 17, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.857 Vali Acc: 0.850 Test Loss: 0.857 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 0.7505471706390381
Epoch: 18, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.816 Vali Acc: 0.875 Test Loss: 0.816 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.8152351379394531
Epoch: 19, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9682109355926514
Epoch: 20, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8232223987579346
Epoch: 21, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.657 Vali Acc: 0.900 Test Loss: 0.657 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.8646330833435059
Epoch: 22, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.0791001319885254
Epoch: 23, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.9691431522369385
Epoch: 24, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9095070362091064
Epoch: 25, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.539 Vali Acc: 0.800 Test Loss: 0.539 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8720417022705078
Epoch: 26, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.9796397686004639
Epoch: 27, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.7999026775360107
Epoch: 28, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.9552218914031982
Epoch: 29, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0531365871429443
Epoch: 30, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9156219959259033
Epoch: 31, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.845278263092041
Epoch: 32, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0138537883758545
Epoch: 33, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8400201797485352
Epoch: 34, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8241126537322998
Epoch: 35, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8067605495452881
Epoch: 36, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8295989036560059
Epoch: 37, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.907940149307251
Epoch: 38, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8503930568695068
Epoch: 39, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8217041492462158
Epoch: 40, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9351160526275635
Epoch: 41, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 684264
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9501376152038574
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.469 Vali Acc: 0.275 Test Loss: 1.469 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.8262841701507568
Epoch: 2, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.423 Vali Acc: 0.325 Test Loss: 1.423 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.9207615852355957
Epoch: 3, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.392 Vali Acc: 0.275 Test Loss: 1.392 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9588806629180908
Epoch: 4, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.365 Vali Acc: 0.425 Test Loss: 1.365 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.7318062782287598
Epoch: 5, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.349 Vali Acc: 0.425 Test Loss: 1.349 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.8048925399780273
Epoch: 6, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8297064304351807
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.295 Vali Acc: 0.425 Test Loss: 1.295 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.9428751468658447
Epoch: 8, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.8177981376647949
Epoch: 9, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.223 Vali Acc: 0.375 Test Loss: 1.223 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8764331340789795
Epoch: 10, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.186 Vali Acc: 0.450 Test Loss: 1.186 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.170062780380249
Epoch: 11, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.124 Vali Acc: 0.575 Test Loss: 1.124 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.9136433601379395
Epoch: 12, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.0507299900054932
Epoch: 13, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.048 Vali Acc: 0.575 Test Loss: 1.048 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9403164386749268
Epoch: 14, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.9579968452453613
Epoch: 15, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8606448173522949
Epoch: 16, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1805367469787598
Epoch: 17, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.7179250717163086
Epoch: 18, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.810 Vali Acc: 0.825 Test Loss: 0.810 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.8699769973754883
Epoch: 19, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.773 Vali Acc: 0.825 Test Loss: 0.773 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.8946652412414551
Epoch: 20, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.729 Vali Acc: 0.825 Test Loss: 0.729 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.761542797088623
Epoch: 21, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.691 Vali Acc: 0.900 Test Loss: 0.691 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.8327794075012207
Epoch: 22, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.7524380683898926
Epoch: 23, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8642756938934326
Epoch: 24, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8128550052642822
Epoch: 25, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.7569513320922852
Epoch: 26, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0563099384307861
Epoch: 27, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.8402681350708008
Epoch: 28, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1655707359313965
Epoch: 29, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8977398872375488
Epoch: 30, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9558546543121338
Epoch: 31, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9962301254272461
Epoch: 32, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.9675655364990234
Epoch: 33, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.0280601978302002
Epoch: 34, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7982611656188965
Epoch: 35, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9321897029876709
Epoch: 36, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6035823822021484
Epoch: 37, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9351582527160645
Epoch: 38, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0885157585144043
Epoch: 39, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0925116539001465
Epoch: 40, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0193817615509033
Epoch: 41, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2780113220214844
Epoch: 42, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2277448177337646
Epoch: 43, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 683368
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4973866939544678
Epoch: 1, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.385 Vali Acc: 0.375 Test Loss: 1.385 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8918263912200928
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8781299591064453
Epoch: 3, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.366 Vali Acc: 0.250 Test Loss: 1.366 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9771251678466797
Epoch: 4, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.1551823616027832
Epoch: 5, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.982429027557373
Epoch: 6, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.878838300704956
Epoch: 7, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.733863115310669
Epoch: 8, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.8438918590545654
Epoch: 9, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.9042675495147705
Epoch: 10, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.197 Vali Acc: 0.425 Test Loss: 1.197 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9263298511505127
Epoch: 11, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.178 Vali Acc: 0.475 Test Loss: 1.178 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.7998828887939453
Epoch: 12, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.166 Vali Acc: 0.450 Test Loss: 1.166 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0402889251708984
Epoch: 13, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.114 Vali Acc: 0.425 Test Loss: 1.114 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7880208492279053
Epoch: 14, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.060 Vali Acc: 0.450 Test Loss: 1.060 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9603209495544434
Epoch: 15, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.036 Vali Acc: 0.550 Test Loss: 1.036 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549990).  Saving model ...
Epoch: 16 cost time: 0.9177565574645996
Epoch: 16, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.990 Vali Acc: 0.550 Test Loss: 0.990 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 17 cost time: 0.8669264316558838
Epoch: 17, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
Validation loss decreased (-0.549990 --> -0.649991).  Saving model ...
Epoch: 18 cost time: 0.7916765213012695
Epoch: 18, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
Validation loss decreased (-0.649991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.7984554767608643
Epoch: 19, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.861 Vali Acc: 0.675 Test Loss: 0.861 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8660316467285156
Epoch: 20, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.8949520587921143
Epoch: 21, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7484540939331055
Epoch: 22, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.701 Vali Acc: 0.725 Test Loss: 0.701 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.719595193862915
Epoch: 23, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.7942447662353516
Epoch: 24, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.633 Vali Acc: 0.650 Test Loss: 0.633 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8149411678314209
Epoch: 25, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.7579116821289062
Epoch: 26, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.833294153213501
Epoch: 27, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9498462677001953
Epoch: 28, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.8081562519073486
Epoch: 29, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.044158697128296
Epoch: 30, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.743868350982666
Epoch: 31, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.919731616973877
Epoch: 32, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9003157615661621
Epoch: 33, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.879542350769043
Epoch: 34, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 1.0918784141540527
Epoch: 35, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.156604528427124
Epoch: 36, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.9947400093078613
Epoch: 37, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.881737470626831
Epoch: 38, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8582065105438232
Epoch: 39, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7338616847991943
Epoch: 40, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7962753772735596
Epoch: 41, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7825698852539062
Epoch: 42, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0310475826263428
Epoch: 43, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.930206298828125
Epoch: 44, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.80879807472229
Epoch: 45, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0072600841522217
Epoch: 46, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.022613763809204
Epoch: 47, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0363028049468994
Epoch: 48, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9211335182189941
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.911876916885376
Epoch: 50, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 0.7009949684143066
Epoch: 51, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 1.0425989627838135
Epoch: 52, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 0.8759253025054932
Epoch: 53, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 54 cost time: 1.153749942779541
Epoch: 54, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 55 cost time: 0.8358142375946045
Epoch: 55, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 56 cost time: 0.9814541339874268
Epoch: 56, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 0.8254609107971191
Epoch: 57, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 1.0977234840393066
Epoch: 58, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9727089405059814
Epoch: 59, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.063467025756836
Epoch: 60, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9404420852661133
Epoch: 61, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9362473487854004
Epoch: 62, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8935375213623047
Epoch: 63, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8674919605255127
Epoch: 64, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.827406644821167
Epoch: 65, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8851909637451172
Epoch: 66, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9416756629943848
Epoch: 67, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 682472
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.818131923675537
Epoch: 1, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.407 Vali Acc: 0.325 Test Loss: 1.407 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.0569770336151123
Epoch: 2, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.403 Vali Acc: 0.375 Test Loss: 1.403 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.9463732242584229
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.406 Vali Acc: 0.275 Test Loss: 1.406 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8451108932495117
Epoch: 4, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.404 Vali Acc: 0.325 Test Loss: 1.404 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8985881805419922
Epoch: 5, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.397 Vali Acc: 0.325 Test Loss: 1.397 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1237468719482422
Epoch: 6, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.7356061935424805
Epoch: 7, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.9032812118530273
Epoch: 8, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.9584176540374756
Epoch: 9, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.7329466342926025
Epoch: 10, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 1.0311884880065918
Epoch: 11, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.213 Vali Acc: 0.600 Test Loss: 1.213 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.7421472072601318
Epoch: 12, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9978158473968506
Epoch: 13, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.9168891906738281
Epoch: 14, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.846566915512085
Epoch: 15, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.9816915988922119
Epoch: 16, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9736535549163818
Epoch: 17, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.8105347156524658
Epoch: 18, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.973 Vali Acc: 0.675 Test Loss: 0.973 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9731874465942383
Epoch: 19, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 0.836885929107666
Epoch: 20, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9566526412963867
Epoch: 21, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.155745029449463
Epoch: 22, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.795 Vali Acc: 0.725 Test Loss: 0.795 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.981825590133667
Epoch: 23, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 0.9417018890380859
Epoch: 24, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 0.9977126121520996
Epoch: 25, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 1.0488379001617432
Epoch: 26, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 1.0175800323486328
Epoch: 27, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0190708637237549
Epoch: 28, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 1.0772290229797363
Epoch: 29, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.9792063236236572
Epoch: 30, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.9831845760345459
Epoch: 31, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9662742614746094
Epoch: 32, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0567405223846436
Epoch: 33, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9773616790771484
Epoch: 34, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.8405249118804932
Epoch: 35, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.9025583267211914
Epoch: 36, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.940072774887085
Epoch: 37, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9263341426849365
Epoch: 38, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3066599369049072
Epoch: 39, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0422711372375488
Epoch: 40, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.953005313873291
Epoch: 41, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9103343486785889
Epoch: 42, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.895883321762085
Epoch: 43, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0274169445037842
Epoch: 44, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6764307022094727
Epoch: 45, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 520040
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5750961303710938
Epoch: 1, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.425 Vali Acc: 0.350 Test Loss: 1.425 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.1493515968322754
Epoch: 2, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.387 Vali Acc: 0.275 Test Loss: 1.387 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8121647834777832
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.8103599548339844
Epoch: 4, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.379 Vali Acc: 0.300 Test Loss: 1.379 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1131339073181152
Epoch: 5, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.396 Vali Acc: 0.225 Test Loss: 1.396 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8307442665100098
Epoch: 6, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9841022491455078
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8413982391357422
Epoch: 8, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.299 Vali Acc: 0.275 Test Loss: 1.299 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7499637603759766
Epoch: 9, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.7311673164367676
Epoch: 10, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.212 Vali Acc: 0.525 Test Loss: 1.212 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.6912341117858887
Epoch: 11, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.656653642654419
Epoch: 12, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.134 Vali Acc: 0.575 Test Loss: 1.134 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.7364287376403809
Epoch: 13, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 0.5849273204803467
Epoch: 14, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.8156917095184326
Epoch: 15, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.695673942565918
Epoch: 16, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.994 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.8925788402557373
Epoch: 17, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.942 Vali Acc: 0.825 Test Loss: 0.942 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 0.7300252914428711
Epoch: 18, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.884 Vali Acc: 0.850 Test Loss: 0.884 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 0.8345367908477783
Epoch: 19, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.840 Vali Acc: 0.900 Test Loss: 0.840 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.7743861675262451
Epoch: 20, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7891800403594971
Epoch: 21, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9092404842376709
Epoch: 22, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.754 Vali Acc: 0.750 Test Loss: 0.754 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9204530715942383
Epoch: 23, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.692 Vali Acc: 0.900 Test Loss: 0.692 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.8554801940917969
Epoch: 24, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.633 Vali Acc: 0.900 Test Loss: 0.633 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.9029817581176758
Epoch: 25, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.586 Vali Acc: 0.800 Test Loss: 0.586 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.946779727935791
Epoch: 26, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.045929193496704
Epoch: 27, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9213657379150391
Epoch: 28, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.1654818058013916
Epoch: 29, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9125194549560547
Epoch: 30, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1453261375427246
Epoch: 31, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9242029190063477
Epoch: 32, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8255019187927246
Epoch: 33, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.962803840637207
Epoch: 34, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1403725147247314
Epoch: 35, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.927656888961792
Epoch: 36, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.992455005645752
Epoch: 37, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9950141906738281
Epoch: 38, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8856263160705566
Epoch: 39, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7665309906005859
Epoch: 40, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9426560401916504
Epoch: 41, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0237767696380615
Epoch: 42, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 0.8039166927337646
Epoch: 43, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.9702730178833008
Epoch: 44, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.159928560256958
Epoch: 45, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9258782863616943
Epoch: 46, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.218945026397705
Epoch: 47, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2225186824798584
Epoch: 48, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.835878849029541
Epoch: 49, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0459396839141846
Epoch: 50, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0269646644592285
Epoch: 51, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.0796356201171875
Epoch: 52, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.9890611171722412
Epoch: 53, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 519144
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.56532621383667
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.402 Vali Acc: 0.275 Test Loss: 1.402 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8138291835784912
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.0497500896453857
Epoch: 3, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.379 Vali Acc: 0.275 Test Loss: 1.379 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.806647777557373
Epoch: 4, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.7514755725860596
Epoch: 5, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.355 Vali Acc: 0.325 Test Loss: 1.355 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.8105990886688232
Epoch: 6, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.8661997318267822
Epoch: 7, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.9546778202056885
Epoch: 8, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.7978434562683105
Epoch: 9, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.251 Vali Acc: 0.550 Test Loss: 1.251 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 1.0088417530059814
Epoch: 10, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.225 Vali Acc: 0.425 Test Loss: 1.225 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4131782054901123
Epoch: 11, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.184 Vali Acc: 0.450 Test Loss: 1.184 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8358075618743896
Epoch: 12, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.156 Vali Acc: 0.575 Test Loss: 1.156 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.7592458724975586
Epoch: 13, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.8738248348236084
Epoch: 14, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.9145572185516357
Epoch: 15, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.9733786582946777
Epoch: 16, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.025 Vali Acc: 0.650 Test Loss: 1.025 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3426547050476074
Epoch: 17, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.970 Vali Acc: 0.650 Test Loss: 0.970 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9642834663391113
Epoch: 18, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 0.921865701675415
Epoch: 19, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.8664655685424805
Epoch: 20, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.877 Vali Acc: 0.575 Test Loss: 0.877 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.897254467010498
Epoch: 21, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.842 Vali Acc: 0.575 Test Loss: 0.842 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4077174663543701
Epoch: 22, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0094914436340332
Epoch: 23, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.7489626407623291
Epoch: 24, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.704 Vali Acc: 0.725 Test Loss: 0.704 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7636668682098389
Epoch: 25, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.682 Vali Acc: 0.725 Test Loss: 0.682 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9156115055084229
Epoch: 26, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.651 Vali Acc: 0.825 Test Loss: 0.651 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.9565920829772949
Epoch: 27, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.8418846130371094
Epoch: 28, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.9615442752838135
Epoch: 29, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 1.1432344913482666
Epoch: 30, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 1.103144884109497
Epoch: 31, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.101494312286377
Epoch: 32, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.158080816268921
Epoch: 33, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1273603439331055
Epoch: 34, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 1.0512440204620361
Epoch: 35, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0735278129577637
Epoch: 36, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.9332554340362549
Epoch: 37, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 1.110807180404663
Epoch: 38, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2216212749481201
Epoch: 39, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3347656726837158
Epoch: 40, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 0.9359724521636963
Epoch: 41, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.02842116355896
Epoch: 42, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 1.0698633193969727
Epoch: 43, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 1.111726999282837
Epoch: 44, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 1.156193733215332
Epoch: 45, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 1.0857679843902588
Epoch: 46, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.9368693828582764
Epoch: 47, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1823971271514893
Epoch: 48, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 49 cost time: 1.0543482303619385
Epoch: 49, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 50 cost time: 1.0205132961273193
Epoch: 50, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.207550287246704
Epoch: 51, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1731595993041992
Epoch: 52, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1323864459991455
Epoch: 53, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1326980590820312
Epoch: 54, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1104423999786377
Epoch: 55, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0077338218688965
Epoch: 56, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.3630805015563965
Epoch: 57, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2229399681091309
Epoch: 58, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.099872350692749
Epoch: 59, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 518248
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.288708209991455
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.464 Vali Acc: 0.200 Test Loss: 1.464 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.8294610977172852
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.420 Vali Acc: 0.250 Test Loss: 1.420 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.9558606147766113
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.391 Vali Acc: 0.225 Test Loss: 1.391 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.797997236251831
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.361 Vali Acc: 0.325 Test Loss: 1.361 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.7645127773284912
Epoch: 5, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.7422938346862793
Epoch: 6, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.7418003082275391
Epoch: 7, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6851654052734375
Epoch: 8, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.295 Vali Acc: 0.525 Test Loss: 1.295 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.8550155162811279
Epoch: 9, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8681819438934326
Epoch: 10, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.238 Vali Acc: 0.550 Test Loss: 1.238 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.7628738880157471
Epoch: 11, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.201 Vali Acc: 0.625 Test Loss: 1.201 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 12 cost time: 0.738642692565918
Epoch: 12, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 0.7831120491027832
Epoch: 13, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.7177932262420654
Epoch: 14, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.116 Vali Acc: 0.550 Test Loss: 1.116 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8546934127807617
Epoch: 15, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.8516864776611328
Epoch: 16, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.7670450210571289
Epoch: 17, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 0.8378198146820068
Epoch: 18, Steps: 3 | Train Loss: 0.780 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8638534545898438
Epoch: 19, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 20 cost time: 0.8311977386474609
Epoch: 20, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.869 Vali Acc: 0.800 Test Loss: 0.869 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.8510875701904297
Epoch: 21, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 0.7221393585205078
Epoch: 22, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.805 Vali Acc: 0.850 Test Loss: 0.805 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 0.8092679977416992
Epoch: 23, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.88016676902771
Epoch: 24, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8023824691772461
Epoch: 25, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.686 Vali Acc: 0.825 Test Loss: 0.686 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8422181606292725
Epoch: 26, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7693274021148682
Epoch: 27, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9600868225097656
Epoch: 28, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.598 Vali Acc: 0.825 Test Loss: 0.598 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8841359615325928
Epoch: 29, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8362293243408203
Epoch: 30, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0051639080047607
Epoch: 31, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.009366512298584
Epoch: 32, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.7682652473449707
Epoch: 33, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.479 Vali Acc: 0.800 Test Loss: 0.479 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0734477043151855
Epoch: 34, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 0.7868235111236572
Epoch: 35, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 36 cost time: 0.7710955142974854
Epoch: 36, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.9477920532226562
Epoch: 37, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.7994518280029297
Epoch: 38, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8950684070587158
Epoch: 39, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8112344741821289
Epoch: 40, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 0.8271975517272949
Epoch: 41, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 0.8111319541931152
Epoch: 42, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 0.8273262977600098
Epoch: 43, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 0.877361536026001
Epoch: 44, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 0.7642734050750732
Epoch: 45, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 1.0122153759002686
Epoch: 46, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.865114688873291
Epoch: 47, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 0.9531972408294678
Epoch: 48, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.014782428741455
Epoch: 49, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 50 cost time: 0.9351248741149902
Epoch: 50, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 51 cost time: 0.7544331550598145
Epoch: 51, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 52 cost time: 0.8031220436096191
Epoch: 52, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 53 cost time: 0.7587642669677734
Epoch: 53, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9707651138305664
Epoch: 54, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 0.9777772426605225
Epoch: 55, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9684135913848877
Epoch: 56, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0189762115478516
Epoch: 57, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9337806701660156
Epoch: 58, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0748851299285889
Epoch: 59, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.930743932723999
Epoch: 60, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9423356056213379
Epoch: 61, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8459122180938721
Epoch: 62, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8058793544769287
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 64 cost time: 1.0088753700256348
Epoch: 64, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 65 cost time: 0.9298274517059326
Epoch: 65, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 66 cost time: 1.1412010192871094
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2931461334228516
Epoch: 67, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7707571983337402
Epoch: 68, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8859889507293701
Epoch: 69, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.7952020168304443
Epoch: 70, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7801320552825928
Epoch: 71, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 72 cost time: 0.8303177356719971
Epoch: 72, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0753166675567627
Epoch: 73, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.8510780334472656
Epoch: 74, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9317765235900879
Epoch: 75, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.8635179996490479
Epoch: 76, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.9684977531433105
Epoch: 77, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.7889993190765381
Epoch: 78, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.9666945934295654
Epoch: 79, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.8612256050109863
Epoch: 80, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.9012093544006348
Epoch: 81, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 517352
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.955519199371338
Epoch: 1, Steps: 3 | Train Loss: 1.661 Vali Loss: 1.509 Vali Acc: 0.225 Test Loss: 1.509 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.8910703659057617
Epoch: 2, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.440 Vali Acc: 0.325 Test Loss: 1.440 Test Acc: 0.325
Validation loss decreased (-0.224985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.8095529079437256
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.391 Vali Acc: 0.350 Test Loss: 1.391 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.9866085052490234
Epoch: 4, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.8331270217895508
Epoch: 5, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.335 Vali Acc: 0.450 Test Loss: 1.335 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.7683770656585693
Epoch: 6, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.327 Vali Acc: 0.350 Test Loss: 1.327 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0232768058776855
Epoch: 7, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.036163568496704
Epoch: 8, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.271 Vali Acc: 0.575 Test Loss: 1.271 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 1.1287062168121338
Epoch: 9, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1867671012878418
Epoch: 10, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.250 Vali Acc: 0.425 Test Loss: 1.250 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9644615650177002
Epoch: 11, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.242 Vali Acc: 0.425 Test Loss: 1.242 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0254466533660889
Epoch: 12, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.235616683959961
Epoch: 13, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7917726039886475
Epoch: 14, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.127 Vali Acc: 0.675 Test Loss: 1.127 Test Acc: 0.675
Validation loss decreased (-0.574987 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.8786554336547852
Epoch: 15, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.089 Vali Acc: 0.700 Test Loss: 1.089 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.975085973739624
Epoch: 16, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.040 Vali Acc: 0.750 Test Loss: 1.040 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.8185992240905762
Epoch: 17, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.220120906829834
Epoch: 18, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.963 Vali Acc: 0.775 Test Loss: 0.963 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.9354298114776611
Epoch: 19, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.923 Vali Acc: 0.725 Test Loss: 0.923 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8417675495147705
Epoch: 20, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9630937576293945
Epoch: 21, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.9648690223693848
Epoch: 22, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9205465316772461
Epoch: 23, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0774624347686768
Epoch: 24, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9331676959991455
Epoch: 25, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.067392110824585
Epoch: 26, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.8564226627349854
Epoch: 27, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.650 Vali Acc: 0.675 Test Loss: 0.650 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.089005708694458
Epoch: 28, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.0442488193511963
Epoch: 29, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9797108173370361
Epoch: 30, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3658092021942139
Epoch: 31, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 1.068105936050415
Epoch: 32, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 33 cost time: 0.8446781635284424
Epoch: 33, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 0.8254411220550537
Epoch: 34, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 0.9804284572601318
Epoch: 35, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 0.7225961685180664
Epoch: 36, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.8691408634185791
Epoch: 37, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.8768777847290039
Epoch: 38, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.891402006149292
Epoch: 39, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.8050272464752197
Epoch: 40, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 0.8682558536529541
Epoch: 41, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0103418827056885
Epoch: 42, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 0.9758286476135254
Epoch: 43, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 1.1514503955841064
Epoch: 44, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 0.857532262802124
Epoch: 45, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 0.8972454071044922
Epoch: 46, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.7988994121551514
Epoch: 47, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 0.860588788986206
Epoch: 48, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 0.8873686790466309
Epoch: 49, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.8818197250366211
Epoch: 50, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8522937297821045
Epoch: 51, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0856513977050781
Epoch: 52, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 0.8525350093841553
Epoch: 53, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 0.8800806999206543
Epoch: 54, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8210902214050293
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7418529987335205
Epoch: 56, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.8808741569519043
Epoch: 57, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.8284409046173096
Epoch: 58, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 0.7733371257781982
Epoch: 59, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0285084247589111
Epoch: 60, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9524452686309814
Epoch: 61, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2496075630187988
Epoch: 62, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0279011726379395
Epoch: 63, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0267055034637451
Epoch: 64, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2919666767120361
Epoch: 65, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 66 cost time: 0.8335163593292236
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.7392134666442871
Epoch: 67, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.7825591564178467
Epoch: 68, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.8329222202301025
Epoch: 69, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0523569583892822
Epoch: 70, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.9687659740447998
Epoch: 71, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.9972975254058838
Epoch: 72, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8260619640350342
Epoch: 73, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.8336515426635742
Epoch: 74, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.7749037742614746
Epoch: 75, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.0376806259155273
Epoch: 76, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.8650569915771484
Epoch: 77, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.9859414100646973
Epoch: 78, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 437480
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6872189044952393
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.431 Vali Acc: 0.300 Test Loss: 1.431 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7684426307678223
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9374544620513916
Epoch: 3, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.409 Vali Acc: 0.275 Test Loss: 1.409 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.055917739868164
Epoch: 4, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.8909335136413574
Epoch: 5, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8742828369140625
Epoch: 6, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.7796955108642578
Epoch: 7, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.346 Vali Acc: 0.450 Test Loss: 1.346 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.8111777305603027
Epoch: 8, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.315 Vali Acc: 0.475 Test Loss: 1.315 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.7878777980804443
Epoch: 9, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.287 Vali Acc: 0.475 Test Loss: 1.287 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.8460841178894043
Epoch: 10, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.253 Vali Acc: 0.725 Test Loss: 1.253 Test Acc: 0.725
Validation loss decreased (-0.474987 --> -0.724987).  Saving model ...
Epoch: 11 cost time: 0.7758746147155762
Epoch: 11, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.224 Vali Acc: 0.650 Test Loss: 1.224 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8665440082550049
Epoch: 12, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.195 Vali Acc: 0.725 Test Loss: 1.195 Test Acc: 0.725
Validation loss decreased (-0.724987 --> -0.724988).  Saving model ...
Epoch: 13 cost time: 0.7123844623565674
Epoch: 13, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8087260723114014
Epoch: 14, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9557709693908691
Epoch: 15, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.713151216506958
Epoch: 16, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7950894832611084
Epoch: 17, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.042860507965088
Epoch: 18, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.8124985694885254
Epoch: 19, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.936 Vali Acc: 0.775 Test Loss: 0.936 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.8195669651031494
Epoch: 20, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.913 Vali Acc: 0.800 Test Loss: 0.913 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.885465145111084
Epoch: 21, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.7966587543487549
Epoch: 22, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.7971673011779785
Epoch: 23, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7532572746276855
Epoch: 24, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 0.9043495655059814
Epoch: 25, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8477237224578857
Epoch: 26, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.6882243156433105
Epoch: 27, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.7463812828063965
Epoch: 28, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.832557201385498
Epoch: 29, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9003832340240479
Epoch: 30, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8537764549255371
Epoch: 31, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.8385295867919922
Epoch: 32, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8732519149780273
Epoch: 33, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1595606803894043
Epoch: 34, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 0.9108963012695312
Epoch: 35, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9988512992858887
Epoch: 36, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.8166930675506592
Epoch: 37, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.9101057052612305
Epoch: 38, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.035085678100586
Epoch: 39, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.8666350841522217
Epoch: 40, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.8203637599945068
Epoch: 41, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9443213939666748
Epoch: 42, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9232456684112549
Epoch: 43, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8627719879150391
Epoch: 44, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9182016849517822
Epoch: 45, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7938070297241211
Epoch: 46, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7884120941162109
Epoch: 47, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8234045505523682
Epoch: 48, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.097642421722412
Epoch: 49, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1368474960327148
Epoch: 50, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 436584
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.472233772277832
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.559 Vali Acc: 0.300 Test Loss: 1.559 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.9172143936157227
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.500 Vali Acc: 0.300 Test Loss: 1.500 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.9111781120300293
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.449 Vali Acc: 0.250 Test Loss: 1.449 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8036255836486816
Epoch: 4, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.394 Vali Acc: 0.300 Test Loss: 1.394 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.874741792678833
Epoch: 5, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.362 Vali Acc: 0.225 Test Loss: 1.362 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8524587154388428
Epoch: 6, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.332 Vali Acc: 0.300 Test Loss: 1.332 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 7 cost time: 0.744011640548706
Epoch: 7, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.314 Vali Acc: 0.475 Test Loss: 1.314 Test Acc: 0.475
Validation loss decreased (-0.299987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.8018743991851807
Epoch: 8, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.9571382999420166
Epoch: 9, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.76204514503479
Epoch: 10, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.8035159111022949
Epoch: 11, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.919365406036377
Epoch: 12, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.248 Vali Acc: 0.600 Test Loss: 1.248 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.8863930702209473
Epoch: 13, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.227 Vali Acc: 0.550 Test Loss: 1.227 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9187886714935303
Epoch: 14, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.181 Vali Acc: 0.525 Test Loss: 1.181 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8691720962524414
Epoch: 15, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.129 Vali Acc: 0.700 Test Loss: 1.129 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.7738983631134033
Epoch: 16, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.086 Vali Acc: 0.775 Test Loss: 1.086 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 17 cost time: 0.9592525959014893
Epoch: 17, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.038 Vali Acc: 0.750 Test Loss: 1.038 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.891190767288208
Epoch: 18, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8761250972747803
Epoch: 19, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 0.8272225856781006
Epoch: 20, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8268778324127197
Epoch: 21, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.9305636882781982
Epoch: 22, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.862 Vali Acc: 0.800 Test Loss: 0.862 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.9481661319732666
Epoch: 23, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0049974918365479
Epoch: 24, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 0.908768892288208
Epoch: 25, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.732 Vali Acc: 0.875 Test Loss: 0.732 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.7813930511474609
Epoch: 26, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8785574436187744
Epoch: 27, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8119451999664307
Epoch: 28, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9151239395141602
Epoch: 29, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0940742492675781
Epoch: 30, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9266886711120605
Epoch: 31, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0459139347076416
Epoch: 32, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8604018688201904
Epoch: 33, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8212704658508301
Epoch: 34, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 0.8209669589996338
Epoch: 35, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9199838638305664
Epoch: 36, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 37 cost time: 1.018416404724121
Epoch: 37, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0228073596954346
Epoch: 38, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 0.9046804904937744
Epoch: 39, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 0.9322106838226318
Epoch: 40, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 41 cost time: 1.0613219738006592
Epoch: 41, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 0.9470822811126709
Epoch: 42, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.8843653202056885
Epoch: 43, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 44 cost time: 1.2269287109375
Epoch: 44, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 45 cost time: 0.9169921875
Epoch: 45, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 46 cost time: 1.1653902530670166
Epoch: 46, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 1.2174110412597656
Epoch: 47, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 48 cost time: 0.8295986652374268
Epoch: 48, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9347395896911621
Epoch: 49, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8359827995300293
Epoch: 50, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8288002014160156
Epoch: 51, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7468385696411133
Epoch: 52, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8836667537689209
Epoch: 53, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0253939628601074
Epoch: 54, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 0.8165440559387207
Epoch: 55, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 56 cost time: 0.8663182258605957
Epoch: 56, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 57 cost time: 0.8624868392944336
Epoch: 57, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 58 cost time: 0.9436266422271729
Epoch: 58, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 59 cost time: 1.000232458114624
Epoch: 59, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9478428363800049
Epoch: 60, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8322005271911621
Epoch: 61, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.997084379196167
Epoch: 62, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 0.9273924827575684
Epoch: 63, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9257636070251465
Epoch: 64, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 65 cost time: 0.8098647594451904
Epoch: 65, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 66 cost time: 0.9191372394561768
Epoch: 66, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.828942060470581
Epoch: 67, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.5012283325195312
Epoch: 68, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9636249542236328
Epoch: 69, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9333720207214355
Epoch: 70, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.9514884948730469
Epoch: 71, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8400306701660156
Epoch: 72, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.839885950088501
Epoch: 73, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2365307807922363
Epoch: 74, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.995474100112915
Epoch: 75, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 435688
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4952378273010254
Epoch: 1, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.467 Vali Acc: 0.250 Test Loss: 1.467 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.9694359302520752
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.415 Vali Acc: 0.225 Test Loss: 1.415 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.017946720123291
Epoch: 3, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.7976887226104736
Epoch: 4, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.365 Vali Acc: 0.425 Test Loss: 1.365 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.8846888542175293
Epoch: 5, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 6 cost time: 0.9298546314239502
Epoch: 6, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9785339832305908
Epoch: 7, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8741903305053711
Epoch: 8, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9526252746582031
Epoch: 9, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.8739149570465088
Epoch: 10, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.9202995300292969
Epoch: 11, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.177 Vali Acc: 0.675 Test Loss: 1.177 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.7742972373962402
Epoch: 12, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.161 Vali Acc: 0.575 Test Loss: 1.161 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9461688995361328
Epoch: 13, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.136 Vali Acc: 0.575 Test Loss: 1.136 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0822322368621826
Epoch: 14, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.115 Vali Acc: 0.725 Test Loss: 1.115 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.958437442779541
Epoch: 15, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.093 Vali Acc: 0.550 Test Loss: 1.093 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9767396450042725
Epoch: 16, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.032 Vali Acc: 0.675 Test Loss: 1.032 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9814574718475342
Epoch: 17, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.980 Vali Acc: 0.825 Test Loss: 0.980 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 18 cost time: 0.6866838932037354
Epoch: 18, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 1.0117690563201904
Epoch: 19, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.872 Vali Acc: 0.825 Test Loss: 0.872 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8474612236022949
Epoch: 20, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9420254230499268
Epoch: 21, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 0.9944343566894531
Epoch: 22, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.744 Vali Acc: 0.875 Test Loss: 0.744 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 0.9251415729522705
Epoch: 23, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.9356825351715088
Epoch: 24, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.670 Vali Acc: 0.775 Test Loss: 0.670 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9700536727905273
Epoch: 25, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9211485385894775
Epoch: 26, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9707708358764648
Epoch: 27, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9758186340332031
Epoch: 28, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0602805614471436
Epoch: 29, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 1.0716135501861572
Epoch: 30, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 31 cost time: 0.9749453067779541
Epoch: 31, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.7889680862426758
Epoch: 32, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.7983195781707764
Epoch: 33, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6990306377410889
Epoch: 34, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.9933912754058838
Epoch: 35, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9331624507904053
Epoch: 36, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8382720947265625
Epoch: 37, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9363405704498291
Epoch: 38, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.820854902267456
Epoch: 39, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9469971656799316
Epoch: 40, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9713268280029297
Epoch: 41, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0382881164550781
Epoch: 42, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0804176330566406
Epoch: 43, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0060088634490967
Epoch: 44, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 434792
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9570794105529785
Epoch: 1, Steps: 3 | Train Loss: 1.498 Vali Loss: 1.615 Vali Acc: 0.325 Test Loss: 1.615 Test Acc: 0.325
Validation loss decreased (inf --> -0.324984).  Saving model ...
Epoch: 2 cost time: 0.8929064273834229
Epoch: 2, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.559 Vali Acc: 0.375 Test Loss: 1.559 Test Acc: 0.375
Validation loss decreased (-0.324984 --> -0.374984).  Saving model ...
Epoch: 3 cost time: 0.8468961715698242
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.510 Vali Acc: 0.350 Test Loss: 1.510 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8854875564575195
Epoch: 4, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.467 Vali Acc: 0.300 Test Loss: 1.467 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8352420330047607
Epoch: 5, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.431 Vali Acc: 0.375 Test Loss: 1.431 Test Acc: 0.375
Validation loss decreased (-0.374984 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.7886013984680176
Epoch: 6, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.405 Vali Acc: 0.325 Test Loss: 1.405 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7946047782897949
Epoch: 7, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.8515467643737793
Epoch: 8, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.8899731636047363
Epoch: 9, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.7223939895629883
Epoch: 10, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.313 Vali Acc: 0.625 Test Loss: 1.313 Test Acc: 0.625
Validation loss decreased (-0.374987 --> -0.624987).  Saving model ...
Epoch: 11 cost time: 0.9650683403015137
Epoch: 11, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.308 Vali Acc: 0.575 Test Loss: 1.308 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9977586269378662
Epoch: 12, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.292 Vali Acc: 0.575 Test Loss: 1.292 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7919986248016357
Epoch: 13, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.243 Vali Acc: 0.700 Test Loss: 1.243 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699988).  Saving model ...
Epoch: 14 cost time: 0.8030698299407959
Epoch: 14, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.199 Vali Acc: 0.675 Test Loss: 1.199 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7990982532501221
Epoch: 15, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8093903064727783
Epoch: 16, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.119 Vali Acc: 0.700 Test Loss: 1.119 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 0.8416857719421387
Epoch: 17, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 0.7219328880310059
Epoch: 18, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.9312248229980469
Epoch: 19, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.7157940864562988
Epoch: 20, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.9052531719207764
Epoch: 21, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 0.7441504001617432
Epoch: 22, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.881 Vali Acc: 0.700 Test Loss: 0.881 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9106297492980957
Epoch: 23, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.839 Vali Acc: 0.725 Test Loss: 0.839 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 24 cost time: 1.1138389110565186
Epoch: 24, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 25 cost time: 0.7812371253967285
Epoch: 25, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 0.7736601829528809
Epoch: 26, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.754 Vali Acc: 0.725 Test Loss: 0.754 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7890398502349854
Epoch: 27, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 0.7088003158569336
Epoch: 28, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
Validation loss decreased (-0.749993 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 0.8114266395568848
Epoch: 29, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 0.831458568572998
Epoch: 30, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9334628582000732
Epoch: 31, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.7783472537994385
Epoch: 32, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9250979423522949
Epoch: 33, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 0.9746565818786621
Epoch: 34, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 0.8435471057891846
Epoch: 35, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7256777286529541
Epoch: 36, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 37 cost time: 0.7582206726074219
Epoch: 37, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 38 cost time: 0.7921996116638184
Epoch: 38, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 0.939197301864624
Epoch: 39, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 0.8974339962005615
Epoch: 40, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 1.356562852859497
Epoch: 41, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 42 cost time: 0.8562211990356445
Epoch: 42, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.866400957107544
Epoch: 43, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9945485591888428
Epoch: 44, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9427750110626221
Epoch: 45, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7926058769226074
Epoch: 46, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0794951915740967
Epoch: 47, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 48 cost time: 0.904057502746582
Epoch: 48, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.007934331893921
Epoch: 49, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9891452789306641
Epoch: 50, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1612327098846436
Epoch: 51, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9623539447784424
Epoch: 52, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 0.8227975368499756
Epoch: 53, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8821268081665039
Epoch: 54, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 0.7348220348358154
Epoch: 55, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.990027904510498
Epoch: 56, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7776718139648438
Epoch: 57, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 0.7820382118225098
Epoch: 58, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9022667407989502
Epoch: 59, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9890129566192627
Epoch: 60, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9492511749267578
Epoch: 61, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8546490669250488
Epoch: 62, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9803295135498047
Epoch: 63, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9034214019775391
Epoch: 64, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 65 cost time: 0.8984999656677246
Epoch: 65, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 66 cost time: 0.9040381908416748
Epoch: 66, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 67 cost time: 0.8065352439880371
Epoch: 67, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.09645676612854
Epoch: 68, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.002495527267456
Epoch: 69, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8804125785827637
Epoch: 70, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9945237636566162
Epoch: 71, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 72 cost time: 0.9078729152679443
Epoch: 72, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 73 cost time: 0.9055702686309814
Epoch: 73, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7627735137939453
Epoch: 74, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7278988361358643
Epoch: 75, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9034140110015869
Epoch: 76, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 77 cost time: 0.933804988861084
Epoch: 77, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 78 cost time: 0.8820786476135254
Epoch: 78, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7781429290771484
Epoch: 79, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7927532196044922
Epoch: 80, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.9261691570281982
Epoch: 81, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.9321696758270264
Epoch: 82, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.9280831813812256
Epoch: 83, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 84 cost time: 0.9003896713256836
Epoch: 84, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.9694721698760986
Epoch: 85, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.6709349155426025
Epoch: 86, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8900389671325684
Epoch: 87, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.7400088310241699
Epoch: 88, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.7576816082000732
Epoch: 89, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.8190810680389404
Epoch: 90, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.755657434463501
Epoch: 91, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.8156900405883789
Epoch: 92, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.8252754211425781
Epoch: 93, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 428360
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.371974468231201
Epoch: 1, Steps: 3 | Train Loss: 1.614 Vali Loss: 1.527 Vali Acc: 0.175 Test Loss: 1.527 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.6829559803009033
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.464 Vali Acc: 0.225 Test Loss: 1.464 Test Acc: 0.225
Validation loss decreased (-0.174985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.7664916515350342
Epoch: 3, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.409 Vali Acc: 0.300 Test Loss: 1.409 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.7896966934204102
Epoch: 4, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.9589395523071289
Epoch: 5, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.319 Vali Acc: 0.300 Test Loss: 1.319 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6775915622711182
Epoch: 6, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.310 Vali Acc: 0.475 Test Loss: 1.310 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.8382425308227539
Epoch: 7, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.324 Vali Acc: 0.350 Test Loss: 1.324 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6629574298858643
Epoch: 8, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.327 Vali Acc: 0.325 Test Loss: 1.327 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8274197578430176
Epoch: 9, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8609521389007568
Epoch: 10, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.250 Vali Acc: 0.425 Test Loss: 1.250 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9219229221343994
Epoch: 11, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.210 Vali Acc: 0.575 Test Loss: 1.210 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.9448940753936768
Epoch: 12, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.7300519943237305
Epoch: 13, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.7545061111450195
Epoch: 14, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.8722999095916748
Epoch: 15, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.092 Vali Acc: 0.650 Test Loss: 1.092 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9328861236572266
Epoch: 16, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.073 Vali Acc: 0.650 Test Loss: 1.073 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9274826049804688
Epoch: 17, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.046 Vali Acc: 0.625 Test Loss: 1.046 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5966181755065918
Epoch: 18, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.985647439956665
Epoch: 19, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 1.0534024238586426
Epoch: 20, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.7055385112762451
Epoch: 21, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.9091982841491699
Epoch: 22, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 0.7853584289550781
Epoch: 23, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 1.06302809715271
Epoch: 24, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 25 cost time: 0.722726583480835
Epoch: 25, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 0.9766180515289307
Epoch: 26, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 27 cost time: 0.7915551662445068
Epoch: 27, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.8724148273468018
Epoch: 28, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 29 cost time: 0.7318003177642822
Epoch: 29, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.9236845970153809
Epoch: 30, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.7819528579711914
Epoch: 31, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 32 cost time: 0.7910201549530029
Epoch: 32, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7430107593536377
Epoch: 33, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.847254753112793
Epoch: 34, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8149962425231934
Epoch: 35, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7822115421295166
Epoch: 36, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.486 Vali Acc: 0.825 Test Loss: 0.486 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9048452377319336
Epoch: 37, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 38 cost time: 0.9048929214477539
Epoch: 38, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9102637767791748
Epoch: 39, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 0.8215963840484619
Epoch: 40, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8332338333129883
Epoch: 41, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0142426490783691
Epoch: 42, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8046708106994629
Epoch: 43, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8421282768249512
Epoch: 44, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0500240325927734
Epoch: 45, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9043533802032471
Epoch: 46, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9232513904571533
Epoch: 47, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8209407329559326
Epoch: 48, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7937486171722412
Epoch: 49, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 427912
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1216325759887695
Epoch: 1, Steps: 3 | Train Loss: 1.607 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.8238492012023926
Epoch: 2, Steps: 3 | Train Loss: 1.541 Vali Loss: 1.438 Vali Acc: 0.200 Test Loss: 1.438 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.8387045860290527
Epoch: 3, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.410 Vali Acc: 0.175 Test Loss: 1.410 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9890048503875732
Epoch: 4, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.8960247039794922
Epoch: 5, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.377 Vali Acc: 0.350 Test Loss: 1.377 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.726041316986084
Epoch: 6, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.8315320014953613
Epoch: 7, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9719207286834717
Epoch: 8, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.329 Vali Acc: 0.300 Test Loss: 1.329 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8500304222106934
Epoch: 9, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.310 Vali Acc: 0.325 Test Loss: 1.310 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.239840030670166
Epoch: 10, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.300 Vali Acc: 0.325 Test Loss: 1.300 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.137866735458374
Epoch: 11, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.267 Vali Acc: 0.350 Test Loss: 1.267 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8136382102966309
Epoch: 12, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.241 Vali Acc: 0.375 Test Loss: 1.241 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374988).  Saving model ...
Epoch: 13 cost time: 0.8893229961395264
Epoch: 13, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.194 Vali Acc: 0.475 Test Loss: 1.194 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.9117450714111328
Epoch: 14, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.140 Vali Acc: 0.525 Test Loss: 1.140 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 15 cost time: 0.8451268672943115
Epoch: 15, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
Validation loss decreased (-0.524989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.760991096496582
Epoch: 16, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8607571125030518
Epoch: 17, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9470772743225098
Epoch: 18, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9013266563415527
Epoch: 19, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.985 Vali Acc: 0.650 Test Loss: 0.985 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.099337100982666
Epoch: 20, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.960 Vali Acc: 0.575 Test Loss: 0.960 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9387845993041992
Epoch: 21, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.913 Vali Acc: 0.625 Test Loss: 0.913 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8268325328826904
Epoch: 22, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 0.8644108772277832
Epoch: 23, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 0.8420121669769287
Epoch: 24, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.813 Vali Acc: 0.700 Test Loss: 0.813 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 25 cost time: 0.9006388187408447
Epoch: 25, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 0.8414192199707031
Epoch: 26, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 27 cost time: 0.8867905139923096
Epoch: 27, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 28 cost time: 0.8572537899017334
Epoch: 28, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.774993 --> -0.874993).  Saving model ...
Epoch: 29 cost time: 1.0410034656524658
Epoch: 29, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 1.0398080348968506
Epoch: 30, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 31 cost time: 0.72951340675354
Epoch: 31, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.9404616355895996
Epoch: 32, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.8555686473846436
Epoch: 33, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 1.0147860050201416
Epoch: 34, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 1.0271823406219482
Epoch: 35, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.9161050319671631
Epoch: 36, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.147338628768921
Epoch: 37, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9088637828826904
Epoch: 38, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9262192249298096
Epoch: 39, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.0917541980743408
Epoch: 40, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.9021360874176025
Epoch: 41, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.9783642292022705
Epoch: 42, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 1.0231389999389648
Epoch: 43, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.9521875381469727
Epoch: 44, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.9898927211761475
Epoch: 45, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.1677327156066895
Epoch: 46, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.8213353157043457
Epoch: 47, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1158740520477295
Epoch: 48, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 1.0129072666168213
Epoch: 49, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 1.013916015625
Epoch: 50, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 51 cost time: 0.869999885559082
Epoch: 51, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.263596534729004
Epoch: 52, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 53 cost time: 0.8176562786102295
Epoch: 53, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 54 cost time: 0.851041316986084
Epoch: 54, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 55 cost time: 0.9122779369354248
Epoch: 55, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 56 cost time: 0.8021152019500732
Epoch: 56, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 57 cost time: 0.9051203727722168
Epoch: 57, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1147160530090332
Epoch: 58, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 59 cost time: 0.9900665283203125
Epoch: 59, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.9315943717956543
Epoch: 60, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 1.0069549083709717
Epoch: 61, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8839328289031982
Epoch: 62, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.065467357635498
Epoch: 63, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.2930548191070557
Epoch: 64, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.925462007522583
Epoch: 65, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9640498161315918
Epoch: 66, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.0483145713806152
Epoch: 67, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.0102691650390625
Epoch: 68, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 69 cost time: 1.0575225353240967
Epoch: 69, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9677720069885254
Epoch: 70, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.9664289951324463
Epoch: 71, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.9401700496673584
Epoch: 72, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8374900817871094
Epoch: 73, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.8119802474975586
Epoch: 74, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.0886220932006836
Epoch: 75, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 76 cost time: 0.9247262477874756
Epoch: 76, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 77 cost time: 0.8467376232147217
Epoch: 77, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0584254264831543
Epoch: 78, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9572441577911377
Epoch: 79, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.0106196403503418
Epoch: 80, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 81 cost time: 0.8027961254119873
Epoch: 81, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 82 cost time: 0.8838543891906738
Epoch: 82, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 83 cost time: 0.768101692199707
Epoch: 83, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 84 cost time: 0.7855958938598633
Epoch: 84, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 85 cost time: 0.9071671962738037
Epoch: 85, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8654313087463379
Epoch: 86, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.9899730682373047
Epoch: 87, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.8736038208007812
Epoch: 88, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.8979761600494385
Epoch: 89, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.2015585899353027
Epoch: 90, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.0104005336761475
Epoch: 91, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.8868286609649658
Epoch: 92, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 93 cost time: 1.0749855041503906
Epoch: 93, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 94 cost time: 0.7693576812744141
Epoch: 94, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.8952350616455078
Epoch: 95, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.0865979194641113
Epoch: 96, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.039747714996338
Epoch: 97, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.9262552261352539
Epoch: 98, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 1.2229351997375488
Epoch: 99, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 1.1301226615905762
Epoch: 100, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 427464
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7352826595306396
Epoch: 1, Steps: 3 | Train Loss: 1.684 Vali Loss: 1.587 Vali Acc: 0.225 Test Loss: 1.587 Test Acc: 0.225
Validation loss decreased (inf --> -0.224984).  Saving model ...
Epoch: 2 cost time: 0.8099367618560791
Epoch: 2, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.515 Vali Acc: 0.225 Test Loss: 1.515 Test Acc: 0.225
Validation loss decreased (-0.224984 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.8205540180206299
Epoch: 3, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.445 Vali Acc: 0.300 Test Loss: 1.445 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.7574214935302734
Epoch: 4, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.375 Vali Acc: 0.325 Test Loss: 1.375 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6854074001312256
Epoch: 5, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.333 Vali Acc: 0.300 Test Loss: 1.333 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7717149257659912
Epoch: 6, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.321 Vali Acc: 0.350 Test Loss: 1.321 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.9323720932006836
Epoch: 7, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.320 Vali Acc: 0.350 Test Loss: 1.320 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 0.9058089256286621
Epoch: 8, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.301 Vali Acc: 0.375 Test Loss: 1.301 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.8287901878356934
Epoch: 9, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.8498473167419434
Epoch: 10, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.255 Vali Acc: 0.525 Test Loss: 1.255 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.883918285369873
Epoch: 11, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.228 Vali Acc: 0.475 Test Loss: 1.228 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.780285120010376
Epoch: 12, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9659726619720459
Epoch: 13, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.148 Vali Acc: 0.575 Test Loss: 1.148 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 0.8158025741577148
Epoch: 14, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749989).  Saving model ...
Epoch: 15 cost time: 0.9329056739807129
Epoch: 15, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.054 Vali Acc: 0.675 Test Loss: 1.054 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9662244319915771
Epoch: 16, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9564774036407471
Epoch: 17, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9838869571685791
Epoch: 18, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.948 Vali Acc: 0.675 Test Loss: 0.948 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8913731575012207
Epoch: 19, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.926 Vali Acc: 0.625 Test Loss: 0.926 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7348487377166748
Epoch: 20, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.9251077175140381
Epoch: 21, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.9838142395019531
Epoch: 22, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.822 Vali Acc: 0.825 Test Loss: 0.822 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.886223316192627
Epoch: 23, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 0.8561661243438721
Epoch: 24, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9509773254394531
Epoch: 25, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.756 Vali Acc: 0.700 Test Loss: 0.756 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.081052303314209
Epoch: 26, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.8002636432647705
Epoch: 27, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 28 cost time: 0.8051092624664307
Epoch: 28, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.7260751724243164
Epoch: 29, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7511281967163086
Epoch: 30, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0750765800476074
Epoch: 31, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.573 Vali Acc: 0.800 Test Loss: 0.573 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9069278240203857
Epoch: 32, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9262051582336426
Epoch: 33, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9233016967773438
Epoch: 34, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 0.9226663112640381
Epoch: 35, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9903249740600586
Epoch: 36, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9742889404296875
Epoch: 37, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.501 Vali Acc: 0.800 Test Loss: 0.501 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.820115327835083
Epoch: 38, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7536451816558838
Epoch: 39, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6962661743164062
Epoch: 40, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8330190181732178
Epoch: 41, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7907505035400391
Epoch: 42, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8685250282287598
Epoch: 43, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7486414909362793
Epoch: 44, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 427016
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.729991912841797
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.459 Vali Acc: 0.100 Test Loss: 1.459 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 0.9600698947906494
Epoch: 2, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.443 Vali Acc: 0.075 Test Loss: 1.443 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9432368278503418
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.434 Vali Acc: 0.225 Test Loss: 1.434 Test Acc: 0.225
Validation loss decreased (-0.099985 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.8729395866394043
Epoch: 4, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.8082587718963623
Epoch: 5, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.439 Vali Acc: 0.275 Test Loss: 1.439 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1654484272003174
Epoch: 6, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.450 Vali Acc: 0.225 Test Loss: 1.450 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9161512851715088
Epoch: 7, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.464 Vali Acc: 0.250 Test Loss: 1.464 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8213753700256348
Epoch: 8, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.451 Vali Acc: 0.225 Test Loss: 1.451 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9390661716461182
Epoch: 9, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8430054187774658
Epoch: 10, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.391 Vali Acc: 0.300 Test Loss: 1.391 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 0.8841147422790527
Epoch: 11, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.358 Vali Acc: 0.375 Test Loss: 1.358 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 1.024359941482544
Epoch: 12, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.326 Vali Acc: 0.425 Test Loss: 1.326 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.8874545097351074
Epoch: 13, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.309 Vali Acc: 0.450 Test Loss: 1.309 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.7366900444030762
Epoch: 14, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 1.0116815567016602
Epoch: 15, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.266 Vali Acc: 0.450 Test Loss: 1.266 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9272663593292236
Epoch: 16, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.237 Vali Acc: 0.575 Test Loss: 1.237 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.9640140533447266
Epoch: 17, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.217 Vali Acc: 0.575 Test Loss: 1.217 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 1.2815828323364258
Epoch: 18, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.198 Vali Acc: 0.650 Test Loss: 1.198 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 19 cost time: 0.843327522277832
Epoch: 19, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.191 Vali Acc: 0.525 Test Loss: 1.191 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8824200630187988
Epoch: 20, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8920905590057373
Epoch: 21, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.134 Vali Acc: 0.550 Test Loss: 1.134 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.795846700668335
Epoch: 22, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.8333373069763184
Epoch: 23, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 24 cost time: 0.9931159019470215
Epoch: 24, Steps: 3 | Train Loss: 0.713 Vali Loss: 1.022 Vali Acc: 0.675 Test Loss: 1.022 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 1.3634674549102783
Epoch: 25, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.9280974864959717
Epoch: 26, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9350247383117676
Epoch: 27, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.938 Vali Acc: 0.775 Test Loss: 0.938 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 28 cost time: 0.9503793716430664
Epoch: 28, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 29 cost time: 0.9838733673095703
Epoch: 29, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 30 cost time: 0.8594753742218018
Epoch: 30, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 31 cost time: 0.9335901737213135
Epoch: 31, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 32 cost time: 1.0293078422546387
Epoch: 32, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 33 cost time: 0.971501350402832
Epoch: 33, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 1.133676290512085
Epoch: 34, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.730 Vali Acc: 0.825 Test Loss: 0.730 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 1.0620081424713135
Epoch: 35, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 36 cost time: 1.0068702697753906
Epoch: 36, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 37 cost time: 0.8561141490936279
Epoch: 37, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 38 cost time: 0.872572660446167
Epoch: 38, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 1.1471781730651855
Epoch: 39, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 0.9044239521026611
Epoch: 40, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 1.14371919631958
Epoch: 41, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.7869741916656494
Epoch: 42, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.584 Vali Acc: 0.875 Test Loss: 0.584 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.7693228721618652
Epoch: 43, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.8491637706756592
Epoch: 44, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.7970468997955322
Epoch: 45, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.550 Vali Acc: 0.875 Test Loss: 0.550 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 46 cost time: 1.083597183227539
Epoch: 46, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 47 cost time: 0.8226397037506104
Epoch: 47, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 0.8514485359191895
Epoch: 48, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.8982949256896973
Epoch: 49, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.912877082824707
Epoch: 50, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.8284695148468018
Epoch: 51, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 52 cost time: 0.9003643989562988
Epoch: 52, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 0.8889682292938232
Epoch: 53, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.7089474201202393
Epoch: 54, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8456530570983887
Epoch: 55, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.839374303817749
Epoch: 56, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8833882808685303
Epoch: 57, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.8706510066986084
Epoch: 58, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924995).  Saving model ...
Epoch: 59 cost time: 0.8683080673217773
Epoch: 59, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9358065128326416
Epoch: 60, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9634010791778564
Epoch: 61, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8167884349822998
Epoch: 62, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8636705875396729
Epoch: 63, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8884372711181641
Epoch: 64, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.7581748962402344
Epoch: 65, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 1.136742115020752
Epoch: 66, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 67 cost time: 1.0342767238616943
Epoch: 67, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0581772327423096
Epoch: 68, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 69 cost time: 0.9348790645599365
Epoch: 69, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0045223236083984
Epoch: 70, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8274497985839844
Epoch: 71, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.9629011154174805
Epoch: 72, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.9430391788482666
Epoch: 73, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 74 cost time: 0.8502063751220703
Epoch: 74, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 75 cost time: 0.7341232299804688
Epoch: 75, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 76 cost time: 1.1205079555511475
Epoch: 76, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 77 cost time: 1.0642609596252441
Epoch: 77, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 78 cost time: 0.8907136917114258
Epoch: 78, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 79 cost time: 1.0578486919403076
Epoch: 79, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.0620708465576172
Epoch: 80, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.1081852912902832
Epoch: 81, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9367184638977051
Epoch: 82, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.930354118347168
Epoch: 83, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.909050464630127
Epoch: 84, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.8259849548339844
Epoch: 85, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.9640097618103027
Epoch: 86, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.148836374282837
Epoch: 87, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.9700338840484619
Epoch: 88, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 261960
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7642273902893066
Epoch: 1, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.402 Vali Acc: 0.375 Test Loss: 1.402 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.7256062030792236
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.385 Vali Acc: 0.450 Test Loss: 1.385 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.7257866859436035
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.372 Vali Acc: 0.450 Test Loss: 1.372 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.9055964946746826
Epoch: 4, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8132634162902832
Epoch: 5, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.345 Vali Acc: 0.450 Test Loss: 1.345 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.9706635475158691
Epoch: 6, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.9060220718383789
Epoch: 7, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.321 Vali Acc: 0.475 Test Loss: 1.321 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.8561925888061523
Epoch: 8, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.310 Vali Acc: 0.475 Test Loss: 1.310 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.9287354946136475
Epoch: 9, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9176759719848633
Epoch: 10, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.9019455909729004
Epoch: 11, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.258 Vali Acc: 0.475 Test Loss: 1.258 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.9012515544891357
Epoch: 12, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.235 Vali Acc: 0.450 Test Loss: 1.235 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0254056453704834
Epoch: 13, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.213 Vali Acc: 0.475 Test Loss: 1.213 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.8383326530456543
Epoch: 14, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.0834934711456299
Epoch: 15, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 1.0257282257080078
Epoch: 16, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.9239177703857422
Epoch: 17, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.095 Vali Acc: 0.625 Test Loss: 1.095 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.9675567150115967
Epoch: 18, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.7746744155883789
Epoch: 19, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.038 Vali Acc: 0.575 Test Loss: 1.038 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0771963596343994
Epoch: 20, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 21 cost time: 0.8748886585235596
Epoch: 21, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724990).  Saving model ...
Epoch: 22 cost time: 0.7893433570861816
Epoch: 22, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9371070861816406
Epoch: 23, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.950 Vali Acc: 0.675 Test Loss: 0.950 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9846127033233643
Epoch: 24, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.8801670074462891
Epoch: 25, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.874 Vali Acc: 0.725 Test Loss: 0.874 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 26 cost time: 0.9678294658660889
Epoch: 26, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.826 Vali Acc: 0.800 Test Loss: 0.826 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 0.8229925632476807
Epoch: 27, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.8836629390716553
Epoch: 28, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 0.8439717292785645
Epoch: 29, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.8527736663818359
Epoch: 30, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.702 Vali Acc: 0.775 Test Loss: 0.702 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.946373462677002
Epoch: 31, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8767375946044922
Epoch: 32, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7596790790557861
Epoch: 33, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.637 Vali Acc: 0.925 Test Loss: 0.637 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 34 cost time: 0.8970425128936768
Epoch: 34, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9161396026611328
Epoch: 35, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.594 Vali Acc: 0.725 Test Loss: 0.594 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1104118824005127
Epoch: 36, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.547 Vali Acc: 0.925 Test Loss: 0.547 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.7940456867218018
Epoch: 37, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8465642929077148
Epoch: 38, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.913196325302124
Epoch: 39, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 40 cost time: 1.0138700008392334
Epoch: 40, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 41 cost time: 0.923058271408081
Epoch: 41, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8048551082611084
Epoch: 42, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9621713161468506
Epoch: 43, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8645725250244141
Epoch: 44, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.794137716293335
Epoch: 45, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.015709638595581
Epoch: 46, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8391759395599365
Epoch: 47, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1264605522155762
Epoch: 48, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8860766887664795
Epoch: 49, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9328405857086182
Epoch: 50, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 261512
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.775296449661255
Epoch: 1, Steps: 3 | Train Loss: 1.550 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.8673357963562012
Epoch: 2, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.380 Vali Acc: 0.225 Test Loss: 1.380 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0656342506408691
Epoch: 3, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.366 Vali Acc: 0.250 Test Loss: 1.366 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.9426712989807129
Epoch: 4, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.361 Vali Acc: 0.200 Test Loss: 1.361 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0930967330932617
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.369 Vali Acc: 0.375 Test Loss: 1.369 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.9368782043457031
Epoch: 6, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8450362682342529
Epoch: 7, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8476331233978271
Epoch: 8, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9706497192382812
Epoch: 9, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.9491312503814697
Epoch: 10, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.0044453144073486
Epoch: 11, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.279 Vali Acc: 0.350 Test Loss: 1.279 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1022038459777832
Epoch: 12, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 1.021477460861206
Epoch: 13, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.218 Vali Acc: 0.600 Test Loss: 1.218 Test Acc: 0.600
Validation loss decreased (-0.449988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 1.3480451107025146
Epoch: 14, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0928668975830078
Epoch: 15, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9737575054168701
Epoch: 16, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0737731456756592
Epoch: 17, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.131 Vali Acc: 0.550 Test Loss: 1.131 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9016282558441162
Epoch: 18, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 19 cost time: 0.861882209777832
Epoch: 19, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.066 Vali Acc: 0.725 Test Loss: 1.066 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 20 cost time: 0.8267724514007568
Epoch: 20, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.196385145187378
Epoch: 21, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0869724750518799
Epoch: 22, Steps: 3 | Train Loss: 0.750 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2143173217773438
Epoch: 23, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3122284412384033
Epoch: 24, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1359694004058838
Epoch: 25, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.9446117877960205
Epoch: 26, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 27 cost time: 0.8544895648956299
Epoch: 27, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.80147385597229
Epoch: 28, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9824244976043701
Epoch: 29, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.768 Vali Acc: 0.775 Test Loss: 0.768 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9041790962219238
Epoch: 30, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.741 Vali Acc: 0.825 Test Loss: 0.741 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 31 cost time: 0.993628978729248
Epoch: 31, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0868232250213623
Epoch: 32, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 1.2363181114196777
Epoch: 33, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 1.13045072555542
Epoch: 34, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0740764141082764
Epoch: 35, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.635 Vali Acc: 0.775 Test Loss: 0.635 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9951145648956299
Epoch: 36, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9220633506774902
Epoch: 37, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.8695182800292969
Epoch: 38, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 39 cost time: 0.808269739151001
Epoch: 39, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 40 cost time: 0.8349511623382568
Epoch: 40, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 1.04569411277771
Epoch: 41, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.9154677391052246
Epoch: 42, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.848137617111206
Epoch: 43, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.9237468242645264
Epoch: 44, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.9236478805541992
Epoch: 45, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 1.1352849006652832
Epoch: 46, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.7913382053375244
Epoch: 47, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.7499887943267822
Epoch: 48, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.8765304088592529
Epoch: 49, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.8254551887512207
Epoch: 50, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 51 cost time: 0.9266200065612793
Epoch: 51, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.9355158805847168
Epoch: 52, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.9405572414398193
Epoch: 53, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.842780351638794
Epoch: 54, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0575988292694092
Epoch: 55, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8655784130096436
Epoch: 56, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9419925212860107
Epoch: 57, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9246516227722168
Epoch: 58, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9646151065826416
Epoch: 59, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.966144323348999
Epoch: 60, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.0991556644439697
Epoch: 61, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9883484840393066
Epoch: 62, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.9164552688598633
Epoch: 63, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.9687809944152832
Epoch: 64, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.9532907009124756
Epoch: 65, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.8419454097747803
Epoch: 66, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 1.0007460117340088
Epoch: 67, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 1.1216814517974854
Epoch: 68, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9351584911346436
Epoch: 69, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.0751571655273438
Epoch: 70, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9450008869171143
Epoch: 71, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.083230972290039
Epoch: 72, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.207435131072998
Epoch: 73, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.1003665924072266
Epoch: 74, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.872431755065918
Epoch: 75, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.1094286441802979
Epoch: 76, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.9371917247772217
Epoch: 77, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 261064
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.584137201309204
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.476 Vali Acc: 0.200 Test Loss: 1.476 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.9012434482574463
Epoch: 2, Steps: 3 | Train Loss: 1.553 Vali Loss: 1.466 Vali Acc: 0.175 Test Loss: 1.466 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8039307594299316
Epoch: 3, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.454 Vali Acc: 0.200 Test Loss: 1.454 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 0.9710407257080078
Epoch: 4, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.449 Vali Acc: 0.250 Test Loss: 1.449 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.9838206768035889
Epoch: 5, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.447 Vali Acc: 0.200 Test Loss: 1.447 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8919696807861328
Epoch: 6, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.444 Vali Acc: 0.150 Test Loss: 1.444 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.915137529373169
Epoch: 7, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.438 Vali Acc: 0.125 Test Loss: 1.438 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9836301803588867
Epoch: 8, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.426 Vali Acc: 0.125 Test Loss: 1.426 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0508227348327637
Epoch: 9, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.403 Vali Acc: 0.200 Test Loss: 1.403 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9364349842071533
Epoch: 10, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.380 Vali Acc: 0.250 Test Loss: 1.380 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 0.9168808460235596
Epoch: 11, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.359 Vali Acc: 0.300 Test Loss: 1.359 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 0.8957657814025879
Epoch: 12, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.346 Vali Acc: 0.425 Test Loss: 1.346 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.9112548828125
Epoch: 13, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8824756145477295
Epoch: 14, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.315 Vali Acc: 0.425 Test Loss: 1.315 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 15 cost time: 0.7660796642303467
Epoch: 15, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.291 Vali Acc: 0.425 Test Loss: 1.291 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 16 cost time: 0.7226872444152832
Epoch: 16, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.265 Vali Acc: 0.375 Test Loss: 1.265 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8869028091430664
Epoch: 17, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.243 Vali Acc: 0.375 Test Loss: 1.243 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7949442863464355
Epoch: 18, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.224 Vali Acc: 0.375 Test Loss: 1.224 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.10353422164917
Epoch: 19, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.208 Vali Acc: 0.425 Test Loss: 1.208 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 20 cost time: 0.8719468116760254
Epoch: 20, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.179 Vali Acc: 0.450 Test Loss: 1.179 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 0.7838089466094971
Epoch: 21, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.147 Vali Acc: 0.575 Test Loss: 1.147 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.8098208904266357
Epoch: 22, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.8670608997344971
Epoch: 23, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.129016399383545
Epoch: 24, Steps: 3 | Train Loss: 0.779 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.7447545528411865
Epoch: 25, Steps: 3 | Train Loss: 0.801 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.7506065368652344
Epoch: 26, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 27 cost time: 1.07102370262146
Epoch: 27, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 28 cost time: 0.8287560939788818
Epoch: 28, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.929 Vali Acc: 0.650 Test Loss: 0.929 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 29 cost time: 0.8827171325683594
Epoch: 29, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 30 cost time: 0.823211669921875
Epoch: 30, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.871 Vali Acc: 0.725 Test Loss: 0.871 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 31 cost time: 0.7918846607208252
Epoch: 31, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 32 cost time: 0.9170641899108887
Epoch: 32, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.796 Vali Acc: 0.650 Test Loss: 0.796 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.057532787322998
Epoch: 33, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 34 cost time: 0.8682291507720947
Epoch: 34, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8881123065948486
Epoch: 35, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.792649507522583
Epoch: 36, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8816266059875488
Epoch: 37, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.897362470626831
Epoch: 38, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 39 cost time: 0.8012759685516357
Epoch: 39, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 40 cost time: 0.872406005859375
Epoch: 40, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 41 cost time: 1.0872745513916016
Epoch: 41, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 42 cost time: 0.8441510200500488
Epoch: 42, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 43 cost time: 0.839547872543335
Epoch: 43, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 44 cost time: 0.7690856456756592
Epoch: 44, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 45 cost time: 0.7870848178863525
Epoch: 45, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.9255151748657227
Epoch: 46, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9581189155578613
Epoch: 47, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9312424659729004
Epoch: 48, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0142042636871338
Epoch: 49, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.8698444366455078
Epoch: 50, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.8968405723571777
Epoch: 51, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.730553150177002
Epoch: 52, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.478 Vali Acc: 0.825 Test Loss: 0.478 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8918278217315674
Epoch: 53, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 0.8545711040496826
Epoch: 54, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8303117752075195
Epoch: 55, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8536615371704102
Epoch: 56, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9509234428405762
Epoch: 57, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.867520809173584
Epoch: 58, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9068505764007568
Epoch: 59, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.9722237586975098
Epoch: 60, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.9673728942871094
Epoch: 61, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8920226097106934
Epoch: 62, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 63 cost time: 0.7843582630157471
Epoch: 63, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8370194435119629
Epoch: 64, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0884006023406982
Epoch: 65, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8814187049865723
Epoch: 66, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7973964214324951
Epoch: 67, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1249110698699951
Epoch: 68, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 69 cost time: 0.7826008796691895
Epoch: 69, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 70 cost time: 0.7880890369415283
Epoch: 70, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 71 cost time: 0.8179957866668701
Epoch: 71, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 72 cost time: 0.9004459381103516
Epoch: 72, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 73 cost time: 0.7605273723602295
Epoch: 73, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 74 cost time: 0.7922360897064209
Epoch: 74, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1001012325286865
Epoch: 75, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8037862777709961
Epoch: 76, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.0114893913269043
Epoch: 77, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8088624477386475
Epoch: 78, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7623236179351807
Epoch: 79, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.9690520763397217
Epoch: 80, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.7959132194519043
Epoch: 81, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.9483942985534668
Epoch: 82, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.9127776622772217
Epoch: 83, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 260616
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4946112632751465
Epoch: 1, Steps: 3 | Train Loss: 1.585 Vali Loss: 1.363 Vali Acc: 0.200 Test Loss: 1.363 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.83097243309021
Epoch: 2, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.341 Vali Acc: 0.200 Test Loss: 1.341 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.7031402587890625
Epoch: 3, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.328 Vali Acc: 0.250 Test Loss: 1.328 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.755171537399292
Epoch: 4, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.249987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.7587966918945312
Epoch: 5, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.7018141746520996
Epoch: 6, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.288 Vali Acc: 0.375 Test Loss: 1.288 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.8359947204589844
Epoch: 7, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7647988796234131
Epoch: 8, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.8769161701202393
Epoch: 9, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.7920632362365723
Epoch: 10, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.8503561019897461
Epoch: 11, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.8608660697937012
Epoch: 12, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.200 Vali Acc: 0.450 Test Loss: 1.200 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 0.8542921543121338
Epoch: 13, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.172 Vali Acc: 0.475 Test Loss: 1.172 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.8013827800750732
Epoch: 14, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.148 Vali Acc: 0.625 Test Loss: 1.148 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.8582091331481934
Epoch: 15, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.122 Vali Acc: 0.700 Test Loss: 1.122 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.9188125133514404
Epoch: 16, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7713456153869629
Epoch: 17, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.071 Vali Acc: 0.625 Test Loss: 1.071 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0434343814849854
Epoch: 18, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.7623894214630127
Epoch: 19, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 0.8884379863739014
Epoch: 20, Steps: 3 | Train Loss: 0.879 Vali Loss: 0.968 Vali Acc: 0.800 Test Loss: 0.968 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 0.8903751373291016
Epoch: 21, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.938 Vali Acc: 0.825 Test Loss: 0.938 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.7552371025085449
Epoch: 22, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.905 Vali Acc: 0.850 Test Loss: 0.905 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 0.8517866134643555
Epoch: 23, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9357669353485107
Epoch: 24, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.840 Vali Acc: 0.825 Test Loss: 0.840 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7951545715332031
Epoch: 25, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.799 Vali Acc: 0.900 Test Loss: 0.799 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 26 cost time: 0.7482011318206787
Epoch: 26, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.756 Vali Acc: 0.900 Test Loss: 0.756 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 27 cost time: 0.9489505290985107
Epoch: 27, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.9295945167541504
Epoch: 28, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.6585547924041748
Epoch: 29, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9797351360321045
Epoch: 30, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8261518478393555
Epoch: 31, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8596069812774658
Epoch: 32, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8944079875946045
Epoch: 33, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.925304651260376
Epoch: 34, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.8608598709106445
Epoch: 35, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.866182804107666
Epoch: 36, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8870549201965332
Epoch: 37, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8690049648284912
Epoch: 38, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2770421504974365
Epoch: 39, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8935980796813965
Epoch: 40, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9962244033813477
Epoch: 41, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.054741382598877
Epoch: 42, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.9441289901733398
Epoch: 43, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.7300267219543457
Epoch: 44, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.8085665702819824
Epoch: 45, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.84004807472229
Epoch: 46, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9161531925201416
Epoch: 47, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7529566287994385
Epoch: 48, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9612870216369629
Epoch: 49, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8862199783325195
Epoch: 50, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9336235523223877
Epoch: 51, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9768221378326416
Epoch: 52, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9939167499542236
Epoch: 53, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9116864204406738
Epoch: 54, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 178760
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8134281635284424
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.378 Vali Acc: 0.275 Test Loss: 1.378 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9046053886413574
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.375 Vali Acc: 0.275 Test Loss: 1.375 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.9145634174346924
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.372 Vali Acc: 0.325 Test Loss: 1.372 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8873648643493652
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.8542823791503906
Epoch: 5, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9352991580963135
Epoch: 6, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.365 Vali Acc: 0.350 Test Loss: 1.365 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7901268005371094
Epoch: 7, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8784520626068115
Epoch: 8, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.335 Vali Acc: 0.350 Test Loss: 1.335 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9601209163665771
Epoch: 9, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.865818977355957
Epoch: 10, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 1.0193417072296143
Epoch: 11, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.9520964622497559
Epoch: 12, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.252 Vali Acc: 0.525 Test Loss: 1.252 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 13 cost time: 0.921950101852417
Epoch: 13, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 1.068150281906128
Epoch: 14, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.217 Vali Acc: 0.575 Test Loss: 1.217 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 1.1019136905670166
Epoch: 15, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 1.0867149829864502
Epoch: 16, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 0.9724807739257812
Epoch: 17, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.159 Vali Acc: 0.675 Test Loss: 1.159 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.972996711730957
Epoch: 18, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.131 Vali Acc: 0.750 Test Loss: 1.131 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 19 cost time: 1.001861810684204
Epoch: 19, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.103 Vali Acc: 0.750 Test Loss: 1.103 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 20 cost time: 0.9100863933563232
Epoch: 20, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.068 Vali Acc: 0.750 Test Loss: 1.068 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 0.7893810272216797
Epoch: 21, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 0.9130690097808838
Epoch: 22, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.172513723373413
Epoch: 23, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.995 Vali Acc: 0.675 Test Loss: 0.995 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.227388620376587
Epoch: 24, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.962 Vali Acc: 0.750 Test Loss: 0.962 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.9486262798309326
Epoch: 25, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.937 Vali Acc: 0.800 Test Loss: 0.937 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 0.7953934669494629
Epoch: 26, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.918 Vali Acc: 0.800 Test Loss: 0.918 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 1.0843329429626465
Epoch: 27, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.885 Vali Acc: 0.825 Test Loss: 0.885 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 28 cost time: 0.9637970924377441
Epoch: 28, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.851 Vali Acc: 0.825 Test Loss: 0.851 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 29 cost time: 0.8969266414642334
Epoch: 29, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.819 Vali Acc: 0.825 Test Loss: 0.819 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 30 cost time: 0.8488445281982422
Epoch: 30, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 31 cost time: 0.8489267826080322
Epoch: 31, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 32 cost time: 0.911175012588501
Epoch: 32, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.8987321853637695
Epoch: 33, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9737098217010498
Epoch: 34, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.0876281261444092
Epoch: 35, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.9648458957672119
Epoch: 36, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 37 cost time: 0.8422741889953613
Epoch: 37, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 1.170274257659912
Epoch: 38, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.596 Vali Acc: 0.875 Test Loss: 0.596 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 1.044008493423462
Epoch: 39, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.8205273151397705
Epoch: 40, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.9035079479217529
Epoch: 41, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 42 cost time: 0.9863579273223877
Epoch: 42, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8467574119567871
Epoch: 43, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8314337730407715
Epoch: 44, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.086775779724121
Epoch: 45, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0445668697357178
Epoch: 46, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.206437110900879
Epoch: 47, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.101783037185669
Epoch: 48, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1743507385253906
Epoch: 49, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 50 cost time: 0.920644998550415
Epoch: 50, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 0.8224947452545166
Epoch: 51, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.8477983474731445
Epoch: 52, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.9118847846984863
Epoch: 53, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 0.7656581401824951
Epoch: 54, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.9937899112701416
Epoch: 55, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 0.8133809566497803
Epoch: 56, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 0.8118343353271484
Epoch: 57, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0286493301391602
Epoch: 58, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9418115615844727
Epoch: 59, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8432273864746094
Epoch: 60, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9901597499847412
Epoch: 61, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 62 cost time: 0.8084166049957275
Epoch: 62, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 63 cost time: 0.7447478771209717
Epoch: 63, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8431129455566406
Epoch: 64, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9344425201416016
Epoch: 65, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7978522777557373
Epoch: 66, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0905566215515137
Epoch: 67, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 68 cost time: 0.8062300682067871
Epoch: 68, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 69 cost time: 0.9431955814361572
Epoch: 69, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.086747646331787
Epoch: 70, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.816270112991333
Epoch: 71, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.9157969951629639
Epoch: 72, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.7438185214996338
Epoch: 73, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 74 cost time: 0.851593017578125
Epoch: 74, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 75 cost time: 0.8339600563049316
Epoch: 75, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8173849582672119
Epoch: 76, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.9529321193695068
Epoch: 77, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.0619893074035645
Epoch: 78, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.221541166305542
Epoch: 79, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.0746488571166992
Epoch: 80, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.0312597751617432
Epoch: 81, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8557910919189453
Epoch: 82, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.0091125965118408
Epoch: 83, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.896080493927002
Epoch: 84, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 178312
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.652261257171631
Epoch: 1, Steps: 3 | Train Loss: 1.614 Vali Loss: 1.635 Vali Acc: 0.275 Test Loss: 1.635 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 1.003082513809204
Epoch: 2, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.580 Vali Acc: 0.275 Test Loss: 1.580 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274984).  Saving model ...
Epoch: 3 cost time: 0.7703039646148682
Epoch: 3, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.541 Vali Acc: 0.275 Test Loss: 1.541 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.9630613327026367
Epoch: 4, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.500 Vali Acc: 0.275 Test Loss: 1.500 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 5 cost time: 1.0833086967468262
Epoch: 5, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.464 Vali Acc: 0.275 Test Loss: 1.464 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 6 cost time: 0.8138127326965332
Epoch: 6, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.435 Vali Acc: 0.225 Test Loss: 1.435 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7915501594543457
Epoch: 7, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.413 Vali Acc: 0.325 Test Loss: 1.413 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.7950963973999023
Epoch: 8, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 1.145047664642334
Epoch: 9, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.379 Vali Acc: 0.325 Test Loss: 1.379 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 10 cost time: 0.7871747016906738
Epoch: 10, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 11 cost time: 0.965385913848877
Epoch: 11, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.352 Vali Acc: 0.475 Test Loss: 1.352 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474986).  Saving model ...
Epoch: 12 cost time: 0.929645299911499
Epoch: 12, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8899807929992676
Epoch: 13, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9419891834259033
Epoch: 14, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0755259990692139
Epoch: 15, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.301 Vali Acc: 0.375 Test Loss: 1.301 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2465169429779053
Epoch: 16, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0141301155090332
Epoch: 17, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.259 Vali Acc: 0.600 Test Loss: 1.259 Test Acc: 0.600
Validation loss decreased (-0.474986 --> -0.599987).  Saving model ...
Epoch: 18 cost time: 1.015808343887329
Epoch: 18, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.240 Vali Acc: 0.475 Test Loss: 1.240 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0534718036651611
Epoch: 19, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8819074630737305
Epoch: 20, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0191991329193115
Epoch: 21, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.176 Vali Acc: 0.725 Test Loss: 1.176 Test Acc: 0.725
Validation loss decreased (-0.599987 --> -0.724988).  Saving model ...
Epoch: 22 cost time: 0.9720242023468018
Epoch: 22, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.156 Vali Acc: 0.650 Test Loss: 1.156 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8042325973510742
Epoch: 23, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.130 Vali Acc: 0.725 Test Loss: 1.130 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 24 cost time: 1.0010404586791992
Epoch: 24, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.103 Vali Acc: 0.700 Test Loss: 1.103 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8965027332305908
Epoch: 25, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.083 Vali Acc: 0.575 Test Loss: 1.083 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0685462951660156
Epoch: 26, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8851628303527832
Epoch: 27, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.043 Vali Acc: 0.750 Test Loss: 1.043 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 28 cost time: 0.8465309143066406
Epoch: 28, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 1.0065381526947021
Epoch: 29, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 30 cost time: 1.29856276512146
Epoch: 30, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8271496295928955
Epoch: 31, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.914 Vali Acc: 0.675 Test Loss: 0.914 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.876213788986206
Epoch: 32, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 33 cost time: 0.771599531173706
Epoch: 33, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.849 Vali Acc: 0.775 Test Loss: 0.849 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 34 cost time: 0.9468872547149658
Epoch: 34, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.822 Vali Acc: 0.825 Test Loss: 0.822 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 35 cost time: 0.7268116474151611
Epoch: 35, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 36 cost time: 0.8344497680664062
Epoch: 36, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 37 cost time: 0.8237161636352539
Epoch: 37, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 38 cost time: 1.0311675071716309
Epoch: 38, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 0.9905238151550293
Epoch: 39, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.713 Vali Acc: 0.825 Test Loss: 0.713 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8925683498382568
Epoch: 40, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9011044502258301
Epoch: 41, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 42 cost time: 0.8858828544616699
Epoch: 42, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.654 Vali Acc: 0.875 Test Loss: 0.654 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 43 cost time: 1.082078456878662
Epoch: 43, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.9640464782714844
Epoch: 44, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.612 Vali Acc: 0.825 Test Loss: 0.612 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9392571449279785
Epoch: 45, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.9118764400482178
Epoch: 46, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 0.83457350730896
Epoch: 47, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 48 cost time: 0.914189338684082
Epoch: 48, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 49 cost time: 0.985037088394165
Epoch: 49, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 50 cost time: 1.1194889545440674
Epoch: 50, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 51 cost time: 1.0386924743652344
Epoch: 51, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.7669792175292969
Epoch: 52, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.9543156623840332
Epoch: 53, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.8581106662750244
Epoch: 54, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 55 cost time: 0.7941663265228271
Epoch: 55, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0675463676452637
Epoch: 56, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 57 cost time: 0.9636688232421875
Epoch: 57, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 58 cost time: 0.9346318244934082
Epoch: 58, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 59 cost time: 1.1117198467254639
Epoch: 59, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 60 cost time: 1.0024306774139404
Epoch: 60, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 0.7373833656311035
Epoch: 61, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 62 cost time: 0.7858791351318359
Epoch: 62, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 63 cost time: 0.8498506546020508
Epoch: 63, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9720449447631836
Epoch: 64, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1335253715515137
Epoch: 65, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.138559103012085
Epoch: 66, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9099736213684082
Epoch: 67, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.0746486186981201
Epoch: 68, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.0305097103118896
Epoch: 69, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.7963581085205078
Epoch: 70, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.7666923999786377
Epoch: 71, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.9056911468505859
Epoch: 72, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 177864
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6390135288238525
Epoch: 1, Steps: 3 | Train Loss: 1.569 Vali Loss: 1.499 Vali Acc: 0.125 Test Loss: 1.499 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 0.8736040592193604
Epoch: 2, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.478 Vali Acc: 0.125 Test Loss: 1.478 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 0.8392319679260254
Epoch: 3, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.462 Vali Acc: 0.125 Test Loss: 1.462 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124985).  Saving model ...
Epoch: 4 cost time: 0.795773983001709
Epoch: 4, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.442 Vali Acc: 0.200 Test Loss: 1.442 Test Acc: 0.200
Validation loss decreased (-0.124985 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 1.0507118701934814
Epoch: 5, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.423 Vali Acc: 0.275 Test Loss: 1.423 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.9163124561309814
Epoch: 6, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 1.1046483516693115
Epoch: 7, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.403 Vali Acc: 0.300 Test Loss: 1.403 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 0.9858365058898926
Epoch: 8, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 9 cost time: 0.9149057865142822
Epoch: 9, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 10 cost time: 0.8699836730957031
Epoch: 10, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 0.8427355289459229
Epoch: 11, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.353 Vali Acc: 0.300 Test Loss: 1.353 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 0.9958956241607666
Epoch: 12, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.337 Vali Acc: 0.350 Test Loss: 1.337 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 13 cost time: 0.8616623878479004
Epoch: 13, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 1.085850715637207
Epoch: 14, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 1.2007455825805664
Epoch: 15, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.304 Vali Acc: 0.525 Test Loss: 1.304 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 16 cost time: 1.1063480377197266
Epoch: 16, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.287 Vali Acc: 0.525 Test Loss: 1.287 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 17 cost time: 1.1664395332336426
Epoch: 17, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.253 Vali Acc: 0.550 Test Loss: 1.253 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 1.049293041229248
Epoch: 18, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.219 Vali Acc: 0.525 Test Loss: 1.219 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.00032377243042
Epoch: 19, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.7307682037353516
Epoch: 20, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9605193138122559
Epoch: 21, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.861750602722168
Epoch: 22, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.136 Vali Acc: 0.575 Test Loss: 1.136 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 23 cost time: 0.7241826057434082
Epoch: 23, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0604932308197021
Epoch: 24, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.075 Vali Acc: 0.575 Test Loss: 1.075 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 25 cost time: 0.7401046752929688
Epoch: 25, Steps: 3 | Train Loss: 0.801 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 26 cost time: 0.8200583457946777
Epoch: 26, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.019 Vali Acc: 0.625 Test Loss: 1.019 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 27 cost time: 0.9460830688476562
Epoch: 27, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0088603496551514
Epoch: 28, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.964 Vali Acc: 0.650 Test Loss: 0.964 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 1.1360421180725098
Epoch: 29, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.936 Vali Acc: 0.650 Test Loss: 0.936 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 30 cost time: 0.949643611907959
Epoch: 30, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 31 cost time: 0.947119951248169
Epoch: 31, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 32 cost time: 0.8530104160308838
Epoch: 32, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 33 cost time: 0.8362362384796143
Epoch: 33, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.807 Vali Acc: 0.850 Test Loss: 0.807 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849992).  Saving model ...
Epoch: 34 cost time: 0.8722405433654785
Epoch: 34, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.928565263748169
Epoch: 35, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9224216938018799
Epoch: 36, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 37 cost time: 0.7369318008422852
Epoch: 37, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8579883575439453
Epoch: 38, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.684 Vali Acc: 0.775 Test Loss: 0.684 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8955042362213135
Epoch: 39, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.653 Vali Acc: 0.750 Test Loss: 0.653 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8109731674194336
Epoch: 40, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9491696357727051
Epoch: 41, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 0.7967615127563477
Epoch: 42, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.9951512813568115
Epoch: 43, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 1.2826073169708252
Epoch: 44, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9816734790802002
Epoch: 45, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0313384532928467
Epoch: 46, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9412715435028076
Epoch: 47, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 1.3016963005065918
Epoch: 48, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 1.2147266864776611
Epoch: 49, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.8618011474609375
Epoch: 50, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 51 cost time: 0.7403326034545898
Epoch: 51, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.7313117980957031
Epoch: 52, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.7598206996917725
Epoch: 53, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.8076643943786621
Epoch: 54, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8043093681335449
Epoch: 55, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9977636337280273
Epoch: 56, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8335762023925781
Epoch: 57, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9281294345855713
Epoch: 58, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 59 cost time: 0.9097440242767334
Epoch: 59, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0084726810455322
Epoch: 60, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 0.8745851516723633
Epoch: 61, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 0.8427574634552002
Epoch: 62, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 63 cost time: 0.9023034572601318
Epoch: 63, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.9572708606719971
Epoch: 64, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.799121618270874
Epoch: 65, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.9473972320556641
Epoch: 66, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 0.8914108276367188
Epoch: 67, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 0.8275580406188965
Epoch: 68, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 69 cost time: 0.9249937534332275
Epoch: 69, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7408909797668457
Epoch: 70, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7620196342468262
Epoch: 71, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.9700472354888916
Epoch: 72, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8292989730834961
Epoch: 73, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 74 cost time: 0.9621913433074951
Epoch: 74, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 75 cost time: 0.8712542057037354
Epoch: 75, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 76 cost time: 0.8929224014282227
Epoch: 76, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8428125381469727
Epoch: 77, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.075819492340088
Epoch: 78, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9575870037078857
Epoch: 79, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.0671041011810303
Epoch: 80, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.319917917251587
Epoch: 81, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.9780318737030029
Epoch: 82, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.8726224899291992
Epoch: 83, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.0754876136779785
Epoch: 84, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.9061379432678223
Epoch: 85, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 177416
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.26570725440979
Epoch: 1, Steps: 3 | Train Loss: 1.531 Vali Loss: 1.410 Vali Acc: 0.300 Test Loss: 1.410 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7226567268371582
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7724504470825195
Epoch: 3, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.351 Vali Acc: 0.325 Test Loss: 1.351 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8976550102233887
Epoch: 4, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.331 Vali Acc: 0.325 Test Loss: 1.331 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.8497710227966309
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.8449797630310059
Epoch: 6, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.7393171787261963
Epoch: 7, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.301 Vali Acc: 0.475 Test Loss: 1.301 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.8005995750427246
Epoch: 8, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.809002161026001
Epoch: 9, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.8303837776184082
Epoch: 10, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.275 Vali Acc: 0.525 Test Loss: 1.275 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.7495276927947998
Epoch: 11, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.8830668926239014
Epoch: 12, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.244 Vali Acc: 0.600 Test Loss: 1.244 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.9154832363128662
Epoch: 13, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.222 Vali Acc: 0.625 Test Loss: 1.222 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.9854977130889893
Epoch: 14, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.194 Vali Acc: 0.600 Test Loss: 1.194 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7375328540802002
Epoch: 15, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 1.0292043685913086
Epoch: 16, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 1.1500225067138672
Epoch: 17, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.124 Vali Acc: 0.625 Test Loss: 1.124 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.8419876098632812
Epoch: 18, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.9532120227813721
Epoch: 19, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 0.8841521739959717
Epoch: 20, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.7415220737457275
Epoch: 21, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.8405015468597412
Epoch: 22, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.030 Vali Acc: 0.725 Test Loss: 1.030 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 23 cost time: 0.8197281360626221
Epoch: 23, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 1.1125152111053467
Epoch: 24, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0213849544525146
Epoch: 25, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.956 Vali Acc: 0.725 Test Loss: 0.956 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.9086713790893555
Epoch: 26, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.930 Vali Acc: 0.725 Test Loss: 0.930 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 27 cost time: 0.9874334335327148
Epoch: 27, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.9136271476745605
Epoch: 28, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.8851375579833984
Epoch: 29, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 30 cost time: 0.7065169811248779
Epoch: 30, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.768 Vali Acc: 0.775 Test Loss: 0.768 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9078855514526367
Epoch: 31, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 32 cost time: 0.9400131702423096
Epoch: 32, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9863371849060059
Epoch: 33, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8725166320800781
Epoch: 34, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 0.8685288429260254
Epoch: 35, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 36 cost time: 0.9190404415130615
Epoch: 36, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 37 cost time: 0.9222006797790527
Epoch: 37, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.861222505569458
Epoch: 38, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8300931453704834
Epoch: 39, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8866307735443115
Epoch: 40, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 0.7823173999786377
Epoch: 41, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.7900631427764893
Epoch: 42, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8104755878448486
Epoch: 43, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8763399124145508
Epoch: 44, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.9153032302856445
Epoch: 45, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.435 Vali Acc: 0.950 Test Loss: 0.435 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.8800482749938965
Epoch: 46, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.421 Vali Acc: 0.950 Test Loss: 0.421 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.8317849636077881
Epoch: 47, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.8968470096588135
Epoch: 48, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 49 cost time: 0.9637846946716309
Epoch: 49, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 1.0859458446502686
Epoch: 50, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9689688682556152
Epoch: 51, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 52 cost time: 0.8617134094238281
Epoch: 52, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 0.8982477188110352
Epoch: 53, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 0.6944937705993652
Epoch: 54, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8480913639068604
Epoch: 55, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8921699523925781
Epoch: 56, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0636296272277832
Epoch: 57, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9929637908935547
Epoch: 58, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.0149750709533691
Epoch: 59, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9833581447601318
Epoch: 60, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.7957170009613037
Epoch: 61, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.8300023078918457
Epoch: 62, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8411552906036377
Epoch: 63, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 137160
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4020023345947266
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.748546838760376
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.386 Vali Acc: 0.425 Test Loss: 1.386 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.7009150981903076
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.385 Vali Acc: 0.425 Test Loss: 1.385 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.7100155353546143
Epoch: 4, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.386 Vali Acc: 0.375 Test Loss: 1.386 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6887905597686768
Epoch: 5, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8113653659820557
Epoch: 6, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.376 Vali Acc: 0.375 Test Loss: 1.376 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8014624118804932
Epoch: 7, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.369 Vali Acc: 0.425 Test Loss: 1.369 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.8184356689453125
Epoch: 8, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.362 Vali Acc: 0.375 Test Loss: 1.362 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8349969387054443
Epoch: 9, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.352 Vali Acc: 0.375 Test Loss: 1.352 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7847168445587158
Epoch: 10, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.341 Vali Acc: 0.450 Test Loss: 1.341 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.8713240623474121
Epoch: 11, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.327 Vali Acc: 0.450 Test Loss: 1.327 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.7566497325897217
Epoch: 12, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.719057559967041
Epoch: 13, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.290 Vali Acc: 0.475 Test Loss: 1.290 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7513899803161621
Epoch: 14, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.7494008541107178
Epoch: 15, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.6995985507965088
Epoch: 16, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 17 cost time: 0.7618722915649414
Epoch: 17, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.243 Vali Acc: 0.525 Test Loss: 1.243 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.6942288875579834
Epoch: 18, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.7909817695617676
Epoch: 19, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.192 Vali Acc: 0.575 Test Loss: 1.192 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6632883548736572
Epoch: 20, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.168 Vali Acc: 0.575 Test Loss: 1.168 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.8153791427612305
Epoch: 21, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 22 cost time: 0.7577705383300781
Epoch: 22, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8221654891967773
Epoch: 23, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.887596845626831
Epoch: 24, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0328385829925537
Epoch: 25, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.7236840724945068
Epoch: 26, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 0.9067072868347168
Epoch: 27, Steps: 3 | Train Loss: 0.764 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.684309720993042
Epoch: 28, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 29 cost time: 0.8506021499633789
Epoch: 29, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 30 cost time: 0.7523629665374756
Epoch: 30, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.942 Vali Acc: 0.775 Test Loss: 0.942 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 31 cost time: 1.0699374675750732
Epoch: 31, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 0.761103630065918
Epoch: 32, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7384800910949707
Epoch: 33, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1152982711791992
Epoch: 34, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.827 Vali Acc: 0.725 Test Loss: 0.827 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.865880012512207
Epoch: 35, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7770044803619385
Epoch: 36, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8430142402648926
Epoch: 37, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.729 Vali Acc: 0.825 Test Loss: 0.729 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 38 cost time: 0.7494564056396484
Epoch: 38, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 39 cost time: 0.9662644863128662
Epoch: 39, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.8551390171051025
Epoch: 40, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 41 cost time: 0.7793993949890137
Epoch: 41, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 42 cost time: 0.8192307949066162
Epoch: 42, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 43 cost time: 0.760638952255249
Epoch: 43, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 44 cost time: 0.8011209964752197
Epoch: 44, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7967474460601807
Epoch: 45, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.85782790184021
Epoch: 46, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 0.8962016105651855
Epoch: 47, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 0.9621045589447021
Epoch: 48, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 0.8102359771728516
Epoch: 49, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9801990985870361
Epoch: 50, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 0.8455910682678223
Epoch: 51, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 52 cost time: 0.7363300323486328
Epoch: 52, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 0.7984442710876465
Epoch: 53, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.8069031238555908
Epoch: 54, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 0.8553550243377686
Epoch: 55, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.962047815322876
Epoch: 56, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.9612720012664795
Epoch: 57, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.764650821685791
Epoch: 58, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0874948501586914
Epoch: 59, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8848505020141602
Epoch: 60, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9409456253051758
Epoch: 61, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9130637645721436
Epoch: 62, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9178245067596436
Epoch: 63, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.966780424118042
Epoch: 64, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.814396858215332
Epoch: 65, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8197336196899414
Epoch: 66, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.9515252113342285
Epoch: 67, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.9943215847015381
Epoch: 68, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.9909086227416992
Epoch: 69, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.9688265323638916
Epoch: 70, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.0128350257873535
Epoch: 71, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.014444351196289
Epoch: 72, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.9282140731811523
Epoch: 73, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 74 cost time: 0.9165933132171631
Epoch: 74, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9750902652740479
Epoch: 75, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 76 cost time: 0.840886116027832
Epoch: 76, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7889602184295654
Epoch: 77, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.0718615055084229
Epoch: 78, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9229397773742676
Epoch: 79, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8705637454986572
Epoch: 80, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.0193181037902832
Epoch: 81, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.8094151020050049
Epoch: 82, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.7831575870513916
Epoch: 83, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.7949130535125732
Epoch: 84, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.8006350994110107
Epoch: 85, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 136712
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.543606996536255
Epoch: 1, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.501 Vali Acc: 0.350 Test Loss: 1.501 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 1.03401517868042
Epoch: 2, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.459 Vali Acc: 0.350 Test Loss: 1.459 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.9135255813598633
Epoch: 3, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.429 Vali Acc: 0.375 Test Loss: 1.429 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.742774248123169
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.0030484199523926
Epoch: 5, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.366 Vali Acc: 0.325 Test Loss: 1.366 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0540359020233154
Epoch: 6, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.343 Vali Acc: 0.300 Test Loss: 1.343 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8746874332427979
Epoch: 7, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7264301776885986
Epoch: 8, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.326 Vali Acc: 0.525 Test Loss: 1.326 Test Acc: 0.525
Validation loss decreased (-0.399986 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.8054788112640381
Epoch: 9, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.320 Vali Acc: 0.475 Test Loss: 1.320 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8506810665130615
Epoch: 10, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.313 Vali Acc: 0.450 Test Loss: 1.313 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1550121307373047
Epoch: 11, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.305 Vali Acc: 0.450 Test Loss: 1.305 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9565622806549072
Epoch: 12, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8931598663330078
Epoch: 13, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1771399974822998
Epoch: 14, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.254 Vali Acc: 0.425 Test Loss: 1.254 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8377909660339355
Epoch: 15, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.222 Vali Acc: 0.450 Test Loss: 1.222 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8355803489685059
Epoch: 16, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.200 Vali Acc: 0.450 Test Loss: 1.200 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.990689754486084
Epoch: 17, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.172 Vali Acc: 0.475 Test Loss: 1.172 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1029651165008545
Epoch: 18, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.525
model parameter : 136264
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.61954402923584
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.474 Vali Acc: 0.275 Test Loss: 1.474 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.6924431324005127
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.461 Vali Acc: 0.275 Test Loss: 1.461 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.8570613861083984
Epoch: 3, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.444 Vali Acc: 0.400 Test Loss: 1.444 Test Acc: 0.400
Validation loss decreased (-0.274985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.8154392242431641
Epoch: 4, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.429 Vali Acc: 0.425 Test Loss: 1.429 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.8304271697998047
Epoch: 5, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.412 Vali Acc: 0.275 Test Loss: 1.412 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1335115432739258
Epoch: 6, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.397 Vali Acc: 0.350 Test Loss: 1.397 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.903261661529541
Epoch: 7, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8609912395477295
Epoch: 8, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7621974945068359
Epoch: 9, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.912431001663208
Epoch: 10, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0883166790008545
Epoch: 11, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.318 Vali Acc: 0.350 Test Loss: 1.318 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8551948070526123
Epoch: 12, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.304 Vali Acc: 0.550 Test Loss: 1.304 Test Acc: 0.550
Validation loss decreased (-0.424986 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 0.8507118225097656
Epoch: 13, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.031675100326538
Epoch: 14, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.276 Vali Acc: 0.350 Test Loss: 1.276 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1391780376434326
Epoch: 15, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8077449798583984
Epoch: 16, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.8701984882354736
Epoch: 17, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.235 Vali Acc: 0.575 Test Loss: 1.235 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.8578794002532959
Epoch: 18, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.219 Vali Acc: 0.575 Test Loss: 1.219 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.7454338073730469
Epoch: 19, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.205 Vali Acc: 0.525 Test Loss: 1.205 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9192521572113037
Epoch: 20, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.78318190574646
Epoch: 21, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.136 Vali Acc: 0.575 Test Loss: 1.136 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.840705156326294
Epoch: 22, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7835879325866699
Epoch: 23, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.8318839073181152
Epoch: 24, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.9345369338989258
Epoch: 25, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.877617359161377
Epoch: 26, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 27 cost time: 0.9072151184082031
Epoch: 27, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.964 Vali Acc: 0.725 Test Loss: 0.964 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 28 cost time: 0.9648449420928955
Epoch: 28, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 1.0691523551940918
Epoch: 29, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 30 cost time: 0.8074545860290527
Epoch: 30, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0744199752807617
Epoch: 31, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.844 Vali Acc: 0.825 Test Loss: 0.844 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 32 cost time: 0.8290753364562988
Epoch: 32, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.818 Vali Acc: 0.850 Test Loss: 0.818 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 33 cost time: 0.7758865356445312
Epoch: 33, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 34 cost time: 0.7885231971740723
Epoch: 34, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 35 cost time: 0.9802200794219971
Epoch: 35, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.730 Vali Acc: 0.875 Test Loss: 0.730 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.8866097927093506
Epoch: 36, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.691 Vali Acc: 0.875 Test Loss: 0.691 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 37 cost time: 0.7237646579742432
Epoch: 37, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 38 cost time: 0.6945979595184326
Epoch: 38, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.7689061164855957
Epoch: 39, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 40 cost time: 0.8207728862762451
Epoch: 40, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 41 cost time: 0.7834970951080322
Epoch: 41, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.577 Vali Acc: 0.900 Test Loss: 0.577 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 42 cost time: 0.7021353244781494
Epoch: 42, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 43 cost time: 0.8478806018829346
Epoch: 43, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.8315389156341553
Epoch: 44, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.7603774070739746
Epoch: 45, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.7925407886505127
Epoch: 46, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.801830530166626
Epoch: 47, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.7718329429626465
Epoch: 48, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.809777021408081
Epoch: 49, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.6781270503997803
Epoch: 50, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 0.7688295841217041
Epoch: 51, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.8630647659301758
Epoch: 52, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.8722600936889648
Epoch: 53, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 0.8089993000030518
Epoch: 54, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.8135104179382324
Epoch: 55, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.7784430980682373
Epoch: 56, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.8257746696472168
Epoch: 57, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.7671096324920654
Epoch: 58, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9599518775939941
Epoch: 59, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8098254203796387
Epoch: 60, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 0.9476244449615479
Epoch: 61, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 0.7966823577880859
Epoch: 62, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7495098114013672
Epoch: 63, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8715898990631104
Epoch: 64, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8012428283691406
Epoch: 65, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7218747138977051
Epoch: 66, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8611910343170166
Epoch: 67, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.7872729301452637
Epoch: 68, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.7199678421020508
Epoch: 69, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.941068172454834
Epoch: 70, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 71 cost time: 0.9870343208312988
Epoch: 71, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.861572265625
Epoch: 72, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.9255402088165283
Epoch: 73, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.727952241897583
Epoch: 74, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 75 cost time: 0.8188822269439697
Epoch: 75, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8558444976806641
Epoch: 76, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6818149089813232
Epoch: 77, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7143065929412842
Epoch: 78, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.7311446666717529
Epoch: 79, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.7614662647247314
Epoch: 80, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.8053832054138184
Epoch: 81, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.0078818798065186
Epoch: 82, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.8267881870269775
Epoch: 83, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.8927066326141357
Epoch: 84, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 135816
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.124006509780884
Epoch: 1, Steps: 3 | Train Loss: 1.744 Vali Loss: 1.448 Vali Acc: 0.150 Test Loss: 1.448 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.6497251987457275
Epoch: 2, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.413 Vali Acc: 0.250 Test Loss: 1.413 Test Acc: 0.250
Validation loss decreased (-0.149986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6455461978912354
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.437 Vali Acc: 0.450 Test Loss: 1.437 Test Acc: 0.450
Validation loss decreased (-0.249986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.9375286102294922
Epoch: 4, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7120962142944336
Epoch: 5, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.219 Vali Acc: 0.475 Test Loss: 1.219 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.7918753623962402
Epoch: 6, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.101 Vali Acc: 0.550 Test Loss: 1.101 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.7665915489196777
Epoch: 7, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.8736164569854736
Epoch: 8, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.110 Vali Acc: 0.475 Test Loss: 1.110 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.731778621673584
Epoch: 9, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.002 Vali Acc: 0.500 Test Loss: 1.002 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7953228950500488
Epoch: 10, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 0.6414937973022461
Epoch: 11, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.730396032333374
Epoch: 12, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.835 Vali Acc: 0.650 Test Loss: 0.835 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7023224830627441
Epoch: 13, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8181278705596924
Epoch: 14, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.7068426609039307
Epoch: 15, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7576565742492676
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7739968299865723
Epoch: 17, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.7526767253875732
Epoch: 18, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.7256214618682861
Epoch: 19, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.669588565826416
Epoch: 20, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7703051567077637
Epoch: 21, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8550245761871338
Epoch: 22, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8612022399902344
Epoch: 23, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7017862796783447
Epoch: 24, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7138426303863525
Epoch: 25, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.7034237384796143
Epoch: 26, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.753997802734375
Epoch: 27, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6975259780883789
Epoch: 28, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8656349182128906
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7916595935821533
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7927632331848145
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6984913349151611
Epoch: 32, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8164582252502441
Epoch: 33, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7044239044189453
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6617519855499268
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7047080993652344
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899995).  Saving model ...
Epoch: 37 cost time: 0.8207137584686279
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 38 cost time: 0.8026375770568848
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7718393802642822
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9305226802825928
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7621588706970215
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7490139007568359
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7708194255828857
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.749809980392456
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7792036533355713
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6536691188812256
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6892960071563721
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4831772
model size : 23.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.589146852493286
Epoch: 1, Steps: 3 | Train Loss: 1.644 Vali Loss: 1.589 Vali Acc: 0.250 Test Loss: 1.589 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.7719845771789551
Epoch: 2, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.460 Vali Acc: 0.250 Test Loss: 1.460 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.7900028228759766
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.378 Vali Acc: 0.225 Test Loss: 1.378 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.987267255783081
Epoch: 4, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.275 Vali Acc: 0.300 Test Loss: 1.275 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.8691763877868652
Epoch: 5, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.248 Vali Acc: 0.450 Test Loss: 1.248 Test Acc: 0.450
Validation loss decreased (-0.299987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.9953098297119141
Epoch: 6, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.85133957862854
Epoch: 7, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.056 Vali Acc: 0.850 Test Loss: 1.056 Test Acc: 0.850
Validation loss decreased (-0.549988 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.7484688758850098
Epoch: 8, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.025 Vali Acc: 0.525 Test Loss: 1.025 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6771163940429688
Epoch: 9, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.926 Vali Acc: 0.875 Test Loss: 0.926 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.8551652431488037
Epoch: 10, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8593387603759766
Epoch: 11, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.800 Vali Acc: 0.875 Test Loss: 0.800 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.8673789501190186
Epoch: 12, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7248764038085938
Epoch: 13, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7474501132965088
Epoch: 14, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.8923759460449219
Epoch: 15, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.8220160007476807
Epoch: 16, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.8594679832458496
Epoch: 17, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8684163093566895
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6931753158569336
Epoch: 19, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.717 Vali Acc: 0.675 Test Loss: 0.717 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7760541439056396
Epoch: 20, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1918079853057861
Epoch: 21, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.8985991477966309
Epoch: 22, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.7618420124053955
Epoch: 23, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7156856060028076
Epoch: 24, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9303910732269287
Epoch: 25, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.726409912109375
Epoch: 26, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.798978328704834
Epoch: 27, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9865584373474121
Epoch: 28, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7560265064239502
Epoch: 29, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8035464286804199
Epoch: 30, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8010177612304688
Epoch: 31, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7717363834381104
Epoch: 32, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4829468
model size : 23.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4846413135528564
Epoch: 1, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.410 Vali Acc: 0.300 Test Loss: 1.410 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.8557038307189941
Epoch: 2, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.429 Vali Acc: 0.300 Test Loss: 1.429 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0009961128234863
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.386 Vali Acc: 0.325 Test Loss: 1.386 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.324953556060791
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.331 Vali Acc: 0.325 Test Loss: 1.331 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.8834202289581299
Epoch: 5, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.169 Vali Acc: 0.650 Test Loss: 1.169 Test Acc: 0.650
Validation loss decreased (-0.324987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.7999849319458008
Epoch: 6, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0663866996765137
Epoch: 7, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.064 Vali Acc: 0.550 Test Loss: 1.064 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8852229118347168
Epoch: 8, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.114 Vali Acc: 0.450 Test Loss: 1.114 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7966799736022949
Epoch: 9, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.996 Vali Acc: 0.625 Test Loss: 0.996 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9683668613433838
Epoch: 10, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.826 Vali Acc: 0.650 Test Loss: 0.826 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649992).  Saving model ...
Epoch: 11 cost time: 0.9314882755279541
Epoch: 11, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.782 Vali Acc: 0.825 Test Loss: 0.782 Test Acc: 0.825
Validation loss decreased (-0.649992 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.9088237285614014
Epoch: 12, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.893 Vali Acc: 0.600 Test Loss: 0.893 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9522850513458252
Epoch: 13, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.805 Vali Acc: 0.525 Test Loss: 0.805 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8934998512268066
Epoch: 14, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.607 Vali Acc: 0.650 Test Loss: 0.607 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9178361892700195
Epoch: 15, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.635 Vali Acc: 0.650 Test Loss: 0.635 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7767021656036377
Epoch: 16, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.714153528213501
Epoch: 17, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.905 Vali Acc: 0.550 Test Loss: 0.905 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0367403030395508
Epoch: 18, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9173307418823242
Epoch: 19, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.601 Vali Acc: 0.775 Test Loss: 0.601 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8271317481994629
Epoch: 20, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.612 Vali Acc: 0.575 Test Loss: 0.612 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0714640617370605
Epoch: 21, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.461 Vali Acc: 0.825 Test Loss: 0.461 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0591061115264893
Epoch: 22, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.521 Vali Acc: 0.775 Test Loss: 0.521 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.056077480316162
Epoch: 23, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.1625306606292725
Epoch: 24, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.482 Vali Acc: 0.825 Test Loss: 0.482 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9892346858978271
Epoch: 25, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 26 cost time: 0.8628997802734375
Epoch: 26, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7913663387298584
Epoch: 27, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 0.8136088848114014
Epoch: 28, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8262135982513428
Epoch: 29, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7967202663421631
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8423261642456055
Epoch: 31, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0921497344970703
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1623656749725342
Epoch: 33, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1033415794372559
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9967865943908691
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0695292949676514
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.065295696258545
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 4827164
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6809256076812744
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.9591989517211914
Epoch: 2, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.376 Vali Acc: 0.300 Test Loss: 1.376 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0704164505004883
Epoch: 3, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.308 Vali Acc: 0.450 Test Loss: 1.308 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.8943183422088623
Epoch: 4, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
Validation loss decreased (-0.449987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.9901952743530273
Epoch: 5, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8883633613586426
Epoch: 6, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.096 Vali Acc: 0.550 Test Loss: 1.096 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7809743881225586
Epoch: 7, Steps: 3 | Train Loss: 0.828 Vali Loss: 1.023 Vali Acc: 0.525 Test Loss: 1.023 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7855231761932373
Epoch: 8, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.908 Vali Acc: 0.550 Test Loss: 0.908 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7713487148284912
Epoch: 9, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.949 Vali Acc: 0.650 Test Loss: 0.949 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649991).  Saving model ...
Epoch: 10 cost time: 0.7507121562957764
Epoch: 10, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
Validation loss decreased (-0.649991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 0.7612566947937012
Epoch: 11, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.713 Vali Acc: 0.600 Test Loss: 0.713 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9208526611328125
Epoch: 12, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
Validation loss decreased (-0.749992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.7590832710266113
Epoch: 13, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.934607982635498
Epoch: 14, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.696 Vali Acc: 0.675 Test Loss: 0.696 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9948692321777344
Epoch: 15, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.677 Vali Acc: 0.675 Test Loss: 0.677 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2492237091064453
Epoch: 16, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.641 Vali Acc: 0.600 Test Loss: 0.641 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8999037742614746
Epoch: 17, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.9216556549072266
Epoch: 18, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.906994104385376
Epoch: 19, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9374659061431885
Epoch: 20, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9401459693908691
Epoch: 21, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8689596652984619
Epoch: 22, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9205451011657715
Epoch: 23, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.494 Vali Acc: 0.775 Test Loss: 0.494 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8666267395019531
Epoch: 24, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.431 Vali Acc: 0.825 Test Loss: 0.431 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9119937419891357
Epoch: 25, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0259649753570557
Epoch: 26, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.412 Vali Acc: 0.800 Test Loss: 0.412 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.061899185180664
Epoch: 27, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.400 Vali Acc: 0.825 Test Loss: 0.400 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1599783897399902
Epoch: 28, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 4824860
model size : 23.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4311797618865967
Epoch: 1, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7167396545410156
Epoch: 2, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.373 Vali Acc: 0.375 Test Loss: 1.373 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.02748441696167
Epoch: 3, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.9387791156768799
Epoch: 4, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.247 Vali Acc: 0.350 Test Loss: 1.247 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0640172958374023
Epoch: 5, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.186 Vali Acc: 0.475 Test Loss: 1.186 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 1.1631529331207275
Epoch: 6, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.6993236541748047
Epoch: 7, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.9457299709320068
Epoch: 8, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.992 Vali Acc: 0.450 Test Loss: 0.992 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.807487964630127
Epoch: 9, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.861 Vali Acc: 0.850 Test Loss: 0.861 Test Acc: 0.850
Validation loss decreased (-0.674990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.8493783473968506
Epoch: 10, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.878 Vali Acc: 0.575 Test Loss: 0.878 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.217674970626831
Epoch: 11, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.9916975498199463
Epoch: 12, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7607042789459229
Epoch: 13, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.703 Vali Acc: 0.725 Test Loss: 0.703 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9469656944274902
Epoch: 14, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.743 Vali Acc: 0.725 Test Loss: 0.743 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9202144145965576
Epoch: 15, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0394353866577148
Epoch: 16, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.9011709690093994
Epoch: 17, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.586 Vali Acc: 0.725 Test Loss: 0.586 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9210755825042725
Epoch: 18, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8988354206085205
Epoch: 19, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8629343509674072
Epoch: 20, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.673 Vali Acc: 0.700 Test Loss: 0.673 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8354899883270264
Epoch: 21, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.475 Vali Acc: 0.825 Test Loss: 0.475 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8685851097106934
Epoch: 22, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.8795413970947266
Epoch: 23, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.452 Vali Acc: 0.825 Test Loss: 0.452 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9283788204193115
Epoch: 24, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9432878494262695
Epoch: 25, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9040744304656982
Epoch: 26, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9096634387969971
Epoch: 27, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.520 Vali Acc: 0.800 Test Loss: 0.520 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9568338394165039
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8203091621398926
Epoch: 29, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.501 Vali Acc: 0.800 Test Loss: 0.501 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9523932933807373
Epoch: 30, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.454 Vali Acc: 0.825 Test Loss: 0.454 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1602919101715088
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0532689094543457
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4043804
model size : 20.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7847864627838135
Epoch: 1, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.474 Vali Acc: 0.275 Test Loss: 1.474 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.9307012557983398
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6581661701202393
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.372 Vali Acc: 0.275 Test Loss: 1.372 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8004410266876221
Epoch: 4, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.313 Vali Acc: 0.300 Test Loss: 1.313 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.7620360851287842
Epoch: 5, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.289 Vali Acc: 0.550 Test Loss: 1.289 Test Acc: 0.550
Validation loss decreased (-0.299987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.7326803207397461
Epoch: 6, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.238 Vali Acc: 0.450 Test Loss: 1.238 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7657716274261475
Epoch: 7, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.120 Vali Acc: 0.425 Test Loss: 1.120 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6664671897888184
Epoch: 8, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7007701396942139
Epoch: 9, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.8149325847625732
Epoch: 10, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.874 Vali Acc: 0.700 Test Loss: 0.874 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.6875467300415039
Epoch: 11, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.943 Vali Acc: 0.550 Test Loss: 0.943 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8011751174926758
Epoch: 12, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.798 Vali Acc: 0.725 Test Loss: 0.798 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 13 cost time: 0.9621236324310303
Epoch: 13, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.915 Vali Acc: 0.600 Test Loss: 0.915 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6915984153747559
Epoch: 14, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.673 Vali Acc: 0.725 Test Loss: 0.673 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724993).  Saving model ...
Epoch: 15 cost time: 0.7295613288879395
Epoch: 15, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.775 Vali Acc: 0.625 Test Loss: 0.775 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8083968162536621
Epoch: 16, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.760 Vali Acc: 0.725 Test Loss: 0.760 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7534329891204834
Epoch: 17, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
Validation loss decreased (-0.724993 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.7188742160797119
Epoch: 18, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.667 Vali Acc: 0.600 Test Loss: 0.667 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.711036205291748
Epoch: 19, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.643 Vali Acc: 0.625 Test Loss: 0.643 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6521947383880615
Epoch: 20, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7105276584625244
Epoch: 21, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.749994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.8398592472076416
Epoch: 22, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.946 Vali Acc: 0.600 Test Loss: 0.946 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6754777431488037
Epoch: 23, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.721 Vali Acc: 0.575 Test Loss: 0.721 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8235340118408203
Epoch: 24, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7358357906341553
Epoch: 25, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7006700038909912
Epoch: 26, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7081162929534912
Epoch: 27, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1048948764801025
Epoch: 28, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.597 Vali Acc: 0.800 Test Loss: 0.597 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8206980228424072
Epoch: 29, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7520546913146973
Epoch: 30, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7261838912963867
Epoch: 31, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 4041500
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.091775894165039
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.388 Vali Acc: 0.450 Test Loss: 1.388 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.8597254753112793
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.390 Vali Acc: 0.325 Test Loss: 1.390 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8443944454193115
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9943935871124268
Epoch: 4, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.8059346675872803
Epoch: 5, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8021261692047119
Epoch: 6, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7603261470794678
Epoch: 7, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.038 Vali Acc: 0.675 Test Loss: 1.038 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.9372191429138184
Epoch: 8, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.088252067565918
Epoch: 9, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.934 Vali Acc: 0.525 Test Loss: 0.934 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8348524570465088
Epoch: 10, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.1142661571502686
Epoch: 11, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.759 Vali Acc: 0.725 Test Loss: 0.759 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9586837291717529
Epoch: 12, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.743 Vali Acc: 0.700 Test Loss: 0.743 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.776158332824707
Epoch: 13, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.719 Vali Acc: 0.650 Test Loss: 0.719 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8651900291442871
Epoch: 14, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.604 Vali Acc: 0.825 Test Loss: 0.604 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.826667070388794
Epoch: 15, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.700 Vali Acc: 0.675 Test Loss: 0.700 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8250353336334229
Epoch: 16, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 1.2232246398925781
Epoch: 17, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9345512390136719
Epoch: 18, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0135910511016846
Epoch: 19, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.094362735748291
Epoch: 20, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 0.8492355346679688
Epoch: 21, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 0.7644860744476318
Epoch: 22, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 0.8736371994018555
Epoch: 23, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8790695667266846
Epoch: 24, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.695749044418335
Epoch: 25, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9717843532562256
Epoch: 26, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8627896308898926
Epoch: 27, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0478699207305908
Epoch: 28, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9364876747131348
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.9888463020324707
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0099685192108154
Epoch: 31, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8139426708221436
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 33 cost time: 0.8465213775634766
Epoch: 33, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1198756694793701
Epoch: 34, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.004697322845459
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8041937351226807
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9344041347503662
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9597666263580322
Epoch: 38, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9684741497039795
Epoch: 39, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 0.6276876926422119
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0558619499206543
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 1.13316011428833
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.8885247707366943
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7491674423217773
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.730118989944458
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.85184645652771
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8830530643463135
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9277534484863281
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9082646369934082
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8601713180541992
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.799584150314331
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1942014694213867
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 0.9462733268737793
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 1.128051996231079
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 0.7699308395385742
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.7376976013183594
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 0.8186306953430176
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 1.157947063446045
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 59 cost time: 1.174910545349121
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 60 cost time: 1.1632766723632812
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0194685459136963
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8495068550109863
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1117587089538574
Epoch: 63, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0040068626403809
Epoch: 64, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8977055549621582
Epoch: 65, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.9068818092346191
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.8425767421722412
Epoch: 67, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.8424358367919922
Epoch: 68, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.1054866313934326
Epoch: 69, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 4039196
model size : 20.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.908862352371216
Epoch: 1, Steps: 3 | Train Loss: 1.620 Vali Loss: 1.400 Vali Acc: 0.125 Test Loss: 1.400 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.8169505596160889
Epoch: 2, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.454 Vali Acc: 0.475 Test Loss: 1.454 Test Acc: 0.475
Validation loss decreased (-0.124986 --> -0.474985).  Saving model ...
Epoch: 3 cost time: 0.9138062000274658
Epoch: 3, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.556 Vali Acc: 0.300 Test Loss: 1.556 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8523740768432617
Epoch: 4, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.491 Vali Acc: 0.500 Test Loss: 1.491 Test Acc: 0.500
Validation loss decreased (-0.474985 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 0.7428371906280518
Epoch: 5, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.263 Vali Acc: 0.450 Test Loss: 1.263 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7672698497772217
Epoch: 6, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.114 Vali Acc: 0.375 Test Loss: 1.114 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.80582594871521
Epoch: 7, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.499985 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.676572322845459
Epoch: 8, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7784075736999512
Epoch: 9, Steps: 3 | Train Loss: 0.726 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8385941982269287
Epoch: 10, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.6963024139404297
Epoch: 11, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.7453382015228271
Epoch: 12, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.782 Vali Acc: 0.700 Test Loss: 0.782 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8657951354980469
Epoch: 13, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.687 Vali Acc: 0.825 Test Loss: 0.687 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.8149619102478027
Epoch: 14, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.678 Vali Acc: 0.825 Test Loss: 0.678 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 0.6753284931182861
Epoch: 15, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7968559265136719
Epoch: 16, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9553830623626709
Epoch: 17, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.8725621700286865
Epoch: 18, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.8435201644897461
Epoch: 19, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.517 Vali Acc: 0.750 Test Loss: 0.517 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.885103702545166
Epoch: 20, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.545 Vali Acc: 0.725 Test Loss: 0.545 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9881477355957031
Epoch: 21, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9298014640808105
Epoch: 22, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.612 Vali Acc: 0.725 Test Loss: 0.612 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7756791114807129
Epoch: 23, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.8877818584442139
Epoch: 24, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8001737594604492
Epoch: 25, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7706899642944336
Epoch: 26, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8540024757385254
Epoch: 27, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0463802814483643
Epoch: 28, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9058492183685303
Epoch: 29, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.9103760719299316
Epoch: 30, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8613502979278564
Epoch: 31, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 32 cost time: 0.9136185646057129
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.7885704040527344
Epoch: 33, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8343629837036133
Epoch: 34, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9499697685241699
Epoch: 35, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8500351905822754
Epoch: 36, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.857276201248169
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6976540088653564
Epoch: 38, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0110242366790771
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9289295673370361
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7504332065582275
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9120197296142578
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4036892
model size : 20.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.499866247177124
Epoch: 1, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.679973840713501
Epoch: 2, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.277 Vali Acc: 0.425 Test Loss: 1.277 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.7980661392211914
Epoch: 3, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.279 Vali Acc: 0.300 Test Loss: 1.279 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8019754886627197
Epoch: 4, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
Validation loss decreased (-0.424987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.7660224437713623
Epoch: 5, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.089 Vali Acc: 0.550 Test Loss: 1.089 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8775391578674316
Epoch: 6, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.089 Vali Acc: 0.425 Test Loss: 1.089 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8997442722320557
Epoch: 7, Steps: 3 | Train Loss: 0.863 Vali Loss: 0.970 Vali Acc: 0.675 Test Loss: 0.970 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.8523719310760498
Epoch: 8, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8358521461486816
Epoch: 9, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.9968366622924805
Epoch: 10, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.834 Vali Acc: 0.650 Test Loss: 0.834 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9196398258209229
Epoch: 11, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.781827449798584
Epoch: 12, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8400945663452148
Epoch: 13, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.745 Vali Acc: 0.675 Test Loss: 0.745 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7721068859100342
Epoch: 14, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9554407596588135
Epoch: 15, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.594 Vali Acc: 0.650 Test Loss: 0.594 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6882586479187012
Epoch: 16, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.688 Vali Acc: 0.650 Test Loss: 0.688 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8290214538574219
Epoch: 17, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.725 Vali Acc: 0.675 Test Loss: 0.725 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8628237247467041
Epoch: 18, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.0070905685424805
Epoch: 19, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.443 Vali Acc: 0.950 Test Loss: 0.443 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6447536945343018
Epoch: 20, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8059868812561035
Epoch: 21, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7535841464996338
Epoch: 22, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7561538219451904
Epoch: 23, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8292193412780762
Epoch: 24, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6341691017150879
Epoch: 25, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.933002233505249
Epoch: 26, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.871924877166748
Epoch: 27, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.935971736907959
Epoch: 28, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8610966205596924
Epoch: 29, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 3649820
model size : 18.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8972678184509277
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.421 Vali Acc: 0.325 Test Loss: 1.421 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.8141214847564697
Epoch: 2, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.8348722457885742
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.344 Vali Acc: 0.250 Test Loss: 1.344 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0191504955291748
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.345 Vali Acc: 0.325 Test Loss: 1.345 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7586424350738525
Epoch: 5, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.251 Vali Acc: 0.375 Test Loss: 1.251 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.7813353538513184
Epoch: 6, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.7916510105133057
Epoch: 7, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.045 Vali Acc: 0.575 Test Loss: 1.045 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 8 cost time: 0.9119608402252197
Epoch: 8, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.574990 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.8554344177246094
Epoch: 9, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6970710754394531
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8013975620269775
Epoch: 11, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.796 Vali Acc: 0.650 Test Loss: 0.796 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8353149890899658
Epoch: 12, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.767 Vali Acc: 0.875 Test Loss: 0.767 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.8875563144683838
Epoch: 13, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.829 Vali Acc: 0.600 Test Loss: 0.829 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9750359058380127
Epoch: 14, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.763 Vali Acc: 0.725 Test Loss: 0.763 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0637171268463135
Epoch: 15, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9052846431732178
Epoch: 16, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.590 Vali Acc: 0.875 Test Loss: 0.590 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.668926477432251
Epoch: 17, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9326276779174805
Epoch: 18, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7839241027832031
Epoch: 19, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8497452735900879
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.7704973220825195
Epoch: 21, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.781710147857666
Epoch: 22, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7699012756347656
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8476099967956543
Epoch: 24, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8006608486175537
Epoch: 25, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.455 Vali Acc: 0.825 Test Loss: 0.455 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7237334251403809
Epoch: 26, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.724862813949585
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9592702388763428
Epoch: 28, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8739635944366455
Epoch: 29, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7768063545227051
Epoch: 30, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7115075588226318
Epoch: 31, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3647516
model size : 18.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.764228343963623
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.9730994701385498
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.359 Vali Acc: 0.475 Test Loss: 1.359 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.865668535232544
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2198081016540527
Epoch: 4, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.263 Vali Acc: 0.550 Test Loss: 1.263 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.8879506587982178
Epoch: 5, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.8477697372436523
Epoch: 6, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 1.1713783740997314
Epoch: 7, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9013915061950684
Epoch: 8, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.064 Vali Acc: 0.575 Test Loss: 1.064 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9906730651855469
Epoch: 9, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.968 Vali Acc: 0.625 Test Loss: 0.968 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.853257417678833
Epoch: 10, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.624990 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 1.053875207901001
Epoch: 11, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.761 Vali Acc: 0.700 Test Loss: 0.761 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8347866535186768
Epoch: 12, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0447402000427246
Epoch: 13, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.758 Vali Acc: 0.600 Test Loss: 0.758 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7321889400482178
Epoch: 14, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.689 Vali Acc: 0.700 Test Loss: 0.689 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9472756385803223
Epoch: 15, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 0.778174877166748
Epoch: 16, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
Validation loss decreased (-0.749994 --> -0.824995).  Saving model ...
Epoch: 17 cost time: 1.0328679084777832
Epoch: 17, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9517827033996582
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8469908237457275
Epoch: 19, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9226129055023193
Epoch: 20, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.568 Vali Acc: 0.650 Test Loss: 0.568 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0994212627410889
Epoch: 21, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.562 Vali Acc: 0.725 Test Loss: 0.562 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8562572002410889
Epoch: 22, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.672 Vali Acc: 0.650 Test Loss: 0.672 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8336029052734375
Epoch: 23, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.8932812213897705
Epoch: 24, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.639 Vali Acc: 0.575 Test Loss: 0.639 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8900067806243896
Epoch: 25, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.842707633972168
Epoch: 26, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8358457088470459
Epoch: 27, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9317536354064941
Epoch: 28, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.072735071182251
Epoch: 29, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1866803169250488
Epoch: 30, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.023273229598999
Epoch: 31, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8868637084960938
Epoch: 32, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9170475006103516
Epoch: 33, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.487 Vali Acc: 0.825 Test Loss: 0.487 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3645212
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.535147190093994
Epoch: 1, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.802177906036377
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.394 Vali Acc: 0.300 Test Loss: 1.394 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.878178596496582
Epoch: 3, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.834465742111206
Epoch: 4, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.7633378505706787
Epoch: 5, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.174 Vali Acc: 0.525 Test Loss: 1.174 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.8569989204406738
Epoch: 6, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7555115222930908
Epoch: 7, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.9289765357971191
Epoch: 8, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.8179609775543213
Epoch: 9, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.875 Vali Acc: 0.625 Test Loss: 0.875 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6877620220184326
Epoch: 10, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.6986017227172852
Epoch: 11, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.809 Vali Acc: 0.700 Test Loss: 0.809 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7920181751251221
Epoch: 12, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.706 Vali Acc: 0.875 Test Loss: 0.706 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.7909669876098633
Epoch: 13, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7957983016967773
Epoch: 14, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6728601455688477
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.652 Vali Acc: 0.750 Test Loss: 0.652 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8496372699737549
Epoch: 16, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.769 Vali Acc: 0.600 Test Loss: 0.769 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.824448823928833
Epoch: 17, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.577 Vali Acc: 0.575 Test Loss: 0.577 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7993953227996826
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.7913341522216797
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.465 Vali Acc: 0.825 Test Loss: 0.465 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8677432537078857
Epoch: 20, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7832794189453125
Epoch: 21, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8552587032318115
Epoch: 22, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.494 Vali Acc: 0.800 Test Loss: 0.494 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8191144466400146
Epoch: 23, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7583935260772705
Epoch: 24, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.393 Vali Acc: 0.825 Test Loss: 0.393 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6183102130889893
Epoch: 25, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.580 Vali Acc: 0.650 Test Loss: 0.580 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7073113918304443
Epoch: 26, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8846290111541748
Epoch: 27, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7370147705078125
Epoch: 28, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.487 Vali Acc: 0.800 Test Loss: 0.487 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3642908
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.49043607711792
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.361 Vali Acc: 0.200 Test Loss: 1.361 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6542339324951172
Epoch: 2, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.312 Vali Acc: 0.325 Test Loss: 1.312 Test Acc: 0.325
Validation loss decreased (-0.199986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.8172116279602051
Epoch: 3, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.294 Vali Acc: 0.275 Test Loss: 1.294 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8643419742584229
Epoch: 4, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.280 Vali Acc: 0.625 Test Loss: 1.280 Test Acc: 0.625
Validation loss decreased (-0.324987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 0.6639549732208252
Epoch: 5, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.220 Vali Acc: 0.375 Test Loss: 1.220 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6586155891418457
Epoch: 6, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.075 Vali Acc: 0.475 Test Loss: 1.075 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.703463077545166
Epoch: 7, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6128256320953369
Epoch: 8, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.994 Vali Acc: 0.625 Test Loss: 0.994 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 0.6215965747833252
Epoch: 9, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
Validation loss decreased (-0.624990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.6868066787719727
Epoch: 10, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.954 Vali Acc: 0.525 Test Loss: 0.954 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9183773994445801
Epoch: 11, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8121333122253418
Epoch: 12, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.926 Vali Acc: 0.575 Test Loss: 0.926 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7185769081115723
Epoch: 13, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8916687965393066
Epoch: 14, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.742 Vali Acc: 0.600 Test Loss: 0.742 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.726600170135498
Epoch: 15, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.8283212184906006
Epoch: 16, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.684 Vali Acc: 0.675 Test Loss: 0.684 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8243637084960938
Epoch: 17, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.730 Vali Acc: 0.625 Test Loss: 0.730 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8499670028686523
Epoch: 18, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6875572204589844
Epoch: 19, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.603 Vali Acc: 0.750 Test Loss: 0.603 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8487677574157715
Epoch: 20, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.671987771987915
Epoch: 21, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.6601088047027588
Epoch: 22, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8251643180847168
Epoch: 23, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7719497680664062
Epoch: 24, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.7388606071472168
Epoch: 25, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.8081610202789307
Epoch: 26, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8740603923797607
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7610290050506592
Epoch: 28, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.449 Vali Acc: 0.825 Test Loss: 0.449 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8588097095489502
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7972869873046875
Epoch: 30, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.875 Vali Acc: 0.550 Test Loss: 0.875 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0409023761749268
Epoch: 31, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7876715660095215
Epoch: 32, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8409593105316162
Epoch: 33, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.625 Vali Acc: 0.825 Test Loss: 0.625 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9311127662658691
Epoch: 34, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.725 Vali Acc: 0.675 Test Loss: 0.725 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0324835777282715
Epoch: 35, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 3452828
model size : 18.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7523298263549805
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.354 Vali Acc: 0.250 Test Loss: 1.354 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.7540171146392822
Epoch: 2, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.371 Vali Acc: 0.350 Test Loss: 1.371 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.0721371173858643
Epoch: 3, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.360 Vali Acc: 0.375 Test Loss: 1.360 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.772810697555542
Epoch: 4, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
Validation loss decreased (-0.374986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.815392017364502
Epoch: 5, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.160 Vali Acc: 0.750 Test Loss: 1.160 Test Acc: 0.750
Validation loss decreased (-0.549987 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.7739760875701904
Epoch: 6, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.074 Vali Acc: 0.750 Test Loss: 1.074 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.6975400447845459
Epoch: 7, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7798933982849121
Epoch: 8, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.005204200744629
Epoch: 9, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.849 Vali Acc: 0.775 Test Loss: 0.849 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.9363632202148438
Epoch: 10, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8251509666442871
Epoch: 11, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 1.0255894660949707
Epoch: 12, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1666758060455322
Epoch: 13, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.9853270053863525
Epoch: 14, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9154300689697266
Epoch: 15, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.688 Vali Acc: 0.650 Test Loss: 0.688 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9710416793823242
Epoch: 16, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0004122257232666
Epoch: 17, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8909356594085693
Epoch: 18, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.611 Vali Acc: 0.725 Test Loss: 0.611 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8322312831878662
Epoch: 19, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.574 Vali Acc: 0.775 Test Loss: 0.574 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8906986713409424
Epoch: 20, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.597 Vali Acc: 0.700 Test Loss: 0.597 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9043145179748535
Epoch: 21, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.6588478088378906
Epoch: 22, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0741767883300781
Epoch: 23, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.838115930557251
Epoch: 24, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.953106164932251
Epoch: 25, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8097214698791504
Epoch: 26, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.671 Vali Acc: 0.800 Test Loss: 0.671 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8107874393463135
Epoch: 27, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.7719647884368896
Epoch: 28, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9948420524597168
Epoch: 29, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.8028960227966309
Epoch: 30, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9149434566497803
Epoch: 31, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0543434619903564
Epoch: 32, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0459773540496826
Epoch: 33, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7737526893615723
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1078035831451416
Epoch: 35, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.909294605255127
Epoch: 36, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8916964530944824
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8764524459838867
Epoch: 38, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8515076637268066
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3450524
model size : 18.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.54573130607605
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 0.8023080825805664
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.368 Vali Acc: 0.475 Test Loss: 1.368 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9536013603210449
Epoch: 3, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.292 Vali Acc: 0.475 Test Loss: 1.292 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7514979839324951
Epoch: 4, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.213 Vali Acc: 0.475 Test Loss: 1.213 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0038371086120605
Epoch: 5, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.196 Vali Acc: 0.525 Test Loss: 1.196 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.856914758682251
Epoch: 6, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.122 Vali Acc: 0.750 Test Loss: 1.122 Test Acc: 0.750
Validation loss decreased (-0.524988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.98209547996521
Epoch: 7, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.8117725849151611
Epoch: 8, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8140220642089844
Epoch: 9, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.7195608615875244
Epoch: 10, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.839 Vali Acc: 0.750 Test Loss: 0.839 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 0.819373369216919
Epoch: 11, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.867 Vali Acc: 0.625 Test Loss: 0.867 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8415136337280273
Epoch: 12, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.8652846813201904
Epoch: 13, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.961 Vali Acc: 0.575 Test Loss: 0.961 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9373173713684082
Epoch: 14, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9028501510620117
Epoch: 15, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7946913242340088
Epoch: 16, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.8400509357452393
Epoch: 17, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.649 Vali Acc: 0.575 Test Loss: 0.649 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9098799228668213
Epoch: 18, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9554178714752197
Epoch: 19, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8308851718902588
Epoch: 20, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7847661972045898
Epoch: 21, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8159348964691162
Epoch: 22, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.8964803218841553
Epoch: 23, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.776231050491333
Epoch: 24, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6699821949005127
Epoch: 25, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9539406299591064
Epoch: 26, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.70566725730896
Epoch: 27, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.504 Vali Acc: 0.800 Test Loss: 0.504 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8638458251953125
Epoch: 28, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8989579677581787
Epoch: 29, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.8504626750946045
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7989165782928467
Epoch: 31, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.455 Vali Acc: 0.825 Test Loss: 0.455 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9608004093170166
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8530704975128174
Epoch: 33, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0277092456817627
Epoch: 34, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9063117504119873
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8729455471038818
Epoch: 36, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7701680660247803
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7439424991607666
Epoch: 38, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8545670509338379
Epoch: 39, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3448220
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1540982723236084
Epoch: 1, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.1222445964813232
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.335 Vali Acc: 0.350 Test Loss: 1.335 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.017880916595459
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.9158544540405273
Epoch: 4, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.9531278610229492
Epoch: 5, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.9853935241699219
Epoch: 6, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.083 Vali Acc: 0.575 Test Loss: 1.083 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.9552838802337646
Epoch: 7, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.004 Vali Acc: 0.550 Test Loss: 1.004 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0195481777191162
Epoch: 8, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.958 Vali Acc: 0.650 Test Loss: 0.958 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.8831911087036133
Epoch: 9, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.866 Vali Acc: 0.700 Test Loss: 0.866 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.9554567337036133
Epoch: 10, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.829 Vali Acc: 0.625 Test Loss: 0.829 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7430317401885986
Epoch: 11, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.0110118389129639
Epoch: 12, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.8119421005249023
Epoch: 13, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1430892944335938
Epoch: 14, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.7272868156433105
Epoch: 15, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.688 Vali Acc: 0.650 Test Loss: 0.688 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1625864505767822
Epoch: 16, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.8136746883392334
Epoch: 17, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.8254470825195312
Epoch: 18, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.894850492477417
Epoch: 19, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9376826286315918
Epoch: 20, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.553 Vali Acc: 0.750 Test Loss: 0.553 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0462489128112793
Epoch: 21, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.584 Vali Acc: 0.625 Test Loss: 0.584 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9463310241699219
Epoch: 22, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.014040231704712
Epoch: 23, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 1.095519781112671
Epoch: 24, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7801942825317383
Epoch: 25, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8102474212646484
Epoch: 26, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8652386665344238
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7978665828704834
Epoch: 28, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9398458003997803
Epoch: 29, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.463 Vali Acc: 0.825 Test Loss: 0.463 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8605470657348633
Epoch: 30, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.450 Vali Acc: 0.825 Test Loss: 0.450 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8177320957183838
Epoch: 31, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.443 Vali Acc: 0.825 Test Loss: 0.443 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9142076969146729
Epoch: 32, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0027351379394531
Epoch: 33, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3445916
model size : 18.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4557971954345703
Epoch: 1, Steps: 3 | Train Loss: 1.623 Vali Loss: 1.370 Vali Acc: 0.350 Test Loss: 1.370 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6947574615478516
Epoch: 2, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.327 Vali Acc: 0.350 Test Loss: 1.327 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.0622451305389404
Epoch: 3, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.9899129867553711
Epoch: 4, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.7552156448364258
Epoch: 5, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.237 Vali Acc: 0.475 Test Loss: 1.237 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.7759244441986084
Epoch: 6, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8586349487304688
Epoch: 7, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.1115343570709229
Epoch: 8, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.104 Vali Acc: 0.525 Test Loss: 1.104 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7830374240875244
Epoch: 9, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7932827472686768
Epoch: 10, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.146 Vali Acc: 0.425 Test Loss: 1.146 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0098230838775635
Epoch: 11, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.044 Vali Acc: 0.525 Test Loss: 1.044 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.861854076385498
Epoch: 12, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.935 Vali Acc: 0.725 Test Loss: 0.935 Test Acc: 0.725
Validation loss decreased (-0.549988 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.803856611251831
Epoch: 13, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.865 Vali Acc: 0.825 Test Loss: 0.865 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 0.805065393447876
Epoch: 14, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.848 Vali Acc: 0.700 Test Loss: 0.848 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1492257118225098
Epoch: 15, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.891 Vali Acc: 0.600 Test Loss: 0.891 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9834411144256592
Epoch: 16, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9562773704528809
Epoch: 17, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7880961894989014
Epoch: 18, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.656 Vali Acc: 0.775 Test Loss: 0.656 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0098204612731934
Epoch: 19, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 0.6480295658111572
Epoch: 20, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.9706840515136719
Epoch: 21, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.009504795074463
Epoch: 22, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 0.7688050270080566
Epoch: 23, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.053605318069458
Epoch: 24, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9857602119445801
Epoch: 25, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 26 cost time: 1.100801706314087
Epoch: 26, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.506 Vali Acc: 0.800 Test Loss: 0.506 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.886845588684082
Epoch: 27, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 28 cost time: 0.9529955387115479
Epoch: 28, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.487 Vali Acc: 0.825 Test Loss: 0.487 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8382420539855957
Epoch: 29, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8049380779266357
Epoch: 30, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.9285984039306641
Epoch: 31, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.497 Vali Acc: 0.800 Test Loss: 0.497 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8908998966217041
Epoch: 32, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.103175401687622
Epoch: 33, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.474 Vali Acc: 0.800 Test Loss: 0.474 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9360699653625488
Epoch: 34, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 35 cost time: 0.9077041149139404
Epoch: 35, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8339598178863525
Epoch: 36, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.448 Vali Acc: 0.800 Test Loss: 0.448 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9785439968109131
Epoch: 37, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.445 Vali Acc: 0.800 Test Loss: 0.445 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9760341644287109
Epoch: 38, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.474 Vali Acc: 0.825 Test Loss: 0.474 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.114220380783081
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 40 cost time: 0.9916865825653076
Epoch: 40, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.459 Vali Acc: 0.800 Test Loss: 0.459 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8306996822357178
Epoch: 41, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 42 cost time: 1.0026216506958008
Epoch: 42, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.825 Test Loss: 0.458 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0327856540679932
Epoch: 43, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0659160614013672
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9393315315246582
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0633137226104736
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 47 cost time: 0.8392903804779053
Epoch: 47, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 48 cost time: 0.8930404186248779
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 49 cost time: 0.7663850784301758
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8161211013793945
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 51 cost time: 0.8093295097351074
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 52 cost time: 0.7867703437805176
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 53 cost time: 1.1680934429168701
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 54 cost time: 0.8596782684326172
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 55 cost time: 1.1126959323883057
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 56 cost time: 0.9696230888366699
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 57 cost time: 0.7954583168029785
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 58 cost time: 0.9465434551239014
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9237780570983887
Epoch: 59, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8035485744476318
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9818975925445557
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8029687404632568
Epoch: 62, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0077526569366455
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8468663692474365
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.8183834552764893
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8732051849365234
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 67 cost time: 0.7077839374542236
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7610583305358887
Epoch: 68, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7969732284545898
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8979446887969971
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7545080184936523
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.879178524017334
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 73 cost time: 0.7940545082092285
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 74 cost time: 0.9386093616485596
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 75 cost time: 0.8133165836334229
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 76 cost time: 0.7830603122711182
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 0.8924367427825928
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8105909824371338
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 79 cost time: 1.0243194103240967
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 80 cost time: 0.8292791843414307
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 81 cost time: 0.9020438194274902
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 82 cost time: 0.9528775215148926
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 83 cost time: 1.1403558254241943
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.190044641494751
Epoch: 84, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.9370443820953369
Epoch: 85, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.9294393062591553
Epoch: 86, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.7867040634155273
Epoch: 87, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 88 cost time: 0.9340848922729492
Epoch: 88, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.8828701972961426
Epoch: 89, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.9101762771606445
Epoch: 90, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.13716721534729
Epoch: 91, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.8068559169769287
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.9099647998809814
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 94 cost time: 1.0474259853363037
Epoch: 94, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 95 cost time: 0.9710021018981934
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 96 cost time: 0.7592298984527588
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.2675960063934326
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8731300830841064
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.7995665073394775
Epoch: 99, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.9122793674468994
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1631004
model size : 8.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.688850164413452
Epoch: 1, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.513 Vali Acc: 0.250 Test Loss: 1.513 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.7529497146606445
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.446 Vali Acc: 0.325 Test Loss: 1.446 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.672081470489502
Epoch: 3, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.402 Vali Acc: 0.400 Test Loss: 1.402 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.8760890960693359
Epoch: 4, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 0.8789510726928711
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.336 Vali Acc: 0.575 Test Loss: 1.336 Test Acc: 0.575
Validation loss decreased (-0.499986 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.9250838756561279
Epoch: 6, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8722872734069824
Epoch: 7, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8289117813110352
Epoch: 8, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7820472717285156
Epoch: 9, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.150 Vali Acc: 0.475 Test Loss: 1.150 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9103102684020996
Epoch: 10, Steps: 3 | Train Loss: 0.848 Vali Loss: 1.063 Vali Acc: 0.575 Test Loss: 1.063 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.7645559310913086
Epoch: 11, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.8083829879760742
Epoch: 12, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.972 Vali Acc: 0.675 Test Loss: 0.972 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.8053584098815918
Epoch: 13, Steps: 3 | Train Loss: 0.630 Vali Loss: 1.002 Vali Acc: 0.450 Test Loss: 1.002 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7993009090423584
Epoch: 14, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.0034763813018799
Epoch: 15, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.7834188938140869
Epoch: 16, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.7664670944213867
Epoch: 17, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.821 Vali Acc: 0.725 Test Loss: 0.821 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8148837089538574
Epoch: 18, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7808253765106201
Epoch: 19, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.8300771713256836
Epoch: 20, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.8271992206573486
Epoch: 21, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 0.7574167251586914
Epoch: 22, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8860726356506348
Epoch: 23, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7937488555908203
Epoch: 24, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7467262744903564
Epoch: 25, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 1.1559467315673828
Epoch: 26, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.7172298431396484
Epoch: 27, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.7124433517456055
Epoch: 28, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.8224565982818604
Epoch: 29, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9557487964630127
Epoch: 30, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.746027946472168
Epoch: 31, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.7195794582366943
Epoch: 32, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7861933708190918
Epoch: 33, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8987538814544678
Epoch: 34, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7494256496429443
Epoch: 35, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8760471343994141
Epoch: 36, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9526023864746094
Epoch: 37, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8874521255493164
Epoch: 38, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8584301471710205
Epoch: 39, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 0.8611934185028076
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7481808662414551
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 0.7388753890991211
Epoch: 42, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.8485252857208252
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9131040573120117
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9120867252349854
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9806194305419922
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7975733280181885
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7860991954803467
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8751075267791748
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9327585697174072
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7510559558868408
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.8753025531768799
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 1.043609380722046
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.8171560764312744
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 1.1587703227996826
Epoch: 55, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.9952473640441895
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 0.9513638019561768
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 1.0219967365264893
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 59 cost time: 0.9729986190795898
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 60 cost time: 0.865302562713623
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 61 cost time: 0.9107425212860107
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 0.9454512596130371
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7915365695953369
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 64 cost time: 1.142716884613037
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7779371738433838
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8076159954071045
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.8699030876159668
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.0241355895996094
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.083444356918335
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.9159929752349854
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.3525192737579346
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.1661641597747803
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.0620739459991455
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1629852
model size : 8.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4687211513519287
Epoch: 1, Steps: 3 | Train Loss: 1.621 Vali Loss: 1.470 Vali Acc: 0.325 Test Loss: 1.470 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.8553235530853271
Epoch: 2, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.455 Vali Acc: 0.325 Test Loss: 1.455 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.8797378540039062
Epoch: 3, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.441 Vali Acc: 0.325 Test Loss: 1.441 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.838421106338501
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.406 Vali Acc: 0.325 Test Loss: 1.406 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.8875150680541992
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.8554112911224365
Epoch: 6, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.309 Vali Acc: 0.375 Test Loss: 1.309 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.0384294986724854
Epoch: 7, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.8275003433227539
Epoch: 8, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.9210975170135498
Epoch: 9, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.177 Vali Acc: 0.450 Test Loss: 1.177 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8475351333618164
Epoch: 10, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.137 Vali Acc: 0.525 Test Loss: 1.137 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9222543239593506
Epoch: 11, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.8458449840545654
Epoch: 12, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8795900344848633
Epoch: 13, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.998 Vali Acc: 0.500 Test Loss: 0.998 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.855292797088623
Epoch: 14, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.7920949459075928
Epoch: 15, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.9769644737243652
Epoch: 16, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.860 Vali Acc: 0.675 Test Loss: 0.860 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3905460834503174
Epoch: 17, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.832 Vali Acc: 0.775 Test Loss: 0.832 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.9915316104888916
Epoch: 18, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.8913352489471436
Epoch: 19, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.768 Vali Acc: 0.775 Test Loss: 0.768 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8899633884429932
Epoch: 20, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.8911843299865723
Epoch: 21, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 0.909963846206665
Epoch: 22, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.7547390460968018
Epoch: 23, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.6937723159790039
Epoch: 24, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9128365516662598
Epoch: 25, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7020916938781738
Epoch: 26, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.827338457107544
Epoch: 27, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8830246925354004
Epoch: 28, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9485480785369873
Epoch: 29, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.8879444599151611
Epoch: 30, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 31 cost time: 0.8955309391021729
Epoch: 31, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0350086688995361
Epoch: 32, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7018654346466064
Epoch: 33, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.452 Vali Acc: 0.800 Test Loss: 0.452 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7468061447143555
Epoch: 34, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7160663604736328
Epoch: 35, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.431 Vali Acc: 0.800 Test Loss: 0.431 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8215484619140625
Epoch: 36, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.417 Vali Acc: 0.825 Test Loss: 0.417 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8993473052978516
Epoch: 37, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9354343414306641
Epoch: 38, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8948566913604736
Epoch: 39, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8400149345397949
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1628700
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.440074920654297
Epoch: 1, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.466 Vali Acc: 0.300 Test Loss: 1.466 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.8743667602539062
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.444 Vali Acc: 0.300 Test Loss: 1.444 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.0840187072753906
Epoch: 3, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.443 Vali Acc: 0.275 Test Loss: 1.443 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7121922969818115
Epoch: 4, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.440 Vali Acc: 0.275 Test Loss: 1.440 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6370348930358887
Epoch: 5, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.357 Vali Acc: 0.425 Test Loss: 1.357 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.742741584777832
Epoch: 6, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.714695930480957
Epoch: 7, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.6618556976318359
Epoch: 8, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8040082454681396
Epoch: 9, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.8193767070770264
Epoch: 10, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.138 Vali Acc: 0.450 Test Loss: 1.138 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7526113986968994
Epoch: 11, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.021 Vali Acc: 0.675 Test Loss: 1.021 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.8951930999755859
Epoch: 12, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.941 Vali Acc: 0.800 Test Loss: 0.941 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.8753905296325684
Epoch: 13, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.946 Vali Acc: 0.600 Test Loss: 0.946 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9118599891662598
Epoch: 14, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.76999831199646
Epoch: 15, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.843743085861206
Epoch: 16, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7942442893981934
Epoch: 17, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.774 Vali Acc: 0.725 Test Loss: 0.774 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8438897132873535
Epoch: 18, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.9018464088439941
Epoch: 19, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8665046691894531
Epoch: 20, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.7948126792907715
Epoch: 21, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 0.6632626056671143
Epoch: 22, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 0.6620175838470459
Epoch: 23, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 24 cost time: 0.7914965152740479
Epoch: 24, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7309205532073975
Epoch: 25, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5985422134399414
Epoch: 26, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8946189880371094
Epoch: 27, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.710 Vali Acc: 0.575 Test Loss: 0.710 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8360981941223145
Epoch: 28, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.475 Vali Acc: 0.825 Test Loss: 0.475 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 29 cost time: 0.7236430644989014
Epoch: 29, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.542 Vali Acc: 0.775 Test Loss: 0.542 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9371616840362549
Epoch: 30, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8874833583831787
Epoch: 31, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0424830913543701
Epoch: 32, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8542807102203369
Epoch: 33, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.473 Vali Acc: 0.825 Test Loss: 0.473 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 34 cost time: 0.8161835670471191
Epoch: 34, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.451 Vali Acc: 0.825 Test Loss: 0.451 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 35 cost time: 0.833869457244873
Epoch: 35, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.500 Vali Acc: 0.800 Test Loss: 0.500 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7389593124389648
Epoch: 36, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9975078105926514
Epoch: 37, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.436 Vali Acc: 0.825 Test Loss: 0.436 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 38 cost time: 0.7549221515655518
Epoch: 38, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.438 Vali Acc: 0.825 Test Loss: 0.438 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7449891567230225
Epoch: 39, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.421 Vali Acc: 0.825 Test Loss: 0.421 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 40 cost time: 0.7752640247344971
Epoch: 40, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.424 Vali Acc: 0.800 Test Loss: 0.424 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8154740333557129
Epoch: 41, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.414 Vali Acc: 0.825 Test Loss: 0.414 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 42 cost time: 0.755403995513916
Epoch: 42, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.824996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.7986259460449219
Epoch: 43, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7420423030853271
Epoch: 44, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8048675060272217
Epoch: 45, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.821387767791748
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7321124076843262
Epoch: 47, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 48 cost time: 0.7475295066833496
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8582515716552734
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.066260814666748
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7746398448944092
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 52 cost time: 0.7992863655090332
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 0.8155031204223633
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.8260445594787598
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7934141159057617
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8640587329864502
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7850158214569092
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.8640413284301758
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7973201274871826
Epoch: 59, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.8341946601867676
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1603357791900635
Epoch: 61, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.8334171772003174
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8779947757720947
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1627548
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6144165992736816
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.343 Vali Acc: 0.400 Test Loss: 1.343 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.7029881477355957
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.352 Vali Acc: 0.450 Test Loss: 1.352 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.7030088901519775
Epoch: 3, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.341 Vali Acc: 0.350 Test Loss: 1.341 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7282118797302246
Epoch: 4, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.8240485191345215
Epoch: 5, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.249 Vali Acc: 0.450 Test Loss: 1.249 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.846754789352417
Epoch: 6, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.207 Vali Acc: 0.425 Test Loss: 1.207 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.788435697555542
Epoch: 7, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.7423441410064697
Epoch: 8, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.7413055896759033
Epoch: 9, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.072 Vali Acc: 0.725 Test Loss: 1.072 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.7713170051574707
Epoch: 10, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.031 Vali Acc: 0.725 Test Loss: 1.031 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7130043506622314
Epoch: 11, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.990 Vali Acc: 0.625 Test Loss: 0.990 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6546468734741211
Epoch: 12, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.924 Vali Acc: 0.650 Test Loss: 0.924 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9401781558990479
Epoch: 13, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.868 Vali Acc: 0.850 Test Loss: 0.868 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 14 cost time: 0.6991996765136719
Epoch: 14, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.883 Vali Acc: 0.575 Test Loss: 0.883 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7405703067779541
Epoch: 15, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.837 Vali Acc: 0.650 Test Loss: 0.837 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7820639610290527
Epoch: 16, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9443085193634033
Epoch: 17, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7511637210845947
Epoch: 18, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.668696403503418
Epoch: 19, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.8096249103546143
Epoch: 20, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8363466262817383
Epoch: 21, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.818284273147583
Epoch: 22, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.9369966983795166
Epoch: 23, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1912219524383545
Epoch: 24, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7734215259552002
Epoch: 25, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.779576301574707
Epoch: 26, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 0.7991440296173096
Epoch: 27, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.7413609027862549
Epoch: 28, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 0.6919107437133789
Epoch: 29, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8232653141021729
Epoch: 30, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 31 cost time: 0.739734411239624
Epoch: 31, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7357368469238281
Epoch: 32, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0328102111816406
Epoch: 33, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8733980655670166
Epoch: 34, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8343119621276855
Epoch: 35, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7417187690734863
Epoch: 36, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 37 cost time: 0.7461428642272949
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7993528842926025
Epoch: 38, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 39 cost time: 0.829075813293457
Epoch: 39, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 0.6602630615234375
Epoch: 40, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 41 cost time: 1.1048800945281982
Epoch: 41, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8173377513885498
Epoch: 42, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.7534046173095703
Epoch: 43, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.896291971206665
Epoch: 44, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9989891052246094
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.675990104675293
Epoch: 46, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8426318168640137
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8984072208404541
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 49 cost time: 0.6575870513916016
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 50 cost time: 0.7304739952087402
Epoch: 50, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 51 cost time: 0.6870877742767334
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7809107303619385
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9905879497528076
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 54 cost time: 0.7878611087799072
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 55 cost time: 1.0185604095458984
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 56 cost time: 0.7978503704071045
Epoch: 56, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 57 cost time: 0.8967039585113525
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 58 cost time: 0.6776680946350098
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7328455448150635
Epoch: 59, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 60 cost time: 0.886986255645752
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 61 cost time: 0.7317233085632324
Epoch: 61, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9020042419433594
Epoch: 62, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8558552265167236
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7584025859832764
Epoch: 64, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8433640003204346
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7152538299560547
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6726326942443848
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.7467405796051025
Epoch: 68, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8277709484100342
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6766195297241211
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 71 cost time: 0.7410199642181396
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 72 cost time: 0.7742555141448975
Epoch: 72, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 73 cost time: 0.7932124137878418
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 74 cost time: 0.7064723968505859
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 75 cost time: 0.720529317855835
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 76 cost time: 0.760643482208252
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7995288372039795
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.6509172916412354
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.6948511600494385
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8431506156921387
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.8910384178161621
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.7945291996002197
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.8905274868011475
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.7668144702911377
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.0051257610321045
Epoch: 85, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1236252
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9508471488952637
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.013059377670288
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7433087825775146
Epoch: 3, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.370 Vali Acc: 0.275 Test Loss: 1.370 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0992352962493896
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.351 Vali Acc: 0.325 Test Loss: 1.351 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8926184177398682
Epoch: 5, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.7580986022949219
Epoch: 6, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.231 Vali Acc: 0.475 Test Loss: 1.231 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.8194763660430908
Epoch: 7, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.181 Vali Acc: 0.475 Test Loss: 1.181 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.71004319190979
Epoch: 8, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.8443949222564697
Epoch: 9, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.148 Vali Acc: 0.450 Test Loss: 1.148 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9791982173919678
Epoch: 10, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.170 Vali Acc: 0.450 Test Loss: 1.170 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8541028499603271
Epoch: 11, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.9989533424377441
Epoch: 12, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.956 Vali Acc: 0.625 Test Loss: 0.956 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.8156857490539551
Epoch: 13, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
Validation loss decreased (-0.624990 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.7930428981781006
Epoch: 14, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.965 Vali Acc: 0.575 Test Loss: 0.965 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.702993631362915
Epoch: 15, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.940 Vali Acc: 0.575 Test Loss: 0.940 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7991623878479004
Epoch: 16, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.822 Vali Acc: 0.650 Test Loss: 0.822 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6493933200836182
Epoch: 17, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.7800798416137695
Epoch: 18, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.753 Vali Acc: 0.625 Test Loss: 0.753 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7551779747009277
Epoch: 19, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.829 Vali Acc: 0.575 Test Loss: 0.829 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8170616626739502
Epoch: 20, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.816 Vali Acc: 0.675 Test Loss: 0.816 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9228625297546387
Epoch: 21, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.818 Vali Acc: 0.650 Test Loss: 0.818 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7404193878173828
Epoch: 22, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.633 Vali Acc: 0.900 Test Loss: 0.633 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.8232259750366211
Epoch: 23, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.698 Vali Acc: 0.600 Test Loss: 0.698 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8337607383728027
Epoch: 24, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.6901319026947021
Epoch: 25, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8309123516082764
Epoch: 26, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7467288970947266
Epoch: 27, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7095217704772949
Epoch: 28, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6341836452484131
Epoch: 29, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8103299140930176
Epoch: 30, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7943339347839355
Epoch: 31, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.7427194118499756
Epoch: 32, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8382003307342529
Epoch: 33, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6614494323730469
Epoch: 34, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.793830394744873
Epoch: 35, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7941102981567383
Epoch: 36, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.718008279800415
Epoch: 37, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8432772159576416
Epoch: 38, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9951858520507812
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7327520847320557
Epoch: 40, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.697526216506958
Epoch: 41, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1235100
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5601186752319336
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.389 Vali Acc: 0.150 Test Loss: 1.389 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.8164370059967041
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.400 Vali Acc: 0.300 Test Loss: 1.400 Test Acc: 0.300
Validation loss decreased (-0.149986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7070064544677734
Epoch: 3, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.441 Vali Acc: 0.325 Test Loss: 1.441 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.616565465927124
Epoch: 4, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.402 Vali Acc: 0.325 Test Loss: 1.402 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6099309921264648
Epoch: 5, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.8671140670776367
Epoch: 6, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.256 Vali Acc: 0.450 Test Loss: 1.256 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.8553965091705322
Epoch: 7, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.201 Vali Acc: 0.425 Test Loss: 1.201 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9507842063903809
Epoch: 8, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.790790319442749
Epoch: 9, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.680675745010376
Epoch: 10, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.7795100212097168
Epoch: 11, Steps: 3 | Train Loss: 0.759 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.7458558082580566
Epoch: 12, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.7548551559448242
Epoch: 13, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6355338096618652
Epoch: 14, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.7405316829681396
Epoch: 15, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.7291784286499023
Epoch: 16, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.7323441505432129
Epoch: 17, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0132255554199219
Epoch: 18, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.848569393157959
Epoch: 19, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.741 Vali Acc: 0.825 Test Loss: 0.741 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 0.7206690311431885
Epoch: 20, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7695803642272949
Epoch: 21, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8760926723480225
Epoch: 22, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.7143599987030029
Epoch: 23, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8259627819061279
Epoch: 24, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6532895565032959
Epoch: 25, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.941577672958374
Epoch: 26, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6849896907806396
Epoch: 27, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.701 Vali Acc: 0.575 Test Loss: 0.701 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6941139698028564
Epoch: 28, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.630 Vali Acc: 0.650 Test Loss: 0.630 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6794466972351074
Epoch: 29, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7165427207946777
Epoch: 30, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7833497524261475
Epoch: 31, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.878288745880127
Epoch: 32, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1233948
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.494366407394409
Epoch: 1, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.380 Vali Acc: 0.125 Test Loss: 1.380 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.8444395065307617
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (-0.124986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.9289617538452148
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.398 Vali Acc: 0.425 Test Loss: 1.398 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.7154762744903564
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6983964443206787
Epoch: 5, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6960439682006836
Epoch: 6, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.709244966506958
Epoch: 7, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.230 Vali Acc: 0.575 Test Loss: 1.230 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.7713661193847656
Epoch: 8, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.7091858386993408
Epoch: 9, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.104 Vali Acc: 0.725 Test Loss: 1.104 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.7960777282714844
Epoch: 10, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.102 Vali Acc: 0.700 Test Loss: 1.102 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.812699556350708
Epoch: 11, Steps: 3 | Train Loss: 0.724 Vali Loss: 1.077 Vali Acc: 0.650 Test Loss: 1.077 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7793242931365967
Epoch: 12, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.989 Vali Acc: 0.650 Test Loss: 0.989 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6803791522979736
Epoch: 13, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.86063551902771
Epoch: 14, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7228233814239502
Epoch: 15, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7259454727172852
Epoch: 16, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.820 Vali Acc: 0.700 Test Loss: 0.820 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.888704776763916
Epoch: 17, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0144271850585938
Epoch: 18, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.6866152286529541
Epoch: 19, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8109493255615234
Epoch: 20, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7765185832977295
Epoch: 21, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8394510746002197
Epoch: 22, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.720 Vali Acc: 0.800 Test Loss: 0.720 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8649978637695312
Epoch: 23, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0908663272857666
Epoch: 24, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.843916654586792
Epoch: 25, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 0.8184459209442139
Epoch: 26, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1003987789154053
Epoch: 27, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8106648921966553
Epoch: 28, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.611 Vali Acc: 0.800 Test Loss: 0.611 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8056941032409668
Epoch: 29, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8245086669921875
Epoch: 30, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8239388465881348
Epoch: 31, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7878448963165283
Epoch: 32, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8359932899475098
Epoch: 33, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6810941696166992
Epoch: 34, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.511 Vali Acc: 0.775 Test Loss: 0.511 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7586829662322998
Epoch: 35, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.531 Vali Acc: 0.800 Test Loss: 0.531 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 1232796
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.289422035217285
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.356 Vali Acc: 0.150 Test Loss: 1.356 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.7352621555328369
Epoch: 2, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.344 Vali Acc: 0.275 Test Loss: 1.344 Test Acc: 0.275
Validation loss decreased (-0.149986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.8909053802490234
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.359 Vali Acc: 0.325 Test Loss: 1.359 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.757554292678833
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.6377620697021484
Epoch: 5, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.331 Vali Acc: 0.425 Test Loss: 1.331 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.8343770503997803
Epoch: 6, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.261 Vali Acc: 0.525 Test Loss: 1.261 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.9142506122589111
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8438465595245361
Epoch: 8, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7619311809539795
Epoch: 9, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.111 Vali Acc: 0.525 Test Loss: 1.111 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.7251713275909424
Epoch: 10, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.069 Vali Acc: 0.725 Test Loss: 1.069 Test Acc: 0.725
Validation loss decreased (-0.524989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.929135799407959
Epoch: 11, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8523037433624268
Epoch: 12, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.635188102722168
Epoch: 13, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.938 Vali Acc: 0.650 Test Loss: 0.938 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1892375946044922
Epoch: 14, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 0.802100658416748
Epoch: 15, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.843 Vali Acc: 0.700 Test Loss: 0.843 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9123039245605469
Epoch: 16, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.9575393199920654
Epoch: 17, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.808 Vali Acc: 0.675 Test Loss: 0.808 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7483394145965576
Epoch: 18, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.7922544479370117
Epoch: 19, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.6968677043914795
Epoch: 20, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7920513153076172
Epoch: 21, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.643 Vali Acc: 0.825 Test Loss: 0.643 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 0.8725700378417969
Epoch: 22, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7641372680664062
Epoch: 23, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 0.660076379776001
Epoch: 24, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8941493034362793
Epoch: 25, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 0.7477691173553467
Epoch: 26, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 0.8238310813903809
Epoch: 27, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.6784224510192871
Epoch: 28, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.781583309173584
Epoch: 29, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.7346205711364746
Epoch: 30, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 31 cost time: 0.7869834899902344
Epoch: 31, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 32 cost time: 0.7887530326843262
Epoch: 32, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 33 cost time: 0.8278381824493408
Epoch: 33, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.398 Vali Acc: 0.825 Test Loss: 0.398 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7011895179748535
Epoch: 34, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8716137409210205
Epoch: 35, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.769911527633667
Epoch: 36, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 37 cost time: 0.8426036834716797
Epoch: 37, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7875444889068604
Epoch: 38, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6564788818359375
Epoch: 39, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 0.6545276641845703
Epoch: 40, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 41 cost time: 0.7576205730438232
Epoch: 41, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7063651084899902
Epoch: 42, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 1.1190266609191895
Epoch: 43, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0443034172058105
Epoch: 44, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 45 cost time: 0.8978574275970459
Epoch: 45, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9160897731781006
Epoch: 46, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 0.6301534175872803
Epoch: 47, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7609939575195312
Epoch: 48, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7502975463867188
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7345025539398193
Epoch: 50, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7766551971435547
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.751617431640625
Epoch: 52, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.3250391483306885
Epoch: 53, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.114105224609375
Epoch: 54, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.85231614112854
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 1.180422306060791
Epoch: 56, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9265656471252441
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1950552463531494
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.0554389953613281
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9443316459655762
Epoch: 60, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9268772602081299
Epoch: 61, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.4538428783416748
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.1195547580718994
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.1541969776153564
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.1249897480010986
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1038876
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.90387225151062
Epoch: 1, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.571 Vali Acc: 0.200 Test Loss: 1.571 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.8757030963897705
Epoch: 2, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.501 Vali Acc: 0.100 Test Loss: 1.501 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6884860992431641
Epoch: 3, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.458 Vali Acc: 0.175 Test Loss: 1.458 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7376563549041748
Epoch: 4, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6837849617004395
Epoch: 5, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6654746532440186
Epoch: 6, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.8107624053955078
Epoch: 7, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.375 Vali Acc: 0.325 Test Loss: 1.375 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8309652805328369
Epoch: 8, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.7387850284576416
Epoch: 9, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.7901773452758789
Epoch: 10, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.187 Vali Acc: 0.450 Test Loss: 1.187 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7418441772460938
Epoch: 11, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.188 Vali Acc: 0.450 Test Loss: 1.188 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8894119262695312
Epoch: 12, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.8080027103424072
Epoch: 13, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.084 Vali Acc: 0.425 Test Loss: 1.084 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7952260971069336
Epoch: 14, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.7610020637512207
Epoch: 15, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.7567458152770996
Epoch: 16, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.6787853240966797
Epoch: 17, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.882 Vali Acc: 0.725 Test Loss: 0.882 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7920336723327637
Epoch: 18, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.956 Vali Acc: 0.675 Test Loss: 0.956 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8821079730987549
Epoch: 19, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.942 Vali Acc: 0.625 Test Loss: 0.942 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7057769298553467
Epoch: 20, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.819 Vali Acc: 0.725 Test Loss: 0.819 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6808648109436035
Epoch: 21, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.7505621910095215
Epoch: 22, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.769 Vali Acc: 0.600 Test Loss: 0.769 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6826410293579102
Epoch: 23, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8015832901000977
Epoch: 24, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7108159065246582
Epoch: 25, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 26 cost time: 0.7339873313903809
Epoch: 26, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.665635347366333
Epoch: 27, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 0.8956465721130371
Epoch: 28, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7701408863067627
Epoch: 29, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.626 Vali Acc: 0.825 Test Loss: 0.626 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.9026565551757812
Epoch: 30, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.600 Vali Acc: 0.800 Test Loss: 0.600 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8150482177734375
Epoch: 31, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9232580661773682
Epoch: 32, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 33 cost time: 0.8883514404296875
Epoch: 33, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 34 cost time: 0.7327539920806885
Epoch: 34, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7683627605438232
Epoch: 35, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.641425371170044
Epoch: 36, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 37 cost time: 0.7689988613128662
Epoch: 37, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6953692436218262
Epoch: 38, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.888469934463501
Epoch: 39, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.574 Vali Acc: 0.800 Test Loss: 0.574 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9325544834136963
Epoch: 40, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7621257305145264
Epoch: 41, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.808729887008667
Epoch: 42, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.547 Vali Acc: 0.800 Test Loss: 0.547 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7873382568359375
Epoch: 43, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.539 Vali Acc: 0.800 Test Loss: 0.539 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9940509796142578
Epoch: 44, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.546 Vali Acc: 0.800 Test Loss: 0.546 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7696690559387207
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7932069301605225
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 0.7801926136016846
Epoch: 47, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8972530364990234
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1448736190795898
Epoch: 49, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9282958507537842
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0029668807983398
Epoch: 51, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0061824321746826
Epoch: 52, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7579202651977539
Epoch: 53, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8632986545562744
Epoch: 54, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7137250900268555
Epoch: 55, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9147260189056396
Epoch: 56, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 1037724
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2959768772125244
Epoch: 1, Steps: 3 | Train Loss: 1.601 Vali Loss: 1.412 Vali Acc: 0.150 Test Loss: 1.412 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.8145418167114258
Epoch: 2, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.397 Vali Acc: 0.075 Test Loss: 1.397 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0300896167755127
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.427 Vali Acc: 0.325 Test Loss: 1.427 Test Acc: 0.325
Validation loss decreased (-0.149986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7562777996063232
Epoch: 4, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.470 Vali Acc: 0.300 Test Loss: 1.470 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8754534721374512
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.411 Vali Acc: 0.350 Test Loss: 1.411 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.851219654083252
Epoch: 6, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.8081567287445068
Epoch: 7, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.226 Vali Acc: 0.525 Test Loss: 1.226 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.8481423854827881
Epoch: 8, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.186 Vali Acc: 0.450 Test Loss: 1.186 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8495128154754639
Epoch: 9, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.133 Vali Acc: 0.475 Test Loss: 1.133 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9467918872833252
Epoch: 10, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.098 Vali Acc: 0.550 Test Loss: 1.098 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.8362927436828613
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.9042007923126221
Epoch: 12, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.050 Vali Acc: 0.725 Test Loss: 1.050 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.0198049545288086
Epoch: 13, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.987 Vali Acc: 0.550 Test Loss: 0.987 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0159738063812256
Epoch: 14, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.8902008533477783
Epoch: 15, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 16 cost time: 0.8199410438537598
Epoch: 16, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.846 Vali Acc: 0.525 Test Loss: 0.846 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.72066330909729
Epoch: 17, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
Validation loss decreased (-0.724992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.7092010974884033
Epoch: 18, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.791 Vali Acc: 0.650 Test Loss: 0.791 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.006732702255249
Epoch: 19, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7632482051849365
Epoch: 20, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.8031833171844482
Epoch: 21, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 0.7233891487121582
Epoch: 22, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8619108200073242
Epoch: 23, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.7484478950500488
Epoch: 24, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.8172345161437988
Epoch: 25, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7104818820953369
Epoch: 26, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8876223564147949
Epoch: 27, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.8304159641265869
Epoch: 28, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 0.758859395980835
Epoch: 29, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.9349911212921143
Epoch: 30, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.8071866035461426
Epoch: 31, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.9017913341522217
Epoch: 32, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 33 cost time: 0.7039783000946045
Epoch: 33, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 34 cost time: 0.7157289981842041
Epoch: 34, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7596609592437744
Epoch: 35, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7025389671325684
Epoch: 36, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8132710456848145
Epoch: 37, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8564903736114502
Epoch: 38, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.913982629776001
Epoch: 39, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7247436046600342
Epoch: 40, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 41 cost time: 0.7920217514038086
Epoch: 41, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9241476058959961
Epoch: 42, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.8761293888092041
Epoch: 43, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8199155330657959
Epoch: 44, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8081238269805908
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8335971832275391
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8129711151123047
Epoch: 47, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8530170917510986
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0056517124176025
Epoch: 49, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7179596424102783
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7392842769622803
Epoch: 51, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.891155481338501
Epoch: 52, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1036572
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.577908992767334
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.410 Vali Acc: 0.325 Test Loss: 1.410 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.1203784942626953
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9247281551361084
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.422 Vali Acc: 0.300 Test Loss: 1.422 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0473613739013672
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8823401927947998
Epoch: 5, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.8665246963500977
Epoch: 6, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.297 Vali Acc: 0.525 Test Loss: 1.297 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.8643321990966797
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.226 Vali Acc: 0.525 Test Loss: 1.226 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.7736835479736328
Epoch: 8, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.177 Vali Acc: 0.600 Test Loss: 1.177 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.7578332424163818
Epoch: 9, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.148 Vali Acc: 0.600 Test Loss: 1.148 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.7381083965301514
Epoch: 10, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.9482641220092773
Epoch: 11, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.067 Vali Acc: 0.675 Test Loss: 1.067 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.7606112957000732
Epoch: 12, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.7933974266052246
Epoch: 13, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.9229235649108887
Epoch: 14, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.934 Vali Acc: 0.575 Test Loss: 0.934 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7612950801849365
Epoch: 15, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
Validation loss decreased (-0.699990 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.8153071403503418
Epoch: 16, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.859 Vali Acc: 0.525 Test Loss: 0.859 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9913477897644043
Epoch: 17, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.807 Vali Acc: 0.825 Test Loss: 0.807 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9935386180877686
Epoch: 18, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8781161308288574
Epoch: 19, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.751 Vali Acc: 0.725 Test Loss: 0.751 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.886826753616333
Epoch: 20, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.809 Vali Acc: 0.700 Test Loss: 0.809 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8309130668640137
Epoch: 21, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8654062747955322
Epoch: 22, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 0.8194141387939453
Epoch: 23, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7813596725463867
Epoch: 24, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.8408482074737549
Epoch: 25, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.795403242111206
Epoch: 26, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.045236349105835
Epoch: 27, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0020952224731445
Epoch: 28, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9859092235565186
Epoch: 29, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7654163837432861
Epoch: 30, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 31 cost time: 0.8131821155548096
Epoch: 31, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.617 Vali Acc: 0.600 Test Loss: 0.617 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0159566402435303
Epoch: 32, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 33 cost time: 0.8234992027282715
Epoch: 33, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7858278751373291
Epoch: 34, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8645730018615723
Epoch: 35, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7882270812988281
Epoch: 36, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8707966804504395
Epoch: 37, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8887217044830322
Epoch: 38, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9504764080047607
Epoch: 39, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1597034931182861
Epoch: 40, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.976473331451416
Epoch: 41, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0763170719146729
Epoch: 42, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 1035420
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.58670711517334
Epoch: 1, Steps: 3 | Train Loss: 1.515 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6715924739837646
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7619960308074951
Epoch: 3, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6418731212615967
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.365 Vali Acc: 0.175 Test Loss: 1.365 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8318500518798828
Epoch: 5, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.317 Vali Acc: 0.350 Test Loss: 1.317 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.8173739910125732
Epoch: 6, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.259 Vali Acc: 0.425 Test Loss: 1.259 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.9323468208312988
Epoch: 7, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.231 Vali Acc: 0.475 Test Loss: 1.231 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.657862663269043
Epoch: 8, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.8613011837005615
Epoch: 9, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8732330799102783
Epoch: 10, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8002698421478271
Epoch: 11, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.064 Vali Acc: 0.575 Test Loss: 1.064 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8328156471252441
Epoch: 12, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.7593333721160889
Epoch: 13, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.8858981132507324
Epoch: 14, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8513529300689697
Epoch: 15, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.7829127311706543
Epoch: 16, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.884 Vali Acc: 0.625 Test Loss: 0.884 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0022077560424805
Epoch: 17, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.850 Vali Acc: 0.625 Test Loss: 0.850 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8790202140808105
Epoch: 18, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.808 Vali Acc: 0.650 Test Loss: 0.808 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8790199756622314
Epoch: 19, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 0.8996975421905518
Epoch: 20, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.6974740028381348
Epoch: 21, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.753 Vali Acc: 0.700 Test Loss: 0.753 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8718602657318115
Epoch: 22, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.773 Vali Acc: 0.650 Test Loss: 0.773 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6600797176361084
Epoch: 23, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.9232916831970215
Epoch: 24, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.671 Vali Acc: 0.750 Test Loss: 0.671 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9090073108673096
Epoch: 25, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.706 Vali Acc: 0.700 Test Loss: 0.706 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.727428674697876
Epoch: 26, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 0.8034858703613281
Epoch: 27, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0853841304779053
Epoch: 28, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 29 cost time: 0.7425839900970459
Epoch: 29, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8233394622802734
Epoch: 30, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 31 cost time: 0.6826608180999756
Epoch: 31, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0184314250946045
Epoch: 32, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.555 Vali Acc: 0.800 Test Loss: 0.555 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8029181957244873
Epoch: 33, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.232522964477539
Epoch: 34, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2859423160552979
Epoch: 35, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.597 Vali Acc: 0.800 Test Loss: 0.597 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2233192920684814
Epoch: 36, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0964763164520264
Epoch: 37, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 38 cost time: 1.022043228149414
Epoch: 38, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.520 Vali Acc: 0.800 Test Loss: 0.520 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1917672157287598
Epoch: 39, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.504 Vali Acc: 0.825 Test Loss: 0.504 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 40 cost time: 1.532522201538086
Epoch: 40, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.520 Vali Acc: 0.800 Test Loss: 0.520 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9073209762573242
Epoch: 41, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8935410976409912
Epoch: 42, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.528 Vali Acc: 0.800 Test Loss: 0.528 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9016542434692383
Epoch: 43, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.525 Vali Acc: 0.800 Test Loss: 0.525 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.108931541442871
Epoch: 44, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.527 Vali Acc: 0.800 Test Loss: 0.527 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0976252555847168
Epoch: 45, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.196875810623169
Epoch: 46, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1299996376037598
Epoch: 47, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.800 Test Loss: 0.519 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1133832931518555
Epoch: 48, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.161017894744873
Epoch: 49, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 940188
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6027965545654297
Epoch: 1, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.501 Vali Acc: 0.300 Test Loss: 1.501 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.8284103870391846
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.442 Vali Acc: 0.275 Test Loss: 1.442 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8967921733856201
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.410 Vali Acc: 0.375 Test Loss: 1.410 Test Acc: 0.375
Validation loss decreased (-0.299985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.9917593002319336
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.369 Vali Acc: 0.425 Test Loss: 1.369 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.9164271354675293
Epoch: 5, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.358 Vali Acc: 0.275 Test Loss: 1.358 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0565195083618164
Epoch: 6, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1572883129119873
Epoch: 7, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.339 Vali Acc: 0.525 Test Loss: 1.339 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.9409494400024414
Epoch: 8, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.301 Vali Acc: 0.575 Test Loss: 1.301 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 0.8969407081604004
Epoch: 9, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.211 Vali Acc: 0.525 Test Loss: 1.211 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9420804977416992
Epoch: 10, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.906782865524292
Epoch: 11, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.8789935111999512
Epoch: 12, Steps: 3 | Train Loss: 0.704 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0798125267028809
Epoch: 13, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.134 Vali Acc: 0.700 Test Loss: 1.134 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 1.135603427886963
Epoch: 14, Steps: 3 | Train Loss: 0.656 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.7622027397155762
Epoch: 15, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9869875907897949
Epoch: 16, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.900 Vali Acc: 0.775 Test Loss: 0.900 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 1.1215083599090576
Epoch: 17, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.887 Vali Acc: 0.700 Test Loss: 0.887 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8548319339752197
Epoch: 18, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1197388172149658
Epoch: 19, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.907 Vali Acc: 0.600 Test Loss: 0.907 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8779699802398682
Epoch: 20, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.815 Vali Acc: 0.725 Test Loss: 0.815 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.782768726348877
Epoch: 21, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.781 Vali Acc: 0.675 Test Loss: 0.781 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0293025970458984
Epoch: 22, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.760 Vali Acc: 0.750 Test Loss: 0.760 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.084918737411499
Epoch: 23, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.820143461227417
Epoch: 24, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3270933628082275
Epoch: 25, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 1.036048173904419
Epoch: 26, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 0.9557483196258545
Epoch: 27, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.8699054718017578
Epoch: 28, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.746 Vali Acc: 0.575 Test Loss: 0.746 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9359879493713379
Epoch: 29, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 30 cost time: 0.9862542152404785
Epoch: 30, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.628 Vali Acc: 0.825 Test Loss: 0.628 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 31 cost time: 0.8649909496307373
Epoch: 31, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.94197678565979
Epoch: 32, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7262074947357178
Epoch: 33, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.980466365814209
Epoch: 34, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.668 Vali Acc: 0.800 Test Loss: 0.668 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8215055465698242
Epoch: 35, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7395968437194824
Epoch: 36, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9529554843902588
Epoch: 37, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7811379432678223
Epoch: 38, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 39 cost time: 1.0126562118530273
Epoch: 39, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8576862812042236
Epoch: 40, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7016792297363281
Epoch: 41, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.628 Vali Acc: 0.800 Test Loss: 0.628 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9106075763702393
Epoch: 42, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.072974443435669
Epoch: 43, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.612 Vali Acc: 0.825 Test Loss: 0.612 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8116779327392578
Epoch: 44, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9539384841918945
Epoch: 45, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8905181884765625
Epoch: 46, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7544596195220947
Epoch: 47, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.981818437576294
Epoch: 48, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 939036
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6002912521362305
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9069342613220215
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.397 Vali Acc: 0.325 Test Loss: 1.397 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.8806447982788086
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.383 Vali Acc: 0.325 Test Loss: 1.383 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8400363922119141
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.7022318840026855
Epoch: 5, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.271 Vali Acc: 0.450 Test Loss: 1.271 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.9217543601989746
Epoch: 6, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.256 Vali Acc: 0.375 Test Loss: 1.256 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7371883392333984
Epoch: 7, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.221 Vali Acc: 0.375 Test Loss: 1.221 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8035664558410645
Epoch: 8, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.7682256698608398
Epoch: 9, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.134 Vali Acc: 0.525 Test Loss: 1.134 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8223445415496826
Epoch: 10, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0785157680511475
Epoch: 11, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.021 Vali Acc: 0.750 Test Loss: 1.021 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.7164762020111084
Epoch: 12, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.052 Vali Acc: 0.450 Test Loss: 1.052 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8233911991119385
Epoch: 13, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8881936073303223
Epoch: 14, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.891 Vali Acc: 0.825 Test Loss: 0.891 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.8651225566864014
Epoch: 15, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.903623104095459
Epoch: 16, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8419809341430664
Epoch: 17, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8433456420898438
Epoch: 18, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.718 Vali Acc: 0.825 Test Loss: 0.718 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 0.8910903930664062
Epoch: 19, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.674 Vali Acc: 0.875 Test Loss: 0.674 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.8717207908630371
Epoch: 20, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8611347675323486
Epoch: 21, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1089439392089844
Epoch: 22, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7639985084533691
Epoch: 23, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8014962673187256
Epoch: 24, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.6634161472320557
Epoch: 25, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8120095729827881
Epoch: 26, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7437300682067871
Epoch: 27, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8660919666290283
Epoch: 28, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.600 Vali Acc: 0.800 Test Loss: 0.600 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8247265815734863
Epoch: 29, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9954891204833984
Epoch: 30, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.514 Vali Acc: 0.800 Test Loss: 0.514 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7906641960144043
Epoch: 31, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7017762660980225
Epoch: 32, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7452178001403809
Epoch: 33, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.440 Vali Acc: 0.825 Test Loss: 0.440 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8113970756530762
Epoch: 34, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.444 Vali Acc: 0.825 Test Loss: 0.444 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 937884
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2865123748779297
Epoch: 1, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6659262180328369
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.390 Vali Acc: 0.325 Test Loss: 1.390 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.6446998119354248
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.397 Vali Acc: 0.350 Test Loss: 1.397 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5828747749328613
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.389 Vali Acc: 0.350 Test Loss: 1.389 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.7211356163024902
Epoch: 5, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.6032376289367676
Epoch: 6, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.316 Vali Acc: 0.375 Test Loss: 1.316 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6967823505401611
Epoch: 7, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.274 Vali Acc: 0.425 Test Loss: 1.274 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6674513816833496
Epoch: 8, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.7350730895996094
Epoch: 9, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.130 Vali Acc: 0.700 Test Loss: 1.130 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.7292969226837158
Epoch: 10, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6761112213134766
Epoch: 11, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7312517166137695
Epoch: 12, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.058 Vali Acc: 0.675 Test Loss: 1.058 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7523283958435059
Epoch: 13, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.6238765716552734
Epoch: 14, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.910 Vali Acc: 0.600 Test Loss: 0.910 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7594871520996094
Epoch: 15, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.892 Vali Acc: 0.625 Test Loss: 0.892 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7873992919921875
Epoch: 16, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.6907832622528076
Epoch: 17, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.866 Vali Acc: 0.725 Test Loss: 0.866 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.793846607208252
Epoch: 18, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.763 Vali Acc: 0.775 Test Loss: 0.763 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 0.6806931495666504
Epoch: 19, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.725 Vali Acc: 0.675 Test Loss: 0.725 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7690927982330322
Epoch: 20, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.6870808601379395
Epoch: 21, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 0.9456491470336914
Epoch: 22, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.683 Vali Acc: 0.775 Test Loss: 0.683 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.666217565536499
Epoch: 23, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 0.7038376331329346
Epoch: 24, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 0.865729808807373
Epoch: 25, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 0.7896668910980225
Epoch: 26, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 0.7290244102478027
Epoch: 27, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6905038356781006
Epoch: 28, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6486945152282715
Epoch: 29, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.694998025894165
Epoch: 30, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.548 Vali Acc: 0.775 Test Loss: 0.548 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7959713935852051
Epoch: 31, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9382166862487793
Epoch: 32, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.482 Vali Acc: 0.825 Test Loss: 0.482 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.736879825592041
Epoch: 33, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 0.7137670516967773
Epoch: 34, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 0.7719578742980957
Epoch: 35, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6727254390716553
Epoch: 36, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.464 Vali Acc: 0.825 Test Loss: 0.464 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7227418422698975
Epoch: 37, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.454 Vali Acc: 0.825 Test Loss: 0.454 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6346244812011719
Epoch: 38, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 39 cost time: 0.7924103736877441
Epoch: 39, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 40 cost time: 0.6825544834136963
Epoch: 40, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.428 Vali Acc: 0.825 Test Loss: 0.428 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7612740993499756
Epoch: 41, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7833578586578369
Epoch: 42, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.825 Test Loss: 0.437 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9259600639343262
Epoch: 43, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.449 Vali Acc: 0.800 Test Loss: 0.449 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8903021812438965
Epoch: 44, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.444 Vali Acc: 0.825 Test Loss: 0.444 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9778299331665039
Epoch: 45, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2369463443756104
Epoch: 46, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.453 Vali Acc: 0.800 Test Loss: 0.453 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0320580005645752
Epoch: 47, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8911933898925781
Epoch: 48, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.849996 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 0.7974612712860107
Epoch: 49, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.448 Vali Acc: 0.825 Test Loss: 0.448 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2195580005645752
Epoch: 50, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.426 Vali Acc: 0.825 Test Loss: 0.426 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7473795413970947
Epoch: 51, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.701366662979126
Epoch: 52, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.7803878784179688
Epoch: 53, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8770701885223389
Epoch: 54, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.390 Vali Acc: 0.825 Test Loss: 0.390 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0074598789215088
Epoch: 55, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6809532642364502
Epoch: 56, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9302535057067871
Epoch: 57, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7589099407196045
Epoch: 58, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.7627499103546143
Epoch: 59, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9213805198669434
Epoch: 60, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.725696325302124
Epoch: 61, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.89786696434021
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 936732
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2118582725524902
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.461 Vali Acc: 0.275 Test Loss: 1.461 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.8898220062255859
Epoch: 2, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.443 Vali Acc: 0.275 Test Loss: 1.443 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.877394437789917
Epoch: 3, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.428 Vali Acc: 0.300 Test Loss: 1.428 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.8441462516784668
Epoch: 4, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.409 Vali Acc: 0.300 Test Loss: 1.409 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.8558108806610107
Epoch: 5, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.399 Vali Acc: 0.300 Test Loss: 1.399 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.0144858360290527
Epoch: 6, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.8167879581451416
Epoch: 7, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.331 Vali Acc: 0.525 Test Loss: 1.331 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.9200263023376465
Epoch: 8, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.288 Vali Acc: 0.625 Test Loss: 1.288 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.8980700969696045
Epoch: 9, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8055417537689209
Epoch: 10, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.208 Vali Acc: 0.575 Test Loss: 1.208 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8573691844940186
Epoch: 11, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8468325138092041
Epoch: 12, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.162 Vali Acc: 0.475 Test Loss: 1.162 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8965191841125488
Epoch: 13, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.131 Vali Acc: 0.450 Test Loss: 1.131 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9274699687957764
Epoch: 14, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.788311243057251
Epoch: 15, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.085 Vali Acc: 0.525 Test Loss: 1.085 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9156966209411621
Epoch: 16, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.794867753982544
Epoch: 17, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.1116700172424316
Epoch: 18, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.893 Vali Acc: 0.800 Test Loss: 0.893 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.8969240188598633
Epoch: 19, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.899 Vali Acc: 0.800 Test Loss: 0.899 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8661048412322998
Epoch: 20, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0354697704315186
Epoch: 21, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.841 Vali Acc: 0.725 Test Loss: 0.841 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9258737564086914
Epoch: 22, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.8304665088653564
Epoch: 23, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 0.7589070796966553
Epoch: 24, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.848574161529541
Epoch: 25, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 0.7487359046936035
Epoch: 26, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2754695415496826
Epoch: 27, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0927438735961914
Epoch: 28, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9985482692718506
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 0.8795950412750244
Epoch: 30, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.849501371383667
Epoch: 31, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.9808201789855957
Epoch: 32, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 33 cost time: 0.6664767265319824
Epoch: 33, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6734049320220947
Epoch: 34, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 35 cost time: 0.9603309631347656
Epoch: 35, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8912136554718018
Epoch: 36, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.456 Vali Acc: 0.825 Test Loss: 0.456 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8261024951934814
Epoch: 37, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 38 cost time: 0.8826389312744141
Epoch: 38, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9574499130249023
Epoch: 39, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 1.0165011882781982
Epoch: 40, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 41 cost time: 0.9663333892822266
Epoch: 41, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 0.7924947738647461
Epoch: 42, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.143237590789795
Epoch: 43, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9817240238189697
Epoch: 44, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 45 cost time: 0.7610867023468018
Epoch: 45, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1804215908050537
Epoch: 46, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 0.7717981338500977
Epoch: 47, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8329179286956787
Epoch: 48, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 49 cost time: 0.8403558731079102
Epoch: 49, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 50 cost time: 0.8841235637664795
Epoch: 50, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8581459522247314
Epoch: 51, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9123928546905518
Epoch: 52, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 53 cost time: 0.7722532749176025
Epoch: 53, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 54 cost time: 0.9214963912963867
Epoch: 54, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8969588279724121
Epoch: 55, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 56 cost time: 0.8944458961486816
Epoch: 56, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 57 cost time: 0.7308998107910156
Epoch: 57, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 58 cost time: 0.8457925319671631
Epoch: 58, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 59 cost time: 0.7352983951568604
Epoch: 59, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9233882427215576
Epoch: 60, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9278759956359863
Epoch: 61, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 62 cost time: 0.9637656211853027
Epoch: 62, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9486982822418213
Epoch: 63, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.1997795104980469
Epoch: 64, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8608448505401611
Epoch: 65, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9035286903381348
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.0081861019134521
Epoch: 67, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.9201364517211914
Epoch: 68, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.922626256942749
Epoch: 69, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.9944391250610352
Epoch: 70, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 71 cost time: 0.981534481048584
Epoch: 71, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 72 cost time: 0.8312628269195557
Epoch: 72, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9561748504638672
Epoch: 73, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 74 cost time: 0.8113760948181152
Epoch: 74, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 75 cost time: 0.8312163352966309
Epoch: 75, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 76 cost time: 0.6553294658660889
Epoch: 76, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 77 cost time: 0.7256875038146973
Epoch: 77, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 78 cost time: 0.6734921932220459
Epoch: 78, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.1449146270751953
Epoch: 79, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8993160724639893
Epoch: 80, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.8126220703125
Epoch: 81, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 82 cost time: 0.8968665599822998
Epoch: 82, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 83 cost time: 0.8182692527770996
Epoch: 83, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 84 cost time: 0.6452090740203857
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 85 cost time: 0.7369532585144043
Epoch: 85, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 86 cost time: 0.6464157104492188
Epoch: 86, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 87 cost time: 0.7423300743103027
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 88 cost time: 0.7129559516906738
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 89 cost time: 0.8177711963653564
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 90 cost time: 0.7589571475982666
Epoch: 90, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.807816743850708
Epoch: 91, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7574067115783691
Epoch: 92, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.7654099464416504
Epoch: 93, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 1.0026910305023193
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.8737897872924805
Epoch: 95, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.8694722652435303
Epoch: 96, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.742140531539917
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.8004636764526367
Epoch: 98, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.8513221740722656
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 620444
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.709812641143799
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.256 Vali Acc: 0.525 Test Loss: 1.256 Test Acc: 0.525
Validation loss decreased (inf --> -0.524987).  Saving model ...
Epoch: 2 cost time: 0.9268348217010498
Epoch: 2, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.263 Vali Acc: 0.475 Test Loss: 1.263 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8568100929260254
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.260 Vali Acc: 0.475 Test Loss: 1.260 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0013608932495117
Epoch: 4, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.258 Vali Acc: 0.475 Test Loss: 1.258 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.059253454208374
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9570131301879883
Epoch: 6, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.949099063873291
Epoch: 7, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.152 Vali Acc: 0.525 Test Loss: 1.152 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.078826665878296
Epoch: 8, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.7816123962402344
Epoch: 9, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7773730754852295
Epoch: 10, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.051 Vali Acc: 0.725 Test Loss: 1.051 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.8849966526031494
Epoch: 11, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.023 Vali Acc: 0.625 Test Loss: 1.023 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.864375114440918
Epoch: 12, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.905754804611206
Epoch: 13, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.947 Vali Acc: 0.675 Test Loss: 0.947 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.904015064239502
Epoch: 14, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.902 Vali Acc: 0.700 Test Loss: 0.902 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9199466705322266
Epoch: 15, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.9119720458984375
Epoch: 16, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.9713351726531982
Epoch: 17, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0196099281311035
Epoch: 18, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.769658088684082
Epoch: 19, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 0.8957867622375488
Epoch: 20, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.1499042510986328
Epoch: 21, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.7069191932678223
Epoch: 22, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9011094570159912
Epoch: 23, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9681777954101562
Epoch: 24, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.8080389499664307
Epoch: 25, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7593646049499512
Epoch: 26, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8571879863739014
Epoch: 27, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8102569580078125
Epoch: 28, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.8100693225860596
Epoch: 29, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.8931159973144531
Epoch: 30, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7735872268676758
Epoch: 31, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8135209083557129
Epoch: 32, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.7380437850952148
Epoch: 33, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.8418560028076172
Epoch: 34, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 0.7827098369598389
Epoch: 35, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.7658782005310059
Epoch: 36, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6810705661773682
Epoch: 37, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9507145881652832
Epoch: 38, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.970181941986084
Epoch: 39, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8606598377227783
Epoch: 40, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8832137584686279
Epoch: 41, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8678443431854248
Epoch: 42, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9086325168609619
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8570327758789062
Epoch: 44, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9102909564971924
Epoch: 45, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 619868
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4275643825531006
Epoch: 1, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.431 Vali Acc: 0.275 Test Loss: 1.431 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.902782678604126
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.386 Vali Acc: 0.375 Test Loss: 1.386 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.913480281829834
Epoch: 3, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.8431737422943115
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.371 Vali Acc: 0.375 Test Loss: 1.371 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.8957304954528809
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.346 Vali Acc: 0.425 Test Loss: 1.346 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.810460090637207
Epoch: 6, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0688331127166748
Epoch: 7, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.298 Vali Acc: 0.525 Test Loss: 1.298 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.9174838066101074
Epoch: 8, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7341039180755615
Epoch: 9, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.266 Vali Acc: 0.425 Test Loss: 1.266 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9012365341186523
Epoch: 10, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.208 Vali Acc: 0.525 Test Loss: 1.208 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.7507009506225586
Epoch: 11, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.8069391250610352
Epoch: 12, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.111 Vali Acc: 0.525 Test Loss: 1.111 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7731790542602539
Epoch: 13, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.7477197647094727
Epoch: 14, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.038 Vali Acc: 0.750 Test Loss: 1.038 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.8209061622619629
Epoch: 15, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.005 Vali Acc: 0.575 Test Loss: 1.005 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8571598529815674
Epoch: 16, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.963 Vali Acc: 0.750 Test Loss: 0.963 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.7006726264953613
Epoch: 17, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7701952457427979
Epoch: 18, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.901 Vali Acc: 0.650 Test Loss: 0.901 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8577516078948975
Epoch: 19, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.903 Vali Acc: 0.575 Test Loss: 0.903 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.848196268081665
Epoch: 20, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.6187655925750732
Epoch: 21, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.9202020168304443
Epoch: 22, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 0.8941085338592529
Epoch: 23, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9596681594848633
Epoch: 24, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.1639888286590576
Epoch: 25, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 0.7647757530212402
Epoch: 26, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9684956073760986
Epoch: 27, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.923175573348999
Epoch: 28, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.9964280128479004
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.476 Vali Acc: 0.950 Test Loss: 0.476 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.7819874286651611
Epoch: 30, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0445032119750977
Epoch: 31, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9809038639068604
Epoch: 32, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9400532245635986
Epoch: 33, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.462 Vali Acc: 0.825 Test Loss: 0.462 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7673254013061523
Epoch: 34, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.453 Vali Acc: 0.825 Test Loss: 0.453 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1081466674804688
Epoch: 35, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8631184101104736
Epoch: 36, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9093117713928223
Epoch: 37, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0666115283966064
Epoch: 38, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9777514934539795
Epoch: 39, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 619292
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.21305251121521
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.480 Vali Acc: 0.275 Test Loss: 1.480 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.937819242477417
Epoch: 2, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.443 Vali Acc: 0.350 Test Loss: 1.443 Test Acc: 0.350
Validation loss decreased (-0.274985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.7323470115661621
Epoch: 3, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.424 Vali Acc: 0.325 Test Loss: 1.424 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8958208560943604
Epoch: 4, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.403 Vali Acc: 0.350 Test Loss: 1.403 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.7104341983795166
Epoch: 5, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.382 Vali Acc: 0.400 Test Loss: 1.382 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.7571771144866943
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.850475549697876
Epoch: 7, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.334 Vali Acc: 0.425 Test Loss: 1.334 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.8000049591064453
Epoch: 8, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.314 Vali Acc: 0.425 Test Loss: 1.314 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.7877655029296875
Epoch: 9, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.276 Vali Acc: 0.425 Test Loss: 1.276 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6537163257598877
Epoch: 10, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.225 Vali Acc: 0.425 Test Loss: 1.225 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 0.6813473701477051
Epoch: 11, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.7656896114349365
Epoch: 12, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9028148651123047
Epoch: 13, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6997427940368652
Epoch: 14, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.7335786819458008
Epoch: 15, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.6278188228607178
Epoch: 16, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.7393138408660889
Epoch: 17, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 0.8899111747741699
Epoch: 18, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.880 Vali Acc: 0.725 Test Loss: 0.880 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.6883230209350586
Epoch: 19, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.863 Vali Acc: 0.650 Test Loss: 0.863 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9269969463348389
Epoch: 20, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.859 Vali Acc: 0.675 Test Loss: 0.859 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6709456443786621
Epoch: 21, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.7557775974273682
Epoch: 22, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 0.9093215465545654
Epoch: 23, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.6333470344543457
Epoch: 24, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.7553737163543701
Epoch: 25, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0319321155548096
Epoch: 26, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7773652076721191
Epoch: 27, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8895392417907715
Epoch: 28, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7782504558563232
Epoch: 29, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.6658082008361816
Epoch: 30, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 31 cost time: 0.756190299987793
Epoch: 31, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.6917033195495605
Epoch: 32, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8023247718811035
Epoch: 33, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 0.6836373805999756
Epoch: 34, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7283906936645508
Epoch: 35, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7199912071228027
Epoch: 36, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.765317440032959
Epoch: 37, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.8362553119659424
Epoch: 38, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8976395130157471
Epoch: 39, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.8938779830932617
Epoch: 40, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.6971089839935303
Epoch: 41, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.8014087677001953
Epoch: 42, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.7599358558654785
Epoch: 43, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.7229940891265869
Epoch: 44, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.7664155960083008
Epoch: 45, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 0.7779710292816162
Epoch: 46, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 0.6174945831298828
Epoch: 47, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9269154071807861
Epoch: 48, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 0.8986763954162598
Epoch: 49, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.7632403373718262
Epoch: 50, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 0.7336404323577881
Epoch: 51, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 0.8689010143280029
Epoch: 52, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 0.7146351337432861
Epoch: 53, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8975837230682373
Epoch: 54, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.844428539276123
Epoch: 55, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7595481872558594
Epoch: 56, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9139821529388428
Epoch: 57, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 0.8303160667419434
Epoch: 58, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 0.7527623176574707
Epoch: 59, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 60 cost time: 0.6511838436126709
Epoch: 60, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 61 cost time: 0.6663069725036621
Epoch: 61, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7753739356994629
Epoch: 62, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7081208229064941
Epoch: 63, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.813861608505249
Epoch: 64, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8014440536499023
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8045432567596436
Epoch: 66, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.9432575702667236
Epoch: 67, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.787240743637085
Epoch: 68, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.9205043315887451
Epoch: 69, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.9291131496429443
Epoch: 70, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 618716
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6526167392730713
Epoch: 1, Steps: 3 | Train Loss: 1.594 Vali Loss: 1.456 Vali Acc: 0.200 Test Loss: 1.456 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.7368698120117188
Epoch: 2, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
Validation loss decreased (-0.199985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6893975734710693
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.428 Vali Acc: 0.325 Test Loss: 1.428 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7219178676605225
Epoch: 4, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.440 Vali Acc: 0.325 Test Loss: 1.440 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.700014591217041
Epoch: 5, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.453 Vali Acc: 0.300 Test Loss: 1.453 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6857235431671143
Epoch: 6, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.444 Vali Acc: 0.250 Test Loss: 1.444 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7475354671478271
Epoch: 7, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.404 Vali Acc: 0.525 Test Loss: 1.404 Test Acc: 0.525
Validation loss decreased (-0.324986 --> -0.524986).  Saving model ...
Epoch: 8 cost time: 0.69553542137146
Epoch: 8, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
Validation loss decreased (-0.524986 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 0.7774250507354736
Epoch: 9, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.291 Vali Acc: 0.450 Test Loss: 1.291 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6960659027099609
Epoch: 10, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.252 Vali Acc: 0.625 Test Loss: 1.252 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 11 cost time: 0.7535841464996338
Epoch: 11, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.212 Vali Acc: 0.700 Test Loss: 1.212 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.7098157405853271
Epoch: 12, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.180 Vali Acc: 0.725 Test Loss: 1.180 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 13 cost time: 0.7710869312286377
Epoch: 13, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.186 Vali Acc: 0.675 Test Loss: 1.186 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6823875904083252
Epoch: 14, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.177 Vali Acc: 0.675 Test Loss: 1.177 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9130983352661133
Epoch: 15, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.134 Vali Acc: 0.675 Test Loss: 1.134 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7733840942382812
Epoch: 16, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7415659427642822
Epoch: 17, Steps: 3 | Train Loss: 0.733 Vali Loss: 1.013 Vali Acc: 0.750 Test Loss: 1.013 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.8693418502807617
Epoch: 18, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.8666932582855225
Epoch: 19, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8633217811584473
Epoch: 20, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7269752025604248
Epoch: 21, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.925 Vali Acc: 0.675 Test Loss: 0.925 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6940405368804932
Epoch: 22, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7992234230041504
Epoch: 23, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.7218832969665527
Epoch: 24, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8577010631561279
Epoch: 25, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.816 Vali Acc: 0.700 Test Loss: 0.816 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0801737308502197
Epoch: 26, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7548303604125977
Epoch: 27, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8066833019256592
Epoch: 28, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 29 cost time: 0.9311838150024414
Epoch: 29, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.7964992523193359
Epoch: 30, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.634 Vali Acc: 0.875 Test Loss: 0.634 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6644811630249023
Epoch: 31, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.655 Vali Acc: 0.825 Test Loss: 0.655 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7217745780944824
Epoch: 32, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7728023529052734
Epoch: 33, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.618 Vali Acc: 0.800 Test Loss: 0.618 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7388598918914795
Epoch: 34, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8487365245819092
Epoch: 35, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.586 Vali Acc: 0.800 Test Loss: 0.586 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9798591136932373
Epoch: 36, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7449326515197754
Epoch: 37, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.01344633102417
Epoch: 38, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 0.6913940906524658
Epoch: 39, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 0.7361712455749512
Epoch: 40, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7432961463928223
Epoch: 41, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 42 cost time: 0.6586418151855469
Epoch: 42, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.501 Vali Acc: 0.825 Test Loss: 0.501 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7714343070983887
Epoch: 43, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6965258121490479
Epoch: 44, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8179833889007568
Epoch: 45, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9405341148376465
Epoch: 46, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6873862743377686
Epoch: 47, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 0.7266807556152344
Epoch: 48, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.935204267501831
Epoch: 49, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.7121360301971436
Epoch: 50, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.7433273792266846
Epoch: 51, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.6715483665466309
Epoch: 52, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7906961441040039
Epoch: 53, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 0.792672872543335
Epoch: 54, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 0.7252712249755859
Epoch: 55, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9930734634399414
Epoch: 56, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 0.8247337341308594
Epoch: 57, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.8613588809967041
Epoch: 58, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7366113662719727
Epoch: 59, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.668175458908081
Epoch: 60, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8792839050292969
Epoch: 61, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6622281074523926
Epoch: 62, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7000629901885986
Epoch: 63, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9279134273529053
Epoch: 64, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.9442412853240967
Epoch: 65, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0135183334350586
Epoch: 66, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.827704668045044
Epoch: 67, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.8175022602081299
Epoch: 68, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.7459535598754883
Epoch: 69, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 422300
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4499096870422363
Epoch: 1, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.430 Vali Acc: 0.100 Test Loss: 1.430 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.7129957675933838
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.444 Vali Acc: 0.375 Test Loss: 1.444 Test Acc: 0.375
Validation loss decreased (-0.099986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.640902042388916
Epoch: 3, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.461 Vali Acc: 0.375 Test Loss: 1.461 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7234556674957275
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.461 Vali Acc: 0.350 Test Loss: 1.461 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0102918148040771
Epoch: 5, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.436 Vali Acc: 0.475 Test Loss: 1.436 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.8380391597747803
Epoch: 6, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.401 Vali Acc: 0.375 Test Loss: 1.401 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.939523458480835
Epoch: 7, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.345 Vali Acc: 0.600 Test Loss: 1.345 Test Acc: 0.600
Validation loss decreased (-0.474986 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 0.7241084575653076
Epoch: 8, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.882706880569458
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8954176902770996
Epoch: 10, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.6638500690460205
Epoch: 11, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.220 Vali Acc: 0.725 Test Loss: 1.220 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 12 cost time: 0.8238508701324463
Epoch: 12, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.189 Vali Acc: 0.700 Test Loss: 1.189 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6529030799865723
Epoch: 13, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.158 Vali Acc: 0.750 Test Loss: 1.158 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749988).  Saving model ...
Epoch: 14 cost time: 0.726487398147583
Epoch: 14, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.122 Vali Acc: 0.750 Test Loss: 1.122 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 15 cost time: 0.8894443511962891
Epoch: 15, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.742469072341919
Epoch: 16, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 17 cost time: 0.9940612316131592
Epoch: 17, Steps: 3 | Train Loss: 0.695 Vali Loss: 1.003 Vali Acc: 0.775 Test Loss: 1.003 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 0.7108428478240967
Epoch: 18, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.987 Vali Acc: 0.800 Test Loss: 0.987 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 19 cost time: 0.7145974636077881
Epoch: 19, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7559390068054199
Epoch: 20, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7840185165405273
Epoch: 21, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.6509888172149658
Epoch: 22, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8975677490234375
Epoch: 23, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7079474925994873
Epoch: 24, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8072834014892578
Epoch: 25, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9309258460998535
Epoch: 26, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.807469367980957
Epoch: 27, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7645351886749268
Epoch: 28, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8649556636810303
Epoch: 29, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.8404073715209961
Epoch: 30, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.8644897937774658
Epoch: 31, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8695111274719238
Epoch: 32, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7952959537506104
Epoch: 33, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8391625881195068
Epoch: 34, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8742260932922363
Epoch: 35, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8545477390289307
Epoch: 36, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9734833240509033
Epoch: 37, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8554489612579346
Epoch: 38, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7386584281921387
Epoch: 39, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.486 Vali Acc: 0.825 Test Loss: 0.486 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.923560619354248
Epoch: 40, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.485 Vali Acc: 0.825 Test Loss: 0.485 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 421724
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.625540018081665
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.492 Vali Acc: 0.325 Test Loss: 1.492 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.7798397541046143
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.428 Vali Acc: 0.375 Test Loss: 1.428 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.6836965084075928
Epoch: 3, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.379 Vali Acc: 0.350 Test Loss: 1.379 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8281617164611816
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.324 Vali Acc: 0.350 Test Loss: 1.324 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7297182083129883
Epoch: 5, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.284 Vali Acc: 0.350 Test Loss: 1.284 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7571127414703369
Epoch: 6, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.256 Vali Acc: 0.525 Test Loss: 1.256 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.9534447193145752
Epoch: 7, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.8439071178436279
Epoch: 8, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.209 Vali Acc: 0.575 Test Loss: 1.209 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.7747769355773926
Epoch: 9, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.8669295310974121
Epoch: 10, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8270761966705322
Epoch: 11, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.7241885662078857
Epoch: 12, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.080 Vali Acc: 0.725 Test Loss: 1.080 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.8894257545471191
Epoch: 13, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.037 Vali Acc: 0.725 Test Loss: 1.037 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.826427698135376
Epoch: 14, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.997 Vali Acc: 0.725 Test Loss: 0.997 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 0.9121317863464355
Epoch: 15, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.8751001358032227
Epoch: 16, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7643132209777832
Epoch: 17, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 0.9452006816864014
Epoch: 18, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.881 Vali Acc: 0.625 Test Loss: 0.881 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8199954032897949
Epoch: 19, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.815 Vali Acc: 0.700 Test Loss: 0.815 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0102438926696777
Epoch: 20, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 0.7990972995758057
Epoch: 21, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.756 Vali Acc: 0.725 Test Loss: 0.756 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7708356380462646
Epoch: 22, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 23 cost time: 0.8922104835510254
Epoch: 23, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.774993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.7444586753845215
Epoch: 24, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9331445693969727
Epoch: 25, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7010369300842285
Epoch: 26, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.641 Vali Acc: 0.775 Test Loss: 0.641 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8878064155578613
Epoch: 27, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.6734797954559326
Epoch: 28, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.7740581035614014
Epoch: 29, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.9475762844085693
Epoch: 30, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.7670693397521973
Epoch: 31, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.8557238578796387
Epoch: 32, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.7457547187805176
Epoch: 33, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.9265999794006348
Epoch: 34, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8511388301849365
Epoch: 35, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.857407808303833
Epoch: 36, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.860424280166626
Epoch: 37, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.8334944248199463
Epoch: 38, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.7219147682189941
Epoch: 39, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.8726778030395508
Epoch: 40, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.7117555141448975
Epoch: 41, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.837604284286499
Epoch: 42, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.0367381572723389
Epoch: 43, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.7769320011138916
Epoch: 44, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.0296146869659424
Epoch: 45, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.0185060501098633
Epoch: 46, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8854682445526123
Epoch: 47, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8585317134857178
Epoch: 48, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7968761920928955
Epoch: 49, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7445068359375
Epoch: 50, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 0.7374863624572754
Epoch: 51, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.7517874240875244
Epoch: 52, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 0.6685638427734375
Epoch: 53, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 0.7197065353393555
Epoch: 54, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 0.9193296432495117
Epoch: 55, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.835674524307251
Epoch: 56, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.8150923252105713
Epoch: 57, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.8085224628448486
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 0.7229759693145752
Epoch: 59, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 0.8193178176879883
Epoch: 60, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.897986650466919
Epoch: 61, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 0.8884315490722656
Epoch: 62, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 0.8797807693481445
Epoch: 63, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 0.8181643486022949
Epoch: 64, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8333597183227539
Epoch: 65, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8956499099731445
Epoch: 66, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.7920291423797607
Epoch: 67, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.8689620494842529
Epoch: 68, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.791062593460083
Epoch: 69, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7232503890991211
Epoch: 70, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7254331111907959
Epoch: 71, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 1.0348186492919922
Epoch: 72, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 73 cost time: 0.683018684387207
Epoch: 73, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 0.6358070373535156
Epoch: 74, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 0.7641456127166748
Epoch: 75, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7583587169647217
Epoch: 76, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7077507972717285
Epoch: 77, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.9442248344421387
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.8775937557220459
Epoch: 79, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 80 cost time: 0.700192928314209
Epoch: 80, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 81 cost time: 0.8539035320281982
Epoch: 81, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 82 cost time: 0.8772251605987549
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9493250846862793
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8270933628082275
Epoch: 84, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.7045793533325195
Epoch: 85, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.8059310913085938
Epoch: 86, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.7746138572692871
Epoch: 87, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 88 cost time: 0.6678228378295898
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 89 cost time: 0.7488632202148438
Epoch: 89, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 90 cost time: 0.8481717109680176
Epoch: 90, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 91 cost time: 0.704941987991333
Epoch: 91, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 92 cost time: 0.7447125911712646
Epoch: 92, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 93 cost time: 0.6420929431915283
Epoch: 93, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 94 cost time: 0.9175279140472412
Epoch: 94, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.804304838180542
Epoch: 95, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.8025743961334229
Epoch: 96, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 97 cost time: 0.7276871204376221
Epoch: 97, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 98 cost time: 0.7600681781768799
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 99 cost time: 0.9603779315948486
Epoch: 99, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 100 cost time: 0.7176790237426758
Epoch: 100, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 421148
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1199042797088623
Epoch: 1, Steps: 3 | Train Loss: 1.623 Vali Loss: 1.481 Vali Acc: 0.200 Test Loss: 1.481 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6654281616210938
Epoch: 2, Steps: 3 | Train Loss: 1.551 Vali Loss: 1.430 Vali Acc: 0.150 Test Loss: 1.430 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7744324207305908
Epoch: 3, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.395 Vali Acc: 0.450 Test Loss: 1.395 Test Acc: 0.450
Validation loss decreased (-0.199985 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.9274048805236816
Epoch: 4, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7495055198669434
Epoch: 5, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9924931526184082
Epoch: 6, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.314 Vali Acc: 0.475 Test Loss: 1.314 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.7405648231506348
Epoch: 7, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.281 Vali Acc: 0.475 Test Loss: 1.281 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.7323815822601318
Epoch: 8, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.252 Vali Acc: 0.525 Test Loss: 1.252 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.6651873588562012
Epoch: 9, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7292146682739258
Epoch: 10, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.221 Vali Acc: 0.600 Test Loss: 1.221 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.7571930885314941
Epoch: 11, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.186 Vali Acc: 0.600 Test Loss: 1.186 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.6862077713012695
Epoch: 12, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.7189750671386719
Epoch: 13, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.108 Vali Acc: 0.625 Test Loss: 1.108 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.6822099685668945
Epoch: 14, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.65077805519104
Epoch: 15, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.057 Vali Acc: 0.525 Test Loss: 1.057 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6389248371124268
Epoch: 16, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.8056766986846924
Epoch: 17, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.930 Vali Acc: 0.800 Test Loss: 0.930 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 0.6383507251739502
Epoch: 18, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.909 Vali Acc: 0.700 Test Loss: 0.909 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7726452350616455
Epoch: 19, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6062421798706055
Epoch: 20, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.849 Vali Acc: 0.775 Test Loss: 0.849 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7891674041748047
Epoch: 21, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7279863357543945
Epoch: 22, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.7874419689178467
Epoch: 23, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1684536933898926
Epoch: 24, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.6724612712860107
Epoch: 25, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.688610315322876
Epoch: 26, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.767629861831665
Epoch: 27, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.6600801944732666
Epoch: 28, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7097160816192627
Epoch: 29, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.7233448028564453
Epoch: 30, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.6170902252197266
Epoch: 31, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.7197203636169434
Epoch: 32, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.7362427711486816
Epoch: 33, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7529025077819824
Epoch: 34, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.8296260833740234
Epoch: 35, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8289382457733154
Epoch: 36, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7662312984466553
Epoch: 37, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.652146577835083
Epoch: 38, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.6579837799072266
Epoch: 39, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7542204856872559
Epoch: 40, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6702919006347656
Epoch: 41, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6060597896575928
Epoch: 42, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.718297004699707
Epoch: 43, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.846515417098999
Epoch: 44, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7078030109405518
Epoch: 45, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5806310176849365
Epoch: 46, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7997965812683105
Epoch: 47, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6533200740814209
Epoch: 48, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 420572
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6924829483032227
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.450 Vali Acc: 0.225 Test Loss: 1.450 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.773550271987915
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.442 Vali Acc: 0.225 Test Loss: 1.442 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6552696228027344
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.446 Vali Acc: 0.225 Test Loss: 1.446 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8531320095062256
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.435 Vali Acc: 0.275 Test Loss: 1.435 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.7202630043029785
Epoch: 5, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.8031964302062988
Epoch: 6, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.400 Vali Acc: 0.300 Test Loss: 1.400 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.8162403106689453
Epoch: 7, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.8980963230133057
Epoch: 8, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.332 Vali Acc: 0.475 Test Loss: 1.332 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.8337743282318115
Epoch: 9, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.280 Vali Acc: 0.525 Test Loss: 1.280 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.8153738975524902
Epoch: 10, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.8062834739685059
Epoch: 11, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.225 Vali Acc: 0.375 Test Loss: 1.225 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8834817409515381
Epoch: 12, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9079563617706299
Epoch: 13, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.7508244514465332
Epoch: 14, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.181 Vali Acc: 0.600 Test Loss: 1.181 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.7850744724273682
Epoch: 15, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0282037258148193
Epoch: 16, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9186151027679443
Epoch: 17, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.7449812889099121
Epoch: 18, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.023 Vali Acc: 0.625 Test Loss: 1.023 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 0.8076694011688232
Epoch: 19, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.7162489891052246
Epoch: 20, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.7420949935913086
Epoch: 21, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.922 Vali Acc: 0.650 Test Loss: 0.922 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7982137203216553
Epoch: 22, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.952 Vali Acc: 0.650 Test Loss: 0.952 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0518035888671875
Epoch: 23, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.935 Vali Acc: 0.650 Test Loss: 0.935 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8383417129516602
Epoch: 24, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8630142211914062
Epoch: 25, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 0.7760047912597656
Epoch: 26, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.724 Vali Acc: 0.800 Test Loss: 0.724 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 0.8562231063842773
Epoch: 27, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.700 Vali Acc: 0.800 Test Loss: 0.700 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.7699394226074219
Epoch: 28, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7489666938781738
Epoch: 29, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 0.8314657211303711
Epoch: 30, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.683 Vali Acc: 0.825 Test Loss: 0.683 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 31 cost time: 0.748964786529541
Epoch: 31, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.642 Vali Acc: 0.775 Test Loss: 0.642 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7350473403930664
Epoch: 32, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7725329399108887
Epoch: 33, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7931327819824219
Epoch: 34, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 0.7338213920593262
Epoch: 35, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6533551216125488
Epoch: 36, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.702869176864624
Epoch: 37, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.551 Vali Acc: 0.775 Test Loss: 0.551 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8171277046203613
Epoch: 38, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7090215682983398
Epoch: 39, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.680229902267456
Epoch: 40, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 0.770984411239624
Epoch: 41, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.700883150100708
Epoch: 42, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 43 cost time: 0.7081339359283447
Epoch: 43, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 44 cost time: 0.6911029815673828
Epoch: 44, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.98404860496521
Epoch: 45, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 46 cost time: 0.8427002429962158
Epoch: 46, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0058062076568604
Epoch: 47, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7689559459686279
Epoch: 48, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.433 Vali Acc: 0.825 Test Loss: 0.433 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8190429210662842
Epoch: 49, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.419 Vali Acc: 0.825 Test Loss: 0.419 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7839577198028564
Epoch: 50, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.416 Vali Acc: 0.825 Test Loss: 0.416 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.918940544128418
Epoch: 51, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9576606750488281
Epoch: 52, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.441 Vali Acc: 0.825 Test Loss: 0.441 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9388062953948975
Epoch: 53, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.416 Vali Acc: 0.825 Test Loss: 0.416 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8546543121337891
Epoch: 54, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8708338737487793
Epoch: 55, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.424 Vali Acc: 0.825 Test Loss: 0.424 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 323228
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6070196628570557
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.486 Vali Acc: 0.325 Test Loss: 1.486 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.718757152557373
Epoch: 2, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8784852027893066
Epoch: 3, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.440 Vali Acc: 0.225 Test Loss: 1.440 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7227783203125
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8644833564758301
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.393 Vali Acc: 0.275 Test Loss: 1.393 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7795741558074951
Epoch: 6, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.712336540222168
Epoch: 7, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.7590000629425049
Epoch: 8, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.834219217300415
Epoch: 9, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.295 Vali Acc: 0.350 Test Loss: 1.295 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 0.9543516635894775
Epoch: 10, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.8873107433319092
Epoch: 11, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.7581379413604736
Epoch: 12, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.237 Vali Acc: 0.475 Test Loss: 1.237 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9653186798095703
Epoch: 13, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.197 Vali Acc: 0.525 Test Loss: 1.197 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.0033140182495117
Epoch: 14, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.148 Vali Acc: 0.450 Test Loss: 1.148 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7554779052734375
Epoch: 15, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.6589353084564209
Epoch: 16, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.6176445484161377
Epoch: 17, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.7308275699615479
Epoch: 18, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.011 Vali Acc: 0.650 Test Loss: 1.011 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6764874458312988
Epoch: 19, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.6413118839263916
Epoch: 20, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 21 cost time: 0.8227808475494385
Epoch: 21, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1857283115386963
Epoch: 22, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.855 Vali Acc: 0.725 Test Loss: 0.855 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8400957584381104
Epoch: 23, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.806 Vali Acc: 0.825 Test Loss: 0.806 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.7700791358947754
Epoch: 24, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8846554756164551
Epoch: 25, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7677295207977295
Epoch: 26, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.785 Vali Acc: 0.725 Test Loss: 0.785 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8724124431610107
Epoch: 27, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.730 Vali Acc: 0.700 Test Loss: 0.730 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9723029136657715
Epoch: 28, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 0.714728593826294
Epoch: 29, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.8162369728088379
Epoch: 30, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8966424465179443
Epoch: 31, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8644447326660156
Epoch: 32, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 0.7729382514953613
Epoch: 33, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 0.8306009769439697
Epoch: 34, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8309564590454102
Epoch: 35, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 36 cost time: 0.7138004302978516
Epoch: 36, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8940603733062744
Epoch: 37, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.985234260559082
Epoch: 38, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9478366374969482
Epoch: 39, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7564949989318848
Epoch: 40, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 0.8996481895446777
Epoch: 41, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.8615286350250244
Epoch: 42, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 1.0504124164581299
Epoch: 43, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.0353198051452637
Epoch: 44, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.7911615371704102
Epoch: 45, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8342640399932861
Epoch: 46, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 0.7659122943878174
Epoch: 47, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.04714035987854
Epoch: 48, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7081246376037598
Epoch: 49, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0191519260406494
Epoch: 50, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7726955413818359
Epoch: 51, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7671911716461182
Epoch: 52, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7833962440490723
Epoch: 53, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 0.6874837875366211
Epoch: 54, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8284192085266113
Epoch: 55, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.089648962020874
Epoch: 56, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8389177322387695
Epoch: 57, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0265305042266846
Epoch: 58, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.8356037139892578
Epoch: 59, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.7827720642089844
Epoch: 60, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.8714148998260498
Epoch: 61, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.8181569576263428
Epoch: 62, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8549737930297852
Epoch: 63, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 322652
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.393328905105591
Epoch: 1, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.376 Vali Acc: 0.275 Test Loss: 1.376 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.7019777297973633
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.363 Vali Acc: 0.275 Test Loss: 1.363 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6722447872161865
Epoch: 3, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.353 Vali Acc: 0.325 Test Loss: 1.353 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7044196128845215
Epoch: 4, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.344 Vali Acc: 0.375 Test Loss: 1.344 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.6438515186309814
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.7863564491271973
Epoch: 6, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.313 Vali Acc: 0.525 Test Loss: 1.313 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.8482077121734619
Epoch: 7, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624987).  Saving model ...
Epoch: 8 cost time: 0.7890129089355469
Epoch: 8, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.252 Vali Acc: 0.625 Test Loss: 1.252 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.8616917133331299
Epoch: 9, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7372043132781982
Epoch: 10, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.173 Vali Acc: 0.525 Test Loss: 1.173 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6975975036621094
Epoch: 11, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.126 Vali Acc: 0.725 Test Loss: 1.126 Test Acc: 0.725
Validation loss decreased (-0.624987 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.6967682838439941
Epoch: 12, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9438071250915527
Epoch: 13, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.082 Vali Acc: 0.725 Test Loss: 1.082 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 1.02978515625
Epoch: 14, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9441769123077393
Epoch: 15, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.7348697185516357
Epoch: 16, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.6579880714416504
Epoch: 17, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.7007765769958496
Epoch: 18, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.889 Vali Acc: 0.725 Test Loss: 0.889 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7058155536651611
Epoch: 19, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.869 Vali Acc: 0.675 Test Loss: 0.869 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.708101749420166
Epoch: 20, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9343738555908203
Epoch: 21, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.70456862449646
Epoch: 22, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 1.0128283500671387
Epoch: 23, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 0.7301886081695557
Epoch: 24, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 25 cost time: 0.8587954044342041
Epoch: 25, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7549300193786621
Epoch: 26, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.699232816696167
Epoch: 27, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.7160956859588623
Epoch: 28, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.6219244003295898
Epoch: 29, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.7713162899017334
Epoch: 30, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5945656299591064
Epoch: 31, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8901593685150146
Epoch: 32, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6648507118225098
Epoch: 33, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8221304416656494
Epoch: 34, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.488 Vali Acc: 0.800 Test Loss: 0.488 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6915643215179443
Epoch: 35, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6981232166290283
Epoch: 36, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6722457408905029
Epoch: 37, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.7745914459228516
Epoch: 38, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8127539157867432
Epoch: 39, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.488 Vali Acc: 0.825 Test Loss: 0.488 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7444629669189453
Epoch: 40, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 0.6220059394836426
Epoch: 41, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.420 Vali Acc: 0.825 Test Loss: 0.420 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6818950176239014
Epoch: 42, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7305974960327148
Epoch: 43, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 0.7374637126922607
Epoch: 44, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.6725265979766846
Epoch: 45, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7407565116882324
Epoch: 46, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6713590621948242
Epoch: 47, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6558358669281006
Epoch: 48, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6986978054046631
Epoch: 49, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7795495986938477
Epoch: 50, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7205746173858643
Epoch: 51, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7546017169952393
Epoch: 52, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7117888927459717
Epoch: 53, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7486648559570312
Epoch: 54, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 322076
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.337129831314087
Epoch: 1, Steps: 3 | Train Loss: 1.688 Vali Loss: 1.588 Vali Acc: 0.200 Test Loss: 1.588 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.7598381042480469
Epoch: 2, Steps: 3 | Train Loss: 1.612 Vali Loss: 1.500 Vali Acc: 0.100 Test Loss: 1.500 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7347791194915771
Epoch: 3, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.438 Vali Acc: 0.350 Test Loss: 1.438 Test Acc: 0.350
Validation loss decreased (-0.199984 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.733440637588501
Epoch: 4, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.401 Vali Acc: 0.350 Test Loss: 1.401 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.7536807060241699
Epoch: 5, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.374 Vali Acc: 0.350 Test Loss: 1.374 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.7487094402313232
Epoch: 6, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.5976681709289551
Epoch: 7, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.331 Vali Acc: 0.500 Test Loss: 1.331 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.746917724609375
Epoch: 8, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.319 Vali Acc: 0.475 Test Loss: 1.319 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6659338474273682
Epoch: 9, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.308 Vali Acc: 0.475 Test Loss: 1.308 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.697716474533081
Epoch: 10, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.292 Vali Acc: 0.650 Test Loss: 1.292 Test Acc: 0.650
Validation loss decreased (-0.499987 --> -0.649987).  Saving model ...
Epoch: 11 cost time: 0.7178690433502197
Epoch: 11, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.243 Vali Acc: 0.675 Test Loss: 1.243 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.6918208599090576
Epoch: 12, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.200 Vali Acc: 0.625 Test Loss: 1.200 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7881407737731934
Epoch: 13, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.137 Vali Acc: 0.650 Test Loss: 1.137 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7565624713897705
Epoch: 14, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.695051908493042
Epoch: 15, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8752517700195312
Epoch: 16, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.069 Vali Acc: 0.725 Test Loss: 1.069 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 17 cost time: 0.6600930690765381
Epoch: 17, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.062 Vali Acc: 0.575 Test Loss: 1.062 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7904596328735352
Epoch: 18, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.019 Vali Acc: 0.750 Test Loss: 1.019 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.8367798328399658
Epoch: 19, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8302686214447021
Epoch: 20, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.7498488426208496
Epoch: 21, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.898 Vali Acc: 0.800 Test Loss: 0.898 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.7157580852508545
Epoch: 22, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7468173503875732
Epoch: 23, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7810754776000977
Epoch: 24, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7801673412322998
Epoch: 25, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7888166904449463
Epoch: 26, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.7929189205169678
Epoch: 27, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 0.8137640953063965
Epoch: 28, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9146394729614258
Epoch: 29, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0098280906677246
Epoch: 30, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.696 Vali Acc: 0.825 Test Loss: 0.696 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 31 cost time: 0.6473567485809326
Epoch: 31, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.683 Vali Acc: 0.825 Test Loss: 0.683 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 32 cost time: 0.8000662326812744
Epoch: 32, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 33 cost time: 0.8083145618438721
Epoch: 33, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 34 cost time: 0.7644181251525879
Epoch: 34, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.598 Vali Acc: 0.800 Test Loss: 0.598 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.264756202697754
Epoch: 35, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.8872768878936768
Epoch: 36, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.8479170799255371
Epoch: 37, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 1.117248773574829
Epoch: 38, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1254498958587646
Epoch: 39, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.247302770614624
Epoch: 40, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 0.9328658580780029
Epoch: 41, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3356788158416748
Epoch: 42, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.9811646938323975
Epoch: 43, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0451996326446533
Epoch: 44, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 1.1580100059509277
Epoch: 45, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 46 cost time: 1.0076370239257812
Epoch: 46, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 47 cost time: 1.0166497230529785
Epoch: 47, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9563241004943848
Epoch: 48, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 49 cost time: 1.0989906787872314
Epoch: 49, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 50 cost time: 1.278064250946045
Epoch: 50, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 51 cost time: 1.07525634765625
Epoch: 51, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 52 cost time: 1.1204893589019775
Epoch: 52, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1055495738983154
Epoch: 53, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 54 cost time: 0.868366003036499
Epoch: 54, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2020573616027832
Epoch: 55, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 56 cost time: 1.2599496841430664
Epoch: 56, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3195185661315918
Epoch: 57, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 58 cost time: 0.8802061080932617
Epoch: 58, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 59 cost time: 1.0135366916656494
Epoch: 59, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 60 cost time: 1.2498347759246826
Epoch: 60, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 61 cost time: 0.8770623207092285
Epoch: 61, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 62 cost time: 0.8315141201019287
Epoch: 62, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 63 cost time: 1.0066583156585693
Epoch: 63, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 64 cost time: 0.9791545867919922
Epoch: 64, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 65 cost time: 1.015566349029541
Epoch: 65, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 66 cost time: 1.2088088989257812
Epoch: 66, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 67 cost time: 1.0168170928955078
Epoch: 67, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.953380823135376
Epoch: 68, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0051729679107666
Epoch: 69, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.0909838676452637
Epoch: 70, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9472105503082275
Epoch: 71, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.013796329498291
Epoch: 72, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0161082744598389
Epoch: 73, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 74 cost time: 0.950308084487915
Epoch: 74, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 75 cost time: 0.994370698928833
Epoch: 75, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 76 cost time: 1.1725873947143555
Epoch: 76, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 0.8454596996307373
Epoch: 77, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 78 cost time: 1.0333123207092285
Epoch: 78, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 79 cost time: 1.1069581508636475
Epoch: 79, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.0542056560516357
Epoch: 80, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.976862907409668
Epoch: 81, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 82 cost time: 1.180617094039917
Epoch: 82, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8676836490631104
Epoch: 83, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.991185188293457
Epoch: 84, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.2075600624084473
Epoch: 85, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.0929162502288818
Epoch: 86, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.1728980541229248
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.1101291179656982
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.24676513671875
Epoch: 89, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.1651246547698975
Epoch: 90, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.2781314849853516
Epoch: 91, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 321500
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4710521697998047
Epoch: 1, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8428323268890381
Epoch: 2, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.8350303173065186
Epoch: 3, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.392 Vali Acc: 0.300 Test Loss: 1.392 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.7674293518066406
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.7599506378173828
Epoch: 5, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7870242595672607
Epoch: 6, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.8044531345367432
Epoch: 7, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.338 Vali Acc: 0.350 Test Loss: 1.338 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9360780715942383
Epoch: 8, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.9170856475830078
Epoch: 9, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.249 Vali Acc: 0.575 Test Loss: 1.249 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.927978515625
Epoch: 10, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.226 Vali Acc: 0.475 Test Loss: 1.226 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9433281421661377
Epoch: 11, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.202 Vali Acc: 0.450 Test Loss: 1.202 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7640790939331055
Epoch: 12, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.189 Vali Acc: 0.425 Test Loss: 1.189 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7419276237487793
Epoch: 13, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.7342691421508789
Epoch: 14, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.128 Vali Acc: 0.625 Test Loss: 1.128 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8632564544677734
Epoch: 15, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.8011825084686279
Epoch: 16, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.027 Vali Acc: 0.675 Test Loss: 1.027 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.7442348003387451
Epoch: 17, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.004 Vali Acc: 0.725 Test Loss: 1.004 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.8583781719207764
Epoch: 18, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.976 Vali Acc: 0.800 Test Loss: 0.976 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 19 cost time: 0.8158838748931885
Epoch: 19, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.935 Vali Acc: 0.700 Test Loss: 0.935 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.812000036239624
Epoch: 20, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.902 Vali Acc: 0.825 Test Loss: 0.902 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 21 cost time: 0.808908224105835
Epoch: 21, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7288782596588135
Epoch: 22, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.850 Vali Acc: 0.675 Test Loss: 0.850 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8113667964935303
Epoch: 23, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.833 Vali Acc: 0.675 Test Loss: 0.833 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7821362018585205
Epoch: 24, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.730004072189331
Epoch: 25, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8958513736724854
Epoch: 26, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.6664197444915771
Epoch: 27, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.670 Vali Acc: 0.800 Test Loss: 0.670 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8511571884155273
Epoch: 28, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.661 Vali Acc: 0.750 Test Loss: 0.661 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8872115612030029
Epoch: 29, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.7565159797668457
Epoch: 30, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.8765912055969238
Epoch: 31, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8394179344177246
Epoch: 32, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.872645378112793
Epoch: 33, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 1.1913537979125977
Epoch: 34, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8544082641601562
Epoch: 35, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.6776924133300781
Epoch: 36, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6831519603729248
Epoch: 37, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 0.7508375644683838
Epoch: 38, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6265759468078613
Epoch: 39, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.663036584854126
Epoch: 40, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7509901523590088
Epoch: 41, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.820734977722168
Epoch: 42, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.7882392406463623
Epoch: 43, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 44 cost time: 0.8288850784301758
Epoch: 44, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9956111907958984
Epoch: 45, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.467 Vali Acc: 0.825 Test Loss: 0.467 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9447534084320068
Epoch: 46, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6826267242431641
Epoch: 47, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.456 Vali Acc: 0.825 Test Loss: 0.456 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8605504035949707
Epoch: 48, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.445 Vali Acc: 0.825 Test Loss: 0.445 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7056634426116943
Epoch: 49, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.449 Vali Acc: 0.825 Test Loss: 0.449 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.719576358795166
Epoch: 50, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.429 Vali Acc: 0.825 Test Loss: 0.429 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7874751091003418
Epoch: 51, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 52 cost time: 0.8671424388885498
Epoch: 52, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 53 cost time: 0.9956662654876709
Epoch: 53, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.406 Vali Acc: 0.825 Test Loss: 0.406 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.168297529220581
Epoch: 54, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 55 cost time: 0.9037215709686279
Epoch: 55, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9727709293365479
Epoch: 56, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8225953578948975
Epoch: 57, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.413 Vali Acc: 0.825 Test Loss: 0.413 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8859820365905762
Epoch: 58, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 59 cost time: 0.7174928188323975
Epoch: 59, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.391 Vali Acc: 0.825 Test Loss: 0.391 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7381532192230225
Epoch: 60, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 61 cost time: 0.7207012176513672
Epoch: 61, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 62 cost time: 0.7891857624053955
Epoch: 62, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8936572074890137
Epoch: 63, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9058032035827637
Epoch: 64, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8887715339660645
Epoch: 65, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.390 Vali Acc: 0.825 Test Loss: 0.390 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8545236587524414
Epoch: 66, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7898051738739014
Epoch: 67, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.9091699123382568
Epoch: 68, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.8523175716400146
Epoch: 69, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.7067174911499023
Epoch: 70, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.9392859935760498
Epoch: 71, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 72 cost time: 0.7766551971435547
Epoch: 72, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9003250598907471
Epoch: 73, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 74 cost time: 0.997755765914917
Epoch: 74, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 75 cost time: 0.7994837760925293
Epoch: 75, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 76 cost time: 0.9993805885314941
Epoch: 76, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9146876335144043
Epoch: 77, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8668513298034668
Epoch: 78, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.89969801902771
Epoch: 79, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 80 cost time: 0.7115979194641113
Epoch: 80, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 81 cost time: 0.9878988265991211
Epoch: 81, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 82 cost time: 0.9184107780456543
Epoch: 82, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.810866117477417
Epoch: 83, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9337220191955566
Epoch: 84, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 85 cost time: 0.7224698066711426
Epoch: 85, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 86 cost time: 0.8634216785430908
Epoch: 86, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 87 cost time: 0.9171762466430664
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.9489045143127441
Epoch: 88, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.8093109130859375
Epoch: 89, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.8218638896942139
Epoch: 90, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.9010334014892578
Epoch: 91, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.9540691375732422
Epoch: 92, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.9703781604766846
Epoch: 93, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.8781390190124512
Epoch: 94, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.7208378314971924
Epoch: 95, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.6951708793640137
Epoch: 96, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 273692
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.573606014251709
Epoch: 1, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.494 Vali Acc: 0.275 Test Loss: 1.494 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.7539932727813721
Epoch: 2, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.449 Vali Acc: 0.350 Test Loss: 1.449 Test Acc: 0.350
Validation loss decreased (-0.274985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.6816234588623047
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.422 Vali Acc: 0.350 Test Loss: 1.422 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6890485286712646
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6629612445831299
Epoch: 5, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7557125091552734
Epoch: 6, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7997701168060303
Epoch: 7, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.335 Vali Acc: 0.325 Test Loss: 1.335 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8451268672943115
Epoch: 8, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.304 Vali Acc: 0.425 Test Loss: 1.304 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.7204568386077881
Epoch: 9, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.296 Vali Acc: 0.475 Test Loss: 1.296 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.6724588871002197
Epoch: 10, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8967304229736328
Epoch: 11, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.7096116542816162
Epoch: 12, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.210 Vali Acc: 0.675 Test Loss: 1.210 Test Acc: 0.675
Validation loss decreased (-0.474988 --> -0.674988).  Saving model ...
Epoch: 13 cost time: 0.7245965003967285
Epoch: 13, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7812595367431641
Epoch: 14, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.162 Vali Acc: 0.600 Test Loss: 1.162 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8160676956176758
Epoch: 15, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7731456756591797
Epoch: 16, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7097070217132568
Epoch: 17, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.060 Vali Acc: 0.725 Test Loss: 1.060 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 18 cost time: 0.9358987808227539
Epoch: 18, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8397223949432373
Epoch: 19, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.036 Vali Acc: 0.725 Test Loss: 1.036 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 20 cost time: 0.7593755722045898
Epoch: 20, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.983 Vali Acc: 0.675 Test Loss: 0.983 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.730118989944458
Epoch: 21, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.951 Vali Acc: 0.675 Test Loss: 0.951 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6977629661560059
Epoch: 22, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.915 Vali Acc: 0.675 Test Loss: 0.915 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7755980491638184
Epoch: 23, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 24 cost time: 0.8203067779541016
Epoch: 24, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 0.857426643371582
Epoch: 25, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9507181644439697
Epoch: 26, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.863 Vali Acc: 0.700 Test Loss: 0.863 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8978402614593506
Epoch: 27, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.910041093826294
Epoch: 28, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 29 cost time: 0.8953485488891602
Epoch: 29, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.744 Vali Acc: 0.825 Test Loss: 0.744 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 0.831925630569458
Epoch: 30, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.674630880355835
Epoch: 31, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8754487037658691
Epoch: 32, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.925206184387207
Epoch: 33, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.687 Vali Acc: 0.825 Test Loss: 0.687 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6775712966918945
Epoch: 34, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.696 Vali Acc: 0.825 Test Loss: 0.696 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7249975204467773
Epoch: 35, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.654 Vali Acc: 0.825 Test Loss: 0.654 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7504439353942871
Epoch: 36, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.8334887027740479
Epoch: 37, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.7012336254119873
Epoch: 38, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 39 cost time: 0.8782062530517578
Epoch: 39, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7027671337127686
Epoch: 40, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 0.7403805255889893
Epoch: 41, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7489361763000488
Epoch: 42, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.7579176425933838
Epoch: 43, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 44 cost time: 0.7758669853210449
Epoch: 44, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 0.7536022663116455
Epoch: 45, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 46 cost time: 0.6623318195343018
Epoch: 46, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 0.7261388301849365
Epoch: 47, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 0.8374052047729492
Epoch: 48, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 0.7601768970489502
Epoch: 49, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7858281135559082
Epoch: 50, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7789487838745117
Epoch: 51, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6621005535125732
Epoch: 52, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7270278930664062
Epoch: 53, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.6971616744995117
Epoch: 54, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8617403507232666
Epoch: 55, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6361968517303467
Epoch: 56, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 0.6593945026397705
Epoch: 57, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0010201930999756
Epoch: 58, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 59 cost time: 0.7705795764923096
Epoch: 59, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 60 cost time: 0.8383948802947998
Epoch: 60, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 61 cost time: 0.7375321388244629
Epoch: 61, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7742118835449219
Epoch: 62, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1594271659851074
Epoch: 63, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 64 cost time: 0.7275733947753906
Epoch: 64, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 65 cost time: 0.8401234149932861
Epoch: 65, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.729172945022583
Epoch: 66, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8650472164154053
Epoch: 67, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.9403102397918701
Epoch: 68, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 69 cost time: 0.8476190567016602
Epoch: 69, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 70 cost time: 0.850534200668335
Epoch: 70, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7878766059875488
Epoch: 71, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7496075630187988
Epoch: 72, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.631244421005249
Epoch: 73, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.8318657875061035
Epoch: 74, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7876367568969727
Epoch: 75, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 76 cost time: 0.7145256996154785
Epoch: 76, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 0.8431742191314697
Epoch: 77, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 78 cost time: 0.8279819488525391
Epoch: 78, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.853461503982544
Epoch: 79, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 80 cost time: 0.7298195362091064
Epoch: 80, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 81 cost time: 0.7216267585754395
Epoch: 81, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 82 cost time: 0.8181240558624268
Epoch: 82, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 83 cost time: 0.6178410053253174
Epoch: 83, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8049705028533936
Epoch: 84, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7112820148468018
Epoch: 85, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.8425984382629395
Epoch: 86, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.6888887882232666
Epoch: 87, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.7742819786071777
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.692448616027832
Epoch: 89, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.7071516513824463
Epoch: 90, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.8910617828369141
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.8419969081878662
Epoch: 92, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 273116
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.825070858001709
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.442 Vali Acc: 0.275 Test Loss: 1.442 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.0494062900543213
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.418 Vali Acc: 0.250 Test Loss: 1.418 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7558271884918213
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.404 Vali Acc: 0.325 Test Loss: 1.404 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.809722900390625
Epoch: 4, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.395 Vali Acc: 0.300 Test Loss: 1.395 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1310641765594482
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.393 Vali Acc: 0.250 Test Loss: 1.393 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9491188526153564
Epoch: 6, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0203649997711182
Epoch: 7, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0298058986663818
Epoch: 8, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.944115400314331
Epoch: 9, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.8871707916259766
Epoch: 10, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.263 Vali Acc: 0.375 Test Loss: 1.263 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6984827518463135
Epoch: 11, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.223 Vali Acc: 0.425 Test Loss: 1.223 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 12 cost time: 0.971435546875
Epoch: 12, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.7235019207000732
Epoch: 13, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.5925014019012451
Epoch: 14, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8722572326660156
Epoch: 15, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.152 Vali Acc: 0.575 Test Loss: 1.152 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7074403762817383
Epoch: 16, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.124 Vali Acc: 0.700 Test Loss: 1.124 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 1.0349371433258057
Epoch: 17, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9252536296844482
Epoch: 18, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.031 Vali Acc: 0.550 Test Loss: 1.031 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9483931064605713
Epoch: 19, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.983 Vali Acc: 0.750 Test Loss: 0.983 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 0.7174947261810303
Epoch: 20, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.964 Vali Acc: 0.775 Test Loss: 0.964 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 21 cost time: 0.8629319667816162
Epoch: 21, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9284589290618896
Epoch: 22, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.942 Vali Acc: 0.775 Test Loss: 0.942 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 0.7687609195709229
Epoch: 23, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 24 cost time: 0.8706250190734863
Epoch: 24, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.863 Vali Acc: 0.700 Test Loss: 0.863 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7143778800964355
Epoch: 25, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8240890502929688
Epoch: 26, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9813985824584961
Epoch: 27, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 28 cost time: 0.8857064247131348
Epoch: 28, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.8327512741088867
Epoch: 29, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8266277313232422
Epoch: 30, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.760 Vali Acc: 0.725 Test Loss: 0.760 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7243466377258301
Epoch: 31, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9660549163818359
Epoch: 32, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 33 cost time: 0.759838342666626
Epoch: 33, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0313665866851807
Epoch: 34, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 35 cost time: 0.794520378112793
Epoch: 35, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8209741115570068
Epoch: 36, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.631 Vali Acc: 0.825 Test Loss: 0.631 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 37 cost time: 0.7407693862915039
Epoch: 37, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3116397857666016
Epoch: 38, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.8403401374816895
Epoch: 39, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.577 Vali Acc: 0.775 Test Loss: 0.577 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9372661113739014
Epoch: 40, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8066048622131348
Epoch: 41, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.7916638851165771
Epoch: 42, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8149559497833252
Epoch: 43, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9347760677337646
Epoch: 44, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9475095272064209
Epoch: 45, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.974419116973877
Epoch: 46, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8062472343444824
Epoch: 47, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 0.8586704730987549
Epoch: 48, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8826746940612793
Epoch: 49, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7496552467346191
Epoch: 50, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 0.8124969005584717
Epoch: 51, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.7096836566925049
Epoch: 52, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7545030117034912
Epoch: 53, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7243647575378418
Epoch: 54, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8396205902099609
Epoch: 55, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.6499991416931152
Epoch: 56, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 0.8488712310791016
Epoch: 57, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.9259004592895508
Epoch: 58, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9409475326538086
Epoch: 59, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 0.9107491970062256
Epoch: 60, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 0.9769480228424072
Epoch: 61, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 0.678704023361206
Epoch: 62, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9740533828735352
Epoch: 63, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.8611104488372803
Epoch: 64, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.7357344627380371
Epoch: 65, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8655059337615967
Epoch: 66, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 0.7578954696655273
Epoch: 67, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 0.9018330574035645
Epoch: 68, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 69 cost time: 0.8649380207061768
Epoch: 69, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 70 cost time: 0.8736252784729004
Epoch: 70, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 71 cost time: 0.8417387008666992
Epoch: 71, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 72 cost time: 0.7970046997070312
Epoch: 72, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 73 cost time: 0.8884677886962891
Epoch: 73, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 74 cost time: 0.7129213809967041
Epoch: 74, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7554402351379395
Epoch: 75, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 76 cost time: 0.698016881942749
Epoch: 76, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.0111188888549805
Epoch: 77, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.7139179706573486
Epoch: 78, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9109077453613281
Epoch: 79, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.9099385738372803
Epoch: 80, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.7571971416473389
Epoch: 81, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.8215928077697754
Epoch: 82, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.9128313064575195
Epoch: 83, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.8719239234924316
Epoch: 84, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.9632728099822998
Epoch: 85, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 272540
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.156162738800049
Epoch: 1, Steps: 3 | Train Loss: 1.582 Vali Loss: 1.446 Vali Acc: 0.225 Test Loss: 1.446 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.8888318538665771
Epoch: 2, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9726212024688721
Epoch: 3, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.388 Vali Acc: 0.350 Test Loss: 1.388 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.9748117923736572
Epoch: 4, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.381 Vali Acc: 0.325 Test Loss: 1.381 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6793756484985352
Epoch: 5, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.386 Vali Acc: 0.350 Test Loss: 1.386 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.7657406330108643
Epoch: 6, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.382 Vali Acc: 0.375 Test Loss: 1.382 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.7841610908508301
Epoch: 7, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.343 Vali Acc: 0.400 Test Loss: 1.343 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.6025681495666504
Epoch: 8, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6721062660217285
Epoch: 9, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.245 Vali Acc: 0.525 Test Loss: 1.245 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.7587838172912598
Epoch: 10, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.8014240264892578
Epoch: 11, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.180 Vali Acc: 0.625 Test Loss: 1.180 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9466812610626221
Epoch: 12, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9738123416900635
Epoch: 13, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.782310962677002
Epoch: 14, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.111 Vali Acc: 0.725 Test Loss: 1.111 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.790520429611206
Epoch: 15, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8481462001800537
Epoch: 16, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.055 Vali Acc: 0.725 Test Loss: 1.055 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 17 cost time: 0.7270674705505371
Epoch: 17, Steps: 3 | Train Loss: 0.783 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7997777462005615
Epoch: 18, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.029 Vali Acc: 0.700 Test Loss: 1.029 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8652276992797852
Epoch: 19, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 20 cost time: 0.6504709720611572
Epoch: 20, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.8072023391723633
Epoch: 21, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.9463369846343994
Epoch: 22, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.8359277248382568
Epoch: 23, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.9750654697418213
Epoch: 24, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.807 Vali Acc: 0.825 Test Loss: 0.807 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 25 cost time: 0.8332037925720215
Epoch: 25, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.808 Vali Acc: 0.800 Test Loss: 0.808 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6608545780181885
Epoch: 26, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6939659118652344
Epoch: 27, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 0.7987847328186035
Epoch: 28, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8062372207641602
Epoch: 29, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7130899429321289
Epoch: 30, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.863936185836792
Epoch: 31, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7697200775146484
Epoch: 32, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7694315910339355
Epoch: 33, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 0.6322362422943115
Epoch: 34, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 35 cost time: 0.8644764423370361
Epoch: 35, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 36 cost time: 1.1195762157440186
Epoch: 36, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8913390636444092
Epoch: 37, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8518457412719727
Epoch: 38, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.819016695022583
Epoch: 39, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8566179275512695
Epoch: 40, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8520305156707764
Epoch: 41, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0013325214385986
Epoch: 42, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9575347900390625
Epoch: 43, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8858716487884521
Epoch: 44, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.544 Vali Acc: 0.800 Test Loss: 0.544 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8688149452209473
Epoch: 45, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 271964
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7848010063171387
Epoch: 1, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.445 Vali Acc: 0.300 Test Loss: 1.445 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9689443111419678
Epoch: 2, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8548352718353271
Epoch: 3, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.442 Vali Acc: 0.250 Test Loss: 1.442 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8272678852081299
Epoch: 4, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7782330513000488
Epoch: 5, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.424 Vali Acc: 0.250 Test Loss: 1.424 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8383982181549072
Epoch: 6, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.806037187576294
Epoch: 7, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.403 Vali Acc: 0.275 Test Loss: 1.403 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8123383522033691
Epoch: 8, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.377 Vali Acc: 0.275 Test Loss: 1.377 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6296036243438721
Epoch: 9, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.352 Vali Acc: 0.450 Test Loss: 1.352 Test Acc: 0.450
Validation loss decreased (-0.299986 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 0.7029750347137451
Epoch: 10, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.326 Vali Acc: 0.475 Test Loss: 1.326 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.6205563545227051
Epoch: 11, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.309 Vali Acc: 0.525 Test Loss: 1.309 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.7772567272186279
Epoch: 12, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0242295265197754
Epoch: 13, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 14 cost time: 0.7595729827880859
Epoch: 14, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.8172478675842285
Epoch: 15, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.213 Vali Acc: 0.550 Test Loss: 1.213 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.7187342643737793
Epoch: 16, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.194 Vali Acc: 0.450 Test Loss: 1.194 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8846452236175537
Epoch: 17, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.7497248649597168
Epoch: 18, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.9915585517883301
Epoch: 19, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.091 Vali Acc: 0.700 Test Loss: 1.091 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 20 cost time: 0.7762625217437744
Epoch: 20, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 21 cost time: 0.8814764022827148
Epoch: 21, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.017 Vali Acc: 0.750 Test Loss: 1.017 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 0.9159724712371826
Epoch: 22, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 0.7840681076049805
Epoch: 23, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.737377405166626
Epoch: 24, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.8963871002197266
Epoch: 25, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.8765404224395752
Epoch: 26, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7945919036865234
Epoch: 27, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 0.8333759307861328
Epoch: 28, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 29 cost time: 0.8794710636138916
Epoch: 29, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 30 cost time: 0.7237634658813477
Epoch: 30, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
Validation loss decreased (-0.774992 --> -0.899992).  Saving model ...
Epoch: 31 cost time: 0.9109783172607422
Epoch: 31, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7579185962677002
Epoch: 32, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8089346885681152
Epoch: 33, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.689 Vali Acc: 0.875 Test Loss: 0.689 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7428915500640869
Epoch: 34, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.652 Vali Acc: 0.800 Test Loss: 0.652 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9423496723175049
Epoch: 35, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.621 Vali Acc: 0.775 Test Loss: 0.621 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7684595584869385
Epoch: 36, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 0.9261319637298584
Epoch: 37, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.568 Vali Acc: 0.925 Test Loss: 0.568 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 38 cost time: 0.9281466007232666
Epoch: 38, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 39 cost time: 0.7180967330932617
Epoch: 39, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1388545036315918
Epoch: 40, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.524 Vali Acc: 0.900 Test Loss: 0.524 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0089976787567139
Epoch: 41, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7646815776824951
Epoch: 42, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7051782608032227
Epoch: 43, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.034130573272705
Epoch: 44, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6763994693756104
Epoch: 45, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8309280872344971
Epoch: 46, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.904057502746582
Epoch: 47, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9508006572723389
Epoch: 48, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 0.8880245685577393
Epoch: 49, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 0.7655389308929443
Epoch: 50, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 0.8789567947387695
Epoch: 51, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 0.8505070209503174
Epoch: 52, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 0.7342953681945801
Epoch: 53, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 0.8501904010772705
Epoch: 54, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 0.7855672836303711
Epoch: 55, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 0.9605319499969482
Epoch: 56, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 0.7122533321380615
Epoch: 57, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 0.8358991146087646
Epoch: 58, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 0.9567584991455078
Epoch: 59, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 0.7531790733337402
Epoch: 60, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 0.9144349098205566
Epoch: 61, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 62 cost time: 0.635430097579956
Epoch: 62, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 63 cost time: 0.6662018299102783
Epoch: 63, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 64 cost time: 0.9542343616485596
Epoch: 64, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 65 cost time: 0.795220136642456
Epoch: 65, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 66 cost time: 0.708733081817627
Epoch: 66, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 67 cost time: 0.7435879707336426
Epoch: 67, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 68 cost time: 0.8010563850402832
Epoch: 68, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 69 cost time: 0.7784738540649414
Epoch: 69, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8918516635894775
Epoch: 70, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7567262649536133
Epoch: 71, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.8006572723388672
Epoch: 72, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.7834386825561523
Epoch: 73, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 74 cost time: 0.7574329376220703
Epoch: 74, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7357544898986816
Epoch: 75, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9565744400024414
Epoch: 76, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.1260688304901123
Epoch: 77, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.9730184078216553
Epoch: 78, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 79 cost time: 0.8360252380371094
Epoch: 79, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 80 cost time: 0.6279616355895996
Epoch: 80, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 81 cost time: 0.8404991626739502
Epoch: 81, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 82 cost time: 0.7430508136749268
Epoch: 82, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6720743179321289
Epoch: 83, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8605141639709473
Epoch: 84, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.814415454864502
Epoch: 85, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.7063827514648438
Epoch: 86, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.7414467334747314
Epoch: 87, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.8156368732452393
Epoch: 88, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.7941746711730957
Epoch: 89, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.9387052059173584
Epoch: 90, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.651029109954834
Epoch: 91, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 262620
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.177086591720581
Epoch: 1, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.615 Vali Acc: 0.250 Test Loss: 1.615 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.6583051681518555
Epoch: 2, Steps: 3 | Train Loss: 1.602 Vali Loss: 1.586 Vali Acc: 0.250 Test Loss: 1.586 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249984).  Saving model ...
Epoch: 3 cost time: 0.6725285053253174
Epoch: 3, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.560 Vali Acc: 0.275 Test Loss: 1.560 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274984).  Saving model ...
Epoch: 4 cost time: 0.7199373245239258
Epoch: 4, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.536 Vali Acc: 0.250 Test Loss: 1.536 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.723395586013794
Epoch: 5, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.521 Vali Acc: 0.225 Test Loss: 1.521 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.710860013961792
Epoch: 6, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.510 Vali Acc: 0.200 Test Loss: 1.510 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9837360382080078
Epoch: 7, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.508 Vali Acc: 0.125 Test Loss: 1.508 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8015799522399902
Epoch: 8, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.495 Vali Acc: 0.175 Test Loss: 1.495 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8246042728424072
Epoch: 9, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.473 Vali Acc: 0.325 Test Loss: 1.473 Test Acc: 0.325
Validation loss decreased (-0.274984 --> -0.324985).  Saving model ...
Epoch: 10 cost time: 0.69525146484375
Epoch: 10, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.450 Vali Acc: 0.400 Test Loss: 1.450 Test Acc: 0.400
Validation loss decreased (-0.324985 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.6225950717926025
Epoch: 11, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.428 Vali Acc: 0.350 Test Loss: 1.428 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7177505493164062
Epoch: 12, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.418 Vali Acc: 0.425 Test Loss: 1.418 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424986).  Saving model ...
Epoch: 13 cost time: 0.7550101280212402
Epoch: 13, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.401 Vali Acc: 0.450 Test Loss: 1.401 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 14 cost time: 0.7577543258666992
Epoch: 14, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8578870296478271
Epoch: 15, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.340 Vali Acc: 0.475 Test Loss: 1.340 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 0.6637623310089111
Epoch: 16, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 17 cost time: 0.638338565826416
Epoch: 17, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.291 Vali Acc: 0.450 Test Loss: 1.291 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7659444808959961
Epoch: 18, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 19 cost time: 0.7604804039001465
Epoch: 19, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7423503398895264
Epoch: 20, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.228 Vali Acc: 0.375 Test Loss: 1.228 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6701645851135254
Epoch: 21, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.200 Vali Acc: 0.575 Test Loss: 1.200 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.7933695316314697
Epoch: 22, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.163 Vali Acc: 0.625 Test Loss: 1.163 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 23 cost time: 0.6200902462005615
Epoch: 23, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.6046624183654785
Epoch: 24, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.6213297843933105
Epoch: 25, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8640792369842529
Epoch: 26, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 0.698786735534668
Epoch: 27, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.748112678527832
Epoch: 28, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.6767611503601074
Epoch: 29, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.6844971179962158
Epoch: 30, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.6018693447113037
Epoch: 31, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 32 cost time: 0.6869089603424072
Epoch: 32, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 33 cost time: 0.6885604858398438
Epoch: 33, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 34 cost time: 0.8712372779846191
Epoch: 34, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 0.6468660831451416
Epoch: 35, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 0.6767220497131348
Epoch: 36, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 37 cost time: 0.8032054901123047
Epoch: 37, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 38 cost time: 0.6396641731262207
Epoch: 38, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7062759399414062
Epoch: 39, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.655 Vali Acc: 0.825 Test Loss: 0.655 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.769587516784668
Epoch: 40, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.7327151298522949
Epoch: 41, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.7784578800201416
Epoch: 42, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9225077629089355
Epoch: 43, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6671290397644043
Epoch: 44, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.7171056270599365
Epoch: 45, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7848477363586426
Epoch: 46, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.8670365810394287
Epoch: 47, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.822040319442749
Epoch: 48, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.7581257820129395
Epoch: 49, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0308358669281006
Epoch: 50, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9470300674438477
Epoch: 51, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.855898380279541
Epoch: 52, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.8820419311523438
Epoch: 53, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7151319980621338
Epoch: 54, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1157357692718506
Epoch: 55, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 56 cost time: 1.030829906463623
Epoch: 56, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 57 cost time: 0.7342278957366943
Epoch: 57, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 58 cost time: 0.7581689357757568
Epoch: 58, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8007075786590576
Epoch: 59, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7223739624023438
Epoch: 60, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7216145992279053
Epoch: 61, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.7082126140594482
Epoch: 62, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.121950387954712
Epoch: 63, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.7330129146575928
Epoch: 64, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.6839876174926758
Epoch: 65, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1054644584655762
Epoch: 66, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.7047240734100342
Epoch: 67, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 262332
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.613551378250122
Epoch: 1, Steps: 3 | Train Loss: 1.603 Vali Loss: 1.596 Vali Acc: 0.200 Test Loss: 1.596 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.6232984066009521
Epoch: 2, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.540 Vali Acc: 0.175 Test Loss: 1.540 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8283252716064453
Epoch: 3, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.504 Vali Acc: 0.200 Test Loss: 1.504 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 0.6006157398223877
Epoch: 4, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.471 Vali Acc: 0.325 Test Loss: 1.471 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.7060341835021973
Epoch: 5, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6862592697143555
Epoch: 6, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.422 Vali Acc: 0.350 Test Loss: 1.422 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.6051976680755615
Epoch: 7, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7509701251983643
Epoch: 8, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.381 Vali Acc: 0.250 Test Loss: 1.381 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0653858184814453
Epoch: 9, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8703310489654541
Epoch: 10, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.340 Vali Acc: 0.450 Test Loss: 1.340 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.7079641819000244
Epoch: 11, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.318 Vali Acc: 0.625 Test Loss: 1.318 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624987).  Saving model ...
Epoch: 12 cost time: 0.7683126926422119
Epoch: 12, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.304 Vali Acc: 0.600 Test Loss: 1.304 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7449920177459717
Epoch: 13, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.282 Vali Acc: 0.625 Test Loss: 1.282 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 14 cost time: 0.7325365543365479
Epoch: 14, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.257 Vali Acc: 0.675 Test Loss: 1.257 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674987).  Saving model ...
Epoch: 15 cost time: 0.7355098724365234
Epoch: 15, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7609975337982178
Epoch: 16, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.215 Vali Acc: 0.650 Test Loss: 1.215 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7123870849609375
Epoch: 17, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.180 Vali Acc: 0.675 Test Loss: 1.180 Test Acc: 0.675
Validation loss decreased (-0.674987 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.9196252822875977
Epoch: 18, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.144 Vali Acc: 0.700 Test Loss: 1.144 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.7850022315979004
Epoch: 19, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 20 cost time: 0.8316378593444824
Epoch: 20, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.077 Vali Acc: 0.725 Test Loss: 1.077 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 21 cost time: 0.7310867309570312
Epoch: 21, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.050 Vali Acc: 0.725 Test Loss: 1.050 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 22 cost time: 0.7435035705566406
Epoch: 22, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.030 Vali Acc: 0.725 Test Loss: 1.030 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 23 cost time: 0.7210676670074463
Epoch: 23, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 0.9407720565795898
Epoch: 24, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.946 Vali Acc: 0.750 Test Loss: 0.946 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 0.8069024085998535
Epoch: 25, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.924 Vali Acc: 0.775 Test Loss: 0.924 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 26 cost time: 0.8618679046630859
Epoch: 26, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 27 cost time: 0.7218248844146729
Epoch: 27, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.843 Vali Acc: 0.725 Test Loss: 0.843 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9569897651672363
Epoch: 28, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.7092299461364746
Epoch: 29, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 0.8290832042694092
Epoch: 30, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.8019232749938965
Epoch: 31, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6843433380126953
Epoch: 32, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6570742130279541
Epoch: 33, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.648 Vali Acc: 0.825 Test Loss: 0.648 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6640591621398926
Epoch: 34, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 0.9962038993835449
Epoch: 35, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9779424667358398
Epoch: 36, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.618 Vali Acc: 0.875 Test Loss: 0.618 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 37 cost time: 0.9284703731536865
Epoch: 37, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.7504401206970215
Epoch: 38, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 1.2439301013946533
Epoch: 39, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.277618408203125
Epoch: 40, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 0.787860631942749
Epoch: 41, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 42 cost time: 0.7729883193969727
Epoch: 42, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 43 cost time: 0.8084790706634521
Epoch: 43, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 44 cost time: 0.7446300983428955
Epoch: 44, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.474 Vali Acc: 0.825 Test Loss: 0.474 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6845102310180664
Epoch: 45, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 46 cost time: 0.6324334144592285
Epoch: 46, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 0.8971822261810303
Epoch: 47, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 48 cost time: 0.7374684810638428
Epoch: 48, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 49 cost time: 0.8058717250823975
Epoch: 49, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 50 cost time: 0.6910314559936523
Epoch: 50, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 51 cost time: 0.7946548461914062
Epoch: 51, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 52 cost time: 0.6365280151367188
Epoch: 52, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7021234035491943
Epoch: 53, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.8013327121734619
Epoch: 54, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9431486129760742
Epoch: 55, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.8062448501586914
Epoch: 56, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 0.8632724285125732
Epoch: 57, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 0.7251179218292236
Epoch: 58, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 59 cost time: 0.8671784400939941
Epoch: 59, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 60 cost time: 0.7740538120269775
Epoch: 60, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 61 cost time: 0.8348824977874756
Epoch: 61, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 0.8137891292572021
Epoch: 62, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.981027364730835
Epoch: 63, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.943678617477417
Epoch: 64, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.2363648414611816
Epoch: 65, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6788032054901123
Epoch: 66, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8277997970581055
Epoch: 67, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.7876489162445068
Epoch: 68, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.7696487903594971
Epoch: 69, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.7322919368743896
Epoch: 70, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.9122180938720703
Epoch: 71, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 262044
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.814683675765991
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.279 Vali Acc: 0.275 Test Loss: 1.279 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.7455418109893799
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.282 Vali Acc: 0.375 Test Loss: 1.282 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.8195717334747314
Epoch: 3, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.284 Vali Acc: 0.575 Test Loss: 1.284 Test Acc: 0.575
Validation loss decreased (-0.374987 --> -0.574987).  Saving model ...
Epoch: 4 cost time: 0.6536345481872559
Epoch: 4, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.284 Vali Acc: 0.575 Test Loss: 1.284 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 5 cost time: 0.6494441032409668
Epoch: 5, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.283 Vali Acc: 0.575 Test Loss: 1.283 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.701500415802002
Epoch: 6, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.271 Vali Acc: 0.550 Test Loss: 1.271 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8841078281402588
Epoch: 7, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.252 Vali Acc: 0.625 Test Loss: 1.252 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624987).  Saving model ...
Epoch: 8 cost time: 0.8673746585845947
Epoch: 8, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.235 Vali Acc: 0.600 Test Loss: 1.235 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7290704250335693
Epoch: 9, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9266269207000732
Epoch: 10, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.204 Vali Acc: 0.625 Test Loss: 1.204 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.9102156162261963
Epoch: 11, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0431969165802002
Epoch: 12, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.8554847240447998
Epoch: 13, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.121 Vali Acc: 0.700 Test Loss: 1.121 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.8809549808502197
Epoch: 14, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.105 Vali Acc: 0.775 Test Loss: 1.105 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 15 cost time: 0.9799299240112305
Epoch: 15, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.082 Vali Acc: 0.625 Test Loss: 1.082 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.86240553855896
Epoch: 16, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.063 Vali Acc: 0.575 Test Loss: 1.063 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6707277297973633
Epoch: 17, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.024 Vali Acc: 0.800 Test Loss: 1.024 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799990).  Saving model ...
Epoch: 18 cost time: 0.8278939723968506
Epoch: 18, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9910788536071777
Epoch: 19, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.963 Vali Acc: 0.675 Test Loss: 0.963 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7745745182037354
Epoch: 20, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0040738582611084
Epoch: 21, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.890 Vali Acc: 0.825 Test Loss: 0.890 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.8513240814208984
Epoch: 22, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.856 Vali Acc: 0.850 Test Loss: 0.856 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 0.7231543064117432
Epoch: 23, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8203001022338867
Epoch: 24, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7888138294219971
Epoch: 25, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.770 Vali Acc: 0.875 Test Loss: 0.770 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 26 cost time: 0.9739618301391602
Epoch: 26, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 0.8727216720581055
Epoch: 27, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.8347945213317871
Epoch: 28, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.653 Vali Acc: 0.925 Test Loss: 0.653 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 29 cost time: 0.892249345779419
Epoch: 29, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.628 Vali Acc: 0.925 Test Loss: 0.628 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.989274263381958
Epoch: 30, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.835129976272583
Epoch: 31, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6686728000640869
Epoch: 32, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.548 Vali Acc: 0.925 Test Loss: 0.548 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.8101170063018799
Epoch: 33, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.7547862529754639
Epoch: 34, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.504 Vali Acc: 0.925 Test Loss: 0.504 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.7374124526977539
Epoch: 35, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.8968644142150879
Epoch: 36, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 37 cost time: 0.8575148582458496
Epoch: 37, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.7956337928771973
Epoch: 38, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.8717734813690186
Epoch: 39, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.7827417850494385
Epoch: 40, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.8241486549377441
Epoch: 41, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.7131857872009277
Epoch: 42, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.7945914268493652
Epoch: 43, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.6621363162994385
Epoch: 44, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.7996177673339844
Epoch: 45, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.8739843368530273
Epoch: 46, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9098672866821289
Epoch: 47, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.8389413356781006
Epoch: 48, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8426539897918701
Epoch: 49, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.806281328201294
Epoch: 50, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8272879123687744
Epoch: 51, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7766902446746826
Epoch: 52, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7346973419189453
Epoch: 53, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.8141696453094482
Epoch: 54, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.7476110458374023
Epoch: 55, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.8428788185119629
Epoch: 56, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9428269863128662
Epoch: 57, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 261756
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.266645908355713
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8633830547332764
Epoch: 2, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.408 Vali Acc: 0.325 Test Loss: 1.408 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.600517988204956
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.402 Vali Acc: 0.450 Test Loss: 1.402 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.5890588760375977
Epoch: 4, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.391 Vali Acc: 0.525 Test Loss: 1.391 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524986).  Saving model ...
Epoch: 5 cost time: 0.7277500629425049
Epoch: 5, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.381 Vali Acc: 0.525 Test Loss: 1.381 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524986).  Saving model ...
Epoch: 6 cost time: 0.7680318355560303
Epoch: 6, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.374 Vali Acc: 0.525 Test Loss: 1.374 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524986).  Saving model ...
Epoch: 7 cost time: 0.6760420799255371
Epoch: 7, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.365 Vali Acc: 0.525 Test Loss: 1.365 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524986).  Saving model ...
Epoch: 8 cost time: 0.654320478439331
Epoch: 8, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.353 Vali Acc: 0.525 Test Loss: 1.353 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524986).  Saving model ...
Epoch: 9 cost time: 0.6493301391601562
Epoch: 9, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.331 Vali Acc: 0.525 Test Loss: 1.331 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.733140230178833
Epoch: 10, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.306 Vali Acc: 0.550 Test Loss: 1.306 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.6578681468963623
Epoch: 11, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.275 Vali Acc: 0.550 Test Loss: 1.275 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 12 cost time: 0.6971316337585449
Epoch: 12, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6009161472320557
Epoch: 13, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.232 Vali Acc: 0.600 Test Loss: 1.232 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.7688677310943604
Epoch: 14, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7505104541778564
Epoch: 15, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7178270816802979
Epoch: 16, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.193 Vali Acc: 0.625 Test Loss: 1.193 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 17 cost time: 0.7302930355072021
Epoch: 17, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.8065550327301025
Epoch: 18, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.148 Vali Acc: 0.625 Test Loss: 1.148 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.6637933254241943
Epoch: 19, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.7661025524139404
Epoch: 20, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.6833305358886719
Epoch: 21, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.063 Vali Acc: 0.675 Test Loss: 1.063 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.8057253360748291
Epoch: 22, Steps: 3 | Train Loss: 0.754 Vali Loss: 1.041 Vali Acc: 0.500 Test Loss: 1.041 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6101465225219727
Epoch: 23, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8045201301574707
Epoch: 24, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.993 Vali Acc: 0.500 Test Loss: 0.993 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6186909675598145
Epoch: 25, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7058765888214111
Epoch: 26, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699991).  Saving model ...
Epoch: 27 cost time: 0.713728666305542
Epoch: 27, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6263298988342285
Epoch: 28, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.900 Vali Acc: 0.650 Test Loss: 0.900 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6990740299224854
Epoch: 29, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.865 Vali Acc: 0.725 Test Loss: 0.865 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 30 cost time: 0.7182049751281738
Epoch: 30, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.864 Vali Acc: 0.675 Test Loss: 0.864 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7622547149658203
Epoch: 31, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.883 Vali Acc: 0.575 Test Loss: 0.883 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7935612201690674
Epoch: 32, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.842 Vali Acc: 0.600 Test Loss: 0.842 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8222312927246094
Epoch: 33, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 34 cost time: 0.7831118106842041
Epoch: 34, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8943195343017578
Epoch: 35, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.750 Vali Acc: 0.725 Test Loss: 0.750 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8366925716400146
Epoch: 36, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.702 Vali Acc: 0.750 Test Loss: 0.702 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.91282057762146
Epoch: 37, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 38 cost time: 0.7825260162353516
Epoch: 38, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 0.9211292266845703
Epoch: 39, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 40 cost time: 0.7959728240966797
Epoch: 40, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7020614147186279
Epoch: 41, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.776878833770752
Epoch: 42, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.621 Vali Acc: 0.775 Test Loss: 0.621 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.741222620010376
Epoch: 43, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6921951770782471
Epoch: 44, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.550 Vali Acc: 0.875 Test Loss: 0.550 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.6603779792785645
Epoch: 45, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 46 cost time: 0.8858621120452881
Epoch: 46, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 47 cost time: 0.9601168632507324
Epoch: 47, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 0.743769645690918
Epoch: 48, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.7969684600830078
Epoch: 49, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.8237879276275635
Epoch: 50, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.661614179611206
Epoch: 51, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.7092218399047852
Epoch: 52, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 0.6049017906188965
Epoch: 53, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 0.8176276683807373
Epoch: 54, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 0.749661922454834
Epoch: 55, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 0.7933394908905029
Epoch: 56, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7640159130096436
Epoch: 57, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 0.7767469882965088
Epoch: 58, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 59 cost time: 0.798797607421875
Epoch: 59, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8445253372192383
Epoch: 60, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 61 cost time: 0.7008688449859619
Epoch: 61, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 1.046935796737671
Epoch: 62, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 63 cost time: 0.6738710403442383
Epoch: 63, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 64 cost time: 0.7631750106811523
Epoch: 64, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 65 cost time: 0.8960933685302734
Epoch: 65, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 66 cost time: 0.6602704524993896
Epoch: 66, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 67 cost time: 0.8802535533905029
Epoch: 67, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 68 cost time: 0.782376766204834
Epoch: 68, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 69 cost time: 0.8408441543579102
Epoch: 69, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 70 cost time: 0.8813552856445312
Epoch: 70, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 71 cost time: 0.7598450183868408
Epoch: 71, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 72 cost time: 0.8447906970977783
Epoch: 72, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7338182926177979
Epoch: 73, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7809658050537109
Epoch: 74, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 75 cost time: 0.7182185649871826
Epoch: 75, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8357250690460205
Epoch: 76, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.713515043258667
Epoch: 77, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.55539870262146
Epoch: 78, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6874685287475586
Epoch: 79, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6793270111083984
Epoch: 80, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.6313083171844482
Epoch: 81, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 82 cost time: 0.719965934753418
Epoch: 82, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 83 cost time: 0.7319369316101074
Epoch: 83, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6812641620635986
Epoch: 84, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.8048546314239502
Epoch: 85, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.936852216720581
Epoch: 86, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 87 cost time: 0.7098257541656494
Epoch: 87, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 88 cost time: 0.7330851554870605
Epoch: 88, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 89 cost time: 0.8403308391571045
Epoch: 89, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 90 cost time: 0.694242000579834
Epoch: 90, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 91 cost time: 0.6923279762268066
Epoch: 91, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 92 cost time: 0.6279971599578857
Epoch: 92, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 93 cost time: 0.7621707916259766
Epoch: 93, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 94 cost time: 0.8580565452575684
Epoch: 94, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 95 cost time: 0.7872581481933594
Epoch: 95, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 96 cost time: 0.7285864353179932
Epoch: 96, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.7252583503723145
Epoch: 97, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.7703542709350586
Epoch: 98, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8312907218933105
Epoch: 99, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.8916370868682861
Epoch: 100, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 162780
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4603617191314697
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.436 Vali Acc: 0.300 Test Loss: 1.436 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7105166912078857
Epoch: 2, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.409 Vali Acc: 0.300 Test Loss: 1.409 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6551451683044434
Epoch: 3, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.7659478187561035
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.8985164165496826
Epoch: 5, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.670522928237915
Epoch: 6, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.356 Vali Acc: 0.300 Test Loss: 1.356 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8332374095916748
Epoch: 7, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.341 Vali Acc: 0.300 Test Loss: 1.341 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7138566970825195
Epoch: 8, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.325 Vali Acc: 0.300 Test Loss: 1.325 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6759476661682129
Epoch: 9, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.305 Vali Acc: 0.375 Test Loss: 1.305 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.807626485824585
Epoch: 10, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.7466914653778076
Epoch: 11, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.265 Vali Acc: 0.575 Test Loss: 1.265 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574987).  Saving model ...
Epoch: 12 cost time: 0.6107382774353027
Epoch: 12, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.248 Vali Acc: 0.600 Test Loss: 1.248 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.656118631362915
Epoch: 13, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.7376313209533691
Epoch: 14, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9522135257720947
Epoch: 15, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7106642723083496
Epoch: 16, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.193 Vali Acc: 0.575 Test Loss: 1.193 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8694500923156738
Epoch: 17, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 0.6961350440979004
Epoch: 18, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.147 Vali Acc: 0.525 Test Loss: 1.147 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7615907192230225
Epoch: 19, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.7569818496704102
Epoch: 20, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.072 Vali Acc: 0.725 Test Loss: 1.072 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 21 cost time: 0.756812572479248
Epoch: 21, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.054 Vali Acc: 0.650 Test Loss: 1.054 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7040460109710693
Epoch: 22, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.030 Vali Acc: 0.650 Test Loss: 1.030 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8539884090423584
Epoch: 23, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.992 Vali Acc: 0.750 Test Loss: 0.992 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 0.7687768936157227
Epoch: 24, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.980 Vali Acc: 0.650 Test Loss: 0.980 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.847480297088623
Epoch: 25, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.972 Vali Acc: 0.575 Test Loss: 0.972 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8038122653961182
Epoch: 26, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.936 Vali Acc: 0.650 Test Loss: 0.936 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8010742664337158
Epoch: 27, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.8253252506256104
Epoch: 28, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 0.5843002796173096
Epoch: 29, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.6494529247283936
Epoch: 30, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 31 cost time: 0.7115871906280518
Epoch: 31, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 0.7137351036071777
Epoch: 32, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 0.8078188896179199
Epoch: 33, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 34 cost time: 0.6726467609405518
Epoch: 34, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 0.6067774295806885
Epoch: 35, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 0.8076601028442383
Epoch: 36, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7912139892578125
Epoch: 37, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 38 cost time: 0.8203966617584229
Epoch: 38, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 39 cost time: 0.7289440631866455
Epoch: 39, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 40 cost time: 0.767157793045044
Epoch: 40, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.7161242961883545
Epoch: 41, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6827609539031982
Epoch: 42, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8028948307037354
Epoch: 43, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6657335758209229
Epoch: 44, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8630270957946777
Epoch: 45, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.6799807548522949
Epoch: 46, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.7826755046844482
Epoch: 47, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6646759510040283
Epoch: 48, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7335216999053955
Epoch: 49, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7525842189788818
Epoch: 50, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6203341484069824
Epoch: 51, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.7659456729888916
Epoch: 52, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7555286884307861
Epoch: 53, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.6593408584594727
Epoch: 54, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8541116714477539
Epoch: 55, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6103920936584473
Epoch: 56, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7446439266204834
Epoch: 57, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.7769026756286621
Epoch: 58, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7894692420959473
Epoch: 59, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.7468314170837402
Epoch: 60, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.789419412612915
Epoch: 61, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.8165879249572754
Epoch: 62, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8282222747802734
Epoch: 63, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 162492
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3744068145751953
Epoch: 1, Steps: 3 | Train Loss: 1.682 Vali Loss: 1.510 Vali Acc: 0.400 Test Loss: 1.510 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 0.7606379985809326
Epoch: 2, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.467 Vali Acc: 0.400 Test Loss: 1.467 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.6609311103820801
Epoch: 3, Steps: 3 | Train Loss: 1.566 Vali Loss: 1.433 Vali Acc: 0.400 Test Loss: 1.433 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.7413270473480225
Epoch: 4, Steps: 3 | Train Loss: 1.557 Vali Loss: 1.404 Vali Acc: 0.425 Test Loss: 1.404 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.7433371543884277
Epoch: 5, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.384 Vali Acc: 0.425 Test Loss: 1.384 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.6802999973297119
Epoch: 6, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.370 Vali Acc: 0.450 Test Loss: 1.370 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.8540093898773193
Epoch: 7, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.365 Vali Acc: 0.450 Test Loss: 1.365 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 8 cost time: 0.7078940868377686
Epoch: 8, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.363 Vali Acc: 0.475 Test Loss: 1.363 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 9 cost time: 0.6859428882598877
Epoch: 9, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 10 cost time: 0.8926491737365723
Epoch: 10, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.6563394069671631
Epoch: 11, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.313 Vali Acc: 0.475 Test Loss: 1.313 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7259948253631592
Epoch: 12, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.659492015838623
Epoch: 13, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 14 cost time: 0.7669887542724609
Epoch: 14, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7821435928344727
Epoch: 15, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.222 Vali Acc: 0.450 Test Loss: 1.222 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6666877269744873
Epoch: 16, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.199 Vali Acc: 0.575 Test Loss: 1.199 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.6505837440490723
Epoch: 17, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.169 Vali Acc: 0.625 Test Loss: 1.169 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.8078639507293701
Epoch: 18, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.6830182075500488
Epoch: 19, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.8584849834442139
Epoch: 20, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.115 Vali Acc: 0.625 Test Loss: 1.115 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8694102764129639
Epoch: 21, Steps: 3 | Train Loss: 0.810 Vali Loss: 1.094 Vali Acc: 0.575 Test Loss: 1.094 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8944449424743652
Epoch: 22, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.057 Vali Acc: 0.625 Test Loss: 1.057 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8392322063446045
Epoch: 23, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 24 cost time: 0.6517815589904785
Epoch: 24, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.989 Vali Acc: 0.775 Test Loss: 0.989 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774990).  Saving model ...
Epoch: 25 cost time: 0.701789379119873
Epoch: 25, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.960 Vali Acc: 0.775 Test Loss: 0.960 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 26 cost time: 0.8380899429321289
Epoch: 26, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5783929824829102
Epoch: 27, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 28 cost time: 0.8259387016296387
Epoch: 28, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 29 cost time: 1.0470843315124512
Epoch: 29, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 0.891042947769165
Epoch: 30, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.786 Vali Acc: 0.900 Test Loss: 0.786 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 31 cost time: 0.7087578773498535
Epoch: 31, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.836280345916748
Epoch: 32, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6624984741210938
Epoch: 33, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.91640305519104
Epoch: 34, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7390778064727783
Epoch: 35, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7455282211303711
Epoch: 36, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7106502056121826
Epoch: 37, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7113821506500244
Epoch: 38, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7740092277526855
Epoch: 39, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6504225730895996
Epoch: 40, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 162204
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.862246513366699
Epoch: 1, Steps: 3 | Train Loss: 1.671 Vali Loss: 1.658 Vali Acc: 0.250 Test Loss: 1.658 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 0.6883695125579834
Epoch: 2, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.547 Vali Acc: 0.225 Test Loss: 1.547 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8601126670837402
Epoch: 3, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.483 Vali Acc: 0.250 Test Loss: 1.483 Test Acc: 0.250
Validation loss decreased (-0.249983 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.9104313850402832
Epoch: 4, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.423 Vali Acc: 0.175 Test Loss: 1.423 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7478172779083252
Epoch: 5, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (-0.249985 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.7089898586273193
Epoch: 6, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.347 Vali Acc: 0.375 Test Loss: 1.347 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.8949134349822998
Epoch: 7, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.64666748046875
Epoch: 8, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.7005033493041992
Epoch: 9, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.6401350498199463
Epoch: 10, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.8490996360778809
Epoch: 11, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 12 cost time: 1.0599989891052246
Epoch: 12, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0643064975738525
Epoch: 13, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.237 Vali Acc: 0.550 Test Loss: 1.237 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 1.0251667499542236
Epoch: 14, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.228 Vali Acc: 0.550 Test Loss: 1.228 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.933884859085083
Epoch: 15, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 1.001204013824463
Epoch: 16, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 17 cost time: 1.0400266647338867
Epoch: 17, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.147 Vali Acc: 0.575 Test Loss: 1.147 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9630095958709717
Epoch: 18, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.8654651641845703
Epoch: 19, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 1.129086971282959
Epoch: 20, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 1.0229499340057373
Epoch: 21, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9563887119293213
Epoch: 22, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.021 Vali Acc: 0.675 Test Loss: 1.021 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 23 cost time: 0.9362900257110596
Epoch: 23, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.8349101543426514
Epoch: 24, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8990826606750488
Epoch: 25, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.945 Vali Acc: 0.650 Test Loss: 0.945 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8900642395019531
Epoch: 26, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.915 Vali Acc: 0.700 Test Loss: 0.915 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 27 cost time: 1.1281778812408447
Epoch: 27, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 28 cost time: 0.8619933128356934
Epoch: 28, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.864 Vali Acc: 0.700 Test Loss: 0.864 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9369676113128662
Epoch: 29, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.839 Vali Acc: 0.725 Test Loss: 0.839 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 30 cost time: 0.7090702056884766
Epoch: 30, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774992).  Saving model ...
Epoch: 31 cost time: 1.1455516815185547
Epoch: 31, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.771 Vali Acc: 0.825 Test Loss: 0.771 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 32 cost time: 1.042104959487915
Epoch: 32, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9470250606536865
Epoch: 33, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 34 cost time: 0.9762048721313477
Epoch: 34, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9836981296539307
Epoch: 35, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 36 cost time: 0.9375834465026855
Epoch: 36, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 37 cost time: 0.8952498435974121
Epoch: 37, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.634 Vali Acc: 0.875 Test Loss: 0.634 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.7584154605865479
Epoch: 38, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.8231124877929688
Epoch: 39, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9086568355560303
Epoch: 40, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.574 Vali Acc: 0.875 Test Loss: 0.574 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.9158737659454346
Epoch: 41, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 42 cost time: 1.1729273796081543
Epoch: 42, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1962523460388184
Epoch: 43, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8745999336242676
Epoch: 44, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8757054805755615
Epoch: 45, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7974593639373779
Epoch: 46, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8150198459625244
Epoch: 47, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.8950197696685791
Epoch: 48, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.9352908134460449
Epoch: 49, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.9042549133300781
Epoch: 50, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 0.9007935523986816
Epoch: 51, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.9690916538238525
Epoch: 52, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.8821475505828857
Epoch: 53, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 1.0822150707244873
Epoch: 54, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.7528753280639648
Epoch: 55, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.8536586761474609
Epoch: 56, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.9837841987609863
Epoch: 57, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.8556830883026123
Epoch: 58, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 0.8675074577331543
Epoch: 59, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0066227912902832
Epoch: 60, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 0.9532630443572998
Epoch: 61, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 0.9695844650268555
Epoch: 62, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 63 cost time: 0.9542689323425293
Epoch: 63, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 1.0217750072479248
Epoch: 64, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.8396270275115967
Epoch: 65, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.758746862411499
Epoch: 66, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8540868759155273
Epoch: 67, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0245530605316162
Epoch: 68, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8908956050872803
Epoch: 69, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8488447666168213
Epoch: 70, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8348808288574219
Epoch: 71, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8078312873840332
Epoch: 72, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.953815221786499
Epoch: 73, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.8940315246582031
Epoch: 74, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.8144006729125977
Epoch: 75, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 161916
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3583924770355225
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.733687162399292
Epoch: 2, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.348 Vali Acc: 0.350 Test Loss: 1.348 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7013068199157715
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.345 Vali Acc: 0.350 Test Loss: 1.345 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9151747226715088
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.339 Vali Acc: 0.325 Test Loss: 1.339 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6723189353942871
Epoch: 5, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.332 Vali Acc: 0.475 Test Loss: 1.332 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.6044266223907471
Epoch: 6, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8014447689056396
Epoch: 7, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7340054512023926
Epoch: 8, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.303 Vali Acc: 0.425 Test Loss: 1.303 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9304525852203369
Epoch: 9, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.285 Vali Acc: 0.325 Test Loss: 1.285 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0837478637695312
Epoch: 10, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.265 Vali Acc: 0.350 Test Loss: 1.265 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0208754539489746
Epoch: 11, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.252 Vali Acc: 0.325 Test Loss: 1.252 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6919443607330322
Epoch: 12, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.234 Vali Acc: 0.325 Test Loss: 1.234 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7794139385223389
Epoch: 13, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.210 Vali Acc: 0.300 Test Loss: 1.210 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9840667247772217
Epoch: 14, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.8352587223052979
Epoch: 15, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.6737504005432129
Epoch: 16, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.135 Vali Acc: 0.675 Test Loss: 1.135 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.6399812698364258
Epoch: 17, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 0.8252239227294922
Epoch: 18, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.095 Vali Acc: 0.575 Test Loss: 1.095 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8837723731994629
Epoch: 19, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.076 Vali Acc: 0.725 Test Loss: 1.076 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 20 cost time: 0.779409646987915
Epoch: 20, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.056 Vali Acc: 0.725 Test Loss: 1.056 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 21 cost time: 0.935413122177124
Epoch: 21, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7712790966033936
Epoch: 22, Steps: 3 | Train Loss: 0.777 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.818169116973877
Epoch: 23, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7024214267730713
Epoch: 24, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7890231609344482
Epoch: 25, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.951 Vali Acc: 0.675 Test Loss: 0.951 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7604131698608398
Epoch: 26, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724991).  Saving model ...
Epoch: 27 cost time: 0.7619996070861816
Epoch: 27, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 28 cost time: 0.7993724346160889
Epoch: 28, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 29 cost time: 1.0121252536773682
Epoch: 29, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.831 Vali Acc: 0.800 Test Loss: 0.831 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 0.901137113571167
Epoch: 30, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 1.008678913116455
Epoch: 31, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 32 cost time: 0.8129570484161377
Epoch: 32, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 33 cost time: 0.8130576610565186
Epoch: 33, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7722163200378418
Epoch: 34, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7738144397735596
Epoch: 35, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7582180500030518
Epoch: 36, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.653 Vali Acc: 0.825 Test Loss: 0.653 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8827672004699707
Epoch: 37, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.9726171493530273
Epoch: 38, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.6145849227905273
Epoch: 39, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.7931909561157227
Epoch: 40, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7077984809875488
Epoch: 41, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.7955515384674072
Epoch: 42, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 43 cost time: 0.7545230388641357
Epoch: 43, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.8864738941192627
Epoch: 44, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.7313623428344727
Epoch: 45, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6468892097473145
Epoch: 46, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.6253507137298584
Epoch: 47, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.7407975196838379
Epoch: 48, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.64438796043396
Epoch: 49, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.6165778636932373
Epoch: 50, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 51 cost time: 0.6285839080810547
Epoch: 51, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.7591292858123779
Epoch: 52, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.6141457557678223
Epoch: 53, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.7873482704162598
Epoch: 54, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.8335139751434326
Epoch: 55, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.7257838249206543
Epoch: 56, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.7250487804412842
Epoch: 57, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.7282059192657471
Epoch: 58, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7588310241699219
Epoch: 59, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 0.816835880279541
Epoch: 60, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 0.7970731258392334
Epoch: 61, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 0.7111837863922119
Epoch: 62, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 63 cost time: 1.1071803569793701
Epoch: 63, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.9132752418518066
Epoch: 64, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.8547160625457764
Epoch: 65, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.9867544174194336
Epoch: 66, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 0.771991491317749
Epoch: 67, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 0.642045259475708
Epoch: 68, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.657067060470581
Epoch: 69, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 70 cost time: 0.8778605461120605
Epoch: 70, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 71 cost time: 0.7994949817657471
Epoch: 71, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8589768409729004
Epoch: 72, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 73 cost time: 0.7949542999267578
Epoch: 73, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.996300458908081
Epoch: 74, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7689292430877686
Epoch: 75, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 76 cost time: 0.861727237701416
Epoch: 76, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8710463047027588
Epoch: 77, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.927985429763794
Epoch: 78, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.032254695892334
Epoch: 79, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.973726749420166
Epoch: 80, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.9288148880004883
Epoch: 81, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.0530357360839844
Epoch: 82, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.9726049900054932
Epoch: 83, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.1655993461608887
Epoch: 84, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.8278751373291016
Epoch: 85, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 112860
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.348041296005249
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.439 Vali Acc: 0.200 Test Loss: 1.439 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.7133026123046875
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.429 Vali Acc: 0.200 Test Loss: 1.429 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.7716093063354492
Epoch: 3, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.427 Vali Acc: 0.225 Test Loss: 1.427 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.6603219509124756
Epoch: 4, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.428 Vali Acc: 0.225 Test Loss: 1.428 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7091324329376221
Epoch: 5, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.426 Vali Acc: 0.350 Test Loss: 1.426 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.7390322685241699
Epoch: 6, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.426 Vali Acc: 0.350 Test Loss: 1.426 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8200695514678955
Epoch: 7, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9565064907073975
Epoch: 8, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.411 Vali Acc: 0.325 Test Loss: 1.411 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9856102466583252
Epoch: 9, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.400 Vali Acc: 0.300 Test Loss: 1.400 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0307362079620361
Epoch: 10, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.380 Vali Acc: 0.350 Test Loss: 1.380 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 11 cost time: 0.7652833461761475
Epoch: 11, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.352 Vali Acc: 0.425 Test Loss: 1.352 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 12 cost time: 0.8550827503204346
Epoch: 12, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.8520925045013428
Epoch: 13, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.8119006156921387
Epoch: 14, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.277 Vali Acc: 0.525 Test Loss: 1.277 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 15 cost time: 0.9954643249511719
Epoch: 15, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.751563310623169
Epoch: 16, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.240 Vali Acc: 0.575 Test Loss: 1.240 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.7726776599884033
Epoch: 17, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6898829936981201
Epoch: 18, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.205 Vali Acc: 0.550 Test Loss: 1.205 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7039422988891602
Epoch: 19, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.8294329643249512
Epoch: 20, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.149 Vali Acc: 0.700 Test Loss: 1.149 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 21 cost time: 0.828697681427002
Epoch: 21, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.128 Vali Acc: 0.700 Test Loss: 1.128 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 0.8058078289031982
Epoch: 22, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.118 Vali Acc: 0.675 Test Loss: 1.118 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.70725417137146
Epoch: 23, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.110 Vali Acc: 0.650 Test Loss: 1.110 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7605180740356445
Epoch: 24, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.707618236541748
Epoch: 25, Steps: 3 | Train Loss: 0.676 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7385752201080322
Epoch: 26, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6811764240264893
Epoch: 27, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.6342742443084717
Epoch: 28, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.8726379871368408
Epoch: 29, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 30 cost time: 0.9057722091674805
Epoch: 30, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8308768272399902
Epoch: 31, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8010706901550293
Epoch: 32, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.810706615447998
Epoch: 33, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.880 Vali Acc: 0.700 Test Loss: 0.880 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7803611755371094
Epoch: 34, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.865 Vali Acc: 0.700 Test Loss: 0.865 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6778874397277832
Epoch: 35, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724992).  Saving model ...
Epoch: 36 cost time: 0.7698073387145996
Epoch: 36, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.832 Vali Acc: 0.725 Test Loss: 0.832 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 37 cost time: 0.850203275680542
Epoch: 37, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.817 Vali Acc: 0.700 Test Loss: 0.817 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7187011241912842
Epoch: 38, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.799 Vali Acc: 0.700 Test Loss: 0.799 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6989660263061523
Epoch: 39, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.784 Vali Acc: 0.725 Test Loss: 0.784 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 40 cost time: 0.7087962627410889
Epoch: 40, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.724992 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 0.7750363349914551
Epoch: 41, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 42 cost time: 0.7329719066619873
Epoch: 42, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 43 cost time: 0.9387624263763428
Epoch: 43, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 44 cost time: 0.6525759696960449
Epoch: 44, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8477044105529785
Epoch: 45, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1014184951782227
Epoch: 46, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 47 cost time: 0.7511425018310547
Epoch: 47, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 48 cost time: 0.8286600112915039
Epoch: 48, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 49 cost time: 0.8989522457122803
Epoch: 49, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.635 Vali Acc: 0.875 Test Loss: 0.635 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.7927758693695068
Epoch: 50, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.783071756362915
Epoch: 51, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.8479387760162354
Epoch: 52, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 53 cost time: 0.8740453720092773
Epoch: 53, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 54 cost time: 0.6809847354888916
Epoch: 54, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 0.7872636318206787
Epoch: 55, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7773807048797607
Epoch: 56, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 0.7364225387573242
Epoch: 57, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7177734375
Epoch: 58, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8348805904388428
Epoch: 59, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8878512382507324
Epoch: 60, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8840281963348389
Epoch: 61, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9819941520690918
Epoch: 62, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9533147811889648
Epoch: 63, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.7269203662872314
Epoch: 64, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 65 cost time: 0.8981130123138428
Epoch: 65, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 66 cost time: 0.8954203128814697
Epoch: 66, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 67 cost time: 0.8999490737915039
Epoch: 67, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 68 cost time: 0.8320772647857666
Epoch: 68, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 69 cost time: 0.6889278888702393
Epoch: 69, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 70 cost time: 0.7283885478973389
Epoch: 70, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 71 cost time: 0.7068889141082764
Epoch: 71, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 72 cost time: 0.7556729316711426
Epoch: 72, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 73 cost time: 1.0383121967315674
Epoch: 73, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 74 cost time: 0.9250316619873047
Epoch: 74, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 75 cost time: 0.6616685390472412
Epoch: 75, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0892744064331055
Epoch: 76, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7232685089111328
Epoch: 77, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.9707465171813965
Epoch: 78, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6759159564971924
Epoch: 79, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.8672816753387451
Epoch: 80, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.7499024868011475
Epoch: 81, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8172461986541748
Epoch: 82, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.7391159534454346
Epoch: 83, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.7691733837127686
Epoch: 84, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 112572
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.020634412765503
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.488 Vali Acc: 0.300 Test Loss: 1.488 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.8073089122772217
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.480 Vali Acc: 0.275 Test Loss: 1.480 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7599048614501953
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.474 Vali Acc: 0.250 Test Loss: 1.474 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.990260124206543
Epoch: 4, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.463 Vali Acc: 0.300 Test Loss: 1.463 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 0.7372875213623047
Epoch: 5, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.458 Vali Acc: 0.300 Test Loss: 1.458 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 0.6572988033294678
Epoch: 6, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.445 Vali Acc: 0.350 Test Loss: 1.445 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.8570418357849121
Epoch: 7, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.434 Vali Acc: 0.325 Test Loss: 1.434 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7938604354858398
Epoch: 8, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.429 Vali Acc: 0.350 Test Loss: 1.429 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.7192988395690918
Epoch: 9, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.410 Vali Acc: 0.375 Test Loss: 1.410 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.6988112926483154
Epoch: 10, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.392 Vali Acc: 0.350 Test Loss: 1.392 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8193955421447754
Epoch: 11, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 0.7080259323120117
Epoch: 12, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 0.8313624858856201
Epoch: 13, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6915159225463867
Epoch: 14, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7549965381622314
Epoch: 15, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8846855163574219
Epoch: 16, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 0.8322012424468994
Epoch: 17, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.261 Vali Acc: 0.425 Test Loss: 1.261 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8386781215667725
Epoch: 18, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9440145492553711
Epoch: 19, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.225 Vali Acc: 0.450 Test Loss: 1.225 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.729572057723999
Epoch: 20, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.204 Vali Acc: 0.525 Test Loss: 1.204 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.6505599021911621
Epoch: 21, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.180 Vali Acc: 0.600 Test Loss: 1.180 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.6965358257293701
Epoch: 22, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.167 Vali Acc: 0.575 Test Loss: 1.167 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7594730854034424
Epoch: 23, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.7099554538726807
Epoch: 24, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.8118138313293457
Epoch: 25, Steps: 3 | Train Loss: 0.684 Vali Loss: 1.084 Vali Acc: 0.650 Test Loss: 1.084 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.8157200813293457
Epoch: 26, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.063 Vali Acc: 0.650 Test Loss: 1.063 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 0.7170720100402832
Epoch: 27, Steps: 3 | Train Loss: 0.689 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.9112026691436768
Epoch: 28, Steps: 3 | Train Loss: 0.594 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 29 cost time: 0.732903003692627
Epoch: 29, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.987 Vali Acc: 0.675 Test Loss: 0.987 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8064954280853271
Epoch: 30, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.972 Vali Acc: 0.675 Test Loss: 0.972 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.739431619644165
Epoch: 31, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.963 Vali Acc: 0.625 Test Loss: 0.963 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6783595085144043
Epoch: 32, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.952 Vali Acc: 0.650 Test Loss: 0.952 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8529634475708008
Epoch: 33, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.915 Vali Acc: 0.650 Test Loss: 0.915 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6349310874938965
Epoch: 34, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.867 Vali Acc: 0.700 Test Loss: 0.867 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6892564296722412
Epoch: 35, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 1.0602242946624756
Epoch: 36, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.826 Vali Acc: 0.800 Test Loss: 0.826 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 0.879565954208374
Epoch: 37, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.8277943134307861
Epoch: 38, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.773 Vali Acc: 0.825 Test Loss: 0.773 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 39 cost time: 0.9993386268615723
Epoch: 39, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 40 cost time: 0.8813974857330322
Epoch: 40, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8189923763275146
Epoch: 41, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 42 cost time: 0.6561594009399414
Epoch: 42, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 43 cost time: 0.6602680683135986
Epoch: 43, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 44 cost time: 0.7866780757904053
Epoch: 44, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.692 Vali Acc: 0.875 Test Loss: 0.692 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 45 cost time: 0.7190914154052734
Epoch: 45, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 46 cost time: 0.7961351871490479
Epoch: 46, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8733084201812744
Epoch: 47, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.9093847274780273
Epoch: 48, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 1.0656890869140625
Epoch: 49, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.611 Vali Acc: 0.875 Test Loss: 0.611 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.8436627388000488
Epoch: 50, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.7811744213104248
Epoch: 51, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.813300609588623
Epoch: 52, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 53 cost time: 0.9085183143615723
Epoch: 53, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 0.7832589149475098
Epoch: 54, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 0.744438886642456
Epoch: 55, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 0.6970975399017334
Epoch: 56, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7631895542144775
Epoch: 57, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.9276211261749268
Epoch: 58, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.945061206817627
Epoch: 59, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.7899141311645508
Epoch: 60, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.8845562934875488
Epoch: 61, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 0.7381680011749268
Epoch: 62, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 63 cost time: 0.7977213859558105
Epoch: 63, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 64 cost time: 0.6565649509429932
Epoch: 64, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 65 cost time: 0.7621810436248779
Epoch: 65, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 66 cost time: 0.7307844161987305
Epoch: 66, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 67 cost time: 0.8183345794677734
Epoch: 67, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 68 cost time: 0.9721970558166504
Epoch: 68, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 69 cost time: 1.015331745147705
Epoch: 69, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 70 cost time: 0.669424295425415
Epoch: 70, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.840630292892456
Epoch: 71, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8236677646636963
Epoch: 72, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7261331081390381
Epoch: 73, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7652931213378906
Epoch: 74, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6558496952056885
Epoch: 75, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.6966407299041748
Epoch: 76, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.7151446342468262
Epoch: 77, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 78 cost time: 0.6775364875793457
Epoch: 78, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 79 cost time: 0.6846339702606201
Epoch: 79, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 80 cost time: 0.7772009372711182
Epoch: 80, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 81 cost time: 0.6587305068969727
Epoch: 81, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 82 cost time: 0.7905125617980957
Epoch: 82, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8813877105712891
Epoch: 83, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.7900047302246094
Epoch: 84, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 85 cost time: 0.718984842300415
Epoch: 85, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 86 cost time: 0.8103976249694824
Epoch: 86, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 87 cost time: 0.749664306640625
Epoch: 87, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 88 cost time: 0.9914646148681641
Epoch: 88, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 89 cost time: 0.7951564788818359
Epoch: 89, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.69500732421875
Epoch: 90, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 91 cost time: 0.8024373054504395
Epoch: 91, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 92 cost time: 0.781381368637085
Epoch: 92, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 93 cost time: 0.9332866668701172
Epoch: 93, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.8792123794555664
Epoch: 94, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.8079187870025635
Epoch: 95, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.7327609062194824
Epoch: 96, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.8337821960449219
Epoch: 97, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.9439787864685059
Epoch: 98, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.7169561386108398
Epoch: 99, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 100 cost time: 0.807337760925293
Epoch: 100, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 112284
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2819764614105225
Epoch: 1, Steps: 3 | Train Loss: 1.691 Vali Loss: 1.492 Vali Acc: 0.175 Test Loss: 1.492 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.6603903770446777
Epoch: 2, Steps: 3 | Train Loss: 1.601 Vali Loss: 1.473 Vali Acc: 0.150 Test Loss: 1.473 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0019807815551758
Epoch: 3, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.466 Vali Acc: 0.150 Test Loss: 1.466 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9625351428985596
Epoch: 4, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.464 Vali Acc: 0.125 Test Loss: 1.464 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7229611873626709
Epoch: 5, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.468 Vali Acc: 0.300 Test Loss: 1.468 Test Acc: 0.300
Validation loss decreased (-0.174985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 0.726010799407959
Epoch: 6, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.471 Vali Acc: 0.250 Test Loss: 1.471 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.856360673904419
Epoch: 7, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.480 Vali Acc: 0.350 Test Loss: 1.480 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349985).  Saving model ...
Epoch: 8 cost time: 0.9175722599029541
Epoch: 8, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.476 Vali Acc: 0.375 Test Loss: 1.476 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 9 cost time: 0.7562525272369385
Epoch: 9, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.464 Vali Acc: 0.375 Test Loss: 1.464 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 10 cost time: 0.8099808692932129
Epoch: 10, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.438 Vali Acc: 0.375 Test Loss: 1.438 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374986).  Saving model ...
Epoch: 11 cost time: 0.6632449626922607
Epoch: 11, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.393 Vali Acc: 0.375 Test Loss: 1.393 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 0.7769646644592285
Epoch: 12, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.353 Vali Acc: 0.375 Test Loss: 1.353 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 13 cost time: 0.7855024337768555
Epoch: 13, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.316 Vali Acc: 0.325 Test Loss: 1.316 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.719698429107666
Epoch: 14, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.685814380645752
Epoch: 15, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.266 Vali Acc: 0.525 Test Loss: 1.266 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 16 cost time: 0.8183605670928955
Epoch: 16, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.7576010227203369
Epoch: 17, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.238 Vali Acc: 0.575 Test Loss: 1.238 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.8287489414215088
Epoch: 18, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8114311695098877
Epoch: 19, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.8604638576507568
Epoch: 20, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.188 Vali Acc: 0.575 Test Loss: 1.188 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7686445713043213
Epoch: 21, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.159 Vali Acc: 0.575 Test Loss: 1.159 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7797036170959473
Epoch: 22, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.7781639099121094
Epoch: 23, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.8057591915130615
Epoch: 24, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.8392512798309326
Epoch: 25, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.054 Vali Acc: 0.625 Test Loss: 1.054 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8955929279327393
Epoch: 26, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9375731945037842
Epoch: 27, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7047886848449707
Epoch: 28, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7346844673156738
Epoch: 29, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.7685070037841797
Epoch: 30, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.7284450531005859
Epoch: 31, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.8134429454803467
Epoch: 32, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 0.8322491645812988
Epoch: 33, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7449307441711426
Epoch: 34, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 35 cost time: 0.8834066390991211
Epoch: 35, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 36 cost time: 1.1353583335876465
Epoch: 36, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 0.8769991397857666
Epoch: 37, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.741 Vali Acc: 0.825 Test Loss: 0.741 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 38 cost time: 1.0610814094543457
Epoch: 38, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 1.0597960948944092
Epoch: 39, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 40 cost time: 0.7864117622375488
Epoch: 40, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 41 cost time: 0.8178739547729492
Epoch: 41, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8050715923309326
Epoch: 42, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6999936103820801
Epoch: 43, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7991268634796143
Epoch: 44, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9049406051635742
Epoch: 45, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9378542900085449
Epoch: 46, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 1.082991123199463
Epoch: 47, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.822944164276123
Epoch: 48, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.7503929138183594
Epoch: 49, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.7532098293304443
Epoch: 50, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.703568696975708
Epoch: 51, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.7758843898773193
Epoch: 52, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 1.077268123626709
Epoch: 53, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8553416728973389
Epoch: 54, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.907005786895752
Epoch: 55, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9195001125335693
Epoch: 56, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6779046058654785
Epoch: 57, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9021661281585693
Epoch: 58, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.7462234497070312
Epoch: 59, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7406442165374756
Epoch: 60, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7275941371917725
Epoch: 61, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.807185173034668
Epoch: 62, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 111996
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.737415313720703
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8289976119995117
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.8239011764526367
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.380 Vali Acc: 0.425 Test Loss: 1.380 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.7029001712799072
Epoch: 4, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.385 Vali Acc: 0.500 Test Loss: 1.385 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 0.7531182765960693
Epoch: 5, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.388 Vali Acc: 0.450 Test Loss: 1.388 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8651466369628906
Epoch: 6, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0203523635864258
Epoch: 7, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8550117015838623
Epoch: 8, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.379 Vali Acc: 0.350 Test Loss: 1.379 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8930881023406982
Epoch: 9, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.360 Vali Acc: 0.375 Test Loss: 1.360 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8327906131744385
Epoch: 10, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.341 Vali Acc: 0.475 Test Loss: 1.341 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7183117866516113
Epoch: 11, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.321 Vali Acc: 0.425 Test Loss: 1.321 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7672302722930908
Epoch: 12, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.300 Vali Acc: 0.550 Test Loss: 1.300 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 0.7944798469543457
Epoch: 13, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 14 cost time: 0.8832874298095703
Epoch: 14, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0326542854309082
Epoch: 15, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.237 Vali Acc: 0.625 Test Loss: 1.237 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.6824908256530762
Epoch: 16, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.222 Vali Acc: 0.675 Test Loss: 1.222 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 17 cost time: 0.8241820335388184
Epoch: 17, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.212 Vali Acc: 0.675 Test Loss: 1.212 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.948026180267334
Epoch: 18, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.199 Vali Acc: 0.650 Test Loss: 1.199 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.005505084991455
Epoch: 19, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.188 Vali Acc: 0.600 Test Loss: 1.188 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8042535781860352
Epoch: 20, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.167 Vali Acc: 0.675 Test Loss: 1.167 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 21 cost time: 0.6695818901062012
Epoch: 21, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.152 Vali Acc: 0.650 Test Loss: 1.152 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7480347156524658
Epoch: 22, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7776503562927246
Epoch: 23, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.7149584293365479
Epoch: 24, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.077 Vali Acc: 0.725 Test Loss: 1.077 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 25 cost time: 0.7139019966125488
Epoch: 25, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.036 Vali Acc: 0.725 Test Loss: 1.036 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.6747891902923584
Epoch: 26, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1652576923370361
Epoch: 27, Steps: 3 | Train Loss: 0.664 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 28 cost time: 0.8094515800476074
Epoch: 28, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.986 Vali Acc: 0.775 Test Loss: 0.986 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 29 cost time: 0.8236196041107178
Epoch: 29, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 30 cost time: 0.7087037563323975
Epoch: 30, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9288070201873779
Epoch: 31, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 32 cost time: 0.9490149021148682
Epoch: 32, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3430595397949219
Epoch: 33, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8353347778320312
Epoch: 34, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8985848426818848
Epoch: 35, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 0.8606560230255127
Epoch: 36, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 0.853097677230835
Epoch: 37, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.799 Vali Acc: 0.775 Test Loss: 0.799 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7890110015869141
Epoch: 38, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.782 Vali Acc: 0.800 Test Loss: 0.782 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 0.7885234355926514
Epoch: 39, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 40 cost time: 0.9640805721282959
Epoch: 40, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7394859790802002
Epoch: 41, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.837507963180542
Epoch: 42, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 43 cost time: 0.7830643653869629
Epoch: 43, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 44 cost time: 0.7802789211273193
Epoch: 44, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 45 cost time: 0.7954282760620117
Epoch: 45, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 46 cost time: 0.793358325958252
Epoch: 46, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 47 cost time: 0.8368792533874512
Epoch: 47, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 48 cost time: 0.7423608303070068
Epoch: 48, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 49 cost time: 0.7951631546020508
Epoch: 49, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 50 cost time: 0.6858808994293213
Epoch: 50, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 51 cost time: 0.8083798885345459
Epoch: 51, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 52 cost time: 0.8299636840820312
Epoch: 52, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 53 cost time: 0.7335376739501953
Epoch: 53, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 54 cost time: 0.6495225429534912
Epoch: 54, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 55 cost time: 0.6556832790374756
Epoch: 55, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 56 cost time: 0.8903787136077881
Epoch: 56, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 0.6848480701446533
Epoch: 57, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 58 cost time: 0.7794713973999023
Epoch: 58, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.7304747104644775
Epoch: 59, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7910292148590088
Epoch: 60, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7898478507995605
Epoch: 61, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5632548332214355
Epoch: 62, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.734607458114624
Epoch: 63, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.753486156463623
Epoch: 64, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 65 cost time: 0.8754580020904541
Epoch: 65, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 66 cost time: 0.8075847625732422
Epoch: 66, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7414062023162842
Epoch: 67, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7435522079467773
Epoch: 68, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 69 cost time: 0.9679017066955566
Epoch: 69, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8412561416625977
Epoch: 70, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7278366088867188
Epoch: 71, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7626886367797852
Epoch: 72, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.7189018726348877
Epoch: 73, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 74 cost time: 0.7908074855804443
Epoch: 74, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 75 cost time: 0.767742395401001
Epoch: 75, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 76 cost time: 0.8921146392822266
Epoch: 76, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 77 cost time: 0.7976312637329102
Epoch: 77, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 78 cost time: 0.6551384925842285
Epoch: 78, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7995500564575195
Epoch: 79, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 80 cost time: 0.9836587905883789
Epoch: 80, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 81 cost time: 1.0606200695037842
Epoch: 81, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7810268402099609
Epoch: 82, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8199694156646729
Epoch: 83, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.9026110172271729
Epoch: 84, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7958126068115234
Epoch: 85, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.8270528316497803
Epoch: 86, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.7467117309570312
Epoch: 87, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.8078029155731201
Epoch: 88, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.7812747955322266
Epoch: 89, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.7757949829101562
Epoch: 90, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 87900
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9659366607666016
Epoch: 1, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.441 Vali Acc: 0.075 Test Loss: 1.441 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.7106211185455322
Epoch: 2, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.435 Vali Acc: 0.175 Test Loss: 1.435 Test Acc: 0.175
Validation loss decreased (-0.074986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.7646663188934326
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.432 Vali Acc: 0.175 Test Loss: 1.432 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.8187403678894043
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.8444139957427979
Epoch: 5, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.443 Vali Acc: 0.350 Test Loss: 1.443 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.6599090099334717
Epoch: 6, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.448 Vali Acc: 0.450 Test Loss: 1.448 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.9062509536743164
Epoch: 7, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.453 Vali Acc: 0.350 Test Loss: 1.453 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7260556221008301
Epoch: 8, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7042169570922852
Epoch: 9, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.414 Vali Acc: 0.325 Test Loss: 1.414 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7793471813201904
Epoch: 10, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 0.7155804634094238
Epoch: 11, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.358 Vali Acc: 0.475 Test Loss: 1.358 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8241565227508545
Epoch: 12, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8550772666931152
Epoch: 13, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8589327335357666
Epoch: 14, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8281593322753906
Epoch: 15, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.275 Vali Acc: 0.475 Test Loss: 1.275 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8194179534912109
Epoch: 16, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.257 Vali Acc: 0.625 Test Loss: 1.257 Test Acc: 0.625
Validation loss decreased (-0.499986 --> -0.624987).  Saving model ...
Epoch: 17 cost time: 0.6952190399169922
Epoch: 17, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.6869387626647949
Epoch: 18, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8162703514099121
Epoch: 19, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 0.7356016635894775
Epoch: 20, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.209 Vali Acc: 0.675 Test Loss: 1.209 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 21 cost time: 0.74501633644104
Epoch: 21, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.199 Vali Acc: 0.575 Test Loss: 1.199 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7239291667938232
Epoch: 22, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.160 Vali Acc: 0.625 Test Loss: 1.160 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7236998081207275
Epoch: 23, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.128 Vali Acc: 0.700 Test Loss: 1.128 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.6971895694732666
Epoch: 24, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.106 Vali Acc: 0.625 Test Loss: 1.106 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8499865531921387
Epoch: 25, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.68906569480896
Epoch: 26, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.061 Vali Acc: 0.725 Test Loss: 1.061 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 27 cost time: 0.6709856986999512
Epoch: 27, Steps: 3 | Train Loss: 0.708 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7605869770050049
Epoch: 28, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.026 Vali Acc: 0.625 Test Loss: 1.026 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.814591646194458
Epoch: 29, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7418239116668701
Epoch: 30, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 31 cost time: 0.8250761032104492
Epoch: 31, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 32 cost time: 0.7111790180206299
Epoch: 32, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 0.6630222797393799
Epoch: 33, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7342889308929443
Epoch: 34, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6928150653839111
Epoch: 35, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9443979263305664
Epoch: 36, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7483971118927002
Epoch: 37, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.8026542663574219
Epoch: 38, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8270988464355469
Epoch: 39, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.791 Vali Acc: 0.775 Test Loss: 0.791 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9453566074371338
Epoch: 40, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8156640529632568
Epoch: 41, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 42 cost time: 0.8764138221740723
Epoch: 42, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 43 cost time: 0.8319172859191895
Epoch: 43, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8691651821136475
Epoch: 44, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 45 cost time: 0.8911049365997314
Epoch: 45, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 46 cost time: 0.7358651161193848
Epoch: 46, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 47 cost time: 0.851405143737793
Epoch: 47, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8302702903747559
Epoch: 48, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8431704044342041
Epoch: 49, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.7279515266418457
Epoch: 50, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.7727837562561035
Epoch: 51, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.865220308303833
Epoch: 52, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 53 cost time: 0.8400790691375732
Epoch: 53, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.574 Vali Acc: 0.875 Test Loss: 0.574 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 54 cost time: 0.8437635898590088
Epoch: 54, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 55 cost time: 0.6645007133483887
Epoch: 55, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 56 cost time: 0.813223123550415
Epoch: 56, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 57 cost time: 0.8769688606262207
Epoch: 57, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.7974722385406494
Epoch: 58, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.7981538772583008
Epoch: 59, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.8674352169036865
Epoch: 60, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.7812399864196777
Epoch: 61, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 0.8105273246765137
Epoch: 62, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 63 cost time: 0.8210527896881104
Epoch: 63, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 64 cost time: 0.777268648147583
Epoch: 64, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8748059272766113
Epoch: 65, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6109330654144287
Epoch: 66, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6445043087005615
Epoch: 67, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.645366907119751
Epoch: 68, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.898282527923584
Epoch: 69, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.014155387878418
Epoch: 70, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.671825647354126
Epoch: 71, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.8912067413330078
Epoch: 72, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.7751758098602295
Epoch: 73, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 87612
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3057641983032227
Epoch: 1, Steps: 3 | Train Loss: 1.613 Vali Loss: 1.409 Vali Acc: 0.150 Test Loss: 1.409 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.6788530349731445
Epoch: 2, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.392 Vali Acc: 0.150 Test Loss: 1.392 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.7839176654815674
Epoch: 3, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.387 Vali Acc: 0.175 Test Loss: 1.387 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.7283360958099365
Epoch: 4, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.6990835666656494
Epoch: 5, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.8702812194824219
Epoch: 6, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.376 Vali Acc: 0.175 Test Loss: 1.376 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7430009841918945
Epoch: 7, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7573089599609375
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8429725170135498
Epoch: 9, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.357 Vali Acc: 0.350 Test Loss: 1.357 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7831039428710938
Epoch: 10, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.337 Vali Acc: 0.325 Test Loss: 1.337 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.808542013168335
Epoch: 11, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.313 Vali Acc: 0.250 Test Loss: 1.313 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6585979461669922
Epoch: 12, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.297 Vali Acc: 0.350 Test Loss: 1.297 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.819725751876831
Epoch: 13, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.9014391899108887
Epoch: 14, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.6179373264312744
Epoch: 15, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.8485126495361328
Epoch: 16, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.7750570774078369
Epoch: 17, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6737227439880371
Epoch: 18, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.150 Vali Acc: 0.575 Test Loss: 1.150 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.9009547233581543
Epoch: 19, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.136 Vali Acc: 0.575 Test Loss: 1.136 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 0.6600322723388672
Epoch: 20, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.8242411613464355
Epoch: 21, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6247832775115967
Epoch: 22, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.072 Vali Acc: 0.700 Test Loss: 1.072 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.8139841556549072
Epoch: 23, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7711691856384277
Epoch: 24, Steps: 3 | Train Loss: 0.810 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0352189540863037
Epoch: 25, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7194850444793701
Epoch: 26, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 27 cost time: 0.8928422927856445
Epoch: 27, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6506996154785156
Epoch: 28, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.919 Vali Acc: 0.825 Test Loss: 0.919 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 29 cost time: 0.8271751403808594
Epoch: 29, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.894 Vali Acc: 0.825 Test Loss: 0.894 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 30 cost time: 0.7530167102813721
Epoch: 30, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.886 Vali Acc: 0.800 Test Loss: 0.886 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6090693473815918
Epoch: 31, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7022736072540283
Epoch: 32, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.900 Vali Acc: 0.575 Test Loss: 0.900 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6951444149017334
Epoch: 33, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.861 Vali Acc: 0.650 Test Loss: 0.861 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0009677410125732
Epoch: 34, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 35 cost time: 0.7046284675598145
Epoch: 35, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.779 Vali Acc: 0.625 Test Loss: 0.779 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8840060234069824
Epoch: 36, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.750 Vali Acc: 0.875 Test Loss: 0.750 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 37 cost time: 0.8910419940948486
Epoch: 37, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7586033344268799
Epoch: 38, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7307651042938232
Epoch: 39, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8851501941680908
Epoch: 40, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.615769624710083
Epoch: 41, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 42 cost time: 0.6592519283294678
Epoch: 42, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.650 Vali Acc: 0.875 Test Loss: 0.650 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 43 cost time: 0.6354002952575684
Epoch: 43, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.752784252166748
Epoch: 44, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7089319229125977
Epoch: 45, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.8389992713928223
Epoch: 46, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.7995834350585938
Epoch: 47, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8009781837463379
Epoch: 48, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 49 cost time: 0.6236701011657715
Epoch: 49, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.6567151546478271
Epoch: 50, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7204952239990234
Epoch: 51, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7110950946807861
Epoch: 52, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 53 cost time: 0.6986124515533447
Epoch: 53, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6128189563751221
Epoch: 54, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.736968994140625
Epoch: 55, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.704355001449585
Epoch: 56, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8258352279663086
Epoch: 57, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.80556321144104
Epoch: 58, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6953463554382324
Epoch: 59, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.909881591796875
Epoch: 60, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7785995006561279
Epoch: 61, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.6202564239501953
Epoch: 62, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 87324
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1359469890594482
Epoch: 1, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.454 Vali Acc: 0.350 Test Loss: 1.454 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.8112890720367432
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.434 Vali Acc: 0.350 Test Loss: 1.434 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.7989122867584229
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.420 Vali Acc: 0.350 Test Loss: 1.420 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0566165447235107
Epoch: 4, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.406 Vali Acc: 0.350 Test Loss: 1.406 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.0324277877807617
Epoch: 5, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.393 Vali Acc: 0.400 Test Loss: 1.393 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.9124083518981934
Epoch: 6, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.382 Vali Acc: 0.325 Test Loss: 1.382 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0078973770141602
Epoch: 7, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8264873027801514
Epoch: 8, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8865723609924316
Epoch: 9, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.347 Vali Acc: 0.450 Test Loss: 1.347 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.7949457168579102
Epoch: 10, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.329 Vali Acc: 0.475 Test Loss: 1.329 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.8167002201080322
Epoch: 11, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.309 Vali Acc: 0.450 Test Loss: 1.309 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0079357624053955
Epoch: 12, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.291 Vali Acc: 0.425 Test Loss: 1.291 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8693289756774902
Epoch: 13, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8902754783630371
Epoch: 14, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.256 Vali Acc: 0.450 Test Loss: 1.256 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7537393569946289
Epoch: 15, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.240 Vali Acc: 0.425 Test Loss: 1.240 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8986783027648926
Epoch: 16, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.225 Vali Acc: 0.450 Test Loss: 1.225 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8328335285186768
Epoch: 17, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.205 Vali Acc: 0.525 Test Loss: 1.205 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.7349450588226318
Epoch: 18, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.196 Vali Acc: 0.625 Test Loss: 1.196 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 19 cost time: 0.6928079128265381
Epoch: 19, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.7476367950439453
Epoch: 20, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6910078525543213
Epoch: 21, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6873559951782227
Epoch: 22, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.115 Vali Acc: 0.525 Test Loss: 1.115 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8651163578033447
Epoch: 23, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.088 Vali Acc: 0.525 Test Loss: 1.088 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8703992366790771
Epoch: 24, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.055 Vali Acc: 0.550 Test Loss: 1.055 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7790107727050781
Epoch: 25, Steps: 3 | Train Loss: 0.745 Vali Loss: 1.037 Vali Acc: 0.575 Test Loss: 1.037 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7531282901763916
Epoch: 26, Steps: 3 | Train Loss: 0.704 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624990).  Saving model ...
Epoch: 27 cost time: 1.1786470413208008
Epoch: 27, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.980 Vali Acc: 0.775 Test Loss: 0.980 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774990).  Saving model ...
Epoch: 28 cost time: 0.724865198135376
Epoch: 28, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.955 Vali Acc: 0.800 Test Loss: 0.955 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 29 cost time: 0.6574618816375732
Epoch: 29, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.933 Vali Acc: 0.775 Test Loss: 0.933 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7083821296691895
Epoch: 30, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.917 Vali Acc: 0.700 Test Loss: 0.917 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7696022987365723
Epoch: 31, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.892 Vali Acc: 0.725 Test Loss: 0.892 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8676412105560303
Epoch: 32, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.870 Vali Acc: 0.800 Test Loss: 0.870 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 33 cost time: 0.7876689434051514
Epoch: 33, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.860 Vali Acc: 0.825 Test Loss: 0.860 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 34 cost time: 0.6754837036132812
Epoch: 34, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8886406421661377
Epoch: 35, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1649680137634277
Epoch: 36, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 0.9873898029327393
Epoch: 37, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.782 Vali Acc: 0.800 Test Loss: 0.782 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7860023975372314
Epoch: 38, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 0.7386400699615479
Epoch: 39, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 40 cost time: 0.7997374534606934
Epoch: 40, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 0.9167304039001465
Epoch: 41, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 42 cost time: 0.9021587371826172
Epoch: 42, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 43 cost time: 0.7802050113677979
Epoch: 43, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8631367683410645
Epoch: 44, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8017499446868896
Epoch: 45, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9106299877166748
Epoch: 46, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0462682247161865
Epoch: 47, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.633 Vali Acc: 0.825 Test Loss: 0.633 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3282544612884521
Epoch: 48, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9349100589752197
Epoch: 49, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0388224124908447
Epoch: 50, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 51 cost time: 1.0553526878356934
Epoch: 51, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.745248556137085
Epoch: 52, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.6681661605834961
Epoch: 53, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.9439258575439453
Epoch: 54, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8945624828338623
Epoch: 55, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 56 cost time: 0.7590861320495605
Epoch: 56, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0430784225463867
Epoch: 57, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 58 cost time: 0.8849837779998779
Epoch: 58, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 59 cost time: 0.9221842288970947
Epoch: 59, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8542959690093994
Epoch: 60, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8322968482971191
Epoch: 61, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.835207462310791
Epoch: 62, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0907871723175049
Epoch: 63, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.816321611404419
Epoch: 64, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.7789037227630615
Epoch: 65, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 66 cost time: 0.8453731536865234
Epoch: 66, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8213388919830322
Epoch: 67, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 68 cost time: 0.8641397953033447
Epoch: 68, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 69 cost time: 0.7926487922668457
Epoch: 69, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9627988338470459
Epoch: 70, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7760989665985107
Epoch: 71, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7641277313232422
Epoch: 72, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.9898591041564941
Epoch: 73, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.920950174331665
Epoch: 74, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8150827884674072
Epoch: 75, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.7726802825927734
Epoch: 76, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.0450191497802734
Epoch: 77, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.030087947845459
Epoch: 78, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_Crossformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 87036
model size : 1.01MB
